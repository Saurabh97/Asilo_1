[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:44603
[S3] → join 127.0.0.1:44602
[S4] → join 127.0.0.1:44602
[S5] → join 127.0.0.1:44602
[S6] → join 127.0.0.1:44602
[S7] → join 127.0.0.1:44602
[S8] → join 127.0.0.1:44602
[S9] → join 127.0.0.1:44602
[S10] → join 127.0.0.1:44602
[S11] → join 127.0.0.1:44602
[S13] → join 127.0.0.1:44602
[S14] → join 127.0.0.1:44602
[S15] → join 127.0.0.1:44602
[S16] → join 127.0.0.1:44602
[S17] → join 127.0.0.1:44602
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.214444 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.155736 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.165797 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.163772 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.184518 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.141790 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.179692 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.127862 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.134239 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.204979 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.220121 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.243719 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.170244 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.192656 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.140796 (no previous merge yet)
[S17]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S3] + discovered S11
[S3] + discovered S7
[S3] + discovered S16
[S3] + discovered S17
[S3] + discovered S4
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S5
[S3] + discovered S15
[S3] + discovered S13
[S3] + discovered S8
[S3] + discovered S14
[S3] + discovered S9
[S3] + discovered S10
[S3] + discovered S6
[S4] + discovered S15
[S4] + discovered S13
[S4] + discovered S5
[S4] + discovered S8
[S4] + discovered S14
[S4] + discovered S9
[S4] + discovered S10
[S4] + discovered S6
[S4] + discovered S11
[S4] + discovered S7
[S4] + discovered S16
[S4] + discovered S17
[S5] + discovered S3
[S5] + discovered S2
[S5] + discovered S4
[S5] + discovered S13
[S5] + discovered S9
[S5] + discovered S6
[S5] + discovered S16
[S5] + discovered S8
[S5] + discovered S11
[S6] + discovered S3
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S2
[S5] + discovered S15
[S5] + discovered S14
[S5] + discovered S10
[S5] + discovered S7
[S5] + discovered S17
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S3
[S6] + discovered S11
[S7] + discovered S6
[S7] + discovered S4
[S6] + discovered S15
[S6] + discovered S7
[S6] + discovered S10
[S6] + discovered S17
[S6] + discovered S16
[S6] + discovered S8
[S6] + discovered S14
[S6] + discovered S13
[S6] + discovered S9
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S2
[S8] + discovered S4
[S8] + discovered S3
[S7] + discovered S16
[S7] + discovered S10
[S7] + discovered S13
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S15
[S7] + discovered S9
[S7] + discovered S14
[S7] + discovered S8
[S9] + discovered S4
[S8] + discovered S10
[S8] + discovered S14
[S8] + discovered S17
[S8] + discovered S13
[S8] + discovered S11
[S9] + discovered S2
[S8] + discovered S9
[S9] + discovered S6
[S8] + discovered S15
[S8] + discovered S16
[S9] + discovered S7
[S9] + discovered S3
[S9] + discovered S8
[S9] + discovered S5
[S10] + discovered S8
[S10] + discovered S2
[S10] + discovered S9
[S10] + discovered S4
[S10] + discovered S5
[S10] + discovered S6
[S10] + discovered S7
[S10] + discovered S3
[S9] + discovered S16
[S9] + discovered S14
[S9] + discovered S15
[S9] + discovered S11
[S9] + discovered S13
[S9] + discovered S17
[S9] + discovered S10
[S10] + discovered S16
[S10] + discovered S15
[S10] + discovered S13
[S10] + discovered S14
[S10] + discovered S11
[S11] + discovered S10
[S11] + discovered S6
[S11] + discovered S4
[S11] + discovered S2
[S11] + discovered S7
[S11] + discovered S5
[S11] + discovered S9
[S11] + discovered S8
[S10] + discovered S17
[S11] + discovered S3
[S13] + discovered S10
[S13] + discovered S2
[S13] + discovered S7
[S13] + discovered S4
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S3
[S11] + discovered S13
[S11] + discovered S17
[S13] + discovered S5
[S11] + discovered S15
[S13] + discovered S11
[S11] + discovered S16
[S11] + discovered S14
[S13] + discovered S9
[S13] + discovered S16
[S13] + discovered S14
[S13] + discovered S15
[S14] + discovered S11
[S14] + discovered S2
[S14] + discovered S10
[S14] + discovered S13
[S14] + discovered S5
[S14] + discovered S3
[S14] + discovered S8
[S14] + discovered S6
[S14] + discovered S4
[S13] + discovered S17
[S14] + discovered S7
[S14] + discovered S9
[S15] + discovered S2
[S15] + discovered S10
[S15] + discovered S14
[S15] + discovered S13
[S15] + discovered S4
[S15] + discovered S8
[S14] + discovered S16
[S14] + discovered S17
[S14] + discovered S15
[S15] + discovered S9
[S15] + discovered S11
[S15] + discovered S3
[S15] + discovered S5
[S15] + discovered S7
[S15] + discovered S6
[S15] + discovered S17
[S16] + discovered S4
[S16] + discovered S11
[S16] + discovered S10
[S16] + discovered S6
[S16] + discovered S8
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S14
[S16] + discovered S5
[S16] + discovered S3
[S16] + discovered S15
[S16] + discovered S7
[S15] + discovered S16
[S16] + discovered S13
[S17] + discovered S4
[S17] + discovered S7
[S16] + discovered S17
[S17] + discovered S14
[S17] + discovered S13
[S17] + discovered S10
[S17] + discovered S5
[S17] + discovered S9
[S17] + discovered S6
[S17] + discovered S2
[S17] + discovered S8
[S17] + discovered S16
[S17] + discovered S15
[S17] + discovered S3
[S17] + discovered S11
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=1.000 → S14@127.0.0.1:44614
[S8] ⇄ pheromone p=1.000 → S4@127.0.0.1:44604
[S7] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S3] ⇄ pheromone p=1.000 → S14@127.0.0.1:44614
[S16] ⇄ pheromone p=1.000 → S15@127.0.0.1:44615
[S11] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S13] ⇄ pheromone p=1.000 → S14@127.0.0.1:44614
[S10] ⇄ pheromone p=1.000 → S9@127.0.0.1:44610
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:44605
[S15] ⇄ pheromone p=1.000 → S8@127.0.0.1:44609
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:44610
[S14] ⇄ pheromone p=1.000 → S15@127.0.0.1:44615
[S2] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S6] ⇄ pheromone p=1.000 → S4@127.0.0.1:44604
[S17] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S2] START round=1 head_norm_before_train=1.224794 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.4160547447484123, 'auprc': 0.77126769254775, 'loss_val': 1.305982689019106, 'psi': 0.5581399238681474}-{'f1_val': 0.6587657450051289, 'auprc': 0.7643013957683298, 'loss_val': 1.3461386366922805, 'psi': 0.7009800053104092}
[S3] START round=1 head_norm_before_train=1.153942 (no previous merge yet)
[S3] round=1 local utility u=0.663700 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9941561503488123, 'loss_val': 1.3432244507555482, 'psi': 0.48156649950798913}-{'f1_val': 0.13984006561410703, 'auprc': 0.561306887863366, 'loss_val': 1.3720768275294097, 'psi': 0.3084267945138106}
[S4] START round=1 head_norm_before_train=1.170442 (no previous merge yet)
[S4] round=1 local utility u=0.263028 metrics={'f1_val': 0.41333504073689786, 'auprc': 0.6348122201395265, 'loss_val': 1.3259312037490214, 'psi': 0.5019259124979494}-{'f1_val': 0.37011183826466343, 'auprc': 0.5560304366025088, 'loss_val': 1.3563018131872233, 'psi': 0.4444792775998016}
[S5] START round=1 head_norm_before_train=1.169921 (no previous merge yet)
[S5] round=1 local utility u=0.500848 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7721115430057475, 'loss_val': 1.314854690575935, 'psi': 0.39420176005944185}-{'f1_val': 0.14226190476190476, 'auprc': 0.44825747740244837, 'loss_val': 1.344989224533678, 'psi': 0.2646601338181222}
[S6] START round=1 head_norm_before_train=1.179862 (no previous merge yet)
[S6] round=1 local utility u=0.587247 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8233500743096613, 'loss_val': 1.3191615301227293, 'psi': 0.41419579895463376}-{'f1_val': 0.14142628205128205, 'auprc': 0.44286322413551776, 'loss_val': 1.352194917632281, 'psi': 0.2620010588849763}
[S7] START round=1 head_norm_before_train=1.152577 (no previous merge yet)
[S7] round=1 local utility u=0.063375 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.4418325979824994, 'loss_val': 1.315037985708349, 'psi': 0.26196713283045475}-{'f1_val': 0.14205682272909165, 'auprc': 0.4092002194709973, 'loss_val': 1.3438917877595076, 'psi': 0.24891418142585392}
[S8] START round=1 head_norm_before_train=1.184965 (no previous merge yet)
[S8] round=1 local utility u=0.040355 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7937564110151405, 'loss_val': 1.3147393091080073, 'psi': 0.40147615384183055}-{'f1_val': 0.13995598239295717, 'auprc': 0.7768763775674404, 'loss_val': 1.344808345336729, 'psi': 0.3947241404627505}
[S9] START round=1 head_norm_before_train=1.132017 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8835077291718998, 'loss_val': 1.3056786495936603, 'psi': 0.43824186595275755}-{'f1_val': 0.37446688499577585, 'auprc': 0.8483896219392988, 'loss_val': 1.3463068027279763, 'psi': 0.5640359797731851}
[S10] START round=1 head_norm_before_train=1.140417 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6424945237034245, 'loss_val': 1.3284462472480427, 'psi': 0.34017079200640415}-{'f1_val': 0.4156866878103539, 'auprc': 0.527767588504811, 'loss_val': 1.3592314425523293, 'psi': 0.4605190480881367}
[S11] START round=1 head_norm_before_train=1.205089 (no previous merge yet)
[S11] round=1 local utility u=0.178935 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6936200368568066, 'loss_val': 1.3218528957739568, 'psi': 0.361696224766589}-{'f1_val': 0.14041368337311058, 'auprc': 0.5847813072641028, 'loss_val': 1.3532076081185722, 'psi': 0.3181607329295075}
[S13] START round=1 head_norm_before_train=1.228305 (no previous merge yet)
[S13] round=1 local utility u=0.011998 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7196522875973159, 'loss_val': 1.3220158626299863, 'psi': 0.3720923725851582}-{'f1_val': 0.1403857625770531, 'auprc': 0.7222913120501133, 'loss_val': 1.3539292678569557, 'psi': 0.37314798236627716}
[S14] START round=1 head_norm_before_train=1.240736 (no previous merge yet)
[S14] round=1 local utility u=0.323039 metrics={'f1_val': 0.26357516323607294, 'auprc': 0.6775975896675202, 'loss_val': 1.353915188750845, 'psi': 0.42918413380865184}-{'f1_val': 0.23351728460574708, 'auprc': 0.5315939929126935, 'loss_val': 1.381635389000753, 'psi': 0.35274796792852564}
[S15] START round=1 head_norm_before_train=1.179517 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.3896670247536157, 'auprc': 0.7843874362617663, 'loss_val': 1.3162051852893826, 'psi': 0.547555189356876}-{'f1_val': 0.5864677401953707, 'auprc': 0.7907483531240256, 'loss_val': 1.3446284485379087, 'psi': 0.6681799853668327}
[S16] START round=1 head_norm_before_train=1.189628 (no previous merge yet)
[S16] round=1 local utility u=0.656233 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8639905488895471, 'loss_val': 1.3468621267234973, 'psi': 0.4299786896753408}-{'f1_val': 0.0545679012345679, 'auprc': 0.6101439038030624, 'loss_val': 1.381370004059854, 'psi': 0.27679830226196567}
[S17] START round=1 head_norm_before_train=1.142274 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5491200179535649, 'loss_val': 1.3438941926998647, 'psi': 0.3042173851718566}-{'f1_val': 0.34666841522410674, 'auprc': 0.48687673308777707, 'loss_val': 1.3722898431819333, 'psi': 0.4027517423695749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:44604
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S5] → sending delta(kind=head bytes=1784) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S6] → sending delta(kind=head bytes=1786) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S11] → sending delta(kind=head bytes=1787) to S10@127.0.0.1:44611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:44617
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:44609
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:44608
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:44610
[S7] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1787 to 1 peers)
[S6] sending update (kind=head size=1786 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1784 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1789) from S3
[S9] cosine check vs S3: cos=0.0297
[S8] RECEIVED delta(kind=head bytes=1791) from S7
[S8] cosine check vs S7: cos=0.0257
[S5] RECEIVED delta(kind=head bytes=1786) from S6
[S5] cosine check vs S6: cos=0.0618
[S16] RECEIVED delta(kind=head bytes=1789) from S4
[S16] cosine check vs S4: cos=-0.0045
[S16] DROPPED delta from S4 (cos=-0.0045 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1784) from S5
[S4] cosine check vs S5: cos=0.0706
[S4] RECEIVED delta(kind=head bytes=1792) from S8
[S4] cosine check vs S8: cos=-0.0089
[S4] DROPPED delta from S8 (cos=-0.0089 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S13
[S17] cosine check vs S13: cos=0.0861
[S10] RECEIVED delta(kind=head bytes=1787) from S11
[S10] cosine check vs S11: cos=-0.0073
[S10] DROPPED delta from S11 (cos=-0.0073 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1791) from S14
[S8] cosine check vs S14: cos=0.0366
[S7] RECEIVED delta(kind=head bytes=1788) from S16
[S7] cosine check vs S16: cos=-0.0409
[S7] DROPPED delta from S16 (cos=-0.0409 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.149621
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.059904e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.830260 delta_norm=0.805990
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.4133 head_norm=1.184728
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.069916e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.866121 delta_norm=0.806992
[S4] aggregate: ROLLBACK (f1_val pre=0.413 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.199324
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.218332e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.752673 delta_norm=0.721833
[S8] aggregate: ACCEPT kept=['S7', 'S14'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.182887
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.115675e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.863404 delta_norm=0.811568
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.156047
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.128534e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.3601 head_norm=0.885945 delta_norm=0.812853
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.243970 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.21264572387019615, 'auprc': 0.778257763605525, 'loss_val': 1.2519487879205327, 'psi': 0.4388905397643277}-{'f1_val': 0.4160547447484123, 'auprc': 0.77126769254775, 'loss_val': 1.305982689019106, 'psi': 0.5581399238681474}
[S3] START round=2 head_norm_before_train=1.164592 (no previous merge yet)
[S3] round=2 local utility u=0.022634 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9991267757765888, 'loss_val': 1.3128683691956191, 'psi': 0.4835547496790997}-{'f1_val': 0.13984006561410703, 'auprc': 0.9941561503488123, 'loss_val': 1.3432244507555482, 'psi': 0.48156649950798913}
[S4] START round=2 head_norm_before_train=0.866121 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7900192985649226, 'loss_val': 1.3209129120283505, 'psi': 0.40014369676307954}-{'f1_val': 0.41333504073689786, 'auprc': 0.6348122201395265, 'loss_val': 1.3259312037490214, 'psi': 0.5019259124979494}
[S5] START round=2 head_norm_before_train=0.863404 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7411849155071843, 'loss_val': 1.3071612415605014, 'psi': 0.3818311090600166}-{'f1_val': 0.14226190476190476, 'auprc': 0.7721115430057475, 'loss_val': 1.314854690575935, 'psi': 0.39420176005944185}
[S6] START round=2 head_norm_before_train=1.187011 (no previous merge yet)
[S6] round=2 local utility u=0.022739 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8278179788463027, 'loss_val': 1.2870875473680095, 'psi': 0.4159829607692903}-{'f1_val': 0.14142628205128205, 'auprc': 0.8233500743096613, 'loss_val': 1.3191615301227293, 'psi': 0.41419579895463376}
[S7] START round=2 head_norm_before_train=1.171773 (no previous merge yet)
[S7] round=2 local utility u=0.251787 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6000180042594689, 'loss_val': 1.2860203660059135, 'psi': 0.3252412953412426}-{'f1_val': 0.14205682272909165, 'auprc': 0.4418325979824994, 'loss_val': 1.315037985708349, 'psi': 0.26196713283045475}
[S8] START round=2 head_norm_before_train=0.752673 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7769449182549262, 'loss_val': 1.3221462665419346, 'psi': 0.3947515567377448}-{'f1_val': 0.13995598239295717, 'auprc': 0.7937564110151405, 'loss_val': 1.3147393091080073, 'psi': 0.40147615384183055}
[S9] START round=2 head_norm_before_train=0.830260 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.160479 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9919961882419686, 'loss_val': 1.3101866157713133, 'psi': 0.4816372495807851}-{'f1_val': 0.141397957139996, 'auprc': 0.8835077291718998, 'loss_val': 1.3056786495936603, 'psi': 0.43824186595275755}
[S10] START round=2 head_norm_before_train=1.155522 (no previous merge yet)
[S10] round=2 local utility u=0.051850 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6648684080807405, 'loss_val': 1.2918681459045667, 'psi': 0.3491203457573306}-{'f1_val': 0.13862163754172394, 'auprc': 0.6424945237034245, 'loss_val': 1.3284462472480427, 'psi': 0.34017079200640415}
[S11] START round=2 head_norm_before_train=1.217673 (no previous merge yet)
[S11] round=2 local utility u=0.104036 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7499048855274749, 'loss_val': 1.2826347412777694, 'psi': 0.3842101642348563}-{'f1_val': 0.14041368337311058, 'auprc': 0.6936200368568066, 'loss_val': 1.3218528957739568, 'psi': 0.361696224766589}
[S13] START round=2 head_norm_before_train=1.246921 (no previous merge yet)
[S13] round=2 local utility u=0.015220 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7188059922694321, 'loss_val': 1.289036436909869, 'psi': 0.3717538544540047}-{'f1_val': 0.1403857625770531, 'auprc': 0.7196522875973159, 'loss_val': 1.3220158626299863, 'psi': 0.3720923725851582}
[S14] START round=2 head_norm_before_train=1.248243 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8404822725717763, 'loss_val': 1.3246581791237348, 'psi': 0.4204076207583328}-{'f1_val': 0.26357516323607294, 'auprc': 0.6775975896675202, 'loss_val': 1.353915188750845, 'psi': 0.42918413380865184}
[S15] START round=2 head_norm_before_train=1.198249 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7826707288402365, 'loss_val': 1.2795176282990413, 'psi': 0.3969084823530296}-{'f1_val': 0.3896670247536157, 'auprc': 0.7843874362617663, 'loss_val': 1.3162051852893826, 'psi': 0.547555189356876}
[S16] START round=2 head_norm_before_train=1.197816 (no previous merge yet)
[S16] round=2 local utility u=0.018442 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8650545019649587, 'loss_val': 1.313170713990806, 'psi': 0.43040427090550537}-{'f1_val': 0.14063745019920318, 'auprc': 0.8639905488895471, 'loss_val': 1.3468621267234973, 'psi': 0.4299786896753408}
[S17] START round=2 head_norm_before_train=0.885945 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.909184 metrics={'f1_val': 0.39198366286064146, 'auprc': 0.6521442769671459, 'loss_val': 1.3408072413099856, 'psi': 0.4960479085032432}-{'f1_val': 0.14094896331738438, 'auprc': 0.5491200179535649, 'loss_val': 1.3438941926998647, 'psi': 0.3042173851718566}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44615
[S13] not sending this round → trigger blocked (psi=0.372)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.325)
[S6] not sending this round → trigger blocked (psi=0.416)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.384)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.484)
[S16] not sending this round → trigger blocked (psi=0.430)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:44605
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1789 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S9
[S15] cosine check vs S9: cos=0.0372
[S5] RECEIVED delta(kind=head bytes=1789) from S10
[S5] cosine check vs S10: cos=-0.0114
[S5] DROPPED delta from S10 (cos=-0.0114 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44603
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=0.0594
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=1.227411
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.332127e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.759175 delta_norm=0.733213
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=2 metric=0.1398 head_norm=1.184085
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.248428e-01
[S3] stored merged vector for next round verification (round=2)
[S3] DEBUG after merge:  round=2 metric=0.1398 head_norm=0.767738 delta_norm=0.724843
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.273397 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7845154860313659, 'loss_val': 1.1796062136891836, 'psi': 0.3988724744456864}-{'f1_val': 0.21264572387019615, 'auprc': 0.778257763605525, 'loss_val': 1.2519487879205327, 'psi': 0.4388905397643277}
[S3] START round=3 head_norm_before_train=0.767738 cos_to_last_merge=1.0000 (last merge round=2)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9992746254137759, 'loss_val': 1.3159261552376043, 'psi': 0.48361388953397455}-{'f1_val': 0.13984006561410703, 'auprc': 0.9991267757765888, 'loss_val': 1.3128683691956191, 'psi': 0.4835547496790997}
[S4] START round=3 head_norm_before_train=0.884362 cos_to_last_merge=0.9972 (last merge round=1)
[S4] round=3 local utility u=0.012613 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7866472467334538, 'loss_val': 1.2855698564591116, 'psi': 0.398794876030492}-{'f1_val': 0.14022662889518414, 'auprc': 0.7900192985649226, 'loss_val': 1.3209129120283505, 'psi': 0.40014369676307954}
[S5] START round=3 head_norm_before_train=0.882889 cos_to_last_merge=0.9972 (last merge round=1)
[S5] round=3 local utility u=0.003211 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7311875698735187, 'loss_val': 1.2707472454811415, 'psi': 0.37783217080655035}-{'f1_val': 0.14226190476190476, 'auprc': 0.7411849155071843, 'loss_val': 1.3071612415605014, 'psi': 0.3818311090600166}
[S6] START round=3 head_norm_before_train=1.204533 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6498319870174505, 'loss_val': 1.2554609286796277, 'psi': 0.34478856403774943}-{'f1_val': 0.14142628205128205, 'auprc': 0.8278179788463027, 'loss_val': 1.2870875473680095, 'psi': 0.4159829607692903}
[S7] START round=3 head_norm_before_train=1.195266 (no previous merge yet)
[S7] round=3 local utility u=0.244595 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7535842753152039, 'loss_val': 1.257528180495102, 'psi': 0.38666780376353654}-{'f1_val': 0.14205682272909165, 'auprc': 0.6000180042594689, 'loss_val': 1.2860203660059135, 'psi': 0.3252412953412426}
[S8] START round=3 head_norm_before_train=0.769206 cos_to_last_merge=0.9957 (last merge round=1)
[S8] round=3 local utility u=0.018360 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.777019922073989, 'loss_val': 1.2856504021349282, 'psi': 0.3947815582653699}-{'f1_val': 0.13995598239295717, 'auprc': 0.7769449182549262, 'loss_val': 1.3221462665419346, 'psi': 0.3947515567377448}
[S9] START round=3 head_norm_before_train=0.849327 cos_to_last_merge=0.9964 (last merge round=1)
[S9] round=3 local utility u=0.039145 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9998623011838731, 'loss_val': 1.2554949921225234, 'psi': 0.48478369475754685}-{'f1_val': 0.141397957139996, 'auprc': 0.9919961882419686, 'loss_val': 1.3101866157713133, 'psi': 0.4816372495807851}
[S10] START round=3 head_norm_before_train=1.179542 (no previous merge yet)
[S10] round=3 local utility u=0.021424 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6641645277735425, 'loss_val': 1.2469079719973168, 'psi': 0.34883879363445136}-{'f1_val': 0.13862163754172394, 'auprc': 0.6648684080807405, 'loss_val': 1.2918681459045667, 'psi': 0.3491203457573306}
[S11] START round=3 head_norm_before_train=1.242199 (no previous merge yet)
[S11] round=3 local utility u=0.029414 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7517410403242724, 'loss_val': 1.2293158411331522, 'psi': 0.38494462615357533}-{'f1_val': 0.14041368337311058, 'auprc': 0.7499048855274749, 'loss_val': 1.2826347412777694, 'psi': 0.3842101642348563}
[S13] START round=3 head_norm_before_train=1.273063 (no previous merge yet)
[S13] round=3 local utility u=0.005895 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7118580661459586, 'loss_val': 1.2564024413707602, 'psi': 0.3689746840046153}-{'f1_val': 0.1403857625770531, 'auprc': 0.7188059922694321, 'loss_val': 1.289036436909869, 'psi': 0.3717538544540047}
[S14] START round=3 head_norm_before_train=1.267380 (no previous merge yet)
[S14] round=3 local utility u=0.033420 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8511792152305238, 'loss_val': 1.289908080752926, 'psi': 0.42468639782183176}-{'f1_val': 0.14035785288270378, 'auprc': 0.8404822725717763, 'loss_val': 1.3246581791237348, 'psi': 0.4204076207583328}
[S15] START round=3 head_norm_before_train=0.759175 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7837449275083813, 'loss_val': 1.2908147744775935, 'psi': 0.3973381618202875}-{'f1_val': 0.13973365136155833, 'auprc': 0.7826707288402365, 'loss_val': 1.2795176282990413, 'psi': 0.3969084823530296}
[S16] START round=3 head_norm_before_train=1.214071 (no previous merge yet)
[S16] round=3 local utility u=0.020027 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.865527392592, 'loss_val': 1.274535679641109, 'psi': 0.4305934271563219}-{'f1_val': 0.14063745019920318, 'auprc': 0.8650545019649587, 'loss_val': 1.313170713990806, 'psi': 0.43040427090550537}
[S17] START round=3 head_norm_before_train=0.909714 cos_to_last_merge=0.9969 (last merge round=1)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7078592541830498, 'loss_val': 1.3000781744838743, 'psi': 0.3677130796636506}-{'f1_val': 0.39198366286064146, 'auprc': 0.6521442769671459, 'loss_val': 1.3408072413099856, 'psi': 0.4960479085032432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:44610
[S10] not sending this round → trigger blocked (psi=0.349)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:44615
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:44605
[S9] not sending this round → trigger blocked (psi=0.485)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S15@127.0.0.1:44615
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1788 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1789) from S5
[S9] cosine check vs S5: cos=0.0853
[S5] RECEIVED delta(kind=head bytes=1794) from S4
[S5] cosine check vs S4: cos=0.5248
[S16] RECEIVED delta(kind=head bytes=1796) from S7
[S16] cosine check vs S7: cos=-0.0286
[S16] DROPPED delta from S7 (cos=-0.0286 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S8
[S4] cosine check vs S8: cos=-0.0206
[S4] DROPPED delta from S8 (cos=-0.0206 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S11
[S16] cosine check vs S11: cos=0.0097
[S14] RECEIVED delta(kind=head bytes=1792) from S13
[S14] cosine check vs S13: cos=-0.0955
[S14] DROPPED delta from S13 (cos=-0.0955 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1788) from S16
[S15] cosine check vs S16: cos=-0.0427
[S15] DROPPED delta from S16 (cos=-0.0427 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S14
[S15] cosine check vs S14: cos=-0.0378
[S15] DROPPED delta from S14 (cos=-0.0378 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=0.877077
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.053293e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.659335 delta_norm=0.605329
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=0.912704
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.442979e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.795920 delta_norm=0.444298
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.236703
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.846274e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.893279 delta_norm=0.884627
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.310046 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7490690035076114, 'loss_val': 1.1330723594809136, 'psi': 0.3846938814361846}-{'f1_val': 0.1417771333885667, 'auprc': 0.7845154860313659, 'loss_val': 1.1796062136891836, 'psi': 0.3988724744456864}
[S3] START round=4 head_norm_before_train=0.791261 cos_to_last_merge=0.9964 (last merge round=2)
[S3] round=4 local utility u=0.023226 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9992270199426605, 'loss_val': 1.269332034096085, 'psi': 0.4835948473455285}-{'f1_val': 0.13984006561410703, 'auprc': 0.9992746254137759, 'loss_val': 1.3159261552376043, 'psi': 0.48361388953397455}
[S4] START round=4 head_norm_before_train=0.910358 cos_to_last_merge=0.9899 (last merge round=1)
[S4] round=4 local utility u=0.029887 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7861736621539761, 'loss_val': 1.22437462942665, 'psi': 0.3986054421987009}-{'f1_val': 0.14022662889518414, 'auprc': 0.7866472467334538, 'loss_val': 1.2855698564591116, 'psi': 0.398794876030492}
[S5] START round=4 head_norm_before_train=0.795920 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.005829 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.726879347519917, 'loss_val': 1.2461641529998466, 'psi': 0.37610888186510966}-{'f1_val': 0.14226190476190476, 'auprc': 0.7311875698735187, 'loss_val': 1.2707472454811415, 'psi': 0.37783217080655035}
[S6] START round=4 head_norm_before_train=1.228771 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6218161849104488, 'loss_val': 1.2306861106080778, 'psi': 0.3335822431949487}-{'f1_val': 0.14142628205128205, 'auprc': 0.6498319870174505, 'loss_val': 1.2554609286796277, 'psi': 0.34478856403774943}
[S7] START round=4 head_norm_before_train=1.219694 (no previous merge yet)
[S7] round=4 local utility u=0.057331 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7808663502433216, 'loss_val': 1.2247126138619848, 'psi': 0.39758063373478364}-{'f1_val': 0.14205682272909165, 'auprc': 0.7535842753152039, 'loss_val': 1.257528180495102, 'psi': 0.38666780376353654}
[S8] START round=4 head_norm_before_train=0.796584 cos_to_last_merge=0.9845 (last merge round=1)
[S8] round=4 local utility u=0.022218 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.777071135331304, 'loss_val': 1.241368378912044, 'psi': 0.39480204356829596}-{'f1_val': 0.13995598239295717, 'auprc': 0.777019922073989, 'loss_val': 1.2856504021349282, 'psi': 0.3947815582653699}
[S9] START round=4 head_norm_before_train=0.659335 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9895861704851795, 'loss_val': 1.2372643828840881, 'psi': 0.4806732424780694}-{'f1_val': 0.141397957139996, 'auprc': 0.9998623011838731, 'loss_val': 1.2554949921225234, 'psi': 0.48478369475754685}
[S10] START round=4 head_norm_before_train=1.210311 (no previous merge yet)
[S10] round=4 local utility u=0.024710 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6645578668377534, 'loss_val': 1.1986670821594323, 'psi': 0.34899612926013573}-{'f1_val': 0.13862163754172394, 'auprc': 0.6641645277735425, 'loss_val': 1.2469079719973168, 'psi': 0.34883879363445136}
[S11] START round=4 head_norm_before_train=1.277338 (no previous merge yet)
[S11] round=4 local utility u=0.041086 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7549190307639503, 'loss_val': 1.1566779707383545, 'psi': 0.38621582232944646}-{'f1_val': 0.14041368337311058, 'auprc': 0.7517410403242724, 'loss_val': 1.2293158411331522, 'psi': 0.38494462615357533}
[S13] START round=4 head_norm_before_train=1.306749 (no previous merge yet)
[S13] round=4 local utility u=0.007935 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7071503462246347, 'loss_val': 1.2264095379518964, 'psi': 0.3670915960360857}-{'f1_val': 0.1403857625770531, 'auprc': 0.7118580661459586, 'loss_val': 1.2564024413707602, 'psi': 0.3689746840046153}
[S14] START round=4 head_norm_before_train=1.295990 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8369168497734543, 'loss_val': 1.247898872782225, 'psi': 0.41898145163900397}-{'f1_val': 0.14035785288270378, 'auprc': 0.8511792152305238, 'loss_val': 1.289908080752926, 'psi': 0.42468639782183176}
[S15] START round=4 head_norm_before_train=0.789509 cos_to_last_merge=0.9968 (last merge round=2)
[S15] round=4 local utility u=0.012454 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7760568792980299, 'loss_val': 1.2428428258085147, 'psi': 0.39426294253614697}-{'f1_val': 0.13973365136155833, 'auprc': 0.7837449275083813, 'loss_val': 1.2908147744775935, 'psi': 0.3973381618202875}
[S16] START round=4 head_norm_before_train=0.893279 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8136909349659069, 'loss_val': 1.269628223552639, 'psi': 0.4098588441058847}-{'f1_val': 0.14063745019920318, 'auprc': 0.865527392592, 'loss_val': 1.274535679641109, 'psi': 0.4305934271563219}
[S17] START round=4 head_norm_before_train=0.940557 cos_to_last_merge=0.9882 (last merge round=1)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6494065219850347, 'loss_val': 1.2434699801510989, 'psi': 0.3443319867844445}-{'f1_val': 0.14094896331738438, 'auprc': 0.7078592541830498, 'loss_val': 1.3000781744838743, 'psi': 0.3677130796636506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44609
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.367)
[S11] not sending this round → trigger blocked (psi=0.386)
[S4] not sending this round → trigger blocked (psi=0.399)
[S5] not sending this round → trigger blocked (psi=0.376)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.398)
[S8] not sending this round → trigger blocked (psi=0.395)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:44610
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:44614
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1792) from S3
[S14] cosine check vs S3: cos=-0.0225
[S14] DROPPED delta from S3 (cos=-0.0225 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1788) from S10
[S9] cosine check vs S10: cos=-0.0661
[S9] DROPPED delta from S10 (cos=-0.0661 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] cosine check vs S15: cos=-0.0549
[S8] DROPPED delta from S15 (cos=-0.0549 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.342673 (no previous merge yet)
[S2] round=5 local utility u=0.873610 metrics={'f1_val': 0.4036741147907813, 'auprc': 0.7833711786749464, 'loss_val': 1.0601405521098375, 'psi': 0.5555529403444474}-{'f1_val': 0.1417771333885667, 'auprc': 0.7490690035076114, 'loss_val': 1.1330723594809136, 'psi': 0.3846938814361846}
[S3] START round=5 head_norm_before_train=0.821764 cos_to_last_merge=0.9877 (last merge round=2)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7511200623857373, 'loss_val': 1.2083542002661658, 'psi': 0.38435206432275915}-{'f1_val': 0.13984006561410703, 'auprc': 0.9992270199426605, 'loss_val': 1.269332034096085, 'psi': 0.4835948473455285}
[S4] START round=5 head_norm_before_train=0.948592 cos_to_last_merge=0.9786 (last merge round=1)
[S4] round=5 local utility u=0.028185 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7682360430909562, 'loss_val': 1.1141922897421677, 'psi': 0.391430394573493}-{'f1_val': 0.14022662889518414, 'auprc': 0.7861736621539761, 'loss_val': 1.22437462942665, 'psi': 0.3986054421987009}
[S5] START round=5 head_norm_before_train=0.831132 cos_to_last_merge=0.9971 (last merge round=3)
[S5] round=5 local utility u=0.034573 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7364122911461886, 'loss_val': 1.2056165608630662, 'psi': 0.3799220593156183}-{'f1_val': 0.14226190476190476, 'auprc': 0.726879347519917, 'loss_val': 1.2461641529998466, 'psi': 0.37610888186510966}
[S6] START round=5 head_norm_before_train=1.255379 (no previous merge yet)
[S6] round=5 local utility u=0.056775 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6425352155951499, 'loss_val': 1.1792930471685257, 'psi': 0.3418698554688292}-{'f1_val': 0.14142628205128205, 'auprc': 0.6218161849104488, 'loss_val': 1.2306861106080778, 'psi': 0.3335822431949487}
[S7] START round=5 head_norm_before_train=1.245350 (no previous merge yet)
[S7] round=5 local utility u=0.011555 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7716874127858229, 'loss_val': 1.1740656020853468, 'psi': 0.39390905875178417}-{'f1_val': 0.14205682272909165, 'auprc': 0.7808663502433216, 'loss_val': 1.2247126138619848, 'psi': 0.39758063373478364}
[S8] START round=5 head_norm_before_train=0.829393 cos_to_last_merge=0.9702 (last merge round=1)
[S8] round=5 local utility u=0.032139 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7771100206553604, 'loss_val': 1.177207086383642, 'psi': 0.3948175976979185}-{'f1_val': 0.13995598239295717, 'auprc': 0.777071135331304, 'loss_val': 1.241368378912044, 'psi': 0.39480204356829596}
[S9] START round=5 head_norm_before_train=0.689503 cos_to_last_merge=0.9943 (last merge round=3)
[S9] round=5 local utility u=0.054845 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9943356123339201, 'loss_val': 1.141822092807268, 'psi': 0.4825730192175657}-{'f1_val': 0.141397957139996, 'auprc': 0.9895861704851795, 'loss_val': 1.2372643828840881, 'psi': 0.4806732424780694}
[S10] START round=5 head_norm_before_train=1.237390 (no previous merge yet)
[S10] round=5 local utility u=0.099334 metrics={'f1_val': 0.15663557053117205, 'auprc': 0.6646991321529934, 'loss_val': 1.1085061796727445, 'psi': 0.35986099517990056}-{'f1_val': 0.13862163754172394, 'auprc': 0.6645578668377534, 'loss_val': 1.1986670821594323, 'psi': 0.34899612926013573}
[S11] START round=5 head_norm_before_train=1.320869 (no previous merge yet)
[S11] round=5 local utility u=0.974668 metrics={'f1_val': 0.42273739039721175, 'auprc': 0.7962270804804423, 'loss_val': 1.0252089739537518, 'psi': 0.572133266430504}-{'f1_val': 0.14041368337311058, 'auprc': 0.7549190307639503, 'loss_val': 1.1566779707383545, 'psi': 0.38621582232944646}
[S13] START round=5 head_norm_before_train=1.327141 (no previous merge yet)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5825429183623068, 'loss_val': 1.1854314082076918, 'psi': 0.3172486248911546}-{'f1_val': 0.1403857625770531, 'auprc': 0.7071503462246347, 'loss_val': 1.2264095379518964, 'psi': 0.3670915960360857}
[S14] START round=5 head_norm_before_train=1.332763 (no previous merge yet)
[S14] round=5 local utility u=0.045407 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8487925630697833, 'loss_val': 1.1927115813246283, 'psi': 0.42373173695753563}-{'f1_val': 0.14035785288270378, 'auprc': 0.8369168497734543, 'loss_val': 1.247898872782225, 'psi': 0.41898145163900397}
[S15] START round=5 head_norm_before_train=0.827152 cos_to_last_merge=0.9882 (last merge round=2)
[S15] round=5 local utility u=0.026121 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7769805091671467, 'loss_val': 1.1933715545874102, 'psi': 0.39463239448379367}-{'f1_val': 0.13973365136155833, 'auprc': 0.7760568792980299, 'loss_val': 1.2428428258085147, 'psi': 0.39426294253614697}
[S16] START round=5 head_norm_before_train=0.919129 cos_to_last_merge=0.9970 (last merge round=3)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7638855632501531, 'loss_val': 1.229524820157568, 'psi': 0.3899366954195832}-{'f1_val': 0.14063745019920318, 'auprc': 0.8136909349659069, 'loss_val': 1.269628223552639, 'psi': 0.4098588441058847}
[S17] START round=5 head_norm_before_train=0.976463 cos_to_last_merge=0.9764 (last merge round=1)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5828559072855032, 'loss_val': 1.1633173235465184, 'psi': 0.31771174090463195}-{'f1_val': 0.14094896331738438, 'auprc': 0.6494065219850347, 'loss_val': 1.2434699801510989, 'psi': 0.3443319867844445}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44615
[S10] not sending this round → trigger blocked (psi=0.360)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:44616
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:44605
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.395)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[S7] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] cosine check vs S6: cos=0.0516
[S4] RECEIVED delta(kind=head bytes=1792) from S8
[S4] cosine check vs S8: cos=-0.0090
[S4] DROPPED delta from S8 (cos=-0.0090 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1790) from S5
[S9] cosine check vs S5: cos=0.5999
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=-0.0187
[S15] DROPPED delta from S14 (cos=-0.0187 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1789) from S4
[S5] cosine check vs S4: cos=0.8310
[S16] RECEIVED delta(kind=head bytes=1794) from S7
[S16] cosine check vs S7: cos=0.0193
[S16] RECEIVED delta(kind=head bytes=1793) from S2
[S16] cosine check vs S2: cos=-0.0080
[S16] DROPPED delta from S2 (cos=-0.0080 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S11
[S16] cosine check vs S11: cos=0.6712
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=-0.0069
[S14] DROPPED delta from S9 (cos=-0.0069 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.360 → S9@127.0.0.1:44610
[S13] ⇄ pheromone p=0.332 → S14@127.0.0.1:44614
[S15] ⇄ pheromone p=0.335 → S8@127.0.0.1:44609
[S3] ⇄ pheromone p=0.388 → S14@127.0.0.1:44614
[S6] ⇄ pheromone p=0.389 → S4@127.0.0.1:44604
[S11] ⇄ pheromone p=0.558 → S16@127.0.0.1:44616
[S8] ⇄ pheromone p=0.343 → S4@127.0.0.1:44604
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.731059
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.588766e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.709623 delta_norm=0.358877
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.360 → S14@127.0.0.1:44614
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.854556
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.774342e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.885669 delta_norm=0.277434
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.377 → S9@127.0.0.1:44610
[S7] ⇄ pheromone p=0.401 → S16@127.0.0.1:44616
[S2] ⇄ pheromone p=0.502 → S16@127.0.0.1:44616
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.1402 head_norm=0.996239
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.883742e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.4144 head_norm=0.828869 delta_norm=0.788374
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.361 → S5@127.0.0.1:44605
[S14] ⇄ pheromone p=0.368 → S15@127.0.0.1:44615
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.949537
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.782636e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.820775 delta_norm=0.478264
[S16] aggregate: ACCEPT kept=['S7', 'S11'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.386 → S15@127.0.0.1:44615
[S17] ⇄ pheromone p=0.421 → S16@127.0.0.1:44616
[S2] START round=6 head_norm_before_train=1.363589 (no previous merge yet)
[S2] round=6 local utility u=0.087320 metrics={'f1_val': 0.41668780995073934, 'auprc': 0.7834952958371681, 'loss_val': 0.963955099307049, 'psi': 0.5634108043053109}-{'f1_val': 0.4036741147907813, 'auprc': 0.7833711786749464, 'loss_val': 1.0601405521098375, 'psi': 0.5555529403444474}
[S3] START round=6 head_norm_before_train=0.863087 cos_to_last_merge=0.9749 (last merge round=2)
[S3] round=6 local utility u=0.205419 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8565196582965482, 'loss_val': 1.113715826717929, 'psi': 0.4265119026870835}-{'f1_val': 0.13984006561410703, 'auprc': 0.7511200623857373, 'loss_val': 1.2083542002661658, 'psi': 0.38435206432275915}
[S4] START round=6 head_norm_before_train=0.828869 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.836317 metrics={'f1_val': 0.4129160358681728, 'auprc': 0.7701413654983084, 'loss_val': 1.083411585608347, 'psi': 0.5558061677202271}-{'f1_val': 0.14022662889518414, 'auprc': 0.7682360430909562, 'loss_val': 1.1141922897421677, 'psi': 0.391430394573493}
[S5] START round=6 head_norm_before_train=0.885669 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.295547 metrics={'f1_val': 0.2157544352666304, 'auprc': 0.7711167457999222, 'loss_val': 1.1595914803339167, 'psi': 0.4378993594799472}-{'f1_val': 0.14226190476190476, 'auprc': 0.7364122911461886, 'loss_val': 1.2056165608630662, 'psi': 0.3799220593156183}
[S6] START round=6 head_norm_before_train=1.274607 (no previous merge yet)
[S6] round=6 local utility u=0.699439 metrics={'f1_val': 0.3619308476775872, 'auprc': 0.6442835493010055, 'loss_val': 1.108688304918049, 'psi': 0.4748719283269546}-{'f1_val': 0.14142628205128205, 'auprc': 0.6425352155951499, 'loss_val': 1.1792930471685257, 'psi': 0.3418698554688292}
[S7] START round=6 head_norm_before_train=1.267896 (no previous merge yet)
[S7] round=6 local utility u=0.612186 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.5991520332707745, 'loss_val': 1.080994219744203, 'psi': 0.4897856530410853}-{'f1_val': 0.14205682272909165, 'auprc': 0.7716874127858229, 'loss_val': 1.1740656020853468, 'psi': 0.39390905875178417}
[S8] START round=6 head_norm_before_train=0.869411 cos_to_last_merge=0.9550 (last merge round=1)
[S8] round=6 local utility u=0.138072 metrics={'f1_val': 0.17057585808294107, 'auprc': 0.7769424679315672, 'loss_val': 1.0842804623386249, 'psi': 0.41312250202239154}-{'f1_val': 0.13995598239295717, 'auprc': 0.7771100206553604, 'loss_val': 1.177207086383642, 'psi': 0.3948175976979185}
[S9] START round=6 head_norm_before_train=0.709623 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.862650 metrics={'f1_val': 0.41637066856105454, 'auprc': 0.9967419693526405, 'loss_val': 1.073576708265977, 'psi': 0.6485191888776889}-{'f1_val': 0.141397957139996, 'auprc': 0.9943356123339201, 'loss_val': 1.141822092807268, 'psi': 0.4825730192175657}
[S10] START round=6 head_norm_before_train=1.263536 (no previous merge yet)
[S10] round=6 local utility u=0.861546 metrics={'f1_val': 0.4170758964666951, 'auprc': 0.6647150624939446, 'loss_val': 0.9481030802697303, 'psi': 0.5161315628775949}-{'f1_val': 0.15663557053117205, 'auprc': 0.6646991321529934, 'loss_val': 1.1085061796727445, 'psi': 0.35986099517990056}
[S11] START round=6 head_norm_before_train=1.359895 (no previous merge yet)
[S11] round=6 local utility u=0.368313 metrics={'f1_val': 0.4118794218117219, 'auprc': 0.9990388793803927, 'loss_val': 0.831870613602904, 'psi': 0.6467432048391902}-{'f1_val': 0.42273739039721175, 'auprc': 0.7962270804804423, 'loss_val': 1.0252089739537518, 'psi': 0.572133266430504}
[S13] START round=6 head_norm_before_train=1.341856 (no previous merge yet)
[S13] round=6 local utility u=1.000000 metrics={'f1_val': 0.6799307660649095, 'auprc': 0.5711733790669091, 'loss_val': 1.1092067870959994, 'psi': 0.6364278112657094}-{'f1_val': 0.1403857625770531, 'auprc': 0.5825429183623068, 'loss_val': 1.1854314082076918, 'psi': 0.3172486248911546}
[S14] START round=6 head_norm_before_train=1.371759 (no previous merge yet)
[S14] round=6 local utility u=0.926779 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9166036858330238, 'loss_val': 1.0798031023933583, 'psi': 0.6045777957194045}-{'f1_val': 0.14035785288270378, 'auprc': 0.8487925630697833, 'loss_val': 1.1927115813246283, 'psi': 0.42373173695753563}
[S15] START round=6 head_norm_before_train=0.857634 cos_to_last_merge=0.9806 (last merge round=2)
[S15] round=6 local utility u=0.877345 metrics={'f1_val': 0.4161838404121786, 'auprc': 0.7770548831243618, 'loss_val': 1.0976049128474585, 'psi': 0.5605322574970518}-{'f1_val': 0.13973365136155833, 'auprc': 0.7769805091671467, 'loss_val': 1.1933715545874102, 'psi': 0.39463239448379367}
[S16] START round=6 head_norm_before_train=0.820775 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.760126 metrics={'f1_val': 0.4134932501534813, 'auprc': 0.7215254731727481, 'loss_val': 1.2193264431860824, 'psi': 0.536706139361188}-{'f1_val': 0.14063745019920318, 'auprc': 0.7638855632501531, 'loss_val': 1.229524820157568, 'psi': 0.3899366954195832}
[S17] START round=6 head_norm_before_train=1.012581 cos_to_last_merge=0.9636 (last merge round=1)
[S17] round=6 local utility u=0.915605 metrics={'f1_val': 0.3821866209942525, 'auprc': 0.6716861974109667, 'loss_val': 1.046025115928415, 'psi': 0.4979864515609381}-{'f1_val': 0.14094896331738438, 'auprc': 0.5828559072855032, 'loss_val': 1.1633173235465184, 'psi': 0.31771174090463195}
[S8] not sending this round → trigger blocked (psi=0.413)
[S6] not sending this round → trigger blocked (psi=0.475)
[S5] not sending this round → trigger blocked (psi=0.438)
[S14] not sending this round → trigger blocked (psi=0.605)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S3] → sending delta(kind=head bytes=1788) to S14@127.0.0.1:44614
[S9] not sending this round → trigger blocked (psi=0.649)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:44610
[S7] not sending this round → trigger blocked (psi=0.490)
[S4] not sending this round → trigger blocked (psi=0.556)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44609
[S11] not sending this round → trigger blocked (psi=0.647)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44615
[S2] not sending this round → trigger blocked (psi=0.563)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44614
[S13] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1788 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1788) from S3
[S14] cosine check vs S3: cos=-0.0196
[S14] DROPPED delta from S3 (cos=-0.0196 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S15
[S8] cosine check vs S15: cos=-0.0471
[S8] DROPPED delta from S15 (cos=-0.0471 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S10
[S9] cosine check vs S10: cos=-0.0418
[S9] DROPPED delta from S10 (cos=-0.0418 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S13
[S14] cosine check vs S13: cos=-0.1055
[S14] DROPPED delta from S13 (cos=-0.1055 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S16
[S15] cosine check vs S16: cos=0.0388
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1790 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1790) from S17
[S16] cosine check vs S17: cos=-0.0521
[S16] DROPPED delta from S17 (cos=-0.0521 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.4162 head_norm=0.894362
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.035751e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.1397 head_norm=0.627451 delta_norm=0.603575
[S15] aggregate: ROLLBACK (f1_val pre=0.416 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.392644 (no previous merge yet)
[S2] round=7 local utility u=0.043742 metrics={'f1_val': 0.416730483187428, 'auprc': 0.7717908256766265, 'loss_val': 0.8416132329001234, 'psi': 0.5587546201831074}-{'f1_val': 0.41668780995073934, 'auprc': 0.7834952958371681, 'loss_val': 0.963955099307049, 'psi': 0.5634108043053109}
[S3] START round=7 head_norm_before_train=0.899430 cos_to_last_merge=0.9631 (last merge round=2)
[S3] round=7 local utility u=0.810980 metrics={'f1_val': 0.39642092198300777, 'auprc': 0.835481116941262, 'loss_val': 0.9681244840270442, 'psi': 0.5720449999663095}-{'f1_val': 0.13984006561410703, 'auprc': 0.8565196582965482, 'loss_val': 1.113715826717929, 'psi': 0.4265119026870835}
[S4] START round=7 head_norm_before_train=0.866369 cos_to_last_merge=0.9960 (last merge round=5)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.37500660758238213, 'auprc': 0.7516696939395489, 'loss_val': 0.9113479951722939, 'psi': 0.5256718421252489}-{'f1_val': 0.4129160358681728, 'auprc': 0.7701413654983084, 'loss_val': 1.083411585608347, 'psi': 0.5558061677202271}
[S5] START round=7 head_norm_before_train=0.905628 cos_to_last_merge=0.9979 (last merge round=5)
[S5] round=7 local utility u=0.667988 metrics={'f1_val': 0.41754956401939425, 'auprc': 0.7777810143953306, 'loss_val': 1.0543784677735581, 'psi': 0.5616421441697688}-{'f1_val': 0.2157544352666304, 'auprc': 0.7711167457999222, 'loss_val': 1.1595914803339167, 'psi': 0.4378993594799472}
[S6] START round=7 head_norm_before_train=1.295092 (no previous merge yet)
[S6] round=7 local utility u=0.208760 metrics={'f1_val': 0.37725537497254924, 'auprc': 0.7113668867640734, 'loss_val': 0.9843651879585665, 'psi': 0.5108999796891589}-{'f1_val': 0.3619308476775872, 'auprc': 0.6442835493010055, 'loss_val': 1.108688304918049, 'psi': 0.4748719283269546}
[S7] START round=7 head_norm_before_train=1.288490 (no previous merge yet)
[S7] round=7 local utility u=0.057251 metrics={'f1_val': 0.4172381946317165, 'auprc': 0.5940609294506419, 'loss_val': 0.9534004491210203, 'psi': 0.4879672885592867}-{'f1_val': 0.4168747328879592, 'auprc': 0.5991520332707745, 'loss_val': 1.080994219744203, 'psi': 0.4897856530410853}
[S8] START round=7 head_norm_before_train=0.909410 cos_to_last_merge=0.9406 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.941
[S8] round=7 local utility u=1.000000 metrics={'f1_val': 0.7156066922694875, 'auprc': 0.777108093625966, 'loss_val': 0.9697976235121433, 'psi': 0.7402072528120789}-{'f1_val': 0.17057585808294107, 'auprc': 0.7769424679315672, 'loss_val': 1.0842804623386249, 'psi': 0.41312250202239154}
[S9] START round=7 head_norm_before_train=0.745319 cos_to_last_merge=0.9945 (last merge round=5)
[S9] round=7 local utility u=0.108348 metrics={'f1_val': 0.41697558078303143, 'auprc': 0.9980830153573592, 'loss_val': 0.8645342061672073, 'psi': 0.6494185546127625}-{'f1_val': 0.41637066856105454, 'auprc': 0.9967419693526405, 'loss_val': 1.073576708265977, 'psi': 0.6485191888776889}
[S10] START round=7 head_norm_before_train=1.295034 (no previous merge yet)
[S10] round=7 local utility u=1.000000 metrics={'f1_val': 0.6981607225861814, 'auprc': 0.788730889930702, 'loss_val': 0.7815692847493718, 'psi': 0.7343887895239897}-{'f1_val': 0.4170758964666951, 'auprc': 0.6647150624939446, 'loss_val': 0.9481030802697303, 'psi': 0.5161315628775949}
[S11] START round=7 head_norm_before_train=1.406566 (no previous merge yet)
[S11] round=7 local utility u=0.038580 metrics={'f1_val': 0.3917979913796843, 'auprc': 0.9994267858062966, 'loss_val': 0.6353848264494859, 'psi': 0.6348495091503292}-{'f1_val': 0.4118794218117219, 'auprc': 0.9990388793803927, 'loss_val': 0.831870613602904, 'psi': 0.6467432048391902}
[S13] START round=7 head_norm_before_train=1.366787 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.4163965282706411, 'auprc': 0.6071603496785967, 'loss_val': 0.9671432407143844, 'psi': 0.49270205683382334}-{'f1_val': 0.6799307660649095, 'auprc': 0.5711733790669091, 'loss_val': 1.1092067870959994, 'psi': 0.6364278112657094}
[S14] START round=7 head_norm_before_train=1.407758 (no previous merge yet)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.7015742629936279, 'auprc': 0.9986503916912213, 'loss_val': 0.8955609476780099, 'psi': 0.8204047144726653}-{'f1_val': 0.39656053564365834, 'auprc': 0.9166036858330238, 'loss_val': 1.0798031023933583, 'psi': 0.6045777957194045}
[S15] START round=7 head_norm_before_train=0.627451 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.020799 metrics={'f1_val': 0.4167593395843331, 'auprc': 0.7770527340695466, 'loss_val': 1.059453048106657, 'psi': 0.5608766973784185}-{'f1_val': 0.4161838404121786, 'auprc': 0.7770548831243618, 'loss_val': 1.0976049128474585, 'psi': 0.5605322574970518}
[S16] START round=7 head_norm_before_train=0.846235 cos_to_last_merge=0.9968 (last merge round=5)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.41683695810830534, 'auprc': 0.5246076188849703, 'loss_val': 1.1195459301331259, 'psi': 0.45994522241897134}-{'f1_val': 0.4134932501534813, 'auprc': 0.7215254731727481, 'loss_val': 1.2193264431860824, 'psi': 0.536706139361188}
[S17] START round=7 head_norm_before_train=1.050040 cos_to_last_merge=0.9510 (last merge round=1)
[S17] round=7 local utility u=0.312858 metrics={'f1_val': 0.39129266205198276, 'auprc': 0.8156948081598099, 'loss_val': 0.9069717872998498, 'psi': 0.5610535204951136}-{'f1_val': 0.3821866209942525, 'auprc': 0.6716861974109667, 'loss_val': 1.046025115928415, 'psi': 0.4979864515609381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S8] → sending delta(kind=head bytes=1786) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:44604
[S3] not sending this round → trigger blocked (psi=0.572)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[S10] not sending this round → trigger blocked (psi=0.734)
[S15] not sending this round → trigger blocked (psi=0.561)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1786 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] cosine check vs S14: cos=0.0050
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=0.0138
[S4] RECEIVED delta(kind=head bytes=1786) from S8
[S4] cosine check vs S8: cos=0.0459
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.7652
[S4] RECEIVED delta(kind=head bytes=1794) from S6
[S4] cosine check vs S6: cos=0.7205
[S16] RECEIVED delta(kind=head bytes=1795) from S2
[S16] cosine check vs S2: cos=-0.0451
[S16] DROPPED delta from S2 (cos=-0.0451 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] cosine check vs S11: cos=0.7609
[S16] RECEIVED delta(kind=head bytes=1797) from S7
[S16] cosine check vs S7: cos=0.3928
[S17] not sending this round → trigger blocked (psi=0.561)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.4168 head_norm=0.668681
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.976543e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.4170 head_norm=0.800715 delta_norm=0.797654
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.3750 head_norm=0.913023
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.934238e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.3759 head_norm=0.781555 delta_norm=0.393424
[S4] aggregate: ACCEPT kept=['S8', 'S6'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.4170 head_norm=0.793767
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.048119e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.4160 head_norm=0.814647 delta_norm=0.304812
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.7016 head_norm=1.451778
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.224937e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.3966 head_norm=0.832086 delta_norm=0.822494
[S14] aggregate: ROLLBACK (f1_val pre=0.702 post=0.397 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4168 head_norm=0.882936
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.960234e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4168 head_norm=0.898333 delta_norm=0.296023
[S16] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.433060 (no previous merge yet)
[S2] round=8 local utility u=0.831740 metrics={'f1_val': 0.6566229430060229, 'auprc': 0.8007727011263581, 'loss_val': 0.7044345579581305, 'psi': 0.7142828462541571}-{'f1_val': 0.416730483187428, 'auprc': 0.7717908256766265, 'loss_val': 0.8416132329001234, 'psi': 0.5587546201831074}
[S3] START round=8 head_norm_before_train=0.934807 cos_to_last_merge=0.9516 (last merge round=2)
[S3] round=8 local utility u=0.264340 metrics={'f1_val': 0.4009668676591264, 'auprc': 0.9606064663376256, 'loss_val': 0.8420964707239545, 'psi': 0.6248227071305261}-{'f1_val': 0.39642092198300777, 'auprc': 0.835481116941262, 'loss_val': 0.9681244840270442, 'psi': 0.5720449999663095}
[S4] START round=8 head_norm_before_train=0.781555 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.212963 metrics={'f1_val': 0.3745847099271616, 'auprc': 0.8948893239135121, 'loss_val': 0.9125486544322873, 'psi': 0.5827065555217018}-{'f1_val': 0.37500660758238213, 'auprc': 0.7516696939395489, 'loss_val': 0.9113479951722939, 'psi': 0.5256718421252489}
[S5] START round=8 head_norm_before_train=0.939710 cos_to_last_merge=0.9919 (last merge round=5)
[S5] round=8 local utility u=0.945528 metrics={'f1_val': 0.7152129124580288, 'auprc': 0.7773055849978204, 'loss_val': 0.947875715214225, 'psi': 0.7400499814739454}-{'f1_val': 0.41754956401939425, 'auprc': 0.7777810143953306, 'loss_val': 1.0543784677735581, 'psi': 0.5616421441697688}
[S6] START round=8 head_norm_before_train=1.325778 (no previous merge yet)
[S6] round=8 local utility u=0.300567 metrics={'f1_val': 0.4164535851642239, 'auprc': 0.7762967405740692, 'loss_val': 0.8132099989052435, 'psi': 0.560390847328162}-{'f1_val': 0.37725537497254924, 'auprc': 0.7113668867640734, 'loss_val': 0.9843651879585665, 'psi': 0.5108999796891589}
[S7] START round=8 head_norm_before_train=1.317081 (no previous merge yet)
[S7] round=8 local utility u=0.013141 metrics={'f1_val': 0.4015508512030733, 'auprc': 0.6085544508206955, 'loss_val': 0.8764752767615754, 'psi': 0.48435229105012223}-{'f1_val': 0.4172381946317165, 'auprc': 0.5940609294506419, 'loss_val': 0.9534004491210203, 'psi': 0.4879672885592867}
[S8] START round=8 head_norm_before_train=0.952480 cos_to_last_merge=0.9255 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.926
[S8] round=8 local utility u=0.082024 metrics={'f1_val': 0.7146825535339066, 'auprc': 0.7767477918839893, 'loss_val': 0.7991235278648401, 'psi': 0.7395086488739397}-{'f1_val': 0.7156066922694875, 'auprc': 0.777108093625966, 'loss_val': 0.9697976235121433, 'psi': 0.7402072528120789}
[S9] START round=8 head_norm_before_train=0.814647 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.748985 metrics={'f1_val': 0.6619856969275353, 'auprc': 0.9799485641128055, 'loss_val': 0.7822218090010942, 'psi': 0.7891708438016434}-{'f1_val': 0.41697558078303143, 'auprc': 0.9980830153573592, 'loss_val': 0.8645342061672073, 'psi': 0.6494185546127625}
[S10] START round=8 head_norm_before_train=1.327327 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.437214700098455, 'auprc': 0.835493810605546, 'loss_val': 0.6860818964089231, 'psi': 0.5965263443012914}-{'f1_val': 0.6981607225861814, 'auprc': 0.788730889930702, 'loss_val': 0.7815692847493718, 'psi': 0.7343887895239897}
[S11] START round=8 head_norm_before_train=1.461681 (no previous merge yet)
[S11] round=8 local utility u=0.503857 metrics={'f1_val': 0.5418985140927179, 'auprc': 0.9990739848460083, 'loss_val': 0.5272150916321323, 'psi': 0.7247687023940341}-{'f1_val': 0.3917979913796843, 'auprc': 0.9994267858062966, 'loss_val': 0.6353848264494859, 'psi': 0.6348495091503292}
[S13] START round=8 head_norm_before_train=1.405036 (no previous merge yet)
[S13] round=8 local utility u=0.961717 metrics={'f1_val': 0.7100820237830641, 'auprc': 0.6200827266011388, 'loss_val': 0.8445891365153934, 'psi': 0.674082304910294}-{'f1_val': 0.4163965282706411, 'auprc': 0.6071603496785967, 'loss_val': 0.9671432407143844, 'psi': 0.49270205683382334}
[S14] START round=8 head_norm_before_train=0.832086 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.6914855385333842, 'auprc': 0.9646056034669386, 'loss_val': 0.8881565464353695, 'psi': 0.800733564506806}-{'f1_val': 0.7015742629936279, 'auprc': 0.9986503916912213, 'loss_val': 0.8955609476780099, 'psi': 0.8204047144726653}
[S15] START round=8 head_norm_before_train=0.800715 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.038628 metrics={'f1_val': 0.4167276561389307, 'auprc': 0.7792747257733713, 'loss_val': 0.9886731092638077, 'psi': 0.5617464839927069}-{'f1_val': 0.4167593395843331, 'auprc': 0.7770527340695466, 'loss_val': 1.059453048106657, 'psi': 0.5608766973784185}
[S16] START round=8 head_norm_before_train=0.898333 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.285637827513797, 'auprc': 0.7257367912150128, 'loss_val': 1.1493023747412459, 'psi': 0.46167741299428333}-{'f1_val': 0.41683695810830534, 'auprc': 0.5246076188849703, 'loss_val': 1.1195459301331259, 'psi': 0.45994522241897134}
[S17] START round=8 head_norm_before_train=1.092135 cos_to_last_merge=0.9349 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.935
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.37606433301797537, 'auprc': 0.7422509041190166, 'loss_val': 0.8226697351486622, 'psi': 0.5225389614583918}-{'f1_val': 0.39129266205198276, 'auprc': 0.8156948081598099, 'loss_val': 0.9069717872998498, 'psi': 0.5610535204951136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:44605
[S5] not sending this round → trigger blocked (psi=0.740)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[S6] not sending this round → trigger blocked (psi=0.560)
[S7] not sending this round → trigger blocked (psi=0.484)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44614
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44609
[S8] not sending this round → trigger blocked (psi=0.740)
[S9] not sending this round → trigger blocked (psi=0.789)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.725)
[S2] not sending this round → trigger blocked (psi=0.714)
[S15] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S13
[S14] cosine check vs S13: cos=-0.0853
[S14] DROPPED delta from S13 (cos=-0.0853 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S3
[S14] cosine check vs S3: cos=0.0388
[S8] RECEIVED delta(kind=head bytes=1795) from S15
[S8] cosine check vs S15: cos=0.2899
[S5] RECEIVED delta(kind=head bytes=1795) from S4
[S5] cosine check vs S4: cos=0.5686
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.6915 head_norm=0.889606
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.474926e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.4018 head_norm=0.672993 delta_norm=0.647493
[S14] aggregate: ROLLBACK (f1_val pre=0.691 post=0.402 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.7147 head_norm=1.011343
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.546566e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.7147 head_norm=0.743318 delta_norm=0.554657
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.7152 head_norm=0.976283
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.233385e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.7153 head_norm=0.797624 delta_norm=0.423339
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.473467 (no previous merge yet)
[S2] round=9 local utility u=0.191801 metrics={'f1_val': 0.7016512288906386, 'auprc': 0.7949639169088445, 'loss_val': 0.5735749988520128, 'psi': 0.7389763040979209}-{'f1_val': 0.6566229430060229, 'auprc': 0.8007727011263581, 'loss_val': 0.7044345579581305, 'psi': 0.7142828462541571}
[S3] START round=9 head_norm_before_train=0.976183 cos_to_last_merge=0.9370 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.401708470248874, 'auprc': 0.8417826715700755, 'loss_val': 0.7642768651122748, 'psi': 0.5777381507773546}-{'f1_val': 0.4009668676591264, 'auprc': 0.9606064663376256, 'loss_val': 0.8420964707239545, 'psi': 0.6248227071305261}
[S4] START round=9 head_norm_before_train=0.823233 cos_to_last_merge=0.9931 (last merge round=7)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.41789165840572007, 'auprc': 0.7671723982506355, 'loss_val': 0.8198591585416782, 'psi': 0.5576039543436864}-{'f1_val': 0.3745847099271616, 'auprc': 0.8948893239135121, 'loss_val': 0.9125486544322873, 'psi': 0.5827065555217018}
[S5] START round=9 head_norm_before_train=0.797624 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.6791477133470456, 'auprc': 0.7775650168508997, 'loss_val': 0.8814038455914409, 'psi': 0.7185146347485872}-{'f1_val': 0.7152129124580288, 'auprc': 0.7773055849978204, 'loss_val': 0.947875715214225, 'psi': 0.7400499814739454}
[S6] START round=9 head_norm_before_train=1.357561 (no previous merge yet)
[S6] round=9 local utility u=0.389810 metrics={'f1_val': 0.41745618053540323, 'auprc': 0.9863391115759815, 'loss_val': 0.669732503188769, 'psi': 0.6450093529516345}-{'f1_val': 0.4164535851642239, 'auprc': 0.7762967405740692, 'loss_val': 0.8132099989052435, 'psi': 0.560390847328162}
[S7] START round=9 head_norm_before_train=1.350745 (no previous merge yet)
[S7] round=9 local utility u=1.000000 metrics={'f1_val': 0.7124496472626924, 'auprc': 0.7880321150635436, 'loss_val': 0.8275826487086668, 'psi': 0.742682634383033}-{'f1_val': 0.4015508512030733, 'auprc': 0.6085544508206955, 'loss_val': 0.8764752767615754, 'psi': 0.48435229105012223}
[S8] START round=9 head_norm_before_train=0.743318 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.039928 metrics={'f1_val': 0.7143962130222558, 'auprc': 0.7993046130785466, 'loss_val': 0.7852198303794289, 'psi': 0.7483595730447721}-{'f1_val': 0.7146825535339066, 'auprc': 0.7767477918839893, 'loss_val': 0.7991235278648401, 'psi': 0.7395086488739397}
[S9] START round=9 head_norm_before_train=0.857252 cos_to_last_merge=0.9946 (last merge round=7)
[S9] round=9 local utility u=0.154808 metrics={'f1_val': 0.6758611731180694, 'auprc': 0.9914302408890187, 'loss_val': 0.590303822066026, 'psi': 0.802088800226449}-{'f1_val': 0.6619856969275353, 'auprc': 0.9799485641128055, 'loss_val': 0.7822218090010942, 'psi': 0.7891708438016434}
[S10] START round=9 head_norm_before_train=1.365840 (no previous merge yet)
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.6956855130602118, 'auprc': 0.9958853532711127, 'loss_val': 0.5427762911612426, 'psi': 0.8157654491445722}-{'f1_val': 0.437214700098455, 'auprc': 0.835493810605546, 'loss_val': 0.6860818964089231, 'psi': 0.5965263443012914}
[S11] START round=9 head_norm_before_train=1.509607 (no previous merge yet)
[S11] round=9 local utility u=0.591400 metrics={'f1_val': 0.7123939345997805, 'auprc': 0.9989812756632422, 'loss_val': 0.36710873653149234, 'psi': 0.8270288710251652}-{'f1_val': 0.5418985140927179, 'auprc': 0.9990739848460083, 'loss_val': 0.5272150916321323, 'psi': 0.7247687023940341}
[S13] START round=9 head_norm_before_train=1.448348 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.5600248190157298, 'auprc': 0.708567265390604, 'loss_val': 0.779380681683283, 'psi': 0.6194417975656794}-{'f1_val': 0.7100820237830641, 'auprc': 0.6200827266011388, 'loss_val': 0.8445891365153934, 'psi': 0.674082304910294}
[S14] START round=9 head_norm_before_train=0.672993 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.3147804532006274, 'auprc': 0.9978430496598949, 'loss_val': 0.9342689682694891, 'psi': 0.5880054917843345}-{'f1_val': 0.6914855385333842, 'auprc': 0.9646056034669386, 'loss_val': 0.8881565464353695, 'psi': 0.800733564506806}
[S15] START round=9 head_norm_before_train=0.835175 cos_to_last_merge=0.9939 (last merge round=7)
[S15] round=9 local utility u=0.212071 metrics={'f1_val': 0.3836834137380135, 'auprc': 0.9285116351509375, 'loss_val': 0.8139769509042621, 'psi': 0.6016147023031831}-{'f1_val': 0.4167276561389307, 'auprc': 0.7792747257733713, 'loss_val': 0.9886731092638077, 'psi': 0.5617464839927069}
[S16] START round=9 head_norm_before_train=0.928369 cos_to_last_merge=0.9961 (last merge round=7)
[S16] round=9 local utility u=0.415134 metrics={'f1_val': 0.41734371905575945, 'auprc': 0.7079767548338689, 'loss_val': 1.055989357707927, 'psi': 0.5335969333670032}-{'f1_val': 0.285637827513797, 'auprc': 0.7257367912150128, 'loss_val': 1.1493023747412459, 'psi': 0.46167741299428333}
[S17] START round=9 head_norm_before_train=1.141591 cos_to_last_merge=0.9179 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.918
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.35169382415044237, 'auprc': 0.6738489807708942, 'loss_val': 0.9096606449524094, 'psi': 0.48055588679862304}-{'f1_val': 0.37606433301797537, 'auprc': 0.7422509041190166, 'loss_val': 0.8226697351486622, 'psi': 0.5225389614583918}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44616
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44614
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:44615
[S15] not sending this round → trigger blocked (psi=0.602)
[S16] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S8
[S4] cosine check vs S8: cos=0.3538
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] cosine check vs S6: cos=0.7667
[S15] RECEIVED delta(kind=head bytes=1795) from S16
[S15] cosine check vs S16: cos=0.2625
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] cosine check vs S10: cos=-0.0343
[S9] DROPPED delta from S10 (cos=-0.0343 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S11
[S16] cosine check vs S11: cos=0.7569
[S16] RECEIVED delta(kind=head bytes=1795) from S2
[S16] cosine check vs S2: cos=-0.0565
[S16] DROPPED delta from S2 (cos=-0.0565 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=0.5325
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] cosine check vs S9: cos=0.3448
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3148 head_norm=0.719465
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.727902e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3148 head_norm=0.670256 delta_norm=0.472790
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.4179 head_norm=0.881858
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.684560e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.4235 head_norm=0.817553 delta_norm=0.268456
[S4] aggregate: ACCEPT kept=['S8', 'S6'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.3837 head_norm=0.880624
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.624704e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.3837 head_norm=0.735015 delta_norm=0.562470
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.4173 head_norm=0.968371
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.279751e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.4120 head_norm=0.987314 delta_norm=0.227975
[S16] aggregate: ROLLBACK (f1_val pre=0.417 post=0.412 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.521724 (no previous merge yet)
[S2] round=10 local utility u=0.054496 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.7735731161255897, 'loss_val': 0.4014937139901172, 'psi': 0.7305283407429732}-{'f1_val': 0.7016512288906386, 'auprc': 0.7949639169088445, 'loss_val': 0.5735749988520128, 'psi': 0.7389763040979209}
[S3] START round=10 head_norm_before_train=1.023600 cos_to_last_merge=0.9197 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=10 local utility u=0.281545 metrics={'f1_val': 0.4134332584938002, 'auprc': 0.9903151525765477, 'loss_val': 0.7171335435640289, 'psi': 0.6441860161268992}-{'f1_val': 0.401708470248874, 'auprc': 0.8417826715700755, 'loss_val': 0.7642768651122748, 'psi': 0.5777381507773546}
[S4] START round=10 head_norm_before_train=0.817553 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.047365 metrics={'f1_val': 0.43583844566945695, 'auprc': 0.7665977251029967, 'loss_val': 0.8310857405834483, 'psi': 0.5681421574428729}-{'f1_val': 0.41789165840572007, 'auprc': 0.7671723982506355, 'loss_val': 0.8198591585416782, 'psi': 0.5576039543436864}
[S5] START round=10 head_norm_before_train=0.831646 cos_to_last_merge=0.9962 (last merge round=8)
[S5] round=10 local utility u=0.180944 metrics={'f1_val': 0.7146275168069246, 'auprc': 0.777480934811103, 'loss_val': 0.7321430246787112, 'psi': 0.739768884008596}-{'f1_val': 0.6791477133470456, 'auprc': 0.7775650168508997, 'loss_val': 0.8814038455914409, 'psi': 0.7185146347485872}
[S6] START round=10 head_norm_before_train=1.394695 (no previous merge yet)
[S6] round=10 local utility u=0.949414 metrics={'f1_val': 0.7083681813625358, 'auprc': 0.9878714347902027, 'loss_val': 0.5209736628368494, 'psi': 0.8201694827336026}-{'f1_val': 0.41745618053540323, 'auprc': 0.9863391115759815, 'loss_val': 0.669732503188769, 'psi': 0.6450093529516345}
[S7] START round=10 head_norm_before_train=1.381594 (no previous merge yet)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7792065788833723, 'loss_val': 0.7740159697156496, 'psi': 0.5618304898148236}-{'f1_val': 0.7124496472626924, 'auprc': 0.7880321150635436, 'loss_val': 0.8275826487086668, 'psi': 0.742682634383033}
[S8] START round=10 head_norm_before_train=0.800030 cos_to_last_merge=0.9942 (last merge round=8)
[S8] round=10 local utility u=0.307008 metrics={'f1_val': 0.7141092833849391, 'auprc': 0.9429595932039652, 'loss_val': 0.6004477883530329, 'psi': 0.8056494073125495}-{'f1_val': 0.7143962130222558, 'auprc': 0.7993046130785466, 'loss_val': 0.7852198303794289, 'psi': 0.7483595730447721}
[S9] START round=10 head_norm_before_train=0.909899 cos_to_last_merge=0.9813 (last merge round=7)
[S9] round=10 local utility u=0.151047 metrics={'f1_val': 0.6991225794116844, 'auprc': 0.998277664018665, 'loss_val': 0.448321197031934, 'psi': 0.8187846132544767}-{'f1_val': 0.6758611731180694, 'auprc': 0.9914302408890187, 'loss_val': 0.590303822066026, 'psi': 0.802088800226449}
[S10] START round=10 head_norm_before_train=1.401927 (no previous merge yet)
[S10] round=10 local utility u=0.044623 metrics={'f1_val': 0.6911412795434119, 'auprc': 0.9980809627918685, 'loss_val': 0.4328517802430116, 'psi': 0.8139171528427945}-{'f1_val': 0.6956855130602118, 'auprc': 0.9958853532711127, 'loss_val': 0.5427762911612426, 'psi': 0.8157654491445722}
[S11] START round=10 head_norm_before_train=1.546135 (no previous merge yet)
[S11] round=10 local utility u=0.035874 metrics={'f1_val': 0.7110806379171908, 'auprc': 0.9989331954191079, 'loss_val': 0.2873357886904918, 'psi': 0.8262216609179576}-{'f1_val': 0.7123939345997805, 'auprc': 0.9989812756632422, 'loss_val': 0.36710873653149234, 'psi': 0.8270288710251652}
[S13] START round=10 head_norm_before_train=1.479905 (no previous merge yet)
[S13] round=10 local utility u=0.386508 metrics={'f1_val': 0.6717477067761185, 'auprc': 0.69428270352274, 'loss_val': 0.633848612355613, 'psi': 0.6807617054747671}-{'f1_val': 0.5600248190157298, 'auprc': 0.708567265390604, 'loss_val': 0.779380681683283, 'psi': 0.6194417975656794}
[S14] START round=10 head_norm_before_train=0.670256 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=1.000000 metrics={'f1_val': 0.7975689640961487, 'auprc': 0.9913401409345444, 'loss_val': 0.8824611343234123, 'psi': 0.875077434831507}-{'f1_val': 0.3147804532006274, 'auprc': 0.9978430496598949, 'loss_val': 0.9342689682694891, 'psi': 0.5880054917843345}
[S15] START round=10 head_norm_before_train=0.735015 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.41680775938714587, 'auprc': 0.7493784675187228, 'loss_val': 0.8886811428108806, 'psi': 0.5498360426397766}-{'f1_val': 0.3836834137380135, 'auprc': 0.9285116351509375, 'loss_val': 0.8139769509042621, 'psi': 0.6016147023031831}
[S16] START round=10 head_norm_before_train=0.987314 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.425625 metrics={'f1_val': 0.5409824872259342, 'auprc': 0.7618295208525333, 'loss_val': 1.1081296736385882, 'psi': 0.6293213006765739}-{'f1_val': 0.41734371905575945, 'auprc': 0.7079767548338689, 'loss_val': 1.055989357707927, 'psi': 0.5335969333670032}
[S17] START round=10 head_norm_before_train=1.181390 cos_to_last_merge=0.9039 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.904
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.35228783858720547, 'auprc': 0.6687601080272567, 'loss_val': 0.9137023812896684, 'psi': 0.47887674636322597}-{'f1_val': 0.35169382415044237, 'auprc': 0.6738489807708942, 'loss_val': 0.9096606449524094, 'psi': 0.48055588679862304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:44605
[S10] not sending this round → trigger blocked (psi=0.814)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44614
[S11] not sending this round → trigger blocked (psi=0.826)
[S2] not sending this round → trigger blocked (psi=0.731)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:44610
[S9] not sending this round → trigger blocked (psi=0.819)
[S8] not sending this round → trigger blocked (psi=0.806)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.629)
[S6] not sending this round → trigger blocked (psi=0.820)
[S14] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1788 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1791) from S5
[S9] cosine check vs S5: cos=0.8446
[S5] RECEIVED delta(kind=head bytes=1788) from S4
[S5] cosine check vs S4: cos=0.7422
[S14] RECEIVED delta(kind=head bytes=1800) from S13
[S14] cosine check vs S13: cos=0.0711
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] cosine check vs S14: cos=0.3120
[S14] RECEIVED delta(kind=head bytes=1795) from S3
[S14] cosine check vs S3: cos=0.3636
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=0.349 → S16@127.0.0.1:44616
[S11] ⇄ pheromone p=0.383 → S16@127.0.0.1:44616
[S8] ⇄ pheromone p=0.304 → S4@127.0.0.1:44604
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.4168 head_norm=0.781090
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.389840e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.4168 head_norm=0.605329 delta_norm=0.438984
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.223 → S8@127.0.0.1:44609
[S2] ⇄ pheromone p=0.324 → S16@127.0.0.1:44616
[S6] ⇄ pheromone p=0.497 → S4@127.0.0.1:44604
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.6991 head_norm=0.968067
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.605836e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.6991 head_norm=0.884108 delta_norm=0.260584
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.351 → S14@127.0.0.1:44614
[S10] ⇄ pheromone p=0.460 → S9@127.0.0.1:44610
[S16] ⇄ pheromone p=0.340 → S15@127.0.0.1:44615
[S13] ⇄ pheromone p=0.391 → S14@127.0.0.1:44614
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7146 head_norm=0.872896
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.122721e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7144 head_norm=0.811841 delta_norm=0.312272
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.373 → S9@127.0.0.1:44610
[S3] ⇄ pheromone p=0.317 → S14@127.0.0.1:44614
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.7976 head_norm=0.712852
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.649928e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.1404 head_norm=0.704466 delta_norm=0.564993
[S14] aggregate: ROLLBACK (f1_val pre=0.798 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.499 → S15@127.0.0.1:44615
[S4] ⇄ pheromone p=0.224 → S5@127.0.0.1:44605
[S17] ⇄ pheromone p=0.245 → S16@127.0.0.1:44616
[S2] START round=11 head_norm_before_train=1.573561 (no previous merge yet)
[S2] round=11 local utility u=0.003987 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.7534321102085066, 'loss_val': 0.3330962541651374, 'psi': 0.72247193837614}-{'f1_val': 0.7018318238212289, 'auprc': 0.7735731161255897, 'loss_val': 0.4014937139901172, 'psi': 0.7305283407429732}
[S3] START round=11 head_norm_before_train=1.070545 cos_to_last_merge=0.9014 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.901
[S3] round=11 local utility u=0.919323 metrics={'f1_val': 0.6842496215603537, 'auprc': 0.9981089597030156, 'loss_val': 0.52676799214922, 'psi': 0.8097933568174185}-{'f1_val': 0.4134332584938002, 'auprc': 0.9903151525765477, 'loss_val': 0.7171335435640289, 'psi': 0.6441860161268992}
[S4] START round=11 head_norm_before_train=0.866749 cos_to_last_merge=0.9935 (last merge round=9)
[S4] round=11 local utility u=0.063818 metrics={'f1_val': 0.43837656764412, 'auprc': 0.7637596670531653, 'loss_val': 0.7101640316613892, 'psi': 0.5685298074077382}-{'f1_val': 0.43583844566945695, 'auprc': 0.7665977251029967, 'loss_val': 0.8310857405834483, 'psi': 0.5681421574428729}
[S5] START round=11 head_norm_before_train=0.811841 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.7008775024980438, 'auprc': 0.7774816119031634, 'loss_val': 0.7098676293649351, 'psi': 0.7315191462600916}-{'f1_val': 0.7146275168069246, 'auprc': 0.777480934811103, 'loss_val': 0.7321430246787112, 'psi': 0.739768884008596}
[S6] START round=11 head_norm_before_train=1.434735 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.5065122826901892, 'auprc': 0.7076800671255342, 'loss_val': 0.6674117819118969, 'psi': 0.5869793964643273}-{'f1_val': 0.7083681813625358, 'auprc': 0.9878714347902027, 'loss_val': 0.5209736628368494, 'psi': 0.8201694827336026}
[S7] START round=11 head_norm_before_train=1.409811 (no previous merge yet)
[S7] round=11 local utility u=0.790275 metrics={'f1_val': 0.6776599073691212, 'auprc': 0.7878100504773858, 'loss_val': 0.7837566834666209, 'psi': 0.721719964612427}-{'f1_val': 0.4169130971024577, 'auprc': 0.7792065788833723, 'loss_val': 0.7740159697156496, 'psi': 0.5618304898148236}
[S8] START round=11 head_norm_before_train=0.872946 cos_to_last_merge=0.9791 (last merge round=8)
[S8] round=11 local utility u=0.136450 metrics={'f1_val': 0.7011808540377706, 'auprc': 0.9932598053641075, 'loss_val': 0.40087742230454215, 'psi': 0.8180124345683054}-{'f1_val': 0.7141092833849391, 'auprc': 0.9429595932039652, 'loss_val': 0.6004477883530329, 'psi': 0.8056494073125495}
[S9] START round=11 head_norm_before_train=0.884108 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.7014341538288464, 'auprc': 0.8350881943515538, 'loss_val': 0.44486639046151305, 'psi': 0.7548957700379294}-{'f1_val': 0.6991225794116844, 'auprc': 0.998277664018665, 'loss_val': 0.448321197031934, 'psi': 0.8187846132544767}
[S10] START round=11 head_norm_before_train=1.439562 (no previous merge yet)
[S10] round=11 local utility u=0.024698 metrics={'f1_val': 0.6885529692213563, 'auprc': 0.9976182646391205, 'loss_val': 0.36653846987588623, 'psi': 0.812179087388462}-{'f1_val': 0.6911412795434119, 'auprc': 0.9980809627918685, 'loss_val': 0.4328517802430116, 'psi': 0.8139171528427945}
[S11] START round=11 head_norm_before_train=1.591401 (no previous merge yet)
[S11] round=11 local utility u=0.796303 metrics={'f1_val': 0.9594776595036811, 'auprc': 0.9986849013676851, 'loss_val': 0.18436763762292258, 'psi': 0.9751605562492828}-{'f1_val': 0.7110806379171908, 'auprc': 0.9989331954191079, 'loss_val': 0.2873357886904918, 'psi': 0.8262216609179576}
[S13] START round=11 head_norm_before_train=1.512106 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.5639009014306401, 'auprc': 0.7060627097990881, 'loss_val': 0.7023721474573474, 'psi': 0.6207656247780193}-{'f1_val': 0.6717477067761185, 'auprc': 0.69428270352274, 'loss_val': 0.633848612355613, 'psi': 0.6807617054747671}
[S14] START round=11 head_norm_before_train=0.704466 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.4620933270764406, 'auprc': 0.9913363304915396, 'loss_val': 0.97475877960174, 'psi': 0.6737905284424801}-{'f1_val': 0.7975689640961487, 'auprc': 0.9913401409345444, 'loss_val': 0.8824611343234123, 'psi': 0.875077434831507}
[S15] START round=11 head_norm_before_train=0.605329 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.301610 metrics={'f1_val': 0.484577330850927, 'auprc': 0.7992508160914928, 'loss_val': 0.8416959404936512, 'psi': 0.6104467249471535}-{'f1_val': 0.41680775938714587, 'auprc': 0.7493784675187228, 'loss_val': 0.8886811428108806, 'psi': 0.5498360426397766}
[S16] START round=11 head_norm_before_train=1.018962 cos_to_last_merge=0.9972 (last merge round=9)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.41083517986878043, 'auprc': 0.7198777393239603, 'loss_val': 1.0523741732932594, 'psi': 0.5344522036508523}-{'f1_val': 0.5409824872259342, 'auprc': 0.7618295208525333, 'loss_val': 1.1081296736385882, 'psi': 0.6293213006765739}
[S17] START round=11 head_norm_before_train=1.214315 cos_to_last_merge=0.8919 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.892
[S17] round=11 local utility u=0.222523 metrics={'f1_val': 0.38249582627873535, 'auprc': 0.6947187909049577, 'loss_val': 0.7277811551986705, 'psi': 0.5073850121292243}-{'f1_val': 0.35228783858720547, 'auprc': 0.6687601080272567, 'loss_val': 0.9137023812896684, 'psi': 0.47887674636322597}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:44604
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.569)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44609
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S3] not sending this round → trigger blocked (psi=0.810)
[S2] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1791) from S8
[S4] cosine check vs S8: cos=0.4419
[S9] RECEIVED delta(kind=head bytes=1795) from S10
[S9] cosine check vs S10: cos=-0.0434
[S9] DROPPED delta from S10 (cos=-0.0434 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=0.5936
[S16] RECEIVED delta(kind=head bytes=1795) from S11
[S16] cosine check vs S11: cos=0.7564
[S16] RECEIVED delta(kind=head bytes=1803) from S2
[S16] cosine check vs S2: cos=-0.0526
[S16] DROPPED delta from S2 (cos=-0.0526 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=0.4691
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1792 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S17
[S16] cosine check vs S17: cos=-0.0619
[S16] DROPPED delta from S17 (cos=-0.0619 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.4384 head_norm=0.928184
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.942464e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.4374 head_norm=0.794349 delta_norm=0.494246
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.7012 head_norm=0.942876
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.298226e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.7036 head_norm=0.689045 delta_norm=0.429823
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4108 head_norm=1.054384
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.818326e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.4085 head_norm=1.065013 delta_norm=0.181833
[S16] aggregate: ACCEPT kept=['S7', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.623781 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6759009950301396, 'loss_val': 0.29938507852318613, 'psi': 0.6913030334352048}-{'f1_val': 0.7018318238212289, 'auprc': 0.7534321102085066, 'loss_val': 0.3330962541651374, 'psi': 0.72247193837614}
[S3] START round=12 head_norm_before_train=1.114142 cos_to_last_merge=0.8839 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.884
[S3] round=12 local utility u=0.026118 metrics={'f1_val': 0.6824230181621339, 'auprc': 0.9970623317316941, 'loss_val': 0.4604316933249803, 'psi': 0.808278743589958}-{'f1_val': 0.6842496215603537, 'auprc': 0.9981089597030156, 'loss_val': 0.52676799214922, 'psi': 0.8097933568174185}
[S4] START round=12 head_norm_before_train=0.794349 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.614016 metrics={'f1_val': 0.6833992249255353, 'auprc': 0.6757271290789539, 'loss_val': 0.6881704252707644, 'psi': 0.6803303865869027}-{'f1_val': 0.43837656764412, 'auprc': 0.7637596670531653, 'loss_val': 0.7101640316613892, 'psi': 0.5685298074077382}
[S5] START round=12 head_norm_before_train=0.852029 cos_to_last_merge=0.9955 (last merge round=10)
[S5] round=12 local utility u=0.168157 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.8506537812369637, 'loss_val': 0.5929476736569571, 'psi': 0.7607756825843047}-{'f1_val': 0.7008775024980438, 'auprc': 0.7774816119031634, 'loss_val': 0.7098676293649351, 'psi': 0.7315191462600916}
[S6] START round=12 head_norm_before_train=1.477530 (no previous merge yet)
[S6] round=12 local utility u=0.502245 metrics={'f1_val': 0.6183211268339823, 'auprc': 0.7797165009544049, 'loss_val': 0.5498844939801215, 'psi': 0.6828792764821514}-{'f1_val': 0.5065122826901892, 'auprc': 0.7076800671255342, 'loss_val': 0.6674117819118969, 'psi': 0.5869793964643273}
[S7] START round=12 head_norm_before_train=1.428124 (no previous merge yet)
[S7] round=12 local utility u=0.187685 metrics={'f1_val': 0.7138802693288737, 'auprc': 0.783879830371025, 'loss_val': 0.6139182107949841, 'psi': 0.7418800937457343}-{'f1_val': 0.6776599073691212, 'auprc': 0.7878100504773858, 'loss_val': 0.7837566834666209, 'psi': 0.721719964612427}
[S8] START round=12 head_norm_before_train=0.689045 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.9932124322770322, 'loss_val': 0.538005740969556, 'psi': 0.8256174529892818}-{'f1_val': 0.7011808540377706, 'auprc': 0.9932598053641075, 'loss_val': 0.40087742230454215, 'psi': 0.8180124345683054}
[S9] START round=12 head_norm_before_train=0.939252 cos_to_last_merge=0.9963 (last merge round=10)
[S9] round=12 local utility u=0.278251 metrics={'f1_val': 0.7011840123541024, 'auprc': 0.9983430237367343, 'loss_val': 0.37662795320089454, 'psi': 0.8200476169071552}-{'f1_val': 0.7014341538288464, 'auprc': 0.8350881943515538, 'loss_val': 0.44486639046151305, 'psi': 0.7548957700379294}
[S10] START round=12 head_norm_before_train=1.478850 (no previous merge yet)
[S10] round=12 local utility u=0.005549 metrics={'f1_val': 0.6797932048059607, 'auprc': 0.9982863537801228, 'loss_val': 0.3048851556890329, 'psi': 0.8071904643956256}-{'f1_val': 0.6885529692213563, 'auprc': 0.9976182646391205, 'loss_val': 0.36653846987588623, 'psi': 0.812179087388462}
[S11] START round=12 head_norm_before_train=1.640768 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.9190677136167534, 'auprc': 0.995496805835553, 'loss_val': 0.22840360087073866, 'psi': 0.9496393505042733}-{'f1_val': 0.9594776595036811, 'auprc': 0.9986849013676851, 'loss_val': 0.18436763762292258, 'psi': 0.9751605562492828}
[S13] START round=12 head_norm_before_train=1.549935 (no previous merge yet)
[S13] round=12 local utility u=0.233609 metrics={'f1_val': 0.6342271458778623, 'auprc': 0.672269321793196, 'loss_val': 0.5557305721006497, 'psi': 0.6494440162439958}-{'f1_val': 0.5639009014306401, 'auprc': 0.7060627097990881, 'loss_val': 0.7023721474573474, 'psi': 0.6207656247780193}
[S14] START round=12 head_norm_before_train=0.725393 cos_to_last_merge=0.9870 (last merge round=10)
[S14] round=12 local utility u=1.000000 metrics={'f1_val': 0.9667575577171116, 'auprc': 0.9930745752641491, 'loss_val': 0.7586082589961534, 'psi': 0.9772843647359266}-{'f1_val': 0.4620933270764406, 'auprc': 0.9913363304915396, 'loss_val': 0.97475877960174, 'psi': 0.6737905284424801}
[S15] START round=12 head_norm_before_train=0.655779 cos_to_last_merge=0.9906 (last merge round=10)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.42590510585065944, 'auprc': 0.6712472198564626, 'loss_val': 0.8166209234470521, 'psi': 0.5240419514529807}-{'f1_val': 0.484577330850927, 'auprc': 0.7992508160914928, 'loss_val': 0.8416959404936512, 'psi': 0.6104467249471535}
[S16] START round=12 head_norm_before_train=1.065013 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.494597 metrics={'f1_val': 0.5419626192780234, 'auprc': 0.7623311126925982, 'loss_val': 0.9773047418079589, 'psi': 0.6301100166438534}-{'f1_val': 0.41083517986878043, 'auprc': 0.7198777393239603, 'loss_val': 1.0523741732932594, 'psi': 0.5344522036508523}
[S17] START round=12 head_norm_before_train=1.236072 cos_to_last_merge=0.8822 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.882
[S17] round=12 local utility u=0.051681 metrics={'f1_val': 0.39138738192265743, 'auprc': 0.6955820927350985, 'loss_val': 0.6803576102120029, 'psi': 0.5130652662476338}-{'f1_val': 0.38249582627873535, 'auprc': 0.6947187909049577, 'loss_val': 0.7277811551986705, 'psi': 0.5073850121292243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:44605
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:44604
[S4] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] cosine check vs S16: cos=0.4627
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] cosine check vs S6: cos=0.4977
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] cosine check vs S14: cos=0.6019
[S9] RECEIVED delta(kind=head bytes=1793) from S5
[S9] cosine check vs S5: cos=0.8424
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] cosine check vs S10: cos=-0.0472
[S9] DROPPED delta from S10 (cos=-0.0472 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S4
[S5] cosine check vs S4: cos=0.7290
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] cosine check vs S7: cos=0.6324
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.4629
[S14] RECEIVED delta(kind=head bytes=1796) from S3
[S14] cosine check vs S3: cos=0.6366
[S14] RECEIVED delta(kind=head bytes=1801) from S13
[S14] cosine check vs S13: cos=0.5655
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S17
[S16] cosine check vs S17: cos=-0.0616
[S16] DROPPED delta from S17 (cos=-0.0616 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7012 head_norm=0.999820
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.709910e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7012 head_norm=0.912263 delta_norm=0.270991
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7009 head_norm=0.900933
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.231005e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7009 head_norm=0.813883 delta_norm=0.323101
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6834 head_norm=0.849658
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.575998e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6850 head_norm=1.035342 delta_norm=0.657600
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.5420 head_norm=1.100492
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.693563e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.7375 head_norm=1.154892 delta_norm=0.569356
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9668 head_norm=0.769510
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.079087e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.6374 head_norm=0.760581 delta_norm=0.207909
[S14] aggregate: ROLLBACK (f1_val pre=0.967 post=0.637 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.4259 head_norm=0.709670
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.680000e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.4180 head_norm=0.645654 delta_norm=0.268000
[S15] aggregate: ROLLBACK (f1_val pre=0.426 post=0.418 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.669286 (no previous merge yet)
[S2] round=13 local utility u=0.062383 metrics={'f1_val': 0.7012980599289202, 'auprc': 0.7228414315817343, 'loss_val': 0.3138033038375803, 'psi': 0.7099154085900459}-{'f1_val': 0.7015710590385817, 'auprc': 0.6759009950301396, 'loss_val': 0.29938507852318613, 'psi': 0.6913030334352048}
[S3] START round=13 head_norm_before_train=1.164591 cos_to_last_merge=0.8673 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.867
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.6718126095194024, 'auprc': 0.9936182050661341, 'loss_val': 0.41237886862399575, 'psi': 0.800534847738095}-{'f1_val': 0.6824230181621339, 'auprc': 0.9970623317316941, 'loss_val': 0.4604316933249803, 'psi': 0.808278743589958}
[S4] START round=13 head_norm_before_train=1.035342 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.388752 metrics={'f1_val': 0.6857719173895169, 'auprc': 0.8949474311684782, 'loss_val': 0.5825640473487327, 'psi': 0.7694421229011015}-{'f1_val': 0.6833992249255353, 'auprc': 0.6757271290789539, 'loss_val': 0.6881704252707644, 'psi': 0.6803303865869027}
[S5] START round=13 head_norm_before_train=0.813883 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7882654677600686, 'loss_val': 0.6406076981971115, 'psi': 0.735671222701632}-{'f1_val': 0.7008569501491988, 'auprc': 0.8506537812369637, 'loss_val': 0.5929476736569571, 'psi': 0.7607756825843047}
[S6] START round=13 head_norm_before_train=1.512224 (no previous merge yet)
[S6] round=13 local utility u=0.671437 metrics={'f1_val': 0.7078471678841252, 'auprc': 0.9710637353570862, 'loss_val': 0.3182090671685844, 'psi': 0.8131337948733096}-{'f1_val': 0.6183211268339823, 'auprc': 0.7797165009544049, 'loss_val': 0.5498844939801215, 'psi': 0.6828792764821514}
[S7] START round=13 head_norm_before_train=1.450794 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.5468146360970279, 'auprc': 0.7792472239768483, 'loss_val': 0.750120199961974, 'psi': 0.6397876712489561}-{'f1_val': 0.7138802693288737, 'auprc': 0.783879830371025, 'loss_val': 0.6139182107949841, 'psi': 0.7418800937457343}
[S8] START round=13 head_norm_before_train=0.750322 cos_to_last_merge=0.9940 (last merge round=11)
[S8] round=13 local utility u=0.933850 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9979161560933414, 'loss_val': 0.37920976444315163, 'psi': 0.9969783073987113}-{'f1_val': 0.7138874667974482, 'auprc': 0.9932124322770322, 'loss_val': 0.538005740969556, 'psi': 0.8256174529892818}
[S9] START round=13 head_norm_before_train=0.912263 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.7011840123541024, 'auprc': 0.9892367711262874, 'loss_val': 0.39946199659128373, 'psi': 0.8164051158629764}-{'f1_val': 0.7011840123541024, 'auprc': 0.9983430237367343, 'loss_val': 0.37662795320089454, 'psi': 0.8200476169071552}
[S10] START round=13 head_norm_before_train=1.513870 (no previous merge yet)
[S10] round=13 local utility u=0.048340 metrics={'f1_val': 0.6969454675234411, 'auprc': 0.9957921675732144, 'loss_val': 0.30363548738507756, 'psi': 0.8164841475433504}-{'f1_val': 0.6797932048059607, 'auprc': 0.9982863537801228, 'loss_val': 0.3048851556890329, 'psi': 0.8071904643956256}
[S11] START round=13 head_norm_before_train=1.689627 (no previous merge yet)
[S11] round=13 local utility u=0.176364 metrics={'f1_val': 0.9600393910689909, 'auprc': 0.9982824817785423, 'loss_val': 0.12986363056974395, 'psi': 0.9753366273528115}-{'f1_val': 0.9190677136167534, 'auprc': 0.995496805835553, 'loss_val': 0.22840360087073866, 'psi': 0.9496393505042733}
[S13] START round=13 head_norm_before_train=1.580854 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.5710048950922116, 'auprc': 0.6973399691954179, 'loss_val': 0.7735926146028016, 'psi': 0.6215389247334941}-{'f1_val': 0.6342271458778623, 'auprc': 0.672269321793196, 'loss_val': 0.5557305721006497, 'psi': 0.6494440162439958}
[S14] START round=13 head_norm_before_train=0.760581 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.097263 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.9947737342175916, 'loss_val': 0.7510720116009105, 'psi': 0.9961531743887804}-{'f1_val': 0.9667575577171116, 'auprc': 0.9930745752641491, 'loss_val': 0.7586082589961534, 'psi': 0.9772843647359266}
[S15] START round=13 head_norm_before_train=0.645654 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.4166959582258189, 'auprc': 0.6768364195834977, 'loss_val': 0.8416378896019979, 'psi': 0.5207521427688904}-{'f1_val': 0.42590510585065944, 'auprc': 0.6712472198564626, 'loss_val': 0.8166209234470521, 'psi': 0.5240419514529807}
[S16] START round=13 head_norm_before_train=1.154892 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.4090736044844668, 'auprc': 0.7488522192341549, 'loss_val': 0.941051523040025, 'psi': 0.5449850503843421}-{'f1_val': 0.5419626192780234, 'auprc': 0.7623311126925982, 'loss_val': 0.9773047418079589, 'psi': 0.6301100166438534}
[S17] START round=13 head_norm_before_train=1.256288 cos_to_last_merge=0.8736 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.874
[S17] round=13 local utility u=0.104021 metrics={'f1_val': 0.41539983921347245, 'auprc': 0.7126060413149975, 'loss_val': 0.6674631642063493, 'psi': 0.5342823200540825}-{'f1_val': 0.39138738192265743, 'auprc': 0.6955820927350985, 'loss_val': 0.6803576102120029, 'psi': 0.5130652662476338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S2
[S16] cosine check vs S2: cos=-0.0939
[S16] DROPPED delta from S2 (cos=-0.0939 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1792) from S4
[S5] cosine check vs S4: cos=0.8487
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:44604
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[S14] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44610
[S15] RECEIVED delta(kind=head bytes=1794) from S14
[S15] cosine check vs S14: cos=0.5978
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] cosine check vs S11: cos=0.3951
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] cosine check vs S10: cos=-0.0521
[S9] DROPPED delta from S10 (cos=-0.0521 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] cosine check vs S6: cos=0.9138
[S4] RECEIVED delta(kind=head bytes=1798) from S8
[S4] cosine check vs S8: cos=0.4631
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S17
[S16] cosine check vs S17: cos=-0.0486
[S16] DROPPED delta from S17 (cos=-0.0486 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7006 head_norm=0.855788
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.884884e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7006 head_norm=0.933018 delta_norm=0.288488
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6858 head_norm=1.084032
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.520075e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6858 head_norm=0.994850 delta_norm=0.152007
[S4] aggregate: ACCEPT kept=['S6', 'S8'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.4091 head_norm=1.183839
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.322849e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.4420 head_norm=1.225107 delta_norm=0.832285
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.4167 head_norm=0.690683
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.366422e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.4283 head_norm=0.664793 delta_norm=0.336642
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.705736 (no previous merge yet)
[S2] round=14 local utility u=0.062587 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.7524248025659199, 'loss_val': 0.27745123830286517, 'psi': 0.7217559998500891}-{'f1_val': 0.7012980599289202, 'auprc': 0.7228414315817343, 'loss_val': 0.3138033038375803, 'psi': 0.7099154085900459}
[S3] START round=14 head_norm_before_train=1.213849 cos_to_last_merge=0.8504 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.850
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.6087253395191301, 'auprc': 0.9434173882183305, 'loss_val': 0.4688205862631153, 'psi': 0.7426021589988103}-{'f1_val': 0.6718126095194024, 'auprc': 0.9936182050661341, 'loss_val': 0.41237886862399575, 'psi': 0.800534847738095}
[S4] START round=14 head_norm_before_train=0.994850 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.5533495998082122, 'auprc': 0.7745183474981183, 'loss_val': 0.6153265777457672, 'psi': 0.6418170988841747}-{'f1_val': 0.6857719173895169, 'auprc': 0.8949474311684782, 'loss_val': 0.5825640473487327, 'psi': 0.7694421229011015}
[S5] START round=14 head_norm_before_train=0.933018 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.345138 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9902044184129171, 'loss_val': 0.5561532865818368, 'psi': 0.8164472237686353}-{'f1_val': 0.7006083926626743, 'auprc': 0.7882654677600686, 'loss_val': 0.6406076981971115, 'psi': 0.735671222701632}
[S6] START round=14 head_norm_before_train=1.537686 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.6965728358718866, 'auprc': 0.9104790474511577, 'loss_val': 0.37447483358364786, 'psi': 0.782135320503595}-{'f1_val': 0.7078471678841252, 'auprc': 0.9710637353570862, 'loss_val': 0.3182090671685844, 'psi': 0.8131337948733096}
[S7] START round=14 head_norm_before_train=1.469929 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.4327338663175234, 'auprc': 0.7753471819821405, 'loss_val': 0.8532709115660815, 'psi': 0.5697791925833703}-{'f1_val': 0.5468146360970279, 'auprc': 0.7792472239768483, 'loss_val': 0.750120199961974, 'psi': 0.6397876712489561}
[S8] START round=14 head_norm_before_train=0.816800 cos_to_last_merge=0.9812 (last merge round=11)
[S8] round=14 local utility u=0.035316 metrics={'f1_val': 0.9941593050591768, 'auprc': 0.9976664818583336, 'loss_val': 0.2946656783858865, 'psi': 0.9955621757788395}-{'f1_val': 0.9963530749356245, 'auprc': 0.9979161560933414, 'loss_val': 0.37920976444315163, 'psi': 0.9969783073987113}
[S9] START round=14 head_norm_before_train=0.965576 cos_to_last_merge=0.9970 (last merge round=12)
[S9] round=14 local utility u=0.028350 metrics={'f1_val': 0.6993707628007879, 'auprc': 0.9978994020863986, 'loss_val': 0.35787041342778003, 'psi': 0.8187822185150322}-{'f1_val': 0.7011840123541024, 'auprc': 0.9892367711262874, 'loss_val': 0.39946199659128373, 'psi': 0.8164051158629764}
[S10] START round=14 head_norm_before_train=1.547643 (no previous merge yet)
[S10] round=14 local utility u=0.152631 metrics={'f1_val': 0.7470430094253752, 'auprc': 0.9941819912350127, 'loss_val': 0.2941284386122967, 'psi': 0.8458986021492302}-{'f1_val': 0.6969454675234411, 'auprc': 0.9957921675732144, 'loss_val': 0.30363548738507756, 'psi': 0.8164841475433504}
[S11] START round=14 head_norm_before_train=1.727917 (no previous merge yet)
[S11] round=14 local utility u=0.047811 metrics={'f1_val': 0.9778048320265726, 'auprc': 0.9979394656469435, 'loss_val': 0.1398053157713527, 'psi': 0.9858586854747209}-{'f1_val': 0.9600393910689909, 'auprc': 0.9982824817785423, 'loss_val': 0.12986363056974395, 'psi': 0.9753366273528115}
[S13] START round=14 head_norm_before_train=1.599100 (no previous merge yet)
[S13] round=14 local utility u=0.265399 metrics={'f1_val': 0.633461311367135, 'auprc': 0.6716151406602991, 'loss_val': 0.5403589674557814, 'psi': 0.6487228430844008}-{'f1_val': 0.5710048950922116, 'auprc': 0.6973399691954179, 'loss_val': 0.7735926146028016, 'psi': 0.6215389247334941}
[S14] START round=14 head_norm_before_train=0.795936 cos_to_last_merge=0.9897 (last merge round=12)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.9403323162667283, 'auprc': 0.9906974342043287, 'loss_val': 0.5739646840998273, 'psi': 0.9604783634417684}-{'f1_val': 0.9970728011695729, 'auprc': 0.9947737342175916, 'loss_val': 0.7510720116009105, 'psi': 0.9961531743887804}
[S15] START round=14 head_norm_before_train=0.664793 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.079296 metrics={'f1_val': 0.4368738182286977, 'auprc': 0.6815197238635882, 'loss_val': 0.8181620574518007, 'psi': 0.5347321804826539}-{'f1_val': 0.4166959582258189, 'auprc': 0.6768364195834977, 'loss_val': 0.8416378896019979, 'psi': 0.5207521427688904}
[S16] START round=14 head_norm_before_train=1.225107 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.468176 metrics={'f1_val': 0.5495735056108006, 'auprc': 0.7752912735523757, 'loss_val': 0.9270152756516935, 'psi': 0.6398606127874307}-{'f1_val': 0.4090736044844668, 'auprc': 0.7488522192341549, 'loss_val': 0.941051523040025, 'psi': 0.5449850503843421}
[S17] START round=14 head_norm_before_train=1.279418 cos_to_last_merge=0.8657 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.866
[S17] round=14 local utility u=0.034914 metrics={'f1_val': 0.4159767563597408, 'auprc': 0.7317227309132732, 'loss_val': 0.6584470513431604, 'psi': 0.5422751461811538}-{'f1_val': 0.41539983921347245, 'auprc': 0.7126060413149975, 'loss_val': 0.6674631642063493, 'psi': 0.5342823200540825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] cosine check vs S2: cos=-0.0174
[S16] DROPPED delta from S2 (cos=-0.0174 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:44610
[S5] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=0.7905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:44604
[S8] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S8
[S4] cosine check vs S8: cos=0.5157
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S13
[S14] cosine check vs S13: cos=0.5539
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44610
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:44609
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] cosine check vs S11: cos=0.8900
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=-0.0550
[S9] DROPPED delta from S10 (cos=-0.0550 < 0.0)
[S9] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S15
[S8] cosine check vs S15: cos=0.5133
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=0.4644
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44615
[S16] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S16
[S15] cosine check vs S16: cos=0.3353
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S17
[S16] cosine check vs S17: cos=-0.0650
[S16] DROPPED delta from S17 (cos=-0.0650 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.9942 head_norm=0.896593
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.040079e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.9955 head_norm=0.698987 delta_norm=0.404008
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.5533 head_norm=1.045004
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.820823e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.5398 head_norm=0.845904 delta_norm=0.482082
[S4] aggregate: ROLLBACK (f1_val pre=0.553 post=0.540 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.6994 head_norm=1.019832
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.237814e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.6994 head_norm=0.944647 delta_norm=0.323781
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.5496 head_norm=1.260561
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.305458e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.5490 head_norm=1.470932 delta_norm=0.430546
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9403 head_norm=0.843417
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.388609e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9947 head_norm=0.831559 delta_norm=0.338861
[S14] aggregate: ACCEPT kept=['S13', 'S9'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.4369 head_norm=0.706918
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.105594e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.4167 head_norm=0.819507 delta_norm=0.610559
[S15] aggregate: ROLLBACK (f1_val pre=0.437 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.730883 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.6215609259640771, 'auprc': 0.8316264691933568, 'loss_val': 0.6975342461249081, 'psi': 0.705587143255789}-{'f1_val': 0.7013101313728686, 'auprc': 0.7524248025659199, 'loss_val': 0.27745123830286517, 'psi': 0.7217559998500891}
[S3] START round=15 head_norm_before_train=1.262781 cos_to_last_merge=0.8362 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.836
[S3] round=15 local utility u=0.259957 metrics={'f1_val': 0.6594876170031627, 'auprc': 0.9827500767656538, 'loss_val': 0.371477667173443, 'psi': 0.7887926009081592}-{'f1_val': 0.6087253395191301, 'auprc': 0.9434173882183305, 'loss_val': 0.4688205862631153, 'psi': 0.7426021589988103}
[S4] START round=15 head_norm_before_train=0.845904 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=1.000000 metrics={'f1_val': 0.9431643350489957, 'auprc': 0.95214199377566, 'loss_val': 0.5156553412422348, 'psi': 0.9467553985396614}-{'f1_val': 0.5533495998082122, 'auprc': 0.7745183474981183, 'loss_val': 0.6153265777457672, 'psi': 0.6418170988841747}
[S5] START round=15 head_norm_before_train=0.976897 cos_to_last_merge=0.9957 (last merge round=13)
[S5] round=15 local utility u=0.029467 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.98564651670706, 'loss_val': 0.48354146235520634, 'psi': 0.8146236422804286}-{'f1_val': 0.7006090940057808, 'auprc': 0.9902044184129171, 'loss_val': 0.5561532865818368, 'psi': 0.8164472237686353}
[S6] START round=15 head_norm_before_train=1.559917 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6405838228192269, 'auprc': 0.8115320533929187, 'loss_val': 0.41976329927642125, 'psi': 0.7089631150487037}-{'f1_val': 0.6965728358718866, 'auprc': 0.9104790474511577, 'loss_val': 0.37447483358364786, 'psi': 0.782135320503595}
[S7] START round=15 head_norm_before_train=1.495483 (no previous merge yet)
[S7] round=15 local utility u=0.272372 metrics={'f1_val': 0.5218810288287782, 'auprc': 0.7735188088804059, 'loss_val': 0.8379244078218586, 'psi': 0.6225361408494292}-{'f1_val': 0.4327338663175234, 'auprc': 0.7753471819821405, 'loss_val': 0.8532709115660815, 'psi': 0.5697791925833703}
[S8] START round=15 head_norm_before_train=0.698987 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.9959789603727395, 'auprc': 0.9942618436003071, 'loss_val': 0.4164282136303301, 'psi': 0.9952921136637665}-{'f1_val': 0.9941593050591768, 'auprc': 0.9976664818583336, 'loss_val': 0.2946656783858865, 'psi': 0.9955621757788395}
[S9] START round=15 head_norm_before_train=0.944647 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.6988745369702247, 'auprc': 0.7986528691012507, 'loss_val': 0.4020458711057304, 'psi': 0.738785869822635}-{'f1_val': 0.6993707628007879, 'auprc': 0.9978994020863986, 'loss_val': 0.35787041342778003, 'psi': 0.8187822185150322}
[S10] START round=15 head_norm_before_train=1.579792 (no previous merge yet)
[S10] round=15 local utility u=0.819443 metrics={'f1_val': 0.9955737983388318, 'auprc': 0.9961697945919874, 'loss_val': 0.1523902555671045, 'psi': 0.9958121968400939}-{'f1_val': 0.7470430094253752, 'auprc': 0.9941819912350127, 'loss_val': 0.2941284386122967, 'psi': 0.8458986021492302}
[S11] START round=15 head_norm_before_train=1.763237 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.9570090367541328, 'auprc': 0.9933720629484315, 'loss_val': 0.18136266707716717, 'psi': 0.9715542472318524}-{'f1_val': 0.9778048320265726, 'auprc': 0.9979394656469435, 'loss_val': 0.1398053157713527, 'psi': 0.9858586854747209}
[S13] START round=15 head_norm_before_train=1.613848 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5896340614620798, 'auprc': 0.6903536082956515, 'loss_val': 0.726268624812508, 'psi': 0.6299218801955084}-{'f1_val': 0.633461311367135, 'auprc': 0.6716151406602991, 'loss_val': 0.5403589674557814, 'psi': 0.6487228430844008}
[S14] START round=15 head_norm_before_train=0.831559 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.142081 metrics={'f1_val': 0.9826751107140723, 'auprc': 0.9965821411446686, 'loss_val': 0.5615137765561176, 'psi': 0.9882379228863107}-{'f1_val': 0.9403323162667283, 'auprc': 0.9906974342043287, 'loss_val': 0.5739646840998273, 'psi': 0.9604783634417684}
[S15] START round=15 head_norm_before_train=0.819507 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.450497 metrics={'f1_val': 0.490006606810643, 'auprc': 0.8415883203994959, 'loss_val': 0.7161709554244333, 'psi': 0.6306392922461842}-{'f1_val': 0.4368738182286977, 'auprc': 0.6815197238635882, 'loss_val': 0.8181620574518007, 'psi': 0.5347321804826539}
[S16] START round=15 head_norm_before_train=1.470932 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.4494019417208838, 'auprc': 0.7698897382440707, 'loss_val': 0.8768233621905026, 'psi': 0.5775970603301586}-{'f1_val': 0.5495735056108006, 'auprc': 0.7752912735523757, 'loss_val': 0.9270152756516935, 'psi': 0.6398606127874307}
[S17] START round=15 head_norm_before_train=1.303304 cos_to_last_merge=0.8590 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.859
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.4122928626798935, 'auprc': 0.7233004999649546, 'loss_val': 0.6688383342392735, 'psi': 0.5366959175939179}-{'f1_val': 0.4159767563597408, 'auprc': 0.7317227309132732, 'loss_val': 0.6584470513431604, 'psi': 0.5422751461811538}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44614
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44609
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44610
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:44610
[S14] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] cosine check vs S14: cos=0.3784
[S14] RECEIVED delta(kind=head bytes=1797) from S3
[S14] cosine check vs S3: cos=0.4518
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] cosine check vs S15: cos=0.6245
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.9347
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] cosine check vs S10: cos=-0.0603
[S9] DROPPED delta from S10 (cos=-0.0603 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1790) from S4
[S5] cosine check vs S4: cos=0.8820
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=0.2288
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.221 → S16@127.0.0.1:44616
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.6989 head_norm=0.990647
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.824803e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.6989 head_norm=0.989904 delta_norm=0.182480
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.148 → S14@127.0.0.1:44614
[S13] ⇄ pheromone p=0.195 → S14@127.0.0.1:44614
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9960 head_norm=0.767643
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.561160e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9964 head_norm=0.735470 delta_norm=0.356116
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.236 → S4@127.0.0.1:44604
[S2] ⇄ pheromone p=0.125 → S16@127.0.0.1:44616
[S6] ⇄ pheromone p=0.300 → S4@127.0.0.1:44604
[S7] ⇄ pheromone p=0.253 → S16@127.0.0.1:44616
[S4] ⇄ pheromone p=0.391 → S5@127.0.0.1:44605
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7006 head_norm=1.022271
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.408381e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7006 head_norm=0.933356 delta_norm=0.240838
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.201 → S9@127.0.0.1:44610
[S10] ⇄ pheromone p=0.348 → S9@127.0.0.1:44610
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.4900 head_norm=0.863825
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.830740e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.4390 head_norm=0.719328 delta_norm=0.483074
[S15] aggregate: ROLLBACK (f1_val pre=0.490 post=0.439 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.200 → S8@127.0.0.1:44609
[S3] ⇄ pheromone p=0.234 → S14@127.0.0.1:44614
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9827 head_norm=0.869134
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.998502e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9962 head_norm=0.934603 delta_norm=0.599850
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.307 → S15@127.0.0.1:44615
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.4494 head_norm=1.502953
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.393100e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.6831 head_norm=1.185618 delta_norm=0.939310
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.237 → S15@127.0.0.1:44615
[S17] ⇄ pheromone p=0.123 → S16@127.0.0.1:44616
[S2] START round=16 head_norm_before_train=1.750398 (no previous merge yet)
[S2] round=16 local utility u=0.433549 metrics={'f1_val': 0.6751618941205365, 'auprc': 0.9095652469405947, 'loss_val': 0.38585846911248683, 'psi': 0.7689232352485598}-{'f1_val': 0.6215609259640771, 'auprc': 0.8316264691933568, 'loss_val': 0.6975342461249081, 'psi': 0.705587143255789}
[S3] START round=16 head_norm_before_train=1.308133 cos_to_last_merge=0.8264 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.826
[S3] round=16 local utility u=0.055975 metrics={'f1_val': 0.6707470934247142, 'auprc': 0.9931448138965118, 'loss_val': 0.3582686919434944, 'psi': 0.7997061816134332}-{'f1_val': 0.6594876170031627, 'auprc': 0.9827500767656538, 'loss_val': 0.371477667173443, 'psi': 0.7887926009081592}
[S4] START round=16 head_norm_before_train=0.901817 cos_to_last_merge=0.9953 (last merge round=14)
[S4] round=16 local utility u=0.048856 metrics={'f1_val': 0.94186672386172, 'auprc': 0.957016770060314, 'loss_val': 0.42478119731142094, 'psi': 0.9479267423411576}-{'f1_val': 0.9431643350489957, 'auprc': 0.95214199377566, 'loss_val': 0.5156553412422348, 'psi': 0.9467553985396614}
[S5] START round=16 head_norm_before_train=0.933356 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.672306974371238, 'auprc': 0.7998163609299564, 'loss_val': 0.5747164695345526, 'psi': 0.7233107289947254}-{'f1_val': 0.7006083926626743, 'auprc': 0.98564651670706, 'loss_val': 0.48354146235520634, 'psi': 0.8146236422804286}
[S6] START round=16 head_norm_before_train=1.580266 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6407373371658421, 'auprc': 0.8026806943117002, 'loss_val': 0.4196095857100302, 'psi': 0.7055146800241854}-{'f1_val': 0.6405838228192269, 'auprc': 0.8115320533929187, 'loss_val': 0.41976329927642125, 'psi': 0.7089631150487037}
[S7] START round=16 head_norm_before_train=1.522209 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.4061898357315431, 'auprc': 0.6852370451819507, 'loss_val': 1.1094031839439518, 'psi': 0.5178087195117062}-{'f1_val': 0.5218810288287782, 'auprc': 0.7735188088804059, 'loss_val': 0.8379244078218586, 'psi': 0.6225361408494292}
[S8] START round=16 head_norm_before_train=0.735470 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9979014882320733, 'loss_val': 0.4628030643825159, 'psi': 0.996882457332921}-{'f1_val': 0.9959789603727395, 'auprc': 0.9942618436003071, 'loss_val': 0.4164282136303301, 'psi': 0.9952921136637665}
[S9] START round=16 head_norm_before_train=0.989904 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.6986282184078285, 'auprc': 0.7953803759266568, 'loss_val': 0.4054517017043451, 'psi': 0.7373290814153599}-{'f1_val': 0.6988745369702247, 'auprc': 0.7986528691012507, 'loss_val': 0.4020458711057304, 'psi': 0.738785869822635}
[S10] START round=16 head_norm_before_train=1.610644 (no previous merge yet)
[S10] round=16 local utility u=0.011970 metrics={'f1_val': 0.9955668669630084, 'auprc': 0.9960094846280143, 'loss_val': 0.1279278337237903, 'psi': 0.9957439140290107}-{'f1_val': 0.9955737983388318, 'auprc': 0.9961697945919874, 'loss_val': 0.1523902555671045, 'psi': 0.9958121968400939}
[S11] START round=16 head_norm_before_train=1.795357 (no previous merge yet)
[S11] round=16 local utility u=0.178090 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978460801158907, 'loss_val': 0.07438153906753595, 'psi': 0.9969215325276728}-{'f1_val': 0.9570090367541328, 'auprc': 0.9933720629484315, 'loss_val': 0.18136266707716717, 'psi': 0.9715542472318524}
[S13] START round=16 head_norm_before_train=1.628674 (no previous merge yet)
[S13] round=16 local utility u=0.077249 metrics={'f1_val': 0.6123303733710765, 'auprc': 0.680133465556767, 'loss_val': 0.6772883931832859, 'psi': 0.6394516102453527}-{'f1_val': 0.5896340614620798, 'auprc': 0.6903536082956515, 'loss_val': 0.726268624812508, 'psi': 0.6299218801955084}
[S14] START round=16 head_norm_before_train=0.934603 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.038918 metrics={'f1_val': 0.997010762750862, 'auprc': 0.9963681433770657, 'loss_val': 0.5690488500137535, 'psi': 0.9967537150013435}-{'f1_val': 0.9826751107140723, 'auprc': 0.9965821411446686, 'loss_val': 0.5615137765561176, 'psi': 0.9882379228863107}
[S15] START round=16 head_norm_before_train=0.719328 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.513989 metrics={'f1_val': 0.7013127984932164, 'auprc': 0.7619353234105631, 'loss_val': 0.7170709469224527, 'psi': 0.725561808460155}-{'f1_val': 0.490006606810643, 'auprc': 0.8415883203994959, 'loss_val': 0.7161709554244333, 'psi': 0.6306392922461842}
[S16] START round=16 head_norm_before_train=1.185618 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=1.000000 metrics={'f1_val': 0.8674380894239659, 'auprc': 0.8586878342929326, 'loss_val': 0.6243294000555576, 'psi': 0.8639379873715526}-{'f1_val': 0.4494019417208838, 'auprc': 0.7698897382440707, 'loss_val': 0.8768233621905026, 'psi': 0.5775970603301586}
[S17] START round=16 head_norm_before_train=1.321032 cos_to_last_merge=0.8556 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.856
[S17] round=16 local utility u=0.188323 metrics={'f1_val': 0.41742295488376896, 'auprc': 0.8238190947648093, 'loss_val': 0.6245277423863022, 'psi': 0.5799814108361852}-{'f1_val': 0.4122928626798935, 'auprc': 0.7233004999649546, 'loss_val': 0.6688383342392735, 'psi': 0.5366959175939179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44614
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:44610
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44615
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:44605
[S11] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] cosine check vs S16: cos=0.5203
[S5] RECEIVED delta(kind=head bytes=1791) from S4
[S5] cosine check vs S4: cos=0.9574
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=0.8336
[S9] RECEIVED delta(kind=head bytes=1806) from S10
[S9] cosine check vs S10: cos=-0.0595
[S9] DROPPED delta from S10 (cos=-0.0595 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S11
[S16] cosine check vs S11: cos=0.6427
[S16] RECEIVED delta(kind=head bytes=1805) from S2
[S16] cosine check vs S2: cos=-0.0646
[S16] DROPPED delta from S2 (cos=-0.0646 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S3
[S14] cosine check vs S3: cos=0.8891
[S14] RECEIVED delta(kind=head bytes=1798) from S13
[S14] cosine check vs S13: cos=0.5083
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] cosine check vs S14: cos=0.6617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S17
[S16] cosine check vs S17: cos=-0.0642
[S16] DROPPED delta from S17 (cos=-0.0642 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9962 head_norm=0.794612
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.261554e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9962 head_norm=0.749897 delta_norm=0.226155
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.6723 head_norm=0.975253
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.414067e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7007 head_norm=0.957590 delta_norm=0.141407
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8674 head_norm=1.221573
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.994718e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8578 head_norm=1.386382 delta_norm=0.699472
[S16] aggregate: ROLLBACK (f1_val pre=0.867 post=0.858 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9970 head_norm=0.966281
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.197036e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9966 head_norm=1.041161 delta_norm=0.319704
[S14] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.7013 head_norm=0.771735
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.414099e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.7010 head_norm=0.741805 delta_norm=0.241410
[S15] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.763937 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.7467800441809226, 'loss_val': 0.2694209910098545, 'psi': 0.7194980964960902}-{'f1_val': 0.6751618941205365, 'auprc': 0.9095652469405947, 'loss_val': 0.38585846911248683, 'psi': 0.7689232352485598}
[S3] START round=17 head_norm_before_train=1.345930 cos_to_last_merge=0.8214 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.821
[S3] round=17 local utility u=0.134758 metrics={'f1_val': 0.7005769689796157, 'auprc': 0.9954042312416215, 'loss_val': 0.2745108402181405, 'psi': 0.818507873884418}-{'f1_val': 0.6707470934247142, 'auprc': 0.9931448138965118, 'loss_val': 0.3582686919434944, 'psi': 0.7997061816134332}
[S4] START round=17 head_norm_before_train=0.960642 cos_to_last_merge=0.9858 (last merge round=14)
[S4] round=17 local utility u=0.029787 metrics={'f1_val': 0.93883767669912, 'auprc': 0.9611251287306314, 'loss_val': 0.35935778143048824, 'psi': 0.9477526575117245}-{'f1_val': 0.94186672386172, 'auprc': 0.957016770060314, 'loss_val': 0.42478119731142094, 'psi': 0.9479267423411576}
[S5] START round=17 head_norm_before_train=0.957590 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.416799 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9944967534278937, 'loss_val': 0.49324608030502487, 'psi': 0.8179914918315057}-{'f1_val': 0.672306974371238, 'auprc': 0.7998163609299564, 'loss_val': 0.5747164695345526, 'psi': 0.7233107289947254}
[S6] START round=17 head_norm_before_train=1.601861 (no previous merge yet)
[S6] round=17 local utility u=1.000000 metrics={'f1_val': 0.9486975853868835, 'auprc': 0.9536008936889627, 'loss_val': 0.2800192570744622, 'psi': 0.9506589087077152}-{'f1_val': 0.6407373371658421, 'auprc': 0.8026806943117002, 'loss_val': 0.4196095857100302, 'psi': 0.7055146800241854}
[S7] START round=17 head_norm_before_train=1.544154 (no previous merge yet)
[S7] round=17 local utility u=1.000000 metrics={'f1_val': 0.6339007440517921, 'auprc': 0.7988682075329205, 'loss_val': 0.5835076208782042, 'psi': 0.6998877294442435}-{'f1_val': 0.4061898357315431, 'auprc': 0.6852370451819507, 'loss_val': 1.1094031839439518, 'psi': 0.5178087195117062}
[S8] START round=17 head_norm_before_train=0.749897 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.7175151143444727, 'auprc': 0.9970962941915832, 'loss_val': 0.5317687989988245, 'psi': 0.8293475862833168}-{'f1_val': 0.9962031034001528, 'auprc': 0.9979014882320733, 'loss_val': 0.4628030643825159, 'psi': 0.996882457332921}
[S9] START round=17 head_norm_before_train=1.037291 cos_to_last_merge=0.9965 (last merge round=15)
[S9] round=17 local utility u=0.317983 metrics={'f1_val': 0.6983788730918179, 'auprc': 0.9913796377714812, 'loss_val': 0.35598742459514443, 'psi': 0.8155791789636833}-{'f1_val': 0.6986282184078285, 'auprc': 0.7953803759266568, 'loss_val': 0.4054517017043451, 'psi': 0.7373290814153599}
[S10] START round=17 head_norm_before_train=1.639423 (no previous merge yet)
[S10] round=17 local utility u=0.008615 metrics={'f1_val': 0.9955668669630084, 'auprc': 0.9963505729618443, 'loss_val': 0.11172123975548501, 'psi': 0.9958803493625428}-{'f1_val': 0.9955668669630084, 'auprc': 0.9960094846280143, 'loss_val': 0.1279278337237903, 'psi': 0.9957439140290107}
[S11] START round=17 head_norm_before_train=1.824936 (no previous merge yet)
[S11] round=17 local utility u=0.006802 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.997818178837165, 'loss_val': 0.06319810390049169, 'psi': 0.9971607232837751}-{'f1_val': 0.996305167468861, 'auprc': 0.9978460801158907, 'loss_val': 0.07438153906753595, 'psi': 0.9969215325276728}
[S13] START round=17 head_norm_before_train=1.643544 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5868901667596831, 'auprc': 0.6901528128198262, 'loss_val': 0.8160526374230659, 'psi': 0.6281952251837404}-{'f1_val': 0.6123303733710765, 'auprc': 0.680133465556767, 'loss_val': 0.6772883931832859, 'psi': 0.6394516102453527}
[S14] START round=17 head_norm_before_train=1.041161 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9963862541371908, 'loss_val': 0.5727504150662622, 'psi': 0.9968536774535315}-{'f1_val': 0.997010762750862, 'auprc': 0.9963681433770657, 'loss_val': 0.5690488500137535, 'psi': 0.9967537150013435}
[S15] START round=17 head_norm_before_train=0.741805 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.130317 metrics={'f1_val': 0.6999067830842871, 'auprc': 0.8314292775858221, 'loss_val': 0.6564831405104803, 'psi': 0.7525157808849011}-{'f1_val': 0.7013127984932164, 'auprc': 0.7619353234105631, 'loss_val': 0.7170709469224527, 'psi': 0.725561808460155}
[S16] START round=17 head_norm_before_train=1.386382 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.175563 metrics={'f1_val': 0.8775414622741118, 'auprc': 0.9322201664024449, 'loss_val': 0.5544213147903352, 'psi': 0.899412943925445}-{'f1_val': 0.8674380894239659, 'auprc': 0.8586878342929326, 'loss_val': 0.6243294000555576, 'psi': 0.8639379873715526}
[S17] START round=17 head_norm_before_train=1.336826 cos_to_last_merge=0.8517 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.852
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.41675168536673324, 'auprc': 0.7009741855384057, 'loss_val': 0.6713480520863875, 'psi': 0.5304406854354022}-{'f1_val': 0.41742295488376896, 'auprc': 0.8238190947648093, 'loss_val': 0.6245277423863022, 'psi': 0.5799814108361852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:44610
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:44605
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:44614
[S9] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S15
[S8] cosine check vs S15: cos=0.9167
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] cosine check vs S11: cos=0.9349
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=0.8821
[S14] RECEIVED delta(kind=head bytes=1805) from S9
[S14] cosine check vs S9: cos=0.1357
[S14] RECEIVED delta(kind=head bytes=1794) from S3
[S14] cosine check vs S3: cos=0.8378
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] cosine check vs S16: cos=0.6007
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] cosine check vs S6: cos=0.6031
[S16] RECEIVED delta(kind=head bytes=1796) from S7
[S16] cosine check vs S7: cos=0.3705
[S5] RECEIVED delta(kind=head bytes=1793) from S4
[S5] cosine check vs S4: cos=0.9801
[S9] RECEIVED delta(kind=head bytes=1796) from S10
[S9] cosine check vs S10: cos=-0.0619
[S9] DROPPED delta from S10 (cos=-0.0619 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.7175 head_norm=0.800896
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.630151e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9616 head_norm=0.781878 delta_norm=0.163015
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9972 head_norm=1.066167
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.630959e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9968 head_norm=0.908199 delta_norm=0.363096
[S14] aggregate: ACCEPT kept=['S9', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.6999 head_norm=0.796481
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.723526e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.8479 head_norm=1.005808 delta_norm=0.572353
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7003 head_norm=0.993166
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.014669e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7003 head_norm=1.002071 delta_norm=0.101467
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.6984 head_norm=1.089818
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.571767e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.6984 head_norm=1.010396 delta_norm=0.257177
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9388 head_norm=1.021031
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.475376e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9385 head_norm=1.191022 delta_norm=0.647538
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.8775 head_norm=1.429718
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.529322e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.8769 head_norm=1.310127 delta_norm=0.252932
[S16] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.776998 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.701230889339113, 'auprc': 0.6642338696659572, 'loss_val': 0.2874491606566746, 'psi': 0.6864320814698507}-{'f1_val': 0.7013101313728686, 'auprc': 0.7467800441809226, 'loss_val': 0.2694209910098545, 'psi': 0.7194980964960902}
[S3] START round=18 head_norm_before_train=1.375024 cos_to_last_merge=0.8176 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.818
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.594526871877416, 'auprc': 0.9700742455034999, 'loss_val': 0.4236919422362474, 'psi': 0.7447458213278496}-{'f1_val': 0.7005769689796157, 'auprc': 0.9954042312416215, 'loss_val': 0.2745108402181405, 'psi': 0.818507873884418}
[S4] START round=18 head_norm_before_train=1.191022 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.062712 metrics={'f1_val': 0.9457788550777048, 'auprc': 0.9692764720158584, 'loss_val': 0.30003511497152063, 'psi': 0.9551779018529662}-{'f1_val': 0.93883767669912, 'auprc': 0.9611251287306314, 'loss_val': 0.35935778143048824, 'psi': 0.9477526575117245}
[S5] START round=18 head_norm_before_train=1.002071 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.6729607973746143, 'auprc': 0.8191532729696575, 'loss_val': 0.5531617493683937, 'psi': 0.7314377876126317}-{'f1_val': 0.7003213174339138, 'auprc': 0.9944967534278937, 'loss_val': 0.49324608030502487, 'psi': 0.8179914918315057}
[S6] START round=18 head_norm_before_train=1.622705 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.8220080433786265, 'auprc': 0.9377881061288109, 'loss_val': 0.40066448362716234, 'psi': 0.8683200684787002}-{'f1_val': 0.9486975853868835, 'auprc': 0.9536008936889627, 'loss_val': 0.2800192570744622, 'psi': 0.9506589087077152}
[S7] START round=18 head_norm_before_train=1.560956 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5510783331428494, 'auprc': 0.7785245273094379, 'loss_val': 0.8289418350109968, 'psi': 0.6420568108094848}-{'f1_val': 0.6339007440517921, 'auprc': 0.7988682075329205, 'loss_val': 0.5835076208782042, 'psi': 0.6998877294442435}
[S8] START round=18 head_norm_before_train=0.781878 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.857068 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9977172499318907, 'loss_val': 0.49162419615246, 'psi': 0.9968087620128481}-{'f1_val': 0.7175151143444727, 'auprc': 0.9970962941915832, 'loss_val': 0.5317687989988245, 'psi': 0.8293475862833168}
[S9] START round=18 head_norm_before_train=1.010396 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.6983788730918179, 'auprc': 0.9944231914827913, 'loss_val': 0.39162630195956855, 'psi': 0.8167966004482072}-{'f1_val': 0.6983788730918179, 'auprc': 0.9913796377714812, 'loss_val': 0.35598742459514443, 'psi': 0.8155791789636833}
[S10] START round=18 head_norm_before_train=1.670127 (no previous merge yet)
[S10] round=18 local utility u=0.010813 metrics={'f1_val': 0.9955668669630084, 'auprc': 0.996253273656526, 'loss_val': 0.0898040116478959, 'psi': 0.9958414296404154}-{'f1_val': 0.9955668669630084, 'auprc': 0.9963505729618443, 'loss_val': 0.11172123975548501, 'psi': 0.9958803493625428}
[S11] START round=18 head_norm_before_train=1.853953 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.9565952115230945, 'auprc': 0.9952730486149404, 'loss_val': 0.15350077375015406, 'psi': 0.9720663463598329}-{'f1_val': 0.9967224195815153, 'auprc': 0.997818178837165, 'loss_val': 0.06319810390049169, 'psi': 0.9971607232837751}
[S13] START round=18 head_norm_before_train=1.657757 (no previous merge yet)
[S13] round=18 local utility u=0.117221 metrics={'f1_val': 0.6159971936403436, 'auprc': 0.6720266869618484, 'loss_val': 0.7018748654845922, 'psi': 0.6384089909689454}-{'f1_val': 0.5868901667596831, 'auprc': 0.6901528128198262, 'loss_val': 0.8160526374230659, 'psi': 0.6281952251837404}
[S14] START round=18 head_norm_before_train=0.908199 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9808176246402462, 'auprc': 0.9968905780313865, 'loss_val': 0.5822756253794062, 'psi': 0.9872468059967023}-{'f1_val': 0.9971652929977585, 'auprc': 0.9963862541371908, 'loss_val': 0.5727504150662622, 'psi': 0.9968536774535315}
[S15] START round=18 head_norm_before_train=1.005808 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6922956992310343, 'auprc': 0.7893026286820213, 'loss_val': 0.6004128164002263, 'psi': 0.7310984710114291}-{'f1_val': 0.6999067830842871, 'auprc': 0.8314292775858221, 'loss_val': 0.6564831405104803, 'psi': 0.7525157808849011}
[S16] START round=18 head_norm_before_train=1.310127 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.028109 metrics={'f1_val': 0.8762177111655522, 'auprc': 0.9524900213403036, 'loss_val': 0.5510711489357738, 'psi': 0.9067266352354528}-{'f1_val': 0.8775414622741118, 'auprc': 0.9322201664024449, 'loss_val': 0.5544213147903352, 'psi': 0.899412943925445}
[S17] START round=18 head_norm_before_train=1.352470 cos_to_last_merge=0.8498 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.850
[S17] round=18 local utility u=0.177698 metrics={'f1_val': 0.41922418409813295, 'auprc': 0.8046644414838457, 'loss_val': 0.6418582652143472, 'psi': 0.5734002870524181}-{'f1_val': 0.41675168536673324, 'auprc': 0.7009741855384057, 'loss_val': 0.6713480520863875, 'psi': 0.5304406854354022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:44605
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44614
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:44610
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:44604
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S4
[S5] cosine check vs S4: cos=0.8708
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] cosine check vs S16: cos=0.9362
[S4] RECEIVED delta(kind=head bytes=1806) from S8
[S4] cosine check vs S8: cos=0.3592
[S9] RECEIVED delta(kind=head bytes=1805) from S10
[S9] cosine check vs S10: cos=-0.0688
[S9] DROPPED delta from S10 (cos=-0.0688 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S13
[S14] cosine check vs S13: cos=0.4927
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S17
[S16] cosine check vs S17: cos=-0.0744
[S16] DROPPED delta from S17 (cos=-0.0744 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9808 head_norm=0.940737
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.291240e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9463 head_norm=1.142675 delta_norm=0.729124
[S14] aggregate: ROLLBACK (f1_val pre=0.981 post=0.946 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.6730 head_norm=1.037706
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.058528e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.6721 head_norm=1.102284 delta_norm=0.305853
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9458 head_norm=1.241095
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.100059e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9458 head_norm=0.861202 delta_norm=0.610006
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.6923 head_norm=1.051671
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.625703e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.6931 head_norm=1.185545 delta_norm=0.262570
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.787413 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.701221302557166, 'auprc': 0.6665279674595569, 'loss_val': 0.2991774547492571, 'psi': 0.6873439685181223}-{'f1_val': 0.701230889339113, 'auprc': 0.6642338696659572, 'loss_val': 0.2874491606566746, 'psi': 0.6864320814698507}
[S3] START round=19 head_norm_before_train=1.396855 cos_to_last_merge=0.8146 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.815
[S3] round=19 local utility u=0.474024 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9971194557350164, 'loss_val': 0.19460944845146916, 'psi': 0.819346823309293}-{'f1_val': 0.594526871877416, 'auprc': 0.9700742455034999, 'loss_val': 0.4236919422362474, 'psi': 0.7447458213278496}
[S4] START round=19 head_norm_before_train=0.861202 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9436112536846147, 'auprc': 0.9640347407849144, 'loss_val': 0.3678644572677968, 'psi': 0.9517806485247347}-{'f1_val': 0.9457788550777048, 'auprc': 0.9692764720158584, 'loss_val': 0.30003511497152063, 'psi': 0.9551779018529662}
[S5] START round=19 head_norm_before_train=1.102284 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.354302 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9641752629949558, 'loss_val': 0.4455097010443251, 'psi': 0.8060351407955869}-{'f1_val': 0.6729607973746143, 'auprc': 0.8191532729696575, 'loss_val': 0.5531617493683937, 'psi': 0.7314377876126317}
[S6] START round=19 head_norm_before_train=1.646355 (no previous merge yet)
[S6] round=19 local utility u=0.022500 metrics={'f1_val': 0.8221611048793159, 'auprc': 0.9499284287662069, 'loss_val': 0.3930047104157187, 'psi': 0.8732680344340723}-{'f1_val': 0.8220080433786265, 'auprc': 0.9377881061288109, 'loss_val': 0.40066448362716234, 'psi': 0.8683200684787002}
[S7] START round=19 head_norm_before_train=1.571107 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.5268903221109489, 'auprc': 0.7779738679833724, 'loss_val': 0.8624686314421627, 'psi': 0.6273237404599183}-{'f1_val': 0.5510783331428494, 'auprc': 0.7785245273094379, 'loss_val': 0.8289418350109968, 'psi': 0.6420568108094848}
[S8] START round=19 head_norm_before_train=0.828995 cos_to_last_merge=0.9924 (last merge round=17)
[S8] round=19 local utility u=0.076219 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9979787587139094, 'loss_val': 0.3399704797898828, 'psi': 0.9969133655256555}-{'f1_val': 0.9962031034001528, 'auprc': 0.9977172499318907, 'loss_val': 0.49162419615246, 'psi': 0.9968087620128481}
[S9] START round=19 head_norm_before_train=1.056160 cos_to_last_merge=0.9968 (last merge round=17)
[S9] round=19 local utility u=0.027941 metrics={'f1_val': 0.6986266350165764, 'auprc': 0.9978103492805964, 'loss_val': 0.3473921027072246, 'psi': 0.8183001207221845}-{'f1_val': 0.6983788730918179, 'auprc': 0.9944231914827913, 'loss_val': 0.39162630195956855, 'psi': 0.8167966004482072}
[S10] START round=19 head_norm_before_train=1.695200 (no previous merge yet)
[S10] round=19 local utility u=0.007037 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9953127469794646, 'loss_val': 0.07037729654759098, 'psi': 0.9952121302722039}-{'f1_val': 0.9955668669630084, 'auprc': 0.996253273656526, 'loss_val': 0.0898040116478959, 'psi': 0.9958414296404154}
[S11] START round=19 head_norm_before_train=1.879465 (no previous merge yet)
[S11] round=19 local utility u=0.177294 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9978304446143513, 'loss_val': 0.0473478144537832, 'psi': 0.9971656295946498}-{'f1_val': 0.9565952115230945, 'auprc': 0.9952730486149404, 'loss_val': 0.15350077375015406, 'psi': 0.9720663463598329}
[S13] START round=19 head_norm_before_train=1.670230 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5713642026977667, 'auprc': 0.6931586787054307, 'loss_val': 1.0240030016300388, 'psi': 0.6200819931008323}-{'f1_val': 0.6159971936403436, 'auprc': 0.6720266869618484, 'loss_val': 0.7018748654845922, 'psi': 0.6384089909689454}
[S14] START round=19 head_norm_before_train=1.142675 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.058650 metrics={'f1_val': 0.9955671357481931, 'auprc': 0.9964021179240974, 'loss_val': 0.5520072840317161, 'psi': 0.9959011286185548}-{'f1_val': 0.9808176246402462, 'auprc': 0.9968905780313865, 'loss_val': 0.5822756253794062, 'psi': 0.9872468059967023}
[S15] START round=19 head_norm_before_train=1.185545 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.798763 metrics={'f1_val': 0.8380007895428597, 'auprc': 0.9861543481425663, 'loss_val': 0.46767302381149006, 'psi': 0.8972622129827423}-{'f1_val': 0.6922956992310343, 'auprc': 0.7893026286820213, 'loss_val': 0.6004128164002263, 'psi': 0.7310984710114291}
[S16] START round=19 head_norm_before_train=1.357538 cos_to_last_merge=0.9986 (last merge round=17)
[S16] round=19 local utility u=0.280118 metrics={'f1_val': 0.9194304519081317, 'auprc': 0.9925207196944462, 'loss_val': 0.37020291717617837, 'psi': 0.9486665590226575}-{'f1_val': 0.8762177111655522, 'auprc': 0.9524900213403036, 'loss_val': 0.5510711489357738, 'psi': 0.9067266352354528}
[S17] START round=19 head_norm_before_train=1.373817 cos_to_last_merge=0.8472 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.847
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.4202294641008376, 'auprc': 0.7200037364644678, 'loss_val': 0.6533572356256756, 'psi': 0.5401391730462897}-{'f1_val': 0.41922418409813295, 'auprc': 0.8046644414838457, 'loss_val': 0.6418582652143472, 'psi': 0.5734002870524181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44609
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44615
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:44614
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=0.7090
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.9269
[S9] RECEIVED delta(kind=head bytes=1803) from S10
[S9] cosine check vs S10: cos=-0.0705
[S9] DROPPED delta from S10 (cos=-0.0705 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] cosine check vs S6: cos=0.7271
[S14] RECEIVED delta(kind=head bytes=1794) from S3
[S14] cosine check vs S3: cos=0.5660
[S14] RECEIVED delta(kind=head bytes=1805) from S9
[S14] cosine check vs S9: cos=0.1565
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] cosine check vs S11: cos=0.8615
[S15] RECEIVED delta(kind=head bytes=1795) from S16
[S15] cosine check vs S16: cos=0.9781
[S4] RECEIVED delta(kind=head bytes=1801) from S8
[S4] cosine check vs S8: cos=0.7334
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=0.1227
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9436 head_norm=0.912906
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.762761e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9440 head_norm=0.940596 delta_norm=0.176276
[S4] aggregate: ACCEPT kept=['S6', 'S8'] (k=2/2) mode=median trim_p=0.1
[S4] r=20 psi=0.952 u=0.0000 p_local=0.1791 f1=0.944 auprc=0.964 bytes=19720
[S2] r=20 psi=0.687 u=0.0000 p_local=0.0954 f1=0.701 auprc=0.667 bytes=12588
[S13] r=20 psi=0.620 u=0.0000 p_local=0.1064 f1=0.571 auprc=0.693 bytes=16174
[S7] r=20 psi=0.627 u=0.0000 p_local=0.2316 f1=0.527 auprc=0.778 bytes=16173
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9956 head_norm=1.160712
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.105233e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9931 head_norm=0.910023 delta_norm=0.510523
[S14] aggregate: ACCEPT kept=['S3', 'S9'] (k=2/2) mode=median trim_p=0.1
[S14] r=20 psi=0.996 u=0.0587 p_local=0.1413 f1=0.996 auprc=0.996 bytes=17965
[S3] r=20 psi=0.819 u=0.4740 p_local=0.2136 f1=0.701 auprc=0.997 bytes=17937
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9962 head_norm=0.894011
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.304155e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9955 head_norm=0.979034 delta_norm=0.430416
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.997 u=0.0762 p_local=0.2491 f1=0.996 auprc=0.998 bytes=17957
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.6986 head_norm=1.105481
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.151358e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.6984 head_norm=1.101375 delta_norm=0.215136
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.818 u=0.0279 p_local=0.1069 f1=0.699 auprc=0.998 bytes=14403
[S10] r=20 psi=0.995 u=0.0070 p_local=0.1479 f1=0.995 auprc=0.995 bytes=23377
[S5] r=20 psi=0.806 u=0.3543 p_local=0.2064 f1=0.701 auprc=0.964 bytes=17931
[S6] r=20 psi=0.873 u=0.0225 p_local=0.2555 f1=0.822 auprc=0.950 bytes=14363
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.9194 head_norm=1.409240
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.961511e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.9159 head_norm=1.598409 delta_norm=0.496151
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.949 u=0.2801 p_local=0.2825 f1=0.919 auprc=0.993 bytes=17961
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.8380 head_norm=1.219949
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.432338e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.8905 head_norm=1.022484 delta_norm=0.343234
[S15] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S15] r=20 psi=0.897 u=0.7988 p_local=0.3112 f1=0.838 auprc=0.986 bytes=16171
[S11] r=20 psi=0.997 u=0.1773 p_local=0.1451 f1=0.997 auprc=0.998 bytes=19747
[S17] r=20 psi=0.540 u=0.0000 p_local=0.0980 f1=0.420 auprc=0.720 bytes=14384
[S2] START round=20 head_norm_before_train=1.793448 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7015604095051192, 'auprc': 0.679566171907916, 'loss_val': 0.35816831341554795, 'psi': 0.6927627144662379}-{'f1_val': 0.701221302557166, 'auprc': 0.6665279674595569, 'loss_val': 0.2991774547492571, 'psi': 0.6873439685181223}
[S3] START round=20 head_norm_before_train=1.422129 cos_to_last_merge=0.8121 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.812
[S3] round=20 local utility u=0.710903 metrics={'f1_val': 0.9307578479511782, 'auprc': 0.9986518206285738, 'loss_val': 0.15695675354785324, 'psi': 0.9579154370221364}-{'f1_val': 0.7008317350254774, 'auprc': 0.9971194557350164, 'loss_val': 0.19460944845146916, 'psi': 0.819346823309293}
[S4] START round=20 head_norm_before_train=0.940596 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9394789502907239, 'auprc': 0.9069425574715977, 'loss_val': 0.3876745032858886, 'psi': 0.9264643931630735}-{'f1_val': 0.9436112536846147, 'auprc': 0.9640347407849144, 'loss_val': 0.3678644572677968, 'psi': 0.9517806485247347}
[S5] START round=20 head_norm_before_train=1.138654 cos_to_last_merge=0.9983 (last merge round=18)
[S5] round=20 local utility u=0.060194 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9872808901119228, 'loss_val': 0.3944421871955384, 'psi': 0.8152778124482376}-{'f1_val': 0.7006083926626743, 'auprc': 0.9641752629949558, 'loss_val': 0.4455097010443251, 'psi': 0.8060351407955869}
[S6] START round=20 head_norm_before_train=1.670247 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.6262158220324192, 'auprc': 0.7971694157564543, 'loss_val': 0.7105927222468297, 'psi': 0.6945972595220333}-{'f1_val': 0.8221611048793159, 'auprc': 0.9499284287662069, 'loss_val': 0.3930047104157187, 'psi': 0.8732680344340723}
[S7] START round=20 head_norm_before_train=1.577544 (no previous merge yet)
[S7] round=20 local utility u=0.434379 metrics={'f1_val': 0.6228922776157475, 'auprc': 0.7943825542388054, 'loss_val': 0.6189478997140934, 'psi': 0.6914883882649707}-{'f1_val': 0.5268903221109489, 'auprc': 0.7779738679833724, 'loss_val': 0.8624686314421627, 'psi': 0.6273237404599183}
[S8] START round=20 head_norm_before_train=0.979034 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000385 metrics={'f1_val': 0.9952713382688878, 'auprc': 0.9984488321232535, 'loss_val': 0.3350210921034008, 'psi': 0.996542335810634}-{'f1_val': 0.9962031034001528, 'auprc': 0.9979787587139094, 'loss_val': 0.3399704797898828, 'psi': 0.9969133655256555}
[S9] START round=20 head_norm_before_train=1.101375 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.6991225794116844, 'auprc': 0.9962360101335288, 'loss_val': 0.36139756793950095, 'psi': 0.8179679517004221}-{'f1_val': 0.6986266350165764, 'auprc': 0.9978103492805964, 'loss_val': 0.3473921027072246, 'psi': 0.8183001207221845}
[S10] START round=20 head_norm_before_train=1.722200 (no previous merge yet)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.994729721313035, 'auprc': 0.9924915244833676, 'loss_val': 0.06393204370711711, 'psi': 0.993834442581168}-{'f1_val': 0.9951450524673635, 'auprc': 0.9953127469794646, 'loss_val': 0.07037729654759098, 'psi': 0.9952121302722039}
[S11] START round=20 head_norm_before_train=1.901631 (no previous merge yet)
[S11] round=20 local utility u=0.000648 metrics={'f1_val': 0.996305167468861, 'auprc': 0.997879181912405, 'loss_val': 0.04369360366571334, 'psi': 0.9969347732462785}-{'f1_val': 0.9967224195815153, 'auprc': 0.9978304446143513, 'loss_val': 0.0473478144537832, 'psi': 0.9971656295946498}
[S13] START round=20 head_norm_before_train=1.680398 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5649928210558749, 'auprc': 0.6951485993595948, 'loss_val': 1.0346600558132568, 'psi': 0.6170551323773629}-{'f1_val': 0.5713642026977667, 'auprc': 0.6931586787054307, 'loss_val': 1.0240030016300388, 'psi': 0.6200819931008323}
[S14] START round=20 head_norm_before_train=0.910023 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.042392 metrics={'f1_val': 0.997010762750862, 'auprc': 0.9967048426977589, 'loss_val': 0.47679300980073336, 'psi': 0.9968883947296208}-{'f1_val': 0.9955671357481931, 'auprc': 0.9964021179240974, 'loss_val': 0.5520072840317161, 'psi': 0.9959011286185548}
[S15] START round=20 head_norm_before_train=1.022484 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6971210240519014, 'auprc': 0.9782195795824877, 'loss_val': 0.4872204308490913, 'psi': 0.8095604462641359}-{'f1_val': 0.8380007895428597, 'auprc': 0.9861543481425663, 'loss_val': 0.46767302381149006, 'psi': 0.8972622129827423}
[S16] START round=20 head_norm_before_train=1.598409 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.237286 metrics={'f1_val': 0.9652666392211924, 'auprc': 0.9950707346515277, 'loss_val': 0.17829907596045216, 'psi': 0.9771882773933265}-{'f1_val': 0.9194304519081317, 'auprc': 0.9925207196944462, 'loss_val': 0.37020291717617837, 'psi': 0.9486665590226575}
[S17] START round=20 head_norm_before_train=1.399076 cos_to_last_merge=0.8445 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.844
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.41912911833146915, 'auprc': 0.7261635111782188, 'loss_val': 0.6680671272614032, 'psi': 0.541942875470169}-{'f1_val': 0.4202294641008376, 'auprc': 0.7200037364644678, 'loss_val': 0.6533572356256756, 'psi': 0.5401391730462897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:44604
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44615
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:44614
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] cosine check vs S14: cos=0.3498
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.9736
[S14] RECEIVED delta(kind=head bytes=1791) from S3
[S14] cosine check vs S3: cos=0.7537
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] cosine check vs S7: cos=0.2540
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] cosine check vs S11: cos=0.9692
[S4] RECEIVED delta(kind=head bytes=1800) from S8
[S4] cosine check vs S8: cos=0.5488
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] cosine check vs S16: cos=0.8770
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.6991 head_norm=1.141957
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.335414e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.6991 head_norm=1.147764 delta_norm=0.133541
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.086 → S14@127.0.0.1:44614
[S10] ⇄ pheromone p=0.118 → S9@127.0.0.1:44610
[S6] ⇄ pheromone p=0.204 → S4@127.0.0.1:44604
[S13] ⇄ pheromone p=0.085 → S14@127.0.0.1:44614
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9395 head_norm=0.992875
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.811300e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9399 head_norm=0.890937 delta_norm=0.481130
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.143 → S5@127.0.0.1:44605
[S2] ⇄ pheromone p=0.076 → S16@127.0.0.1:44616
[S5] ⇄ pheromone p=0.177 → S9@127.0.0.1:44610
[S3] ⇄ pheromone p=0.313 → S14@127.0.0.1:44614
[S7] ⇄ pheromone p=0.272 → S16@127.0.0.1:44616
[S8] ⇄ pheromone p=0.199 → S4@127.0.0.1:44604
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9653 head_norm=1.642697
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.806651e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9651 head_norm=1.416493 delta_norm=0.380665
[S16] aggregate: ACCEPT kept=['S7', 'S11'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.273 → S15@127.0.0.1:44615
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9970 head_norm=0.942202
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.827364e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9969 head_norm=1.124018 delta_norm=0.482736
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.122 → S15@127.0.0.1:44615
[S11] ⇄ pheromone p=0.116 → S16@127.0.0.1:44616
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.6971 head_norm=1.060571
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.692987e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.6981 head_norm=0.983554 delta_norm=0.169299
[S15] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.249 → S8@127.0.0.1:44609
[S17] ⇄ pheromone p=0.078 → S16@127.0.0.1:44616
[S2] START round=21 head_norm_before_train=1.800858 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.6651034845962341, 'loss_val': 0.33449099791096837, 'psi': 0.6869364835768013}-{'f1_val': 0.7015604095051192, 'auprc': 0.679566171907916, 'loss_val': 0.35816831341554795, 'psi': 0.6927627144662379}
[S3] START round=21 head_norm_before_train=1.450916 cos_to_last_merge=0.8102 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.810
[S3] round=21 local utility u=0.112297 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9986603211966434, 'loss_val': 0.11405169944087937, 'psi': 0.9760852791419234}-{'f1_val': 0.9307578479511782, 'auprc': 0.9986518206285738, 'loss_val': 0.15695675354785324, 'psi': 0.9579154370221364}
[S4] START round=21 head_norm_before_train=0.890937 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.109653 metrics={'f1_val': 0.9452550753848301, 'auprc': 0.9701229263420237, 'loss_val': 0.3925664643461375, 'psi': 0.9552022157677076}-{'f1_val': 0.9394789502907239, 'auprc': 0.9069425574715977, 'loss_val': 0.3876745032858886, 'psi': 0.9264643931630735}
[S5] START round=21 head_norm_before_train=1.168900 cos_to_last_merge=0.9952 (last merge round=18)
[S5] round=21 local utility u=0.025306 metrics={'f1_val': 0.7006099296049884, 'auprc': 0.9899262925339803, 'loss_val': 0.3517707181445682, 'psi': 0.8163364747765851}-{'f1_val': 0.7006090940057808, 'auprc': 0.9872808901119228, 'loss_val': 0.3944421871955384, 'psi': 0.8152778124482376}
[S6] START round=21 head_norm_before_train=1.691681 (no previous merge yet)
[S6] round=21 local utility u=1.000000 metrics={'f1_val': 0.9438372356225717, 'auprc': 0.9630004153579119, 'loss_val': 0.208266535686541, 'psi': 0.9515025075167077}-{'f1_val': 0.6262158220324192, 'auprc': 0.7971694157564543, 'loss_val': 0.7105927222468297, 'psi': 0.6945972595220333}
[S7] START round=21 head_norm_before_train=1.585664 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.5725118399843832, 'auprc': 0.7828499728873958, 'loss_val': 0.7419232359580898, 'psi': 0.6566470931455882}-{'f1_val': 0.6228922776157475, 'auprc': 0.7943825542388054, 'loss_val': 0.6189478997140934, 'psi': 0.6914883882649707}
[S8] START round=21 head_norm_before_train=1.031848 cos_to_last_merge=0.9951 (last merge round=19)
[S8] round=21 local utility u=0.047021 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9991012524181737, 'loss_val': 0.248526252888742, 'psi': 0.9973623630073611}-{'f1_val': 0.9952713382688878, 'auprc': 0.9984488321232535, 'loss_val': 0.3350210921034008, 'psi': 0.996542335810634}
[S9] START round=21 head_norm_before_train=1.147764 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.001994 metrics={'f1_val': 0.7001161632660122, 'auprc': 0.9943501760488258, 'loss_val': 0.3577126853129437, 'psi': 0.8178097683791377}-{'f1_val': 0.6991225794116844, 'auprc': 0.9962360101335288, 'loss_val': 0.36139756793950095, 'psi': 0.8179679517004221}
[S10] START round=21 head_norm_before_train=1.749887 (no previous merge yet)
[S10] round=21 local utility u=0.009210 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9954175880861278, 'loss_val': 0.05678194729649531, 'psi': 0.9952540667148693}-{'f1_val': 0.994729721313035, 'auprc': 0.9924915244833676, 'loss_val': 0.06393204370711711, 'psi': 0.993834442581168}
[S11] START round=21 head_norm_before_train=1.922875 (no previous merge yet)
[S11] round=21 local utility u=0.001821 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978772359500664, 'loss_val': 0.04004648769089492, 'psi': 0.9969339948613432}-{'f1_val': 0.996305167468861, 'auprc': 0.997879181912405, 'loss_val': 0.04369360366571334, 'psi': 0.9969347732462785}
[S13] START round=21 head_norm_before_train=1.687603 (no previous merge yet)
[S13] round=21 local utility u=0.353506 metrics={'f1_val': 0.6271604327319418, 'auprc': 0.6704783336005813, 'loss_val': 0.6266421350386752, 'psi': 0.6444875930793976}-{'f1_val': 0.5649928210558749, 'auprc': 0.6951485993595948, 'loss_val': 1.0346600558132568, 'psi': 0.6170551323773629}
[S14] START round=21 head_norm_before_train=1.124018 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.028902 metrics={'f1_val': 0.996029947855771, 'auprc': 0.998599049631837, 'loss_val': 0.41878714497611985, 'psi': 0.9970575885661974}-{'f1_val': 0.997010762750862, 'auprc': 0.9967048426977589, 'loss_val': 0.47679300980073336, 'psi': 0.9968883947296208}
[S15] START round=21 head_norm_before_train=0.983554 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.385157 metrics={'f1_val': 0.8135349526383964, 'auprc': 0.9847272860377064, 'loss_val': 0.434912128026222, 'psi': 0.8820118859981204}-{'f1_val': 0.6971210240519014, 'auprc': 0.9782195795824877, 'loss_val': 0.4872204308490913, 'psi': 0.8095604462641359}
[S16] START round=21 head_norm_before_train=1.416493 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.099154 metrics={'f1_val': 0.9906266689161731, 'auprc': 0.9945618137268459, 'loss_val': 0.13062420729905957, 'psi': 0.9922007268404422}-{'f1_val': 0.9652666392211924, 'auprc': 0.9950707346515277, 'loss_val': 0.17829907596045216, 'psi': 0.9771882773933265}
[S17] START round=21 head_norm_before_train=1.424666 cos_to_last_merge=0.8419 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.842
[S17] round=21 local utility u=0.820435 metrics={'f1_val': 0.662847296416896, 'auprc': 0.7916319313917642, 'loss_val': 0.6859108080773496, 'psi': 0.7143611504068432}-{'f1_val': 0.41912911833146915, 'auprc': 0.7261635111782188, 'loss_val': 0.6680671272614032, 'psi': 0.541942875470169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:44610
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44615
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S16
[S15] cosine check vs S16: cos=0.8852
[S14] RECEIVED delta(kind=head bytes=1802) from S13
[S14] cosine check vs S13: cos=0.4645
[S4] RECEIVED delta(kind=head bytes=1802) from S8
[S4] cosine check vs S8: cos=0.8670
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] cosine check vs S6: cos=0.5134
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=0.3399
[S8] RECEIVED delta(kind=head bytes=1795) from S15
[S8] cosine check vs S15: cos=0.9139
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.9859
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] cosine check vs S4: cos=0.7655
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] cosine check vs S11: cos=0.9058
[S9] RECEIVED delta(kind=head bytes=1805) from S10
[S9] cosine check vs S10: cos=-0.0608
[S9] DROPPED delta from S10 (cos=-0.0608 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S3
[S14] cosine check vs S3: cos=0.9532
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=0.2044
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S17
[S16] cosine check vs S17: cos=-0.0748
[S16] DROPPED delta from S17 (cos=-0.0748 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9962 head_norm=1.089202
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.216646e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9936 head_norm=1.035420 delta_norm=0.221665
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9453 head_norm=0.943729
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.595330e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9453 head_norm=0.962982 delta_norm=0.259533
[S4] aggregate: ACCEPT kept=['S8', 'S6'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.8135 head_norm=1.027667
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.993844e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.8872 head_norm=0.952476 delta_norm=0.199384
[S15] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.9906 head_norm=1.462667
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.374358e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.9898 head_norm=1.662656 delta_norm=0.437436
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.7001 head_norm=1.186664
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.001975e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.7001 head_norm=1.187480 delta_norm=0.100198
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.7006 head_norm=1.196714
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.852263e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.7006 head_norm=1.006467 delta_norm=0.385226
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9960 head_norm=1.157478
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.452902e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9960 head_norm=1.029602 delta_norm=0.245290
[S14] aggregate: ACCEPT kept=['S13', 'S3', 'S9'] (k=3/3) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.809306 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7017525803949645, 'auprc': 0.6654377771509852, 'loss_val': 0.3420417667046097, 'psi': 0.6872266590973728}-{'f1_val': 0.7014918162305126, 'auprc': 0.6651034845962341, 'loss_val': 0.33449099791096837, 'psi': 0.6869364835768013}
[S3] START round=22 head_norm_before_train=1.483710 cos_to_last_merge=0.8088 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.809
[S3] round=22 local utility u=0.125195 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.998453517096651, 'loss_val': 0.08351902287591376, 'psi': 0.998050304665619}-{'f1_val': 0.9610352511054436, 'auprc': 0.9986603211966434, 'loss_val': 0.11405169944087937, 'psi': 0.9760852791419234}
[S4] START round=22 head_norm_before_train=0.962982 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.024282 metrics={'f1_val': 0.9447108969996209, 'auprc': 0.9700685942143275, 'loss_val': 0.3405736293938923, 'psi': 0.9548539758855035}-{'f1_val': 0.9452550753848301, 'auprc': 0.9701229263420237, 'loss_val': 0.3925664643461375, 'psi': 0.9552022157677076}
[S5] START round=22 head_norm_before_train=1.006467 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.6804408678664731, 'auprc': 0.9641083437914612, 'loss_val': 0.4606189059185891, 'psi': 0.7939078582364683}-{'f1_val': 0.7006099296049884, 'auprc': 0.9899262925339803, 'loss_val': 0.3517707181445682, 'psi': 0.8163364747765851}
[S6] START round=22 head_norm_before_train=1.710305 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.822205096856841, 'auprc': 0.9514211748379494, 'loss_val': 0.3616155038944577, 'psi': 0.8738915280492843}-{'f1_val': 0.9438372356225717, 'auprc': 0.9630004153579119, 'loss_val': 0.208266535686541, 'psi': 0.9515025075167077}
[S7] START round=22 head_norm_before_train=1.598154 (no previous merge yet)
[S7] round=22 local utility u=0.056365 metrics={'f1_val': 0.5853440510935382, 'auprc': 0.7856695812559229, 'loss_val': 0.7146461548974838, 'psi': 0.665474263158492}-{'f1_val': 0.5725118399843832, 'auprc': 0.7828499728873958, 'loss_val': 0.7419232359580898, 'psi': 0.6566470931455882}
[S8] START round=22 head_norm_before_train=1.035420 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9890186369943099, 'loss_val': 0.39796904542915645, 'psi': 0.8239787554381114}-{'f1_val': 0.9962031034001528, 'auprc': 0.9991012524181737, 'loss_val': 0.248526252888742, 'psi': 0.9973623630073611}
[S9] START round=22 head_norm_before_train=1.187480 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.6983088075561159, 'auprc': 0.9954806269037231, 'loss_val': 0.35735775475284637, 'psi': 0.8171775352951587}-{'f1_val': 0.7001161632660122, 'auprc': 0.9943501760488258, 'loss_val': 0.3577126853129437, 'psi': 0.8178097683791377}
[S10] START round=22 head_norm_before_train=1.774541 (no previous merge yet)
[S10] round=22 local utility u=0.004891 metrics={'f1_val': 0.9955668669630084, 'auprc': 0.9965599389920539, 'loss_val': 0.05295794888116011, 'psi': 0.9959640957746265}-{'f1_val': 0.9951450524673635, 'auprc': 0.9954175880861278, 'loss_val': 0.05678194729649531, 'psi': 0.9952540667148693}
[S11] START round=22 head_norm_before_train=1.942204 (no previous merge yet)
[S11] round=22 local utility u=0.001450 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978760320104476, 'loss_val': 0.037142889080396015, 'psi': 0.9969335132854956}-{'f1_val': 0.996305167468861, 'auprc': 0.9978772359500664, 'loss_val': 0.04004648769089492, 'psi': 0.9969339948613432}
[S13] START round=22 head_norm_before_train=1.693779 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5760576272380342, 'auprc': 0.6922192722607173, 'loss_val': 0.8999125270101906, 'psi': 0.6225222852471075}-{'f1_val': 0.6271604327319418, 'auprc': 0.6704783336005813, 'loss_val': 0.6266421350386752, 'psi': 0.6444875930793976}
[S14] START round=22 head_norm_before_train=1.029602 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.007876 metrics={'f1_val': 0.9951088338021451, 'auprc': 0.9985614535691025, 'loss_val': 0.3973949294470163, 'psi': 0.996489881708928}-{'f1_val': 0.996029947855771, 'auprc': 0.998599049631837, 'loss_val': 0.41878714497611985, 'psi': 0.9970575885661974}
[S15] START round=22 head_norm_before_train=0.952476 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.8234457072613638, 'auprc': 0.9426073912833486, 'loss_val': 0.4408531509679791, 'psi': 0.8711103808701577}-{'f1_val': 0.8135349526383964, 'auprc': 0.9847272860377064, 'loss_val': 0.434912128026222, 'psi': 0.8820118859981204}
[S16] START round=22 head_norm_before_train=1.662656 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8785426989226743, 'auprc': 0.9780115604106072, 'loss_val': 0.5501887810749257, 'psi': 0.9183302435178475}-{'f1_val': 0.9906266689161731, 'auprc': 0.9945618137268459, 'loss_val': 0.13062420729905957, 'psi': 0.9922007268404422}
[S17] START round=22 head_norm_before_train=1.449709 cos_to_last_merge=0.8402 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.840
[S17] round=22 local utility u=0.031265 metrics={'f1_val': 0.657335852124974, 'auprc': 0.8183941549107271, 'loss_val': 0.6705985230736328, 'psi': 0.7217591732392752}-{'f1_val': 0.662847296416896, 'auprc': 0.7916319313917642, 'loss_val': 0.6859108080773496, 'psi': 0.7143611504068432}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:44605
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44614
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:44615
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S4
[S5] cosine check vs S4: cos=0.9568
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] cosine check vs S11: cos=0.9791
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] cosine check vs S7: cos=0.2214
[S14] RECEIVED delta(kind=head bytes=1798) from S3
[S14] cosine check vs S3: cos=0.8876
[S15] RECEIVED delta(kind=head bytes=1795) from S14
[S15] cosine check vs S14: cos=0.4963
[S9] RECEIVED delta(kind=head bytes=1805) from S10
[S9] cosine check vs S10: cos=-0.0587
[S9] DROPPED delta from S10 (cos=-0.0587 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S17
[S16] cosine check vs S17: cos=-0.0673
[S16] DROPPED delta from S17 (cos=-0.0673 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.8234 head_norm=0.999447
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.191932e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.7151 head_norm=0.893624 delta_norm=0.519193
[S15] aggregate: ROLLBACK (f1_val pre=0.823 post=0.715 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.6804 head_norm=1.034469
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.512439e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7006 head_norm=1.017049 delta_norm=0.151244
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.8785 head_norm=1.699717
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.138174e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.8790 head_norm=1.451860 delta_norm=0.413817
[S16] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9951 head_norm=1.066469
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.749675e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9955 head_norm=1.254191 delta_norm=0.374967
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.819549 (no previous merge yet)
[S2] round=23 local utility u=0.031928 metrics={'f1_val': 0.7017525803949645, 'auprc': 0.6809505041173436, 'loss_val': 0.3247246514513193, 'psi': 0.6934317498839161}-{'f1_val': 0.7017525803949645, 'auprc': 0.6654377771509852, 'loss_val': 0.3420417667046097, 'psi': 0.6872266590973728}
[S3] START round=23 head_norm_before_train=1.513219 cos_to_last_merge=0.8076 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.808
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.960531351117436, 'auprc': 0.9983984458133944, 'loss_val': 0.1261575943377396, 'psi': 0.9756781889958195}-{'f1_val': 0.9977814963782642, 'auprc': 0.998453517096651, 'loss_val': 0.08351902287591376, 'psi': 0.998050304665619}
[S4] START round=23 head_norm_before_train=1.021959 cos_to_last_merge=0.9970 (last merge round=21)
[S4] round=23 local utility u=0.019910 metrics={'f1_val': 0.9431861457235013, 'auprc': 0.9737607422580066, 'loss_val': 0.30268067506445506, 'psi': 0.9554159843373035}-{'f1_val': 0.9447108969996209, 'auprc': 0.9700685942143275, 'loss_val': 0.3405736293938923, 'psi': 0.9548539758855035}
[S5] START round=23 head_norm_before_train=1.017049 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.6651072588115414, 'auprc': 0.957798754905549, 'loss_val': 0.47901226559377325, 'psi': 0.7821838572491444}-{'f1_val': 0.6804408678664731, 'auprc': 0.9641083437914612, 'loss_val': 0.4606189059185891, 'psi': 0.7939078582364683}
[S6] START round=23 head_norm_before_train=1.726039 (no previous merge yet)
[S6] round=23 local utility u=0.539208 metrics={'f1_val': 0.9643233057755316, 'auprc': 0.9676933060266906, 'loss_val': 0.18472532146694667, 'psi': 0.9656713058759953}-{'f1_val': 0.822205096856841, 'auprc': 0.9514211748379494, 'loss_val': 0.3616155038944577, 'psi': 0.8738915280492843}
[S7] START round=23 head_norm_before_train=1.617308 (no previous merge yet)
[S7] round=23 local utility u=0.036647 metrics={'f1_val': 0.5924535055571215, 'auprc': 0.7873944236291639, 'loss_val': 0.6891837198955659, 'psi': 0.6704298727859385}-{'f1_val': 0.5853440510935382, 'auprc': 0.7856695812559229, 'loss_val': 0.7146461548974838, 'psi': 0.665474263158492}
[S8] START round=23 head_norm_before_train=1.081721 cos_to_last_merge=0.9973 (last merge round=21)
[S8] round=23 local utility u=0.902289 metrics={'f1_val': 0.9918872479736266, 'auprc': 0.998153456664505, 'loss_val': 0.2884057427600121, 'psi': 0.994393731449978}-{'f1_val': 0.7139521677339791, 'auprc': 0.9890186369943099, 'loss_val': 0.39796904542915645, 'psi': 0.8239787554381114}
[S9] START round=23 head_norm_before_train=1.224230 cos_to_last_merge=0.9981 (last merge round=21)
[S9] round=23 local utility u=0.020828 metrics={'f1_val': 0.6996190875982814, 'auprc': 0.9944164741584145, 'loss_val': 0.32037014949945064, 'psi': 0.8175380422223346}-{'f1_val': 0.6983088075561159, 'auprc': 0.9954806269037231, 'loss_val': 0.35735775475284637, 'psi': 0.8171775352951587}
[S10] START round=23 head_norm_before_train=1.794980 (no previous merge yet)
[S10] round=23 local utility u=0.001000 metrics={'f1_val': 0.9955668669630084, 'auprc': 0.9965972564997906, 'loss_val': 0.05107069764294609, 'psi': 0.9959790227777212}-{'f1_val': 0.9955668669630084, 'auprc': 0.9965599389920539, 'loss_val': 0.05295794888116011, 'psi': 0.9959640957746265}
[S11] START round=23 head_norm_before_train=1.961699 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9532392735645093, 'auprc': 0.9929333303102126, 'loss_val': 0.20307441956198402, 'psi': 0.9691168962627907}-{'f1_val': 0.996305167468861, 'auprc': 0.9978760320104476, 'loss_val': 0.037142889080396015, 'psi': 0.9969335132854956}
[S13] START round=23 head_norm_before_train=1.703465 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5779046095719566, 'auprc': 0.6900227931506036, 'loss_val': 0.9367791155449792, 'psi': 0.6227518830034153}-{'f1_val': 0.5760576272380342, 'auprc': 0.6922192722607173, 'loss_val': 0.8999125270101906, 'psi': 0.6225222852471075}
[S14] START round=23 head_norm_before_train=1.254191 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.046058 metrics={'f1_val': 0.9974515471354712, 'auprc': 0.9987153613986381, 'loss_val': 0.3197973358711878, 'psi': 0.997957072840738}-{'f1_val': 0.9951088338021451, 'auprc': 0.9985614535691025, 'loss_val': 0.3973949294470163, 'psi': 0.996489881708928}
[S15] START round=23 head_norm_before_train=0.893624 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7893695233346856, 'auprc': 0.9157710695509687, 'loss_val': 0.48899325380507513, 'psi': 0.8399301418211989}-{'f1_val': 0.8234457072613638, 'auprc': 0.9426073912833486, 'loss_val': 0.4408531509679791, 'psi': 0.8711103808701577}
[S16] START round=23 head_norm_before_train=1.451860 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.557647 metrics={'f1_val': 0.9865080825229962, 'auprc': 0.994035938317323, 'loss_val': 0.13075932822806108, 'psi': 0.9895192248407269}-{'f1_val': 0.8785426989226743, 'auprc': 0.9780115604106072, 'loss_val': 0.5501887810749257, 'psi': 0.9183302435178475}
[S17] START round=23 head_norm_before_train=1.473679 cos_to_last_merge=0.8373 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.837
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.6178761788550691, 'auprc': 0.7619441855739374, 'loss_val': 0.717657798578694, 'psi': 0.6755033815426164}-{'f1_val': 0.657335852124974, 'auprc': 0.8183941549107271, 'loss_val': 0.6705985230736328, 'psi': 0.7217591732392752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:44604
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:44605
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[S16] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S16
[S15] cosine check vs S16: cos=0.4680
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] cosine check vs S14: cos=0.8068
[S4] RECEIVED delta(kind=head bytes=1799) from S8
[S4] cosine check vs S8: cos=0.7065
[S9] RECEIVED delta(kind=head bytes=1804) from S10
[S9] cosine check vs S10: cos=-0.0594
[S9] DROPPED delta from S10 (cos=-0.0594 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] cosine check vs S4: cos=0.9871
[S16] RECEIVED delta(kind=head bytes=1797) from S2
[S16] cosine check vs S2: cos=-0.0125
[S16] DROPPED delta from S2 (cos=-0.0125 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S7
[S16] cosine check vs S7: cos=0.4219
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=0.1584
[S4] RECEIVED delta(kind=head bytes=1792) from S6
[S4] cosine check vs S6: cos=0.7144
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.6651 head_norm=1.048776
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.603470e-02
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.6736 head_norm=1.056733 delta_norm=0.086035
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9975 head_norm=1.293787
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.283552e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9969 head_norm=0.971769 delta_norm=0.828355
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9865 head_norm=1.488989
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.406352e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9880 head_norm=1.315622 delta_norm=0.840635
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9432 head_norm=1.071561
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.703644e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9426 head_norm=1.059846 delta_norm=0.170364
[S4] aggregate: ACCEPT kept=['S8', 'S6'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.7894 head_norm=0.938762
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.109978e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.8975 head_norm=0.928198 delta_norm=0.210998
[S15] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.831208 (no previous merge yet)
[S2] round=24 local utility u=0.472657 metrics={'f1_val': 0.8262471891448172, 'auprc': 0.7490969194283332, 'loss_val': 0.3308179153517099, 'psi': 0.7953870812582235}-{'f1_val': 0.7017525803949645, 'auprc': 0.6809505041173436, 'loss_val': 0.3247246514513193, 'psi': 0.6934317498839161}
[S3] START round=24 head_norm_before_train=1.540130 cos_to_last_merge=0.8065 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.807
[S3] round=24 local utility u=0.144170 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9985342147329445, 'loss_val': 0.06189601198741004, 'psi': 0.9980997064537536}-{'f1_val': 0.960531351117436, 'auprc': 0.9983984458133944, 'loss_val': 0.1261575943377396, 'psi': 0.9756781889958195}
[S4] START round=24 head_norm_before_train=1.059846 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9393104556946399, 'auprc': 0.9578968953414171, 'loss_val': 0.3313986629613355, 'psi': 0.9467450315533508}-{'f1_val': 0.9431861457235013, 'auprc': 0.9737607422580066, 'loss_val': 0.30268067506445506, 'psi': 0.9554159843373035}
[S5] START round=24 head_norm_before_train=1.056733 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.6451951113793298, 'auprc': 0.9187191983800939, 'loss_val': 0.4904645391846402, 'psi': 0.7546047461796355}-{'f1_val': 0.6651072588115414, 'auprc': 0.957798754905549, 'loss_val': 0.47901226559377325, 'psi': 0.7821838572491444}
[S6] START round=24 head_norm_before_train=1.741010 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.9426250976903324, 'auprc': 0.9692662289211335, 'loss_val': 0.19637189278632064, 'psi': 0.9532815501826528}-{'f1_val': 0.9643233057755316, 'auprc': 0.9676933060266906, 'loss_val': 0.18472532146694667, 'psi': 0.9656713058759953}
[S7] START round=24 head_norm_before_train=1.630329 (no previous merge yet)
[S7] round=24 local utility u=0.311679 metrics={'f1_val': 0.6558506340337046, 'auprc': 0.8056460888306616, 'loss_val': 0.5009638085994184, 'psi': 0.7157688159524873}-{'f1_val': 0.5924535055571215, 'auprc': 0.7873944236291639, 'loss_val': 0.6891837198955659, 'psi': 0.6704298727859385}
[S8] START round=24 head_norm_before_train=1.130174 cos_to_last_merge=0.9909 (last merge round=21)
[S8] round=24 local utility u=0.069258 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9992551565827008, 'loss_val': 0.1680256290984849, 'psi': 0.9963174789923963}-{'f1_val': 0.9918872479736266, 'auprc': 0.998153456664505, 'loss_val': 0.2884057427600121, 'psi': 0.994393731449978}
[S9] START round=24 head_norm_before_train=1.259814 cos_to_last_merge=0.9940 (last merge round=21)
[S9] round=24 local utility u=0.017913 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9952880319005678, 'loss_val': 0.2976127113376516, 'psi': 0.8189320284673146}-{'f1_val': 0.6996190875982814, 'auprc': 0.9944164741584145, 'loss_val': 0.32037014949945064, 'psi': 0.8175380422223346}
[S10] START round=24 head_norm_before_train=1.815300 (no previous merge yet)
[S10] round=24 local utility u=0.002833 metrics={'f1_val': 0.9955668669630084, 'auprc': 0.9966352279417142, 'loss_val': 0.045518114777640464, 'psi': 0.9959942113544907}-{'f1_val': 0.9955668669630084, 'auprc': 0.9965972564997906, 'loss_val': 0.05107069764294609, 'psi': 0.9959790227777212}
[S11] START round=24 head_norm_before_train=1.976810 (no previous merge yet)
[S11] round=24 local utility u=0.221445 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978586316961834, 'loss_val': 0.03335533997589865, 'psi': 0.99692655315979}-{'f1_val': 0.9532392735645093, 'auprc': 0.9929333303102126, 'loss_val': 0.20307441956198402, 'psi': 0.9691168962627907}
[S13] START round=24 head_norm_before_train=1.713366 (no previous merge yet)
[S13] round=24 local utility u=0.148689 metrics={'f1_val': 0.5862258893606105, 'auprc': 0.6878469823749432, 'loss_val': 0.6828019867768091, 'psi': 0.6268743265663436}-{'f1_val': 0.5779046095719566, 'auprc': 0.6900227931506036, 'loss_val': 0.9367791155449792, 'psi': 0.6227518830034153}
[S14] START round=24 head_norm_before_train=0.971769 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.995421906745025, 'loss_val': 0.3922137340963379, 'psi': 0.9959890615614007}-{'f1_val': 0.9974515471354712, 'auprc': 0.9987153613986381, 'loss_val': 0.3197973358711878, 'psi': 0.997957072840738}
[S15] START round=24 head_norm_before_train=0.928198 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.191991 metrics={'f1_val': 0.8094828115986723, 'auprc': 0.9839054944461572, 'loss_val': 0.43009525205138843, 'psi': 0.8792518847376662}-{'f1_val': 0.7893695233346856, 'auprc': 0.9157710695509687, 'loss_val': 0.48899325380507513, 'psi': 0.8399301418211989}
[S16] START round=24 head_norm_before_train=1.315622 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9400724474965697, 'auprc': 0.9935910776021083, 'loss_val': 0.2463062649540444, 'psi': 0.9614798995387852}-{'f1_val': 0.9865080825229962, 'auprc': 0.994035938317323, 'loss_val': 0.13075932822806108, 'psi': 0.9895192248407269}
[S17] START round=24 head_norm_before_train=1.493493 cos_to_last_merge=0.8344 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=24 local utility u=0.118177 metrics={'f1_val': 0.6631480374682694, 'auprc': 0.7404988313010175, 'loss_val': 0.6885995695387567, 'psi': 0.6940883550013686}-{'f1_val': 0.6178761788550691, 'auprc': 0.7619441855739374, 'loss_val': 0.717657798578694, 'psi': 0.6755033815426164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44614
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:44610
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S3
[S14] cosine check vs S3: cos=0.6668
[S4] RECEIVED delta(kind=head bytes=1798) from S8
[S4] cosine check vs S8: cos=0.6521
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] cosine check vs S15: cos=0.8241
[S14] RECEIVED delta(kind=head bytes=1804) from S9
[S14] cosine check vs S9: cos=0.7404
[S9] RECEIVED delta(kind=head bytes=1805) from S10
[S9] cosine check vs S10: cos=-0.0601
[S9] DROPPED delta from S10 (cos=-0.0601 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S2
[S16] cosine check vs S2: cos=-0.0792
[S16] DROPPED delta from S2 (cos=-0.0792 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] cosine check vs S11: cos=0.5520
[S14] RECEIVED delta(kind=head bytes=1804) from S13
[S14] cosine check vs S13: cos=0.2635
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] cosine check vs S7: cos=0.8474
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=-0.0718
[S16] DROPPED delta from S17 (cos=-0.0718 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9393 head_norm=1.094541
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.747461e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9393 head_norm=1.031616 delta_norm=0.474746
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9964 head_norm=1.014161
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.937763e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9966 head_norm=0.963924 delta_norm=0.293776
[S14] aggregate: ACCEPT kept=['S3', 'S9', 'S13'] (k=3/3) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9944 head_norm=1.175250
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.328955e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9936 head_norm=1.027132 delta_norm=0.332896
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.9401 head_norm=1.357968
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.137934e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.9399 head_norm=1.317170 delta_norm=0.213793
[S16] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.842097 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.8032642868008721, 'auprc': 0.7478581268507181, 'loss_val': 0.3502070900284584, 'psi': 0.7811018228208105}-{'f1_val': 0.8262471891448172, 'auprc': 0.7490969194283332, 'loss_val': 0.3308179153517099, 'psi': 0.7953870812582235}
[S3] START round=25 head_norm_before_train=1.567846 cos_to_last_merge=0.8051 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.805
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9547886044370022, 'auprc': 0.9987489346683853, 'loss_val': 0.13149320322178404, 'psi': 0.9723727365295555}-{'f1_val': 0.9978100342676263, 'auprc': 0.9985342147329445, 'loss_val': 0.06189601198741004, 'psi': 0.9980997064537536}
[S4] START round=25 head_norm_before_train=1.031616 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9395477215580078, 'auprc': 0.9646340514202333, 'loss_val': 0.3603531801543581, 'psi': 0.949582253502898}-{'f1_val': 0.9393104556946399, 'auprc': 0.9578968953414171, 'loss_val': 0.3313986629613355, 'psi': 0.9467450315533508}
[S5] START round=25 head_norm_before_train=1.094289 cos_to_last_merge=0.9986 (last merge round=23)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.6186048372878525, 'auprc': 0.8624523177432695, 'loss_val': 0.4715259535697178, 'psi': 0.7161438294700193}-{'f1_val': 0.6451951113793298, 'auprc': 0.9187191983800939, 'loss_val': 0.4904645391846402, 'psi': 0.7546047461796355}
[S6] START round=25 head_norm_before_train=1.752817 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.7879477203505149, 'auprc': 0.9446386442493753, 'loss_val': 0.5033488598475137, 'psi': 0.850624089910059}-{'f1_val': 0.9426250976903324, 'auprc': 0.9692662289211335, 'loss_val': 0.19637189278632064, 'psi': 0.9532815501826528}
[S7] START round=25 head_norm_before_train=1.638916 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.4826484805471769, 'auprc': 0.7790238479992692, 'loss_val': 0.9244193988950826, 'psi': 0.6011986275280139}-{'f1_val': 0.6558506340337046, 'auprc': 0.8056460888306616, 'loss_val': 0.5009638085994184, 'psi': 0.7157688159524873}
[S8] START round=25 head_norm_before_train=1.027132 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9986730083787957, 'loss_val': 0.24280218681136967, 'psi': 0.9956444056202163}-{'f1_val': 0.9943590272655265, 'auprc': 0.9992551565827008, 'loss_val': 0.1680256290984849, 'psi': 0.9963174789923963}
[S9] START round=25 head_norm_before_train=1.292178 cos_to_last_merge=0.9892 (last merge round=21)
[S9] round=25 local utility u=0.008917 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9953360890577163, 'loss_val': 0.2799230728092327, 'psi': 0.818951251330174}-{'f1_val': 0.7013613595118124, 'auprc': 0.9952880319005678, 'loss_val': 0.2976127113376516, 'psi': 0.8189320284673146}
[S10] START round=25 head_norm_before_train=1.836135 (no previous merge yet)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9938178351826603, 'loss_val': 0.04296789139370977, 'psi': 0.994639837484689}-{'f1_val': 0.9955668669630084, 'auprc': 0.9966352279417142, 'loss_val': 0.045518114777640464, 'psi': 0.9959942113544907}
[S11] START round=25 head_norm_before_train=1.991030 (no previous merge yet)
[S11] round=25 local utility u=0.000702 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978315803362099, 'loss_val': 0.03187082958667933, 'psi': 0.9969157326158005}-{'f1_val': 0.996305167468861, 'auprc': 0.9978586316961834, 'loss_val': 0.03335533997589865, 'psi': 0.99692655315979}
[S13] START round=25 head_norm_before_train=1.717765 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5719044449076965, 'auprc': 0.69331555923181, 'loss_val': 0.8556159521902524, 'psi': 0.6204688906373419}-{'f1_val': 0.5862258893606105, 'auprc': 0.6878469823749432, 'loss_val': 0.6828019867768091, 'psi': 0.6268743265663436}
[S14] START round=25 head_norm_before_train=0.963924 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.044261 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.998789617797103, 'loss_val': 0.32149846683042604, 'psi': 0.9981065179487534}-{'f1_val': 0.9963671647723179, 'auprc': 0.995421906745025, 'loss_val': 0.3922137340963379, 'psi': 0.9959890615614007}
[S15] START round=25 head_norm_before_train=0.974899 cos_to_last_merge=0.9966 (last merge round=23)
[S15] round=25 local utility u=0.643081 metrics={'f1_val': 0.9948108769629211, 'auprc': 0.9914118916287616, 'loss_val': 0.2784206099660899, 'psi': 0.9934512828292573}-{'f1_val': 0.8094828115986723, 'auprc': 0.9839054944461572, 'loss_val': 0.43009525205138843, 'psi': 0.8792518847376662}
[S16] START round=25 head_norm_before_train=1.317170 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8657131435054032, 'auprc': 0.9916338234482799, 'loss_val': 0.5377160361787725, 'psi': 0.9160814154825538}-{'f1_val': 0.9400724474965697, 'auprc': 0.9935910776021083, 'loss_val': 0.2463062649540444, 'psi': 0.9614798995387852}
[S17] START round=25 head_norm_before_train=1.511739 cos_to_last_merge=0.8316 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.832
[S17] round=25 local utility u=0.042837 metrics={'f1_val': 0.6695745663291169, 'auprc': 0.7560381569231738, 'loss_val': 0.6881028421870714, 'psi': 0.7041600025667397}-{'f1_val': 0.6631480374682694, 'auprc': 0.7404988313010175, 'loss_val': 0.6885995695387567, 'psi': 0.6940883550013686}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44609
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44615
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:44614
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S9] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.6980
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] cosine check vs S15: cos=0.9370
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] cosine check vs S11: cos=0.6806
[S14] RECEIVED delta(kind=head bytes=1802) from S9
[S14] cosine check vs S9: cos=0.5767
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S17
[S16] cosine check vs S17: cos=-0.0749
[S16] DROPPED delta from S17 (cos=-0.0749 < 0.0)
[S7] ⇄ pheromone p=0.150 → S16@127.0.0.1:44616
[S3] ⇄ pheromone p=0.148 → S14@127.0.0.1:44614
[S5] ⇄ pheromone p=0.060 → S9@127.0.0.1:44610
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9936 head_norm=1.067904
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.866961e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9933 head_norm=1.026870 delta_norm=0.186696
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.196 → S4@127.0.0.1:44604
[S6] ⇄ pheromone p=0.218 → S4@127.0.0.1:44604
[S13] ⇄ pheromone p=0.081 → S14@127.0.0.1:44614
[S2] ⇄ pheromone p=0.105 → S16@127.0.0.1:44616
[S4] ⇄ pheromone p=0.061 → S5@127.0.0.1:44605
[S10] ⇄ pheromone p=0.041 → S9@127.0.0.1:44610
[S9] ⇄ pheromone p=0.035 → S14@127.0.0.1:44614
[S11] ⇄ pheromone p=0.074 → S16@127.0.0.1:44616
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9948 head_norm=1.018928
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.942601e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9949 head_norm=0.934732 delta_norm=0.394260
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.272 → S8@127.0.0.1:44609
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9977 head_norm=1.010008
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.536465e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9974 head_norm=1.037245 delta_norm=0.553647
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.058 → S15@127.0.0.1:44615
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.8657 head_norm=1.364357
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.350225e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.8631 head_norm=1.550273 delta_norm=0.735023
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.169 → S15@127.0.0.1:44615
[S17] ⇄ pheromone p=0.124 → S16@127.0.0.1:44616
[S2] START round=26 head_norm_before_train=1.852060 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.7004857986950133, 'auprc': 0.7013588226304519, 'loss_val': 0.40710829897788653, 'psi': 0.7008350082691888}-{'f1_val': 0.8032642868008721, 'auprc': 0.7478581268507181, 'loss_val': 0.3502070900284584, 'psi': 0.7811018228208105}
[S3] START round=26 head_norm_before_train=1.594796 cos_to_last_merge=0.8036 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.804
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.8735547019140244, 'auprc': 0.998621343621798, 'loss_val': 0.2314981823374871, 'psi': 0.9235813585971339}-{'f1_val': 0.9547886044370022, 'auprc': 0.9987489346683853, 'loss_val': 0.13149320322178404, 'psi': 0.9723727365295555}
[S4] START round=26 head_norm_before_train=1.070550 cos_to_last_merge=0.9978 (last merge round=24)
[S4] round=26 local utility u=0.033486 metrics={'f1_val': 0.9429866763468596, 'auprc': 0.9620343836135632, 'loss_val': 0.3062165059191325, 'psi': 0.9506057592535411}-{'f1_val': 0.9395477215580078, 'auprc': 0.9646340514202333, 'loss_val': 0.3603531801543581, 'psi': 0.949582253502898}
[S5] START round=26 head_norm_before_train=1.136192 cos_to_last_merge=0.9946 (last merge round=23)
[S5] round=26 local utility u=0.502333 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9894350274694217, 'loss_val': 0.3398336411189169, 'psi': 0.8161394673912372}-{'f1_val': 0.6186048372878525, 'auprc': 0.8624523177432695, 'loss_val': 0.4715259535697178, 'psi': 0.7161438294700193}
[S6] START round=26 head_norm_before_train=1.765313 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.5548736017061598, 'auprc': 0.7786088617141516, 'loss_val': 0.9321228505444124, 'psi': 0.6443677057093565}-{'f1_val': 0.7879477203505149, 'auprc': 0.9446386442493753, 'loss_val': 0.5033488598475137, 'psi': 0.850624089910059}
[S7] START round=26 head_norm_before_train=1.646341 (no previous merge yet)
[S7] round=26 local utility u=0.363912 metrics={'f1_val': 0.5701390423363476, 'auprc': 0.7835790209485979, 'loss_val': 0.7352048141019577, 'psi': 0.6555150337812476}-{'f1_val': 0.4826484805471769, 'auprc': 0.7790238479992692, 'loss_val': 0.9244193988950826, 'psi': 0.6011986275280139}
[S8] START round=26 head_norm_before_train=1.026870 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9985272878959491, 'loss_val': 0.26923793856215394, 'psi': 0.9955861174270776}-{'f1_val': 0.9936253371144965, 'auprc': 0.9986730083787957, 'loss_val': 0.24280218681136967, 'psi': 0.9956444056202163}
[S9] START round=26 head_norm_before_train=1.320867 cos_to_last_merge=0.9846 (last merge round=21)
[S9] round=26 local utility u=0.006892 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9962431360365631, 'loss_val': 0.2688596600926161, 'psi': 0.8193140701217128}-{'f1_val': 0.7013613595118124, 'auprc': 0.9953360890577163, 'loss_val': 0.2799230728092327, 'psi': 0.818951251330174}
[S10] START round=26 head_norm_before_train=1.856229 (no previous merge yet)
[S10] round=26 local utility u=0.005301 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9959136687858028, 'loss_val': 0.03839654201471238, 'psi': 0.9954524989947392}-{'f1_val': 0.9951878390193748, 'auprc': 0.9938178351826603, 'loss_val': 0.04296789139370977, 'psi': 0.994639837484689}
[S11] START round=26 head_norm_before_train=2.006425 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9590907480425037, 'auprc': 0.9978706851044503, 'loss_val': 0.11076273996716546, 'psi': 0.9746027228672824}-{'f1_val': 0.996305167468861, 'auprc': 0.9978315803362099, 'loss_val': 0.03187082958667933, 'psi': 0.9969157326158005}
[S13] START round=26 head_norm_before_train=1.723115 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5762631804111876, 'auprc': 0.6913122599737561, 'loss_val': 0.9381800546889747, 'psi': 0.622282812236215}-{'f1_val': 0.5719044449076965, 'auprc': 0.69331555923181, 'loss_val': 0.8556159521902524, 'psi': 0.6204688906373419}
[S14] START round=26 head_norm_before_train=1.037245 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9949110635196168, 'auprc': 0.9965574808227092, 'loss_val': 0.3470615748115006, 'psi': 0.9955696304408538}-{'f1_val': 0.9976511180498535, 'auprc': 0.998789617797103, 'loss_val': 0.32149846683042604, 'psi': 0.9981065179487534}
[S15] START round=26 head_norm_before_train=0.934732 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.8787402753875503, 'auprc': 0.9829924507135381, 'loss_val': 0.41455297940302666, 'psi': 0.9204411455179454}-{'f1_val': 0.9948108769629211, 'auprc': 0.9914118916287616, 'loss_val': 0.2784206099660899, 'psi': 0.9934512828292573}
[S16] START round=26 head_norm_before_train=1.550273 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.186090 metrics={'f1_val': 0.9129693154900422, 'auprc': 0.9830015559077574, 'loss_val': 0.4231765382108835, 'psi': 0.9409822116571283}-{'f1_val': 0.8657131435054032, 'auprc': 0.9916338234482799, 'loss_val': 0.5377160361787725, 'psi': 0.9160814154825538}
[S17] START round=26 head_norm_before_train=1.534662 cos_to_last_merge=0.8284 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.828
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.6476417076069549, 'auprc': 0.7407925733536171, 'loss_val': 0.7763954032610119, 'psi': 0.6849020539056199}-{'f1_val': 0.6695745663291169, 'auprc': 0.7560381569231738, 'loss_val': 0.6881028421870714, 'psi': 0.7041600025667397}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44610
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44605
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44615
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S7
[S16] cosine check vs S7: cos=0.3549
[S14] RECEIVED delta(kind=head bytes=1804) from S9
[S14] cosine check vs S9: cos=0.8987
[S15] RECEIVED delta(kind=head bytes=1803) from S16
[S15] cosine check vs S16: cos=0.3465
[S9] RECEIVED delta(kind=head bytes=1805) from S5
[S9] cosine check vs S5: cos=0.8788
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] cosine check vs S10: cos=-0.0618
[S9] DROPPED delta from S10 (cos=-0.0618 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S4
[S5] cosine check vs S4: cos=0.9177
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9949 head_norm=1.074300
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.028094e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9943 head_norm=1.179390 delta_norm=0.302809
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.7006 head_norm=1.170238
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.336202e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.7006 head_norm=1.121061 delta_norm=0.233620
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.9130 head_norm=1.591321
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.215816e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.9128 head_norm=1.335195 delta_norm=0.921582
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.7014 head_norm=1.345803
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.211753e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.7014 head_norm=1.219495 delta_norm=0.321175
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.8787 head_norm=0.969461
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.750748e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.9135 head_norm=1.065522 delta_norm=0.775075
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.861632 (no previous merge yet)
[S2] round=27 local utility u=0.308323 metrics={'f1_val': 0.7174280160796496, 'auprc': 0.8582871747380143, 'loss_val': 0.36290077167399326, 'psi': 0.7737716795429954}-{'f1_val': 0.7004857986950133, 'auprc': 0.7013588226304519, 'loss_val': 0.40710829897788653, 'psi': 0.7008350082691888}
[S3] START round=27 head_norm_before_train=1.616953 cos_to_last_merge=0.8024 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.802
[S3] round=27 local utility u=0.416540 metrics={'f1_val': 0.9871065676984565, 'auprc': 0.9983986000615207, 'loss_val': 0.07906078371474141, 'psi': 0.9916233806436822}-{'f1_val': 0.8735547019140244, 'auprc': 0.998621343621798, 'loss_val': 0.2314981823374871, 'psi': 0.9235813585971339}
[S4] START round=27 head_norm_before_train=1.119490 cos_to_last_merge=0.9911 (last merge round=24)
[S4] round=27 local utility u=0.006507 metrics={'f1_val': 0.9394282399302328, 'auprc': 0.9685760629339473, 'loss_val': 0.2914777289736261, 'psi': 0.9510873691317187}-{'f1_val': 0.9429866763468596, 'auprc': 0.9620343836135632, 'loss_val': 0.3062165059191325, 'psi': 0.9506057592535411}
[S5] START round=27 head_norm_before_train=1.121061 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9898901796527197, 'loss_val': 0.35752876512209397, 'psi': 0.8161488623214361}-{'f1_val': 0.7006090940057808, 'auprc': 0.9894350274694217, 'loss_val': 0.3398336411189169, 'psi': 0.8161394673912372}
[S6] START round=27 head_norm_before_train=1.777093 (no previous merge yet)
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.8240392948141309, 'auprc': 0.9263082744444333, 'loss_val': 0.4087972501176979, 'psi': 0.8649468866662519}-{'f1_val': 0.5548736017061598, 'auprc': 0.7786088617141516, 'loss_val': 0.9321228505444124, 'psi': 0.6443677057093565}
[S7] START round=27 head_norm_before_train=1.652820 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5661255855230056, 'auprc': 0.7837735641242812, 'loss_val': 0.7610467824199947, 'psi': 0.653184776963516}-{'f1_val': 0.5701390423363476, 'auprc': 0.7835790209485979, 'loss_val': 0.7352048141019577, 'psi': 0.6555150337812476}
[S8] START round=27 head_norm_before_train=1.072770 cos_to_last_merge=0.9978 (last merge round=25)
[S8] round=27 local utility u=0.038035 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9988099492631555, 'loss_val': 0.19621599415721114, 'psi': 0.9959191214583702}-{'f1_val': 0.9936253371144965, 'auprc': 0.9985272878959491, 'loss_val': 0.26923793856215394, 'psi': 0.9955861174270776}
[S9] START round=27 head_norm_before_train=1.219495 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9949771290640912, 'loss_val': 0.3064331600531746, 'psi': 0.818807667332724}-{'f1_val': 0.7013613595118124, 'auprc': 0.9962431360365631, 'loss_val': 0.2688596600926161, 'psi': 0.8193140701217128}
[S10] START round=27 head_norm_before_train=1.876140 (no previous merge yet)
[S10] round=27 local utility u=0.003340 metrics={'f1_val': 0.9955598831439865, 'auprc': 0.9961728989790789, 'loss_val': 0.034983574274144405, 'psi': 0.9958050894780235}-{'f1_val': 0.9951450524673635, 'auprc': 0.9959136687858028, 'loss_val': 0.03839654201471238, 'psi': 0.9954524989947392}
[S11] START round=27 head_norm_before_train=2.021732 (no previous merge yet)
[S11] round=27 local utility u=0.152496 metrics={'f1_val': 0.996305167468861, 'auprc': 0.997821379491259, 'loss_val': 0.028910318264743433, 'psi': 0.9969116522778202}-{'f1_val': 0.9590907480425037, 'auprc': 0.9978706851044503, 'loss_val': 0.11076273996716546, 'psi': 0.9746027228672824}
[S13] START round=27 head_norm_before_train=1.729356 (no previous merge yet)
[S13] round=27 local utility u=0.179373 metrics={'f1_val': 0.6008195512582736, 'auprc': 0.6887780543504407, 'loss_val': 0.7191690741019566, 'psi': 0.6360029524951405}-{'f1_val': 0.5762631804111876, 'auprc': 0.6913122599737561, 'loss_val': 0.9381800546889747, 'psi': 0.622282812236215}
[S14] START round=27 head_norm_before_train=1.179390 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.026238 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9979494693777209, 'loss_val': 0.3127380174935586, 'psi': 0.9975240017745641}-{'f1_val': 0.9949110635196168, 'auprc': 0.9965574808227092, 'loss_val': 0.3470615748115006, 'psi': 0.9955696304408538}
[S15] START round=27 head_norm_before_train=1.065522 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.193071 metrics={'f1_val': 0.915332240987436, 'auprc': 0.9950358690631759, 'loss_val': 0.28409234442021297, 'psi': 0.9472136922177319}-{'f1_val': 0.8787402753875503, 'auprc': 0.9829924507135381, 'loss_val': 0.41455297940302666, 'psi': 0.9204411455179454}
[S16] START round=27 head_norm_before_train=1.335195 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.392358 metrics={'f1_val': 0.9908052871406017, 'auprc': 0.9906344638636538, 'loss_val': 0.12837489119961243, 'psi': 0.9907369578298225}-{'f1_val': 0.9129693154900422, 'auprc': 0.9830015559077574, 'loss_val': 0.4231765382108835, 'psi': 0.9409822116571283}
[S17] START round=27 head_norm_before_train=1.557668 cos_to_last_merge=0.8257 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=27 local utility u=0.098115 metrics={'f1_val': 0.6500250209896723, 'auprc': 0.8068495210259208, 'loss_val': 0.7926358847688509, 'psi': 0.7127548210041716}-{'f1_val': 0.6476417076069549, 'auprc': 0.7407925733536171, 'loss_val': 0.7763954032610119, 'psi': 0.6849020539056199}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44610
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:44605
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:44616
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S14
[S15] cosine check vs S14: cos=0.3000
[S4] RECEIVED delta(kind=head bytes=1802) from S8
[S4] cosine check vs S8: cos=0.8180
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] cosine check vs S6: cos=0.4959
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] cosine check vs S15: cos=0.9161
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] cosine check vs S10: cos=-0.0551
[S9] DROPPED delta from S10 (cos=-0.0551 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S11
[S16] cosine check vs S11: cos=0.5928
[S16] RECEIVED delta(kind=head bytes=1800) from S2
[S16] cosine check vs S2: cos=-0.0779
[S16] DROPPED delta from S2 (cos=-0.0779 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] cosine check vs S16: cos=0.7793
[S14] RECEIVED delta(kind=head bytes=1801) from S13
[S14] cosine check vs S13: cos=0.1056
[S14] RECEIVED delta(kind=head bytes=1793) from S3
[S14] cosine check vs S3: cos=0.2290
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=-0.0739
[S16] DROPPED delta from S17 (cos=-0.0739 < 0.0)
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] cosine check vs S4: cos=0.9765
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.7003 head_norm=1.153407
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.255314e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.7003 head_norm=1.151564 delta_norm=0.125531
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9940 head_norm=1.123826
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.283769e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9936 head_norm=1.090141 delta_norm=0.228377
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9972 head_norm=1.209842
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.139567e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9970 head_norm=1.000080 delta_norm=0.813957
[S14] aggregate: ACCEPT kept=['S13', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.9153 head_norm=1.103695
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.713088e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.9248 head_norm=0.964279 delta_norm=0.371309
[S15] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9908 head_norm=1.375876
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.247187e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9906 head_norm=1.530367 delta_norm=0.824719
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9394 head_norm=1.163343
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.425147e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9394 head_norm=1.080232 delta_norm=0.342515
[S4] aggregate: ACCEPT kept=['S8', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.873923 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.45797586160533416, 'auprc': 0.6670463825872197, 'loss_val': 1.0338645373531778, 'psi': 0.5416040699980884}-{'f1_val': 0.7174280160796496, 'auprc': 0.8582871747380143, 'loss_val': 0.36290077167399326, 'psi': 0.7737716795429954}
[S3] START round=28 head_norm_before_train=1.637620 cos_to_last_merge=0.8009 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.801
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.8478824162095456, 'auprc': 0.9987011870299349, 'loss_val': 0.26734987416642775, 'psi': 0.9082099245377013}-{'f1_val': 0.9871065676984565, 'auprc': 0.9983986000615207, 'loss_val': 0.07906078371474141, 'psi': 0.9916233806436822}
[S4] START round=28 head_norm_before_train=1.080232 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9397003779203787, 'auprc': 0.9509676972699321, 'loss_val': 0.3115180083315549, 'psi': 0.9442073056602001}-{'f1_val': 0.9394282399302328, 'auprc': 0.9685760629339473, 'loss_val': 0.2914777289736261, 'psi': 0.9510873691317187}
[S5] START round=28 head_norm_before_train=1.151564 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.42262442068799205, 'auprc': 0.7367251978404932, 'loss_val': 0.8142507338495389, 'psi': 0.5482647315489925}-{'f1_val': 0.7003213174339138, 'auprc': 0.9898901796527197, 'loss_val': 0.35752876512209397, 'psi': 0.8161488623214361}
[S6] START round=28 head_norm_before_train=1.784955 (no previous merge yet)
[S6] round=28 local utility u=0.231921 metrics={'f1_val': 0.8628787581433359, 'auprc': 0.9613904949759671, 'loss_val': 0.2832389955121262, 'psi': 0.9022834528763884}-{'f1_val': 0.8240392948141309, 'auprc': 0.9263082744444333, 'loss_val': 0.4087972501176979, 'psi': 0.8649468866662519}
[S7] START round=28 head_norm_before_train=1.663051 (no previous merge yet)
[S7] round=28 local utility u=0.524860 metrics={'f1_val': 0.665842830785297, 'auprc': 0.8172622419175665, 'loss_val': 0.410096437861766, 'psi': 0.7264105952382048}-{'f1_val': 0.5661255855230056, 'auprc': 0.7837735641242812, 'loss_val': 0.7610467824199947, 'psi': 0.653184776963516}
[S8] START round=28 head_norm_before_train=1.090141 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9941739919500441, 'auprc': 0.9989740699138119, 'loss_val': 0.20956038842010297, 'psi': 0.9960940231355512}-{'f1_val': 0.9939919029218467, 'auprc': 0.9988099492631555, 'loss_val': 0.19621599415721114, 'psi': 0.9959191214583702}
[S9] START round=28 head_norm_before_train=1.244138 cos_to_last_merge=0.9996 (last merge round=26)
[S9] round=28 local utility u=0.009236 metrics={'f1_val': 0.7011854735302249, 'auprc': 0.9955444645303845, 'loss_val': 0.2886076591384134, 'psi': 0.8189290699302887}-{'f1_val': 0.7013613595118124, 'auprc': 0.9949771290640912, 'loss_val': 0.3064331600531746, 'psi': 0.818807667332724}
[S10] START round=28 head_norm_before_train=1.895495 (no previous merge yet)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9960263539651085, 'loss_val': 0.034228202677535687, 'psi': 0.9954975730664615}-{'f1_val': 0.9955598831439865, 'auprc': 0.9961728989790789, 'loss_val': 0.034983574274144405, 'psi': 0.9958050894780235}
[S11] START round=28 head_norm_before_train=2.037482 (no previous merge yet)
[S11] round=28 local utility u=0.000086 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979007946226875, 'loss_val': 0.02897700236134596, 'psi': 0.9969434183303916}-{'f1_val': 0.996305167468861, 'auprc': 0.997821379491259, 'loss_val': 0.028910318264743433, 'psi': 0.9969116522778202}
[S13] START round=28 head_norm_before_train=1.733556 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.574749556417218, 'auprc': 0.6952631059304782, 'loss_val': 0.8411982231391852, 'psi': 0.6229549762225222}-{'f1_val': 0.6008195512582736, 'auprc': 0.6887780543504407, 'loss_val': 0.7191690741019566, 'psi': 0.6360029524951405}
[S14] START round=28 head_norm_before_train=1.000080 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.024925 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9984973463875081, 'loss_val': 0.26161705062616075, 'psi': 0.9974516575472221}-{'f1_val': 0.997240356705793, 'auprc': 0.9979494693777209, 'loss_val': 0.3127380174935586, 'psi': 0.9975240017745641}
[S15] START round=28 head_norm_before_train=0.964279 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.8906321457545621, 'auprc': 0.9887652911338001, 'loss_val': 0.37024263984003036, 'psi': 0.9298854039062573}-{'f1_val': 0.915332240987436, 'auprc': 0.9950358690631759, 'loss_val': 0.28409234442021297, 'psi': 0.9472136922177319}
[S16] START round=28 head_norm_before_train=1.530367 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9373326464318082, 'auprc': 0.9905551978468328, 'loss_val': 0.27768499600642077, 'psi': 0.958621666997818}-{'f1_val': 0.9908052871406017, 'auprc': 0.9906344638636538, 'loss_val': 0.12837489119961243, 'psi': 0.9907369578298225}
[S17] START round=28 head_norm_before_train=1.578935 cos_to_last_merge=0.8228 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.823
[S17] round=28 local utility u=0.310361 metrics={'f1_val': 0.6914793260661208, 'auprc': 0.8630428850198264, 'loss_val': 0.5892189358176417, 'psi': 0.760104749647603}-{'f1_val': 0.6500250209896723, 'auprc': 0.8068495210259208, 'loss_val': 0.7926358847688509, 'psi': 0.7127548210041716}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:44604
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:44616
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44614
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1793) from S6
[S4] cosine check vs S6: cos=0.7060
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=0.3948
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] cosine check vs S9: cos=0.6021
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.4936
[S16] RECEIVED delta(kind=head bytes=1793) from S11
[S16] cosine check vs S11: cos=0.9295
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S17
[S16] cosine check vs S17: cos=-0.0731
[S16] DROPPED delta from S17 (cos=-0.0731 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9397 head_norm=1.118416
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.398073e-01
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9399 head_norm=1.351375 delta_norm=0.639807
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.8906 head_norm=1.003899
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.183720e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.8735 head_norm=0.889545 delta_norm=0.518372
[S15] aggregate: ROLLBACK (f1_val pre=0.891 post=0.874 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.9373 head_norm=1.571501
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.478155e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.9369 head_norm=1.441547 delta_norm=0.247816
[S16] aggregate: ACCEPT kept=['S7', 'S11'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9968 head_norm=1.054603
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.273968e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9968 head_norm=1.041529 delta_norm=0.527397
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.885962 (no previous merge yet)
[S2] round=29 local utility u=1.000000 metrics={'f1_val': 0.7395186760083411, 'auprc': 0.8371828262993481, 'loss_val': 0.36033725271185046, 'psi': 0.778584336124744}-{'f1_val': 0.45797586160533416, 'auprc': 0.6670463825872197, 'loss_val': 1.0338645373531778, 'psi': 0.5416040699980884}
[S3] START round=29 head_norm_before_train=1.654607 cos_to_last_merge=0.7993 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.799
[S3] round=29 local utility u=0.441205 metrics={'f1_val': 0.9664590075283306, 'auprc': 0.9991339698895912, 'loss_val': 0.09769797186792814, 'psi': 0.9795289924728349}-{'f1_val': 0.8478824162095456, 'auprc': 0.9987011870299349, 'loss_val': 0.26734987416642775, 'psi': 0.9082099245377013}
[S4] START round=29 head_norm_before_train=1.351375 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9382456774476522, 'auprc': 0.9328462510788249, 'loss_val': 0.340854620431001, 'psi': 0.9360859069001213}-{'f1_val': 0.9397003779203787, 'auprc': 0.9509676972699321, 'loss_val': 0.3115180083315549, 'psi': 0.9442073056602001}
[S5] START round=29 head_norm_before_train=1.181997 cos_to_last_merge=0.9992 (last merge round=27)
[S5] round=29 local utility u=1.000000 metrics={'f1_val': 0.6975531240214947, 'auprc': 0.998244986207734, 'loss_val': 0.3742967736971761, 'psi': 0.8178298688959904}-{'f1_val': 0.42262442068799205, 'auprc': 0.7367251978404932, 'loss_val': 0.8142507338495389, 'psi': 0.5482647315489925}
[S6] START round=29 head_norm_before_train=1.794515 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.7276652386396091, 'auprc': 0.9439907377689327, 'loss_val': 0.6816380264893642, 'psi': 0.8141954382913386}-{'f1_val': 0.8628787581433359, 'auprc': 0.9613904949759671, 'loss_val': 0.2832389955121262, 'psi': 0.9022834528763884}
[S7] START round=29 head_norm_before_train=1.670975 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.46300862410435306, 'auprc': 0.7801159520750865, 'loss_val': 0.9519750413615288, 'psi': 0.5898515552926464}-{'f1_val': 0.665842830785297, 'auprc': 0.8172622419175665, 'loss_val': 0.410096437861766, 'psi': 0.7264105952382048}
[S8] START round=29 head_norm_before_train=1.135238 cos_to_last_merge=0.9984 (last merge round=27)
[S8] round=29 local utility u=0.021598 metrics={'f1_val': 0.9939829691362772, 'auprc': 0.9989720038154419, 'loss_val': 0.16521149454614015, 'psi': 0.9959785830079431}-{'f1_val': 0.9941739919500441, 'auprc': 0.9989740699138119, 'loss_val': 0.20956038842010297, 'psi': 0.9960940231355512}
[S9] START round=29 head_norm_before_train=1.270305 cos_to_last_merge=0.9983 (last merge round=26)
[S9] round=29 local utility u=0.009819 metrics={'f1_val': 0.7011126798871403, 'auprc': 0.9961360742017101, 'loss_val': 0.2703074694384198, 'psi': 0.8191220376129682}-{'f1_val': 0.7011854735302249, 'auprc': 0.9955444645303845, 'loss_val': 0.2886076591384134, 'psi': 0.8189290699302887}
[S10] START round=29 head_norm_before_train=1.913901 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9953480938035095, 'loss_val': 0.03367266874681678, 'psi': 0.9952262690018219}-{'f1_val': 0.9951450524673635, 'auprc': 0.9960263539651085, 'loss_val': 0.034228202677535687, 'psi': 0.9954975730664615}
[S11] START round=29 head_norm_before_train=2.051489 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9960642655951585, 'auprc': 0.9978751192012295, 'loss_val': 0.029681890820881615, 'psi': 0.9967886070375869}-{'f1_val': 0.996305167468861, 'auprc': 0.9979007946226875, 'loss_val': 0.02897700236134596, 'psi': 0.9969434183303916}
[S13] START round=29 head_norm_before_train=1.738150 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5521390550233757, 'auprc': 0.7007563296532728, 'loss_val': 1.0745236275538548, 'psi': 0.6115859648753346}-{'f1_val': 0.574749556417218, 'auprc': 0.6952631059304782, 'loss_val': 0.8411982231391852, 'psi': 0.6229549762225222}
[S14] START round=29 head_norm_before_train=1.041529 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.003314 metrics={'f1_val': 0.9969942850194674, 'auprc': 0.9968857013248302, 'loss_val': 0.2515932833045755, 'psi': 0.9969508515416126}-{'f1_val': 0.996754531653698, 'auprc': 0.9984973463875081, 'loss_val': 0.26161705062616075, 'psi': 0.9974516575472221}
[S15] START round=29 head_norm_before_train=0.889545 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.041277 metrics={'f1_val': 0.9014246660548306, 'auprc': 0.992542687330017, 'loss_val': 0.36377575086615455, 'psi': 0.9378718745649053}-{'f1_val': 0.8906321457545621, 'auprc': 0.9887652911338001, 'loss_val': 0.37024263984003036, 'psi': 0.9298854039062573}
[S16] START round=29 head_norm_before_train=1.441547 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.9176919728931744, 'auprc': 0.9857754157671764, 'loss_val': 0.38107917268040586, 'psi': 0.9449253500427752}-{'f1_val': 0.9373326464318082, 'auprc': 0.9905551978468328, 'loss_val': 0.27768499600642077, 'psi': 0.958621666997818}
[S17] START round=29 head_norm_before_train=1.594231 cos_to_last_merge=0.8203 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.6543432095270632, 'auprc': 0.8151580599795403, 'loss_val': 0.8180417927193795, 'psi': 0.718669149708054}-{'f1_val': 0.6914793260661208, 'auprc': 0.8630428850198264, 'loss_val': 0.5892189358176417, 'psi': 0.760104749647603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:44604
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44616
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44615
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S15
[S8] cosine check vs S15: cos=0.8472
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.8681
[S16] RECEIVED delta(kind=head bytes=1804) from S2
[S16] cosine check vs S2: cos=-0.0295
[S16] DROPPED delta from S2 (cos=-0.0295 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1805) from S8
[S4] cosine check vs S8: cos=0.3893
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=0.8626
[S14] RECEIVED delta(kind=head bytes=1803) from S9
[S14] cosine check vs S9: cos=0.9002
[S14] RECEIVED delta(kind=head bytes=1799) from S3
[S14] cosine check vs S3: cos=0.4037
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9382 head_norm=1.387635
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.153988e-01
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9380 head_norm=1.072794 delta_norm=0.715399
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9970 head_norm=1.085298
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.998624e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9970 head_norm=1.043968 delta_norm=0.299862
[S14] aggregate: ACCEPT kept=['S9', 'S3'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.7011 head_norm=1.296116
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.242414e-01
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.7011 head_norm=1.208997 delta_norm=0.324241
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.9014 head_norm=0.930403
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.745549e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.8997 head_norm=0.972821 delta_norm=0.274555
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9940 head_norm=1.183147
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.163703e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9934 head_norm=1.016195 delta_norm=0.316370
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.894654 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.7752191510733356, 'auprc': 0.7463898926922571, 'loss_val': 0.536289526082805, 'psi': 0.7636874477209041}-{'f1_val': 0.7395186760083411, 'auprc': 0.8371828262993481, 'loss_val': 0.36033725271185046, 'psi': 0.778584336124744}
[S3] START round=30 head_norm_before_train=1.674122 cos_to_last_merge=0.7977 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.798
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9995158189607919, 'loss_val': 0.11867513400966037, 'psi': 0.9764754819250082}-{'f1_val': 0.9664590075283306, 'auprc': 0.9991339698895912, 'loss_val': 0.09769797186792814, 'psi': 0.9795289924728349}
[S4] START round=30 head_norm_before_train=1.072794 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.066786 metrics={'f1_val': 0.9404549741299555, 'auprc': 0.9686099481095042, 'loss_val': 0.32782855287533974, 'psi': 0.951716963721775}-{'f1_val': 0.9382456774476522, 'auprc': 0.9328462510788249, 'loss_val': 0.340854620431001, 'psi': 0.9360859069001213}
[S5] START round=30 head_norm_before_train=1.205692 cos_to_last_merge=0.9977 (last merge round=27)
[S5] round=30 local utility u=0.039941 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9899170104720385, 'loss_val': 0.2860392996370933, 'psi': 0.8161595946491637}-{'f1_val': 0.6975531240214947, 'auprc': 0.998244986207734, 'loss_val': 0.3742967736971761, 'psi': 0.8178298688959904}
[S6] START round=30 head_norm_before_train=1.803418 (no previous merge yet)
[S6] round=30 local utility u=0.821345 metrics={'f1_val': 0.9142826951863279, 'auprc': 0.9583153326466856, 'loss_val': 0.2016267245253802, 'psi': 0.931895750170471}-{'f1_val': 0.7276652386396091, 'auprc': 0.9439907377689327, 'loss_val': 0.6816380264893642, 'psi': 0.8141954382913386}
[S7] START round=30 head_norm_before_train=1.676071 (no previous merge yet)
[S7] round=30 local utility u=0.870014 metrics={'f1_val': 0.6568598112034817, 'auprc': 0.8052529873576416, 'loss_val': 0.4504648893068879, 'psi': 0.7162170816651456}-{'f1_val': 0.46300862410435306, 'auprc': 0.7801159520750865, 'loss_val': 0.9519750413615288, 'psi': 0.5898515552926464}
[S8] START round=30 head_norm_before_train=1.016195 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9985288731222209, 'loss_val': 0.1890097487260031, 'psi': 0.99492893084328}-{'f1_val': 0.9939829691362772, 'auprc': 0.9989720038154419, 'loss_val': 0.16521149454614015, 'psi': 0.9959785830079431}
[S9] START round=30 head_norm_before_train=1.208997 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.6978170514811213, 'auprc': 0.9980478900186955, 'loss_val': 0.30578703517855194, 'psi': 0.817909386896151}-{'f1_val': 0.7011126798871403, 'auprc': 0.9961360742017101, 'loss_val': 0.2703074694384198, 'psi': 0.8191220376129682}
[S10] START round=30 head_norm_before_train=1.928484 (no previous merge yet)
[S10] round=30 local utility u=0.001961 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9960594269534443, 'loss_val': 0.03188479135271336, 'psi': 0.9955108022617958}-{'f1_val': 0.9951450524673635, 'auprc': 0.9953480938035095, 'loss_val': 0.03367266874681678, 'psi': 0.9952262690018219}
[S11] START round=30 head_norm_before_train=2.065943 (no previous merge yet)
[S11] round=30 local utility u=0.002471 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979097640167973, 'loss_val': 0.02628855668840732, 'psi': 0.9969470060880354}-{'f1_val': 0.9960642655951585, 'auprc': 0.9978751192012295, 'loss_val': 0.029681890820881615, 'psi': 0.9967886070375869}
[S13] START round=30 head_norm_before_train=1.742424 (no previous merge yet)
[S13] round=30 local utility u=0.281934 metrics={'f1_val': 0.6024309521932216, 'auprc': 0.666689498016674, 'loss_val': 0.7102055591573746, 'psi': 0.6281343705226026}-{'f1_val': 0.5521390550233757, 'auprc': 0.7007563296532728, 'loss_val': 1.0745236275538548, 'psi': 0.6115859648753346}
[S14] START round=30 head_norm_before_train=1.043968 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.022801 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.997122477836318, 'loss_val': 0.2068579080406664, 'psi': 0.9970611648082526}-{'f1_val': 0.9969942850194674, 'auprc': 0.9968857013248302, 'loss_val': 0.2515932833045755, 'psi': 0.9969508515416126}
[S15] START round=30 head_norm_before_train=0.972821 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.8170476860357364, 'auprc': 0.98830744475186, 'loss_val': 0.4066296395263411, 'psi': 0.8855515895221859}-{'f1_val': 0.9014246660548306, 'auprc': 0.992542687330017, 'loss_val': 0.36377575086615455, 'psi': 0.9378718745649053}
[S16] START round=30 head_norm_before_train=1.478049 cos_to_last_merge=0.9996 (last merge round=28)
[S16] round=30 local utility u=0.383413 metrics={'f1_val': 0.990199908532446, 'auprc': 0.9950257929639639, 'loss_val': 0.07705116107335701, 'psi': 0.9921302623050531}-{'f1_val': 0.9176919728931744, 'auprc': 0.9857754157671764, 'loss_val': 0.38107917268040586, 'psi': 0.9449253500427752}
[S17] START round=30 head_norm_before_train=1.605112 cos_to_last_merge=0.8190 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.819
[S17] round=30 local utility u=0.088807 metrics={'f1_val': 0.6657490036826397, 'auprc': 0.8421179212577113, 'loss_val': 0.7897429084268287, 'psi': 0.7362965707126683}-{'f1_val': 0.6543432095270632, 'auprc': 0.8151580599795403, 'loss_val': 0.8180417927193795, 'psi': 0.718669149708054}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44610
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44615
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.9596
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=-0.0509
[S9] DROPPED delta from S10 (cos=-0.0509 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] cosine check vs S4: cos=0.9479
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] cosine check vs S11: cos=0.8694
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] cosine check vs S7: cos=0.5165
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] cosine check vs S6: cos=0.6756
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] cosine check vs S16: cos=0.3329
[S14] RECEIVED delta(kind=head bytes=1800) from S13
[S14] cosine check vs S13: cos=0.3085
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] cosine check vs S14: cos=0.9436
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S17
[S16] cosine check vs S17: cos=-0.0771
[S16] DROPPED delta from S17 (cos=-0.0771 < 0.0)
[S2] ⇄ pheromone p=0.226 → S16@127.0.0.1:44616
[S8] ⇄ pheromone p=0.071 → S4@127.0.0.1:44604
[S3] ⇄ pheromone p=0.162 → S14@127.0.0.1:44614
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.6978 head_norm=1.233355
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.749993e-01
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.6978 head_norm=1.218966 delta_norm=0.174999
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.015 → S14@127.0.0.1:44614
[S13] ⇄ pheromone p=0.101 → S14@127.0.0.1:44614
[S10] ⇄ pheromone p=0.014 → S9@127.0.0.1:44610
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.9902 head_norm=1.511413
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.492742e-01
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.9902 head_norm=1.428905 delta_norm=0.149274
[S16] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.188 → S15@127.0.0.1:44615
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9405 head_norm=1.113490
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.694140e-01
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9400 head_norm=1.345241 delta_norm=0.669414
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.037 → S5@127.0.0.1:44605
[S6] ⇄ pheromone p=0.368 → S4@127.0.0.1:44604
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9970 head_norm=1.095586
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.761573e-01
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9970 head_norm=1.165363 delta_norm=0.876157
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.030 → S15@127.0.0.1:44615
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.7003 head_norm=1.229571
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.976232e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.7003 head_norm=1.156199 delta_norm=0.197623
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.229 → S9@127.0.0.1:44610
[S11] ⇄ pheromone p=0.040 → S16@127.0.0.1:44616
[S7] ⇄ pheromone p=0.320 → S16@127.0.0.1:44616
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.8170 head_norm=1.015703
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.279250e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.8993 head_norm=0.942396 delta_norm=0.327925
[S15] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.116 → S8@127.0.0.1:44609
[S17] ⇄ pheromone p=0.108 → S16@127.0.0.1:44616
[S2] START round=31 head_norm_before_train=1.905504 (no previous merge yet)
[S2] round=31 local utility u=0.066463 metrics={'f1_val': 0.7086496469942809, 'auprc': 0.9001264600705562, 'loss_val': 0.4651565284433936, 'psi': 0.785240372224791}-{'f1_val': 0.7752191510733356, 'auprc': 0.7463898926922571, 'loss_val': 0.536289526082805, 'psi': 0.7636874477209041}
[S3] START round=31 head_norm_before_train=1.694255 cos_to_last_merge=0.7962 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.796
[S3] round=31 local utility u=0.154091 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.999848197255671, 'loss_val': 0.03183130029115907, 'psi': 0.9986426353821557}-{'f1_val': 0.9611152572344858, 'auprc': 0.9995158189607919, 'loss_val': 0.11867513400966037, 'psi': 0.9764754819250082}
[S4] START round=31 head_norm_before_train=1.345241 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.6904337683195692, 'auprc': 0.9349796491062821, 'loss_val': 0.5592723336031477, 'psi': 0.7882521206342543}-{'f1_val': 0.9404549741299555, 'auprc': 0.9686099481095042, 'loss_val': 0.32782855287533974, 'psi': 0.951716963721775}
[S5] START round=31 head_norm_before_train=1.156199 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7032867927782303, 'auprc': 0.8402739954502724, 'loss_val': 0.4724971085365566, 'psi': 0.758081673847047}-{'f1_val': 0.7003213174339138, 'auprc': 0.9899170104720385, 'loss_val': 0.2860392996370933, 'psi': 0.8161595946491637}
[S6] START round=31 head_norm_before_train=1.809894 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.8440516457951345, 'auprc': 0.9662757088928692, 'loss_val': 0.26153681319583844, 'psi': 0.8929412710342284}-{'f1_val': 0.9142826951863279, 'auprc': 0.9583153326466856, 'loss_val': 0.2016267245253802, 'psi': 0.931895750170471}
[S7] START round=31 head_norm_before_train=1.680523 (no previous merge yet)
[S7] round=31 local utility u=0.032698 metrics={'f1_val': 0.6636885701865975, 'auprc': 0.809430392092184, 'loss_val': 0.4385728743408723, 'psi': 0.7219852989488322}-{'f1_val': 0.6568598112034817, 'auprc': 0.8052529873576416, 'loss_val': 0.4504648893068879, 'psi': 0.7162170816651456}
[S8] START round=31 head_norm_before_train=1.067605 cos_to_last_merge=0.9981 (last merge round=29)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9848010119947144, 'loss_val': 0.3408406486291431, 'psi': 0.8222917054382732}-{'f1_val': 0.9925289693239863, 'auprc': 0.9985288731222209, 'loss_val': 0.1890097487260031, 'psi': 0.99492893084328}
[S9] START round=31 head_norm_before_train=1.218966 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.6902215741953426, 'auprc': 0.998027466882748, 'loss_val': 0.3329417587542476, 'psi': 0.8133439312703048}-{'f1_val': 0.6978170514811213, 'auprc': 0.9980478900186955, 'loss_val': 0.30578703517855194, 'psi': 0.817909386896151}
[S10] START round=31 head_norm_before_train=1.941253 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9940317316070892, 'loss_val': 0.03246313137764484, 'psi': 0.9947253960544605}-{'f1_val': 0.9951450524673635, 'auprc': 0.9960594269534443, 'loss_val': 0.03188479135271336, 'psi': 0.9955108022617958}
[S11] START round=31 head_norm_before_train=2.075436 (no previous merge yet)
[S11] round=31 local utility u=0.000238 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9978985013633401, 'loss_val': 0.025802187745976646, 'psi': 0.9969448513155572}-{'f1_val': 0.996305167468861, 'auprc': 0.9979097640167973, 'loss_val': 0.02628855668840732, 'psi': 0.9969470060880354}
[S13] START round=31 head_norm_before_train=1.746750 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5755099839844765, 'auprc': 0.6899968776524987, 'loss_val': 0.6987307945871648, 'psi': 0.6213047414516855}-{'f1_val': 0.6024309521932216, 'auprc': 0.666689498016674, 'loss_val': 0.7102055591573746, 'psi': 0.6281343705226026}
[S14] START round=31 head_norm_before_train=1.165363 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9992003676610693, 'loss_val': 0.2561651362866114, 'psi': 0.9978786519590268}-{'f1_val': 0.9970202894562089, 'auprc': 0.997122477836318, 'loss_val': 0.2068579080406664, 'psi': 0.9970611648082526}
[S15] START round=31 head_norm_before_train=0.942396 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.127396 metrics={'f1_val': 0.8491407618979613, 'auprc': 0.9872776413566904, 'loss_val': 0.3413066104188693, 'psi': 0.904395513681453}-{'f1_val': 0.8170476860357364, 'auprc': 0.98830744475186, 'loss_val': 0.4066296395263411, 'psi': 0.8855515895221859}
[S16] START round=31 head_norm_before_train=1.428905 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8553739890031387, 'auprc': 0.9748920807144665, 'loss_val': 0.6619440455308477, 'psi': 0.9031812256876699}-{'f1_val': 0.990199908532446, 'auprc': 0.9950257929639639, 'loss_val': 0.07705116107335701, 'psi': 0.9921302623050531}
[S17] START round=31 head_norm_before_train=1.618802 cos_to_last_merge=0.8171 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.817
[S17] round=31 local utility u=0.265537 metrics={'f1_val': 0.6868022814726057, 'auprc': 0.9122661219941739, 'loss_val': 0.5954335176673062, 'psi': 0.776987817681233}-{'f1_val': 0.6657490036826397, 'auprc': 0.8421179212577113, 'loss_val': 0.7897429084268287, 'psi': 0.7362965707126683}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44614
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S3
[S14] cosine check vs S3: cos=0.5465
[S8] RECEIVED delta(kind=head bytes=1794) from S15
[S8] cosine check vs S15: cos=0.9470
[S16] RECEIVED delta(kind=head bytes=1802) from S11
[S16] cosine check vs S11: cos=0.8329
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] cosine check vs S2: cos=-0.0404
[S16] DROPPED delta from S2 (cos=-0.0404 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S7
[S16] cosine check vs S7: cos=0.5782
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S17
[S16] cosine check vs S17: cos=-0.0772
[S16] DROPPED delta from S17 (cos=-0.0772 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.7140 head_norm=1.120106
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.836955e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.7140 head_norm=1.039271 delta_norm=0.183695
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9970 head_norm=1.209523
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.307814e-01
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9974 head_norm=1.291260 delta_norm=0.730781
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.8554 head_norm=1.457693
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.877933e-02
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.8536 head_norm=1.408649 delta_norm=0.088779
[S16] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.918744 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.5439533046782737, 'auprc': 0.6255780961664723, 'loss_val': 1.7733528242356777, 'psi': 0.5766032212735532}-{'f1_val': 0.7086496469942809, 'auprc': 0.9001264600705562, 'loss_val': 0.4651565284433936, 'psi': 0.785240372224791}
[S3] START round=32 head_norm_before_train=1.714597 cos_to_last_merge=0.7948 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.795
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9884488729707058, 'auprc': 0.9997953345708991, 'loss_val': 0.04970660370589064, 'psi': 0.9929874576107831}-{'f1_val': 0.9978389274664787, 'auprc': 0.999848197255671, 'loss_val': 0.03183130029115907, 'psi': 0.9986426353821557}
[S4] START round=32 head_norm_before_train=1.381946 cos_to_last_merge=0.9989 (last merge round=30)
[S4] round=32 local utility u=0.918865 metrics={'f1_val': 0.9383796881786666, 'auprc': 0.9643628380354441, 'loss_val': 0.2973670931353824, 'psi': 0.9487729481213776}-{'f1_val': 0.6904337683195692, 'auprc': 0.9349796491062821, 'loss_val': 0.5592723336031477, 'psi': 0.7882521206342543}
[S5] START round=32 head_norm_before_train=1.176040 cos_to_last_merge=0.9997 (last merge round=30)
[S5] round=32 local utility u=0.277977 metrics={'f1_val': 0.7004465831882414, 'auprc': 0.9848426317608563, 'loss_val': 0.3332084056353706, 'psi': 0.8142050026172873}-{'f1_val': 0.7032867927782303, 'auprc': 0.8402739954502724, 'loss_val': 0.4724971085365566, 'psi': 0.758081673847047}
[S6] START round=32 head_norm_before_train=1.819224 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.5951792673470022, 'auprc': 0.7982336042360706, 'loss_val': 0.946245135306904, 'psi': 0.6764010021026295}-{'f1_val': 0.8440516457951345, 'auprc': 0.9662757088928692, 'loss_val': 0.26153681319583844, 'psi': 0.8929412710342284}
[S7] START round=32 head_norm_before_train=1.687790 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5561487256347373, 'auprc': 0.7811159264899941, 'loss_val': 0.8395468252940324, 'psi': 0.6461356059768399}-{'f1_val': 0.6636885701865975, 'auprc': 0.809430392092184, 'loss_val': 0.4385728743408723, 'psi': 0.7219852989488322}
[S8] START round=32 head_norm_before_train=1.039271 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.920470 metrics={'f1_val': 0.9892831449862951, 'auprc': 0.9984408602504853, 'loss_val': 0.1928068994740405, 'psi': 0.9929462310919712}-{'f1_val': 0.7139521677339791, 'auprc': 0.9848010119947144, 'loss_val': 0.3408406486291431, 'psi': 0.8222917054382732}
[S9] START round=32 head_norm_before_train=1.243035 cos_to_last_merge=0.9991 (last merge round=30)
[S9] round=32 local utility u=0.053606 metrics={'f1_val': 0.6991225794116844, 'auprc': 0.9982000574458709, 'loss_val': 0.2796530399650127, 'psi': 0.818753570625359}-{'f1_val': 0.6902215741953426, 'auprc': 0.998027466882748, 'loss_val': 0.3329417587542476, 'psi': 0.8133439312703048}
[S10] START round=32 head_norm_before_train=1.954781 (no previous merge yet)
[S10] round=32 local utility u=0.007194 metrics={'f1_val': 0.9955668669630084, 'auprc': 0.9970689483779834, 'loss_val': 0.029461149582867406, 'psi': 0.9961676995289984}-{'f1_val': 0.9951878390193748, 'auprc': 0.9940317316070892, 'loss_val': 0.03246313137764484, 'psi': 0.9947253960544605}
[S11] START round=32 head_norm_before_train=2.084054 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9905644502636628, 'auprc': 0.9981906495922812, 'loss_val': 0.03977638147352075, 'psi': 0.9936149299951101}-{'f1_val': 0.9963090846170353, 'auprc': 0.9978985013633401, 'loss_val': 0.025802187745976646, 'psi': 0.9969448513155572}
[S13] START round=32 head_norm_before_train=1.753558 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5333050495939476, 'auprc': 0.7177961791558196, 'loss_val': 1.1440888917860188, 'psi': 0.6071015014186965}-{'f1_val': 0.5755099839844765, 'auprc': 0.6899968776524987, 'loss_val': 0.6987307945871648, 'psi': 0.6213047414516855}
[S14] START round=32 head_norm_before_train=1.291260 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.040123 metrics={'f1_val': 0.9972086331282386, 'auprc': 0.9992021560688754, 'loss_val': 0.17719095797538853, 'psi': 0.9980060423044933}-{'f1_val': 0.9969975081576651, 'auprc': 0.9992003676610693, 'loss_val': 0.2561651362866114, 'psi': 0.9978786519590268}
[S15] START round=32 head_norm_before_train=0.986417 cos_to_last_merge=0.9982 (last merge round=30)
[S15] round=32 local utility u=0.196803 metrics={'f1_val': 0.8992050853664227, 'auprc': 0.9932807130162785, 'loss_val': 0.2660948872734318, 'psi': 0.9368353364263651}-{'f1_val': 0.8491407618979613, 'auprc': 0.9872776413566904, 'loss_val': 0.3413066104188693, 'psi': 0.904395513681453}
[S16] START round=32 head_norm_before_train=1.408649 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.153384 metrics={'f1_val': 0.8765837499114127, 'auprc': 0.987922824470303, 'loss_val': 0.521527363001559, 'psi': 0.9211193797349688}-{'f1_val': 0.8553739890031387, 'auprc': 0.9748920807144665, 'loss_val': 0.6619440455308477, 'psi': 0.9031812256876699}
[S17] START round=32 head_norm_before_train=1.627976 cos_to_last_merge=0.8153 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6092212266151648, 'auprc': 0.8340455699482373, 'loss_val': 0.8739828420610897, 'psi': 0.6991509639483938}-{'f1_val': 0.6868022814726057, 'auprc': 0.9122661219941739, 'loss_val': 0.5954335176673062, 'psi': 0.776987817681233}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:44605
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S8
[S4] cosine check vs S8: cos=0.6035
[S8] RECEIVED delta(kind=head bytes=1795) from S15
[S8] cosine check vs S15: cos=0.9790
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=-0.0472
[S9] DROPPED delta from S10 (cos=-0.0472 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.9690
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] cosine check vs S4: cos=0.8514
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=0.3056
[S15] RECEIVED delta(kind=head bytes=1803) from S16
[S15] cosine check vs S16: cos=0.6262
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.5862
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.6991 head_norm=1.271000
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.582401e-01
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.6991 head_norm=1.221637 delta_norm=0.158240
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9384 head_norm=1.416536
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.759858e-01
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9382 head_norm=1.120708 delta_norm=0.575986
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9893 head_norm=1.081164
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.112447e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9879 head_norm=1.049365 delta_norm=0.111245
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9972 head_norm=1.338789
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.693651e-01
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9972 head_norm=1.054502 delta_norm=0.769365
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.8992 head_norm=1.028674
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.754985e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.9035 head_norm=0.970509 delta_norm=0.275499
[S15] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.7004 head_norm=1.191400
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.715746e-01
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.7005 head_norm=1.254965 delta_norm=0.371575
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.931670 (no previous merge yet)
[S2] round=33 local utility u=1.000000 metrics={'f1_val': 0.7594246379377525, 'auprc': 0.8897855195223359, 'loss_val': 0.41440197903678766, 'psi': 0.8115689905715858}-{'f1_val': 0.5439533046782737, 'auprc': 0.6255780961664723, 'loss_val': 1.7733528242356777, 'psi': 0.5766032212735532}
[S3] START round=33 head_norm_before_train=1.733787 cos_to_last_merge=0.7935 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.793
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9998636170007189, 'loss_val': 0.11484616193702878, 'psi': 0.9764432121830258}-{'f1_val': 0.9884488729707058, 'auprc': 0.9997953345708991, 'loss_val': 0.04970660370589064, 'psi': 0.9929874576107831}
[S4] START round=33 head_norm_before_train=1.120708 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.031785 metrics={'f1_val': 0.943795100818809, 'auprc': 0.9684883966190907, 'loss_val': 0.2786668838978257, 'psi': 0.9536724191389216}-{'f1_val': 0.9383796881786666, 'auprc': 0.9643628380354441, 'loss_val': 0.2973670931353824, 'psi': 0.9487729481213776}
[S5] START round=33 head_norm_before_train=1.254965 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.000455 metrics={'f1_val': 0.7005335395834296, 'auprc': 0.9844963946449966, 'loss_val': 0.3317809643708413, 'psi': 0.8141186816080563}-{'f1_val': 0.7004465831882414, 'auprc': 0.9848426317608563, 'loss_val': 0.3332084056353706, 'psi': 0.8142050026172873}
[S6] START round=33 head_norm_before_train=1.831152 (no previous merge yet)
[S6] round=33 local utility u=0.972421 metrics={'f1_val': 0.7861096799351891, 'auprc': 0.9462661708314576, 'loss_val': 0.5910828651607425, 'psi': 0.8501722762936965}-{'f1_val': 0.5951792673470022, 'auprc': 0.7982336042360706, 'loss_val': 0.946245135306904, 'psi': 0.6764010021026295}
[S7] START round=33 head_norm_before_train=1.696014 (no previous merge yet)
[S7] round=33 local utility u=0.698106 metrics={'f1_val': 0.6792417490786717, 'auprc': 0.8380285187799031, 'loss_val': 0.35263096770841024, 'psi': 0.7427564569591643}-{'f1_val': 0.5561487256347373, 'auprc': 0.7811159264899941, 'loss_val': 0.8395468252940324, 'psi': 0.6461356059768399}
[S8] START round=33 head_norm_before_train=1.049365 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.007162 metrics={'f1_val': 0.9928620364247343, 'auprc': 0.9971082714112806, 'loss_val': 0.19595766747512225, 'psi': 0.9945605304193528}-{'f1_val': 0.9892831449862951, 'auprc': 0.9984408602504853, 'loss_val': 0.1928068994740405, 'psi': 0.9929462310919712}
[S9] START round=33 head_norm_before_train=1.221637 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.015068 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9981244451463146, 'loss_val': 0.2627237248644304, 'psi': 0.8200665937656133}-{'f1_val': 0.6991225794116844, 'auprc': 0.9982000574458709, 'loss_val': 0.2796530399650127, 'psi': 0.818753570625359}
[S10] START round=33 head_norm_before_train=1.968217 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956436323549077, 'loss_val': 0.03071573471145509, 'psi': 0.9953701563535879}-{'f1_val': 0.9955668669630084, 'auprc': 0.9970689483779834, 'loss_val': 0.029461149582867406, 'psi': 0.9961676995289984}
[S11] START round=33 head_norm_before_train=2.090449 (no previous merge yet)
[S11] round=33 local utility u=0.024180 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9981271274238671, 'loss_val': 0.02569334239053593, 'psi': 0.9970363017397681}-{'f1_val': 0.9905644502636628, 'auprc': 0.9981906495922812, 'loss_val': 0.03977638147352075, 'psi': 0.9936149299951101}
[S13] START round=33 head_norm_before_train=1.761373 (no previous merge yet)
[S13] round=33 local utility u=0.063988 metrics={'f1_val': 0.5465049688220418, 'auprc': 0.7083959189985591, 'loss_val': 1.0671119719127546, 'psi': 0.6112613488926488}-{'f1_val': 0.5333050495939476, 'auprc': 0.7177961791558196, 'loss_val': 1.1440888917860188, 'psi': 0.6071015014186965}
[S14] START round=33 head_norm_before_train=1.054502 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.999097704765067, 'loss_val': 0.17904829590428373, 'psi': 0.9978375868006258}-{'f1_val': 0.9972086331282386, 'auprc': 0.9992021560688754, 'loss_val': 0.17719095797538853, 'psi': 0.9980060423044933}
[S15] START round=33 head_norm_before_train=0.970509 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.9002859196820672, 'auprc': 0.9902112811881392, 'loss_val': 0.287545557100063, 'psi': 0.9362560642844959}-{'f1_val': 0.8992050853664227, 'auprc': 0.9932807130162785, 'loss_val': 0.2660948872734318, 'psi': 0.9368353364263651}
[S16] START round=33 head_norm_before_train=1.435499 cos_to_last_merge=0.9998 (last merge round=31)
[S16] round=33 local utility u=0.582364 metrics={'f1_val': 0.9917505555831294, 'auprc': 0.996203018499326, 'loss_val': 0.07264047929811789, 'psi': 0.9935315407496081}-{'f1_val': 0.8765837499114127, 'auprc': 0.987922824470303, 'loss_val': 0.521527363001559, 'psi': 0.9211193797349688}
[S17] START round=33 head_norm_before_train=1.635834 cos_to_last_merge=0.8143 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.57476386443904, 'auprc': 0.8363623178135265, 'loss_val': 1.0082143545147377, 'psi': 0.6794032457888346}-{'f1_val': 0.6092212266151648, 'auprc': 0.8340455699482373, 'loss_val': 0.8739828420610897, 'psi': 0.6991509639483938}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:44608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:44607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44605
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S5
[S4] cosine check vs S5: cos=0.9821
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=0.6074
[S6] RECEIVED delta(kind=head bytes=1801) from S4
[S6] cosine check vs S4: cos=0.7411
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] cosine check vs S9: cos=0.9517
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=0.9706
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.7861 head_norm=1.839204
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.256984e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.7857 head_norm=1.404524 delta_norm=0.625698
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=33 metric=0.6792 head_norm=1.704680
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.103004e-01
[S7] stored merged vector for next round verification (round=33)
[S7] DEBUG after merge:  round=33 metric=0.6689 head_norm=1.421544 delta_norm=0.710300
[S7] aggregate: ROLLBACK (f1_val pre=0.679 post=0.669 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.9438 head_norm=1.160043
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.288766e-01
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.9440 head_norm=1.212560 delta_norm=0.128877
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.7005 head_norm=1.275978
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.968656e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.7004 head_norm=1.250046 delta_norm=0.196866
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.9003 head_norm=1.016617
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.327174e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.9003 head_norm=1.045443 delta_norm=0.132717
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.941940 (no previous merge yet)
[S2] round=34 local utility u=0.057129 metrics={'f1_val': 0.778081876113038, 'auprc': 0.8878230449149632, 'loss_val': 0.40620069051953195, 'psi': 0.8219783436338081}-{'f1_val': 0.7594246379377525, 'auprc': 0.8897855195223359, 'loss_val': 0.41440197903678766, 'psi': 0.8115689905715858}
[S3] START round=34 head_norm_before_train=1.750647 cos_to_last_merge=0.7925 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.792
[S3] round=34 local utility u=0.012187 metrics={'f1_val': 0.9608604911886242, 'auprc': 0.9987278558765352, 'loss_val': 0.0872501763779929, 'psi': 0.9760074370637886}-{'f1_val': 0.9608296089712303, 'auprc': 0.9998636170007189, 'loss_val': 0.11484616193702878, 'psi': 0.9764432121830258}
[S4] START round=34 head_norm_before_train=1.212560 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9399170091182598, 'auprc': 0.9669461438354775, 'loss_val': 0.27271882778884415, 'psi': 0.9507286630051469}-{'f1_val': 0.943795100818809, 'auprc': 0.9684883966190907, 'loss_val': 0.2786668838978257, 'psi': 0.9536724191389216}
[S5] START round=34 head_norm_before_train=1.250046 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.550613 metrics={'f1_val': 0.8676162834459438, 'auprc': 0.9889076838343082, 'loss_val': 0.24628526368617507, 'psi': 0.9161328436012894}-{'f1_val': 0.7005335395834296, 'auprc': 0.9844963946449966, 'loss_val': 0.3317809643708413, 'psi': 0.8141186816080563}
[S6] START round=34 head_norm_before_train=1.404524 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.723957 metrics={'f1_val': 0.961413634537624, 'auprc': 0.965338467674739, 'loss_val': 0.25220882904139463, 'psi': 0.96298356779247}-{'f1_val': 0.7861096799351891, 'auprc': 0.9462661708314576, 'loss_val': 0.5910828651607425, 'psi': 0.8501722762936965}
[S7] START round=34 head_norm_before_train=1.421544 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.41689600719218, 'auprc': 0.7757952909677072, 'loss_val': 1.1588228747597085, 'psi': 0.5604557207023909}-{'f1_val': 0.6792417490786717, 'auprc': 0.8380285187799031, 'loss_val': 0.35263096770841024, 'psi': 0.7427564569591643}
[S8] START round=34 head_norm_before_train=1.089779 cos_to_last_merge=0.9989 (last merge round=32)
[S8] round=34 local utility u=0.029946 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9985506243505163, 'loss_val': 0.13626522844381875, 'psi': 0.9947247939582735}-{'f1_val': 0.9928620364247343, 'auprc': 0.9971082714112806, 'loss_val': 0.19595766747512225, 'psi': 0.9945605304193528}
[S9] START round=34 head_norm_before_train=1.254840 cos_to_last_merge=0.9987 (last merge round=32)
[S9] round=34 local utility u=0.179870 metrics={'f1_val': 0.7540949143452129, 'auprc': 0.9979301356790347, 'loss_val': 0.2188025165306552, 'psi': 0.8516290028787417}-{'f1_val': 0.7013613595118124, 'auprc': 0.9981244451463146, 'loss_val': 0.2627237248644304, 'psi': 0.8200665937656133}
[S10] START round=34 head_norm_before_train=1.976261 (no previous merge yet)
[S10] round=34 local utility u=0.002013 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9966229489891836, 'loss_val': 0.029371087286189, 'psi': 0.9957362110760916}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956436323549077, 'loss_val': 0.03071573471145509, 'psi': 0.9953701563535879}
[S11] START round=34 head_norm_before_train=2.100148 (no previous merge yet)
[S11] round=34 local utility u=0.000519 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9981494503674343, 'loss_val': 0.02472196405219922, 'psi': 0.9970452309171949}-{'f1_val': 0.9963090846170353, 'auprc': 0.9981271274238671, 'loss_val': 0.02569334239053593, 'psi': 0.9970363017397681}
[S13] START round=34 head_norm_before_train=1.767453 (no previous merge yet)
[S13] round=34 local utility u=0.150465 metrics={'f1_val': 0.5620701152656771, 'auprc': 0.7007803007895533, 'loss_val': 0.8367256394016472, 'psi': 0.6175541894752277}-{'f1_val': 0.5465049688220418, 'auprc': 0.7083959189985591, 'loss_val': 1.0671119719127546, 'psi': 0.6112613488926488}
[S14] START round=34 head_norm_before_train=1.102000 cos_to_last_merge=0.9986 (last merge round=32)
[S14] round=34 local utility u=0.017775 metrics={'f1_val': 0.9969981421187261, 'auprc': 0.9991039493806266, 'loss_val': 0.14351989378517568, 'psi': 0.9978404650234863}-{'f1_val': 0.9969975081576651, 'auprc': 0.999097704765067, 'loss_val': 0.17904829590428373, 'psi': 0.9978375868006258}
[S15] START round=34 head_norm_before_train=1.045443 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.016381 metrics={'f1_val': 0.9001907716574875, 'auprc': 0.9913923878165336, 'loss_val': 0.25775581850113133, 'psi': 0.936671418121106}-{'f1_val': 0.9002859196820672, 'auprc': 0.9902112811881392, 'loss_val': 0.287545557100063, 'psi': 0.9362560642844959}
[S16] START round=34 head_norm_before_train=1.464476 cos_to_last_merge=0.9992 (last merge round=31)
[S16] round=34 local utility u=0.003987 metrics={'f1_val': 0.9915269949829544, 'auprc': 0.9961398787205842, 'loss_val': 0.0631348088722819, 'psi': 0.9933721484780063}-{'f1_val': 0.9917505555831294, 'auprc': 0.996203018499326, 'loss_val': 0.07264047929811789, 'psi': 0.9935315407496081}
[S17] START round=34 head_norm_before_train=1.647159 cos_to_last_merge=0.8130 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=34 local utility u=0.104698 metrics={'f1_val': 0.5970281281211045, 'auprc': 0.839861741759204, 'loss_val': 0.9429022855579359, 'psi': 0.6941615735763443}-{'f1_val': 0.57476386443904, 'auprc': 0.8363623178135265, 'loss_val': 1.0082143545147377, 'psi': 0.6794032457888346}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:44603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:44608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S9
[S5] cosine check vs S9: cos=0.9852
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] cosine check vs S15: cos=0.6798
[S15] RECEIVED delta(kind=head bytes=1791) from S8
[S15] cosine check vs S8: cos=0.9887
[S4] RECEIVED delta(kind=head bytes=1805) from S5
[S4] cosine check vs S5: cos=0.9894
[S3] RECEIVED delta(kind=head bytes=1794) from S14
[S3] cosine check vs S14: cos=0.6457
[S7] RECEIVED delta(kind=head bytes=1804) from S16
[S7] cosine check vs S16: cos=0.8761
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.9399 head_norm=1.248144
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.217033e-02
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.9399 head_norm=1.256060 delta_norm=0.092170
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.4169 head_norm=1.431011
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.652833e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.4143 head_norm=1.416629 delta_norm=0.365283
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.9609 head_norm=1.766418
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.744429e-01
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.9609 head_norm=1.328729 delta_norm=0.674443
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.9002 head_norm=1.090639
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.634191e-02
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.8996 head_norm=1.109479 delta_norm=0.086342
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.8676 head_norm=1.270630
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.108534e-01
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.7492 head_norm=1.277654 delta_norm=0.110853
[S5] aggregate: ROLLBACK (f1_val pre=0.868 post=0.749 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.9915 head_norm=1.494238
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.491930e-01
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.9915 head_norm=1.187227 delta_norm=0.549193
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.955158 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.8309946134090265, 'auprc': 0.765272615413562, 'loss_val': 0.4098095312223696, 'psi': 0.8047058142108406}-{'f1_val': 0.778081876113038, 'auprc': 0.8878230449149632, 'loss_val': 0.40620069051953195, 'psi': 0.8219783436338081}
[S3] START round=35 head_norm_before_train=1.328729 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.8344732986652271, 'auprc': 0.9988200857060845, 'loss_val': 0.30538979080714485, 'psi': 0.9002120134815701}-{'f1_val': 0.9608604911886242, 'auprc': 0.9987278558765352, 'loss_val': 0.0872501763779929, 'psi': 0.9760074370637886}
[S4] START round=35 head_norm_before_train=1.256060 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9193597604984234, 'auprc': 0.9197038133492632, 'loss_val': 0.3529920089060568, 'psi': 0.9194973816387593}-{'f1_val': 0.9399170091182598, 'auprc': 0.9669461438354775, 'loss_val': 0.27271882778884415, 'psi': 0.9507286630051469}
[S5] START round=35 head_norm_before_train=1.277654 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.243774 metrics={'f1_val': 0.9500707801097543, 'auprc': 0.9873216875345261, 'loss_val': 0.2487061515912651, 'psi': 0.964971143079663}-{'f1_val': 0.8676162834459438, 'auprc': 0.9889076838343082, 'loss_val': 0.24628526368617507, 'psi': 0.9161328436012894}
[S6] START round=35 head_norm_before_train=1.419901 cos_to_last_merge=0.9999 (last merge round=33)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.823024573297806, 'auprc': 0.9530210584753734, 'loss_val': 0.4101156995107143, 'psi': 0.8750231673688329}-{'f1_val': 0.961413634537624, 'auprc': 0.965338467674739, 'loss_val': 0.25220882904139463, 'psi': 0.96298356779247}
[S7] START round=35 head_norm_before_train=1.416629 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.954054 metrics={'f1_val': 0.6258233732334185, 'auprc': 0.8020822701709379, 'loss_val': 0.5831406966549815, 'psi': 0.6963269320084262}-{'f1_val': 0.41689600719218, 'auprc': 0.7757952909677072, 'loss_val': 1.1588228747597085, 'psi': 0.5604557207023909}
[S8] START round=35 head_norm_before_train=1.134595 cos_to_last_merge=0.9959 (last merge round=32)
[S8] round=35 local utility u=0.016916 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9989121189648255, 'loss_val': 0.11002799647561427, 'psi': 0.995520444194048}-{'f1_val': 0.992174240363445, 'auprc': 0.9985506243505163, 'loss_val': 0.13626522844381875, 'psi': 0.9947247939582735}
[S9] START round=35 head_norm_before_train=1.294171 cos_to_last_merge=0.9949 (last merge round=32)
[S9] round=35 local utility u=0.651635 metrics={'f1_val': 0.9704492129451294, 'auprc': 0.9977590865023878, 'loss_val': 0.21314581592808268, 'psi': 0.9813731623680327}-{'f1_val': 0.7540949143452129, 'auprc': 0.9979301356790347, 'loss_val': 0.2188025165306552, 'psi': 0.8516290028787417}
[S10] START round=35 head_norm_before_train=1.985802 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9963491349351745, 'loss_val': 0.029286565548396204, 'psi': 0.995626685454488}-{'f1_val': 0.9951450524673635, 'auprc': 0.9966229489891836, 'loss_val': 0.029371087286189, 'psi': 0.9957362110760916}
[S11] START round=35 head_norm_before_train=2.112484 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9879533067891904, 'auprc': 0.9982604881424314, 'loss_val': 0.04338996883929655, 'psi': 0.9920761793304868}-{'f1_val': 0.9963090846170353, 'auprc': 0.9981494503674343, 'loss_val': 0.02472196405219922, 'psi': 0.9970452309171949}
[S13] START round=35 head_norm_before_train=1.769738 (no previous merge yet)
[S13] round=35 local utility u=0.007286 metrics={'f1_val': 0.5726001639943099, 'auprc': 0.7100899985363571, 'loss_val': 0.9132622544127864, 'psi': 0.6275960978111288}-{'f1_val': 0.5620701152656771, 'auprc': 0.7007803007895533, 'loss_val': 0.8367256394016472, 'psi': 0.6175541894752277}
[S14] START round=35 head_norm_before_train=1.149155 cos_to_last_merge=0.9955 (last merge round=32)
[S14] round=35 local utility u=0.013566 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990690981168366, 'loss_val': 0.11874354442664138, 'psi': 0.9980726009477701}-{'f1_val': 0.9969981421187261, 'auprc': 0.9991039493806266, 'loss_val': 0.14351989378517568, 'psi': 0.9978404650234863}
[S15] START round=35 head_norm_before_train=1.109479 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.8946658850349933, 'auprc': 0.9884875619628545, 'loss_val': 0.23063271433516255, 'psi': 0.9321945558061377}-{'f1_val': 0.9001907716574875, 'auprc': 0.9913923878165336, 'loss_val': 0.25775581850113133, 'psi': 0.936671418121106}
[S16] START round=35 head_norm_before_train=1.187227 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9917264684477215, 'auprc': 0.9957731883598936, 'loss_val': 0.11027957840493945, 'psi': 0.9933451564125904}-{'f1_val': 0.9915269949829544, 'auprc': 0.9961398787205842, 'loss_val': 0.0631348088722819, 'psi': 0.9933721484780063}
[S17] START round=35 head_norm_before_train=1.659020 cos_to_last_merge=0.8114 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=35 local utility u=0.088758 metrics={'f1_val': 0.6199200290024887, 'auprc': 0.8192433184134591, 'loss_val': 0.8408833850248598, 'psi': 0.6996493447668768}-{'f1_val': 0.5970281281211045, 'auprc': 0.839861741759204, 'loss_val': 0.9429022855579359, 'psi': 0.6941615735763443}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:44603
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44605
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S5
[S4] cosine check vs S5: cos=0.9887
[S3] RECEIVED delta(kind=head bytes=1795) from S14
[S3] cosine check vs S14: cos=0.8587
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=0.9936
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] cosine check vs S9: cos=0.9940
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=35 metric=0.8345 head_norm=1.351230
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.466574e-01
[S3] stored merged vector for next round verification (round=35)
[S3] DEBUG after merge:  round=35 metric=0.8371 head_norm=1.227105 delta_norm=0.346657
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=35 metric=0.9194 head_norm=1.288241
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.694450e-02
[S4] stored merged vector for next round verification (round=35)
[S4] DEBUG after merge:  round=35 metric=0.9099 head_norm=1.287312 delta_norm=0.096944
[S4] aggregate: ROLLBACK (f1_val pre=0.919 post=0.910 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.110 → S6@127.0.0.1:44607
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.8947 head_norm=1.143085
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.798833e-02
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.8964 head_norm=1.158398 delta_norm=0.067988
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.071 → S16@127.0.0.1:44616
[S8] ⇄ pheromone p=0.127 → S15@127.0.0.1:44615
[S14] ⇄ pheromone p=0.019 → S3@127.0.0.1:44603
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.9501 head_norm=1.293668
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.409835e-02
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.9227 head_norm=1.310579 delta_norm=0.074098
[S5] aggregate: ROLLBACK (f1_val pre=0.950 post=0.923 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.240 → S4@127.0.0.1:44604
[S9] ⇄ pheromone p=0.171 → S5@127.0.0.1:44605
[S16] ⇄ pheromone p=0.152 → S7@127.0.0.1:44608
[S2] START round=36 head_norm_before_train=1.968011 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7085742138177114, 'auprc': 0.8722572225903972, 'loss_val': 0.533072800111542, 'psi': 0.7740474173267857}-{'f1_val': 0.8309946134090265, 'auprc': 0.765272615413562, 'loss_val': 0.4098095312223696, 'psi': 0.8047058142108406}
[S3] START round=36 head_norm_before_train=1.227105 cos_to_last_merge=1.0000 (last merge round=35)
[S3] round=36 local utility u=0.412932 metrics={'f1_val': 0.9503804043842043, 'auprc': 0.9987031391743394, 'loss_val': 0.174616805239759, 'psi': 0.9697094983002584}-{'f1_val': 0.8344732986652271, 'auprc': 0.9988200857060845, 'loss_val': 0.30538979080714485, 'psi': 0.9002120134815701}
[S4] START round=36 head_norm_before_train=1.287312 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=36 local utility u=0.153997 metrics={'f1_val': 0.9378430512415883, 'auprc': 0.9613541540633543, 'loss_val': 0.2808496947182942, 'psi': 0.9472474923702947}-{'f1_val': 0.9193597604984234, 'auprc': 0.9197038133492632, 'loss_val': 0.3529920089060568, 'psi': 0.9194973816387593}
[S5] START round=36 head_norm_before_train=1.310579 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.650460043780736, 'auprc': 0.9342422380961709, 'loss_val': 0.3719135345601158, 'psi': 0.76397292150691}-{'f1_val': 0.9500707801097543, 'auprc': 0.9873216875345261, 'loss_val': 0.2487061515912651, 'psi': 0.964971143079663}
[S6] START round=36 head_norm_before_train=1.450869 cos_to_last_merge=0.9995 (last merge round=33)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.8002140644107292, 'auprc': 0.8379467490644933, 'loss_val': 0.5681280751109263, 'psi': 0.8153071382722348}-{'f1_val': 0.823024573297806, 'auprc': 0.9530210584753734, 'loss_val': 0.4101156995107143, 'psi': 0.8750231673688329}
[S7] START round=36 head_norm_before_train=1.425860 cos_to_last_merge=0.9999 (last merge round=34)
[S7] round=36 local utility u=0.034564 metrics={'f1_val': 0.6342014591534315, 'auprc': 0.7994990048471353, 'loss_val': 0.5565319008975083, 'psi': 0.7003204774309131}-{'f1_val': 0.6258233732334185, 'auprc': 0.8020822701709379, 'loss_val': 0.5831406966549815, 'psi': 0.6963269320084262}
[S8] START round=36 head_norm_before_train=1.177443 cos_to_last_merge=0.9919 (last merge round=32)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9873718260311501, 'loss_val': 0.3242197191949592, 'psi': 0.8234921936511576}-{'f1_val': 0.9932593276801964, 'auprc': 0.9989121189648255, 'loss_val': 0.11002799647561427, 'psi': 0.995520444194048}
[S9] START round=36 head_norm_before_train=1.331405 cos_to_last_merge=0.9903 (last merge round=32)
[S9] round=36 local utility u=0.113518 metrics={'f1_val': 0.9963511932942111, 'auprc': 0.9982287861644684, 'loss_val': 0.142930212912799, 'psi': 0.9971022304423139}-{'f1_val': 0.9704492129451294, 'auprc': 0.9977590865023878, 'loss_val': 0.21314581592808268, 'psi': 0.9813731623680327}
[S10] START round=36 head_norm_before_train=1.996534 (no previous merge yet)
[S10] round=36 local utility u=0.000811 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9966172249305072, 'loss_val': 0.028469472730589404, 'psi': 0.995733921452621}-{'f1_val': 0.9951450524673635, 'auprc': 0.9963491349351745, 'loss_val': 0.029286565548396204, 'psi': 0.995626685454488}
[S11] START round=36 head_norm_before_train=2.122681 (no previous merge yet)
[S11] round=36 local utility u=0.034596 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9982198301426584, 'loss_val': 0.024210133972175366, 'psi': 0.9970733828272845}-{'f1_val': 0.9879533067891904, 'auprc': 0.9982604881424314, 'loss_val': 0.04338996883929655, 'psi': 0.9920761793304868}
[S13] START round=36 head_norm_before_train=1.775467 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5893249847984086, 'auprc': 0.5854651036586465, 'loss_val': 0.9491621184473958, 'psi': 0.5877810323425037}-{'f1_val': 0.5726001639943099, 'auprc': 0.7100899985363571, 'loss_val': 0.9132622544127864, 'psi': 0.6275960978111288}
[S14] START round=36 head_norm_before_train=1.194193 cos_to_last_merge=0.9918 (last merge round=32)
[S14] round=36 local utility u=0.006495 metrics={'f1_val': 0.9970407855713329, 'auprc': 0.9972653962178718, 'loss_val': 0.09813725211687137, 'psi': 0.9971306298299485}-{'f1_val': 0.9974082695017256, 'auprc': 0.9990690981168366, 'loss_val': 0.11874354442664138, 'psi': 0.9980726009477701}
[S15] START round=36 head_norm_before_train=1.158398 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.365953 metrics={'f1_val': 0.9952374137271993, 'auprc': 0.9970943270593907, 'loss_val': 0.12797704884939798, 'psi': 0.9959801790600759}-{'f1_val': 0.8946658850349933, 'auprc': 0.9884875619628545, 'loss_val': 0.23063271433516255, 'psi': 0.9321945558061377}
[S16] START round=36 head_norm_before_train=1.224728 cos_to_last_merge=0.9994 (last merge round=34)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9778652360957178, 'auprc': 0.9920445844003836, 'loss_val': 0.12650326169693044, 'psi': 0.9835369754175841}-{'f1_val': 0.9917264684477215, 'auprc': 0.9957731883598936, 'loss_val': 0.11027957840493945, 'psi': 0.9933451564125904}
[S17] START round=36 head_norm_before_train=1.673108 cos_to_last_merge=0.8098 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6044865600181272, 'auprc': 0.7761836771007922, 'loss_val': 0.8247965324692108, 'psi': 0.6731654068511932}-{'f1_val': 0.6199200290024887, 'auprc': 0.8192433184134591, 'loss_val': 0.8408833850248598, 'psi': 0.6996493447668768}
[S3]  timeout peer S2
[S2]  timeout peer S3
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44603
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:44607
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1807 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1807) from S4
[S6] cosine check vs S4: cos=0.8702
[S3] RECEIVED delta(kind=head bytes=1800) from S14
[S3] cosine check vs S14: cos=0.9527
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] cosine check vs S9: cos=0.9971
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] cosine check vs S7: cos=0.9155
[S16] RECEIVED delta(kind=head bytes=1790) from S15
[S16] cosine check vs S15: cos=0.8585
[S14] RECEIVED delta(kind=head bytes=1801) from S3
[S14] cosine check vs S3: cos=0.9527
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=36 metric=0.9504 head_norm=1.267455
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.931293e-01
[S3] stored merged vector for next round verification (round=36)
[S3] DEBUG after merge:  round=36 metric=0.9516 head_norm=1.236555 delta_norm=0.193129
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.8002 head_norm=1.489879
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.671034e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.7966 head_norm=1.355127 delta_norm=0.367103
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=36 metric=0.6505 head_norm=1.321488
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.503452e-02
[S5] stored merged vector for next round verification (round=36)
[S5] DEBUG after merge:  round=36 metric=0.6479 head_norm=1.341066 delta_norm=0.055035
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.9779 head_norm=1.267220
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.252554e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.9772 head_norm=1.224556 delta_norm=0.125255
[S16] aggregate: ACCEPT kept=['S7', 'S15'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9970 head_norm=1.235432
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.931293e-01
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9970 head_norm=1.236555 delta_norm=0.193129
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.975829 (no previous merge yet)
[S2] round=37 local utility u=0.292944 metrics={'f1_val': 0.8309946134090265, 'auprc': 0.7799665163914207, 'loss_val': 0.4048348028189321, 'psi': 0.8105833746019842}-{'f1_val': 0.7085742138177114, 'auprc': 0.8722572225903972, 'loss_val': 0.533072800111542, 'psi': 0.7740474173267857}
[S3] START round=37 head_norm_before_train=1.236555 cos_to_last_merge=1.0000 (last merge round=36)
[S3] round=37 local utility u=0.082538 metrics={'f1_val': 0.9749327718229718, 'auprc': 0.9988199100144721, 'loss_val': 0.15720532360958742, 'psi': 0.9844876270995719}-{'f1_val': 0.9503804043842043, 'auprc': 0.9987031391743394, 'loss_val': 0.174616805239759, 'psi': 0.9697094983002584}
[S4] START round=37 head_norm_before_train=1.312452 cos_to_last_merge=0.9998 (last merge round=35)
[S4] round=37 local utility u=0.063537 metrics={'f1_val': 0.9513479177917659, 'auprc': 0.9680108417109549, 'loss_val': 0.2547751404882134, 'psi': 0.9580130873594415}-{'f1_val': 0.9378430512415883, 'auprc': 0.9613541540633543, 'loss_val': 0.2808496947182942, 'psi': 0.9472474923702947}
[S5] START round=37 head_norm_before_train=1.341066 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=37 local utility u=0.260226 metrics={'f1_val': 0.7006947214685414, 'auprc': 0.9765498574501303, 'loss_val': 0.2797926618575074, 'psi': 0.811036775861177}-{'f1_val': 0.650460043780736, 'auprc': 0.9342422380961709, 'loss_val': 0.3719135345601158, 'psi': 0.76397292150691}
[S6] START round=37 head_norm_before_train=1.355127 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7130086376676161, 'auprc': 0.7769103994521406, 'loss_val': 0.7116692110748866, 'psi': 0.7385693423814259}-{'f1_val': 0.8002140644107292, 'auprc': 0.8379467490644933, 'loss_val': 0.5681280751109263, 'psi': 0.8153071382722348}
[S7] START round=37 head_norm_before_train=1.445081 cos_to_last_merge=0.9988 (last merge round=34)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.6154598091884627, 'auprc': 0.7900713606345111, 'loss_val': 0.6076906761231702, 'psi': 0.685304429766882}-{'f1_val': 0.6342014591534315, 'auprc': 0.7994990048471353, 'loss_val': 0.5565319008975083, 'psi': 0.7003204774309131}
[S8] START round=37 head_norm_before_train=1.218184 cos_to_last_merge=0.9880 (last merge round=32)
[S8] round=37 local utility u=0.973011 metrics={'f1_val': 0.9926811669910671, 'auprc': 0.9990515584016321, 'loss_val': 0.08388970933588517, 'psi': 0.9952293235552931}-{'f1_val': 0.7142391053978291, 'auprc': 0.9873718260311501, 'loss_val': 0.3242197191949592, 'psi': 0.8234921936511576}
[S9] START round=37 head_norm_before_train=1.362586 cos_to_last_merge=0.9864 (last merge round=32)
[S9] round=37 local utility u=0.009252 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9981100196048126, 'loss_val': 0.12899736506536008, 'psi': 0.9975475146511688}-{'f1_val': 0.9963511932942111, 'auprc': 0.9982287861644684, 'loss_val': 0.142930212912799, 'psi': 0.9971022304423139}
[S10] START round=37 head_norm_before_train=2.002646 (no previous merge yet)
[S10] round=37 local utility u=0.000020 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.996567039598668, 'loss_val': 0.02827832249862866, 'psi': 0.9957138473198853}-{'f1_val': 0.9951450524673635, 'auprc': 0.9966172249305072, 'loss_val': 0.028469472730589404, 'psi': 0.995733921452621}
[S11] START round=37 head_norm_before_train=2.132931 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9982252058557246, 'loss_val': 0.023383071870782104, 'psi': 0.9968251850634382}-{'f1_val': 0.9963090846170353, 'auprc': 0.9982198301426584, 'loss_val': 0.024210133972175366, 'psi': 0.9970733828272845}
[S13] START round=37 head_norm_before_train=1.780915 (no previous merge yet)
[S13] round=37 local utility u=0.113998 metrics={'f1_val': 0.5663857356509083, 'auprc': 0.7248447681004355, 'loss_val': 1.001669160022944, 'psi': 0.6297693486307192}-{'f1_val': 0.5893249847984086, 'auprc': 0.5854651036586465, 'loss_val': 0.9491621184473958, 'psi': 0.5877810323425037}
[S14] START round=37 head_norm_before_train=1.236555 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.004912 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9989335058825728, 'loss_val': 0.09059529857756161, 'psi': 0.9975257413194794}-{'f1_val': 0.9970407855713329, 'auprc': 0.9972653962178718, 'loss_val': 0.09813725211687137, 'psi': 0.9971306298299485}
[S15] START round=37 head_norm_before_train=1.186887 cos_to_last_merge=0.9998 (last merge round=35)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8853713802349895, 'auprc': 0.9888337949978959, 'loss_val': 0.24517697173458566, 'psi': 0.926756346140152}-{'f1_val': 0.9952374137271993, 'auprc': 0.9970943270593907, 'loss_val': 0.12797704884939798, 'psi': 0.9959801790600759}
[S16] START round=37 head_norm_before_train=1.224556 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.065709 metrics={'f1_val': 0.9921885099697452, 'auprc': 0.9955411826086598, 'loss_val': 0.09151442462521577, 'psi': 0.9935295790253109}-{'f1_val': 0.9778652360957178, 'auprc': 0.9920445844003836, 'loss_val': 0.12650326169693044, 'psi': 0.9835369754175841}
[S17] START round=37 head_norm_before_train=1.685910 cos_to_last_merge=0.8083 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6133741712292597, 'auprc': 0.7132922358978327, 'loss_val': 0.9981615097694642, 'psi': 0.6533413970966889}-{'f1_val': 0.6044865600181272, 'auprc': 0.7761836771007922, 'loss_val': 0.8247965324692108, 'psi': 0.6731654068511932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:44603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:44607
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:44610
[S14] RECEIVED delta(kind=head bytes=1799) from S3
[S14] cosine check vs S3: cos=0.9987
[S5] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S4
[S6] cosine check vs S4: cos=0.9576
[S5] RECEIVED delta(kind=head bytes=1801) from S9
[S5] cosine check vs S9: cos=0.9982
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=0.9932
[S3] RECEIVED delta(kind=head bytes=1796) from S14
[S3] cosine check vs S14: cos=0.9987
[S9] RECEIVED delta(kind=head bytes=1806) from S5
[S9] cosine check vs S5: cos=0.9982
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:44608
[S16] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S16
[S7] cosine check vs S16: cos=0.9225
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.9749 head_norm=1.284423
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.327312e-02
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.9749 head_norm=1.278042 delta_norm=0.033273
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.6155 head_norm=1.471727
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.873763e-01
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.6098 head_norm=1.344066 delta_norm=0.287376
[S7] aggregate: ROLLBACK (f1_val pre=0.615 post=0.610 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=37 metric=0.7130 head_norm=1.388128
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.998989e-01
[S6] stored merged vector for next round verification (round=37)
[S6] DEBUG after merge:  round=37 metric=0.7096 head_norm=1.345954 delta_norm=0.199899
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9966 head_norm=1.272500
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.327313e-02
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9966 head_norm=1.278042 delta_norm=0.033273
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=37 metric=0.9972 head_norm=1.389494
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.471343e-02
[S9] stored merged vector for next round verification (round=37)
[S9] DEBUG after merge:  round=37 metric=0.9976 head_norm=1.371641 delta_norm=0.044713
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=37 metric=0.7007 head_norm=1.355029
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.471343e-02
[S5] stored merged vector for next round verification (round=37)
[S5] DEBUG after merge:  round=37 metric=0.7007 head_norm=1.371641 delta_norm=0.044713
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.8854 head_norm=1.210957
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.395273e-02
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.8866 head_norm=1.226835 delta_norm=0.073953
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.983528 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7086515145217377, 'auprc': 0.9190190931835684, 'loss_val': 0.5097443316872853, 'psi': 0.7927985459864699}-{'f1_val': 0.8309946134090265, 'auprc': 0.7799665163914207, 'loss_val': 0.4048348028189321, 'psi': 0.8105833746019842}
[S3] START round=38 head_norm_before_train=1.278042 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.009277 metrics={'f1_val': 0.972044775801435, 'auprc': 0.9987944900953201, 'loss_val': 0.1212475260224115, 'psi': 0.982744661518989}-{'f1_val': 0.9749327718229718, 'auprc': 0.9988199100144721, 'loss_val': 0.15720532360958742, 'psi': 0.9844876270995719}
[S4] START round=38 head_norm_before_train=1.332744 cos_to_last_merge=0.9995 (last merge round=35)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9398838249833414, 'auprc': 0.9694137885222842, 'loss_val': 0.27560179628751863, 'psi': 0.9516958103989185}-{'f1_val': 0.9513479177917659, 'auprc': 0.9680108417109549, 'loss_val': 0.2547751404882134, 'psi': 0.9580130873594415}
[S5] START round=38 head_norm_before_train=1.371641 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.5371590399483234, 'auprc': 0.8544100282262346, 'loss_val': 0.5362285749921198, 'psi': 0.6640594352594879}-{'f1_val': 0.7006947214685414, 'auprc': 0.9765498574501303, 'loss_val': 0.2797926618575074, 'psi': 0.811036775861177}
[S6] START round=38 head_norm_before_train=1.345954 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=38 local utility u=0.837589 metrics={'f1_val': 0.8353337976740502, 'auprc': 0.9569397277140499, 'loss_val': 0.3105307333506929, 'psi': 0.8839761696900501}-{'f1_val': 0.7130086376676161, 'auprc': 0.7769103994521406, 'loss_val': 0.7116692110748866, 'psi': 0.7385693423814259}
[S7] START round=38 head_norm_before_train=1.344066 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5656107407783093, 'auprc': 0.7793525959075006, 'loss_val': 0.7746447226996667, 'psi': 0.6511074828299859}-{'f1_val': 0.6154598091884627, 'auprc': 0.7900713606345111, 'loss_val': 0.6076906761231702, 'psi': 0.685304429766882}
[S8] START round=38 head_norm_before_train=1.246904 cos_to_last_merge=0.9853 (last merge round=32)
[S8] round=38 local utility u=0.001368 metrics={'f1_val': 0.9918008107316822, 'auprc': 0.9990064778462162, 'loss_val': 0.07573732215331849, 'psi': 0.9946830775774959}-{'f1_val': 0.9926811669910671, 'auprc': 0.9990515584016321, 'loss_val': 0.08388970933588517, 'psi': 0.9952293235552931}
[S9] START round=38 head_norm_before_train=1.371641 cos_to_last_merge=1.0000 (last merge round=37)
[S9] round=38 local utility u=0.007267 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9981574369344821, 'loss_val': 0.11213923975151581, 'psi': 0.9973199408382019}-{'f1_val': 0.9971725113487396, 'auprc': 0.9981100196048126, 'loss_val': 0.12899736506536008, 'psi': 0.9975475146511688}
[S10] START round=38 head_norm_before_train=2.011087 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9964385070708052, 'loss_val': 0.028098553620641967, 'psi': 0.9956624343087401}-{'f1_val': 0.9951450524673635, 'auprc': 0.996567039598668, 'loss_val': 0.02827832249862866, 'psi': 0.9957138473198853}
[S11] START round=38 head_norm_before_train=2.143712 (no previous merge yet)
[S11] round=38 local utility u=0.000495 metrics={'f1_val': 0.9963061018870393, 'auprc': 0.9982116807845004, 'loss_val': 0.02483898071170376, 'psi': 0.9970683334460237}-{'f1_val': 0.9958918378685807, 'auprc': 0.9982252058557246, 'loss_val': 0.023383071870782104, 'psi': 0.9968251850634382}
[S13] START round=38 head_norm_before_train=1.782630 (no previous merge yet)
[S13] round=38 local utility u=0.194651 metrics={'f1_val': 0.5919294803282998, 'auprc': 0.7120953451686803, 'loss_val': 0.7273820998777837, 'psi': 0.6399958262644521}-{'f1_val': 0.5663857356509083, 'auprc': 0.7248447681004355, 'loss_val': 1.001669160022944, 'psi': 0.6297693486307192}
[S14] START round=38 head_norm_before_train=1.278042 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.004081 metrics={'f1_val': 0.9966305087305161, 'auprc': 0.9988517157257095, 'loss_val': 0.08244764901847777, 'psi': 0.9975189915285935}-{'f1_val': 0.9965872316107504, 'auprc': 0.9989335058825728, 'loss_val': 0.09059529857756161, 'psi': 0.9975257413194794}
[S15] START round=38 head_norm_before_train=1.226835 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=0.203084 metrics={'f1_val': 0.9329951424130059, 'auprc': 0.9962652502025723, 'loss_val': 0.14704520777611865, 'psi': 0.9583031855288324}-{'f1_val': 0.8853713802349895, 'auprc': 0.9888337949978959, 'loss_val': 0.24517697173458566, 'psi': 0.926756346140152}
[S16] START round=38 head_norm_before_train=1.269732 cos_to_last_merge=0.9994 (last merge round=36)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.875696451317364, 'auprc': 0.99462765918646, 'loss_val': 0.4711033685998751, 'psi': 0.9232689344650024}-{'f1_val': 0.9921885099697452, 'auprc': 0.9955411826086598, 'loss_val': 0.09151442462521577, 'psi': 0.9935295790253109}
[S17] START round=38 head_norm_before_train=1.695799 cos_to_last_merge=0.8071 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=38 local utility u=0.230022 metrics={'f1_val': 0.6289231959155734, 'auprc': 0.7847960344516525, 'loss_val': 0.8459225134129782, 'psi': 0.6912723313300051}-{'f1_val': 0.6133741712292597, 'auprc': 0.7132922358978327, 'loss_val': 0.9981615097694642, 'psi': 0.6533413970966889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44614
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:44604
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S9] → sending delta(kind=head bytes=1809) to S5@127.0.0.1:44605
[S14] RECEIVED delta(kind=head bytes=1797) from S3
[S14] cosine check vs S3: cos=0.9983
[S9] sending update (kind=head size=1809 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1809) from S9
[S5] cosine check vs S9: cos=0.9996
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S8
[S15] cosine check vs S8: cos=0.9967
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:44603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S6
[S4] cosine check vs S6: cos=0.9848
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S14
[S3] cosine check vs S14: cos=0.9983
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44616
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.5372 head_norm=1.387932
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.093251e-02
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.5359 head_norm=1.393400 delta_norm=0.020933
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=38 metric=0.9399 head_norm=1.346642
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.203238e-01
[S4] stored merged vector for next round verification (round=38)
[S4] DEBUG after merge:  round=38 metric=0.9399 head_norm=1.359602 delta_norm=0.120324
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S15
[S16] cosine check vs S15: cos=0.8585
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.9720 head_norm=1.343579
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.228193e-02
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.9725 head_norm=1.326330 delta_norm=0.042282
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=38 metric=0.9966 head_norm=1.310218
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.228193e-02
[S14] stored merged vector for next round verification (round=38)
[S14] DEBUG after merge:  round=38 metric=0.9966 head_norm=1.326330 delta_norm=0.042282
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.8757 head_norm=1.311527
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.420126e-01
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.8753 head_norm=1.234645 delta_norm=0.342013
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.9330 head_norm=1.250016
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.214398e-02
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.9335 head_norm=1.259807 delta_norm=0.052144
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.991527 (no previous merge yet)
[S2] round=39 local utility u=0.049677 metrics={'f1_val': 0.731858162406135, 'auprc': 0.9025186308835383, 'loss_val': 0.5001285790299104, 'psi': 0.8001223497970964}-{'f1_val': 0.7086515145217377, 'auprc': 0.9190190931835684, 'loss_val': 0.5097443316872853, 'psi': 0.7927985459864699}
[S3] START round=39 head_norm_before_train=1.326330 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9984223568569476, 'loss_val': 0.1435034852273268, 'psi': 0.9760139939824513}-{'f1_val': 0.972044775801435, 'auprc': 0.9987944900953201, 'loss_val': 0.1212475260224115, 'psi': 0.982744661518989}
[S4] START round=39 head_norm_before_train=1.359602 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=39 local utility u=0.031242 metrics={'f1_val': 0.9447351636580632, 'auprc': 0.976738645282414, 'loss_val': 0.2641998522613751, 'psi': 0.9575365563078035}-{'f1_val': 0.9398838249833414, 'auprc': 0.9694137885222842, 'loss_val': 0.27560179628751863, 'psi': 0.9516958103989185}
[S5] START round=39 head_norm_before_train=1.393400 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.855024 metrics={'f1_val': 0.7017729049353254, 'auprc': 0.9889856289989535, 'loss_val': 0.21759106098806855, 'psi': 0.8166579945607766}-{'f1_val': 0.5371590399483234, 'auprc': 0.8544100282262346, 'loss_val': 0.5362285749921198, 'psi': 0.6640594352594879}
[S6] START round=39 head_norm_before_train=1.382949 cos_to_last_merge=0.9995 (last merge round=37)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.7064848765243747, 'auprc': 0.8699313118061782, 'loss_val': 0.7161218153949931, 'psi': 0.7718634506370962}-{'f1_val': 0.8353337976740502, 'auprc': 0.9569397277140499, 'loss_val': 0.3105307333506929, 'psi': 0.8839761696900501}
[S7] START round=39 head_norm_before_train=1.381615 cos_to_last_merge=0.9992 (last merge round=37)
[S7] round=39 local utility u=0.346643 metrics={'f1_val': 0.6395012382447486, 'auprc': 0.7960038339449027, 'loss_val': 0.5746563570561531, 'psi': 0.7021022765248102}-{'f1_val': 0.5656107407783093, 'auprc': 0.7793525959075006, 'loss_val': 0.7746447226996667, 'psi': 0.6511074828299859}
[S8] START round=39 head_norm_before_train=1.271662 cos_to_last_merge=0.9827 (last merge round=32)
[S8] round=39 local utility u=0.009027 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9992190504025196, 'loss_val': 0.06707182699604121, 'psi': 0.9956432167691256}-{'f1_val': 0.9918008107316822, 'auprc': 0.9990064778462162, 'loss_val': 0.07573732215331849, 'psi': 0.9946830775774959}
[S9] START round=39 head_norm_before_train=1.399160 cos_to_last_merge=0.9997 (last merge round=37)
[S9] round=39 local utility u=0.008480 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9981563674769515, 'loss_val': 0.09517688585562914, 'psi': 0.9973195130551895}-{'f1_val': 0.9967616101073482, 'auprc': 0.9981574369344821, 'loss_val': 0.11213923975151581, 'psi': 0.9973199408382019}
[S10] START round=39 head_norm_before_train=2.020771 (no previous merge yet)
[S10] round=39 local utility u=0.000558 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9966165033231885, 'loss_val': 0.027516541552171016, 'psi': 0.9957336328096935}-{'f1_val': 0.9951450524673635, 'auprc': 0.9964385070708052, 'loss_val': 0.028098553620641967, 'psi': 0.9956624343087401}
[S11] START round=39 head_norm_before_train=2.153295 (no previous merge yet)
[S11] round=39 local utility u=0.000755 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9981821726886166, 'loss_val': 0.023258325643810855, 'psi': 0.9970583198456678}-{'f1_val': 0.9963061018870393, 'auprc': 0.9982116807845004, 'loss_val': 0.02483898071170376, 'psi': 0.9970683334460237}
[S13] START round=39 head_norm_before_train=1.782043 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5879274985330585, 'auprc': 0.6094865645746788, 'loss_val': 0.9422378369783253, 'psi': 0.5965511249497066}-{'f1_val': 0.5919294803282998, 'auprc': 0.7120953451686803, 'loss_val': 0.7273820998777837, 'psi': 0.6399958262644521}
[S14] START round=39 head_norm_before_train=1.326330 cos_to_last_merge=1.0000 (last merge round=38)
[S14] round=39 local utility u=0.004702 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9987493506524754, 'loss_val': 0.07234477554207146, 'psi': 0.9974388742067661}-{'f1_val': 0.9966305087305161, 'auprc': 0.9988517157257095, 'loss_val': 0.08244764901847777, 'psi': 0.9975189915285935}
[S15] START round=39 head_norm_before_train=1.259807 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.69896393608683, 'auprc': 0.9062950124183297, 'loss_val': 0.43588447998872176, 'psi': 0.7818963666194299}-{'f1_val': 0.9329951424130059, 'auprc': 0.9962652502025723, 'loss_val': 0.14704520777611865, 'psi': 0.9583031855288324}
[S16] START round=39 head_norm_before_train=1.234645 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.267629 metrics={'f1_val': 0.9336335309989189, 'auprc': 0.9953424365962015, 'loss_val': 0.2856129376738546, 'psi': 0.958317093237832}-{'f1_val': 0.875696451317364, 'auprc': 0.99462765918646, 'loss_val': 0.4711033685998751, 'psi': 0.9232689344650024}
[S17] START round=39 head_norm_before_train=1.707707 cos_to_last_merge=0.8054 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.805
[S17] round=39 local utility u=0.278358 metrics={'f1_val': 0.6607577102436796, 'auprc': 0.8451645519053144, 'loss_val': 0.6613198870498845, 'psi': 0.7345204469083335}-{'f1_val': 0.6289231959155734, 'auprc': 0.7847960344516525, 'loss_val': 0.8459225134129782, 'psi': 0.6912723313300051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:44610
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:44608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:44605
[S14] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S14
[S3] cosine check vs S14: cos=0.9985
[S5] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.9990
[S16] RECEIVED delta(kind=head bytes=1797) from S7
[S16] cosine check vs S7: cos=0.8967
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S9
[S5] cosine check vs S9: cos=0.9990
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] cosine check vs S8: cos=0.9980
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=0.8967
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:44607
[S4] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S4
[S6] cosine check vs S4: cos=0.9931
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=39 metric=0.9611 head_norm=1.394248
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.180007e-02
[S3] stored merged vector for next round verification (round=39)
[S3] DEBUG after merge:  round=39 metric=0.9611 head_norm=1.374371 delta_norm=0.041800
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] r=40 psi=0.976 u=0.0000 p_local=0.0820 f1=0.961 auprc=0.998 bytes=37707
[S2] r=40 psi=0.800 u=0.0497 p_local=0.1362 f1=0.732 auprc=0.903 bytes=28780
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S13
[S16]  timeout peer S14
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S7
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S16
[S8]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S11] r=40 psi=0.997 u=0.0008 p_local=0.0105 f1=0.996 auprc=0.998 bytes=44912
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=39 metric=0.7065 head_norm=1.432534
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.832231e-02
[S6] stored merged vector for next round verification (round=39)
[S6] DEBUG after merge:  round=39 metric=0.6996 head_norm=1.398503 delta_norm=0.088322
[S6] aggregate: ROLLBACK (f1_val pre=0.706 post=0.700 tol_abs=0.005 tol_rel=0.0)
[S6] r=40 psi=0.772 u=0.0000 p_local=0.2818 f1=0.706 auprc=0.870 bytes=28741
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.6990 head_norm=1.284450
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.142268e-02
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.6990 head_norm=1.289759 delta_norm=0.041423
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.782 u=0.0000 p_local=0.0991 f1=0.699 auprc=0.906 bytes=34141
[S10] r=40 psi=0.996 u=0.0006 p_local=0.0026 f1=0.995 auprc=0.997 bytes=44987
[S13] r=40 psi=0.597 u=0.0000 p_local=0.0731 f1=0.588 auprc=0.609 bytes=32378
[S14] r=40 psi=0.997 u=0.0047 p_local=0.0109 f1=0.997 auprc=0.999 bytes=46729
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.6395 head_norm=1.418533
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.138973e-01
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.6317 head_norm=1.312258 delta_norm=0.313897
[S7] aggregate: ROLLBACK (f1_val pre=0.640 post=0.632 tol_abs=0.005 tol_rel=0.0)
[S7] r=40 psi=0.702 u=0.3466 p_local=0.2317 f1=0.640 auprc=0.796 bytes=37769
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=39 metric=0.7018 head_norm=1.409493
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.298109e-02
[S5] stored merged vector for next round verification (round=39)
[S5] DEBUG after merge:  round=39 metric=0.7018 head_norm=1.418584 delta_norm=0.032981
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] r=40 psi=0.817 u=0.8550 p_local=0.3028 f1=0.702 auprc=0.989 bytes=37751
[S8] r=40 psi=0.996 u=0.0090 p_local=0.1785 f1=0.993 auprc=0.999 bytes=41334
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=39 metric=0.9968 head_norm=1.428380
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.298110e-02
[S9] stored merged vector for next round verification (round=39)
[S9] DEBUG after merge:  round=39 metric=0.9968 head_norm=1.418584 delta_norm=0.032981
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] r=40 psi=0.997 u=0.0085 p_local=0.0859 f1=0.997 auprc=0.998 bytes=41435
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.9336 head_norm=1.276271
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.138973e-01
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.9334 head_norm=1.312258 delta_norm=0.313897
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.958 u=0.2676 p_local=0.1243 f1=0.934 auprc=0.995 bytes=37770
[S17] r=40 psi=0.735 u=0.2784 p_local=0.1300 f1=0.661 auprc=0.845 bytes=35970
[S4] r=40 psi=0.958 u=0.0312 p_local=0.0753 f1=0.945 auprc=0.977 bytes=39525
[S2] START round=40 head_norm_before_train=1.999016 (no previous merge yet)
[S2] round=40 local utility u=0.050270 metrics={'f1_val': 0.825141925748551, 'auprc': 0.7410018798304014, 'loss_val': 0.4747401469450003, 'psi': 0.7914859073812912}-{'f1_val': 0.731858162406135, 'auprc': 0.9025186308835383, 'loss_val': 0.5001285790299104, 'psi': 0.8001223497970964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=40 head_norm_before_train=1.374371 cos_to_last_merge=1.0000 (last merge round=39)
[S3] round=40 local utility u=0.005130 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.99879809008798, 'loss_val': 0.13436975062881806, 'psi': 0.9761642872748643}-{'f1_val': 0.9610750853994537, 'auprc': 0.9984223568569476, 'loss_val': 0.1435034852273268, 'psi': 0.9760139939824513}
[S4] START round=40 head_norm_before_train=1.369332 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9400271714209207, 'auprc': 0.9693329001105241, 'loss_val': 0.27618496278518057, 'psi': 0.9517494628967621}-{'f1_val': 0.9447351636580632, 'auprc': 0.976738645282414, 'loss_val': 0.2641998522613751, 'psi': 0.9575365563078035}
[S5] START round=40 head_norm_before_train=1.418584 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.6390090375023567, 'auprc': 0.9349559689939781, 'loss_val': 0.3942910995533736, 'psi': 0.7573878100990052}-{'f1_val': 0.7017729049353254, 'auprc': 0.9889856289989535, 'loss_val': 0.21759106098806855, 'psi': 0.8166579945607766}
[S6] START round=40 head_norm_before_train=1.398503 cos_to_last_merge=1.0000 (last merge round=39)
[S6] round=40 local utility u=0.709136 metrics={'f1_val': 0.8370669573546696, 'auprc': 0.9553348375547995, 'loss_val': 0.3375519286078342, 'psi': 0.8843741094347216}-{'f1_val': 0.7064848765243747, 'auprc': 0.8699313118061782, 'loss_val': 0.7161218153949931, 'psi': 0.7718634506370962}
[S7] START round=40 head_norm_before_train=1.312258 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5283488574345746, 'auprc': 0.7780387279405779, 'loss_val': 0.9092470841755739, 'psi': 0.6282248056369759}-{'f1_val': 0.6395012382447486, 'auprc': 0.7960038339449027, 'loss_val': 0.5746563570561531, 'psi': 0.7021022765248102}
[S8] START round=40 head_norm_before_train=1.296370 cos_to_last_merge=0.9802 (last merge round=32)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9987424450771681, 'loss_val': 0.06394274026459691, 'psi': 0.9948015222489343}-{'f1_val': 0.9932593276801964, 'auprc': 0.9992190504025196, 'loss_val': 0.06707182699604121, 'psi': 0.9956432167691256}
[S9] START round=40 head_norm_before_train=1.418584 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=40 local utility u=0.006195 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9982454513756442, 'loss_val': 0.08305340711521378, 'psi': 0.9973551466146666}-{'f1_val': 0.9967616101073482, 'auprc': 0.9981563674769515, 'loss_val': 0.09517688585562914, 'psi': 0.9973195130551895}
[S10] START round=40 head_norm_before_train=2.030732 (no previous merge yet)
[S10] round=40 local utility u=0.000187 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9966221003939288, 'loss_val': 0.02715973725748115, 'psi': 0.9957358716379896}-{'f1_val': 0.9951450524673635, 'auprc': 0.9966165033231885, 'loss_val': 0.027516541552171016, 'psi': 0.9957336328096935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=40 head_norm_before_train=2.159566 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9963100190352135, 'auprc': 0.9982390781826842, 'loss_val': 0.024652610343665674, 'psi': 0.9970816426942017}-{'f1_val': 0.9963090846170353, 'auprc': 0.9981821726886166, 'loss_val': 0.023258325643810855, 'psi': 0.9970583198456678}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.785700 (no previous merge yet)
[S13] round=40 local utility u=0.134566 metrics={'f1_val': 0.5753571806293596, 'auprc': 0.7311823200903153, 'loss_val': 0.9627713370206774, 'psi': 0.6376872364137418}-{'f1_val': 0.5879274985330585, 'auprc': 0.6094865645746788, 'loss_val': 0.9422378369783253, 'psi': 0.5965511249497066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=40 head_norm_before_train=1.355491 cos_to_last_merge=0.9999 (last merge round=38)
[S14] round=40 local utility u=0.003632 metrics={'f1_val': 0.9966305087305161, 'auprc': 0.9988218946066263, 'loss_val': 0.06569094286041519, 'psi': 0.9975070630809602}-{'f1_val': 0.9965652232429598, 'auprc': 0.9987493506524754, 'loss_val': 0.07234477554207146, 'psi': 0.9974388742067661}
[S15] START round=40 head_norm_before_train=1.289759 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9913134937310607, 'loss_val': 0.08681081462194477, 'psi': 0.9945733985249366}-{'f1_val': 0.69896393608683, 'auprc': 0.9062950124183297, 'loss_val': 0.43588447998872176, 'psi': 0.7818963666194299}
[S16] START round=40 head_norm_before_train=1.312258 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.281944 metrics={'f1_val': 0.9917505555831294, 'auprc': 0.996369404571281, 'loss_val': 0.07350711386841358, 'psi': 0.99359809517839}-{'f1_val': 0.9336335309989189, 'auprc': 0.9953424365962015, 'loss_val': 0.2856129376738546, 'psi': 0.958317093237832}
[S17] START round=40 head_norm_before_train=1.716355 cos_to_last_merge=0.8039 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.804
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6185297056310436, 'auprc': 0.8276181187539347, 'loss_val': 0.8498722375464979, 'psi': 0.7021650708802001}-{'f1_val': 0.6607577102436796, 'auprc': 0.8451645519053144, 'loss_val': 0.6613198870498845, 'psi': 0.7345204469083335}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:44604
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[S7] ⇄ pheromone p=0.185 → S16@127.0.0.1:44616
[S3] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1807 to 1 peers)
[S8] ⇄ pheromone p=0.143 → S15@127.0.0.1:44615
[S4] RECEIVED delta(kind=head bytes=1807) from S6
[S4] cosine check vs S6: cos=0.9958
[S14] RECEIVED delta(kind=head bytes=1800) from S3
[S14] cosine check vs S3: cos=0.9974
[S6] ⇄ pheromone p=0.367 → S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44603
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S14
[S3] cosine check vs S14: cos=0.9974
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44616
[S9] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S15
[S16] cosine check vs S15: cos=0.8561
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] cosine check vs S9: cos=0.9995
[S9] ⇄ pheromone p=0.070 → S5@127.0.0.1:44605
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=40 metric=0.6390 head_norm=1.434316
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.324758e-02
[S5] stored merged vector for next round verification (round=40)
[S5] DEBUG after merge:  round=40 metric=0.6390 head_norm=1.441028 delta_norm=0.023248
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.242 → S9@127.0.0.1:44610
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=40 metric=0.9611 head_norm=1.436808
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.814227e-02
[S3] stored merged vector for next round verification (round=40)
[S3] DEBUG after merge:  round=40 metric=0.9611 head_norm=1.407279 delta_norm=0.058142
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.067 → S14@127.0.0.1:44614
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=40 metric=0.9400 head_norm=1.384338
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.021978e-02
[S4] stored merged vector for next round verification (round=40)
[S4] DEBUG after merge:  round=40 metric=0.9400 head_norm=1.410264 delta_norm=0.070220
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.060 → S6@127.0.0.1:44607
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=40 metric=0.9966 head_norm=1.379570
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.814227e-02
[S14] stored merged vector for next round verification (round=40)
[S14] DEBUG after merge:  round=40 metric=0.9966 head_norm=1.407279 delta_norm=0.058142
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.009 → S13@127.0.0.1:44613
[S16] RoundReady barrier timeout: have=2 need=4 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:44602
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S16
[S2] cosine check vs S16: cos=-0.0700
[S2] DROPPED delta from S16 (cos=-0.0700 < 0.0)
[S15] ⇄ pheromone p=0.279 → S16@127.0.0.1:44616
[S15]  timeout peer S14
[S15]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S11
[S16]  timeout peer S17
[S8]  timeout peer S15
[S14]  timeout peer S9
[S14]  timeout peer S13
[S5]  timeout peer S4
[S4]  timeout peer S8
[S9]  timeout peer S10
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=40 metric=0.9918 head_norm=1.357094
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.583207e-01
[S16] stored merged vector for next round verification (round=40)
[S16] DEBUG after merge:  round=40 metric=0.9918 head_norm=1.284443 delta_norm=0.358321
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.156 → S15@127.0.0.1:44615
[S2] START round=41 head_norm_before_train=2.007791 (no previous merge yet)
[S2] round=41 local utility u=0.117395 metrics={'f1_val': 0.8098429915243306, 'auprc': 0.8597372873742656, 'loss_val': 0.5043627245702944, 'psi': 0.8298007098643045}-{'f1_val': 0.825141925748551, 'auprc': 0.7410018798304014, 'loss_val': 0.4747401469450003, 'psi': 0.7914859073812912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=41 head_norm_before_train=1.407279 cos_to_last_merge=1.0000 (last merge round=40)
[S3] round=41 local utility u=0.147562 metrics={'f1_val': 0.9971302205031132, 'auprc': 0.9987911036374901, 'loss_val': 0.05555552146173669, 'psi': 0.997794573756864}-{'f1_val': 0.9610750853994537, 'auprc': 0.99879809008798, 'loss_val': 0.13436975062881806, 'psi': 0.9761642872748643}
[S4] START round=41 head_norm_before_train=1.410264 cos_to_last_merge=1.0000 (last merge round=40)
[S4] round=41 local utility u=0.004998 metrics={'f1_val': 0.9404827586519164, 'auprc': 0.9705449260262561, 'loss_val': 0.2725594059958535, 'psi': 0.9525076256016523}-{'f1_val': 0.9400271714209207, 'auprc': 0.9693329001105241, 'loss_val': 0.27618496278518057, 'psi': 0.9517494628967621}
[S5] START round=41 head_norm_before_train=1.441028 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=41 local utility u=0.326026 metrics={'f1_val': 0.7005797538498719, 'auprc': 0.9876900018717313, 'loss_val': 0.26986499284779336, 'psi': 0.8154238530586158}-{'f1_val': 0.6390090375023567, 'auprc': 0.9349559689939781, 'loss_val': 0.3942910995533736, 'psi': 0.7573878100990052}
[S6] START round=41 head_norm_before_train=1.439153 cos_to_last_merge=0.9995 (last merge round=39)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7546697907012547, 'auprc': 0.9393332382867121, 'loss_val': 0.6404434162306009, 'psi': 0.8285351697354377}-{'f1_val': 0.8370669573546696, 'auprc': 0.9553348375547995, 'loss_val': 0.3375519286078342, 'psi': 0.8843741094347216}
[S7] START round=41 head_norm_before_train=1.349026 cos_to_last_merge=0.9992 (last merge round=39)
[S7] round=41 local utility u=0.395747 metrics={'f1_val': 0.603793910827605, 'auprc': 0.7967802007293036, 'loss_val': 0.6266473839770049, 'psi': 0.6809884267882844}-{'f1_val': 0.5283488574345746, 'auprc': 0.7780387279405779, 'loss_val': 0.9092470841755739, 'psi': 0.6282248056369759}
[S8] START round=41 head_norm_before_train=1.318019 cos_to_last_merge=0.9781 (last merge round=32)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.713688922681958, 'auprc': 0.9859478209431252, 'loss_val': 0.24520821360342288, 'psi': 0.822592481986425}-{'f1_val': 0.992174240363445, 'auprc': 0.9987424450771681, 'loss_val': 0.06394274026459691, 'psi': 0.9948015222489343}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.448082 cos_to_last_merge=0.9997 (last merge round=39)
[S9] round=41 local utility u=0.005948 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.998239454679313, 'loss_val': 0.071139113915326, 'psi': 0.9973527479361342}-{'f1_val': 0.9967616101073482, 'auprc': 0.9982454513756442, 'loss_val': 0.08305340711521378, 'psi': 0.9973551466146666}
[S10] START round=41 head_norm_before_train=2.040634 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.996604429868556, 'loss_val': 0.027106812196761077, 'psi': 0.9957288034278405}-{'f1_val': 0.9951450524673635, 'auprc': 0.9966221003939288, 'loss_val': 0.02715973725748115, 'psi': 0.9957358716379896}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=2.163372 (no previous merge yet)
[S11] round=41 local utility u=0.000917 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9982772090708348, 'loss_val': 0.024378204974654098, 'psi': 0.9972414366253923}-{'f1_val': 0.9963100190352135, 'auprc': 0.9982390781826842, 'loss_val': 0.024652610343665674, 'psi': 0.9970816426942017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=41 head_norm_before_train=1.787498 (no previous merge yet)
[S13] round=41 local utility u=0.178209 metrics={'f1_val': 0.6016151301556998, 'auprc': 0.7308074099976204, 'loss_val': 0.7627769459293902, 'psi': 0.653292042092468}-{'f1_val': 0.5753571806293596, 'auprc': 0.7311823200903153, 'loss_val': 0.9627713370206774, 'psi': 0.6376872364137418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=41 head_norm_before_train=1.407279 cos_to_last_merge=1.0000 (last merge round=40)
[S14] round=41 local utility u=0.000183 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.997084552331644, 'loss_val': 0.059721918198045794, 'psi': 0.9967729548784335}-{'f1_val': 0.9966305087305161, 'auprc': 0.9988218946066263, 'loss_val': 0.06569094286041519, 'psi': 0.9975070630809602}
[S15] START round=41 head_norm_before_train=1.309454 cos_to_last_merge=0.9999 (last merge round=39)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.7008305005721126, 'auprc': 0.9109500298313599, 'loss_val': 0.4235894595104875, 'psi': 0.7848783122758116}-{'f1_val': 0.9967466683875206, 'auprc': 0.9913134937310607, 'loss_val': 0.08681081462194477, 'psi': 0.9945733985249366}
[S16] START round=41 head_norm_before_train=1.284443 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9402064812154758, 'auprc': 0.9887182738010079, 'loss_val': 0.24081295907979505, 'psi': 0.9596111982496887}-{'f1_val': 0.9917505555831294, 'auprc': 0.996369404571281, 'loss_val': 0.07350711386841358, 'psi': 0.99359809517839}
[S17] START round=41 head_norm_before_train=1.723763 cos_to_last_merge=0.8031 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.803
[S17] round=41 local utility u=0.113495 metrics={'f1_val': 0.635404291937622, 'auprc': 0.8428676380830353, 'loss_val': 0.7698780755915431, 'psi': 0.7183896303957873}-{'f1_val': 0.6185297056310436, 'auprc': 0.8276181187539347, 'loss_val': 0.8498722375464979, 'psi': 0.7021650708802001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:44605
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:44603
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S5] → sending delta(kind=head bytes=1810) to S9@127.0.0.1:44610
[S14] sending update (kind=head size=1794 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1810 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:44607
[S9] RECEIVED delta(kind=head bytes=1810) from S5
[S9] cosine check vs S5: cos=0.9991
[S3] RECEIVED delta(kind=head bytes=1794) from S14
[S3] cosine check vs S14: cos=0.9993
[S5] RECEIVED delta(kind=head bytes=1801) from S9
[S5] cosine check vs S9: cos=0.9991
[S4] sending update (kind=head size=1807 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=41 metric=0.9968 head_norm=1.476974
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.266812e-02
[S9] stored merged vector for next round verification (round=41)
[S9] DEBUG after merge:  round=41 metric=0.9968 head_norm=1.465733 delta_norm=0.032668
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=41 metric=0.7006 head_norm=1.455138
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.266810e-02
[S5] stored merged vector for next round verification (round=41)
[S5] DEBUG after merge:  round=41 metric=0.7006 head_norm=1.465733 delta_norm=0.032668
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1807) from S4
[S6] cosine check vs S4: cos=0.9970
[S2] START round=42 head_norm_before_train=2.016532 (no previous merge yet)
[S2] round=42 local utility u=0.004376 metrics={'f1_val': 0.7953822088677754, 'auprc': 0.8912849272731844, 'loss_val': 0.5034883865983433, 'psi': 0.833743296229939}-{'f1_val': 0.8098429915243306, 'auprc': 0.8597372873742656, 'loss_val': 0.5043627245702944, 'psi': 0.8298007098643045}
[S2] not sending this round → trigger blocked (psi=0.834)
[S3] START round=42 head_norm_before_train=1.461297 cos_to_last_merge=0.9995 (last merge round=40)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.8627548183927669, 'auprc': 0.9965884135801261, 'loss_val': 0.27054662434103893, 'psi': 0.9162882564677106}-{'f1_val': 0.9971302205031132, 'auprc': 0.9987911036374901, 'loss_val': 0.05555552146173669, 'psi': 0.997794573756864}
[S4] START round=42 head_norm_before_train=1.424227 cos_to_last_merge=0.9999 (last merge round=40)
[S4] round=42 local utility u=0.012241 metrics={'f1_val': 0.9443659183538858, 'auprc': 0.9686793603075795, 'loss_val': 0.2657790325262249, 'psi': 0.9540912951353633}-{'f1_val': 0.9404827586519164, 'auprc': 0.9705449260262561, 'loss_val': 0.2725594059958535, 'psi': 0.9525076256016523}
[S5] START round=42 head_norm_before_train=1.465733 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=42 local utility u=0.971944 metrics={'f1_val': 0.9964092673554392, 'auprc': 0.9941952593694648, 'loss_val': 0.12046901284659982, 'psi': 0.9955236641610494}-{'f1_val': 0.7005797538498719, 'auprc': 0.9876900018717313, 'loss_val': 0.26986499284779336, 'psi': 0.8154238530586158}
[S6] START round=42 head_norm_before_train=1.486793 cos_to_last_merge=0.9981 (last merge round=39)
[S6] round=42 local utility u=0.237595 metrics={'f1_val': 0.8124459112764255, 'auprc': 0.9439823252733902, 'loss_val': 0.5258565524488693, 'psi': 0.8650604768752115}-{'f1_val': 0.7546697907012547, 'auprc': 0.9393332382867121, 'loss_val': 0.6404434162306009, 'psi': 0.8285351697354377}
[S7] START round=42 head_norm_before_train=1.378932 cos_to_last_merge=0.9978 (last merge round=39)
[S7] round=42 local utility u=0.086052 metrics={'f1_val': 0.6208411137272143, 'auprc': 0.8018162168054351, 'loss_val': 0.5719345896480461, 'psi': 0.6932311549585026}-{'f1_val': 0.603793910827605, 'auprc': 0.7967802007293036, 'loss_val': 0.6266473839770049, 'psi': 0.6809884267882844}
[S8] START round=42 head_norm_before_train=1.337654 cos_to_last_merge=0.9762 (last merge round=32)
[S8] round=42 local utility u=0.942088 metrics={'f1_val': 0.9919528555747477, 'auprc': 0.9962113048369761, 'loss_val': 0.061406978804312236, 'psi': 0.993656235279639}-{'f1_val': 0.713688922681958, 'auprc': 0.9859478209431252, 'loss_val': 0.24520821360342288, 'psi': 0.822592481986425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=42 head_norm_before_train=1.465733 cos_to_last_merge=1.0000 (last merge round=41)
[S9] round=42 local utility u=0.002477 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9982345391959205, 'loss_val': 0.06616944594648468, 'psi': 0.9973507817427771}-{'f1_val': 0.9967616101073482, 'auprc': 0.998239454679313, 'loss_val': 0.071139113915326, 'psi': 0.9973527479361342}
[S10] START round=42 head_norm_before_train=2.050327 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9965130505990055, 'loss_val': 0.02706600144276663, 'psi': 0.9956922517200203}-{'f1_val': 0.9951450524673635, 'auprc': 0.996604429868556, 'loss_val': 0.027106812196761077, 'psi': 0.9957288034278405}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=2.165780 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9982598075145688, 'loss_val': 0.024009587538638105, 'psi': 0.9970893737760487}-{'f1_val': 0.9965509216617638, 'auprc': 0.9982772090708348, 'loss_val': 0.024378204974654098, 'psi': 0.9972414366253923}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.790104 (no previous merge yet)
[S13] round=42 local utility u=0.155374 metrics={'f1_val': 0.6374277911871704, 'auprc': 0.7349192586019483, 'loss_val': 0.6792407749980109, 'psi': 0.6764243781530815}-{'f1_val': 0.6016151301556998, 'auprc': 0.7308074099976204, 'loss_val': 0.7627769459293902, 'psi': 0.653292042092468}
[S13] not sending this round → trigger blocked (psi=0.676)
[S14] START round=42 head_norm_before_train=1.427738 cos_to_last_merge=0.9999 (last merge round=40)
[S14] round=42 local utility u=0.003282 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9962565605782076, 'loss_val': 0.05559969529906111, 'psi': 0.9969343812200319}-{'f1_val': 0.9965652232429598, 'auprc': 0.997084552331644, 'loss_val': 0.059721918198045794, 'psi': 0.9967729548784335}
[S15] START round=42 head_norm_before_train=1.323641 cos_to_last_merge=0.9997 (last merge round=39)
[S15] round=42 local utility u=0.855918 metrics={'f1_val': 0.9023679029891518, 'auprc': 0.9927888161451537, 'loss_val': 0.16649330745440688, 'psi': 0.9385362682515526}-{'f1_val': 0.7008305005721126, 'auprc': 0.9109500298313599, 'loss_val': 0.4235894595104875, 'psi': 0.7848783122758116}
[S16] START round=42 head_norm_before_train=1.323229 cos_to_last_merge=0.9995 (last merge round=40)
[S16] round=42 local utility u=0.244817 metrics={'f1_val': 0.991756566477358, 'auprc': 0.9943073558016952, 'loss_val': 0.07724593211723434, 'psi': 0.9927768822070928}-{'f1_val': 0.9402064812154758, 'auprc': 0.9887182738010079, 'loss_val': 0.24081295907979505, 'psi': 0.9596111982496887}
[S17] START round=42 head_norm_before_train=1.732923 cos_to_last_merge=0.8021 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.802
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6096512546397184, 'auprc': 0.8741185612140834, 'loss_val': 0.9764039314145029, 'psi': 0.7154381772694643}-{'f1_val': 0.635404291937622, 'auprc': 0.8428676380830353, 'loss_val': 0.7698780755915431, 'psi': 0.7183896303957873}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44609
[S5] not sending this round → trigger blocked (psi=0.996)
[S7] not sending this round → trigger blocked (psi=0.693)
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] → sending delta(kind=head bytes=1808) to S4@127.0.0.1:44604
[S4] not sending this round → trigger blocked (psi=0.954)
[S6] sending update (kind=head size=1808 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44615
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=42 metric=0.8628 head_norm=1.509139
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.132226e-02
[S3] stored merged vector for next round verification (round=42)
[S3] DEBUG after merge:  round=42 metric=0.8674 head_norm=1.467722 delta_norm=0.061322
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1808) from S6
[S4] cosine check vs S6: cos=0.9946
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] cosine check vs S15: cos=0.9969
[S16] sending update (kind=head size=1799 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=42 metric=0.8124 head_norm=1.524402
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.843531e-02
[S6] stored merged vector for next round verification (round=42)
[S6] DEBUG after merge:  round=42 metric=0.8117 head_norm=1.472512 delta_norm=0.088435
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] cosine check vs S16: cos=0.9495
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=42 metric=0.9444 head_norm=1.434052
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.906583e-02
[S4] stored merged vector for next round verification (round=42)
[S4] DEBUG after merge:  round=42 metric=0.9444 head_norm=1.477234 delta_norm=0.089066
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=2.026811 (no previous merge yet)
[S2] round=43 local utility u=0.091144 metrics={'f1_val': 0.8278678932084138, 'auprc': 0.8744311649935232, 'loss_val': 0.4655537636700981, 'psi': 0.8464932019224576}-{'f1_val': 0.7953822088677754, 'auprc': 0.8912849272731844, 'loss_val': 0.5034883865983433, 'psi': 0.833743296229939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=43 head_norm_before_train=1.467722 cos_to_last_merge=1.0000 (last merge round=42)
[S3] round=43 local utility u=0.469079 metrics={'f1_val': 0.985834033998681, 'auprc': 0.9986318817468722, 'loss_val': 0.07699496823760156, 'psi': 0.9909531730979575}-{'f1_val': 0.8627548183927669, 'auprc': 0.9965884135801261, 'loss_val': 0.27054662434103893, 'psi': 0.9162882564677106}
[S4] START round=43 head_norm_before_train=1.477234 cos_to_last_merge=1.0000 (last merge round=42)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9433403193205431, 'auprc': 0.958591389006868, 'loss_val': 0.2731553284151063, 'psi': 0.9494407471950731}-{'f1_val': 0.9443659183538858, 'auprc': 0.9686793603075795, 'loss_val': 0.2657790325262249, 'psi': 0.9540912951353633}
[S5] START round=43 head_norm_before_train=1.477358 cos_to_last_merge=0.9999 (last merge round=41)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.4279430124279051, 'auprc': 0.8363748787122463, 'loss_val': 1.0555972891373127, 'psi': 0.5913157589416416}-{'f1_val': 0.9964092673554392, 'auprc': 0.9941952593694648, 'loss_val': 0.12046901284659982, 'psi': 0.9955236641610494}
[S6] START round=43 head_norm_before_train=1.472512 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.8037422537743294, 'auprc': 0.9434686000661576, 'loss_val': 0.48388776614406265, 'psi': 0.8596327922910607}-{'f1_val': 0.8124459112764255, 'auprc': 0.9439823252733902, 'loss_val': 0.5258565524488693, 'psi': 0.8650604768752115}
[S7] START round=43 head_norm_before_train=1.408522 cos_to_last_merge=0.9959 (last merge round=39)
[S7] round=43 local utility u=0.005809 metrics={'f1_val': 0.6241662975260682, 'auprc': 0.800255380326546, 'loss_val': 0.5755851112662317, 'psi': 0.6946019306462594}-{'f1_val': 0.6208411137272143, 'auprc': 0.8018162168054351, 'loss_val': 0.5719345896480461, 'psi': 0.6932311549585026}
[S8] START round=43 head_norm_before_train=1.353359 cos_to_last_merge=0.9747 (last merge round=32)
[S8] round=43 local utility u=0.000431 metrics={'f1_val': 0.9916698259783234, 'auprc': 0.99592852044651, 'loss_val': 0.05799838228752091, 'psi': 0.9933733037655981}-{'f1_val': 0.9919528555747477, 'auprc': 0.9962113048369761, 'loss_val': 0.061406978804312236, 'psi': 0.993656235279639}
[S8] not sending this round → trigger blocked (psi=0.993)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=43 metric=0.9917 head_norm=1.365779
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.804270e-02
[S8] stored merged vector for next round verification (round=43)
[S8] DEBUG after merge:  round=43 metric=0.9917 head_norm=1.349515 delta_norm=0.058043
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] START round=43 head_norm_before_train=1.492120 cos_to_last_merge=0.9998 (last merge round=41)
[S9] round=43 local utility u=0.001650 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9969153853524642, 'loss_val': 0.05891283804837687, 'psi': 0.9968231202053947}-{'f1_val': 0.9967616101073482, 'auprc': 0.9982345391959205, 'loss_val': 0.06616944594648468, 'psi': 0.9973507817427771}
[S10] START round=43 head_norm_before_train=2.059817 (no previous merge yet)
[S10] round=43 local utility u=0.000178 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9965052589099626, 'loss_val': 0.02668614976071993, 'psi': 0.9956891350444032}-{'f1_val': 0.9951450524673635, 'auprc': 0.9965130505990055, 'loss_val': 0.02706600144276663, 'psi': 0.9956922517200203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=43 head_norm_before_train=2.171224 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9946271333047509, 'auprc': 0.9983386258909782, 'loss_val': 0.03171991085098713, 'psi': 0.9961117303392418}-{'f1_val': 0.9963090846170353, 'auprc': 0.9982598075145688, 'loss_val': 0.024009587538638105, 'psi': 0.9970893737760487}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.797971 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6104355298740685, 'auprc': 0.744497702201243, 'loss_val': 0.8788258740576067, 'psi': 0.6640603988049383}-{'f1_val': 0.6374277911871704, 'auprc': 0.7349192586019483, 'loss_val': 0.6792407749980109, 'psi': 0.6764243781530815}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.446257 cos_to_last_merge=0.9998 (last merge round=40)
[S14] round=43 local utility u=0.003863 metrics={'f1_val': 0.9967552940827689, 'auprc': 0.9988351290066114, 'loss_val': 0.05182294676830771, 'psi': 0.9975872280523059}-{'f1_val': 0.9973862616479148, 'auprc': 0.9962565605782076, 'loss_val': 0.05559969529906111, 'psi': 0.9969343812200319}
[S15] START round=43 head_norm_before_train=1.335577 cos_to_last_merge=0.9995 (last merge round=39)
[S15] round=43 local utility u=0.011664 metrics={'f1_val': 0.9042370681806984, 'auprc': 0.9930354161297545, 'loss_val': 0.1551207335613555, 'psi': 0.9397564073603208}-{'f1_val': 0.9023679029891518, 'auprc': 0.9927888161451537, 'loss_val': 0.16649330745440688, 'psi': 0.9385362682515526}
[S16] START round=43 head_norm_before_train=1.365187 cos_to_last_merge=0.9979 (last merge round=40)
[S16] round=43 local utility u=0.010851 metrics={'f1_val': 0.9924075982136004, 'auprc': 0.9964729362020437, 'loss_val': 0.06594654782432001, 'psi': 0.9940337334089777}-{'f1_val': 0.991756566477358, 'auprc': 0.9943073558016952, 'loss_val': 0.07724593211723434, 'psi': 0.9927768822070928}
[S17] START round=43 head_norm_before_train=1.744449 cos_to_last_merge=0.8012 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=43 local utility u=0.022438 metrics={'f1_val': 0.611798130533651, 'auprc': 0.9011578324194603, 'loss_val': 1.0255268343473087, 'psi': 0.7275420112879747}-{'f1_val': 0.6096512546397184, 'auprc': 0.8741185612140834, 'loss_val': 0.9764039314145029, 'psi': 0.7154381772694643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:44603
[S15] not sending this round → trigger blocked (psi=0.940)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S9] → sending delta(kind=head bytes=1808) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1808 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=43 metric=0.9042 head_norm=1.347075
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.158105e-01
[S15] stored merged vector for next round verification (round=43)
[S15] DEBUG after merge:  round=43 metric=0.9076 head_norm=1.338880 delta_norm=0.215810
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → trigger blocked (psi=0.994)
[S5] RECEIVED delta(kind=head bytes=1808) from S9
[S5] cosine check vs S9: cos=0.9992
[S3] RECEIVED delta(kind=head bytes=1794) from S14
[S3] cosine check vs S14: cos=0.9980
[S2] START round=44 head_norm_before_train=2.038369 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.8302186304870962, 'auprc': 0.8570656122624993, 'loss_val': 0.45240824775475236, 'psi': 0.8409574231972574}-{'f1_val': 0.8278678932084138, 'auprc': 0.8744311649935232, 'loss_val': 0.4655537636700981, 'psi': 0.8464932019224576}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.510165 cos_to_last_merge=0.9998 (last merge round=42)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9704073503344026, 'auprc': 0.9982957653831548, 'loss_val': 0.08834144678933208, 'psi': 0.9815627163539035}-{'f1_val': 0.985834033998681, 'auprc': 0.9986318817468722, 'loss_val': 0.07699496823760156, 'psi': 0.9909531730979575}
[S4] START round=44 head_norm_before_train=1.488226 cos_to_last_merge=1.0000 (last merge round=42)
[S4] round=44 local utility u=0.027644 metrics={'f1_val': 0.9484310280821423, 'auprc': 0.963766749777331, 'loss_val': 0.2639369059149887, 'psi': 0.9545653167602178}-{'f1_val': 0.9433403193205431, 'auprc': 0.958591389006868, 'loss_val': 0.2731553284151063, 'psi': 0.9494407471950731}
[S5] START round=44 head_norm_before_train=1.486160 cos_to_last_merge=0.9998 (last merge round=41)
[S5] round=44 local utility u=1.000000 metrics={'f1_val': 0.8787670843880921, 'auprc': 0.9886749152364761, 'loss_val': 0.18287916940268176, 'psi': 0.9227302167274458}-{'f1_val': 0.4279430124279051, 'auprc': 0.8363748787122463, 'loss_val': 1.0555972891373127, 'psi': 0.5913157589416416}
[S6] START round=44 head_norm_before_train=1.504297 cos_to_last_merge=0.9998 (last merge round=42)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.7165994111628697, 'auprc': 0.915911532183649, 'loss_val': 0.6550638148269701, 'psi': 0.7963242595711815}-{'f1_val': 0.8037422537743294, 'auprc': 0.9434686000661576, 'loss_val': 0.48388776614406265, 'psi': 0.8596327922910607}
[S7] START round=44 head_norm_before_train=1.432801 cos_to_last_merge=0.9942 (last merge round=39)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6210202897888908, 'auprc': 0.7975043809245721, 'loss_val': 0.599411097013248, 'psi': 0.6916139262431633}-{'f1_val': 0.6241662975260682, 'auprc': 0.800255380326546, 'loss_val': 0.5755851112662317, 'psi': 0.6946019306462594}
[S8] START round=44 head_norm_before_train=1.349515 cos_to_last_merge=1.0000 (last merge round=43)
[S8] round=44 local utility u=0.006232 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9990702764259052, 'loss_val': 0.0579281893438725, 'psi': 0.9949268802433934}-{'f1_val': 0.9916698259783234, 'auprc': 0.99592852044651, 'loss_val': 0.05799838228752091, 'psi': 0.9933733037655981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=44 head_norm_before_train=1.517028 cos_to_last_merge=0.9994 (last merge round=41)
[S9] round=44 local utility u=0.005534 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9983142906927484, 'loss_val': 0.05450629960744776, 'psi': 0.997629223086343}-{'f1_val': 0.9967616101073482, 'auprc': 0.9969153853524642, 'loss_val': 0.05891283804837687, 'psi': 0.9968231202053947}
[S10] START round=44 head_norm_before_train=2.069105 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9962478172767162, 'loss_val': 0.02680389238660021, 'psi': 0.9955861583911045}-{'f1_val': 0.9951450524673635, 'auprc': 0.9965052589099626, 'loss_val': 0.02668614976071993, 'psi': 0.9956891350444032}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.176003 (no previous merge yet)
[S11] round=44 local utility u=0.009174 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9982086593059699, 'loss_val': 0.023073280002980555, 'psi': 0.9970689144926091}-{'f1_val': 0.9946271333047509, 'auprc': 0.9983386258909782, 'loss_val': 0.03171991085098713, 'psi': 0.9961117303392418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=44 head_norm_before_train=1.804160 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6131661341048544, 'auprc': 0.7449281288173222, 'loss_val': 0.9397059600496499, 'psi': 0.6658709319898415}-{'f1_val': 0.6104355298740685, 'auprc': 0.744497702201243, 'loss_val': 0.8788258740576067, 'psi': 0.6640603988049383}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.462827 cos_to_last_merge=0.9996 (last merge round=40)
[S14] round=44 local utility u=0.002084 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9987707664827445, 'loss_val': 0.04878291226406531, 'psi': 0.9976936066433637}-{'f1_val': 0.9967552940827689, 'auprc': 0.9988351290066114, 'loss_val': 0.05182294676830771, 'psi': 0.9975872280523059}
[S15] START round=44 head_norm_before_train=1.338880 cos_to_last_merge=1.0000 (last merge round=43)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.891022395166159, 'auprc': 0.9901647604404802, 'loss_val': 0.22757094559827631, 'psi': 0.9306793412758874}-{'f1_val': 0.9042370681806984, 'auprc': 0.9930354161297545, 'loss_val': 0.1551207335613555, 'psi': 0.9397564073603208}
[S16] START round=44 head_norm_before_train=1.405069 cos_to_last_merge=0.9957 (last merge round=40)
[S16] round=44 local utility u=0.004154 metrics={'f1_val': 0.9923873926502049, 'auprc': 0.9969584149424471, 'loss_val': 0.05897276988770001, 'psi': 0.9942158015671018}-{'f1_val': 0.9924075982136004, 'auprc': 0.9964729362020437, 'loss_val': 0.06594654782432001, 'psi': 0.9940337334089777}
[S17] START round=44 head_norm_before_train=1.756561 cos_to_last_merge=0.7995 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.800
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6156479125696571, 'auprc': 0.8252588701598259, 'loss_val': 1.021639679124151, 'psi': 0.6994922956057246}-{'f1_val': 0.611798130533651, 'auprc': 0.9011578324194603, 'loss_val': 1.0255268343473087, 'psi': 0.7275420112879747}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44610
[S14] not sending this round → trigger blocked (psi=0.998)
[S9] not sending this round → trigger blocked (psi=0.998)
[S5] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44615
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=44 metric=0.9704 head_norm=1.547491
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.340928e-02
[S3] stored merged vector for next round verification (round=44)
[S3] DEBUG after merge:  round=44 metric=0.9704 head_norm=1.503964 delta_norm=0.073409
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S4] → sending delta(kind=head bytes=1810) to S6@127.0.0.1:44607
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.9986
[S4] sending update (kind=head size=1810 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=44 metric=0.8788 head_norm=1.490450
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.418311e-02
[S5] stored merged vector for next round verification (round=44)
[S5] DEBUG after merge:  round=44 metric=0.8763 head_norm=1.503409 delta_norm=0.034183
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] cosine check vs S16: cos=0.9804
[S6] RECEIVED delta(kind=head bytes=1810) from S4
[S6] cosine check vs S4: cos=0.9988
[S2] START round=45 head_norm_before_train=2.048944 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.8270827581545427, 'auprc': 0.8691621623381773, 'loss_val': 0.5108497492088041, 'psi': 0.8439145198279965}-{'f1_val': 0.8302186304870962, 'auprc': 0.8570656122624993, 'loss_val': 0.45240824775475236, 'psi': 0.8409574231972574}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.503964 cos_to_last_merge=1.0000 (last merge round=44)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9985604530740732, 'loss_val': 0.15972232735514494, 'psi': 0.9759219466123674}-{'f1_val': 0.9704073503344026, 'auprc': 0.9982957653831548, 'loss_val': 0.08834144678933208, 'psi': 0.9815627163539035}
[S4] START round=45 head_norm_before_train=1.498422 cos_to_last_merge=0.9999 (last merge round=42)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9395291029668451, 'auprc': 0.9580543039799748, 'loss_val': 0.2857598365612322, 'psi': 0.946939183372097}-{'f1_val': 0.9484310280821423, 'auprc': 0.963766749777331, 'loss_val': 0.2639369059149887, 'psi': 0.9545653167602178}
[S5] START round=45 head_norm_before_train=1.503409 cos_to_last_merge=1.0000 (last merge round=44)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.7007823660498416, 'auprc': 0.9880965001315768, 'loss_val': 0.3226197237346615, 'psi': 0.8157080196825357}-{'f1_val': 0.8787670843880921, 'auprc': 0.9886749152364761, 'loss_val': 0.18287916940268176, 'psi': 0.9227302167274458}
[S6] START round=45 head_norm_before_train=1.529590 cos_to_last_merge=0.9993 (last merge round=42)
[S6] round=45 local utility u=0.033321 metrics={'f1_val': 0.7258636595022765, 'auprc': 0.9123052385686298, 'loss_val': 0.6331882174776248, 'psi': 0.8004402911288178}-{'f1_val': 0.7165994111628697, 'auprc': 0.915911532183649, 'loss_val': 0.6550638148269701, 'psi': 0.7963242595711815}
[S7] START round=45 head_norm_before_train=1.451667 cos_to_last_merge=0.9927 (last merge round=39)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5492431851115201, 'auprc': 0.7807942403524086, 'loss_val': 0.85226076584735, 'psi': 0.6418636072078756}-{'f1_val': 0.6210202897888908, 'auprc': 0.7975043809245721, 'loss_val': 0.599411097013248, 'psi': 0.6916139262431633}
[S8] START round=45 head_norm_before_train=1.361809 cos_to_last_merge=1.0000 (last merge round=43)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.944063278416619, 'auprc': 0.9890833104579171, 'loss_val': 0.11655568650811804, 'psi': 0.9620712912331383}-{'f1_val': 0.9921646161217188, 'auprc': 0.9990702764259052, 'loss_val': 0.0579281893438725, 'psi': 0.9949268802433934}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.539207 cos_to_last_merge=0.9989 (last merge round=41)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9945877554377853, 'loss_val': 0.04958389419666127, 'psi': 0.9958920682395231}-{'f1_val': 0.9971725113487396, 'auprc': 0.9983142906927484, 'loss_val': 0.05450629960744776, 'psi': 0.997629223086343}
[S10] START round=45 head_norm_before_train=2.076817 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9961103362630891, 'loss_val': 0.026779013940865654, 'psi': 0.9955311659856537}-{'f1_val': 0.9951450524673635, 'auprc': 0.9962478172767162, 'loss_val': 0.02680389238660021, 'psi': 0.9955861583911045}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.181977 (no previous merge yet)
[S11] round=45 local utility u=0.001933 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9983229288783846, 'loss_val': 0.021000286629941967, 'psi': 0.9972597245484122}-{'f1_val': 0.9963090846170353, 'auprc': 0.9982086593059699, 'loss_val': 0.023073280002980555, 'psi': 0.9970689144926091}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=45 head_norm_before_train=1.810701 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6029797809285187, 'auprc': 0.7520018331041858, 'loss_val': 1.0353775858313043, 'psi': 0.6625886017987855}-{'f1_val': 0.6131661341048544, 'auprc': 0.7449281288173222, 'loss_val': 0.9397059600496499, 'psi': 0.6658709319898415}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.480152 cos_to_last_merge=0.9993 (last merge round=40)
[S14] round=45 local utility u=0.001098 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9984697121734228, 'loss_val': 0.04568352694166007, 'psi': 0.997573184919635}-{'f1_val': 0.9969755000837764, 'auprc': 0.9987707664827445, 'loss_val': 0.04878291226406531, 'psi': 0.9976936066433637}
[S15] START round=45 head_norm_before_train=1.352826 cos_to_last_merge=1.0000 (last merge round=43)
[S15] round=45 local utility u=0.268895 metrics={'f1_val': 0.9589618460032607, 'auprc': 0.9928342247309505, 'loss_val': 0.1054269996659774, 'psi': 0.9725107974943366}-{'f1_val': 0.891022395166159, 'auprc': 0.9901647604404802, 'loss_val': 0.22757094559827631, 'psi': 0.9306793412758874}
[S16] START round=45 head_norm_before_train=1.440280 cos_to_last_merge=0.9935 (last merge round=40)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.936896188084185, 'auprc': 0.9886497067113632, 'loss_val': 0.28271917383291817, 'psi': 0.9575975955350562}-{'f1_val': 0.9923873926502049, 'auprc': 0.9969584149424471, 'loss_val': 0.05897276988770001, 'psi': 0.9942158015671018}
[S17] START round=45 head_norm_before_train=1.767334 cos_to_last_merge=0.7980 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.798
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.5892776249494422, 'auprc': 0.807326558242344, 'loss_val': 0.9693190595379402, 'psi': 0.6764971982666029}-{'f1_val': 0.6156479125696571, 'auprc': 0.8252588701598259, 'loss_val': 1.021639679124151, 'psi': 0.6994922956057246}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:44603
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=45 metric=0.9968 head_norm=1.557483
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.885683e-02
[S9] stored merged vector for next round verification (round=45)
[S9] DEBUG after merge:  round=45 metric=0.9968 head_norm=1.523198 delta_norm=0.058857
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.025 → S5@127.0.0.1:44605
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S5] ⇄ pheromone p=0.366 → S9@127.0.0.1:44610
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1805) from S6
[S4] cosine check vs S6: cos=0.9977
[S3] RECEIVED delta(kind=head bytes=1804) from S14
[S3] cosine check vs S14: cos=0.9979
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] cosine check vs S15: cos=0.9848
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=45 metric=0.9590 head_norm=1.369434
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.458545e-01
[S15] stored merged vector for next round verification (round=45)
[S15] DEBUG after merge:  round=45 metric=0.9681 head_norm=1.397714 delta_norm=0.145854
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.234 → S8@127.0.0.1:44609
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=45 metric=0.7259 head_norm=1.550560
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.536580e-02
[S6] stored merged vector for next round verification (round=45)
[S6] DEBUG after merge:  round=45 metric=0.7393 head_norm=1.523708 delta_norm=0.055366
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.151 → S4@127.0.0.1:44604
[S14] ⇄ pheromone p=0.004 → S3@127.0.0.1:44603
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=45 metric=0.9395 head_norm=1.508281
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.595695e-02
[S4] stored merged vector for next round verification (round=45)
[S4] DEBUG after merge:  round=45 metric=0.9395 head_norm=1.528543 delta_norm=0.055957
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.026 → S6@127.0.0.1:44607
[S16] ⇄ pheromone p=0.078 → S15@127.0.0.1:44615
[S2] START round=46 head_norm_before_train=2.058175 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6228544907029431, 'auprc': 0.6787983851669714, 'loss_val': 1.6390888921824527, 'psi': 0.6452320484885544}-{'f1_val': 0.8270827581545427, 'auprc': 0.8691621623381773, 'loss_val': 0.5108497492088041, 'psi': 0.8439145198279965}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.533331 cos_to_last_merge=0.9999 (last merge round=44)
[S3] round=46 local utility u=0.005173 metrics={'f1_val': 0.9602580484078469, 'auprc': 0.9983971524599353, 'loss_val': 0.14545786855421106, 'psi': 0.9755136900286823}-{'f1_val': 0.9608296089712303, 'auprc': 0.9985604530740732, 'loss_val': 0.15972232735514494, 'psi': 0.9759219466123674}
[S4] START round=46 head_norm_before_train=1.528543 cos_to_last_merge=1.0000 (last merge round=45)
[S4] round=46 local utility u=0.000500 metrics={'f1_val': 0.9399651529761355, 'auprc': 0.9575577520022075, 'loss_val': 0.2858856368471527, 'psi': 0.9470021925865644}-{'f1_val': 0.9395291029668451, 'auprc': 0.9580543039799748, 'loss_val': 0.2857598365612322, 'psi': 0.946939183372097}
[S5] START round=46 head_norm_before_train=1.507236 cos_to_last_merge=1.0000 (last merge round=44)
[S5] round=46 local utility u=0.993312 metrics={'f1_val': 0.9963644980511829, 'auprc': 0.9914184429438592, 'loss_val': 0.11945431911955812, 'psi': 0.9943860760082535}-{'f1_val': 0.7007823660498416, 'auprc': 0.9880965001315768, 'loss_val': 0.3226197237346615, 'psi': 0.8157080196825357}
[S6] START round=46 head_norm_before_train=1.523708 cos_to_last_merge=1.0000 (last merge round=45)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6285261448112848, 'auprc': 0.80901699257418, 'loss_val': 0.8002359652978439, 'psi': 0.7007224839164429}-{'f1_val': 0.7258636595022765, 'auprc': 0.9123052385686298, 'loss_val': 0.6331882174776248, 'psi': 0.8004402911288178}
[S7] START round=46 head_norm_before_train=1.466660 cos_to_last_merge=0.9915 (last merge round=39)
[S7] round=46 local utility u=0.252126 metrics={'f1_val': 0.5983967706970941, 'auprc': 0.7906746619744658, 'loss_val': 0.6725710976121475, 'psi': 0.6753079272080428}-{'f1_val': 0.5492431851115201, 'auprc': 0.7807942403524086, 'loss_val': 0.85226076584735, 'psi': 0.6418636072078756}
[S8] START round=46 head_norm_before_train=1.377492 cos_to_last_merge=0.9999 (last merge round=43)
[S8] round=46 local utility u=0.152956 metrics={'f1_val': 0.9826996219641752, 'auprc': 0.9990109354717951, 'loss_val': 0.07224467933784948, 'psi': 0.9892241473672232}-{'f1_val': 0.944063278416619, 'auprc': 0.9890833104579171, 'loss_val': 0.11655568650811804, 'psi': 0.9620712912331383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=46 metric=0.9827 head_norm=1.391978
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.229360e-01
[S8] stored merged vector for next round verification (round=46)
[S8] DEBUG after merge:  round=46 metric=0.9827 head_norm=1.375268 delta_norm=0.122936
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] START round=46 head_norm_before_train=1.523198 cos_to_last_merge=1.0000 (last merge round=45)
[S9] round=46 local utility u=0.004453 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.998334526703996, 'loss_val': 0.0519188256123384, 'psi': 0.9973907767460074}-{'f1_val': 0.9967616101073482, 'auprc': 0.9945877554377853, 'loss_val': 0.04958389419666127, 'psi': 0.9958920682395231}
[S10] START round=46 head_norm_before_train=2.079999 (no previous merge yet)
[S10] round=46 local utility u=0.000169 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9961280537691772, 'loss_val': 0.02649322595387402, 'psi': 0.995538252988089}-{'f1_val': 0.9951450524673635, 'auprc': 0.9961103362630891, 'loss_val': 0.026779013940865654, 'psi': 0.9955311659856537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=46 head_norm_before_train=2.186989 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9478727326062797, 'auprc': 0.9973100432518105, 'loss_val': 0.29696049175128764, 'psi': 0.9676476568644921}-{'f1_val': 0.9965509216617638, 'auprc': 0.9983229288783846, 'loss_val': 0.021000286629941967, 'psi': 0.9972597245484122}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.817715 (no previous merge yet)
[S13] round=46 local utility u=0.392994 metrics={'f1_val': 0.6640880384851842, 'auprc': 0.7594415937720923, 'loss_val': 0.6383576361853078, 'psi': 0.7022294605999474}-{'f1_val': 0.6029797809285187, 'auprc': 0.7520018331041858, 'loss_val': 1.0353775858313043, 'psi': 0.6625886017987855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=46 head_norm_before_train=1.497195 cos_to_last_merge=0.9990 (last merge round=40)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9959352234707468, 'auprc': 0.9987684822490981, 'loss_val': 0.04618280139750883, 'psi': 0.9970685269820874}-{'f1_val': 0.9969755000837764, 'auprc': 0.9984697121734228, 'loss_val': 0.04568352694166007, 'psi': 0.997573184919635}
[S15] START round=46 head_norm_before_train=1.397714 cos_to_last_merge=1.0000 (last merge round=45)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7632616785743054, 'auprc': 0.9872064166047715, 'loss_val': 0.314747264038264, 'psi': 0.8528395737864918}-{'f1_val': 0.9589618460032607, 'auprc': 0.9928342247309505, 'loss_val': 0.1054269996659774, 'psi': 0.9725107974943366}
[S16] START round=46 head_norm_before_train=1.470511 cos_to_last_merge=0.9915 (last merge round=40)
[S16] round=46 local utility u=0.282207 metrics={'f1_val': 0.9908809986494522, 'auprc': 0.9933497673787998, 'loss_val': 0.056313693484705954, 'psi': 0.9918685061411912}-{'f1_val': 0.936896188084185, 'auprc': 0.9886497067113632, 'loss_val': 0.28271917383291817, 'psi': 0.9575975955350562}
[S17] START round=46 head_norm_before_train=1.777637 cos_to_last_merge=0.7968 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.797
[S17] round=46 local utility u=0.381395 metrics={'f1_val': 0.6642488840479767, 'auprc': 0.8920676130916406, 'loss_val': 0.9105801480285495, 'psi': 0.7553763756654422}-{'f1_val': 0.5892776249494422, 'auprc': 0.807326558242344, 'loss_val': 0.9693190595379402, 'psi': 0.6764971982666029}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S9] → sending delta(kind=head bytes=1811) to S5@127.0.0.1:44605
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:44610
[S5] sending update (kind=head size=1807 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:44607
[S9] sending update (kind=head size=1811 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44615
[S9] RECEIVED delta(kind=head bytes=1807) from S5
[S9] cosine check vs S5: cos=0.9996
[S5] RECEIVED delta(kind=head bytes=1811) from S9
[S5] cosine check vs S9: cos=0.9996
[S14] RECEIVED delta(kind=head bytes=1803) from S3
[S14] cosine check vs S3: cos=0.9968
[S16] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=46 metric=0.9603 head_norm=1.562620
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.718135e-02
[S3] stored merged vector for next round verification (round=46)
[S3] DEBUG after merge:  round=46 metric=0.9605 head_norm=1.528781 delta_norm=0.067181
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=46 metric=0.9968 head_norm=1.541277
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.524067e-02
[S9] stored merged vector for next round verification (round=46)
[S9] DEBUG after merge:  round=46 metric=0.9968 head_norm=1.526171 delta_norm=0.025241
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=46 metric=0.9964 head_norm=1.511335
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.524069e-02
[S5] stored merged vector for next round verification (round=46)
[S5] DEBUG after merge:  round=46 metric=0.9964 head_norm=1.526171 delta_norm=0.025241
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1800) from S16
[S15] cosine check vs S16: cos=0.9917
[S6] RECEIVED delta(kind=head bytes=1804) from S4
[S6] cosine check vs S4: cos=0.9997
[S2] START round=47 head_norm_before_train=2.062654 (no previous merge yet)
[S2] round=47 local utility u=1.000000 metrics={'f1_val': 0.8158386222528821, 'auprc': 0.8658217418415131, 'loss_val': 0.5265946199734772, 'psi': 0.8358318700883345}-{'f1_val': 0.6228544907029431, 'auprc': 0.6787983851669714, 'loss_val': 1.6390888921824527, 'psi': 0.6452320484885544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=47 head_norm_before_train=1.528781 cos_to_last_merge=1.0000 (last merge round=46)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9550851541749742, 'auprc': 0.9990074609160546, 'loss_val': 0.127308163537383, 'psi': 0.9726540768714065}-{'f1_val': 0.9602580484078469, 'auprc': 0.9983971524599353, 'loss_val': 0.14545786855421106, 'psi': 0.9755136900286823}
[S4] START round=47 head_norm_before_train=1.537576 cos_to_last_merge=1.0000 (last merge round=45)
[S4] round=47 local utility u=0.040902 metrics={'f1_val': 0.9508560027032116, 'auprc': 0.9553516096413749, 'loss_val': 0.2628085830760142, 'psi': 0.9526542454784769}-{'f1_val': 0.9399651529761355, 'auprc': 0.9575577520022075, 'loss_val': 0.2858856368471527, 'psi': 0.9470021925865644}
[S5] START round=47 head_norm_before_train=1.526171 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.42869672829513505, 'auprc': 0.8244149454458666, 'loss_val': 0.8350938416508019, 'psi': 0.5869840151554276}-{'f1_val': 0.9963644980511829, 'auprc': 0.9914184429438592, 'loss_val': 0.11945431911955812, 'psi': 0.9943860760082535}
[S6] START round=47 head_norm_before_train=1.547787 cos_to_last_merge=0.9998 (last merge round=45)
[S6] round=47 local utility u=1.000000 metrics={'f1_val': 0.9038046668355414, 'auprc': 0.9552881885202729, 'loss_val': 0.22080605598900266, 'psi': 0.924398075509434}-{'f1_val': 0.6285261448112848, 'auprc': 0.80901699257418, 'loss_val': 0.8002359652978439, 'psi': 0.7007224839164429}
[S7] START round=47 head_norm_before_train=1.483345 cos_to_last_merge=0.9902 (last merge round=39)
[S7] round=47 local utility u=0.190886 metrics={'f1_val': 0.6281148805078017, 'auprc': 0.802538615438009, 'loss_val': 0.5046992287270052, 'psi': 0.6978843744798846}-{'f1_val': 0.5983967706970941, 'auprc': 0.7906746619744658, 'loss_val': 0.6725710976121475, 'psi': 0.6753079272080428}
[S8] START round=47 head_norm_before_train=1.375268 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=47 local utility u=0.009260 metrics={'f1_val': 0.9913939174441393, 'auprc': 0.9900595374738606, 'loss_val': 0.07903609762920948, 'psi': 0.9908601654560278}-{'f1_val': 0.9826996219641752, 'auprc': 0.9990109354717951, 'loss_val': 0.07224467933784948, 'psi': 0.9892241473672232}
[S8] not sending this round → trigger blocked (psi=0.991)
[S9] START round=47 head_norm_before_train=1.526171 cos_to_last_merge=1.0000 (last merge round=46)
[S9] round=47 local utility u=0.000737 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9985159210842779, 'loss_val': 0.05098819919892522, 'psi': 0.9974633344981201}-{'f1_val': 0.9967616101073482, 'auprc': 0.998334526703996, 'loss_val': 0.0519188256123384, 'psi': 0.9973907767460074}
[S10] START round=47 head_norm_before_train=2.085468 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9958483801175386, 'loss_val': 0.026806004535670672, 'psi': 0.9954263835274335}-{'f1_val': 0.9951450524673635, 'auprc': 0.9961280537691772, 'loss_val': 0.02649322595387402, 'psi': 0.995538252988089}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.191791 (no previous merge yet)
[S11] round=47 local utility u=0.284005 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9981670525411213, 'loss_val': 0.022140284894333645, 'psi': 0.9970522717866697}-{'f1_val': 0.9478727326062797, 'auprc': 0.9973100432518105, 'loss_val': 0.29696049175128764, 'psi': 0.9676476568644921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=47 head_norm_before_train=1.823045 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.609523114813008, 'auprc': 0.6948846955156043, 'loss_val': 1.0757022898974404, 'psi': 0.6436677470940466}-{'f1_val': 0.6640880384851842, 'auprc': 0.7594415937720923, 'loss_val': 0.6383576361853078, 'psi': 0.7022294605999474}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.511993 cos_to_last_merge=0.9986 (last merge round=40)
[S14] round=47 local utility u=0.003796 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9984673238257099, 'loss_val': 0.04146747739269374, 'psi': 0.9973260634760599}-{'f1_val': 0.9959352234707468, 'auprc': 0.9987684822490981, 'loss_val': 0.04618280139750883, 'psi': 0.9970685269820874}
[S15] START round=47 head_norm_before_train=1.416222 cos_to_last_merge=0.9999 (last merge round=45)
[S15] round=47 local utility u=0.843027 metrics={'f1_val': 0.9969902329512002, 'auprc': 0.9967078020964121, 'loss_val': 0.059569163999636736, 'psi': 0.9968772606092849}-{'f1_val': 0.7632616785743054, 'auprc': 0.9872064166047715, 'loss_val': 0.314747264038264, 'psi': 0.8528395737864918}
[S16] START round=47 head_norm_before_train=1.496808 cos_to_last_merge=0.9897 (last merge round=40)
[S16] round=47 local utility u=0.014520 metrics={'f1_val': 0.9923381412886771, 'auprc': 0.9972990849473745, 'loss_val': 0.04786353381948759, 'psi': 0.994322518752156}-{'f1_val': 0.9908809986494522, 'auprc': 0.9933497673787998, 'loss_val': 0.056313693484705954, 'psi': 0.9918685061411912}
[S17] START round=47 head_norm_before_train=1.788753 cos_to_last_merge=0.7952 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.795
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6365744308317447, 'auprc': 0.9370926453714645, 'loss_val': 0.8912146703305359, 'psi': 0.7567817166476326}-{'f1_val': 0.6642488840479767, 'auprc': 0.8920676130916406, 'loss_val': 0.9105801480285495, 'psi': 0.7553763756654422}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44603
[S9] not sending this round → trigger blocked (psi=0.997)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44609
[S7] not sending this round → trigger blocked (psi=0.698)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → trigger blocked (psi=0.953)
[S16] not sending this round → trigger blocked (psi=0.994)
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] cosine check vs S6: cos=0.9991
[S3] RECEIVED delta(kind=head bytes=1799) from S14
[S3] cosine check vs S14: cos=0.9983
[S8] RECEIVED delta(kind=head bytes=1795) from S15
[S8] cosine check vs S15: cos=0.9831
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=47 metric=0.9038 head_norm=1.571793
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.423738e-02
[S6] stored merged vector for next round verification (round=47)
[S6] DEBUG after merge:  round=47 metric=0.9281 head_norm=1.554402 delta_norm=0.034237
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=47 metric=0.9970 head_norm=1.434870
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.034265e-01
[S15] stored merged vector for next round verification (round=47)
[S15] DEBUG after merge:  round=47 metric=0.9970 head_norm=1.462514 delta_norm=0.103426
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=47 metric=0.9966 head_norm=1.526421
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.743399e-02
[S14] stored merged vector for next round verification (round=47)
[S14] DEBUG after merge:  round=47 metric=0.9966 head_norm=1.543154 delta_norm=0.067434
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=47 metric=0.9509 head_norm=1.544247
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.630883e-02
[S4] stored merged vector for next round verification (round=47)
[S4] DEBUG after merge:  round=47 metric=0.9509 head_norm=1.557658 delta_norm=0.036309
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=2.070291 (no previous merge yet)
[S2] round=48 local utility u=0.077015 metrics={'f1_val': 0.8270916486870554, 'auprc': 0.8885118298432271, 'loss_val': 0.5081528951524135, 'psi': 0.851659721149524}-{'f1_val': 0.8158386222528821, 'auprc': 0.8658217418415131, 'loss_val': 0.5265946199734772, 'psi': 0.8358318700883345}
[S2] not sending this round → trigger blocked (psi=0.852)
[S3] START round=48 head_norm_before_train=1.556915 cos_to_last_merge=0.9999 (last merge round=46)
[S3] round=48 local utility u=0.110790 metrics={'f1_val': 0.9821381472866884, 'auprc': 0.9988574321493139, 'loss_val': 0.06759698984952497, 'psi': 0.9888258612317387}-{'f1_val': 0.9550851541749742, 'auprc': 0.9990074609160546, 'loss_val': 0.127308163537383, 'psi': 0.9726540768714065}
[S4] START round=48 head_norm_before_train=1.557658 cos_to_last_merge=1.0000 (last merge round=47)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9407918735427372, 'auprc': 0.9610161734466481, 'loss_val': 0.285488267988748, 'psi': 0.9488815935043016}-{'f1_val': 0.9508560027032116, 'auprc': 0.9553516096413749, 'loss_val': 0.2628085830760142, 'psi': 0.9526542454784769}
[S5] START round=48 head_norm_before_train=1.530258 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=48 local utility u=1.000000 metrics={'f1_val': 0.9876305103029603, 'auprc': 0.9899195629177142, 'loss_val': 0.1316682512007604, 'psi': 0.9885461313488619}-{'f1_val': 0.42869672829513505, 'auprc': 0.8244149454458666, 'loss_val': 0.8350938416508019, 'psi': 0.5869840151554276}
[S6] START round=48 head_norm_before_train=1.554402 cos_to_last_merge=1.0000 (last merge round=47)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.7690323462902036, 'auprc': 0.8871986912855033, 'loss_val': 0.6130652259571441, 'psi': 0.8162988842883234}-{'f1_val': 0.9038046668355414, 'auprc': 0.9552881885202729, 'loss_val': 0.22080605598900266, 'psi': 0.924398075509434}
[S7] START round=48 head_norm_before_train=1.500337 cos_to_last_merge=0.9889 (last merge round=39)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5028476600593239, 'auprc': 0.7810753182100636, 'loss_val': 0.9115854150098556, 'psi': 0.6141387233196198}-{'f1_val': 0.6281148805078017, 'auprc': 0.802538615438009, 'loss_val': 0.5046992287270052, 'psi': 0.6978843744798846}
[S8] START round=48 head_norm_before_train=1.387430 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9734314931359104, 'auprc': 0.9989826941106826, 'loss_val': 0.08451522370519451, 'psi': 0.9836519735258193}-{'f1_val': 0.9913939174441393, 'auprc': 0.9900595374738606, 'loss_val': 0.07903609762920948, 'psi': 0.9908601654560278}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=48 metric=0.9734 head_norm=1.399841
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.331717e-01
[S8] stored merged vector for next round verification (round=48)
[S8] DEBUG after merge:  round=48 metric=0.9734 head_norm=1.411194 delta_norm=0.133172
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] START round=48 head_norm_before_train=1.544195 cos_to_last_merge=0.9999 (last merge round=46)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.996768219682378, 'loss_val': 0.048119102955899315, 'psi': 0.9967642539373602}-{'f1_val': 0.9967616101073482, 'auprc': 0.9985159210842779, 'loss_val': 0.05098819919892522, 'psi': 0.9974633344981201}
[S10] START round=48 head_norm_before_train=2.092177 (no previous merge yet)
[S10] round=48 local utility u=0.001117 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.996328329859653, 'loss_val': 0.026010920633654712, 'psi': 0.9956183634242793}-{'f1_val': 0.9951450524673635, 'auprc': 0.9958483801175386, 'loss_val': 0.026806004535670672, 'psi': 0.9954263835274335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=48 head_norm_before_train=2.195107 (no previous merge yet)
[S11] round=48 local utility u=0.002682 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9982751597510704, 'loss_val': 0.02103120527713903, 'psi': 0.9974886178761744}-{'f1_val': 0.9963090846170353, 'auprc': 0.9981670525411213, 'loss_val': 0.022140284894333645, 'psi': 0.9970522717866697}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=48 head_norm_before_train=1.828687 (no previous merge yet)
[S13] round=48 local utility u=0.255738 metrics={'f1_val': 0.6182504767972874, 'auprc': 0.7674136945892536, 'loss_val': 0.8341770475740611, 'psi': 0.6779157639140738}-{'f1_val': 0.609523114813008, 'auprc': 0.6948846955156043, 'loss_val': 1.0757022898974404, 'psi': 0.6436677470940466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=48 head_norm_before_train=1.543154 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9967151938346126, 'loss_val': 0.04045517829673168, 'psi': 0.9968713775841109}-{'f1_val': 0.9965652232429598, 'auprc': 0.9984673238257099, 'loss_val': 0.04146747739269374, 'psi': 0.9973260634760599}
[S15] START round=48 head_norm_before_train=1.462514 cos_to_last_merge=1.0000 (last merge round=47)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.8133313114252707, 'auprc': 0.9895651609481957, 'loss_val': 0.27833250969250156, 'psi': 0.8838248512344407}-{'f1_val': 0.9969902329512002, 'auprc': 0.9967078020964121, 'loss_val': 0.059569163999636736, 'psi': 0.9968772606092849}
[S16] START round=48 head_norm_before_train=1.519247 cos_to_last_merge=0.9882 (last merge round=40)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9411139217425994, 'auprc': 0.9960015523739909, 'loss_val': 0.21654506629443043, 'psi': 0.963068973995156}-{'f1_val': 0.9923381412886771, 'auprc': 0.9972990849473745, 'loss_val': 0.04786353381948759, 'psi': 0.994322518752156}
[S17] START round=48 head_norm_before_train=1.801483 cos_to_last_merge=0.7935 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.794
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6177473541577387, 'auprc': 0.9405413130014656, 'loss_val': 1.0664963163313401, 'psi': 0.7468649376952294}-{'f1_val': 0.6365744308317447, 'auprc': 0.9370926453714645, 'loss_val': 0.8912146703305359, 'psi': 0.7567817166476326}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:44614
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1802) from S3
[S14] cosine check vs S3: cos=0.9995
[S9] RECEIVED delta(kind=head bytes=1806) from S5
[S9] cosine check vs S5: cos=0.9997
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=48 metric=0.9821 head_norm=1.584748
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.227271e-02
[S3] stored merged vector for next round verification (round=48)
[S3] DEBUG after merge:  round=48 metric=0.9821 head_norm=1.554611 delta_norm=0.062273
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=2.078348 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.8270916486870554, 'auprc': 0.8619173000932572, 'loss_val': 0.522523717583169, 'psi': 0.8410219092495361}-{'f1_val': 0.8270916486870554, 'auprc': 0.8885118298432271, 'loss_val': 0.5081528951524135, 'psi': 0.851659721149524}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.554611 cos_to_last_merge=1.0000 (last merge round=48)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9673653651057048, 'auprc': 0.9987894960270018, 'loss_val': 0.11340426295154828, 'psi': 0.9799350174742236}-{'f1_val': 0.9821381472866884, 'auprc': 0.9988574321493139, 'loss_val': 0.06759698984952497, 'psi': 0.9888258612317387}
[S4] START round=49 head_norm_before_train=1.562527 cos_to_last_merge=1.0000 (last merge round=47)
[S4] round=49 local utility u=0.031156 metrics={'f1_val': 0.9436284837745089, 'auprc': 0.9723789134832852, 'loss_val': 0.27428413263054896, 'psi': 0.9551286556580194}-{'f1_val': 0.9407918735427372, 'auprc': 0.9610161734466481, 'loss_val': 0.285488267988748, 'psi': 0.9488815935043016}
[S5] START round=49 head_norm_before_train=1.533018 cos_to_last_merge=1.0000 (last merge round=46)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.700868080518019, 'auprc': 0.9881817487002694, 'loss_val': 0.28439715846829766, 'psi': 0.8157935477909192}-{'f1_val': 0.9876305103029603, 'auprc': 0.9899195629177142, 'loss_val': 0.1316682512007604, 'psi': 0.9885461313488619}
[S6] START round=49 head_norm_before_train=1.569205 cos_to_last_merge=0.9999 (last merge round=47)
[S6] round=49 local utility u=0.268684 metrics={'f1_val': 0.81776216041903, 'auprc': 0.9524338481347876, 'loss_val': 0.5637817929420706, 'psi': 0.871630835505333}-{'f1_val': 0.7690323462902036, 'auprc': 0.8871986912855033, 'loss_val': 0.6130652259571441, 'psi': 0.8162988842883234}
[S7] START round=49 head_norm_before_train=1.513302 cos_to_last_merge=0.9878 (last merge round=39)
[S7] round=49 local utility u=0.816526 metrics={'f1_val': 0.6680382628246033, 'auprc': 0.8234854201196758, 'loss_val': 0.39690738613285625, 'psi': 0.7302171257426324}-{'f1_val': 0.5028476600593239, 'auprc': 0.7810753182100636, 'loss_val': 0.9115854150098556, 'psi': 0.6141387233196198}
[S8] START round=49 head_norm_before_train=1.411194 cos_to_last_merge=1.0000 (last merge round=48)
[S8] round=49 local utility u=0.073638 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9993510962994678, 'loss_val': 0.055117814979122326, 'psi': 0.9954767619987563}-{'f1_val': 0.9734314931359104, 'auprc': 0.9989826941106826, 'loss_val': 0.08451522370519451, 'psi': 0.9836519735258193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=49 head_norm_before_train=1.561605 cos_to_last_merge=0.9997 (last merge round=46)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9963511932942111, 'auprc': 0.9934641389249874, 'loss_val': 0.045441479294992856, 'psi': 0.9951963715465215}-{'f1_val': 0.9967616101073482, 'auprc': 0.996768219682378, 'loss_val': 0.048119102955899315, 'psi': 0.9967642539373602}
[S10] START round=49 head_norm_before_train=2.094990 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9961429604725022, 'loss_val': 0.026187438100517754, 'psi': 0.995544215669419}-{'f1_val': 0.9951450524673635, 'auprc': 0.996328329859653, 'loss_val': 0.026010920633654712, 'psi': 0.9956183634242793}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.197984 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9983185259185385, 'loss_val': 0.021422610762325465, 'psi': 0.9971128611376365}-{'f1_val': 0.9969642566262439, 'auprc': 0.9982751597510704, 'loss_val': 0.02103120527713903, 'psi': 0.9974886178761744}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.830291 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.624210592819516, 'auprc': 0.7267143168017505, 'loss_val': 0.9214964755055882, 'psi': 0.6652120824124097}-{'f1_val': 0.6182504767972874, 'auprc': 0.7674136945892536, 'loss_val': 0.8341770475740611, 'psi': 0.6779157639140738}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.556359 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9612521834110387, 'auprc': 0.9964687512980066, 'loss_val': 0.07143172689007046, 'psi': 0.9753388105658258}-{'f1_val': 0.9969755000837764, 'auprc': 0.9967151938346126, 'loss_val': 0.04045517829673168, 'psi': 0.9968713775841109}
[S15] START round=49 head_norm_before_train=1.478811 cos_to_last_merge=0.9999 (last merge round=47)
[S15] round=49 local utility u=0.547261 metrics={'f1_val': 0.9664533560715588, 'auprc': 0.9904124214322003, 'loss_val': 0.10508459716116762, 'psi': 0.9760369822158155}-{'f1_val': 0.8133313114252707, 'auprc': 0.9895651609481957, 'loss_val': 0.27833250969250156, 'psi': 0.8838248512344407}
[S16] START round=49 head_norm_before_train=1.538127 cos_to_last_merge=0.9869 (last merge round=40)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8416789677662119, 'auprc': 0.9265062735995528, 'loss_val': 0.8500345846741123, 'psi': 0.8756098900995481}-{'f1_val': 0.9411139217425994, 'auprc': 0.9960015523739909, 'loss_val': 0.21654506629443043, 'psi': 0.963068973995156}
[S17] START round=49 head_norm_before_train=1.814438 cos_to_last_merge=0.7917 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.792
[S17] round=49 local utility u=0.095278 metrics={'f1_val': 0.6280503560229558, 'auprc': 0.9673170014504383, 'loss_val': 1.018084396574677, 'psi': 0.7637570141939488}-{'f1_val': 0.6177473541577387, 'auprc': 0.9405413130014656, 'loss_val': 1.0664963163313401, 'psi': 0.7468649376952294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S4]  timeout peer S5
[S7]  timeout peer S16
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:44609
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:44607
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=49 metric=0.9613 head_norm=1.568319
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.936451e-02
[S14] stored merged vector for next round verification (round=49)
[S14] DEBUG after merge:  round=49 metric=0.9608 head_norm=1.576281 delta_norm=0.029365
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=49 metric=0.9964 head_norm=1.579051
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.562943e-02
[S9] stored merged vector for next round verification (round=49)
[S9] DEBUG after merge:  round=49 metric=0.9964 head_norm=1.555797 delta_norm=0.035629
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1805) from S6
[S4] cosine check vs S6: cos=0.9993
[S8] RECEIVED delta(kind=head bytes=1794) from S15
[S8] cosine check vs S15: cos=0.9885
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S4
[S6] cosine check vs S4: cos=0.9993
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=49 metric=0.9436 head_norm=1.566464
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.166185e-02
[S4] stored merged vector for next round verification (round=49)
[S4] DEBUG after merge:  round=49 metric=0.9436 head_norm=1.575763 delta_norm=0.031662
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14]  timeout peer S3
[S16]  timeout peer S7
[S15]  timeout peer S8
[runner] rounds complete.
[runner] all agents stopped.
