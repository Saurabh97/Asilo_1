[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:61003
[S3] → join 127.0.0.1:61002
[S4] → join 127.0.0.1:61002
[S5] → join 127.0.0.1:61002
[S6] → join 127.0.0.1:61002
[S7] → join 127.0.0.1:61002
[S8] → join 127.0.0.1:61002
[S9] → join 127.0.0.1:61002
[S10] → join 127.0.0.1:61002
[S11] → join 127.0.0.1:61002
[S13] → join 127.0.0.1:61002
[S14] → join 127.0.0.1:61002
[S15] → join 127.0.0.1:61002
[S16] → join 127.0.0.1:61002
[S17] → join 127.0.0.1:61002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.121513 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.150637 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.145893 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.217111 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.175228 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.152011 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.128587 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.178493 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.193196 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.118121 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.206385 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.209629 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.156386 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.182493 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.217058 (no previous merge yet)
[S13]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S3] + discovered S14
[S3] + discovered S11
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S6
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S10
[S3] + discovered S7
[S3] + discovered S16
[S3] + discovered S5
[S3] + discovered S13
[S3] + discovered S15
[S3] + discovered S4
[S3] + discovered S8
[S5] + discovered S3
[S5] + discovered S4
[S5] + discovered S2
[S4] + discovered S6
[S4] + discovered S5
[S4] + discovered S9
[S4] + discovered S17
[S4] + discovered S14
[S4] + discovered S10
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S15
[S4] + discovered S8
[S4] + discovered S7
[S4] + discovered S11
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S5
[S6] + discovered S4
[S5] + discovered S13
[S5] + discovered S16
[S5] + discovered S9
[S5] + discovered S11
[S5] + discovered S14
[S5] + discovered S8
[S5] + discovered S7
[S5] + discovered S15
[S5] + discovered S10
[S5] + discovered S17
[S5] + discovered S6
[S7] + discovered S5
[S7] + discovered S3
[S6] + discovered S14
[S6] + discovered S8
[S6] + discovered S16
[S6] + discovered S13
[S6] + discovered S17
[S6] + discovered S10
[S6] + discovered S15
[S6] + discovered S7
[S6] + discovered S11
[S7] + discovered S4
[S6] + discovered S9
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S11
[S7] + discovered S15
[S7] + discovered S16
[S7] + discovered S9
[S7] + discovered S10
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S17
[S7] + discovered S13
[S8] + discovered S3
[S8] + discovered S7
[S8] + discovered S5
[S8] + discovered S4
[S8] + discovered S6
[S8] + discovered S2
[S9] + discovered S2
[S9] + discovered S4
[S9] + discovered S7
[S9] + discovered S5
[S9] + discovered S8
[S9] + discovered S6
[S9] + discovered S3
[S8] + discovered S13
[S8] + discovered S14
[S8] + discovered S10
[S8] + discovered S11
[S8] + discovered S9
[S8] + discovered S17
[S8] + discovered S16
[S8] + discovered S15
[S10] + discovered S7
[S10] + discovered S9
[S10] + discovered S4
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S6
[S10] + discovered S5
[S9] + discovered S17
[S9] + discovered S13
[S9] + discovered S15
[S9] + discovered S16
[S9] + discovered S11
[S9] + discovered S14
[S9] + discovered S10
[S11] + discovered S2
[S11] + discovered S6
[S11] + discovered S10
[S11] + discovered S9
[S11] + discovered S3
[S10] + discovered S11
[S11] + discovered S7
[S10] + discovered S15
[S11] + discovered S8
[S10] + discovered S13
[S11] + discovered S4
[S10] + discovered S14
[S10] + discovered S16
[S11] + discovered S5
[S10] + discovered S17
[S11] + discovered S13
[S11] + discovered S15
[S11] + discovered S14
[S11] + discovered S16
[S11] + discovered S17
[S13] + discovered S4
[S13] + discovered S8
[S13] + discovered S2
[S13] + discovered S11
[S13] + discovered S7
[S13] + discovered S10
[S13] + discovered S9
[S13] + discovered S6
[S13] + discovered S3
[S13] + discovered S5
[S14] + discovered S10
[S14] + discovered S13
[S14] + discovered S4
[S13] + discovered S16
[S13] + discovered S17
[S13] + discovered S15
[S14] + discovered S6
[S14] + discovered S8
[S13] + discovered S14
[S14] + discovered S5
[S14] + discovered S2
[S14] + discovered S11
[S14] + discovered S3
[S14] + discovered S9
[S14] + discovered S7
[S14] + discovered S17
[S15] + discovered S4
[S15] + discovered S3
[S14] + discovered S16
[S15] + discovered S13
[S15] + discovered S2
[S15] + discovered S10
[S15] + discovered S5
[S15] + discovered S14
[S14] + discovered S15
[S15] + discovered S6
[S15] + discovered S11
[S15] + discovered S8
[S15] + discovered S7
[S15] + discovered S9
[S16] + discovered S6
[S16] + discovered S14
[S16] + discovered S15
[S16] + discovered S10
[S16] + discovered S9
[S16] + discovered S13
[S16] + discovered S3
[S16] + discovered S4
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S5
[S16] + discovered S2
[S16] + discovered S7
[S16] + discovered S11
[S16] + discovered S8
[S17] + discovered S7
[S17] + discovered S8
[S17] + discovered S13
[S17] + discovered S3
[S17] + discovered S11
[S16] + discovered S17
[S17] + discovered S14
[S17] + discovered S5
[S17] + discovered S16
[S17] + discovered S4
[S17] + discovered S15
[S17] + discovered S10
[S17] + discovered S6
[S17] + discovered S2
[S17] + discovered S9
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=1.000 → S11@127.0.0.1:61012
[S2] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:61017
[S11] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:61008
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:61017
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:61017
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:61014
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:61015
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:61009
[S5] ⇄ pheromone p=1.000 → S11@127.0.0.1:61012
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:61008
[S15] ⇄ pheromone p=1.000 → S9@127.0.0.1:61010
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:61013
[S2] START round=1 head_norm_before_train=1.120710 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.5381789365441775, 'loss_val': 1.3287054761053172, 'psi': 0.30033785465081103}-{'f1_val': 0.3766734945047302, 'auprc': 0.3837483544106647, 'loss_val': 1.3649029147424168, 'psi': 0.379503438467104}
[S3] START round=1 head_norm_before_train=1.178368 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9724214467004401, 'loss_val': 1.2585625657098845, 'psi': 0.4728726180486402}-{'f1_val': 0.39626584025733846, 'auprc': 0.7334062006650736, 'loss_val': 1.323230015752819, 'psi': 0.5311219844204325}
[S4] START round=1 head_norm_before_train=1.150393 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7623234950484123, 'loss_val': 1.323457435919015, 'psi': 0.38906537535647545}-{'f1_val': 0.32296085824774673, 'auprc': 0.5991275379544925, 'loss_val': 1.3560417194870915, 'psi': 0.433427530130445}
[S5] START round=1 head_norm_before_train=1.229657 (no previous merge yet)
[S5] round=1 local utility u=0.337616 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7279926508432641, 'loss_val': 1.2837057550926287, 'psi': 0.37655420319444854}-{'f1_val': 0.14226190476190476, 'auprc': 0.523423962820574, 'loss_val': 1.345231527775553, 'psi': 0.29472672798537247}
[S6] START round=1 head_norm_before_train=1.175789 (no previous merge yet)
[S6] round=1 local utility u=0.050360 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7150012195397528, 'loss_val': 1.3212089666842184, 'psi': 0.37085625704667036}-{'f1_val': 0.14142628205128205, 'auprc': 0.6937493321749227, 'loss_val': 1.3581735661418928, 'psi': 0.3623555021007383}
[S7] START round=1 head_norm_before_train=1.159087 (no previous merge yet)
[S7] round=1 local utility u=0.113367 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7811355063786204, 'loss_val': 1.2689515981564397, 'psi': 0.39768829618890317}-{'f1_val': 0.14205682272909165, 'auprc': 0.7255765668636647, 'loss_val': 1.329008669703453, 'psi': 0.3754647203829209}
[S8] START round=1 head_norm_before_train=1.128332 (no previous merge yet)
[S8] round=1 local utility u=0.013608 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7678095467325875, 'loss_val': 1.319649227184749, 'psi': 0.39109740812880933}-{'f1_val': 0.13995598239295717, 'auprc': 0.7704286960414435, 'loss_val': 1.3547232702294347, 'psi': 0.39214506785235176}
[S9] START round=1 head_norm_before_train=1.198999 (no previous merge yet)
[S9] round=1 local utility u=0.512869 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9813540506241238, 'loss_val': 1.2395304308874373, 'psi': 0.47738039453364717}-{'f1_val': 0.141397957139996, 'auprc': 0.6681821819395015, 'loss_val': 1.325751886696545, 'psi': 0.35211164705979825}
[S10] START round=1 head_norm_before_train=1.202799 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5629428369387598, 'loss_val': 1.33662609982532, 'psi': 0.3083501173005383}-{'f1_val': 0.15123820754716982, 'auprc': 0.5497361178545718, 'loss_val': 1.36853918683345, 'psi': 0.3106373716701306}
[S11] START round=1 head_norm_before_train=1.126166 (no previous merge yet)
[S11] round=1 local utility u=0.591331 metrics={'f1_val': 0.4229120744550575, 'auprc': 0.6637020444385787, 'loss_val': 1.3201837781013206, 'psi': 0.519228062448466}-{'f1_val': 0.2472820704853473, 'auprc': 0.632424143092456, 'loss_val': 1.3552312606421724, 'psi': 0.4013388995281908}
[S13] START round=1 head_norm_before_train=1.203140 (no previous merge yet)
[S13] round=1 local utility u=0.029897 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5995188761512764, 'loss_val': 1.3437318240352638, 'psi': 0.32403900800674246}-{'f1_val': 0.144929267743667, 'auprc': 0.5800795470464972, 'loss_val': 1.3724682955762315, 'psi': 0.3189893794647991}
[S14] START round=1 head_norm_before_train=1.200880 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.11640471512770137, 'auprc': 0.2848548316591518, 'loss_val': 1.3711255546467906, 'psi': 0.18378476174028155}-{'f1_val': 0.21697480237880296, 'auprc': 0.17912175949337367, 'loss_val': 1.3949516633189554, 'psi': 0.20183358522463124}
[S15] START round=1 head_norm_before_train=1.164484 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.19438914041065217, 'auprc': 0.7255209000018348, 'loss_val': 1.3108267499837019, 'psi': 0.4068418442471252}-{'f1_val': 0.42173087704027123, 'auprc': 0.6023335942193903, 'loss_val': 1.3384588241928432, 'psi': 0.49397196391191883}
[S16] START round=1 head_norm_before_train=1.195608 (no previous merge yet)
[S16] round=1 local utility u=0.023639 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8018492050374669, 'loss_val': 1.297970244601326, 'psi': 0.40512215213450875}-{'f1_val': 0.14063745019920318, 'auprc': 0.7942531149854175, 'loss_val': 1.3224598684786564, 'psi': 0.402083716113689}
[S17] START round=1 head_norm_before_train=1.222879 (no previous merge yet)
[S17] round=1 local utility u=0.142817 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6569988109276083, 'loss_val': 1.3309762124452145, 'psi': 0.34736890236147394}-{'f1_val': 0.13046805460112051, 'auprc': 0.5930434558615278, 'loss_val': 1.3618577286909903, 'psi': 0.3154982151052835}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61008
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:61007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:61007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:61005
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S13] → sending delta(kind=head bytes=1785) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S11] → sending delta(kind=head bytes=1785) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:61016
[S13] sending update (kind=head size=1785 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1785 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1790) from S16
[S6] cosine check vs S16: cos=0.0171
[S6] RECEIVED delta(kind=head bytes=1796) from S5
[S6] cosine check vs S5: cos=0.1154
[S7] RECEIVED delta(kind=head bytes=1785) from S11
[S7] cosine check vs S11: cos=-0.0201
[S7] DROPPED delta from S11 (cos=-0.0201 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S6
[S16] cosine check vs S6: cos=0.0171
[S7] RECEIVED delta(kind=head bytes=1796) from S8
[S7] cosine check vs S8: cos=0.0101
[S8] RECEIVED delta(kind=head bytes=1785) from S13
[S8] cosine check vs S13: cos=-0.1036
[S8] DROPPED delta from S13 (cos=-0.1036 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S9
[S8] cosine check vs S9: cos=-0.0229
[S8] DROPPED delta from S9 (cos=-0.0229 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S7
[S5] cosine check vs S7: cos=0.0149
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S17] → sending delta(kind=head bytes=1787) to S16@127.0.0.1:61016
[S17] sending update (kind=head size=1787 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1787) from S17
[S16] cosine check vs S17: cos=0.1331
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.194293
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.207327e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.829075 delta_norm=0.820733
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.210888
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.004778e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.776411 delta_norm=0.700478
[S16] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.254987
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.597285e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.872657 delta_norm=0.859729
[S5] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.189097
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.110054e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.777149 delta_norm=0.711005
[S6] aggregate: ACCEPT kept=['S16', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.127873 (no previous merge yet)
[S2] round=2 local utility u=0.126287 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6072544526787483, 'loss_val': 1.2833571329128228, 'psi': 0.3279680611046394}-{'f1_val': 0.1417771333885667, 'auprc': 0.5381789365441775, 'loss_val': 1.3287054761053172, 'psi': 0.30033785465081103}
[S3] START round=2 head_norm_before_train=1.219387 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8175989240480394, 'loss_val': 1.1638618145920954, 'psi': 0.41094360898768}-{'f1_val': 0.13984006561410703, 'auprc': 0.9724214467004401, 'loss_val': 1.2585625657098845, 'psi': 0.4728726180486402}
[S4] START round=2 head_norm_before_train=1.167548 (no previous merge yet)
[S4] round=2 local utility u=0.044786 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7801244634279841, 'loss_val': 1.2872891852544608, 'psi': 0.39618576270830413}-{'f1_val': 0.14022662889518414, 'auprc': 0.7623234950484123, 'loss_val': 1.323457435919015, 'psi': 0.38906537535647545}
[S5] START round=2 head_norm_before_train=0.872657 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.004195 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7282661543541797, 'loss_val': 1.2761366809967924, 'psi': 0.37666360459881476}-{'f1_val': 0.14226190476190476, 'auprc': 0.7279926508432641, 'loss_val': 1.2837057550926287, 'psi': 0.37655420319444854}
[S6] START round=2 head_norm_before_train=0.777149 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.679348947721601, 'loss_val': 1.3126317798633254, 'psi': 0.35659534831940964}-{'f1_val': 0.14142628205128205, 'auprc': 0.7150012195397528, 'loss_val': 1.3212089666842184, 'psi': 0.37085625704667036}
[S7] START round=2 head_norm_before_train=0.829075 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.015258 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7875816621311669, 'loss_val': 1.2577739185930608, 'psi': 0.40026675848992177}-{'f1_val': 0.14205682272909165, 'auprc': 0.7811355063786204, 'loss_val': 1.2689515981564397, 'psi': 0.39768829618890317}
[S8] START round=2 head_norm_before_train=1.138245 (no previous merge yet)
[S8] round=2 local utility u=0.016926 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7666988198904637, 'loss_val': 1.2824644714145426, 'psi': 0.39065311739195985}-{'f1_val': 0.13995598239295717, 'auprc': 0.7678095467325875, 'loss_val': 1.319649227184749, 'psi': 0.39109740812880933}
[S9] START round=2 head_norm_before_train=1.236461 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6682570465520261, 'loss_val': 1.1216221758658653, 'psi': 0.35214159290480807}-{'f1_val': 0.141397957139996, 'auprc': 0.9813540506241238, 'loss_val': 1.2395304308874373, 'psi': 0.47738039453364717}
[S10] START round=2 head_norm_before_train=1.214673 (no previous merge yet)
[S10] round=2 local utility u=0.041690 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5793015750522473, 'loss_val': 1.3023214784443315, 'psi': 0.3148936125459333}-{'f1_val': 0.13862163754172394, 'auprc': 0.5629428369387598, 'loss_val': 1.33662609982532, 'psi': 0.3083501173005383}
[S11] START round=2 head_norm_before_train=1.143913 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6753600256101779, 'loss_val': 1.2739427677749937, 'psi': 0.35439222026793754}-{'f1_val': 0.4229120744550575, 'auprc': 0.6637020444385787, 'loss_val': 1.3201837781013206, 'psi': 0.519228062448466}
[S13] START round=2 head_norm_before_train=1.209498 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5872666714649646, 'loss_val': 1.3103770577194103, 'psi': 0.3191381261322177}-{'f1_val': 0.1403857625770531, 'auprc': 0.5995188761512764, 'loss_val': 1.3437318240352638, 'psi': 0.32403900800674246}
[S14] START round=2 head_norm_before_train=1.202209 (no previous merge yet)
[S14] round=2 local utility u=1.000000 metrics={'f1_val': 0.41095474641100793, 'auprc': 0.4936522776811939, 'loss_val': 1.3449076392051575, 'psi': 0.4440337589190823}-{'f1_val': 0.11640471512770137, 'auprc': 0.2848548316591518, 'loss_val': 1.3711255546467906, 'psi': 0.18378476174028155}
[S15] START round=2 head_norm_before_train=1.179871 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7490833037726976, 'loss_val': 1.284257230246914, 'psi': 0.38347351232601407}-{'f1_val': 0.19438914041065217, 'auprc': 0.7255209000018348, 'loss_val': 1.3108267499837019, 'psi': 0.4068418442471252}
[S16] START round=2 head_norm_before_train=0.776411 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.013026 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8109090022251884, 'loss_val': 1.2990974771311818, 'psi': 0.40874607100959726}-{'f1_val': 0.14063745019920318, 'auprc': 0.8018492050374669, 'loss_val': 1.297970244601326, 'psi': 0.40512215213450875}
[S17] START round=2 head_norm_before_train=1.239017 (no previous merge yet)
[S17] round=2 local utility u=0.187682 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7691748753066083, 'loss_val': 1.2921413272049955, 'psi': 0.392239328113074}-{'f1_val': 0.14094896331738438, 'auprc': 0.6569988109276083, 'loss_val': 1.3309762124452145, 'psi': 0.34736890236147394}
[S8] not sending this round → trigger blocked (psi=0.391)
[S7] not sending this round → trigger blocked (psi=0.400)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:61017
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.377)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:61014
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.409)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:61014
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=-0.0956
[S14] DROPPED delta from S10 (cos=-0.0956 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S4
[S14] cosine check vs S4: cos=-0.0116
[S14] DROPPED delta from S4 (cos=-0.0116 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1792) from S2
[S11] cosine check vs S2: cos=-0.0403
[S11] DROPPED delta from S2 (cos=-0.0403 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S14
[S17] cosine check vs S14: cos=-0.0277
[S17] DROPPED delta from S14 (cos=-0.0277 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.392)
[S2] START round=3 head_norm_before_train=1.145906 (no previous merge yet)
[S2] round=3 local utility u=0.271618 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.768855101256791, 'loss_val': 1.224923058806752, 'psi': 0.3926083205358565}-{'f1_val': 0.1417771333885667, 'auprc': 0.6072544526787483, 'loss_val': 1.2833571329128228, 'psi': 0.3279680611046394}
[S3] START round=3 head_norm_before_train=1.269669 (no previous merge yet)
[S3] round=3 local utility u=1.000000 metrics={'f1_val': 0.3918212993543667, 'auprc': 0.9990002005706884, 'loss_val': 0.9192512483931924, 'psi': 0.6346928598408954}-{'f1_val': 0.13984006561410703, 'auprc': 0.8175989240480394, 'loss_val': 1.1638618145920954, 'psi': 0.41094360898768}
[S4] START round=3 head_norm_before_train=1.191275 (no previous merge yet)
[S4] round=3 local utility u=0.028114 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7827975370273094, 'loss_val': 1.2390798342354457, 'psi': 0.3972549921480342}-{'f1_val': 0.14022662889518414, 'auprc': 0.7801244634279841, 'loss_val': 1.2872891852544608, 'psi': 0.39618576270830413}
[S5] START round=3 head_norm_before_train=0.903392 cos_to_last_merge=0.9945 (last merge round=1)
[S5] round=3 local utility u=0.029066 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.728764420594582, 'loss_val': 1.2194993130922342, 'psi': 0.37686291109497566}-{'f1_val': 0.14226190476190476, 'auprc': 0.7282661543541797, 'loss_val': 1.2761366809967924, 'psi': 0.37666360459881476}
[S6] START round=3 head_norm_before_train=0.796566 cos_to_last_merge=0.9963 (last merge round=1)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6517707232939328, 'loss_val': 1.261778251280585, 'psi': 0.3455640585483423}-{'f1_val': 0.14142628205128205, 'auprc': 0.679348947721601, 'loss_val': 1.3126317798633254, 'psi': 0.35659534831940964}
[S7] START round=3 head_norm_before_train=0.869700 cos_to_last_merge=0.9926 (last merge round=1)
[S7] round=3 local utility u=0.038699 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7879853671066221, 'loss_val': 1.181586617125738, 'psi': 0.4004282404801039}-{'f1_val': 0.14205682272909165, 'auprc': 0.7875816621311669, 'loss_val': 1.2577739185930608, 'psi': 0.40026675848992177}
[S8] START round=3 head_norm_before_train=1.159330 (no previous merge yet)
[S8] round=3 local utility u=0.017896 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7631875196515938, 'loss_val': 1.236138163906282, 'psi': 0.38924859729641187}-{'f1_val': 0.13995598239295717, 'auprc': 0.7666988198904637, 'loss_val': 1.2824644714145426, 'psi': 0.39065311739195985}
[S9] START round=3 head_norm_before_train=1.291888 (no previous merge yet)
[S9] round=3 local utility u=0.937564 metrics={'f1_val': 0.41697558078303143, 'auprc': 0.6686604318730712, 'loss_val': 0.9011700526330897, 'psi': 0.5176495212190473}-{'f1_val': 0.141397957139996, 'auprc': 0.6682570465520261, 'loss_val': 1.1216221758658653, 'psi': 0.35214159290480807}
[S10] START round=3 head_norm_before_train=1.237330 (no previous merge yet)
[S10] round=3 local utility u=0.030988 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5856700890593722, 'loss_val': 1.2594505202537205, 'psi': 0.3174410181487832}-{'f1_val': 0.13862163754172394, 'auprc': 0.5793015750522473, 'loss_val': 1.3023214784443315, 'psi': 0.3148936125459333}
[S11] START round=3 head_norm_before_train=1.173519 (no previous merge yet)
[S11] round=3 local utility u=0.057607 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6930965339827673, 'loss_val': 1.2119379143224156, 'psi': 0.36148682361697326}-{'f1_val': 0.14041368337311058, 'auprc': 0.6753600256101779, 'loss_val': 1.2739427677749937, 'psi': 0.35439222026793754}
[S13] START round=3 head_norm_before_train=1.225601 (no previous merge yet)
[S13] round=3 local utility u=0.030342 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5944597130330036, 'loss_val': 1.2712731021226196, 'psi': 0.32201534275943333}-{'f1_val': 0.1403857625770531, 'auprc': 0.5872666714649646, 'loss_val': 1.3103770577194103, 'psi': 0.3191381261322177}
[S14] START round=3 head_norm_before_train=1.214065 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6737784945085842, 'loss_val': 1.3135356527276334, 'psi': 0.35372610953305594}-{'f1_val': 0.41095474641100793, 'auprc': 0.4936522776811939, 'loss_val': 1.3449076392051575, 'psi': 0.4440337589190823}
[S15] START round=3 head_norm_before_train=1.199966 (no previous merge yet)
[S15] round=3 local utility u=0.041015 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7669639954476964, 'loss_val': 1.255870081622874, 'psi': 0.3906257889960136}-{'f1_val': 0.13973365136155833, 'auprc': 0.7490833037726976, 'loss_val': 1.284257230246914, 'psi': 0.38347351232601407}
[S16] START round=3 head_norm_before_train=0.798277 cos_to_last_merge=0.9967 (last merge round=1)
[S16] round=3 local utility u=0.016621 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8021901320633887, 'loss_val': 1.239698800192123, 'psi': 0.4052585229448774}-{'f1_val': 0.14063745019920318, 'auprc': 0.8109090022251884, 'loss_val': 1.2990974771311818, 'psi': 0.40874607100959726}
[S17] START round=3 head_norm_before_train=1.264634 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5848762259673498, 'loss_val': 1.241192061962477, 'psi': 0.31851986837737056}-{'f1_val': 0.14094896331738438, 'auprc': 0.7691748753066083, 'loss_val': 1.2921413272049955, 'psi': 0.392239328113074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:61009
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61012
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:61008
[S4] not sending this round → trigger blocked (psi=0.397)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:61010
[S2] not sending this round → trigger blocked (psi=0.393)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:61008
[S10] not sending this round → trigger blocked (psi=0.317)
[S13] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1793) from S5
[S11] cosine check vs S5: cos=-0.0123
[S11] DROPPED delta from S5 (cos=-0.0123 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S15
[S9] cosine check vs S15: cos=0.0169
[S11] RECEIVED delta(kind=head bytes=1796) from S3
[S11] cosine check vs S3: cos=0.0807
[S7] RECEIVED delta(kind=head bytes=1793) from S13
[S7] cosine check vs S13: cos=-0.1419
[S7] DROPPED delta from S13 (cos=-0.1419 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] cosine check vs S16: cos=0.0141
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] cosine check vs S7: cos=0.0280
[S17] RECEIVED delta(kind=head bytes=1805) from S9
[S17] cosine check vs S9: cos=0.0392
[S8] RECEIVED delta(kind=head bytes=1789) from S11
[S8] cosine check vs S11: cos=-0.0244
[S8] DROPPED delta from S11 (cos=-0.0244 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.0268
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.212281
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.614991e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.933798 delta_norm=0.861499
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=0.914972
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.140785e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.4167 head_norm=0.622749 delta_norm=0.614079
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.4170 head_norm=1.347917
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.031124e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.4167 head_norm=0.918432 delta_norm=0.903112
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=1.225308
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.435590e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.866487 delta_norm=0.843559
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=1.293931
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.491722e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.782314 delta_norm=0.749172
[S17] aggregate: ACCEPT kept=['S7', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.175121 (no previous merge yet)
[S2] round=4 local utility u=0.023640 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7712239285000644, 'loss_val': 1.1847493971339422, 'psi': 0.3935558514331658}-{'f1_val': 0.1417771333885667, 'auprc': 0.768855101256791, 'loss_val': 1.224923058806752, 'psi': 0.3926083205358565}
[S3] START round=4 head_norm_before_train=1.326158 (no previous merge yet)
[S3] round=4 local utility u=0.108281 metrics={'f1_val': 0.4010090932274478, 'auprc': 0.999789580514389, 'loss_val': 0.7601834658759916, 'psi': 0.6405212881422243}-{'f1_val': 0.3918212993543667, 'auprc': 0.9990002005706884, 'loss_val': 0.9192512483931924, 'psi': 0.6346928598408954}
[S4] START round=4 head_norm_before_train=1.218724 (no previous merge yet)
[S4] round=4 local utility u=0.025028 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7761529268604949, 'loss_val': 1.1690898968612367, 'psi': 0.39459714808130847}-{'f1_val': 0.14022662889518414, 'auprc': 0.7827975370273094, 'loss_val': 1.2390798342354457, 'psi': 0.3972549921480342}
[S5] START round=4 head_norm_before_train=0.936911 cos_to_last_merge=0.9833 (last merge round=1)
[S5] round=4 local utility u=0.903504 metrics={'f1_val': 0.4167436894719335, 'auprc': 0.7546637282920644, 'loss_val': 1.1370802741729995, 'psi': 0.5519117049999859}-{'f1_val': 0.14226190476190476, 'auprc': 0.728764420594582, 'loss_val': 1.2194993130922342, 'psi': 0.37686291109497566}
[S6] START round=4 head_norm_before_train=0.828738 cos_to_last_merge=0.9858 (last merge round=1)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6214700369234616, 'loss_val': 1.230667900830588, 'psi': 0.33344378400015384}-{'f1_val': 0.14142628205128205, 'auprc': 0.6517707232939328, 'loss_val': 1.261778251280585, 'psi': 0.3455640585483423}
[S7] START round=4 head_norm_before_train=0.622749 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.892602 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7883992279740315, 'loss_val': 1.046278653319631, 'psi': 0.5654591708486767}-{'f1_val': 0.14205682272909165, 'auprc': 0.7879853671066221, 'loss_val': 1.181586617125738, 'psi': 0.4004282404801039}
[S8] START round=4 head_norm_before_train=1.193065 (no previous merge yet)
[S8] round=4 local utility u=0.028871 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7661457811786879, 'loss_val': 1.1872702370853443, 'psi': 0.3904319019072495}-{'f1_val': 0.13995598239295717, 'auprc': 0.7631875196515938, 'loss_val': 1.236138163906282, 'psi': 0.38924859729641187}
[S9] START round=4 head_norm_before_train=0.918432 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.451369 metrics={'f1_val': 0.3855892171895158, 'auprc': 0.981771050512938, 'loss_val': 0.749445804400463, 'psi': 0.6240619505188847}-{'f1_val': 0.41697558078303143, 'auprc': 0.6686604318730712, 'loss_val': 0.9011700526330897, 'psi': 0.5176495212190473}
[S10] START round=4 head_norm_before_train=1.267139 (no previous merge yet)
[S10] round=4 local utility u=0.034157 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5878696066157726, 'loss_val': 1.1977359623095276, 'psi': 0.3183208251713434}-{'f1_val': 0.13862163754172394, 'auprc': 0.5856700890593722, 'loss_val': 1.2594505202537205, 'psi': 0.3174410181487832}
[S11] START round=4 head_norm_before_train=0.933798 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.618340993191773, 'loss_val': 1.1904749006433155, 'psi': 0.3315846073005756}-{'f1_val': 0.14041368337311058, 'auprc': 0.6930965339827673, 'loss_val': 1.2119379143224156, 'psi': 0.36148682361697326}
[S13] START round=4 head_norm_before_train=1.248675 (no previous merge yet)
[S13] round=4 local utility u=0.050506 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6144336664802289, 'loss_val': 1.2301829201245154, 'psi': 0.33000492413832344}-{'f1_val': 0.1403857625770531, 'auprc': 0.5944597130330036, 'loss_val': 1.2712731021226196, 'psi': 0.32201534275943333}
[S14] START round=4 head_norm_before_train=1.235625 (no previous merge yet)
[S14] round=4 local utility u=0.100312 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7275460636973978, 'loss_val': 1.2742147110314546, 'psi': 0.37523313720858137}-{'f1_val': 0.14035785288270378, 'auprc': 0.6737784945085842, 'loss_val': 1.3135356527276334, 'psi': 0.35372610953305594}
[S15] START round=4 head_norm_before_train=0.866487 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.002263 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7758488128131563, 'loss_val': 1.2779975630682385, 'psi': 0.39417971594219753}-{'f1_val': 0.13973365136155833, 'auprc': 0.7669639954476964, 'loss_val': 1.255870081622874, 'psi': 0.3906257889960136}
[S16] START round=4 head_norm_before_train=0.832253 cos_to_last_merge=0.9872 (last merge round=1)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6149258039495595, 'loss_val': 1.1855967975003778, 'psi': 0.3303527916993457}-{'f1_val': 0.14063745019920318, 'auprc': 0.8021901320633887, 'loss_val': 1.239698800192123, 'psi': 0.4052585229448774}
[S17] START round=4 head_norm_before_train=0.782314 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5583986146291144, 'loss_val': 1.2389322979534352, 'psi': 0.3079288238420764}-{'f1_val': 0.14094896331738438, 'auprc': 0.5848762259673498, 'loss_val': 1.241192061962477, 'psi': 0.31851986837737056}
[S15] not sending this round → trigger blocked (psi=0.394)
[S7] not sending this round → trigger blocked (psi=0.565)
[S8] not sending this round → trigger blocked (psi=0.390)
[S13] not sending this round → trigger blocked (psi=0.330)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61009
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.641)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:61009
[S5] not sending this round → trigger blocked (psi=0.552)
[S9] not sending this round → trigger blocked (psi=0.624)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61009
[S2] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=-0.0760
[S14] DROPPED delta from S10 (cos=-0.0760 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1790) from S2
[S8] cosine check vs S2: cos=0.1428
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] cosine check vs S4: cos=-0.0207
[S8] DROPPED delta from S4 (cos=-0.0207 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] cosine check vs S14: cos=-0.0035
[S8] DROPPED delta from S14 (cos=-0.0035 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.1400 head_norm=1.224101
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.948638e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.1400 head_norm=0.917728 delta_norm=0.794864
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.204011 (no previous merge yet)
[S2] round=5 local utility u=0.032451 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7745279906401651, 'loss_val': 1.1297588288904044, 'psi': 0.3948774762892061}-{'f1_val': 0.1417771333885667, 'auprc': 0.7712239285000644, 'loss_val': 1.1847493971339422, 'psi': 0.3935558514331658}
[S3] START round=5 head_norm_before_train=1.389228 (no previous merge yet)
[S3] round=5 local utility u=0.135870 metrics={'f1_val': 0.42198931843839965, 'auprc': 0.999879733682266, 'loss_val': 0.6145950477121519, 'psi': 0.6531454845359462}-{'f1_val': 0.4010090932274478, 'auprc': 0.999789580514389, 'loss_val': 0.7601834658759916, 'psi': 0.6405212881422243}
[S4] START round=5 head_norm_before_train=1.249427 (no previous merge yet)
[S4] round=5 local utility u=0.806360 metrics={'f1_val': 0.3944221707041827, 'auprc': 0.7674052894240946, 'loss_val': 1.0553004559079342, 'psi': 0.5436154181921474}-{'f1_val': 0.14022662889518414, 'auprc': 0.7761529268604949, 'loss_val': 1.1690898968612367, 'psi': 0.39459714808130847}
[S5] START round=5 head_norm_before_train=0.955141 cos_to_last_merge=0.9739 (last merge round=1)
[S5] round=5 local utility u=0.112749 metrics={'f1_val': 0.4177505557824055, 'auprc': 0.7742023197224008, 'loss_val': 0.9762393538782217, 'psi': 0.5603312613584036}-{'f1_val': 0.4167436894719335, 'auprc': 0.7546637282920644, 'loss_val': 1.1370802741729995, 'psi': 0.5519117049999859}
[S6] START round=5 head_norm_before_train=0.862863 cos_to_last_merge=0.9732 (last merge round=1)
[S6] round=5 local utility u=0.013504 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6156014330208128, 'loss_val': 1.1860540949814045, 'psi': 0.33109634243909436}-{'f1_val': 0.14142628205128205, 'auprc': 0.6214700369234616, 'loss_val': 1.230667900830588, 'psi': 0.33344378400015384}
[S7] START round=5 head_norm_before_train=0.675974 cos_to_last_merge=0.9895 (last merge round=3)
[S7] round=5 local utility u=0.125862 metrics={'f1_val': 0.41679099637737954, 'auprc': 0.8046753241944324, 'loss_val': 0.8431337061092384, 'psi': 0.5719447275042007}-{'f1_val': 0.41683246609844005, 'auprc': 0.7883992279740315, 'loss_val': 1.046278653319631, 'psi': 0.5654591708486767}
[S8] START round=5 head_norm_before_train=0.917728 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7666468594345044, 'loss_val': 1.1898837975329042, 'psi': 0.3906323332095761}-{'f1_val': 0.13995598239295717, 'auprc': 0.7661457811786879, 'loss_val': 1.1872702370853443, 'psi': 0.3904319019072495}
[S9] START round=5 head_norm_before_train=0.989911 cos_to_last_merge=0.9928 (last merge round=3)
[S9] round=5 local utility u=0.046319 metrics={'f1_val': 0.4371667528122887, 'auprc': 0.8657862599407069, 'loss_val': 0.6183181309647813, 'psi': 0.608614555663656}-{'f1_val': 0.3855892171895158, 'auprc': 0.981771050512938, 'loss_val': 0.749445804400463, 'psi': 0.6240619505188847}
[S10] START round=5 head_norm_before_train=1.302960 (no previous merge yet)
[S10] round=5 local utility u=0.987234 metrics={'f1_val': 0.41615846728099787, 'auprc': 0.6558520374052138, 'loss_val': 1.092435730213082, 'psi': 0.5120358953306843}-{'f1_val': 0.13862163754172394, 'auprc': 0.5878696066157726, 'loss_val': 1.1977359623095276, 'psi': 0.3183208251713434}
[S11] START round=5 head_norm_before_train=0.964263 cos_to_last_merge=0.9978 (last merge round=3)
[S11] round=5 local utility u=0.125327 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.665735659216744, 'loss_val': 1.0820051550052643, 'psi': 0.35054247371056396}-{'f1_val': 0.14041368337311058, 'auprc': 0.618340993191773, 'loss_val': 1.1904749006433155, 'psi': 0.3315846073005756}
[S13] START round=5 head_norm_before_train=1.275941 (no previous merge yet)
[S13] round=5 local utility u=0.026755 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6187906257096746, 'loss_val': 1.1897439294929155, 'psi': 0.3317477078301017}-{'f1_val': 0.1403857625770531, 'auprc': 0.6144336664802289, 'loss_val': 1.2301829201245154, 'psi': 0.33000492413832344}
[S14] START round=5 head_norm_before_train=1.264873 (no previous merge yet)
[S14] round=5 local utility u=0.033790 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7341013443731343, 'loss_val': 1.2263009835543217, 'psi': 0.377855249478876}-{'f1_val': 0.14035785288270378, 'auprc': 0.7275460636973978, 'loss_val': 1.2742147110314546, 'psi': 0.37523313720858137}
[S15] START round=5 head_norm_before_train=0.889914 cos_to_last_merge=0.9984 (last merge round=3)
[S15] round=5 local utility u=0.027135 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7767209610933554, 'loss_val': 1.2263435500574988, 'psi': 0.3945285752542772}-{'f1_val': 0.13973365136155833, 'auprc': 0.7758488128131563, 'loss_val': 1.2779975630682385, 'psi': 0.39417971594219753}
[S16] START round=5 head_norm_before_train=0.869517 cos_to_last_merge=0.9750 (last merge round=1)
[S16] round=5 local utility u=0.850104 metrics={'f1_val': 0.41526982732562534, 'auprc': 0.5980048899231161, 'loss_val': 1.0824200323226363, 'psi': 0.48836385236462165}-{'f1_val': 0.14063745019920318, 'auprc': 0.6149258039495595, 'loss_val': 1.1855967975003778, 'psi': 0.3303527916993457}
[S17] START round=5 head_norm_before_train=0.812916 cos_to_last_merge=0.9967 (last merge round=3)
[S17] round=5 local utility u=0.047999 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5531247322501197, 'loss_val': 1.1271129922270213, 'psi': 0.30581927089047856}-{'f1_val': 0.14094896331738438, 'auprc': 0.5583986146291144, 'loss_val': 1.2389322979534352, 'psi': 0.3079288238420764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:61017
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:61017
[S2] not sending this round → trigger blocked (psi=0.395)
[S14] not sending this round → trigger blocked (psi=0.378)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61009
[S10] not sending this round → trigger blocked (psi=0.512)
[S4] not sending this round → trigger blocked (psi=0.544)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:61012
[S15] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1788 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1790) from S15
[S9] cosine check vs S15: cos=0.4400
[S7] RECEIVED delta(kind=head bytes=1788) from S13
[S7] cosine check vs S13: cos=-0.0234
[S7] DROPPED delta from S13 (cos=-0.0234 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1789) from S16
[S7] cosine check vs S16: cos=0.5952
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] cosine check vs S7: cos=0.4570
[S17] RECEIVED delta(kind=head bytes=1794) from S6
[S17] cosine check vs S6: cos=0.0463
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.3609
[S11] RECEIVED delta(kind=head bytes=1792) from S5
[S11] cosine check vs S5: cos=0.0022
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] cosine check vs S3: cos=0.7184
[S8] RECEIVED delta(kind=head bytes=1803) from S11
[S8] cosine check vs S11: cos=-0.0278
[S8] DROPPED delta from S11 (cos=-0.0278 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=0.0623
[S4] ⇄ pheromone p=0.501 → S8@127.0.0.1:61009
[S10] ⇄ pheromone p=0.539 → S14@127.0.0.1:61014
[S2] ⇄ pheromone p=0.386 → S8@127.0.0.1:61009
[S8] ⇄ pheromone p=0.337 → S15@127.0.0.1:61015
[S14] ⇄ pheromone p=0.453 → S8@127.0.0.1:61009
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.4372 head_norm=1.083764
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.355109e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.4376 head_norm=0.852867 delta_norm=0.535511
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.571 → S17@127.0.0.1:61017
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=1.300983
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.559950e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.800520 delta_norm=0.755995
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.347 → S7@127.0.0.1:61008
[S5] ⇄ pheromone p=0.527 → S11@127.0.0.1:61012
[S6] ⇄ pheromone p=0.335 → S17@127.0.0.1:61017
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=1.002071
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.339149e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.3750 head_norm=0.841965 delta_norm=0.433915
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.409 → S8@127.0.0.1:61009
[S15] ⇄ pheromone p=0.339 → S9@127.0.0.1:61010
[S16] ⇄ pheromone p=0.503 → S7@127.0.0.1:61008
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.4168 head_norm=0.751886
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.779615e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.4168 head_norm=0.739202 delta_norm=0.377962
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.511 → S17@127.0.0.1:61017
[S3] ⇄ pheromone p=0.500 → S11@127.0.0.1:61012
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=0.855666
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.004994e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1409 head_norm=0.613779 delta_norm=0.400499
[S17] aggregate: ACCEPT kept=['S7', 'S6', 'S9'] (k=3/3) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.368 → S13@127.0.0.1:61013
[S2] START round=6 head_norm_before_train=1.225803 (no previous merge yet)
[S2] round=6 local utility u=0.871766 metrics={'f1_val': 0.41668780995073934, 'auprc': 0.778149576158178, 'loss_val': 1.0465560288634173, 'psi': 0.5612725164337148}-{'f1_val': 0.1417771333885667, 'auprc': 0.7745279906401651, 'loss_val': 1.1297588288904044, 'psi': 0.3948774762892061}
[S3] START round=6 head_norm_before_train=1.443246 (no previous merge yet)
[S3] round=6 local utility u=0.952934 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9990406397098347, 'loss_val': 0.37926441114070925, 'psi': 0.8201152968992202}-{'f1_val': 0.42198931843839965, 'auprc': 0.999879733682266, 'loss_val': 0.6145950477121519, 'psi': 0.6531454845359462}
[S4] START round=6 head_norm_before_train=1.278788 (no previous merge yet)
[S4] round=6 local utility u=0.150344 metrics={'f1_val': 0.4107016937200819, 'auprc': 0.7855282834173201, 'loss_val': 0.9066587317101688, 'psi': 0.5606323295989772}-{'f1_val': 0.3944221707041827, 'auprc': 0.7674052894240946, 'loss_val': 1.0553004559079342, 'psi': 0.5436154181921474}
[S5] START round=6 head_norm_before_train=1.000267 cos_to_last_merge=0.9547 (last merge round=1)
[S5] round=6 local utility u=0.075969 metrics={'f1_val': 0.4183544144322735, 'auprc': 0.7774917043927655, 'loss_val': 0.8377934049058453, 'psi': 0.5620093304164703}-{'f1_val': 0.4177505557824055, 'auprc': 0.7742023197224008, 'loss_val': 0.9762393538782217, 'psi': 0.5603312613584036}
[S6] START round=6 head_norm_before_train=0.885746 cos_to_last_merge=0.9644 (last merge round=1)
[S6] round=6 local utility u=0.240410 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7573934294984359, 'loss_val': 1.1306107986191298, 'psi': 0.3878131410301436}-{'f1_val': 0.14142628205128205, 'auprc': 0.6156014330208128, 'loss_val': 1.1860540949814045, 'psi': 0.33109634243909436}
[S7] START round=6 head_norm_before_train=0.739202 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.393862 metrics={'f1_val': 0.5527391540428332, 'auprc': 0.7940073084827346, 'loss_val': 0.8390945299465614, 'psi': 0.6492464158187938}-{'f1_val': 0.41679099637737954, 'auprc': 0.8046753241944324, 'loss_val': 0.8431337061092384, 'psi': 0.5719447275042007}
[S8] START round=6 head_norm_before_train=0.948022 cos_to_last_merge=0.9981 (last merge round=4)
[S8] round=6 local utility u=0.907593 metrics={'f1_val': 0.4156929677121941, 'auprc': 0.7861112800792581, 'loss_val': 1.0875123485138847, 'psi': 0.5638602926590197}-{'f1_val': 0.13995598239295717, 'auprc': 0.7666468594345044, 'loss_val': 1.1898837975329042, 'psi': 0.3906323332095761}
[S9] START round=6 head_norm_before_train=0.852867 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9985884054442359, 'loss_val': 0.44982293790088873, 'psi': 0.8201653106417055}-{'f1_val': 0.4371667528122887, 'auprc': 0.8657862599407069, 'loss_val': 0.6183181309647813, 'psi': 0.608614555663656}
[S10] START round=6 head_norm_before_train=1.340134 (no previous merge yet)
[S10] round=6 local utility u=0.159662 metrics={'f1_val': 0.43190400963357745, 'auprc': 0.6646051611559669, 'loss_val': 0.8938444859829978, 'psi': 0.5249844702425333}-{'f1_val': 0.41615846728099787, 'auprc': 0.6558520374052138, 'loss_val': 1.092435730213082, 'psi': 0.5120358953306843}
[S11] START round=6 head_norm_before_train=0.841965 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.858071 metrics={'f1_val': 0.41567515922599385, 'auprc': 0.6660504192142689, 'loss_val': 1.0183760657002987, 'psi': 0.5158252632213038}-{'f1_val': 0.14041368337311058, 'auprc': 0.665735659216744, 'loss_val': 1.0820051550052643, 'psi': 0.35054247371056396}
[S13] START round=6 head_norm_before_train=0.800520 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5681419832863474, 'loss_val': 1.223395177854127, 'psi': 0.3114882508607708}-{'f1_val': 0.1403857625770531, 'auprc': 0.6187906257096746, 'loss_val': 1.1897439294929155, 'psi': 0.3317477078301017}
[S14] START round=6 head_norm_before_train=1.293733 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6968184295128765, 'loss_val': 1.146612015302753, 'psi': 0.36294208353477286}-{'f1_val': 0.14035785288270378, 'auprc': 0.7341013443731343, 'loss_val': 1.2263009835543217, 'psi': 0.377855249478876}
[S15] START round=6 head_norm_before_train=0.923993 cos_to_last_merge=0.9937 (last merge round=3)
[S15] round=6 local utility u=0.031481 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770424453077527, 'loss_val': 1.164346132280016, 'psi': 0.3946571689400361}-{'f1_val': 0.13973365136155833, 'auprc': 0.7767209610933554, 'loss_val': 1.2263435500574988, 'psi': 0.3945285752542772}
[S16] START round=6 head_norm_before_train=0.901785 cos_to_last_merge=0.9634 (last merge round=1)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.3849512420002099, 'auprc': 0.5749291187744021, 'loss_val': 0.9607459610634097, 'psi': 0.4609423927098868}-{'f1_val': 0.41526982732562534, 'auprc': 0.5980048899231161, 'loss_val': 1.0824200323226363, 'psi': 0.48836385236462165}
[S17] START round=6 head_norm_before_train=0.613779 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.772223 metrics={'f1_val': 0.38658735517174114, 'auprc': 0.5577917187604389, 'loss_val': 1.0704976293546555, 'psi': 0.4550691006072203}-{'f1_val': 0.14094896331738438, 'auprc': 0.5531247322501197, 'loss_val': 1.1271129922270213, 'psi': 0.30581927089047856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61015
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.395)
[S9] not sending this round → trigger blocked (psi=0.820)
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:61014
[S7] not sending this round → trigger blocked (psi=0.649)
[S6] not sending this round → trigger blocked (psi=0.388)
[S3] not sending this round → trigger blocked (psi=0.820)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.516)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:61009
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=-0.0612
[S14] DROPPED delta from S10 (cos=-0.0612 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S2
[S8] cosine check vs S2: cos=0.7137
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.4984
[S8] RECEIVED delta(kind=head bytes=1798) from S4
[S8] cosine check vs S4: cos=-0.0791
[S8] DROPPED delta from S4 (cos=-0.0791 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.455)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.1397 head_norm=0.960659
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.866963e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.1397 head_norm=0.841055 delta_norm=0.486696
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.4157 head_norm=0.982664
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.377935e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.4157 head_norm=1.031112 delta_norm=0.437793
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.242611 (no previous merge yet)
[S2] round=7 local utility u=0.053094 metrics={'f1_val': 0.41710880107850823, 'auprc': 0.7756965659620946, 'loss_val': 0.9355357620478559, 'psi': 0.5605439070319427}-{'f1_val': 0.41668780995073934, 'auprc': 0.778149576158178, 'loss_val': 1.0465560288634173, 'psi': 0.5612725164337148}
[S3] START round=7 head_norm_before_train=1.504043 (no previous merge yet)
[S3] round=7 local utility u=0.029373 metrics={'f1_val': 0.7003264167718803, 'auprc': 0.9995811028947356, 'loss_val': 0.319108351944917, 'psi': 0.8200282912210224}-{'f1_val': 0.7008317350254774, 'auprc': 0.9990406397098347, 'loss_val': 0.37926441114070925, 'psi': 0.8201152968992202}
[S4] START round=7 head_norm_before_train=1.310881 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.37405120010447307, 'auprc': 0.664370289638596, 'loss_val': 0.7549454172266078, 'psi': 0.4901788359181222}-{'f1_val': 0.4107016937200819, 'auprc': 0.7855282834173201, 'loss_val': 0.9066587317101688, 'psi': 0.5606323295989772}
[S5] START round=7 head_norm_before_train=1.049414 cos_to_last_merge=0.9302 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.930
[S5] round=7 local utility u=0.186358 metrics={'f1_val': 0.4209294729246674, 'auprc': 0.8508869622147367, 'loss_val': 0.7007131019139703, 'psi': 0.5929124686406951}-{'f1_val': 0.4183544144322735, 'auprc': 0.7774917043927655, 'loss_val': 0.8377934049058453, 'psi': 0.5620093304164703}
[S6] START round=7 head_norm_before_train=0.907176 cos_to_last_merge=0.9561 (last merge round=1)
[S6] round=7 local utility u=0.893419 metrics={'f1_val': 0.41605123052148413, 'auprc': 0.7686412030844079, 'loss_val': 1.0252648437788936, 'psi': 0.5570872195466536}-{'f1_val': 0.14142628205128205, 'auprc': 0.7573934294984359, 'loss_val': 1.1306107986191298, 'psi': 0.3878131410301436}
[S7] START round=7 head_norm_before_train=0.802175 cos_to_last_merge=0.9859 (last merge round=5)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.41650694526510673, 'auprc': 0.7846067518959969, 'loss_val': 0.8210668478252807, 'psi': 0.5637468679174629}-{'f1_val': 0.5527391540428332, 'auprc': 0.7940073084827346, 'loss_val': 0.8390945299465614, 'psi': 0.6492464158187938}
[S8] START round=7 head_norm_before_train=1.031112 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.931185 metrics={'f1_val': 0.7145254456069222, 'auprc': 0.79409795672911, 'loss_val': 1.0420974994046157, 'psi': 0.7463544500557974}-{'f1_val': 0.4156929677121941, 'auprc': 0.7861112800792581, 'loss_val': 1.0875123485138847, 'psi': 0.5638602926590197}
[S9] START round=7 head_norm_before_train=0.957684 cos_to_last_merge=0.9883 (last merge round=5)
[S9] round=7 local utility u=0.080923 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981755049135217, 'loss_val': 0.2867377953628582, 'psi': 0.8200001504294199}-{'f1_val': 0.7012165807733519, 'auprc': 0.9985884054442359, 'loss_val': 0.44982293790088873, 'psi': 0.8201653106417055}
[S10] START round=7 head_norm_before_train=1.382997 (no previous merge yet)
[S10] round=7 local utility u=1.000000 metrics={'f1_val': 0.623018028214242, 'auprc': 0.9859505601618239, 'loss_val': 0.6865587440897182, 'psi': 0.7681910409932748}-{'f1_val': 0.43190400963357745, 'auprc': 0.6646051611559669, 'loss_val': 0.8938444859829978, 'psi': 0.5249844702425333}
[S11] START round=7 head_norm_before_train=0.876370 cos_to_last_merge=0.9954 (last merge round=5)
[S11] round=7 local utility u=0.511264 metrics={'f1_val': 0.3964515026091945, 'auprc': 0.9969858501388974, 'loss_val': 0.8733123735703536, 'psi': 0.6366652416210756}-{'f1_val': 0.41567515922599385, 'auprc': 0.6660504192142689, 'loss_val': 1.0183760657002987, 'psi': 0.5158252632213038}
[S13] START round=7 head_norm_before_train=0.821478 cos_to_last_merge=0.9985 (last merge round=5)
[S13] round=7 local utility u=0.867352 metrics={'f1_val': 0.4152892684755862, 'auprc': 0.5677198731809546, 'loss_val': 1.1368461815035564, 'psi': 0.47626151035773356}-{'f1_val': 0.1403857625770531, 'auprc': 0.5681419832863474, 'loss_val': 1.223395177854127, 'psi': 0.3114882508607708}
[S14] START round=7 head_norm_before_train=1.330267 (no previous merge yet)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.39629970208074317, 'auprc': 0.8118718774713447, 'loss_val': 1.0149161266885625, 'psi': 0.5625285722369837}-{'f1_val': 0.14035785288270378, 'auprc': 0.6968184295128765, 'loss_val': 1.146612015302753, 'psi': 0.36294208353477286}
[S15] START round=7 head_norm_before_train=0.841055 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.175520 metrics={'f1_val': 0.19093719088915, 'auprc': 0.7770499190219902, 'loss_val': 1.1205503033008528, 'psi': 0.42538228214228613}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770424453077527, 'loss_val': 1.164346132280016, 'psi': 0.3946571689400361}
[S16] START round=7 head_norm_before_train=0.947294 cos_to_last_merge=0.9464 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.946
[S16] round=7 local utility u=0.274832 metrics={'f1_val': 0.38341139873784935, 'auprc': 0.7433380264939421, 'loss_val': 0.9070705619703414, 'psi': 0.5273820498402865}-{'f1_val': 0.3849512420002099, 'auprc': 0.5749291187744021, 'loss_val': 0.9607459610634097, 'psi': 0.4609423927098868}
[S17] START round=7 head_norm_before_train=0.658107 cos_to_last_merge=0.9928 (last merge round=5)
[S17] round=7 local utility u=0.138582 metrics={'f1_val': 0.39214610316493337, 'auprc': 0.6095722168365976, 'loss_val': 0.9820275484476795, 'psi': 0.47911654863359904}-{'f1_val': 0.38658735517174114, 'auprc': 0.5577917187604389, 'loss_val': 1.0704976293546555, 'psi': 0.4550691006072203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:61010
[S8] not sending this round → trigger blocked (psi=0.746)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[S2] not sending this round → trigger blocked (psi=0.561)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:61008
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61012
[S10] not sending this round → trigger blocked (psi=0.768)
[S6] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S6
[S17] cosine check vs S6: cos=0.3185
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=-0.0333
[S8] DROPPED delta from S14 (cos=-0.0333 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] cosine check vs S11: cos=-0.0408
[S8] DROPPED delta from S11 (cos=-0.0408 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1791) from S16
[S7] cosine check vs S16: cos=0.8181
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] cosine check vs S3: cos=0.8007
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=0.2831
[S9] RECEIVED delta(kind=head bytes=1794) from S15
[S9] cosine check vs S15: cos=0.5306
[S17] RECEIVED delta(kind=head bytes=1792) from S9
[S17] cosine check vs S9: cos=0.4136
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=0.2356
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1791 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1791) from S17
[S13] cosine check vs S17: cos=0.5261
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.4165 head_norm=0.870459
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.225729e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.4165 head_norm=0.739763 delta_norm=0.322573
[S7] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7012 head_norm=1.078510
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.816607e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.9844 head_norm=0.856374 delta_norm=0.481661
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4153 head_norm=0.861659
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.894517e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4129 head_norm=0.690559 delta_norm=0.389452
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3965 head_norm=0.923118
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.018168e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3965 head_norm=0.903849 delta_norm=0.301817
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3921 head_norm=0.717380
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.521386e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3923 head_norm=0.626267 delta_norm=0.352139
[S17] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.271282 (no previous merge yet)
[S2] round=8 local utility u=0.468467 metrics={'f1_val': 0.5527521987677002, 'auprc': 0.7772380818458045, 'loss_val': 0.8170875525241715, 'psi': 0.642546551998942}-{'f1_val': 0.41710880107850823, 'auprc': 0.7756965659620946, 'loss_val': 0.9355357620478559, 'psi': 0.5605439070319427}
[S3] START round=8 head_norm_before_train=1.569454 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.6417399436800648, 'auprc': 0.9871176154832983, 'loss_val': 0.4115397536928893, 'psi': 0.7798910124013583}-{'f1_val': 0.7003264167718803, 'auprc': 0.9995811028947356, 'loss_val': 0.319108351944917, 'psi': 0.8200282912210224}
[S4] START round=8 head_norm_before_train=1.349044 (no previous merge yet)
[S4] round=8 local utility u=0.074888 metrics={'f1_val': 0.3807539433751021, 'auprc': 0.6739885564124201, 'loss_val': 0.6742405408455194, 'psi': 0.4980477885900293}-{'f1_val': 0.37405120010447307, 'auprc': 0.664370289638596, 'loss_val': 0.7549454172266078, 'psi': 0.4901788359181222}
[S5] START round=8 head_norm_before_train=1.116231 cos_to_last_merge=0.9049 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.905
[S5] round=8 local utility u=0.812268 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.785962066467419, 'loss_val': 0.5609663495771243, 'psi': 0.7348989966764868}-{'f1_val': 0.4209294729246674, 'auprc': 0.8508869622147367, 'loss_val': 0.7007131019139703, 'psi': 0.5929124686406951}
[S6] START round=8 head_norm_before_train=0.947212 cos_to_last_merge=0.9430 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.943
[S6] round=8 local utility u=0.048587 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.7714426200280936, 'loss_val': 0.9425217169396013, 'psi': 0.5588104707357578}-{'f1_val': 0.41605123052148413, 'auprc': 0.7686412030844079, 'loss_val': 1.0252648437788936, 'psi': 0.5570872195466536}
[S7] START round=8 head_norm_before_train=0.739763 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.490784 metrics={'f1_val': 0.5763426356406185, 'auprc': 0.7919862621936793, 'loss_val': 0.8206515568738825, 'psi': 0.6626000862618429}-{'f1_val': 0.41650694526510673, 'auprc': 0.7846067518959969, 'loss_val': 0.8210668478252807, 'psi': 0.5637468679174629}
[S8] START round=8 head_norm_before_train=1.061550 cos_to_last_merge=0.9975 (last merge round=6)
[S8] round=8 local utility u=0.080628 metrics={'f1_val': 0.714331594236135, 'auprc': 0.7883565855681549, 'loss_val': 0.8624542149645655, 'psi': 0.7439415907689431}-{'f1_val': 0.7145254456069222, 'auprc': 0.79409795672911, 'loss_val': 1.0420974994046157, 'psi': 0.7463544500557974}
[S9] START round=8 head_norm_before_train=0.856374 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.850340 metrics={'f1_val': 0.9916448056378947, 'auprc': 0.9977936771549822, 'loss_val': 0.32748144072776186, 'psi': 0.9941043542447296}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981755049135217, 'loss_val': 0.2867377953628582, 'psi': 0.8200001504294199}
[S10] START round=8 head_norm_before_train=1.434107 (no previous merge yet)
[S10] round=8 local utility u=0.271978 metrics={'f1_val': 0.687037760494198, 'auprc': 0.9957584984888891, 'loss_val': 0.5561446262300792, 'psi': 0.8105260556920744}-{'f1_val': 0.623018028214242, 'auprc': 0.9859505601618239, 'loss_val': 0.6865587440897182, 'psi': 0.7681910409932748}
[S11] START round=8 head_norm_before_train=0.903849 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.392021407222874, 'auprc': 0.9875997117011118, 'loss_val': 0.8267627042871052, 'psi': 0.6302527290141692}-{'f1_val': 0.3964515026091945, 'auprc': 0.9969858501388974, 'loss_val': 0.8733123735703536, 'psi': 0.6366652416210756}
[S13] START round=8 head_norm_before_train=0.690559 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.035846 metrics={'f1_val': 0.4156839344320697, 'auprc': 0.5783626640281988, 'loss_val': 1.099450235395964, 'psi': 0.48075542627052137}-{'f1_val': 0.4152892684755862, 'auprc': 0.5677198731809546, 'loss_val': 1.1368461815035564, 'psi': 0.47626151035773356}
[S14] START round=8 head_norm_before_train=1.368555 (no previous merge yet)
[S14] round=8 local utility u=0.550184 metrics={'f1_val': 0.523906265133253, 'auprc': 0.8488580794829854, 'loss_val': 0.7911453953369803, 'psi': 0.653886990873146}-{'f1_val': 0.39629970208074317, 'auprc': 0.8118718774713447, 'loss_val': 1.0149161266885625, 'psi': 0.5625285722369837}
[S15] START round=8 head_norm_before_train=0.876108 cos_to_last_merge=0.9970 (last merge round=6)
[S15] round=8 local utility u=0.755940 metrics={'f1_val': 0.41846246937249143, 'auprc': 0.7770504968363304, 'loss_val': 0.9738239486108344, 'psi': 0.5618976803580271}-{'f1_val': 0.19093719088915, 'auprc': 0.7770499190219902, 'loss_val': 1.1205503033008528, 'psi': 0.42538228214228613}
[S16] START round=8 head_norm_before_train=0.996515 cos_to_last_merge=0.9283 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=8 local utility u=0.112216 metrics={'f1_val': 0.393271628345738, 'auprc': 0.7780417593118094, 'loss_val': 0.8459117669578489, 'psi': 0.5471796807321665}-{'f1_val': 0.38341139873784935, 'auprc': 0.7433380264939421, 'loss_val': 0.9070705619703414, 'psi': 0.5273820498402865}
[S17] START round=8 head_norm_before_train=0.626267 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.265974 metrics={'f1_val': 0.38189873302075106, 'auprc': 0.8065425008788984, 'loss_val': 0.9795066223718838, 'psi': 0.55175624016401}-{'f1_val': 0.39214610316493337, 'auprc': 0.6095722168365976, 'loss_val': 0.9820275484476795, 'psi': 0.47911654863359904}
[S15] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:61015
[S9] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:61017
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:61014
[S5] not sending this round → trigger blocked (psi=0.735)
[S6] not sending this round → trigger blocked (psi=0.559)
[S13] not sending this round → trigger blocked (psi=0.481)
[S14] not sending this round → trigger blocked (psi=0.654)
[S16] not sending this round → trigger blocked (psi=0.547)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=-0.0519
[S14] DROPPED delta from S10 (cos=-0.0519 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] cosine check vs S7: cos=0.6538
[S8] RECEIVED delta(kind=head bytes=1794) from S4
[S8] cosine check vs S4: cos=-0.0970
[S8] DROPPED delta from S4 (cos=-0.0970 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1789) from S2
[S8] cosine check vs S2: cos=0.8976
[S15] RECEIVED delta(kind=head bytes=1790) from S8
[S15] cosine check vs S8: cos=0.6849
[S17] not sending this round → trigger blocked (psi=0.552)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.4185 head_norm=0.918763
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.111857e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.6966 head_norm=0.930374 delta_norm=0.411186
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.7143 head_norm=1.106894
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.900622e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.6813 head_norm=1.176054 delta_norm=0.290062
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.681 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3819 head_norm=0.678951
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.081083e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3666 head_norm=0.665562 delta_norm=0.308108
[S17] aggregate: ROLLBACK (f1_val pre=0.382 post=0.367 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=1.307388 (no previous merge yet)
[S2] round=9 local utility u=0.533339 metrics={'f1_val': 0.7040112690503564, 'auprc': 0.7777761292244453, 'loss_val': 0.6595782041973338, 'psi': 0.733517213119992}-{'f1_val': 0.5527521987677002, 'auprc': 0.7772380818458045, 'loss_val': 0.8170875525241715, 'psi': 0.642546551998942}
[S3] START round=9 head_norm_before_train=1.621041 (no previous merge yet)
[S3] round=9 local utility u=0.257728 metrics={'f1_val': 0.7005859652789095, 'auprc': 0.997108911279511, 'loss_val': 0.27913311398764235, 'psi': 0.81919514367915}-{'f1_val': 0.6417399436800648, 'auprc': 0.9871176154832983, 'loss_val': 0.4115397536928893, 'psi': 0.7798910124013583}
[S4] START round=9 head_norm_before_train=1.391909 (no previous merge yet)
[S4] round=9 local utility u=0.932981 metrics={'f1_val': 0.6672749350138345, 'auprc': 0.6879188525327304, 'loss_val': 0.5691956682787546, 'psi': 0.6755325020213929}-{'f1_val': 0.3807539433751021, 'auprc': 0.6739885564124201, 'loss_val': 0.6742405408455194, 'psi': 0.4980477885900293}
[S5] START round=9 head_norm_before_train=1.189746 cos_to_last_merge=0.8852 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.885
[S5] round=9 local utility u=0.100030 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.796066828658081, 'loss_val': 0.39122007227346084, 'psi': 0.7389409015527517}-{'f1_val': 0.7008569501491988, 'auprc': 0.785962066467419, 'loss_val': 0.5609663495771243, 'psi': 0.7348989966764868}
[S6] START round=9 head_norm_before_train=0.992809 cos_to_last_merge=0.9287 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.929
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.37186966235495067, 'auprc': 0.6654964432874914, 'loss_val': 0.8076633985068564, 'psi': 0.48932037472796697}-{'f1_val': 0.41705570454086727, 'auprc': 0.7714426200280936, 'loss_val': 0.9425217169396013, 'psi': 0.5588104707357578}
[S7] START round=9 head_norm_before_train=0.784112 cos_to_last_merge=0.9946 (last merge round=7)
[S7] round=9 local utility u=0.570024 metrics={'f1_val': 0.7139737313795297, 'auprc': 0.8748176481048515, 'loss_val': 0.7548833335197236, 'psi': 0.7783112980696585}-{'f1_val': 0.5763426356406185, 'auprc': 0.7919862621936793, 'loss_val': 0.8206515568738825, 'psi': 0.6626000862618429}
[S8] START round=9 head_norm_before_train=1.176054 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.096550 metrics={'f1_val': 0.713916700902738, 'auprc': 0.806250374578104, 'loss_val': 0.7205467177042181, 'psi': 0.7508501703728845}-{'f1_val': 0.714331594236135, 'auprc': 0.7883565855681549, 'loss_val': 0.8624542149645655, 'psi': 0.7439415907689431}
[S9] START round=9 head_norm_before_train=0.955648 cos_to_last_merge=0.9904 (last merge round=7)
[S9] round=9 local utility u=0.046554 metrics={'f1_val': 0.9878214512971564, 'auprc': 0.9976395683232275, 'loss_val': 0.21097064625300205, 'psi': 0.9917486981075848}-{'f1_val': 0.9916448056378947, 'auprc': 0.9977936771549822, 'loss_val': 0.32748144072776186, 'psi': 0.9941043542447296}
[S10] START round=9 head_norm_before_train=1.483280 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.6680530703250729, 'auprc': 0.9846983386054946, 'loss_val': 0.4737938998923234, 'psi': 0.7947111776372415}-{'f1_val': 0.687037760494198, 'auprc': 0.9957584984888891, 'loss_val': 0.5561446262300792, 'psi': 0.8105260556920744}
[S11] START round=9 head_norm_before_train=0.945379 cos_to_last_merge=0.9949 (last merge round=7)
[S11] round=9 local utility u=0.041045 metrics={'f1_val': 0.3998848669786352, 'auprc': 0.9784794654537291, 'loss_val': 0.7644917289285518, 'psi': 0.6313227063686728}-{'f1_val': 0.392021407222874, 'auprc': 0.9875997117011118, 'loss_val': 0.8267627042871052, 'psi': 0.6302527290141692}
[S13] START round=9 head_norm_before_train=0.731773 cos_to_last_merge=0.9941 (last merge round=7)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.4161203556905605, 'auprc': 0.5204234082601935, 'loss_val': 1.040620327912353, 'psi': 0.45784157671841375}-{'f1_val': 0.4156839344320697, 'auprc': 0.5783626640281988, 'loss_val': 1.099450235395964, 'psi': 0.48075542627052137}
[S14] START round=9 head_norm_before_train=1.416683 (no previous merge yet)
[S14] round=9 local utility u=0.816814 metrics={'f1_val': 0.6975406781311908, 'auprc': 0.9984602396931082, 'loss_val': 0.648129712739407, 'psi': 0.8179085027559577}-{'f1_val': 0.523906265133253, 'auprc': 0.8488580794829854, 'loss_val': 0.7911453953369803, 'psi': 0.653886990873146}
[S15] START round=9 head_norm_before_train=0.930374 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.944447 metrics={'f1_val': 0.7155217019188683, 'auprc': 0.777190386262124, 'loss_val': 0.8677051897736139, 'psi': 0.7401891756561706}-{'f1_val': 0.41846246937249143, 'auprc': 0.7770504968363304, 'loss_val': 0.9738239486108344, 'psi': 0.5618976803580271}
[S16] START round=9 head_norm_before_train=1.038559 cos_to_last_merge=0.9097 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.910
[S16] round=9 local utility u=0.126508 metrics={'f1_val': 0.4368340395179678, 'auprc': 0.7629682375629998, 'loss_val': 0.8090502923637684, 'psi': 0.5672877187359806}-{'f1_val': 0.393271628345738, 'auprc': 0.7780417593118094, 'loss_val': 0.8459117669578489, 'psi': 0.5471796807321665}
[S17] START round=9 head_norm_before_train=0.665562 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.010488 metrics={'f1_val': 0.35699822727232206, 'auprc': 0.843267681870248, 'loss_val': 0.9193032951376378, 'psi': 0.5515060091114925}-{'f1_val': 0.38189873302075106, 'auprc': 0.8065425008788984, 'loss_val': 0.9795066223718838, 'psi': 0.55175624016401}
[S8] not sending this round → trigger blocked (psi=0.751)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61012
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[S4] not sending this round → trigger blocked (psi=0.676)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[S2] not sending this round → trigger blocked (psi=0.734)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61008
[S7] not sending this round → trigger blocked (psi=0.778)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:61017
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=0.8223
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] cosine check vs S14: cos=-0.0280
[S8] DROPPED delta from S14 (cos=-0.0280 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S11
[S8] cosine check vs S11: cos=-0.0546
[S8] DROPPED delta from S11 (cos=-0.0546 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S3
[S11] cosine check vs S3: cos=0.8097
[S9] RECEIVED delta(kind=head bytes=1802) from S15
[S9] cosine check vs S15: cos=0.5954
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] cosine check vs S5: cos=0.4343
[S17] RECEIVED delta(kind=head bytes=1793) from S9
[S17] cosine check vs S9: cos=0.4079
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S17
[S13] cosine check vs S17: cos=0.7332
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.4161 head_norm=0.775717
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.751784e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.4161 head_norm=0.698926 delta_norm=0.275178
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.7140 head_norm=0.830513
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.078221e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.6118 head_norm=0.911316 delta_norm=0.307822
[S7] aggregate: ROLLBACK (f1_val pre=0.714 post=0.612 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.9878 head_norm=1.062988
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.588622e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.9895 head_norm=0.907557 delta_norm=0.458862
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.3999 head_norm=0.998073
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.484334e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.4006 head_norm=1.002557 delta_norm=0.248433
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3570 head_norm=0.725744
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.067835e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3554 head_norm=0.755972 delta_norm=0.506783
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.350204 (no previous merge yet)
[S2] round=10 local utility u=0.108805 metrics={'f1_val': 0.7103880354741633, 'auprc': 0.7924333245934732, 'loss_val': 0.5242006611842148, 'psi': 0.7432061511218873}-{'f1_val': 0.7040112690503564, 'auprc': 0.7777761292244453, 'loss_val': 0.6595782041973338, 'psi': 0.733517213119992}
[S3] START round=10 head_norm_before_train=1.661126 (no previous merge yet)
[S3] round=10 local utility u=0.024368 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9997817078218023, 'loss_val': 0.23943761132643732, 'psi': 0.8203664053699007}-{'f1_val': 0.7005859652789095, 'auprc': 0.997108911279511, 'loss_val': 0.27913311398764235, 'psi': 0.81919514367915}
[S4] START round=10 head_norm_before_train=1.444224 (no previous merge yet)
[S4] round=10 local utility u=0.137731 metrics={'f1_val': 0.6775090187825852, 'auprc': 0.726220142112073, 'loss_val': 0.47004150759874835, 'psi': 0.6969934681143803}-{'f1_val': 0.6672749350138345, 'auprc': 0.6879188525327304, 'loss_val': 0.5691956682787546, 'psi': 0.6755325020213929}
[S5] START round=10 head_norm_before_train=1.255863 cos_to_last_merge=0.8672 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.867
[S5] round=10 local utility u=0.099176 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.8451929637499874, 'loss_val': 0.3402434693762125, 'psi': 0.7585909790359215}-{'f1_val': 0.7008569501491988, 'auprc': 0.796066828658081, 'loss_val': 0.39122007227346084, 'psi': 0.7389409015527517}
[S6] START round=10 head_norm_before_train=1.031199 cos_to_last_merge=0.9151 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.915
[S6] round=10 local utility u=0.429746 metrics={'f1_val': 0.45644688832930774, 'auprc': 0.7749004019409809, 'loss_val': 0.7838470835146851, 'psi': 0.5838282937739769}-{'f1_val': 0.37186966235495067, 'auprc': 0.6654964432874914, 'loss_val': 0.8076633985068564, 'psi': 0.48932037472796697}
[S7] START round=10 head_norm_before_train=0.911316 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.185344 metrics={'f1_val': 0.7139737313795297, 'auprc': 0.9638708186407376, 'loss_val': 0.6513558195702103, 'psi': 0.8139325662840129}-{'f1_val': 0.7139737313795297, 'auprc': 0.8748176481048515, 'loss_val': 0.7548833335197236, 'psi': 0.7783112980696585}
[S8] START round=10 head_norm_before_train=1.218115 cos_to_last_merge=0.9969 (last merge round=8)
[S8] round=10 local utility u=0.392123 metrics={'f1_val': 0.710886176727743, 'auprc': 0.997769087295167, 'loss_val': 0.492674456984164, 'psi': 0.8256393409547127}-{'f1_val': 0.713916700902738, 'auprc': 0.806250374578104, 'loss_val': 0.7205467177042181, 'psi': 0.7508501703728845}
[S9] START round=10 head_norm_before_train=0.907557 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.003072 metrics={'f1_val': 0.9958312226609984, 'auprc': 0.9978002604008701, 'loss_val': 0.2533676918393766, 'psi': 0.996618837756947}-{'f1_val': 0.9878214512971564, 'auprc': 0.9976395683232275, 'loss_val': 0.21097064625300205, 'psi': 0.9917486981075848}
[S10] START round=10 head_norm_before_train=1.525189 (no previous merge yet)
[S10] round=10 local utility u=0.148973 metrics={'f1_val': 0.7014667009264342, 'auprc': 0.9854301929614773, 'loss_val': 0.3785245226404838, 'psi': 0.8150520977404514}-{'f1_val': 0.6680530703250729, 'auprc': 0.9846983386054946, 'loss_val': 0.4737938998923234, 'psi': 0.7947111776372415}
[S11] START round=10 head_norm_before_train=1.002557 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.4005844218082196, 'auprc': 0.9402618175313313, 'loss_val': 0.7711495732430688, 'psi': 0.6164553800974644}-{'f1_val': 0.3998848669786352, 'auprc': 0.9784794654537291, 'loss_val': 0.7644917289285518, 'psi': 0.6313227063686728}
[S13] START round=10 head_norm_before_train=0.698926 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.46539425396530726, 'loss_val': 1.0315595731198142, 'psi': 0.4357600213456}-{'f1_val': 0.4161203556905605, 'auprc': 0.5204234082601935, 'loss_val': 1.040620327912353, 'psi': 0.45784157671841375}
[S14] START round=10 head_norm_before_train=1.466082 (no previous merge yet)
[S14] round=10 local utility u=0.138879 metrics={'f1_val': 0.7015782525941663, 'auprc': 0.9996121439371655, 'loss_val': 0.39805206080526845, 'psi': 0.820791809131366}-{'f1_val': 0.6975406781311908, 'auprc': 0.9984602396931082, 'loss_val': 0.648129712739407, 'psi': 0.8179085027559577}
[S15] START round=10 head_norm_before_train=0.968754 cos_to_last_merge=0.9956 (last merge round=8)
[S15] round=10 local utility u=0.056517 metrics={'f1_val': 0.6999820938233587, 'auprc': 0.7952420180612666, 'loss_val': 0.7155885148238575, 'psi': 0.7380860635185219}-{'f1_val': 0.7155217019188683, 'auprc': 0.777190386262124, 'loss_val': 0.8677051897736139, 'psi': 0.7401891756561706}
[S16] START round=10 head_norm_before_train=1.077382 cos_to_last_merge=0.8929 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.893
[S16] round=10 local utility u=0.260934 metrics={'f1_val': 0.49517628603802205, 'auprc': 0.791186371727711, 'loss_val': 0.721889594555539, 'psi': 0.6135803203138976}-{'f1_val': 0.4368340395179678, 'auprc': 0.7629682375629998, 'loss_val': 0.8090502923637684, 'psi': 0.5672877187359806}
[S17] START round=10 head_norm_before_train=0.755972 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.35391560672066175, 'auprc': 0.563856156256669, 'loss_val': 0.9446343881574618, 'psi': 0.43789182653506464}-{'f1_val': 0.35699822727232206, 'auprc': 0.843267681870248, 'loss_val': 0.9193032951376378, 'psi': 0.5515060091114925}
[S14] not sending this round → trigger blocked (psi=0.821)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61009
[S15] not sending this round → trigger blocked (psi=0.738)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:61009
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:61015
[S16] not sending this round → trigger blocked (psi=0.614)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.820)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.759)
[S8] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=-0.0351
[S14] DROPPED delta from S10 (cos=-0.0351 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S6
[S17] cosine check vs S6: cos=0.1961
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] cosine check vs S7: cos=0.5408
[S8] RECEIVED delta(kind=head bytes=1792) from S4
[S8] cosine check vs S4: cos=-0.1043
[S8] DROPPED delta from S4 (cos=-0.1043 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=0.9379
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] cosine check vs S8: cos=0.8264
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.263 → S8@127.0.0.1:61009
[S5] ⇄ pheromone p=0.338 → S11@127.0.0.1:61012
[S13] ⇄ pheromone p=0.207 → S7@127.0.0.1:61008
[S3] ⇄ pheromone p=0.291 → S11@127.0.0.1:61012
[S14] ⇄ pheromone p=0.480 → S8@127.0.0.1:61009
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.7000 head_norm=1.019395
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.575120e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.6938 head_norm=1.093907 delta_norm=0.357512
[S15] aggregate: ROLLBACK (f1_val pre=0.700 post=0.694 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.391 → S9@127.0.0.1:61010
[S9] ⇄ pheromone p=0.394 → S17@127.0.0.1:61017
[S4] ⇄ pheromone p=0.363 → S8@127.0.0.1:61009
[S7] ⇄ pheromone p=0.391 → S17@127.0.0.1:61017
[S10] ⇄ pheromone p=0.357 → S14@127.0.0.1:61014
[S2] ⇄ pheromone p=0.370 → S8@127.0.0.1:61009
[S6] ⇄ pheromone p=0.313 → S17@127.0.0.1:61017
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.7109 head_norm=1.268751
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.436896e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.7115 head_norm=1.313130 delta_norm=0.243690
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.384 → S15@127.0.0.1:61015
[S16] ⇄ pheromone p=0.280 → S7@127.0.0.1:61008
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3539 head_norm=0.805985
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.546105e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3536 head_norm=0.707820 delta_norm=0.454611
[S17] aggregate: ACCEPT kept=['S6', 'S7'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.234 → S13@127.0.0.1:61013
[S2] START round=11 head_norm_before_train=1.399164 (no previous merge yet)
[S2] round=11 local utility u=0.316063 metrics={'f1_val': 0.7008717589696155, 'auprc': 0.9775748138512222, 'loss_val': 0.3904008194709516, 'psi': 0.8115529809222582}-{'f1_val': 0.7103880354741633, 'auprc': 0.7924333245934732, 'loss_val': 0.5242006611842148, 'psi': 0.7432061511218873}
[S3] START round=11 head_norm_before_train=1.694716 (no previous merge yet)
[S3] round=11 local utility u=0.013965 metrics={'f1_val': 0.701340830449827, 'auprc': 1.0, 'loss_val': 0.21567006175393252, 'psi': 0.8208044982698962}-{'f1_val': 0.7007562037352997, 'auprc': 0.9997817078218023, 'loss_val': 0.23943761132643732, 'psi': 0.8203664053699007}
[S4] START round=11 head_norm_before_train=1.496923 (no previous merge yet)
[S4] round=11 local utility u=0.111330 metrics={'f1_val': 0.6681055263949885, 'auprc': 0.8024138005057424, 'loss_val': 0.41954156675201953, 'psi': 0.7218288360392902}-{'f1_val': 0.6775090187825852, 'auprc': 0.726220142112073, 'loss_val': 0.47004150759874835, 'psi': 0.6969934681143803}
[S5] START round=11 head_norm_before_train=1.308197 cos_to_last_merge=0.8541 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.854
[S5] round=11 local utility u=0.174084 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9538239502029137, 'loss_val': 0.3164808424555843, 'psi': 0.8018946156787701}-{'f1_val': 0.7008563225598777, 'auprc': 0.8451929637499874, 'loss_val': 0.3402434693762125, 'psi': 0.7585909790359215}
[S6] START round=11 head_norm_before_train=1.076685 cos_to_last_merge=0.8987 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.899
[S6] round=11 local utility u=0.741374 metrics={'f1_val': 0.6656483462815961, 'auprc': 0.7955681805076327, 'loss_val': 0.6183112576868526, 'psi': 0.7176162799720107}-{'f1_val': 0.45644688832930774, 'auprc': 0.7749004019409809, 'loss_val': 0.7838470835146851, 'psi': 0.5838282937739769}
[S7] START round=11 head_norm_before_train=0.960116 cos_to_last_merge=0.9964 (last merge round=9)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.7139068610123107, 'auprc': 0.8588053946904557, 'loss_val': 0.6227361786715354, 'psi': 0.7718662744835687}-{'f1_val': 0.7139737313795297, 'auprc': 0.9638708186407376, 'loss_val': 0.6513558195702103, 'psi': 0.8139325662840129}
[S8] START round=11 head_norm_before_train=1.313130 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.050626 metrics={'f1_val': 0.709063388684925, 'auprc': 0.9975993561611505, 'loss_val': 0.3799761331661935, 'psi': 0.8244777756754152}-{'f1_val': 0.710886176727743, 'auprc': 0.997769087295167, 'loss_val': 0.492674456984164, 'psi': 0.8256393409547127}
[S9] START round=11 head_norm_before_train=1.011648 cos_to_last_merge=0.9891 (last merge round=9)
[S9] round=11 local utility u=0.055391 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9981817599988496, 'loss_val': 0.14123803952209144, 'psi': 0.9965222035215113}-{'f1_val': 0.9958312226609984, 'auprc': 0.9978002604008701, 'loss_val': 0.2533676918393766, 'psi': 0.996618837756947}
[S10] START round=11 head_norm_before_train=1.564350 (no previous merge yet)
[S10] round=11 local utility u=0.026992 metrics={'f1_val': 0.7014667009264342, 'auprc': 0.9848662671264404, 'loss_val': 0.3228480903648547, 'psi': 0.8148265274064367}-{'f1_val': 0.7014667009264342, 'auprc': 0.9854301929614773, 'loss_val': 0.3785245226404838, 'psi': 0.8150520977404514}
[S11] START round=11 head_norm_before_train=1.044613 cos_to_last_merge=0.9967 (last merge round=9)
[S11] round=11 local utility u=0.139993 metrics={'f1_val': 0.40252731690722093, 'auprc': 0.9835754645425664, 'loss_val': 0.6327613438655865, 'psi': 0.6349465759613592}-{'f1_val': 0.4005844218082196, 'auprc': 0.9402618175313313, 'loss_val': 0.7711495732430688, 'psi': 0.6164553800974644}
[S13] START round=11 head_norm_before_train=0.737572 cos_to_last_merge=0.9931 (last merge round=9)
[S13] round=11 local utility u=0.003585 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.446570937817667, 'loss_val': 0.9667406550645997, 'psi': 0.4281127363184851}-{'f1_val': 0.4160038662657951, 'auprc': 0.46539425396530726, 'loss_val': 1.0315595731198142, 'psi': 0.4357600213456}
[S14] START round=11 head_norm_before_train=1.520354 (no previous merge yet)
[S14] round=11 local utility u=0.047790 metrics={'f1_val': 0.7023047375160051, 'auprc': 0.9996159126030564, 'loss_val': 0.3068422568840964, 'psi': 0.8212292075508256}-{'f1_val': 0.7015782525941663, 'auprc': 0.9996121439371655, 'loss_val': 0.39805206080526845, 'psi': 0.820791809131366}
[S15] START round=11 head_norm_before_train=1.093907 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.035632 metrics={'f1_val': 0.6999381145660017, 'auprc': 0.7850216687383147, 'loss_val': 0.6133986349594559, 'psi': 0.733971536234927}-{'f1_val': 0.6999820938233587, 'auprc': 0.7952420180612666, 'loss_val': 0.7155885148238575, 'psi': 0.7380860635185219}
[S16] START round=11 head_norm_before_train=1.118588 cos_to_last_merge=0.8770 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.877
[S16] round=11 local utility u=0.465061 metrics={'f1_val': 0.5922255235935567, 'auprc': 0.8770966804262488, 'loss_val': 0.6317941776102179, 'psi': 0.7061739863266335}-{'f1_val': 0.49517628603802205, 'auprc': 0.791186371727711, 'loss_val': 0.721889594555539, 'psi': 0.6135803203138976}
[S17] START round=11 head_norm_before_train=0.707820 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.105033 metrics={'f1_val': 0.35317771804322007, 'auprc': 0.6284071459128231, 'loss_val': 0.9237932124587898, 'psi': 0.46326948919106126}-{'f1_val': 0.35391560672066175, 'auprc': 0.563856156256669, 'loss_val': 0.9446343881574618, 'psi': 0.43789182653506464}
[S10] not sending this round → trigger blocked (psi=0.815)
[S4] not sending this round → trigger blocked (psi=0.722)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61012
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.812)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61012
[S6] not sending this round → trigger blocked (psi=0.718)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:61017
[S8] not sending this round → trigger blocked (psi=0.824)
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S16
[S7] cosine check vs S16: cos=0.9161
[S9] RECEIVED delta(kind=head bytes=1794) from S15
[S9] cosine check vs S15: cos=0.6825
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] cosine check vs S9: cos=0.4905
[S7] RECEIVED delta(kind=head bytes=1795) from S13
[S7] cosine check vs S13: cos=0.6433
[S11] RECEIVED delta(kind=head bytes=1796) from S3
[S11] cosine check vs S3: cos=0.8094
[S8] RECEIVED delta(kind=head bytes=1793) from S11
[S8] cosine check vs S11: cos=-0.0653
[S8] DROPPED delta from S11 (cos=-0.0653 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S14
[S8] cosine check vs S14: cos=-0.0170
[S8] DROPPED delta from S14 (cos=-0.0170 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S5
[S11] cosine check vs S5: cos=0.5222
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S17
[S13] cosine check vs S17: cos=0.7453
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.7139 head_norm=0.999644
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.016697e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.7139 head_norm=0.909653 delta_norm=0.201670
[S7] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.4158 head_norm=0.789341
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.775773e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.4158 head_norm=0.726052 delta_norm=0.277577
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.4025 head_norm=1.088010
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.004204e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.4614 head_norm=1.088178 delta_norm=0.200420
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.9954 head_norm=1.127463
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.505539e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.9954 head_norm=1.037224 delta_norm=0.450554
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3532 head_norm=0.765076
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.025602e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3532 head_norm=0.822004 delta_norm=0.502560
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.447126 (no previous merge yet)
[S2] round=12 local utility u=0.065779 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.9945893181422875, 'loss_val': 0.3156476059947631, 'psi': 0.8189348215496524}-{'f1_val': 0.7008717589696155, 'auprc': 0.9775748138512222, 'loss_val': 0.3904008194709516, 'psi': 0.8115529809222582}
[S3] START round=12 head_norm_before_train=1.730320 (no previous merge yet)
[S3] round=12 local utility u=0.011872 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9998789733442018, 'loss_val': 0.18805428198186314, 'psi': 0.8204053115788605}-{'f1_val': 0.701340830449827, 'auprc': 1.0, 'loss_val': 0.21567006175393252, 'psi': 0.8208044982698962}
[S4] START round=12 head_norm_before_train=1.545506 (no previous merge yet)
[S4] round=12 local utility u=0.179690 metrics={'f1_val': 0.6681382446885828, 'auprc': 0.9164443086376353, 'loss_val': 0.4024485057311866, 'psi': 0.7674606702682039}-{'f1_val': 0.6681055263949885, 'auprc': 0.8024138005057424, 'loss_val': 0.41954156675201953, 'psi': 0.7218288360392902}
[S5] START round=12 head_norm_before_train=1.344949 cos_to_last_merge=0.8469 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.847
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8076725802810969, 'loss_val': 0.3136065271307617, 'psi': 0.7434340677100433}-{'f1_val': 0.7006083926626743, 'auprc': 0.9538239502029137, 'loss_val': 0.3164808424555843, 'psi': 0.8018946156787701}
[S6] START round=12 head_norm_before_train=1.117888 cos_to_last_merge=0.8844 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.884
[S6] round=12 local utility u=0.222282 metrics={'f1_val': 0.7106346092761868, 'auprc': 0.8202549216143905, 'loss_val': 0.5177246610874137, 'psi': 0.7544827342114684}-{'f1_val': 0.6656483462815961, 'auprc': 0.7955681805076327, 'loss_val': 0.6183112576868526, 'psi': 0.7176162799720107}
[S7] START round=12 head_norm_before_train=0.909653 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.7139068610123107, 'auprc': 0.8500868381107445, 'loss_val': 0.6267879591847753, 'psi': 0.7683788518516843}-{'f1_val': 0.7139068610123107, 'auprc': 0.8588053946904557, 'loss_val': 0.6227361786715354, 'psi': 0.7718662744835687}
[S8] START round=12 head_norm_before_train=1.358359 cos_to_last_merge=0.9974 (last merge round=10)
[S8] round=12 local utility u=0.044434 metrics={'f1_val': 0.7145254456069222, 'auprc': 0.9966335941958548, 'loss_val': 0.3209823770164354, 'psi': 0.8273687050424953}-{'f1_val': 0.709063388684925, 'auprc': 0.9975993561611505, 'loss_val': 0.3799761331661935, 'psi': 0.8244777756754152}
[S9] START round=12 head_norm_before_train=1.037224 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.9933313312849914, 'auprc': 0.9982754183449376, 'loss_val': 0.20837904134829097, 'psi': 0.9953089661089699}-{'f1_val': 0.9954158325366191, 'auprc': 0.9981817599988496, 'loss_val': 0.14123803952209144, 'psi': 0.9965222035215113}
[S10] START round=12 head_norm_before_train=1.599931 (no previous merge yet)
[S10] round=12 local utility u=0.027052 metrics={'f1_val': 0.6932835105140396, 'auprc': 0.9971618865247737, 'loss_val': 0.25653114862338106, 'psi': 0.8148348609183332}-{'f1_val': 0.7014667009264342, 'auprc': 0.9848662671264404, 'loss_val': 0.3228480903648547, 'psi': 0.8148265274064367}
[S11] START round=12 head_norm_before_train=1.088178 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.829366 metrics={'f1_val': 0.7021340645804313, 'auprc': 0.942552471310331, 'loss_val': 0.6486015378110778, 'psi': 0.7983014272723912}-{'f1_val': 0.40252731690722093, 'auprc': 0.9835754645425664, 'loss_val': 0.6327613438655865, 'psi': 0.6349465759613592}
[S13] START round=12 head_norm_before_train=0.726052 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.025293 metrics={'f1_val': 0.4154919852385314, 'auprc': 0.47046173871685587, 'loss_val': 0.9859358444790077, 'psi': 0.4374798866298612}-{'f1_val': 0.41580726865236384, 'auprc': 0.446570937817667, 'loss_val': 0.9667406550645997, 'psi': 0.4281127363184851}
[S14] START round=12 head_norm_before_train=1.566484 (no previous merge yet)
[S14] round=12 local utility u=0.021125 metrics={'f1_val': 0.701751512821432, 'auprc': 0.9982332187760667, 'loss_val': 0.25712399179045264, 'psi': 0.8203441952032859}-{'f1_val': 0.7023047375160051, 'auprc': 0.9996159126030564, 'loss_val': 0.3068422568840964, 'psi': 0.8212292075508256}
[S15] START round=12 head_norm_before_train=1.134235 cos_to_last_merge=0.9962 (last merge round=10)
[S15] round=12 local utility u=0.048169 metrics={'f1_val': 0.6868713163969707, 'auprc': 0.8202606255585294, 'loss_val': 0.5443766355462981, 'psi': 0.7402270400615942}-{'f1_val': 0.6999381145660017, 'auprc': 0.7850216687383147, 'loss_val': 0.6133986349594559, 'psi': 0.733971536234927}
[S16] START round=12 head_norm_before_train=1.164038 cos_to_last_merge=0.8629 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.863
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.5598256433683569, 'auprc': 0.8916872197156271, 'loss_val': 0.6609278748413583, 'psi': 0.692570273907265}-{'f1_val': 0.5922255235935567, 'auprc': 0.8770966804262488, 'loss_val': 0.6317941776102179, 'psi': 0.7061739863266335}
[S17] START round=12 head_norm_before_train=0.822004 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.3516972959257648, 'auprc': 0.5252226381223879, 'loss_val': 0.9548316447261129, 'psi': 0.42110743280441404}-{'f1_val': 0.35317771804322007, 'auprc': 0.6284071459128231, 'loss_val': 0.9237932124587898, 'psi': 0.46326948919106126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[S13] not sending this round → trigger blocked (psi=0.437)
[S15] not sending this round → trigger blocked (psi=0.740)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61009
[S3] not sending this round → trigger blocked (psi=0.820)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[S14] not sending this round → trigger blocked (psi=0.820)
[S11] not sending this round → trigger blocked (psi=0.798)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S10
[S14] cosine check vs S10: cos=-0.0205
[S14] DROPPED delta from S10 (cos=-0.0205 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S4
[S8] cosine check vs S4: cos=-0.1151
[S8] DROPPED delta from S4 (cos=-0.1151 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S6
[S17] cosine check vs S6: cos=0.2372
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] cosine check vs S2: cos=0.9549
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.8932
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6869 head_norm=1.182582
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.189015e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6582 head_norm=1.260638 delta_norm=0.318902
[S15] aggregate: ROLLBACK (f1_val pre=0.687 post=0.658 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.7145 head_norm=1.408301
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.221188e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.7145 head_norm=1.434906 delta_norm=0.222119
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3517 head_norm=0.871159
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.397284e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3517 head_norm=0.806399 delta_norm=0.639728
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.494415 (no previous merge yet)
[S2] round=13 local utility u=0.015475 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.9943757845440829, 'loss_val': 0.28405621306815854, 'psi': 0.8188494081103705}-{'f1_val': 0.7018318238212289, 'auprc': 0.9945893181422875, 'loss_val': 0.3156476059947631, 'psi': 0.8189348215496524}
[S3] START round=13 head_norm_before_train=1.759052 (no previous merge yet)
[S3] round=13 local utility u=0.713774 metrics={'f1_val': 0.9339016147350454, 'auprc': 0.9998044215498763, 'loss_val': 0.1591560471763477, 'psi': 0.9602627374609778}-{'f1_val': 0.7007562037352997, 'auprc': 0.9998789733442018, 'loss_val': 0.18805428198186314, 'psi': 0.8204053115788605}
[S4] START round=13 head_norm_before_train=1.588328 (no previous merge yet)
[S4] round=13 local utility u=0.007120 metrics={'f1_val': 0.6688634361881701, 'auprc': 0.9252615265543819, 'loss_val': 0.41901114398689726, 'psi': 0.7714226723346549}-{'f1_val': 0.6681382446885828, 'auprc': 0.9164443086376353, 'loss_val': 0.4024485057311866, 'psi': 0.7674606702682039}
[S5] START round=13 head_norm_before_train=1.372693 cos_to_last_merge=0.8415 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.841
[S5] round=13 local utility u=0.240721 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9632850598145023, 'loss_val': 0.29900173528771407, 'psi': 0.8056790595234056}-{'f1_val': 0.7006083926626743, 'auprc': 0.8076725802810969, 'loss_val': 0.3136065271307617, 'psi': 0.7434340677100433}
[S6] START round=13 head_norm_before_train=1.166252 cos_to_last_merge=0.8687 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.6574997828454703, 'auprc': 0.7907411859091396, 'loss_val': 0.5321118766314236, 'psi': 0.710796344070938}-{'f1_val': 0.7106346092761868, 'auprc': 0.8202549216143905, 'loss_val': 0.5177246610874137, 'psi': 0.7544827342114684}
[S7] START round=13 head_norm_before_train=0.938542 cos_to_last_merge=0.9965 (last merge round=11)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.7139737313795297, 'auprc': 0.803882963780902, 'loss_val': 0.5686400955692931, 'psi': 0.7499374243400786}-{'f1_val': 0.7139068610123107, 'auprc': 0.8500868381107445, 'loss_val': 0.6267879591847753, 'psi': 0.7683788518516843}
[S8] START round=13 head_norm_before_train=1.434906 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.028327 metrics={'f1_val': 0.7145254456069222, 'auprc': 0.9958346784822519, 'loss_val': 0.2619318441280002, 'psi': 0.8270491387570541}-{'f1_val': 0.7145254456069222, 'auprc': 0.9966335941958548, 'loss_val': 0.3209823770164354, 'psi': 0.8273687050424953}
[S9] START round=13 head_norm_before_train=1.130200 cos_to_last_merge=0.9919 (last merge round=11)
[S9] round=13 local utility u=0.050341 metrics={'f1_val': 0.9958312226609984, 'auprc': 0.9972867418023971, 'loss_val': 0.11973059852516683, 'psi': 0.9964134303175578}-{'f1_val': 0.9933313312849914, 'auprc': 0.9982754183449376, 'loss_val': 0.20837904134829097, 'psi': 0.9953089661089699}
[S10] START round=13 head_norm_before_train=1.631424 (no previous merge yet)
[S10] round=13 local utility u=0.278633 metrics={'f1_val': 0.7815838901804251, 'auprc': 0.9968789569882326, 'loss_val': 0.2282185009466561, 'psi': 0.867701916903548}-{'f1_val': 0.6932835105140396, 'auprc': 0.9971618865247737, 'loss_val': 0.25653114862338106, 'psi': 0.8148348609183332}
[S11] START round=13 head_norm_before_train=1.124356 cos_to_last_merge=0.9983 (last merge round=11)
[S11] round=13 local utility u=0.168217 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9934556837819486, 'loss_val': 0.4626254245741442, 'psi': 0.8184376365096582}-{'f1_val': 0.7021340645804313, 'auprc': 0.942552471310331, 'loss_val': 0.6486015378110778, 'psi': 0.7983014272723912}
[S13] START round=13 head_norm_before_train=0.765746 cos_to_last_merge=0.9942 (last merge round=11)
[S13] round=13 local utility u=0.391718 metrics={'f1_val': 0.5340400760720369, 'auprc': 0.47666230189981856, 'loss_val': 0.9323908023447917, 'psi': 0.5110889664031495}-{'f1_val': 0.4154919852385314, 'auprc': 0.47046173871685587, 'loss_val': 0.9859358444790077, 'psi': 0.4374798866298612}
[S14] START round=13 head_norm_before_train=1.609601 (no previous merge yet)
[S14] round=13 local utility u=0.796697 metrics={'f1_val': 0.9538104098936833, 'auprc': 0.9992331310395981, 'loss_val': 0.17908345867226413, 'psi': 0.9719794983520491}-{'f1_val': 0.701751512821432, 'auprc': 0.9982332187760667, 'loss_val': 0.25712399179045264, 'psi': 0.8203441952032859}
[S15] START round=13 head_norm_before_train=1.260638 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.333025 metrics={'f1_val': 0.6989274229389338, 'auprc': 0.982089613925275, 'loss_val': 0.4361501487842904, 'psi': 0.8121922993334703}-{'f1_val': 0.6868713163969707, 'auprc': 0.8202606255585294, 'loss_val': 0.5443766355462981, 'psi': 0.7402270400615942}
[S16] START round=13 head_norm_before_train=1.208578 cos_to_last_merge=0.8496 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.850
[S16] round=13 local utility u=0.330804 metrics={'f1_val': 0.6233849071918721, 'auprc': 0.9416796290610823, 'loss_val': 0.5306522811760995, 'psi': 0.7507027959395562}-{'f1_val': 0.5598256433683569, 'auprc': 0.8916872197156271, 'loss_val': 0.6609278748413583, 'psi': 0.692570273907265}
[S17] START round=13 head_norm_before_train=0.806399 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.155122 metrics={'f1_val': 0.35317771804322007, 'auprc': 0.6212946918249541, 'loss_val': 0.9416858007297596, 'psi': 0.4604245075559137}-{'f1_val': 0.3516972959257648, 'auprc': 0.5252226381223879, 'loss_val': 0.9548316447261129, 'psi': 0.42110743280441404}
[S2] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:61017
[S4] not sending this round → trigger blocked (psi=0.771)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61008
[S8] not sending this round → trigger blocked (psi=0.827)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.868)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:61010
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61008
[S5] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1805) from S5
[S11] cosine check vs S5: cos=0.5698
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] cosine check vs S3: cos=0.8082
[S9] RECEIVED delta(kind=head bytes=1799) from S15
[S9] cosine check vs S15: cos=0.7665
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=0.8942
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=0.7929
[S17] RECEIVED delta(kind=head bytes=1805) from S9
[S17] cosine check vs S9: cos=0.4065
[S8] RECEIVED delta(kind=head bytes=1803) from S11
[S8] cosine check vs S11: cos=-0.0698
[S8] DROPPED delta from S11 (cos=-0.0698 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] cosine check vs S14: cos=-0.0110
[S8] DROPPED delta from S14 (cos=-0.0110 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=0.7024
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.7140 head_norm=0.987918
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.633502e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.7140 head_norm=0.947015 delta_norm=0.163350
[S7] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7018 head_norm=1.165032
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.608192e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7018 head_norm=1.155563 delta_norm=0.160819
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.9958 head_norm=1.231058
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.330586e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.9960 head_norm=1.188203 delta_norm=0.433059
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.5340 head_norm=0.811167
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.202857e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.5163 head_norm=0.765011 delta_norm=0.320286
[S13] aggregate: ROLLBACK (f1_val pre=0.534 post=0.516 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3532 head_norm=0.847147
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.884871e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3532 head_norm=0.877647 delta_norm=0.588487
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.532550 (no previous merge yet)
[S2] round=14 local utility u=0.007085 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.9929577169786118, 'loss_val': 0.2656317436605694, 'psi': 0.818282181084182}-{'f1_val': 0.7018318238212289, 'auprc': 0.9943757845440829, 'loss_val': 0.28405621306815854, 'psi': 0.8188494081103705}
[S3] START round=14 head_norm_before_train=1.795055 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.9380686822374825, 'auprc': 0.9998718709478127, 'loss_val': 0.20193424079341563, 'psi': 0.9627899577216146}-{'f1_val': 0.9339016147350454, 'auprc': 0.9998044215498763, 'loss_val': 0.1591560471763477, 'psi': 0.9602627374609778}
[S4] START round=14 head_norm_before_train=1.625196 (no previous merge yet)
[S4] round=14 local utility u=0.849351 metrics={'f1_val': 0.9444359277174594, 'auprc': 0.9348297757401163, 'loss_val': 0.4024485010201688, 'psi': 0.9405934669265222}-{'f1_val': 0.6688634361881701, 'auprc': 0.9252615265543819, 'loss_val': 0.41901114398689726, 'psi': 0.7714226723346549}
[S5] START round=14 head_norm_before_train=1.399199 cos_to_last_merge=0.8362 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.836
[S5] round=14 local utility u=0.041732 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9882386801179422, 'loss_val': 0.2903981644124198, 'psi': 0.8156605076447815}-{'f1_val': 0.7006083926626743, 'auprc': 0.9632850598145023, 'loss_val': 0.29900173528771407, 'psi': 0.8056790595234056}
[S6] START round=14 head_norm_before_train=1.217075 cos_to_last_merge=0.8552 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.855
[S6] round=14 local utility u=0.250578 metrics={'f1_val': 0.7101693448503854, 'auprc': 0.8141777060436248, 'loss_val': 0.41728278774408356, 'psi': 0.7517726893276813}-{'f1_val': 0.6574997828454703, 'auprc': 0.7907411859091396, 'loss_val': 0.5321118766314236, 'psi': 0.710796344070938}
[S7] START round=14 head_norm_before_train=0.947015 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.088081 metrics={'f1_val': 0.7136777461215018, 'auprc': 0.8688713973377629, 'loss_val': 0.5856680602975235, 'psi': 0.7757552066080062}-{'f1_val': 0.7139737313795297, 'auprc': 0.803882963780902, 'loss_val': 0.5686400955692931, 'psi': 0.7499374243400786}
[S8] START round=14 head_norm_before_train=1.473981 cos_to_last_merge=0.9990 (last merge round=12)
[S8] round=14 local utility u=0.894544 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9971633272548317, 'loss_val': 0.1686131092797249, 'psi': 0.9967589964633377}-{'f1_val': 0.7145254456069222, 'auprc': 0.9958346784822519, 'loss_val': 0.2619318441280002, 'psi': 0.8270491387570541}
[S9] START round=14 head_norm_before_train=1.188203 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.9947065539755162, 'auprc': 0.9993095099550838, 'loss_val': 0.17946395172121793, 'psi': 0.9965477363673433}-{'f1_val': 0.9958312226609984, 'auprc': 0.9972867418023971, 'loss_val': 0.11973059852516683, 'psi': 0.9964134303175578}
[S10] START round=14 head_norm_before_train=1.662390 (no previous merge yet)
[S10] round=14 local utility u=0.032569 metrics={'f1_val': 0.7868572257147464, 'auprc': 0.9967255448904246, 'loss_val': 0.19425940021729085, 'psi': 0.8708045533850177}-{'f1_val': 0.7815838901804251, 'auprc': 0.9968789569882326, 'loss_val': 0.2282185009466561, 'psi': 0.867701916903548}
[S11] START round=14 head_norm_before_train=1.155563 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.024310 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.998146705065275, 'loss_val': 0.42953007901680984, 'psi': 0.8204591475936492}-{'f1_val': 0.7017589383281313, 'auprc': 0.9934556837819486, 'loss_val': 0.4626254245741442, 'psi': 0.8184376365096582}
[S13] START round=14 head_norm_before_train=0.765011 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.4266575377841032, 'auprc': 0.5113080326356495, 'loss_val': 0.94536613763415, 'psi': 0.4605177357247217}-{'f1_val': 0.5340400760720369, 'auprc': 0.47666230189981856, 'loss_val': 0.9323908023447917, 'psi': 0.5110889664031495}
[S14] START round=14 head_norm_before_train=1.648970 (no previous merge yet)
[S14] round=14 local utility u=0.152338 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9992314628004273, 'loss_val': 0.13600675892113653, 'psi': 0.9981391816808678}-{'f1_val': 0.9538104098936833, 'auprc': 0.9992331310395981, 'loss_val': 0.17908345867226413, 'psi': 0.9719794983520491}
[S15] START round=14 head_norm_before_train=1.297393 cos_to_last_merge=0.9979 (last merge round=12)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6842140777528436, 'auprc': 0.8355711395994403, 'loss_val': 0.4794800378831368, 'psi': 0.7447569024914822}-{'f1_val': 0.6989274229389338, 'auprc': 0.982089613925275, 'loss_val': 0.4361501487842904, 'psi': 0.8121922993334703}
[S16] START round=14 head_norm_before_train=1.250751 cos_to_last_merge=0.8394 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.839
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.5917643688808616, 'auprc': 0.9656181128502956, 'loss_val': 0.5203132155900643, 'psi': 0.7413058664686352}-{'f1_val': 0.6233849071918721, 'auprc': 0.9416796290610823, 'loss_val': 0.5306522811760995, 'psi': 0.7507027959395562}
[S17] START round=14 head_norm_before_train=0.877647 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.35729044469418525, 'auprc': 0.5728745047854653, 'loss_val': 0.9182748875287696, 'psi': 0.4435240687306973}-{'f1_val': 0.35317771804322007, 'auprc': 0.6212946918249541, 'loss_val': 0.9416858007297596, 'psi': 0.4604245075559137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:61015
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[S6] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S11
[S8] cosine check vs S11: cos=-0.0693
[S8] DROPPED delta from S11 (cos=-0.0693 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] cosine check vs S14: cos=-0.0127
[S8] DROPPED delta from S14 (cos=-0.0127 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=-0.1186
[S8] DROPPED delta from S4 (cos=-0.1186 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=-0.0119
[S14] DROPPED delta from S10 (cos=-0.0119 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=0.9734
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] cosine check vs S5: cos=0.6025
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] cosine check vs S6: cos=0.3307
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] cosine check vs S7: cos=0.4897
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=0.9323
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7020 head_norm=1.195154
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.938499e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7020 head_norm=1.174981 delta_norm=0.593850
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.9965 head_norm=1.510567
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.795634e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.9965 head_norm=1.528304 delta_norm=0.179563
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6842 head_norm=1.339609
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.752796e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6659 head_norm=1.400858 delta_norm=0.275280
[S15] aggregate: ROLLBACK (f1_val pre=0.684 post=0.666 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3573 head_norm=0.919239
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.826035e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3573 head_norm=0.803254 delta_norm=0.482603
[S17] aggregate: ACCEPT kept=['S6', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.566557 (no previous merge yet)
[S2] round=15 local utility u=0.010722 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.9946906244459982, 'loss_val': 0.24938639469556184, 'psi': 0.8189753440711367}-{'f1_val': 0.7018318238212289, 'auprc': 0.9929577169786118, 'loss_val': 0.2656317436605694, 'psi': 0.818282181084182}
[S3] START round=15 head_norm_before_train=1.835556 (no previous merge yet)
[S3] round=15 local utility u=0.103787 metrics={'f1_val': 0.9585412103933568, 'auprc': 0.9997551266492526, 'loss_val': 0.11684513296366886, 'psi': 0.9750267768957152}-{'f1_val': 0.9380686822374825, 'auprc': 0.9998718709478127, 'loss_val': 0.20193424079341563, 'psi': 0.9627899577216146}
[S4] START round=15 head_norm_before_train=1.656060 (no previous merge yet)
[S4] round=15 local utility u=0.040146 metrics={'f1_val': 0.9451829220172963, 'auprc': 0.9459489734925082, 'loss_val': 0.3599955708672005, 'psi': 0.9454893426073809}-{'f1_val': 0.9444359277174594, 'auprc': 0.9348297757401163, 'loss_val': 0.4024485010201688, 'psi': 0.9405934669265222}
[S5] START round=15 head_norm_before_train=1.427615 cos_to_last_merge=0.8314 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=15 local utility u=0.019769 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9918432620466611, 'loss_val': 0.2616775798427914, 'psi': 0.8171027612221329}-{'f1_val': 0.7006083926626743, 'auprc': 0.9882386801179422, 'loss_val': 0.2903981644124198, 'psi': 0.8156605076447815}
[S6] START round=15 head_norm_before_train=1.261740 cos_to_last_merge=0.8445 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.844
[S6] round=15 local utility u=0.207936 metrics={'f1_val': 0.697820228326151, 'auprc': 0.9525770623353346, 'loss_val': 0.3425150464096653, 'psi': 0.7997229619298245}-{'f1_val': 0.7101693448503854, 'auprc': 0.8141777060436248, 'loss_val': 0.41728278774408356, 'psi': 0.7517726893276813}
[S7] START round=15 head_norm_before_train=0.979840 cos_to_last_merge=0.9976 (last merge round=13)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.7139068610123107, 'auprc': 0.8020347688190592, 'loss_val': 0.5874861070454914, 'psi': 0.7491580241350102}-{'f1_val': 0.7136777461215018, 'auprc': 0.8688713973377629, 'loss_val': 0.5856680602975235, 'psi': 0.7757552066080062}
[S8] START round=15 head_norm_before_train=1.528304 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.003626 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9976256160687764, 'loss_val': 0.16274729777522337, 'psi': 0.9969439119889156}-{'f1_val': 0.9964894426023416, 'auprc': 0.9971633272548317, 'loss_val': 0.1686131092797249, 'psi': 0.9967589964633377}
[S9] START round=15 head_norm_before_train=1.268817 cos_to_last_merge=0.9939 (last merge round=13)
[S9] round=15 local utility u=0.030981 metrics={'f1_val': 0.9930384954489024, 'auprc': 0.9992951833069189, 'loss_val': 0.10745089691593054, 'psi': 0.9955411705921091}-{'f1_val': 0.9947065539755162, 'auprc': 0.9993095099550838, 'loss_val': 0.17946395172121793, 'psi': 0.9965477363673433}
[S10] START round=15 head_norm_before_train=1.689424 (no previous merge yet)
[S10] round=15 local utility u=0.635130 metrics={'f1_val': 0.9944541036875503, 'auprc': 0.9960374482058818, 'loss_val': 0.16751656002612272, 'psi': 0.9950874414948829}-{'f1_val': 0.7868572257147464, 'auprc': 0.9967255448904246, 'loss_val': 0.19425940021729085, 'psi': 0.8708045533850177}
[S11] START round=15 head_norm_before_train=1.174981 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9981940687551921, 'loss_val': 0.4550728075768611, 'psi': 0.8204388174810688}-{'f1_val': 0.7020007759458987, 'auprc': 0.998146705065275, 'loss_val': 0.42953007901680984, 'psi': 0.8204591475936492}
[S13] START round=15 head_norm_before_train=0.799140 cos_to_last_merge=0.9954 (last merge round=13)
[S13] round=15 local utility u=0.406355 metrics={'f1_val': 0.5535044135155558, 'auprc': 0.5105701043782255, 'loss_val': 0.8915234557536682, 'psi': 0.5363306898606237}-{'f1_val': 0.4266575377841032, 'auprc': 0.5113080326356495, 'loss_val': 0.94536613763415, 'psi': 0.4605177357247217}
[S14] START round=15 head_norm_before_train=1.687558 (no previous merge yet)
[S14] round=15 local utility u=0.021511 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9992308093611877, 'loss_val': 0.09298281280472596, 'psi': 0.998138920305172}-{'f1_val': 0.9974109942678281, 'auprc': 0.9992314628004273, 'loss_val': 0.13600675892113653, 'psi': 0.9981391816808678}
[S15] START round=15 head_norm_before_train=1.400858 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.337896 metrics={'f1_val': 0.7017380905492667, 'auprc': 0.9885966780169864, 'loss_val': 0.36790885099188253, 'psi': 0.8164815255363546}-{'f1_val': 0.6842140777528436, 'auprc': 0.8355711395994403, 'loss_val': 0.4794800378831368, 'psi': 0.7447569024914822}
[S16] START round=15 head_norm_before_train=1.287867 cos_to_last_merge=0.8318 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.832
[S16] round=15 local utility u=1.000000 metrics={'f1_val': 0.904640401389722, 'auprc': 0.9770314670075562, 'loss_val': 0.3794327978282553, 'psi': 0.9335968276368556}-{'f1_val': 0.5917643688808616, 'auprc': 0.9656181128502956, 'loss_val': 0.5203132155900643, 'psi': 0.7413058664686352}
[S17] START round=15 head_norm_before_train=0.803254 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.176396 metrics={'f1_val': 0.36005499538270175, 'auprc': 0.6709823207152702, 'loss_val': 0.876393436070783, 'psi': 0.48442592551572916}-{'f1_val': 0.35729044469418525, 'auprc': 0.5728745047854653, 'loss_val': 0.9182748875287696, 'psi': 0.4435240687306973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:61014
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:61010
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S15] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1806) from S9
[S17] cosine check vs S9: cos=0.4947
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] cosine check vs S4: cos=-0.1191
[S8] DROPPED delta from S4 (cos=-0.1191 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S15
[S9] cosine check vs S15: cos=0.8336
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=-0.0087
[S14] DROPPED delta from S10 (cos=-0.0087 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=0.9895
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=-0.0090
[S8] DROPPED delta from S14 (cos=-0.0090 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=0.9631
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=0.8975
[S7] RECEIVED delta(kind=head bytes=1795) from S13
[S7] cosine check vs S13: cos=0.7858
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=0.6813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:61013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:61008
[S3] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S3
[S11] cosine check vs S3: cos=0.4653
[S16] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S16
[S7] cosine check vs S16: cos=0.8910
[S17] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S17
[S13] cosine check vs S17: cos=0.8876
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.7139 head_norm=1.014051
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.763877e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.7139 head_norm=0.982347 delta_norm=0.176388
[S7] aggregate: ACCEPT kept=['S13', 'S16'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.142 → S17@127.0.0.1:61017
[S10] ⇄ pheromone p=0.290 → S14@127.0.0.1:61014
[S6] ⇄ pheromone p=0.268 → S17@127.0.0.1:61017
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9965 head_norm=1.558638
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.159981e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9965 head_norm=1.573854 delta_norm=0.115998
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.282 → S15@127.0.0.1:61015
[S4] ⇄ pheromone p=0.291 → S8@127.0.0.1:61009
[S2] ⇄ pheromone p=0.159 → S8@127.0.0.1:61009
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7019 head_norm=1.215105
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.818765e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7019 head_norm=1.184207 delta_norm=0.281877
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.208 → S8@127.0.0.1:61009
[S3] ⇄ pheromone p=0.210 → S11@127.0.0.1:61012
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.5535 head_norm=0.843340
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.005327e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.5571 head_norm=0.821618 delta_norm=0.200533
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.202 → S7@127.0.0.1:61008
[S5] ⇄ pheromone p=0.166 → S11@127.0.0.1:61012
[S16] ⇄ pheromone p=0.372 → S7@127.0.0.1:61008
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.7017 head_norm=1.429302
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.126835e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.7017 head_norm=1.480167 delta_norm=0.212684
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.246 → S9@127.0.0.1:61010
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9930 head_norm=1.354214
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.030929e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.9947 head_norm=1.332635 delta_norm=0.403093
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.146 → S17@127.0.0.1:61017
[S14] ⇄ pheromone p=0.294 → S8@127.0.0.1:61009
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3601 head_norm=0.848126
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.251413e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3593 head_norm=0.843121 delta_norm=0.225141
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.140 → S13@127.0.0.1:61013
[S2] START round=16 head_norm_before_train=1.597369 (no previous merge yet)
[S2] round=16 local utility u=0.004026 metrics={'f1_val': 0.7012333617836406, 'auprc': 0.994502453920191, 'loss_val': 0.23717823466799923, 'psi': 0.8185409986382608}-{'f1_val': 0.7018318238212289, 'auprc': 0.9946906244459982, 'loss_val': 0.24938639469556184, 'psi': 0.8189753440711367}
[S3] START round=16 head_norm_before_train=1.878574 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.9443833612950668, 'auprc': 0.9997233151993545, 'loss_val': 0.1206879635030444, 'psi': 0.9665193428567819}-{'f1_val': 0.9585412103933568, 'auprc': 0.9997551266492526, 'loss_val': 0.11684513296366886, 'psi': 0.9750267768957152}
[S4] START round=16 head_norm_before_train=1.679755 (no previous merge yet)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9400948889294003, 'auprc': 0.9583051313794007, 'loss_val': 0.3709068382327759, 'psi': 0.9473789859094004}-{'f1_val': 0.9451829220172963, 'auprc': 0.9459489734925082, 'loss_val': 0.3599955708672005, 'psi': 0.9454893426073809}
[S5] START round=16 head_norm_before_train=1.452103 cos_to_last_merge=0.8294 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.829
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9427197951822495, 'loss_val': 0.2913582661099418, 'psi': 0.7974533744763683}-{'f1_val': 0.7006090940057808, 'auprc': 0.9918432620466611, 'loss_val': 0.2616775798427914, 'psi': 0.8171027612221329}
[S6] START round=16 head_norm_before_train=1.301756 cos_to_last_merge=0.8346 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.835
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.7096572343948266, 'auprc': 0.7898958734357675, 'loss_val': 0.4557414981670629, 'psi': 0.741752690011203}-{'f1_val': 0.697820228326151, 'auprc': 0.9525770623353346, 'loss_val': 0.3425150464096653, 'psi': 0.7997229619298245}
[S7] START round=16 head_norm_before_train=0.982347 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.084512 metrics={'f1_val': 0.7142685888878759, 'auprc': 0.8525897737449608, 'loss_val': 0.5722975819907591, 'psi': 0.7695970628307098}-{'f1_val': 0.7139068610123107, 'auprc': 0.8020347688190592, 'loss_val': 0.5874861070454914, 'psi': 0.7491580241350102}
[S8] START round=16 head_norm_before_train=1.573854 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9960376355310944, 'auprc': 0.9955686020804921, 'loss_val': 0.16895899271094936, 'psi': 0.9958500221508535}-{'f1_val': 0.9964894426023416, 'auprc': 0.9976256160687764, 'loss_val': 0.16274729777522337, 'psi': 0.9969439119889156}
[S9] START round=16 head_norm_before_train=1.332635 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9922014013811216, 'auprc': 0.9992643073908233, 'loss_val': 0.15951304584507314, 'psi': 0.9950265637850022}-{'f1_val': 0.9930384954489024, 'auprc': 0.9992951833069189, 'loss_val': 0.10745089691593054, 'psi': 0.9955411705921091}
[S10] START round=16 head_norm_before_train=1.709942 (no previous merge yet)
[S10] round=16 local utility u=0.013646 metrics={'f1_val': 0.9940161844119884, 'auprc': 0.9969065047990326, 'loss_val': 0.1402040520641317, 'psi': 0.995172312566806}-{'f1_val': 0.9944541036875503, 'auprc': 0.9960374482058818, 'loss_val': 0.16751656002612272, 'psi': 0.9950874414948829}
[S11] START round=16 head_norm_before_train=1.184207 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.052831 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9980397586937315, 'loss_val': 0.348947110314621, 'psi': 0.8203770934564847}-{'f1_val': 0.7019353166316534, 'auprc': 0.9981940687551921, 'loss_val': 0.4550728075768611, 'psi': 0.8204388174810688}
[S13] START round=16 head_norm_before_train=0.821618 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.028577 metrics={'f1_val': 0.5549991896601534, 'auprc': 0.5345249046716897, 'loss_val': 0.9152025580004565, 'psi': 0.5468094756647679}-{'f1_val': 0.5535044135155558, 'auprc': 0.5105701043782255, 'loss_val': 0.8915234557536682, 'psi': 0.5363306898606237}
[S14] START round=16 head_norm_before_train=1.727369 (no previous merge yet)
[S14] round=16 local utility u=0.012171 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9992289028189008, 'loss_val': 0.06863542260410135, 'psi': 0.9981381576882572}-{'f1_val': 0.9974109942678281, 'auprc': 0.9992308093611877, 'loss_val': 0.09298281280472596, 'psi': 0.998138920305172}
[S15] START round=16 head_norm_before_train=1.480167 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6918556516555622, 'auprc': 0.9844923802745638, 'loss_val': 0.42743677468982394, 'psi': 0.8089103431031628}-{'f1_val': 0.7017380905492667, 'auprc': 0.9885966780169864, 'loss_val': 0.36790885099188253, 'psi': 0.8164815255363546}
[S16] START round=16 head_norm_before_train=1.323439 cos_to_last_merge=0.8251 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.825
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.8692437711154235, 'auprc': 0.9878462520821062, 'loss_val': 0.5037180374551677, 'psi': 0.9166847635020966}-{'f1_val': 0.904640401389722, 'auprc': 0.9770314670075562, 'loss_val': 0.3794327978282553, 'psi': 0.9335968276368556}
[S17] START round=16 head_norm_before_train=0.843121 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.3555336041701449, 'auprc': 0.6696680606213644, 'loss_val': 0.9218437184948416, 'psi': 0.48118738675063266}-{'f1_val': 0.36005499538270175, 'auprc': 0.6709823207152702, 'loss_val': 0.876393436070783, 'psi': 0.48442592551572916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61009
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:61008
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S7] → sending delta(kind=head bytes=1787) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:61014
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:61009
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1787 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=0.8319
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=-0.0051
[S14] DROPPED delta from S10 (cos=-0.0051 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1787) from S7
[S17] cosine check vs S7: cos=0.6757
[S8] RECEIVED delta(kind=head bytes=1793) from S2
[S8] cosine check vs S2: cos=0.9948
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] cosine check vs S11: cos=-0.0657
[S8] DROPPED delta from S11 (cos=-0.0657 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] cosine check vs S14: cos=-0.0075
[S8] DROPPED delta from S14 (cos=-0.0075 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9960 head_norm=1.604453
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.294889e-02
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9957 head_norm=1.611379 delta_norm=0.082949
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.7143 head_norm=1.019783
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.829948e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.7143 head_norm=0.898928 delta_norm=0.282995
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3555 head_norm=0.882107
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.880899e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3555 head_norm=0.870873 delta_norm=0.388090
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.622521 (no previous merge yet)
[S2] round=17 local utility u=0.354337 metrics={'f1_val': 0.816865903306863, 'auprc': 0.993189046497672, 'loss_val': 0.21836017448720937, 'psi': 0.8873951605831867}-{'f1_val': 0.7012333617836406, 'auprc': 0.994502453920191, 'loss_val': 0.23717823466799923, 'psi': 0.8185409986382608}
[S3] START round=17 head_norm_before_train=1.909174 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.8482660217156128, 'auprc': 0.9989574326016162, 'loss_val': 0.3011880006953721, 'psi': 0.9085425860700141}-{'f1_val': 0.9443833612950668, 'auprc': 0.9997233151993545, 'loss_val': 0.1206879635030444, 'psi': 0.9665193428567819}
[S4] START round=17 head_norm_before_train=1.703256 (no previous merge yet)
[S4] round=17 local utility u=0.067720 metrics={'f1_val': 0.9445506389316475, 'auprc': 0.9664004959282488, 'loss_val': 0.28648660889726985, 'psi': 0.9532905817302881}-{'f1_val': 0.9400948889294003, 'auprc': 0.9583051313794007, 'loss_val': 0.3709068382327759, 'psi': 0.9473789859094004}
[S5] START round=17 head_norm_before_train=1.478317 cos_to_last_merge=0.8277 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.828
[S5] round=17 local utility u=0.100623 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9918162744211285, 'loss_val': 0.23567000255386575, 'psi': 0.8169188688632668}-{'f1_val': 0.7006090940057808, 'auprc': 0.9427197951822495, 'loss_val': 0.2913582661099418, 'psi': 0.7974533744763683}
[S6] START round=17 head_norm_before_train=1.334551 cos_to_last_merge=0.8267 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.827
[S6] round=17 local utility u=1.000000 metrics={'f1_val': 0.9583718189556715, 'auprc': 0.9423458686789974, 'loss_val': 0.28681252540415353, 'psi': 0.951961438845002}-{'f1_val': 0.7096572343948266, 'auprc': 0.7898958734357675, 'loss_val': 0.4557414981670629, 'psi': 0.741752690011203}
[S7] START round=17 head_norm_before_train=0.898928 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.7142685888878759, 'auprc': 0.8614219147397967, 'loss_val': 0.6110674613878503, 'psi': 0.7731299192286443}-{'f1_val': 0.7142685888878759, 'auprc': 0.8525897737449608, 'loss_val': 0.5722975819907591, 'psi': 0.7695970628307098}
[S8] START round=17 head_norm_before_train=1.611379 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.015604 metrics={'f1_val': 0.9943440443697734, 'auprc': 0.9978682024568859, 'loss_val': 0.1344887805167877, 'psi': 0.9957537076046183}-{'f1_val': 0.9960376355310944, 'auprc': 0.9955686020804921, 'loss_val': 0.16895899271094936, 'psi': 0.9958500221508535}
[S9] START round=17 head_norm_before_train=1.408710 cos_to_last_merge=0.9955 (last merge round=15)
[S9] round=17 local utility u=0.010556 metrics={'f1_val': 0.9879970276931102, 'auprc': 0.9973919473384221, 'loss_val': 0.10755708899936404, 'psi': 0.9917549955512349}-{'f1_val': 0.9922014013811216, 'auprc': 0.9992643073908233, 'loss_val': 0.15951304584507314, 'psi': 0.9950265637850022}
[S10] START round=17 head_norm_before_train=1.730383 (no previous merge yet)
[S10] round=17 local utility u=0.007979 metrics={'f1_val': 0.9937885261526809, 'auprc': 0.9964473762561106, 'loss_val': 0.12150256256121328, 'psi': 0.9948520661940528}-{'f1_val': 0.9940161844119884, 'auprc': 0.9969065047990326, 'loss_val': 0.1402040520641317, 'psi': 0.995172312566806}
[S11] START round=17 head_norm_before_train=1.233651 cos_to_last_merge=0.9982 (last merge round=15)
[S11] round=17 local utility u=0.025525 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9985368946219687, 'loss_val': 0.2993876698581974, 'psi': 0.8205759478277795}-{'f1_val': 0.7019353166316534, 'auprc': 0.9980397586937315, 'loss_val': 0.348947110314621, 'psi': 0.8203770934564847}
[S13] START round=17 head_norm_before_train=0.858114 cos_to_last_merge=0.9954 (last merge round=15)
[S13] round=17 local utility u=0.129375 metrics={'f1_val': 0.5760512028021931, 'auprc': 0.5528955555052443, 'loss_val': 0.8378762801060684, 'psi': 0.5667889438834136}-{'f1_val': 0.5549991896601534, 'auprc': 0.5345249046716897, 'loss_val': 0.9152025580004565, 'psi': 0.5468094756647679}
[S14] START round=17 head_norm_before_train=1.766116 (no previous merge yet)
[S14] round=17 local utility u=0.007199 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9992289028189005, 'loss_val': 0.054238232757739646, 'psi': 0.9981381576882571}-{'f1_val': 0.9974109942678281, 'auprc': 0.9992289028189008, 'loss_val': 0.06863542260410135, 'psi': 0.9981381576882572}
[S15] START round=17 head_norm_before_train=1.501101 cos_to_last_merge=0.9994 (last merge round=15)
[S15] round=17 local utility u=0.387964 metrics={'f1_val': 0.7929833042619425, 'auprc': 0.9911389289421089, 'loss_val': 0.2782145702983633, 'psi': 0.8722455541340091}-{'f1_val': 0.6918556516555622, 'auprc': 0.9844923802745638, 'loss_val': 0.42743677468982394, 'psi': 0.8089103431031628}
[S16] START round=17 head_norm_before_train=1.357733 cos_to_last_merge=0.8189 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.819
[S16] round=17 local utility u=0.278429 metrics={'f1_val': 0.9269897300696269, 'auprc': 0.9893827698939671, 'loss_val': 0.29794474543175464, 'psi': 0.951946945999363}-{'f1_val': 0.8692437711154235, 'auprc': 0.9878462520821062, 'loss_val': 0.5037180374551677, 'psi': 0.9166847635020966}
[S17] START round=17 head_norm_before_train=0.870873 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.35406300060542706, 'auprc': 0.6300724230158132, 'loss_val': 0.9185747471415306, 'psi': 0.46446676956958155}-{'f1_val': 0.3555336041701449, 'auprc': 0.6696680606213644, 'loss_val': 0.9218437184948416, 'psi': 0.48118738675063266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:61008
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:61009
[S11] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] cosine check vs S5: cos=0.7604
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=0.8138
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=-0.0018
[S14] DROPPED delta from S10 (cos=-0.0018 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S15
[S9] cosine check vs S15: cos=0.8830
[S17] RECEIVED delta(kind=head bytes=1805) from S9
[S17] cosine check vs S9: cos=0.3893
[S7] RECEIVED delta(kind=head bytes=1794) from S13
[S7] cosine check vs S13: cos=0.9310
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] cosine check vs S6: cos=0.5914
[S8] RECEIVED delta(kind=head bytes=1804) from S11
[S8] cosine check vs S11: cos=-0.0673
[S8] DROPPED delta from S11 (cos=-0.0673 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] cosine check vs S14: cos=-0.0062
[S8] DROPPED delta from S14 (cos=-0.0062 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S4
[S8] cosine check vs S4: cos=-0.1155
[S8] DROPPED delta from S4 (cos=-0.1155 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=0.9966
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=0.9689
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.7143 head_norm=0.948088
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.685224e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.7034 head_norm=0.982464 delta_norm=0.168522
[S7] aggregate: ROLLBACK (f1_val pre=0.714 post=0.703 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9880 head_norm=1.485397
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.648260e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9889 head_norm=1.461639 delta_norm=0.364826
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.7930 head_norm=1.527276
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.050832e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.8063 head_norm=1.570783 delta_norm=0.205083
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9943 head_norm=1.638983
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.716509e-02
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9943 head_norm=1.638905 delta_norm=0.067165
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7019 head_norm=1.281053
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.919600e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7003 head_norm=1.304743 delta_norm=0.491960
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.3541 head_norm=0.914720
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.487130e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.3541 head_norm=0.868688 delta_norm=0.348713
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.641578 (no previous merge yet)
[S2] round=18 local utility u=0.015575 metrics={'f1_val': 0.8214706672935866, 'auprc': 0.9924825917539153, 'loss_val': 0.21271866227990013, 'psi': 0.8898754370777181}-{'f1_val': 0.816865903306863, 'auprc': 0.993189046497672, 'loss_val': 0.21836017448720937, 'psi': 0.8873951605831867}
[S3] START round=18 head_norm_before_train=1.939767 (no previous merge yet)
[S3] round=18 local utility u=0.448503 metrics={'f1_val': 0.9607233090810763, 'auprc': 0.9996987090311784, 'loss_val': 0.08115030934922554, 'psi': 0.9763134690611172}-{'f1_val': 0.8482660217156128, 'auprc': 0.9989574326016162, 'loss_val': 0.3011880006953721, 'psi': 0.9085425860700141}
[S4] START round=18 head_norm_before_train=1.724862 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9399601896978254, 'auprc': 0.9282328237647769, 'loss_val': 0.34654492594183467, 'psi': 0.9352692433246059}-{'f1_val': 0.9445506389316475, 'auprc': 0.9664004959282488, 'loss_val': 0.28648660889726985, 'psi': 0.9532905817302881}
[S5] START round=18 head_norm_before_train=1.499220 cos_to_last_merge=0.8255 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.826
[S5] round=18 local utility u=0.019430 metrics={'f1_val': 0.7007418514877237, 'auprc': 0.9922693964340064, 'loss_val': 0.20069783888536075, 'psi': 0.8173528694662368}-{'f1_val': 0.700320598491359, 'auprc': 0.9918162744211285, 'loss_val': 0.23567000255386575, 'psi': 0.8169188688632668}
[S6] START round=18 head_norm_before_train=1.362581 cos_to_last_merge=0.8199 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.820
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.6167255911532297, 'auprc': 0.7785350366439526, 'loss_val': 0.5889531622329084, 'psi': 0.6814493693495188}-{'f1_val': 0.9583718189556715, 'auprc': 0.9423458686789974, 'loss_val': 0.28681252540415353, 'psi': 0.951961438845002}
[S7] START round=18 head_norm_before_train=0.982464 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.039816 metrics={'f1_val': 0.7139737313795297, 'auprc': 0.8538630651934354, 'loss_val': 0.5069904171952241, 'psi': 0.769929464905092}-{'f1_val': 0.7142685888878759, 'auprc': 0.8614219147397967, 'loss_val': 0.6110674613878503, 'psi': 0.7731299192286443}
[S8] START round=18 head_norm_before_train=1.638905 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.994152941791943, 'auprc': 0.9954158536694226, 'loss_val': 0.15798381434297237, 'psi': 0.9946581065429349}-{'f1_val': 0.9943440443697734, 'auprc': 0.9978682024568859, 'loss_val': 0.1344887805167877, 'psi': 0.9957537076046183}
[S9] START round=18 head_norm_before_train=1.461639 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000949 metrics={'f1_val': 0.9930384954489024, 'auprc': 0.9992912189143529, 'loss_val': 0.14160643000944728, 'psi': 0.9955395848350826}-{'f1_val': 0.9879970276931102, 'auprc': 0.9973919473384221, 'loss_val': 0.10755708899936404, 'psi': 0.9917549955512349}
[S10] START round=18 head_norm_before_train=1.748210 (no previous merge yet)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9941370213715576, 'auprc': 0.992344605980997, 'loss_val': 0.13030199611728704, 'psi': 0.9934200552153334}-{'f1_val': 0.9937885261526809, 'auprc': 0.9964473762561106, 'loss_val': 0.12150256256121328, 'psi': 0.9948520661940528}
[S11] START round=18 head_norm_before_train=1.304743 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.743724 metrics={'f1_val': 0.9561587356364768, 'auprc': 0.9984823047968623, 'loss_val': 0.3371163903650993, 'psi': 0.973088163300631}-{'f1_val': 0.7019353166316534, 'auprc': 0.9985368946219687, 'loss_val': 0.2993876698581974, 'psi': 0.8205759478277795}
[S13] START round=18 head_norm_before_train=0.905393 cos_to_last_merge=0.9833 (last merge round=15)
[S13] round=18 local utility u=0.136551 metrics={'f1_val': 0.6006438292588486, 'auprc': 0.5741225590375902, 'loss_val': 0.7760110058596802, 'psi': 0.5900353211703453}-{'f1_val': 0.5760512028021931, 'auprc': 0.5528955555052443, 'loss_val': 0.8378762801060684, 'psi': 0.5667889438834136}
[S14] START round=18 head_norm_before_train=1.802835 (no previous merge yet)
[S14] round=18 local utility u=0.005235 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9992224457311597, 'loss_val': 0.04619917902252877, 'psi': 0.9983806890727949}-{'f1_val': 0.9974109942678281, 'auprc': 0.9992289028189005, 'loss_val': 0.054238232757739646, 'psi': 0.9981381576882571}
[S15] START round=18 head_norm_before_train=1.570783 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.132597 metrics={'f1_val': 0.833744513064115, 'auprc': 0.9944021378889424, 'loss_val': 0.26737748097211506, 'psi': 0.898007562994046}-{'f1_val': 0.7929833042619425, 'auprc': 0.9911389289421089, 'loss_val': 0.2782145702983633, 'psi': 0.8722455541340091}
[S16] START round=18 head_norm_before_train=1.392700 cos_to_last_merge=0.8137 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.814
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8275280750798315, 'auprc': 0.9927197746035055, 'loss_val': 0.7311259144460164, 'psi': 0.8936047548893011}-{'f1_val': 0.9269897300696269, 'auprc': 0.9893827698939671, 'loss_val': 0.29794474543175464, 'psi': 0.951946945999363}
[S17] START round=18 head_norm_before_train=0.868688 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.35332541874877144, 'auprc': 0.6088506244211819, 'loss_val': 0.9351004300049411, 'psi': 0.45553550101773566}-{'f1_val': 0.35406300060542706, 'auprc': 0.6300724230158132, 'loss_val': 0.9185747471415306, 'psi': 0.46446676956958155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=0.9978
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[S13] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] cosine check vs S13: cos=0.8868
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:61010
[S14] sending update (kind=head size=1802 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] cosine check vs S14: cos=-0.0063
[S8] DROPPED delta from S14 (cos=-0.0063 < 0.0)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:61017
[S9] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.5575
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=0.9329
[S7] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[S17] RECEIVED delta(kind=head bytes=1795) from S7
[S17] cosine check vs S7: cos=0.8269
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61012
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S11
[S8] cosine check vs S11: cos=-0.0602
[S8] DROPPED delta from S11 (cos=-0.0602 < 0.0)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S3
[S11] cosine check vs S3: cos=0.3720
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61012
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] cosine check vs S5: cos=0.9399
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9942 head_norm=1.660829
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.483695e-02
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9930 head_norm=1.659911 delta_norm=0.054837
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.9562 head_norm=1.331070
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.653808e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.7017 head_norm=1.253106 delta_norm=0.365381
[S11] aggregate: ROLLBACK (f1_val pre=0.956 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9930 head_norm=1.521170
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.885337e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9939 head_norm=1.534545 delta_norm=0.288534
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.7140 head_norm=1.028607
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.383950e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.7140 head_norm=0.960115 delta_norm=0.238395
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.3533 head_norm=0.904664
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.626777e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.3533 head_norm=0.915046 delta_norm=0.262678
[S17] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.660804 (no previous merge yet)
[S2] round=19 local utility u=0.029034 metrics={'f1_val': 0.8301612256014697, 'auprc': 0.9910081494641145, 'loss_val': 0.20237048295118665, 'psi': 0.8944999951465276}-{'f1_val': 0.8214706672935866, 'auprc': 0.9924825917539153, 'loss_val': 0.21271866227990013, 'psi': 0.8898754370777181}
[S3] START round=19 head_norm_before_train=1.971961 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7230610351121618, 'auprc': 0.968665025251941, 'loss_val': 0.6801910771711602, 'psi': 0.8213026311680736}-{'f1_val': 0.9607233090810763, 'auprc': 0.9996987090311784, 'loss_val': 0.08115030934922554, 'psi': 0.9763134690611172}
[S4] START round=19 head_norm_before_train=1.745346 (no previous merge yet)
[S4] round=19 local utility u=0.079912 metrics={'f1_val': 0.9425234102047243, 'auprc': 0.9521252753882758, 'loss_val': 0.27377697091106923, 'psi': 0.9463641562781449}-{'f1_val': 0.9399601896978254, 'auprc': 0.9282328237647769, 'loss_val': 0.34654492594183467, 'psi': 0.9352692433246059}
[S5] START round=19 head_norm_before_train=1.516418 cos_to_last_merge=0.8232 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.823
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9900429271536471, 'loss_val': 0.21065310053919736, 'psi': 0.816261703793387}-{'f1_val': 0.7007418514877237, 'auprc': 0.9922693964340064, 'loss_val': 0.20069783888536075, 'psi': 0.8173528694662368}
[S6] START round=19 head_norm_before_train=1.387916 cos_to_last_merge=0.8144 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.814
[S6] round=19 local utility u=1.000000 metrics={'f1_val': 0.959032644490867, 'auprc': 0.9538395950934464, 'loss_val': 0.24319888803942635, 'psi': 0.9569554247318988}-{'f1_val': 0.6167255911532297, 'auprc': 0.7785350366439526, 'loss_val': 0.5889531622329084, 'psi': 0.6814493693495188}
[S7] START round=19 head_norm_before_train=0.960115 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.121650 metrics={'f1_val': 0.7137073324812948, 'auprc': 0.9245186122858484, 'loss_val': 0.4740579874485207, 'psi': 0.7980318444031163}-{'f1_val': 0.7139737313795297, 'auprc': 0.8538630651934354, 'loss_val': 0.5069904171952241, 'psi': 0.769929464905092}
[S8] START round=19 head_norm_before_train=1.659911 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.020317 metrics={'f1_val': 0.9941986149874398, 'auprc': 0.9975740355485343, 'loss_val': 0.12409927145873122, 'psi': 0.9955487832118776}-{'f1_val': 0.994152941791943, 'auprc': 0.9954158536694226, 'loss_val': 0.15798381434297237, 'psi': 0.9946581065429349}
[S9] START round=19 head_norm_before_train=1.534545 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9913526543442172, 'auprc': 0.9980800890884062, 'loss_val': 0.15685730252573193, 'psi': 0.9940436282418927}-{'f1_val': 0.9930384954489024, 'auprc': 0.9992912189143529, 'loss_val': 0.14160643000944728, 'psi': 0.9955395848350826}
[S10] START round=19 head_norm_before_train=1.762460 (no previous merge yet)
[S10] round=19 local utility u=0.010491 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9926124032953231, 'loss_val': 0.10564801354888019, 'psi': 0.9930795715190238}-{'f1_val': 0.9941370213715576, 'auprc': 0.992344605980997, 'loss_val': 0.13030199611728704, 'psi': 0.9934200552153334}
[S11] START round=19 head_norm_before_train=1.253106 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.035791 metrics={'f1_val': 0.9552034538751127, 'auprc': 0.997665234067251, 'loss_val': 0.25735054374267463, 'psi': 0.972188165951968}-{'f1_val': 0.9561587356364768, 'auprc': 0.9984823047968623, 'loss_val': 0.3371163903650993, 'psi': 0.973088163300631}
[S13] START round=19 head_norm_before_train=0.948301 cos_to_last_merge=0.9702 (last merge round=15)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5590201496103432, 'auprc': 0.5801238773844789, 'loss_val': 0.8961557502827909, 'psi': 0.5674616407199975}-{'f1_val': 0.6006438292588486, 'auprc': 0.5741225590375902, 'loss_val': 0.7760110058596802, 'psi': 0.5900353211703453}
[S14] START round=19 head_norm_before_train=1.837436 (no previous merge yet)
[S14] round=19 local utility u=0.003096 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9992040110328585, 'loss_val': 0.04140969765009513, 'psi': 0.9985190243223512}-{'f1_val': 0.9978195179672185, 'auprc': 0.9992224457311597, 'loss_val': 0.04619917902252877, 'psi': 0.9983806890727949}
[S15] START round=19 head_norm_before_train=1.600688 cos_to_last_merge=0.9988 (last merge round=17)
[S15] round=19 local utility u=0.083013 metrics={'f1_val': 0.860476279287961, 'auprc': 0.9925194364228285, 'loss_val': 0.25609384290373055, 'psi': 0.9132935421419079}-{'f1_val': 0.833744513064115, 'auprc': 0.9944021378889424, 'loss_val': 0.26737748097211506, 'psi': 0.898007562994046}
[S16] START round=19 head_norm_before_train=1.430626 cos_to_last_merge=0.8084 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.808
[S16] round=19 local utility u=0.283623 metrics={'f1_val': 0.8708335466969463, 'auprc': 0.993978404072059, 'loss_val': 0.42748943424477814, 'psi': 0.9200914896469914}-{'f1_val': 0.8275280750798315, 'auprc': 0.9927197746035055, 'loss_val': 0.7311259144460164, 'psi': 0.8936047548893011}
[S17] START round=19 head_norm_before_train=0.915046 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.076118 metrics={'f1_val': 0.35332541874877144, 'auprc': 0.6612564578198769, 'loss_val': 0.940082251802698, 'psi': 0.4764978343772136}-{'f1_val': 0.35332541874877144, 'auprc': 0.6088506244211819, 'loss_val': 0.9351004300049411, 'psi': 0.45553550101773566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:61010
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:61009
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:61015
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=-0.0074
[S8] DROPPED delta from S14 (cos=-0.0074 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=0.9985
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.0017
[S9] RECEIVED delta(kind=head bytes=1793) from S15
[S9] cosine check vs S15: cos=0.9704
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] cosine check vs S8: cos=0.9761
[S8] RECEIVED delta(kind=head bytes=1797) from S4
[S8] cosine check vs S4: cos=-0.1141
[S8] DROPPED delta from S4 (cos=-0.1141 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1807) from S11
[S8] cosine check vs S11: cos=-0.0583
[S8] DROPPED delta from S11 (cos=-0.0583 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S7
[S17] cosine check vs S7: cos=0.8035
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:61013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:61008
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.7759
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=0.7630
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:61017
[S6] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.4141
[S2] r=20 psi=0.894 u=0.0290 p_local=0.1193 f1=0.830 auprc=0.991 bytes=21549
[S4] r=20 psi=0.946 u=0.0799 p_local=0.1440 f1=0.943 auprc=0.952 bytes=17974
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9942 head_norm=1.680169
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.639880e-02
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9942 head_norm=1.678196 delta_norm=0.046399
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.996 u=0.0203 p_local=0.1216 f1=0.994 auprc=0.998 bytes=17970
[S11] r=20 psi=0.972 u=0.0358 p_local=0.2200 f1=0.955 auprc=0.998 bytes=21584
[S5] r=20 psi=0.816 u=0.0000 p_local=0.0841 f1=0.700 auprc=0.990 bytes=19775
[S3] r=20 psi=0.821 u=0.0000 p_local=0.1577 f1=0.723 auprc=0.969 bytes=14383
[S10] r=20 psi=0.993 u=0.0105 p_local=0.1232 f1=0.993 auprc=0.993 bytes=19777
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.5590 head_norm=0.984575
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.245688e-01
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.5599 head_norm=0.912666 delta_norm=0.324569
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.567 u=0.0000 p_local=0.1242 f1=0.559 auprc=0.580 bytes=17935
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9981 head_norm=1.866389
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.286920e+00
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9978 head_norm=1.289047 delta_norm=1.286920
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.999 u=0.0031 p_local=0.1240 f1=0.998 auprc=0.999 bytes=21577
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9914 head_norm=1.592975
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.974732e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9922 head_norm=1.601723 delta_norm=0.197473
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.994 u=0.0000 p_local=0.0615 f1=0.991 auprc=0.998 bytes=18001
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.8605 head_norm=1.634459
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.824649e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.8777 head_norm=1.647398 delta_norm=0.182465
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.913 u=0.0830 p_local=0.1883 f1=0.860 auprc=0.993 bytes=17958
[S16] r=20 psi=0.920 u=0.2836 p_local=0.2448 f1=0.871 auprc=0.994 bytes=17965
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.7137 head_norm=0.994741
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.784046e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.7143 head_norm=1.158734 delta_norm=0.478405
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.798 u=0.1217 p_local=0.0976 f1=0.714 auprc=0.925 bytes=16159
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.3533 head_norm=0.952480
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.239472e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.3533 head_norm=0.915624 delta_norm=0.423947
[S17] aggregate: ACCEPT kept=['S7', 'S6'] (k=2/2) mode=median trim_p=0.1
[S17] r=20 psi=0.476 u=0.0761 p_local=0.0727 f1=0.353 auprc=0.661 bytes=14359
[S6] r=20 psi=0.957 u=1.0000 p_local=0.4377 f1=0.959 auprc=0.954 bytes=16182
[S2] START round=20 head_norm_before_train=1.677505 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.8343348333315348, 'auprc': 0.9690382228044139, 'loss_val': 0.2522431092297158, 'psi': 0.8882161891206865}-{'f1_val': 0.8301612256014697, 'auprc': 0.9910081494641145, 'loss_val': 0.20237048295118665, 'psi': 0.8944999951465276}
[S3] START round=20 head_norm_before_train=2.001930 (no previous merge yet)
[S3] round=20 local utility u=0.686984 metrics={'f1_val': 0.8677398879544747, 'auprc': 0.996601894170401, 'loss_val': 0.25810698840295476, 'psi': 0.9192846904408452}-{'f1_val': 0.7230610351121618, 'auprc': 0.968665025251941, 'loss_val': 0.6801910771711602, 'psi': 0.8213026311680736}
[S4] START round=20 head_norm_before_train=1.765522 (no previous merge yet)
[S4] round=20 local utility u=0.036552 metrics={'f1_val': 0.9434803272620292, 'auprc': 0.9700999865162547, 'loss_val': 0.2603384770870392, 'psi': 0.9541281909637194}-{'f1_val': 0.9425234102047243, 'auprc': 0.9521252753882758, 'loss_val': 0.27377697091106923, 'psi': 0.9463641562781449}
[S5] START round=20 head_norm_before_train=1.524876 cos_to_last_merge=0.8226 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.823
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.8676576791714461, 'loss_val': 0.312552498018331, 'psi': 0.767455262396034}-{'f1_val': 0.700407554886547, 'auprc': 0.9900429271536471, 'loss_val': 0.21065310053919736, 'psi': 0.816261703793387}
[S6] START round=20 head_norm_before_train=1.409530 cos_to_last_merge=0.8100 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.810
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8229316412601138, 'auprc': 0.9464751105331344, 'loss_val': 0.29737800446117496, 'psi': 0.872349028969322}-{'f1_val': 0.959032644490867, 'auprc': 0.9538395950934464, 'loss_val': 0.24319888803942635, 'psi': 0.9569554247318988}
[S7] START round=20 head_norm_before_train=1.158734 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.6878311033894584, 'auprc': 0.9243955312977448, 'loss_val': 0.43066886372101265, 'psi': 0.7824568745527729}-{'f1_val': 0.7137073324812948, 'auprc': 0.9245186122858484, 'loss_val': 0.4740579874485207, 'psi': 0.7980318444031163}
[S8] START round=20 head_norm_before_train=1.678196 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.005218 metrics={'f1_val': 0.9941986149874398, 'auprc': 0.9973763059622508, 'loss_val': 0.11306908595070687, 'psi': 0.9954696913773642}-{'f1_val': 0.9941986149874398, 'auprc': 0.9975740355485343, 'loss_val': 0.12409927145873122, 'psi': 0.9955487832118776}
[S9] START round=20 head_norm_before_train=1.601723 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.009504 metrics={'f1_val': 0.992650224600626, 'auprc': 0.999344647738934, 'loss_val': 0.14942745979820338, 'psi': 0.9953279938559492}-{'f1_val': 0.9913526543442172, 'auprc': 0.9980800890884062, 'loss_val': 0.15685730252573193, 'psi': 0.9940436282418927}
[S10] START round=20 head_norm_before_train=1.775444 (no previous merge yet)
[S10] round=20 local utility u=0.009245 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9941541139910954, 'loss_val': 0.08915580864693129, 'psi': 0.9934335916142332}-{'f1_val': 0.993391017001491, 'auprc': 0.9926124032953231, 'loss_val': 0.10564801354888019, 'psi': 0.9930795715190238}
[S11] START round=20 head_norm_before_train=1.286913 cos_to_last_merge=0.9992 (last merge round=18)
[S11] round=20 local utility u=0.027133 metrics={'f1_val': 0.9583017359231194, 'auprc': 0.9985106849889469, 'loss_val': 0.22421038199590956, 'psi': 0.9743853155494504}-{'f1_val': 0.9552034538751127, 'auprc': 0.997665234067251, 'loss_val': 0.25735054374267463, 'psi': 0.972188165951968}
[S13] START round=20 head_norm_before_train=0.912666 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.222260 metrics={'f1_val': 0.6075018312810653, 'auprc': 0.5959774806252193, 'loss_val': 0.7900859791080469, 'psi': 0.6028920910187269}-{'f1_val': 0.5590201496103432, 'auprc': 0.5801238773844789, 'loss_val': 0.8961557502827909, 'psi': 0.5674616407199975}
[S14] START round=20 head_norm_before_train=1.289047 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9991986690909684, 'loss_val': 0.18859190349772165, 'psi': 0.9983711784167184}-{'f1_val': 0.9980623665153463, 'auprc': 0.9992040110328585, 'loss_val': 0.04140969765009513, 'psi': 0.9985190243223512}
[S15] START round=20 head_norm_before_train=1.647398 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.7012812424328441, 'auprc': 0.9707125616508007, 'loss_val': 0.283556018933098, 'psi': 0.8090537701200267}-{'f1_val': 0.860476279287961, 'auprc': 0.9925194364228285, 'loss_val': 0.25609384290373055, 'psi': 0.9132935421419079}
[S16] START round=20 head_norm_before_train=1.467502 cos_to_last_merge=0.8041 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.804
[S16] round=20 local utility u=0.350257 metrics={'f1_val': 0.9444929490875269, 'auprc': 0.994322186711958, 'loss_val': 0.16996359604239103, 'psi': 0.9644246441372993}-{'f1_val': 0.8708335466969463, 'auprc': 0.993978404072059, 'loss_val': 0.42748943424477814, 'psi': 0.9200914896469914}
[S17] START round=20 head_norm_before_train=0.915624 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.035471 metrics={'f1_val': 0.35332541874877144, 'auprc': 0.6825909777863997, 'loss_val': 0.9331445376349746, 'psi': 0.4850316423638227}-{'f1_val': 0.35332541874877144, 'auprc': 0.6612564578198769, 'loss_val': 0.940082251802698, 'psi': 0.4764978343772136}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61015
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:61017
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:61009
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S3
[S11] cosine check vs S3: cos=0.6191
[S7] RECEIVED delta(kind=head bytes=1802) from S16
[S7] cosine check vs S16: cos=0.9534
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] cosine check vs S4: cos=-0.1141
[S8] DROPPED delta from S4 (cos=-0.1141 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] cosine check vs S9: cos=0.3676
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] cosine check vs S13: cos=0.7969
[S8] RECEIVED delta(kind=head bytes=1805) from S11
[S8] cosine check vs S11: cos=-0.0589
[S8] DROPPED delta from S11 (cos=-0.0589 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=0.9891
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.6643
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=0.9308
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9978 head_norm=1.333737
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.741223e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9974 head_norm=1.429577 delta_norm=0.674122
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.099 → S8@127.0.0.1:61009
[S2] ⇄ pheromone p=0.095 → S8@127.0.0.1:61009
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6878 head_norm=1.185334
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.995234e-02
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.6993 head_norm=1.140925 delta_norm=0.099952
[S7] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.078 → S17@127.0.0.1:61017
[S5] ⇄ pheromone p=0.067 → S11@127.0.0.1:61012
[S6] ⇄ pheromone p=0.350 → S17@127.0.0.1:61017
[S10] ⇄ pheromone p=0.100 → S14@127.0.0.1:61014
[S9] ⇄ pheromone p=0.051 → S17@127.0.0.1:61017
[S3] ⇄ pheromone p=0.264 → S11@127.0.0.1:61012
[S8] ⇄ pheromone p=0.098 → S15@127.0.0.1:61015
[S16] ⇄ pheromone p=0.266 → S7@127.0.0.1:61008
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.6075 head_norm=0.939485
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.757000e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.6093 head_norm=0.927809 delta_norm=0.175700
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.144 → S7@127.0.0.1:61008
[S4] ⇄ pheromone p=0.122 → S8@127.0.0.1:61009
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.9583 head_norm=1.324441
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.965578e-01
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.9540 head_norm=1.515429 delta_norm=0.796558
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.181 → S8@127.0.0.1:61009
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.7013 head_norm=1.677284
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.250008e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.7013 head_norm=1.684349 delta_norm=0.125001
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.151 → S9@127.0.0.1:61010
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.3533 head_norm=0.949087
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.868088e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.3533 head_norm=1.093265 delta_norm=0.786809
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.065 → S13@127.0.0.1:61013
[S2] START round=21 head_norm_before_train=1.695572 (no previous merge yet)
[S2] round=21 local utility u=0.544819 metrics={'f1_val': 0.9882416197797638, 'auprc': 0.9845683995101052, 'loss_val': 0.13263707313666268, 'psi': 0.9867723316719004}-{'f1_val': 0.8343348333315348, 'auprc': 0.9690382228044139, 'loss_val': 0.2522431092297158, 'psi': 0.8882161891206865}
[S3] START round=21 head_norm_before_train=2.026800 (no previous merge yet)
[S3] round=21 local utility u=0.314502 metrics={'f1_val': 0.9488660557509185, 'auprc': 0.9969723517666548, 'loss_val': 0.11697141830741624, 'psi': 0.9681085741572131}-{'f1_val': 0.8677398879544747, 'auprc': 0.996601894170401, 'loss_val': 0.25810698840295476, 'psi': 0.9192846904408452}
[S4] START round=21 head_norm_before_train=1.783612 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9407801881977829, 'auprc': 0.9650179813570265, 'loss_val': 0.26619669894975767, 'psi': 0.9504753054614803}-{'f1_val': 0.9434803272620292, 'auprc': 0.9700999865162547, 'loss_val': 0.2603384770870392, 'psi': 0.9541281909637194}
[S5] START round=21 head_norm_before_train=1.535810 cos_to_last_merge=0.8212 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.821
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.6471304522983473, 'auprc': 0.8539407405533846, 'loss_val': 0.39438347500403176, 'psi': 0.7298545676003623}-{'f1_val': 0.7006536512124258, 'auprc': 0.8676576791714461, 'loss_val': 0.312552498018331, 'psi': 0.767455262396034}
[S6] START round=21 head_norm_before_train=1.437201 cos_to_last_merge=0.8049 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.805
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.8210552619405374, 'auprc': 0.9340688358381716, 'loss_val': 0.3155378175477722, 'psi': 0.866260691499591}-{'f1_val': 0.8229316412601138, 'auprc': 0.9464751105331344, 'loss_val': 0.29737800446117496, 'psi': 0.872349028969322}
[S7] START round=21 head_norm_before_train=1.140925 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.069193 metrics={'f1_val': 0.6876570634040002, 'auprc': 0.9692278819556197, 'loss_val': 0.4257366372895068, 'psi': 0.8002853908246481}-{'f1_val': 0.6878311033894584, 'auprc': 0.9243955312977448, 'loss_val': 0.43066886372101265, 'psi': 0.7824568745527729}
[S8] START round=21 head_norm_before_train=1.700597 cos_to_last_merge=0.9998 (last merge round=19)
[S8] round=21 local utility u=0.009385 metrics={'f1_val': 0.9941986149874398, 'auprc': 0.9979191710269021, 'loss_val': 0.09592807787054634, 'psi': 0.9956868374032246}-{'f1_val': 0.9941986149874398, 'auprc': 0.9973763059622508, 'loss_val': 0.11306908595070687, 'psi': 0.9954696913773642}
[S9] START round=21 head_norm_before_train=1.651613 cos_to_last_merge=0.9974 (last merge round=19)
[S9] round=21 local utility u=0.034389 metrics={'f1_val': 0.996398546385143, 'auprc': 0.9946070161269048, 'loss_val': 0.08892631536137185, 'psi': 0.9956819342818478}-{'f1_val': 0.992650224600626, 'auprc': 0.999344647738934, 'loss_val': 0.14942745979820338, 'psi': 0.9953279938559492}
[S10] START round=21 head_norm_before_train=1.793713 (no previous merge yet)
[S10] round=21 local utility u=0.008253 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9954945912911481, 'loss_val': 0.07667108524720413, 'psi': 0.9939697825342544}-{'f1_val': 0.9929532433629917, 'auprc': 0.9941541139910954, 'loss_val': 0.08915580864693129, 'psi': 0.9934335916142332}
[S11] START round=21 head_norm_before_train=1.515429 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.154171 metrics={'f1_val': 0.9971333159512151, 'auprc': 0.9989106368980643, 'loss_val': 0.15005848545432085, 'psi': 0.9978442443299548}-{'f1_val': 0.9583017359231194, 'auprc': 0.9985106849889469, 'loss_val': 0.22421038199590956, 'psi': 0.9743853155494504}
[S13] START round=21 head_norm_before_train=0.927809 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6030901587519067, 'auprc': 0.5972795082733586, 'loss_val': 0.8203855243694294, 'psi': 0.6007658985604876}-{'f1_val': 0.6075018312810653, 'auprc': 0.5959774806252193, 'loss_val': 0.7900859791080469, 'psi': 0.6028920910187269}
[S14] START round=21 head_norm_before_train=1.429577 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9987376713737044, 'loss_val': 0.3952775600767043, 'psi': 0.9983324884586896}-{'f1_val': 0.9978195179672185, 'auprc': 0.9991986690909684, 'loss_val': 0.18859190349772165, 'psi': 0.9983711784167184}
[S15] START round=21 head_norm_before_train=1.684349 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.970461 metrics={'f1_val': 0.9956069595145758, 'auprc': 0.9907212847160618, 'loss_val': 0.16861415885996214, 'psi': 0.9936526895951702}-{'f1_val': 0.7012812424328441, 'auprc': 0.9707125616508007, 'loss_val': 0.283556018933098, 'psi': 0.8090537701200267}
[S16] START round=21 head_norm_before_train=1.500755 cos_to_last_merge=0.8012 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.801
[S16] round=21 local utility u=0.164560 metrics={'f1_val': 0.9909157294516636, 'auprc': 0.9917777873829703, 'loss_val': 0.11174662154988438, 'psi': 0.9912605526241862}-{'f1_val': 0.9444929490875269, 'auprc': 0.994322186711958, 'loss_val': 0.16996359604239103, 'psi': 0.9644246441372993}
[S17] START round=21 head_norm_before_train=1.093265 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.35317771804322007, 'auprc': 0.6088699506255333, 'loss_val': 0.9555581203865993, 'psi': 0.4554546110761454}-{'f1_val': 0.35332541874877144, 'auprc': 0.6825909777863997, 'loss_val': 0.9331445376349746, 'psi': 0.4850316423638227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:61017
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61009
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61014
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:61010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S11] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.9448
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] cosine check vs S3: cos=0.9354
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=0.9966
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9137
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.9948
[S9] RECEIVED delta(kind=head bytes=1802) from S15
[S9] cosine check vs S15: cos=0.9519
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] cosine check vs S9: cos=0.9077
[S8] RECEIVED delta(kind=head bytes=1803) from S11
[S8] cosine check vs S11: cos=-0.0477
[S8] DROPPED delta from S11 (cos=-0.0477 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] cosine check vs S7: cos=0.5144
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9981 head_norm=1.459299
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.831567e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9756 head_norm=1.603664 delta_norm=0.383157
[S14] aggregate: ROLLBACK (f1_val pre=0.998 post=0.976 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9942 head_norm=1.721919
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.087077e-02
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9942 head_norm=1.715866 delta_norm=0.070871
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.6877 head_norm=1.162046
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.890798e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.6986 head_norm=1.329237 delta_norm=0.289080
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9964 head_norm=1.706674
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.649530e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9964 head_norm=1.687234 delta_norm=0.264953
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9971 head_norm=1.547646
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.061935e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9925 head_norm=1.769027 delta_norm=0.406194
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.9956 head_norm=1.709147
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.765871e-02
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.9952 head_norm=1.713304 delta_norm=0.087659
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.3532 head_norm=1.118358
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.599150e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.3532 head_norm=1.107294 delta_norm=0.159915
[S17] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.712726 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.9313470480624948, 'auprc': 0.994532972006522, 'loss_val': 0.1449406058873681, 'psi': 0.9566214176401057}-{'f1_val': 0.9882416197797638, 'auprc': 0.9845683995101052, 'loss_val': 0.13263707313666268, 'psi': 0.9867723316719004}
[S3] START round=22 head_norm_before_train=2.047849 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9246796874411831, 'auprc': 0.9895368956217968, 'loss_val': 0.172345561826048, 'psi': 0.9506225707134286}-{'f1_val': 0.9488660557509185, 'auprc': 0.9969723517666548, 'loss_val': 0.11697141830741624, 'psi': 0.9681085741572131}
[S4] START round=22 head_norm_before_train=1.806099 (no previous merge yet)
[S4] round=22 local utility u=0.070333 metrics={'f1_val': 0.9565214450164281, 'auprc': 0.971851272662763, 'loss_val': 0.24047807462076942, 'psi': 0.9626533760749622}-{'f1_val': 0.9407801881977829, 'auprc': 0.9650179813570265, 'loss_val': 0.26619669894975767, 'psi': 0.9504753054614803}
[S5] START round=22 head_norm_before_train=1.542743 cos_to_last_merge=0.8203 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.820
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.6016229462527302, 'auprc': 0.8560622118501239, 'loss_val': 0.4744994809348053, 'psi': 0.7033986524916876}-{'f1_val': 0.6471304522983473, 'auprc': 0.8539407405533846, 'loss_val': 0.39438347500403176, 'psi': 0.7298545676003623}
[S6] START round=22 head_norm_before_train=1.467581 cos_to_last_merge=0.8001 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.800
[S6] round=22 local utility u=0.209562 metrics={'f1_val': 0.8627333439868645, 'auprc': 0.9550602259123284, 'loss_val': 0.20945728136431666, 'psi': 0.8996640967570502}-{'f1_val': 0.8210552619405374, 'auprc': 0.9340688358381716, 'loss_val': 0.3155378175477722, 'psi': 0.866260691499591}
[S7] START round=22 head_norm_before_train=1.329237 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.6764524392373721, 'auprc': 0.9014868432882879, 'loss_val': 0.4149594226648322, 'psi': 0.7664662008577384}-{'f1_val': 0.6876570634040002, 'auprc': 0.9692278819556197, 'loss_val': 0.4257366372895068, 'psi': 0.8002853908246481}
[S8] START round=22 head_norm_before_train=1.715866 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.7145254456069222, 'auprc': 0.9918727158561285, 'loss_val': 0.3766088805031531, 'psi': 0.8254643537066048}-{'f1_val': 0.9941986149874398, 'auprc': 0.9979191710269021, 'loss_val': 0.09592807787054634, 'psi': 0.9956868374032246}
[S9] START round=22 head_norm_before_train=1.687234 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9091395862480188, 'auprc': 0.9690384265581121, 'loss_val': 0.20859062416081886, 'psi': 0.9330991223720562}-{'f1_val': 0.996398546385143, 'auprc': 0.9946070161269048, 'loss_val': 0.08892631536137185, 'psi': 0.9956819342818478}
[S10] START round=22 head_norm_before_train=1.818665 (no previous merge yet)
[S10] round=22 local utility u=0.003559 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9947541157507269, 'loss_val': 0.06733219026612813, 'psi': 0.9936735923180858}-{'f1_val': 0.9929532433629917, 'auprc': 0.9954945912911481, 'loss_val': 0.07667108524720413, 'psi': 0.9939697825342544}
[S11] START round=22 head_norm_before_train=1.769027 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.010793 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988957136896028, 'loss_val': 0.12741332477972786, 'psi': 0.9977368394515874}-{'f1_val': 0.9971333159512151, 'auprc': 0.9989106368980643, 'loss_val': 0.15005848545432085, 'psi': 0.9978442443299548}
[S13] START round=22 head_norm_before_train=0.949746 cos_to_last_merge=0.9979 (last merge round=20)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5626375925950816, 'auprc': 0.5680373856199455, 'loss_val': 0.9156115697453134, 'psi': 0.5647975098050272}-{'f1_val': 0.6030901587519067, 'auprc': 0.5972795082733586, 'loss_val': 0.8203855243694294, 'psi': 0.6007658985604876}
[S14] START round=22 head_norm_before_train=1.603664 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9938520103037034, 'auprc': 0.998662551106947, 'loss_val': 0.4623581486639015, 'psi': 0.9957762266250008}-{'f1_val': 0.9980623665153463, 'auprc': 0.9987376713737044, 'loss_val': 0.3952775600767043, 'psi': 0.9983324884586896}
[S15] START round=22 head_norm_before_train=1.713304 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.8177755303370089, 'auprc': 0.9916667241623401, 'loss_val': 0.28289469813690715, 'psi': 0.8873320078671414}-{'f1_val': 0.9956069595145758, 'auprc': 0.9907212847160618, 'loss_val': 0.16861415885996214, 'psi': 0.9936526895951702}
[S16] START round=22 head_norm_before_train=1.533143 cos_to_last_merge=0.7986 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.799
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8515237309373318, 'auprc': 0.9927691686577049, 'loss_val': 0.593224784678389, 'psi': 0.908021906025481}-{'f1_val': 0.9909157294516636, 'auprc': 0.9917777873829703, 'loss_val': 0.11174662154988438, 'psi': 0.9912605526241862}
[S17] START round=22 head_norm_before_train=1.107294 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.028305 metrics={'f1_val': 0.35317771804322007, 'auprc': 0.6279052458825134, 'loss_val': 0.9560534792213269, 'psi': 0.4630687291789374}-{'f1_val': 0.35317771804322007, 'auprc': 0.6088699506255333, 'loss_val': 0.9555581203865993, 'psi': 0.4554546110761454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:61009
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:61014
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:61017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.9664
[S8] RECEIVED delta(kind=head bytes=1795) from S11
[S8] cosine check vs S11: cos=-0.0412
[S8] DROPPED delta from S11 (cos=-0.0412 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.2095
[S8] RECEIVED delta(kind=head bytes=1796) from S4
[S8] cosine check vs S4: cos=-0.1137
[S8] DROPPED delta from S4 (cos=-0.1137 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S17
[S13] cosine check vs S17: cos=0.7581
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9939 head_norm=1.626606
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.502039e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9737 head_norm=1.722031 delta_norm=0.250204
[S14] aggregate: ROLLBACK (f1_val pre=0.994 post=0.974 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.5626 head_norm=0.973622
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.739162e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.5641 head_norm=0.988023 delta_norm=0.373916
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.3532 head_norm=1.133166
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.377890e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.3535 head_norm=1.027936 delta_norm=0.837789
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.722456 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7860644297222632, 'auprc': 0.8955498878659441, 'loss_val': 0.30255035206017855, 'psi': 0.8298586129797356}-{'f1_val': 0.9313470480624948, 'auprc': 0.994532972006522, 'loss_val': 0.1449406058873681, 'psi': 0.9566214176401057}
[S3] START round=23 head_norm_before_train=2.068530 (no previous merge yet)
[S3] round=23 local utility u=0.037225 metrics={'f1_val': 0.9275338747488857, 'auprc': 0.997183359302418, 'loss_val': 0.13795937798536487, 'psi': 0.9553936685702986}-{'f1_val': 0.9246796874411831, 'auprc': 0.9895368956217968, 'loss_val': 0.172345561826048, 'psi': 0.9506225707134286}
[S4] START round=23 head_norm_before_train=1.824064 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.938215478601368, 'auprc': 0.9439066027148268, 'loss_val': 0.2859341393470394, 'psi': 0.9404919282467515}-{'f1_val': 0.9565214450164281, 'auprc': 0.971851272662763, 'loss_val': 0.24047807462076942, 'psi': 0.9626533760749622}
[S5] START round=23 head_norm_before_train=1.555272 cos_to_last_merge=0.8193 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.819
[S5] round=23 local utility u=0.257981 metrics={'f1_val': 0.6582541159708963, 'auprc': 0.8779718022640008, 'loss_val': 0.36405385778248794, 'psi': 0.7461411904881381}-{'f1_val': 0.6016229462527302, 'auprc': 0.8560622118501239, 'loss_val': 0.4744994809348053, 'psi': 0.7033986524916876}
[S6] START round=23 head_norm_before_train=1.494329 cos_to_last_merge=0.7967 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.797
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.5758641130577538, 'auprc': 0.7792253901932209, 'loss_val': 0.8857037919175178, 'psi': 0.6572086239119406}-{'f1_val': 0.8627333439868645, 'auprc': 0.9550602259123284, 'loss_val': 0.20945728136431666, 'psi': 0.8996640967570502}
[S7] START round=23 head_norm_before_train=1.349223 cos_to_last_merge=0.9993 (last merge round=21)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.6217248751548607, 'auprc': 0.8231533997119816, 'loss_val': 0.524763628914451, 'psi': 0.702296284977709}-{'f1_val': 0.6764524392373721, 'auprc': 0.9014868432882879, 'loss_val': 0.4149594226648322, 'psi': 0.7664662008577384}
[S8] START round=23 head_norm_before_train=1.736146 cos_to_last_merge=0.9998 (last merge round=21)
[S8] round=23 local utility u=0.985401 metrics={'f1_val': 0.991372388611257, 'auprc': 0.9989757115582992, 'loss_val': 0.08819753255102203, 'psi': 0.9944137177900738}-{'f1_val': 0.7145254456069222, 'auprc': 0.9918727158561285, 'loss_val': 0.3766088805031531, 'psi': 0.8254643537066048}
[S9] START round=23 head_norm_before_train=1.738105 cos_to_last_merge=0.9982 (last merge round=21)
[S9] round=23 local utility u=0.374107 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991689271423951, 'loss_val': 0.07854868438917768, 'psi': 0.9979293183642437}-{'f1_val': 0.9091395862480188, 'auprc': 0.9690384265581121, 'loss_val': 0.20859062416081886, 'psi': 0.9330991223720562}
[S10] START round=23 head_norm_before_train=1.846656 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9936984912981479, 'auprc': 0.9920533126669708, 'loss_val': 0.0719345023307286, 'psi': 0.993040419845677}-{'f1_val': 0.9929532433629917, 'auprc': 0.9947541157507269, 'loss_val': 0.06733219026612813, 'psi': 0.9936735923180858}
[S11] START round=23 head_norm_before_train=1.795866 cos_to_last_merge=0.9996 (last merge round=21)
[S11] round=23 local utility u=0.019064 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.999270643604315, 'loss_val': 0.09041037334614216, 'psi': 0.9978868114174723}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988957136896028, 'loss_val': 0.12741332477972786, 'psi': 0.9977368394515874}
[S13] START round=23 head_norm_before_train=0.988023 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.072110 metrics={'f1_val': 0.5761453950874734, 'auprc': 0.5816897951981447, 'loss_val': 0.8933965452289131, 'psi': 0.578363155131742}-{'f1_val': 0.5626375925950816, 'auprc': 0.5680373856199455, 'loss_val': 0.9156115697453134, 'psi': 0.5647975098050272}
[S14] START round=23 head_norm_before_train=1.722031 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9586973704332523, 'auprc': 0.9969424525927228, 'loss_val': 0.4117501499301329, 'psi': 0.9739954032970405}-{'f1_val': 0.9938520103037034, 'auprc': 0.998662551106947, 'loss_val': 0.4623581486639015, 'psi': 0.9957762266250008}
[S15] START round=23 head_norm_before_train=1.737497 cos_to_last_merge=0.9993 (last merge round=21)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7709561880909128, 'auprc': 0.9856514377256653, 'loss_val': 0.287388190753362, 'psi': 0.8568342879448139}-{'f1_val': 0.8177755303370089, 'auprc': 0.9916667241623401, 'loss_val': 0.28289469813690715, 'psi': 0.8873320078671414}
[S16] START round=23 head_norm_before_train=1.563022 cos_to_last_merge=0.7962 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.796
[S16] round=23 local utility u=0.474636 metrics={'f1_val': 0.9400722287331895, 'auprc': 0.9932907820849781, 'loss_val': 0.17680892141705637, 'psi': 0.961359650073905}-{'f1_val': 0.8515237309373318, 'auprc': 0.9927691686577049, 'loss_val': 0.593224784678389, 'psi': 0.908021906025481}
[S17] START round=23 head_norm_before_train=1.027936 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.099288 metrics={'f1_val': 0.3531854579089863, 'auprc': 0.6945481707076098, 'loss_val': 0.9574534745863162, 'psi': 0.4897305430284357}-{'f1_val': 0.35317771804322007, 'auprc': 0.6279052458825134, 'loss_val': 0.9560534792213269, 'psi': 0.4630687291789374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:61008
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61015
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:61009
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:61017
[S9] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.9924
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] cosine check vs S3: cos=0.9826
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] cosine check vs S9: cos=0.4061
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:61013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61008
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] cosine check vs S16: cos=0.9811
[S13] RECEIVED delta(kind=head bytes=1804) from S17
[S13] cosine check vs S17: cos=0.8231
[S13] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S11
[S8] cosine check vs S11: cos=-0.0429
[S8] DROPPED delta from S11 (cos=-0.0429 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1806) from S13
[S7] cosine check vs S13: cos=0.6685
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:61012
[S5] sending update (kind=head size=1793 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1793) from S5
[S11] cosine check vs S5: cos=0.2214
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6217 head_norm=1.374918
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.000187e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6309 head_norm=1.255928 delta_norm=0.200019
[S7] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.5761 head_norm=1.011341
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.077593e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.5776 head_norm=0.985842 delta_norm=0.307759
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9970 head_norm=1.821497
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.337670e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9970 head_norm=1.539396 delta_norm=0.433767
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.7710 head_norm=1.763992
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.087411e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.7713 head_norm=1.756683 delta_norm=0.108741
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.3532 head_norm=1.053751
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.280901e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.3526 head_norm=1.202235 delta_norm=0.828090
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.729514 (no previous merge yet)
[S2] round=24 local utility u=0.387918 metrics={'f1_val': 0.8844218446244305, 'auprc': 0.930020931727244, 'loss_val': 0.2202714358790441, 'psi': 0.9026614794655559}-{'f1_val': 0.7860644297222632, 'auprc': 0.8955498878659441, 'loss_val': 0.30255035206017855, 'psi': 0.8298586129797356}
[S3] START round=24 head_norm_before_train=2.084495 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.882607090248582, 'auprc': 0.9962093969773941, 'loss_val': 0.22795702378192095, 'psi': 0.9280480129401069}-{'f1_val': 0.9275338747488857, 'auprc': 0.997183359302418, 'loss_val': 0.13795937798536487, 'psi': 0.9553936685702986}
[S4] START round=24 head_norm_before_train=1.835691 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9389893400976221, 'auprc': 0.9304163196913222, 'loss_val': 0.280662086610023, 'psi': 0.9355601319351022}-{'f1_val': 0.938215478601368, 'auprc': 0.9439066027148268, 'loss_val': 0.2859341393470394, 'psi': 0.9404919282467515}
[S5] START round=24 head_norm_before_train=1.568137 cos_to_last_merge=0.8182 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.818
[S5] round=24 local utility u=0.444931 metrics={'f1_val': 0.7292415546235277, 'auprc': 0.9855835585185627, 'loss_val': 0.22295273737623228, 'psi': 0.8317783561815417}-{'f1_val': 0.6582541159708963, 'auprc': 0.8779718022640008, 'loss_val': 0.36405385778248794, 'psi': 0.7461411904881381}
[S6] START round=24 head_norm_before_train=1.519493 cos_to_last_merge=0.7941 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.794
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.9821301408007802, 'auprc': 0.9583911207940622, 'loss_val': 0.11855276709672576, 'psi': 0.972634532798093}-{'f1_val': 0.5758641130577538, 'auprc': 0.7792253901932209, 'loss_val': 0.8857037919175178, 'psi': 0.6572086239119406}
[S7] START round=24 head_norm_before_train=1.255928 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.6199081054907293, 'auprc': 0.8162907209527901, 'loss_val': 0.5433346009758672, 'psi': 0.6984611516755537}-{'f1_val': 0.6217248751548607, 'auprc': 0.8231533997119816, 'loss_val': 0.524763628914451, 'psi': 0.702296284977709}
[S8] START round=24 head_norm_before_train=1.756090 cos_to_last_merge=0.9994 (last merge round=21)
[S8] round=24 local utility u=0.013109 metrics={'f1_val': 0.9938326055531397, 'auprc': 0.9980470397500364, 'loss_val': 0.07395433983205443, 'psi': 0.9955183792318985}-{'f1_val': 0.991372388611257, 'auprc': 0.9989757115582992, 'loss_val': 0.08819753255102203, 'psi': 0.9944137177900738}
[S9] START round=24 head_norm_before_train=1.775334 cos_to_last_merge=0.9954 (last merge round=21)
[S9] round=24 local utility u=0.003272 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9993232288508475, 'loss_val': 0.06234550288101593, 'psi': 0.9969787910623105}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991689271423951, 'loss_val': 0.07854868438917768, 'psi': 0.9979293183642437}
[S10] START round=24 head_norm_before_train=1.876220 (no previous merge yet)
[S10] round=24 local utility u=0.011522 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9960691269385568, 'loss_val': 0.05515432831736619, 'psi': 0.9940683299435472}-{'f1_val': 0.9936984912981479, 'auprc': 0.9920533126669708, 'loss_val': 0.0719345023307286, 'psi': 0.993040419845677}
[S11] START round=24 head_norm_before_train=1.539396 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9987887900968955, 'loss_val': 0.1008442765965238, 'psi': 0.9975489677876674}-{'f1_val': 0.9969642566262439, 'auprc': 0.999270643604315, 'loss_val': 0.09041037334614216, 'psi': 0.9978868114174723}
[S13] START round=24 head_norm_before_train=0.985842 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.113906 metrics={'f1_val': 0.6029053488683713, 'auprc': 0.5798834262516466, 'loss_val': 0.8207245312945256, 'psi': 0.5936965798216814}-{'f1_val': 0.5761453950874734, 'auprc': 0.5816897951981447, 'loss_val': 0.8933965452289131, 'psi': 0.578363155131742}
[S14] START round=24 head_norm_before_train=1.748181 cos_to_last_merge=0.9965 (last merge round=22)
[S14] round=24 local utility u=0.215768 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9983267489676916, 'loss_val': 0.21416787969255344, 'psi': 0.9975292044816757}-{'f1_val': 0.9586973704332523, 'auprc': 0.9969424525927228, 'loss_val': 0.4117501499301329, 'psi': 0.9739954032970405}
[S15] START round=24 head_norm_before_train=1.756683 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.444960 metrics={'f1_val': 0.8999796413039325, 'auprc': 0.9938246420443304, 'loss_val': 0.19612932847896317, 'psi': 0.9375176416000917}-{'f1_val': 0.7709561880909128, 'auprc': 0.9856514377256653, 'loss_val': 0.287388190753362, 'psi': 0.8568342879448139}
[S16] START round=24 head_norm_before_train=1.590303 cos_to_last_merge=0.7946 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.795
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8646375428002756, 'auprc': 0.9949441212917689, 'loss_val': 0.4721249416103619, 'psi': 0.916760174196873}-{'f1_val': 0.9400722287331895, 'auprc': 0.9932907820849781, 'loss_val': 0.17680892141705637, 'psi': 0.961359650073905}
[S17] START round=24 head_norm_before_train=1.202235 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.35199388000949794, 'auprc': 0.6533206524617821, 'loss_val': 0.9696812866505168, 'psi': 0.4725245889904116}-{'f1_val': 0.3531854579089863, 'auprc': 0.6945481707076098, 'loss_val': 0.9574534745863162, 'psi': 0.4897305430284357}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:61010
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9623
[S11] RECEIVED delta(kind=head bytes=1806) from S5
[S11] cosine check vs S5: cos=0.4090
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=0.7506
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] cosine check vs S9: cos=0.9091
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=0.0202
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] cosine check vs S6: cos=0.2847
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.9958
[S8] RECEIVED delta(kind=head bytes=1803) from S2
[S8] cosine check vs S2: cos=0.9957
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S15
[S9] cosine check vs S15: cos=0.9618
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.6199 head_norm=1.282722
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.246998e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.6253 head_norm=1.077024 delta_norm=0.424700
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9938 head_norm=1.774405
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.343290e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9938 head_norm=1.402141 delta_norm=0.634329
[S8] aggregate: ACCEPT kept=['S14', 'S2'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9954 head_norm=1.811598
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.487889e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9959 head_norm=1.779573 delta_norm=0.248789
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9967 head_norm=1.568089
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.565105e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9967 head_norm=1.322413 delta_norm=0.856510
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.9000 head_norm=1.782039
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.173986e-02
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.9000 head_norm=1.776347 delta_norm=0.081740
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.3520 head_norm=1.227012
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.292156e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.3520 head_norm=1.153981 delta_norm=0.229216
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9970 head_norm=1.791570
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.589562e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9966 head_norm=1.827726 delta_norm=0.258956
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.733552 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.8206708730418817, 'auprc': 0.9928924481495154, 'loss_val': 0.2700493188422064, 'psi': 0.8895595030849353}-{'f1_val': 0.8844218446244305, 'auprc': 0.930020931727244, 'loss_val': 0.2202714358790441, 'psi': 0.9026614794655559}
[S3] START round=25 head_norm_before_train=2.099649 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.7775137122408171, 'auprc': 0.9846283751597351, 'loss_val': 0.6116862792997049, 'psi': 0.8603595774083843}-{'f1_val': 0.882607090248582, 'auprc': 0.9962093969773941, 'loss_val': 0.22795702378192095, 'psi': 0.9280480129401069}
[S4] START round=25 head_norm_before_train=1.842817 (no previous merge yet)
[S4] round=25 local utility u=0.077032 metrics={'f1_val': 0.9465216832833162, 'auprc': 0.95969228687046, 'loss_val': 0.2596196595458561, 'psi': 0.9517899247181738}-{'f1_val': 0.9389893400976221, 'auprc': 0.9304163196913222, 'loss_val': 0.280662086610023, 'psi': 0.9355601319351022}
[S5] START round=25 head_norm_before_train=1.582993 cos_to_last_merge=0.8167 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.817
[S5] round=25 local utility u=0.175063 metrics={'f1_val': 0.8029106895293205, 'auprc': 0.9669914532889833, 'loss_val': 0.2590642429924103, 'psi': 0.8685429950331857}-{'f1_val': 0.7292415546235277, 'auprc': 0.9855835585185627, 'loss_val': 0.22295273737623228, 'psi': 0.8317783561815417}
[S6] START round=25 head_norm_before_train=1.538194 cos_to_last_merge=0.7919 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.792
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6952811141705548, 'auprc': 0.9051723136802181, 'loss_val': 0.6282448563673535, 'psi': 0.77923759397442}-{'f1_val': 0.9821301408007802, 'auprc': 0.9583911207940622, 'loss_val': 0.11855276709672576, 'psi': 0.972634532798093}
[S7] START round=25 head_norm_before_train=1.077024 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.5287247467306486, 'auprc': 0.7852310109219396, 'loss_val': 0.8159827986973808, 'psi': 0.6313272524071649}-{'f1_val': 0.6199081054907293, 'auprc': 0.8162907209527901, 'loss_val': 0.5433346009758672, 'psi': 0.6984611516755537}
[S8] START round=25 head_norm_before_train=1.402141 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9950789820710053, 'auprc': 0.9978146034957174, 'loss_val': 0.13597060726459764, 'psi': 0.9961732306408901}-{'f1_val': 0.9938326055531397, 'auprc': 0.9980470397500364, 'loss_val': 0.07395433983205443, 'psi': 0.9955183792318985}
[S9] START round=25 head_norm_before_train=1.779573 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9892740760156413, 'auprc': 0.9955292963770737, 'loss_val': 0.09860399990651943, 'psi': 0.9917761641602143}-{'f1_val': 0.9954158325366191, 'auprc': 0.9993232288508475, 'loss_val': 0.06234550288101593, 'psi': 0.9969787910623105}
[S10] START round=25 head_norm_before_train=1.898829 (no previous merge yet)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.990526387949847, 'auprc': 0.9966729110445871, 'loss_val': 0.05961555549011923, 'psi': 0.992984997187743}-{'f1_val': 0.9927344652802075, 'auprc': 0.9960691269385568, 'loss_val': 0.05515432831736619, 'psi': 0.9940683299435472}
[S11] START round=25 head_norm_before_train=1.322413 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982753190304599, 'loss_val': 0.15760329077205126, 'psi': 0.9972383303203377}-{'f1_val': 0.9967224195815153, 'auprc': 0.9987887900968955, 'loss_val': 0.1008442765965238, 'psi': 0.9975489677876674}
[S13] START round=25 head_norm_before_train=1.017511 cos_to_last_merge=0.9967 (last merge round=23)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.583007856074228, 'auprc': 0.5521555670392608, 'loss_val': 0.8498971365454095, 'psi': 0.5706669404602411}-{'f1_val': 0.6029053488683713, 'auprc': 0.5798834262516466, 'loss_val': 0.8207245312945256, 'psi': 0.5936965798216814}
[S14] START round=25 head_norm_before_train=1.827726 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.004085 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9985365819481475, 'loss_val': 0.20503735152279065, 'psi': 0.9974541472786556}-{'f1_val': 0.9969975081576651, 'auprc': 0.9983267489676916, 'loss_val': 0.21416787969255344, 'psi': 0.9975292044816757}
[S15] START round=25 head_norm_before_train=1.776347 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.288873 metrics={'f1_val': 0.9857879694872718, 'auprc': 0.998994519160165, 'loss_val': 0.1487419311408271, 'psi': 0.9910705893564291}-{'f1_val': 0.8999796413039325, 'auprc': 0.9938246420443304, 'loss_val': 0.19612932847896317, 'psi': 0.9375176416000917}
[S16] START round=25 head_norm_before_train=1.615157 cos_to_last_merge=0.7929 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.793
[S16] round=25 local utility u=0.182901 metrics={'f1_val': 0.9024887502486894, 'auprc': 0.9960069936110119, 'loss_val': 0.33661780906348704, 'psi': 0.9398960475936183}-{'f1_val': 0.8646375428002756, 'auprc': 0.9949441212917689, 'loss_val': 0.4721249416103619, 'psi': 0.916760174196873}
[S17] START round=25 head_norm_before_train=1.153981 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.290424356272859, 'auprc': 0.6007215144846217, 'loss_val': 1.2581887958706686, 'psi': 0.4145432195575641}-{'f1_val': 0.35199388000949794, 'auprc': 0.6533206524617821, 'loss_val': 0.9696812866505168, 'psi': 0.4725245889904116}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:61009
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:61010
[S14] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=0.9834
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] cosine check vs S5: cos=0.8325
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.8469
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=0.3358
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=-0.1529
[S8] DROPPED delta from S4 (cos=-0.1529 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.5287 head_norm=1.107221
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.579544e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.5331 head_norm=1.321715 delta_norm=0.457954
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.031 → S17@127.0.0.1:61017
[S3] ⇄ pheromone p=0.117 → S11@127.0.0.1:61012
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9951 head_norm=1.430218
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.665822e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9951 head_norm=1.353018 delta_norm=0.966582
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.161 → S15@127.0.0.1:61015
[S13] ⇄ pheromone p=0.075 → S7@127.0.0.1:61008
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9965 head_norm=1.360880
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.404230e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9965 head_norm=1.411800 delta_norm=0.440423
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.076 → S8@127.0.0.1:61009
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9893 head_norm=1.821276
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.654157e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9893 head_norm=1.804484 delta_norm=0.165416
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.068 → S17@127.0.0.1:61017
[S6] ⇄ pheromone p=0.296 → S17@127.0.0.1:61017
[S10] ⇄ pheromone p=0.036 → S14@127.0.0.1:61014
[S2] ⇄ pheromone p=0.138 → S8@127.0.0.1:61009
[S5] ⇄ pheromone p=0.161 → S11@127.0.0.1:61012
[S14] ⇄ pheromone p=0.068 → S8@127.0.0.1:61009
[S4] ⇄ pheromone p=0.063 → S8@127.0.0.1:61009
[S16] ⇄ pheromone p=0.198 → S7@127.0.0.1:61008
[S15] ⇄ pheromone p=0.258 → S9@127.0.0.1:61010
[S17] ⇄ pheromone p=0.037 → S13@127.0.0.1:61013
[S2] START round=26 head_norm_before_train=1.741805 (no previous merge yet)
[S2] round=26 local utility u=0.312648 metrics={'f1_val': 0.9350292818640512, 'auprc': 0.9698602036695633, 'loss_val': 0.2618064304239684, 'psi': 0.948961650586256}-{'f1_val': 0.8206708730418817, 'auprc': 0.9928924481495154, 'loss_val': 0.2700493188422064, 'psi': 0.8895595030849353}
[S3] START round=26 head_norm_before_train=2.113499 (no previous merge yet)
[S3] round=26 local utility u=0.262805 metrics={'f1_val': 0.8285991332494528, 'auprc': 0.9988635550481816, 'loss_val': 0.4352949471617984, 'psi': 0.8967049019689444}-{'f1_val': 0.7775137122408171, 'auprc': 0.9846283751597351, 'loss_val': 0.6116862792997049, 'psi': 0.8603595774083843}
[S4] START round=26 head_norm_before_train=1.849276 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9432939457340221, 'auprc': 0.954049927407828, 'loss_val': 0.264967978519637, 'psi': 0.9475963384035444}-{'f1_val': 0.9465216832833162, 'auprc': 0.95969228687046, 'loss_val': 0.2596196595458561, 'psi': 0.9517899247181738}
[S5] START round=26 head_norm_before_train=1.588178 cos_to_last_merge=0.8166 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.817
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9791792014322664, 'loss_val': 0.3278398208552871, 'psi': 0.8119680002385804}-{'f1_val': 0.8029106895293205, 'auprc': 0.9669914532889833, 'loss_val': 0.2590642429924103, 'psi': 0.8685429950331857}
[S6] START round=26 head_norm_before_train=1.553110 cos_to_last_merge=0.7903 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.790
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.45582843195810413, 'auprc': 0.778733390881289, 'loss_val': 0.9735558680463628, 'psi': 0.5849904155273781}-{'f1_val': 0.6952811141705548, 'auprc': 0.9051723136802181, 'loss_val': 0.6282448563673535, 'psi': 0.77923759397442}
[S7] START round=26 head_norm_before_train=1.321715 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.4215243410103527, 'auprc': 0.7810034065312992, 'loss_val': 0.8207719710111562, 'psi': 0.5653159672187313}-{'f1_val': 0.5287247467306486, 'auprc': 0.7852310109219396, 'loss_val': 0.8159827986973808, 'psi': 0.6313272524071649}
[S8] START round=26 head_norm_before_train=1.353018 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9934090858100645, 'auprc': 0.9970403865455728, 'loss_val': 0.367248636502301, 'psi': 0.9948616061042679}-{'f1_val': 0.9950789820710053, 'auprc': 0.9978146034957174, 'loss_val': 0.13597060726459764, 'psi': 0.9961732306408901}
[S9] START round=26 head_norm_before_train=1.804484 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.023864 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9946078174506562, 'loss_val': 0.0950854237615699, 'psi': 0.9961048744875481}-{'f1_val': 0.9892740760156413, 'auprc': 0.9955292963770737, 'loss_val': 0.09860399990651943, 'psi': 0.9917761641602143}
[S10] START round=26 head_norm_before_train=1.914837 (no previous merge yet)
[S10] round=26 local utility u=0.009327 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9956651633426069, 'loss_val': 0.05118659786105284, 'psi': 0.9939067445051673}-{'f1_val': 0.990526387949847, 'auprc': 0.9966729110445871, 'loss_val': 0.05961555549011923, 'psi': 0.992984997187743}
[S11] START round=26 head_norm_before_train=1.411800 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976723310519506, 'loss_val': 0.18218412556242428, 'psi': 0.996997135128934}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982753190304599, 'loss_val': 0.15760329077205126, 'psi': 0.9972383303203377}
[S13] START round=26 head_norm_before_train=1.051449 cos_to_last_merge=0.9892 (last merge round=23)
[S13] round=26 local utility u=0.139563 metrics={'f1_val': 0.6034146454030523, 'auprc': 0.5722689850838674, 'loss_val': 0.753552497418504, 'psi': 0.5909563812753783}-{'f1_val': 0.583007856074228, 'auprc': 0.5521555670392608, 'loss_val': 0.8498971365454095, 'psi': 0.5706669404602411}
[S14] START round=26 head_norm_before_train=1.866642 cos_to_last_merge=0.9978 (last merge round=24)
[S14] round=26 local utility u=0.040947 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9989649053934418, 'loss_val': 0.12848268647087388, 'psi': 0.9980309238584121}-{'f1_val': 0.9967325241656609, 'auprc': 0.9985365819481475, 'loss_val': 0.20503735152279065, 'psi': 0.9974541472786556}
[S15] START round=26 head_norm_before_train=1.802776 cos_to_last_merge=0.9994 (last merge round=24)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7116744949640734, 'auprc': 0.9855117165888704, 'loss_val': 0.2985702743399827, 'psi': 0.8212093836139922}-{'f1_val': 0.9857879694872718, 'auprc': 0.998994519160165, 'loss_val': 0.1487419311408271, 'psi': 0.9910705893564291}
[S16] START round=26 head_norm_before_train=1.639320 cos_to_last_merge=0.7916 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.792
[S16] round=26 local utility u=0.150359 metrics={'f1_val': 0.9352764271224606, 'auprc': 0.9941960416247543, 'loss_val': 0.22719272694005524, 'psi': 0.9588442729233781}-{'f1_val': 0.9024887502486894, 'auprc': 0.9960069936110119, 'loss_val': 0.33661780906348704, 'psi': 0.9398960475936183}
[S17] START round=26 head_norm_before_train=1.177942 cos_to_last_merge=0.9981 (last merge round=24)
[S17] round=26 local utility u=0.296619 metrics={'f1_val': 0.33749700333953414, 'auprc': 0.6492795907968354, 'loss_val': 1.0930608822145673, 'psi': 0.46221003832245466}-{'f1_val': 0.290424356272859, 'auprc': 0.6007215144846217, 'loss_val': 1.2581887958706686, 'psi': 0.4145432195575641}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:61008
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:61014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:61008
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61009
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.8141
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] cosine check vs S16: cos=0.9727
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] cosine check vs S3: cos=0.3448
[S7] RECEIVED delta(kind=head bytes=1800) from S13
[S7] cosine check vs S13: cos=0.7312
[S8] RECEIVED delta(kind=head bytes=1803) from S2
[S8] cosine check vs S2: cos=0.5462
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] cosine check vs S14: cos=0.8441
[S14] RECEIVED delta(kind=head bytes=1794) from S10
[S14] cosine check vs S10: cos=0.9686
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] cosine check vs S17: cos=0.8404
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.4215 head_norm=1.337856
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.239818e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.4215 head_norm=1.274798 delta_norm=0.123982
[S7] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9934 head_norm=1.381452
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.387450e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9934 head_norm=1.339320 delta_norm=0.138745
[S8] aggregate: ACCEPT kept=['S2', 'S14'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9965 head_norm=1.454430
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.061377e+00
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9970 head_norm=1.480913 delta_norm=1.061377
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9974 head_norm=1.910808
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.405590e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9974 head_norm=1.903674 delta_norm=0.240559
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.6034 head_norm=1.084904
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.278084e-01
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.6058 head_norm=1.096948 delta_norm=0.327808
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.3375 head_norm=1.201869
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.560732e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.3290 head_norm=1.453935 delta_norm=0.556073
[S17] aggregate: ROLLBACK (f1_val pre=0.337 post=0.329 tol_abs=0.005 tol_rel=0.0)
[S2] START round=27 head_norm_before_train=1.750457 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.8612674759512321, 'auprc': 0.9897682045371055, 'loss_val': 0.24134035379377697, 'psi': 0.9126677673855814}-{'f1_val': 0.9350292818640512, 'auprc': 0.9698602036695633, 'loss_val': 0.2618064304239684, 'psi': 0.948961650586256}
[S3] START round=27 head_norm_before_train=2.126943 (no previous merge yet)
[S3] round=27 local utility u=0.416242 metrics={'f1_val': 0.9212890898765012, 'auprc': 0.9989273378928144, 'loss_val': 0.15914115581721533, 'psi': 0.9523443890830265}-{'f1_val': 0.8285991332494528, 'auprc': 0.9988635550481816, 'loss_val': 0.4352949471617984, 'psi': 0.8967049019689444}
[S4] START round=27 head_norm_before_train=1.857913 (no previous merge yet)
[S4] round=27 local utility u=0.027624 metrics={'f1_val': 0.9496843717276011, 'auprc': 0.958038335147059, 'loss_val': 0.26002733262765876, 'psi': 0.9530259570953843}-{'f1_val': 0.9432939457340221, 'auprc': 0.954049927407828, 'loss_val': 0.264967978519637, 'psi': 0.9475963384035444}
[S5] START round=27 head_norm_before_train=1.595833 cos_to_last_merge=0.8162 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.816
[S5] round=27 local utility u=0.780442 metrics={'f1_val': 0.9416808866305283, 'auprc': 0.9833309245377693, 'loss_val': 0.22653290994166614, 'psi': 0.9583409017934246}-{'f1_val': 0.7004938661094564, 'auprc': 0.9791792014322664, 'loss_val': 0.3278398208552871, 'psi': 0.8119680002385804}
[S6] START round=27 head_norm_before_train=1.565530 cos_to_last_merge=0.7902 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.790
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.868645435497621, 'auprc': 0.9591181162786832, 'loss_val': 0.223836789201857, 'psi': 0.9048345078100458}-{'f1_val': 0.45582843195810413, 'auprc': 0.778733390881289, 'loss_val': 0.9735558680463628, 'psi': 0.5849904155273781}
[S7] START round=27 head_norm_before_train=1.274798 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=1.000000 metrics={'f1_val': 0.6986301248989053, 'auprc': 0.9964584634454554, 'loss_val': 0.2586862343086277, 'psi': 0.8177614603175254}-{'f1_val': 0.4215243410103527, 'auprc': 0.7810034065312992, 'loss_val': 0.8207719710111562, 'psi': 0.5653159672187313}
[S8] START round=27 head_norm_before_train=1.339320 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.070192 metrics={'f1_val': 0.9937751589505717, 'auprc': 0.9975366998103472, 'loss_val': 0.2305506375328557, 'psi': 0.995279775294482}-{'f1_val': 0.9934090858100645, 'auprc': 0.9970403865455728, 'loss_val': 0.367248636502301, 'psi': 0.9948616061042679}
[S9] START round=27 head_norm_before_train=1.844396 cos_to_last_merge=0.9991 (last merge round=25)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9875625681944921, 'auprc': 0.9940187495170277, 'loss_val': 0.08667026948393683, 'psi': 0.9901450407235063}-{'f1_val': 0.9971029125121428, 'auprc': 0.9946078174506562, 'loss_val': 0.0950854237615699, 'psi': 0.9961048744875481}
[S10] START round=27 head_norm_before_train=1.926784 (no previous merge yet)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9931928978870455, 'loss_val': 0.04916765571485515, 'psi': 0.9933117693557127}-{'f1_val': 0.9927344652802075, 'auprc': 0.9956651633426069, 'loss_val': 0.05118659786105284, 'psi': 0.9939067445051673}
[S11] START round=27 head_norm_before_train=1.480913 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.052657 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9977838475614449, 'loss_val': 0.0757543895324745, 'psi': 0.9968966395058945}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976723310519506, 'loss_val': 0.18218412556242428, 'psi': 0.996997135128934}
[S13] START round=27 head_norm_before_train=1.096948 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6017673230211698, 'auprc': 0.5454078061501794, 'loss_val': 0.8456856088876264, 'psi': 0.5792235162727736}-{'f1_val': 0.6034146454030523, 'auprc': 0.5722689850838674, 'loss_val': 0.753552497418504, 'psi': 0.5909563812753783}
[S14] START round=27 head_norm_before_train=1.903674 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9969687589007382, 'auprc': 0.9965227113866952, 'loss_val': 0.1561302150987245, 'psi': 0.996790339895121}-{'f1_val': 0.9974082695017256, 'auprc': 0.9989649053934418, 'loss_val': 0.12848268647087388, 'psi': 0.9980309238584121}
[S15] START round=27 head_norm_before_train=1.827080 cos_to_last_merge=0.9981 (last merge round=24)
[S15] round=27 local utility u=0.990417 metrics={'f1_val': 0.9968092060862683, 'auprc': 0.9983862041884621, 'loss_val': 0.06716837549212071, 'psi': 0.9974400053271458}-{'f1_val': 0.7116744949640734, 'auprc': 0.9855117165888704, 'loss_val': 0.2985702743399827, 'psi': 0.8212093836139922}
[S16] START round=27 head_norm_before_train=1.658554 cos_to_last_merge=0.7908 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.791
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.8711997656222306, 'auprc': 0.9963343024670355, 'loss_val': 0.4342237310248952, 'psi': 0.9212535803601525}-{'f1_val': 0.9352764271224606, 'auprc': 0.9941960416247543, 'loss_val': 0.22719272694005524, 'psi': 0.9588442729233781}
[S17] START round=27 head_norm_before_train=1.453935 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.072237 metrics={'f1_val': 0.3531854579089863, 'auprc': 0.6247944170072385, 'loss_val': 0.9692611236126697, 'psi': 0.4618290415482872}-{'f1_val': 0.33749700333953414, 'auprc': 0.6492795907968354, 'loss_val': 1.0930608822145673, 'psi': 0.46221003832245466}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:61012
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:61010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61015
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:61017
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S7
[S17] cosine check vs S7: cos=0.3681
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=-0.1789
[S8] DROPPED delta from S4 (cos=-0.1789 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1806) from S5
[S11] cosine check vs S5: cos=0.5100
[S11] RECEIVED delta(kind=head bytes=1796) from S3
[S11] cosine check vs S3: cos=0.8852
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.6522
[S9] RECEIVED delta(kind=head bytes=1804) from S15
[S9] cosine check vs S15: cos=0.9877
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.1189
[S8] RECEIVED delta(kind=head bytes=1803) from S11
[S8] cosine check vs S11: cos=-0.1008
[S8] DROPPED delta from S11 (cos=-0.1008 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:61013
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S17
[S13] cosine check vs S17: cos=0.8276
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.6018 head_norm=1.117486
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.156139e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.6034 head_norm=1.237978 delta_norm=0.415614
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9876 head_norm=1.885198
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.475446e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9880 head_norm=1.862584 delta_norm=0.147545
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.9968 head_norm=1.851486
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.073935e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.9961 head_norm=1.474320 delta_norm=0.707393
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9963 head_norm=1.534237
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.447024e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9963 head_norm=1.449108 delta_norm=0.144702
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.3532 head_norm=1.470331
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.281831e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.3532 head_norm=1.082683 delta_norm=0.828183
[S17] aggregate: ACCEPT kept=['S7', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.756693 (no previous merge yet)
[S2] round=28 local utility u=0.187594 metrics={'f1_val': 0.9090883253123972, 'auprc': 0.9917944167263697, 'loss_val': 0.1591556061705792, 'psi': 0.9421707618779862}-{'f1_val': 0.8612674759512321, 'auprc': 0.9897682045371055, 'loss_val': 0.24134035379377697, 'psi': 0.9126677673855814}
[S3] START round=28 head_norm_before_train=2.138395 (no previous merge yet)
[S3] round=28 local utility u=0.283942 metrics={'f1_val': 0.9919952467380473, 'auprc': 0.9999371486812114, 'loss_val': 0.01852415791432613, 'psi': 0.9951720075153129}-{'f1_val': 0.9212890898765012, 'auprc': 0.9989273378928144, 'loss_val': 0.15914115581721533, 'psi': 0.9523443890830265}
[S4] START round=28 head_norm_before_train=1.867221 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9353769432579255, 'auprc': 0.9097619318278458, 'loss_val': 0.2821214189222451, 'psi': 0.9251309386858937}-{'f1_val': 0.9496843717276011, 'auprc': 0.958038335147059, 'loss_val': 0.26002733262765876, 'psi': 0.9530259570953843}
[S5] START round=28 head_norm_before_train=1.602505 cos_to_last_merge=0.8147 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.815
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7270622119022324, 'auprc': 0.9892303779233665, 'loss_val': 0.21600613197593613, 'psi': 0.8319294783106861}-{'f1_val': 0.9416808866305283, 'auprc': 0.9833309245377693, 'loss_val': 0.22653290994166614, 'psi': 0.9583409017934246}
[S6] START round=28 head_norm_before_train=1.575305 cos_to_last_merge=0.7900 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.790
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6273134443480184, 'auprc': 0.8119472681683428, 'loss_val': 0.7733301780807551, 'psi': 0.7011669738761481}-{'f1_val': 0.868645435497621, 'auprc': 0.9591181162786832, 'loss_val': 0.223836789201857, 'psi': 0.9048345078100458}
[S7] START round=28 head_norm_before_train=1.288102 cos_to_last_merge=0.9999 (last merge round=26)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.6910842270905009, 'auprc': 0.9474033012099903, 'loss_val': 0.3351339964013734, 'psi': 0.7936118567382966}-{'f1_val': 0.6986301248989053, 'auprc': 0.9964584634454554, 'loss_val': 0.2586862343086277, 'psi': 0.8177614603175254}
[S8] START round=28 head_norm_before_train=1.385659 cos_to_last_merge=0.9972 (last merge round=26)
[S8] round=28 local utility u=0.038957 metrics={'f1_val': 0.99304356686603, 'auprc': 0.997840274114765, 'loss_val': 0.14915822978236212, 'psi': 0.9949622497655239}-{'f1_val': 0.9937751589505717, 'auprc': 0.9975366998103472, 'loss_val': 0.2305506375328557, 'psi': 0.995279775294482}
[S9] START round=28 head_norm_before_train=1.862584 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.042162 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9977923890949036, 'loss_val': 0.07090834161200178, 'psi': 0.9973787031452471}-{'f1_val': 0.9875625681944921, 'auprc': 0.9940187495170277, 'loss_val': 0.08667026948393683, 'psi': 0.9901450407235063}
[S10] START round=28 head_norm_before_train=1.939240 (no previous merge yet)
[S10] round=28 local utility u=0.001903 metrics={'f1_val': 0.9928548469119698, 'auprc': 0.9963847462427754, 'loss_val': 0.05171981590127446, 'psi': 0.994266806644292}-{'f1_val': 0.993391017001491, 'auprc': 0.9931928978870455, 'loss_val': 0.04916765571485515, 'psi': 0.9933117693557127}
[S11] START round=28 head_norm_before_train=1.449108 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.005582 metrics={'f1_val': 0.9969845827789485, 'auprc': 0.9992308503328952, 'loss_val': 0.07300715956693593, 'psi': 0.9978830898005271}-{'f1_val': 0.996305167468861, 'auprc': 0.9977838475614449, 'loss_val': 0.0757543895324745, 'psi': 0.9968966395058945}
[S13] START round=28 head_norm_before_train=1.237978 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5793797278912531, 'auprc': 0.5065298788375577, 'loss_val': 0.9543298871428907, 'psi': 0.5502397882697749}-{'f1_val': 0.6017673230211698, 'auprc': 0.5454078061501794, 'loss_val': 0.8456856088876264, 'psi': 0.5792235162727736}
[S14] START round=28 head_norm_before_train=1.942020 cos_to_last_merge=0.9988 (last merge round=26)
[S14] round=28 local utility u=0.025400 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9950972843132307, 'loss_val': 0.0996372763310709, 'psi': 0.9960784282246888}-{'f1_val': 0.9969687589007382, 'auprc': 0.9965227113866952, 'loss_val': 0.1561302150987245, 'psi': 0.996790339895121}
[S15] START round=28 head_norm_before_train=1.474320 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.8942647470011416, 'auprc': 0.9911184731999092, 'loss_val': 0.2509319995155658, 'psi': 0.9330062374806486}-{'f1_val': 0.9968092060862683, 'auprc': 0.9983862041884621, 'loss_val': 0.06716837549212071, 'psi': 0.9974400053271458}
[S16] START round=28 head_norm_before_train=1.677110 cos_to_last_merge=0.7903 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.790
[S16] round=28 local utility u=0.188231 metrics={'f1_val': 0.9157054881920415, 'auprc': 0.9968699166551869, 'loss_val': 0.3264025678141654, 'psi': 0.9481712595772996}-{'f1_val': 0.8711997656222306, 'auprc': 0.9963343024670355, 'loss_val': 0.4342237310248952, 'psi': 0.9212535803601525}
[S17] START round=28 head_norm_before_train=1.082683 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.3525532542335838, 'auprc': 0.6197744259942973, 'loss_val': 0.9659786356719895, 'psi': 0.4594417229378692}-{'f1_val': 0.3531854579089863, 'auprc': 0.6247944170072385, 'loss_val': 0.9692611236126697, 'psi': 0.4618290415482872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:61008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] → sending delta(kind=head bytes=1808) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:61014
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:61012
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1808 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] cosine check vs S14: cos=0.7405
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=0.6669
[S8] RECEIVED delta(kind=head bytes=1803) from S11
[S8] cosine check vs S11: cos=-0.1052
[S8] DROPPED delta from S11 (cos=-0.1052 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S3
[S11] cosine check vs S3: cos=0.8528
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=0.9529
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.6747
[S15] RECEIVED delta(kind=head bytes=1808) from S8
[S15] cosine check vs S8: cos=0.8921
[S14] RECEIVED delta(kind=head bytes=1790) from S10
[S14] cosine check vs S10: cos=0.9774
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6911 head_norm=1.299547
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.016560e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.6921 head_norm=1.480033 delta_norm=0.301656
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.9970 head_norm=1.492784
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.868424e-01
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.9970 head_norm=1.755503 delta_norm=0.586842
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9967 head_norm=1.982119
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.094293e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9967 head_norm=1.955776 delta_norm=0.209429
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9930 head_norm=1.444509
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.319811e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9927 head_norm=1.388374 delta_norm=0.131981
[S8] aggregate: ACCEPT kept=['S14', 'S2'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.3526 head_norm=1.104638
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.069039e-01
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.3526 head_norm=1.384176 delta_norm=0.706904
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.8943 head_norm=1.504001
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.435689e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.8921 head_norm=1.433971 delta_norm=0.343569
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.764728 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.8402778028774197, 'auprc': 0.9885639372743447, 'loss_val': 0.2573956284303709, 'psi': 0.8995922566361898}-{'f1_val': 0.9090883253123972, 'auprc': 0.9917944167263697, 'loss_val': 0.1591556061705792, 'psi': 0.9421707618779862}
[S3] START round=29 head_norm_before_train=2.150336 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9792699784381248, 'auprc': 0.9998962304094421, 'loss_val': 0.04104297351724989, 'psi': 0.9875204792266518}-{'f1_val': 0.9919952467380473, 'auprc': 0.9999371486812114, 'loss_val': 0.01852415791432613, 'psi': 0.9951720075153129}
[S4] START round=29 head_norm_before_train=1.878240 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9229740347121438, 'auprc': 0.915447441101604, 'loss_val': 0.2624105009196962, 'psi': 0.919963397267928}-{'f1_val': 0.9353769432579255, 'auprc': 0.9097619318278458, 'loss_val': 0.2821214189222451, 'psi': 0.9251309386858937}
[S5] START round=29 head_norm_before_train=1.606285 cos_to_last_merge=0.8143 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.814
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7007401102601454, 'auprc': 0.9579385074540742, 'loss_val': 0.33281763121278257, 'psi': 0.8036194691377169}-{'f1_val': 0.7270622119022324, 'auprc': 0.9892303779233665, 'loss_val': 0.21600613197593613, 'psi': 0.8319294783106861}
[S6] START round=29 head_norm_before_train=1.588533 cos_to_last_merge=0.7893 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.789
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.8844712011074519, 'auprc': 0.9621710985042076, 'loss_val': 0.27901910843865996, 'psi': 0.9155511600661541}-{'f1_val': 0.6273134443480184, 'auprc': 0.8119472681683428, 'loss_val': 0.7733301780807551, 'psi': 0.7011669738761481}
[S7] START round=29 head_norm_before_train=1.480033 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.6135731338878748, 'auprc': 0.8306000270795362, 'loss_val': 0.5291371508169321, 'psi': 0.7003838911645394}-{'f1_val': 0.6910842270905009, 'auprc': 0.9474033012099903, 'loss_val': 0.3351339964013734, 'psi': 0.7936118567382966}
[S8] START round=29 head_norm_before_train=1.388374 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.009348 metrics={'f1_val': 0.9934090858100645, 'auprc': 0.997894392518051, 'loss_val': 0.13281712171739504, 'psi': 0.9952032084932592}-{'f1_val': 0.99304356686603, 'auprc': 0.997840274114765, 'loss_val': 0.14915822978236212, 'psi': 0.9949622497655239}
[S9] START round=29 head_norm_before_train=1.900286 cos_to_last_merge=0.9993 (last merge round=27)
[S9] round=29 local utility u=0.002658 metrics={'f1_val': 0.9947358838652685, 'auprc': 0.9993289349472195, 'loss_val': 0.05599969668594756, 'psi': 0.9965731042980489}-{'f1_val': 0.9971029125121428, 'auprc': 0.9977923890949036, 'loss_val': 0.07090834161200178, 'psi': 0.9973787031452471}
[S10] START round=29 head_norm_before_train=1.951677 (no previous merge yet)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9913263960172334, 'auprc': 0.996989462983235, 'loss_val': 0.05397940876294974, 'psi': 0.9935916228036341}-{'f1_val': 0.9928548469119698, 'auprc': 0.9963847462427754, 'loss_val': 0.05171981590127446, 'psi': 0.994266806644292}
[S11] START round=29 head_norm_before_train=1.755503 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.009927 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9997104240239258, 'loss_val': 0.050539572269206766, 'psi': 0.9976696203797915}-{'f1_val': 0.9969845827789485, 'auprc': 0.9992308503328952, 'loss_val': 0.07300715956693593, 'psi': 0.9978830898005271}
[S13] START round=29 head_norm_before_train=1.255137 cos_to_last_merge=0.9984 (last merge round=27)
[S13] round=29 local utility u=0.185994 metrics={'f1_val': 0.6025430358261976, 'auprc': 0.5453082162170717, 'loss_val': 0.8376575982112613, 'psi': 0.5796491079825472}-{'f1_val': 0.5793797278912531, 'auprc': 0.5065298788375577, 'loss_val': 0.9543298871428907, 'psi': 0.5502397882697749}
[S14] START round=29 head_norm_before_train=1.955776 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9141282798130372, 'auprc': 0.9963721550820386, 'loss_val': 0.23808884560615057, 'psi': 0.9470258299206378}-{'f1_val': 0.9967325241656609, 'auprc': 0.9950972843132307, 'loss_val': 0.0996372763310709, 'psi': 0.9960784282246888}
[S15] START round=29 head_norm_before_train=1.433971 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.369380 metrics={'f1_val': 0.9966156713254911, 'auprc': 0.9973228244992779, 'loss_val': 0.14489132420373763, 'psi': 0.9968985325950058}-{'f1_val': 0.8942647470011416, 'auprc': 0.9911184731999092, 'loss_val': 0.2509319995155658, 'psi': 0.9330062374806486}
[S16] START round=29 head_norm_before_train=1.695336 cos_to_last_merge=0.7896 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.790
[S16] round=29 local utility u=0.353776 metrics={'f1_val': 0.9912838558622399, 'auprc': 0.9928354788690048, 'loss_val': 0.060217671614965045, 'psi': 0.9919045050649458}-{'f1_val': 0.9157054881920415, 'auprc': 0.9968699166551869, 'loss_val': 0.3264025678141654, 'psi': 0.9481712595772996}
[S17] START round=29 head_norm_before_train=1.384176 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.056308 metrics={'f1_val': 0.3599858480149252, 'auprc': 0.6452375765578555, 'loss_val': 0.9743475073059927, 'psi': 0.47408653943209733}-{'f1_val': 0.3525532542335838, 'auprc': 0.6197744259942973, 'loss_val': 0.9659786356719895, 'psi': 0.4594417229378692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:61002
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:61005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:61009
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S8
[S2] cosine check vs S8: cos=0.6928
[S8] RECEIVED delta(kind=head bytes=1802) from S15
[S8] cosine check vs S15: cos=0.9725
[S15] RECEIVED delta(kind=head bytes=1798) from S9
[S15] cosine check vs S9: cos=0.8274
[S17] RECEIVED delta(kind=head bytes=1802) from S13
[S17] cosine check vs S13: cos=0.9563
[S5] RECEIVED delta(kind=head bytes=1791) from S11
[S5] cosine check vs S11: cos=0.2821
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:61007
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S17
[S6] cosine check vs S17: cos=0.1679
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.8845 head_norm=1.601042
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.714250e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.8666 head_norm=1.149152 delta_norm=0.971425
[S6] aggregate: ROLLBACK (f1_val pre=0.884 post=0.867 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.7007 head_norm=1.616567
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.022204e+00
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.7007 head_norm=1.363925 delta_norm=1.022204
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=29 metric=0.8403 head_norm=1.774154
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.488487e-01
[S2] stored merged vector for next round verification (round=29)
[S2] DEBUG after merge:  round=29 metric=0.8489 head_norm=1.482543 delta_norm=0.648849
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9934 head_norm=1.445771
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.715765e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9934 head_norm=1.448823 delta_norm=0.171576
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.9966 head_norm=1.472005
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.484048e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.9950 head_norm=1.631496 delta_norm=0.548405
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.3600 head_norm=1.401819
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.071880e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.3951 head_norm=1.326034 delta_norm=0.207188
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.482543 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=30 local utility u=0.501288 metrics={'f1_val': 0.9851445169922074, 'auprc': 0.9870294059337361, 'loss_val': 0.11941621326864398, 'psi': 0.9858984725688189}-{'f1_val': 0.8402778028774197, 'auprc': 0.9885639372743447, 'loss_val': 0.2573956284303709, 'psi': 0.8995922566361898}
[S3] START round=30 head_norm_before_train=2.160523 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.8236474048247413, 'auprc': 0.9955779344602942, 'loss_val': 0.46272785109012066, 'psi': 0.8924196166789624}-{'f1_val': 0.9792699784381248, 'auprc': 0.9998962304094421, 'loss_val': 0.04104297351724989, 'psi': 0.9875204792266518}
[S4] START round=30 head_norm_before_train=1.885306 (no previous merge yet)
[S4] round=30 local utility u=0.190538 metrics={'f1_val': 0.9521443152174307, 'auprc': 0.9823446804148592, 'loss_val': 0.25704797656923706, 'psi': 0.9642244612964022}-{'f1_val': 0.9229740347121438, 'auprc': 0.915447441101604, 'loss_val': 0.2624105009196962, 'psi': 0.919963397267928}
[S5] START round=30 head_norm_before_train=1.363925 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.330084 metrics={'f1_val': 0.7941361252186541, 'auprc': 0.9745363917741732, 'loss_val': 0.28281946569742844, 'psi': 0.8662962318408618}-{'f1_val': 0.7007401102601454, 'auprc': 0.9579385074540742, 'loss_val': 0.33281763121278257, 'psi': 0.8036194691377169}
[S6] START round=30 head_norm_before_train=1.149152 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.6522112637062097, 'auprc': 0.9483947410947994, 'loss_val': 0.5890221675138484, 'psi': 0.7706846546616456}-{'f1_val': 0.8844712011074519, 'auprc': 0.9621710985042076, 'loss_val': 0.27901910843865996, 'psi': 0.9155511600661541}
[S7] START round=30 head_norm_before_train=1.494117 cos_to_last_merge=0.9998 (last merge round=28)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.4913891699371964, 'auprc': 0.7817842736272799, 'loss_val': 0.8046674819099388, 'psi': 0.6075472114132299}-{'f1_val': 0.6135731338878748, 'auprc': 0.8306000270795362, 'loss_val': 0.5291371508169321, 'psi': 0.7003838911645394}
[S8] START round=30 head_norm_before_train=1.448823 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.017831 metrics={'f1_val': 0.9910529874306067, 'auprc': 0.9986052764429261, 'loss_val': 0.08515036654716397, 'psi': 0.9940739030355343}-{'f1_val': 0.9934090858100645, 'auprc': 0.997894392518051, 'loss_val': 0.13281712171739504, 'psi': 0.9952032084932592}
[S9] START round=30 head_norm_before_train=1.938623 cos_to_last_merge=0.9976 (last merge round=27)
[S9] round=30 local utility u=0.010007 metrics={'f1_val': 0.9959812240560731, 'auprc': 0.999346224770434, 'loss_val': 0.04350870169502905, 'psi': 0.9973272243418175}-{'f1_val': 0.9947358838652685, 'auprc': 0.9993289349472195, 'loss_val': 0.05599969668594756, 'psi': 0.9965731042980489}
[S10] START round=30 head_norm_before_train=1.963787 (no previous merge yet)
[S10] round=30 local utility u=0.005043 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.994455091107537, 'loss_val': 0.046050921320406335, 'psi': 0.99355398246081}-{'f1_val': 0.9913263960172334, 'auprc': 0.996989462983235, 'loss_val': 0.05397940876294974, 'psi': 0.9935916228036341}
[S11] START round=30 head_norm_before_train=1.788041 cos_to_last_merge=0.9997 (last merge round=28)
[S11] round=30 local utility u=0.004424 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9996823669921491, 'loss_val': 0.043181276543388644, 'psi': 0.9978156956641344}-{'f1_val': 0.9963090846170353, 'auprc': 0.9997104240239258, 'loss_val': 0.050539572269206766, 'psi': 0.9976696203797915}
[S13] START round=30 head_norm_before_train=1.279645 cos_to_last_merge=0.9927 (last merge round=27)
[S13] round=30 local utility u=0.046145 metrics={'f1_val': 0.6078778676210527, 'auprc': 0.5483940049968602, 'loss_val': 0.7866339038839585, 'psi': 0.5840843225713757}-{'f1_val': 0.6025430358261976, 'auprc': 0.5453082162170717, 'loss_val': 0.8376575982112613, 'psi': 0.5796491079825472}
[S14] START round=30 head_norm_before_train=1.990309 cos_to_last_merge=0.9992 (last merge round=28)
[S14] round=30 local utility u=0.109359 metrics={'f1_val': 0.942539736518622, 'auprc': 0.9978791038373043, 'loss_val': 0.19436070053355922, 'psi': 0.9646754834460949}-{'f1_val': 0.9141282798130372, 'auprc': 0.9963721550820386, 'loss_val': 0.23808884560615057, 'psi': 0.9470258299206378}
[S15] START round=30 head_norm_before_train=1.631496 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.9493700829359814, 'auprc': 0.9979664282981011, 'loss_val': 0.09588584774620844, 'psi': 0.9688086210808293}-{'f1_val': 0.9966156713254911, 'auprc': 0.9973228244992779, 'loss_val': 0.14489132420373763, 'psi': 0.9968985325950058}
[S16] START round=30 head_norm_before_train=1.708945 cos_to_last_merge=0.7891 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.789
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9434217072998635, 'auprc': 0.9965905280807087, 'loss_val': 0.143509622309371, 'psi': 0.9646892356122017}-{'f1_val': 0.9912838558622399, 'auprc': 0.9928354788690048, 'loss_val': 0.060217671614965045, 'psi': 0.9919045050649458}
[S17] START round=30 head_norm_before_train=1.326034 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.010726 metrics={'f1_val': 0.35273424507766726, 'auprc': 0.6664302618444018, 'loss_val': 0.972964139808957, 'psi': 0.47821265178436106}-{'f1_val': 0.3599858480149252, 'auprc': 0.6452375765578555, 'loss_val': 0.9743475073059927, 'psi': 0.47408653943209733}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:61017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:61005
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:61002
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:61011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1806) from S14
[S10] cosine check vs S14: cos=0.9841
[S17] RECEIVED delta(kind=head bytes=1803) from S13
[S17] cosine check vs S13: cos=0.9781
[S2] RECEIVED delta(kind=head bytes=1798) from S8
[S2] cosine check vs S8: cos=0.9418
[S15] RECEIVED delta(kind=head bytes=1795) from S9
[S15] cosine check vs S9: cos=0.9661
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:61007
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S17
[S6] cosine check vs S17: cos=0.7550
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S11
[S5] cosine check vs S11: cos=0.8133
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.6522 head_norm=1.176294
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.481039e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.6653 head_norm=1.181086 delta_norm=0.448104
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.113 → S16@127.0.0.1:61016
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.7941 head_norm=1.395382
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.290439e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.8711 head_norm=1.529011 delta_norm=0.529044
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.070 → S2@127.0.0.1:61002
[S9] ⇄ pheromone p=0.032 → S15@127.0.0.1:61015
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.9494 head_norm=1.672984
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.794507e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.9355 head_norm=1.806344 delta_norm=0.279451
[S15] aggregate: ROLLBACK (f1_val pre=0.949 post=0.936 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.245 → S8@127.0.0.1:61009
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9930 head_norm=1.977358
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.797040e-01
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9930 head_norm=1.992689 delta_norm=0.179704
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.075 → S17@127.0.0.1:61017
[S14] ⇄ pheromone p=0.051 → S10@127.0.0.1:61011
[S11] ⇄ pheromone p=0.033 → S5@127.0.0.1:61005
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=30 metric=0.9851 head_norm=1.496115
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.560767e-01
[S2] stored merged vector for next round verification (round=30)
[S2] DEBUG after merge:  round=30 metric=0.9783 head_norm=1.478600 delta_norm=0.256077
[S2] aggregate: ROLLBACK (f1_val pre=0.985 post=0.978 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.195 → S8@127.0.0.1:61009
[S16] ⇄ pheromone p=0.158 → S7@127.0.0.1:61008
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.3527 head_norm=1.344566
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.399558e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.3527 head_norm=1.321786 delta_norm=0.139956
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.055 → S6@127.0.0.1:61007
[S2] START round=31 head_norm_before_train=1.478600 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.8661063028184617, 'auprc': 0.9854767040028443, 'loss_val': 0.2165565582871997, 'psi': 0.9138544632922148}-{'f1_val': 0.9851445169922074, 'auprc': 0.9870294059337361, 'loss_val': 0.11941621326864398, 'psi': 0.9858984725688189}
[S3] START round=31 head_norm_before_train=2.169276 (no previous merge yet)
[S3] round=31 local utility u=0.146522 metrics={'f1_val': 0.8543903227270372, 'auprc': 0.9935435125738599, 'loss_val': 0.34803763943767474, 'psi': 0.9100515986657662}-{'f1_val': 0.8236474048247413, 'auprc': 0.9955779344602942, 'loss_val': 0.46272785109012066, 'psi': 0.8924196166789624}
[S4] START round=31 head_norm_before_train=1.886747 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9500626379617448, 'auprc': 0.9588045864798869, 'loss_val': 0.26959318471292815, 'psi': 0.9535594173690016}-{'f1_val': 0.9521443152174307, 'auprc': 0.9823446804148592, 'loss_val': 0.25704797656923706, 'psi': 0.9642244612964022}
[S5] START round=31 head_norm_before_train=1.529011 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7007406076076139, 'auprc': 0.9878451294408567, 'loss_val': 0.34676137555892245, 'psi': 0.8155824163409111}-{'f1_val': 0.7941361252186541, 'auprc': 0.9745363917741732, 'loss_val': 0.28281946569742844, 'psi': 0.8662962318408618}
[S6] START round=31 head_norm_before_train=1.181086 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.581006 metrics={'f1_val': 0.8265211920889957, 'auprc': 0.9498170270548526, 'loss_val': 0.4771357437846074, 'psi': 0.8758395260753384}-{'f1_val': 0.6522112637062097, 'auprc': 0.9483947410947994, 'loss_val': 0.5890221675138484, 'psi': 0.7706846546616456}
[S7] START round=31 head_norm_before_train=1.509236 cos_to_last_merge=0.9995 (last merge round=28)
[S7] round=31 local utility u=0.456997 metrics={'f1_val': 0.6064126503333178, 'auprc': 0.7966410192758877, 'loss_val': 0.6253844596495367, 'psi': 0.6825039979103458}-{'f1_val': 0.4913891699371964, 'auprc': 0.7817842736272799, 'loss_val': 0.8046674819099388, 'psi': 0.6075472114132299}
[S8] START round=31 head_norm_before_train=1.505094 cos_to_last_merge=0.9990 (last merge round=29)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.8610485732631207, 'auprc': 0.9853687855287154, 'loss_val': 0.16665250270253143, 'psi': 0.9107766581693586}-{'f1_val': 0.9910529874306067, 'auprc': 0.9986052764429261, 'loss_val': 0.08515036654716397, 'psi': 0.9940739030355343}
[S9] START round=31 head_norm_before_train=1.970551 cos_to_last_merge=0.9958 (last merge round=27)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9893150859224193, 'auprc': 0.9959118930208559, 'loss_val': 0.0558292886029674, 'psi': 0.991953808761794}-{'f1_val': 0.9959812240560731, 'auprc': 0.999346224770434, 'loss_val': 0.04350870169502905, 'psi': 0.9973272243418175}
[S10] START round=31 head_norm_before_train=1.992689 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9926103213473582, 'loss_val': 0.048869235604391555, 'psi': 0.9929473848448731}-{'f1_val': 0.9929532433629917, 'auprc': 0.994455091107537, 'loss_val': 0.046050921320406335, 'psi': 0.99355398246081}
[S11] START round=31 head_norm_before_train=1.813404 cos_to_last_merge=0.9992 (last merge round=28)
[S11] round=31 local utility u=0.000062 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9987662937114137, 'loss_val': 0.03873513002169327, 'psi': 0.9972919682547867}-{'f1_val': 0.9965712481121245, 'auprc': 0.9996823669921491, 'loss_val': 0.043181276543388644, 'psi': 0.9978156956641344}
[S13] START round=31 head_norm_before_train=1.313604 cos_to_last_merge=0.9827 (last merge round=27)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5738657111938132, 'auprc': 0.5350652092146791, 'loss_val': 0.9088274837760567, 'psi': 0.5583455104021596}-{'f1_val': 0.6078778676210527, 'auprc': 0.5483940049968602, 'loss_val': 0.7866339038839585, 'psi': 0.5840843225713757}
[S14] START round=31 head_norm_before_train=2.023922 cos_to_last_merge=0.9974 (last merge round=28)
[S14] round=31 local utility u=0.024249 metrics={'f1_val': 0.9485561413941213, 'auprc': 0.9962836759403622, 'loss_val': 0.1771749549895233, 'psi': 0.9676471552126176}-{'f1_val': 0.942539736518622, 'auprc': 0.9978791038373043, 'loss_val': 0.19436070053355922, 'psi': 0.9646754834460949}
[S15] START round=31 head_norm_before_train=1.806344 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.9058005873080919, 'auprc': 0.9983467426145902, 'loss_val': 0.12576004477454056, 'psi': 0.9428190494306913}-{'f1_val': 0.9493700829359814, 'auprc': 0.9979664282981011, 'loss_val': 0.09588584774620844, 'psi': 0.9688086210808293}
[S16] START round=31 head_norm_before_train=1.722399 cos_to_last_merge=0.7883 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.788
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9191999431638236, 'auprc': 0.9949638999547356, 'loss_val': 0.3399439830943682, 'psi': 0.9495055258801883}-{'f1_val': 0.9434217072998635, 'auprc': 0.9965905280807087, 'loss_val': 0.143509622309371, 'psi': 0.9646892356122017}
[S17] START round=31 head_norm_before_train=1.321786 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.3522902132865899, 'auprc': 0.656155410858164, 'loss_val': 0.9785411590398088, 'psi': 0.4738362923152195}-{'f1_val': 0.35273424507766726, 'auprc': 0.6664302618444018, 'loss_val': 0.972964139808957, 'psi': 0.47821265178436106}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:61016
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:61017
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:61005
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:61011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] cosine check vs S11: cos=0.9526
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] cosine check vs S6: cos=0.9291
[S16] RECEIVED delta(kind=head bytes=1804) from S7
[S16] cosine check vs S7: cos=0.9868
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=0.9935
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.7007 head_norm=1.564737
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.935365e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.7007 head_norm=1.679261 delta_norm=0.293537
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=31 metric=0.9932 head_norm=2.007231
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.177240e-01
[S10] stored merged vector for next round verification (round=31)
[S10] DEBUG after merge:  round=31 metric=0.9932 head_norm=2.027474 delta_norm=0.117724
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.9192 head_norm=1.733403
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.680900e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.9190 head_norm=1.624122 delta_norm=0.168090
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.3523 head_norm=1.335212
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.472584e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.3535 head_norm=1.252905 delta_norm=0.247258
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.499795 cos_to_last_merge=0.9998 (last merge round=30)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.8449306094069113, 'auprc': 0.9845205739102427, 'loss_val': 0.26212771093160864, 'psi': 0.9007665952082439}-{'f1_val': 0.8661063028184617, 'auprc': 0.9854767040028443, 'loss_val': 0.2165565582871997, 'psi': 0.9138544632922148}
[S3] START round=32 head_norm_before_train=2.180838 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.8232538820418038, 'auprc': 0.984562733021745, 'loss_val': 0.5174178158028878, 'psi': 0.8877774224337802}-{'f1_val': 0.8543903227270372, 'auprc': 0.9935435125738599, 'loss_val': 0.34803763943767474, 'psi': 0.9100515986657662}
[S4] START round=32 head_norm_before_train=1.895059 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9385226342667498, 'auprc': 0.9223128585154265, 'loss_val': 0.28980207639204825, 'psi': 0.9320387239662205}-{'f1_val': 0.9500626379617448, 'auprc': 0.9588045864798869, 'loss_val': 0.26959318471292815, 'psi': 0.9535594173690016}
[S5] START round=32 head_norm_before_train=1.679261 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.256096 metrics={'f1_val': 0.8094128662489952, 'auprc': 0.9583766863564772, 'loss_val': 0.39819688792990865, 'psi': 0.8689983942919881}-{'f1_val': 0.7007406076076139, 'auprc': 0.9878451294408567, 'loss_val': 0.34676137555892245, 'psi': 0.8155824163409111}
[S6] START round=32 head_norm_before_train=1.216152 cos_to_last_merge=0.9970 (last merge round=30)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.5380787011953838, 'auprc': 0.7810733836164304, 'loss_val': 0.7311922047288023, 'psi': 0.6352765741638025}-{'f1_val': 0.8265211920889957, 'auprc': 0.9498170270548526, 'loss_val': 0.4771357437846074, 'psi': 0.8758395260753384}
[S7] START round=32 head_norm_before_train=1.525570 cos_to_last_merge=0.9989 (last merge round=28)
[S7] round=32 local utility u=0.434061 metrics={'f1_val': 0.680469147122488, 'auprc': 0.8581813929212778, 'loss_val': 0.3862225250438008, 'psi': 0.7515540454420039}-{'f1_val': 0.6064126503333178, 'auprc': 0.7966410192758877, 'loss_val': 0.6253844596495367, 'psi': 0.6825039979103458}
[S8] START round=32 head_norm_before_train=1.546135 cos_to_last_merge=0.9973 (last merge round=29)
[S8] round=32 local utility u=0.428893 metrics={'f1_val': 0.9832091184619611, 'auprc': 0.9991090050811613, 'loss_val': 0.08305065253891442, 'psi': 0.9895690731096412}-{'f1_val': 0.8610485732631207, 'auprc': 0.9853687855287154, 'loss_val': 0.16665250270253143, 'psi': 0.9107766581693586}
[S9] START round=32 head_norm_before_train=1.997148 cos_to_last_merge=0.9941 (last merge round=27)
[S9] round=32 local utility u=0.034944 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9971161773209803, 'loss_val': 0.03362650363787284, 'psi': 0.996842778016727}-{'f1_val': 0.9893150859224193, 'auprc': 0.9959118930208559, 'loss_val': 0.0558292886029674, 'psi': 0.991953808761794}
[S10] START round=32 head_norm_before_train=2.027474 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=32 local utility u=0.003352 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9941557913624292, 'loss_val': 0.04548856859640448, 'psi': 0.9934342625627668}-{'f1_val': 0.9931720938432163, 'auprc': 0.9926103213473582, 'loss_val': 0.048869235604391555, 'psi': 0.9929473848448731}
[S11] START round=32 head_norm_before_train=1.834056 cos_to_last_merge=0.9986 (last merge round=28)
[S11] round=32 local utility u=0.005565 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9996107950734818, 'loss_val': 0.03407034016244672, 'psi': 0.998022872005139}-{'f1_val': 0.9963090846170353, 'auprc': 0.9987662937114137, 'loss_val': 0.03873513002169327, 'psi': 0.9972919682547867}
[S13] START round=32 head_norm_before_train=1.349320 cos_to_last_merge=0.9735 (last merge round=27)
[S13] round=32 local utility u=0.122779 metrics={'f1_val': 0.6005475407533403, 'auprc': 0.5385287527776137, 'loss_val': 0.8337518970383248, 'psi': 0.5757400255630496}-{'f1_val': 0.5738657111938132, 'auprc': 0.5350652092146791, 'loss_val': 0.9088274837760567, 'psi': 0.5583455104021596}
[S14] START round=32 head_norm_before_train=2.054275 cos_to_last_merge=0.9953 (last merge round=28)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.8902043404894513, 'auprc': 0.9962228732608682, 'loss_val': 0.26665976363069444, 'psi': 0.9326117535980181}-{'f1_val': 0.9485561413941213, 'auprc': 0.9962836759403622, 'loss_val': 0.1771749549895233, 'psi': 0.9676471552126176}
[S15] START round=32 head_norm_before_train=1.836410 cos_to_last_merge=0.9998 (last merge round=30)
[S15] round=32 local utility u=0.212775 metrics={'f1_val': 0.9677159090661562, 'auprc': 0.9986638968072624, 'loss_val': 0.07265249034977934, 'psi': 0.9800951041625987}-{'f1_val': 0.9058005873080919, 'auprc': 0.9983467426145902, 'loss_val': 0.12576004477454056, 'psi': 0.9428190494306913}
[S16] START round=32 head_norm_before_train=1.624122 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.147480 metrics={'f1_val': 0.9404895518076879, 'auprc': 0.9965689934143649, 'loss_val': 0.1775359826252273, 'psi': 0.9629213284503586}-{'f1_val': 0.9191999431638236, 'auprc': 0.9949638999547356, 'loss_val': 0.3399439830943682, 'psi': 0.9495055258801883}
[S17] START round=32 head_norm_before_train=1.252905 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.000439 metrics={'f1_val': 0.3528441664805301, 'auprc': 0.6585173036384819, 'loss_val': 0.9880720458674983, 'psi': 0.4751134213437108}-{'f1_val': 0.3522902132865899, 'auprc': 0.656155410858164, 'loss_val': 0.9785411590398088, 'psi': 0.4738362923152195}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:61014
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:61012
[S5] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S5
[S11] cosine check vs S5: cos=0.9805
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.9971
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:61016
[S7] sending update (kind=head size=1806 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1806) from S7
[S16] cosine check vs S7: cos=0.9951
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:61015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:61015
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S9
[S15] cosine check vs S9: cos=0.9903
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.8471
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:61008
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:61005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:61017
[S16] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] cosine check vs S15: cos=0.8471
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] cosine check vs S16: cos=0.9951
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S13
[S17] cosine check vs S13: cos=0.9613
[S5] RECEIVED delta(kind=head bytes=1795) from S11
[S5] cosine check vs S11: cos=0.9805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:61007
[S17] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S17
[S6] cosine check vs S17: cos=0.9608
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S13
[S8]  timeout peer S16
[S8]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S4
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S16
[S9]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S8
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.6805 head_norm=1.542884
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.103412e-02
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.6806 head_norm=1.587294 delta_norm=0.091034
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9832 head_norm=1.574762
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.937191e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9843 head_norm=1.649944 delta_norm=0.493719
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.5381 head_norm=1.274355
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.779561e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.5232 head_norm=1.257856 delta_norm=0.177956
[S6] aggregate: ROLLBACK (f1_val pre=0.538 post=0.523 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.8094 head_norm=1.717040
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.885162e-01
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.8924 head_norm=1.775548 delta_norm=0.188516
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.8902 head_norm=2.082542
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.092541e-02
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.8895 head_norm=2.061485 delta_norm=0.080925
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9970 head_norm=1.851483
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.885162e-01
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9970 head_norm=1.775548 delta_norm=0.188516
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.9677 head_norm=1.858030
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.812266e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.9637 head_norm=1.769107 delta_norm=0.181227
[S15] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.3528 head_norm=1.266396
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.928865e-01
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.4846 head_norm=1.311149 delta_norm=0.192886
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9405 head_norm=1.635571
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.103413e-02
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9403 head_norm=1.587294 delta_norm=0.091034
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.528550 cos_to_last_merge=0.9991 (last merge round=30)
[S2] round=33 local utility u=0.472633 metrics={'f1_val': 0.9770028031163134, 'auprc': 0.9874448949391403, 'loss_val': 0.11806723298631448, 'psi': 0.9811796398454442}-{'f1_val': 0.8449306094069113, 'auprc': 0.9845205739102427, 'loss_val': 0.26212771093160864, 'psi': 0.9007665952082439}
[S3] START round=33 head_norm_before_train=2.193394 (no previous merge yet)
[S3] round=33 local utility u=0.447075 metrics={'f1_val': 0.91417124720573, 'auprc': 0.992108894236841, 'loss_val': 0.19141087258254028, 'psi': 0.9453463060181744}-{'f1_val': 0.8232538820418038, 'auprc': 0.984562733021745, 'loss_val': 0.5174178158028878, 'psi': 0.8877774224337802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=33 head_norm_before_train=1.906210 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.8238543969525833, 'auprc': 0.8937663582815157, 'loss_val': 0.4086757711671116, 'psi': 0.8518191814841563}-{'f1_val': 0.9385226342667498, 'auprc': 0.9223128585154265, 'loss_val': 0.28980207639204825, 'psi': 0.9320387239662205}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.775548 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.700868080518019, 'auprc': 0.9662444941583159, 'loss_val': 0.34695742915297734, 'psi': 0.8070186459741377}-{'f1_val': 0.8094128662489952, 'auprc': 0.9583766863564772, 'loss_val': 0.39819688792990865, 'psi': 0.8689983942919881}
[S6] START round=33 head_norm_before_train=1.257856 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.738394 metrics={'f1_val': 0.746633139193307, 'auprc': 0.8006221089540474, 'loss_val': 0.5643779618142386, 'psi': 0.7682287270976031}-{'f1_val': 0.5380787011953838, 'auprc': 0.7810733836164304, 'loss_val': 0.7311922047288023, 'psi': 0.6352765741638025}
[S7] START round=33 head_norm_before_train=1.587294 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.109078 metrics={'f1_val': 0.6820358196941151, 'auprc': 0.9015873276067812, 'loss_val': 0.3076848745891647, 'psi': 0.7698564228591815}-{'f1_val': 0.680469147122488, 'auprc': 0.8581813929212778, 'loss_val': 0.3862225250438008, 'psi': 0.7515540454420039}
[S8] START round=33 head_norm_before_train=1.649944 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.7138880036303916, 'auprc': 0.9851382784750422, 'loss_val': 0.36629806807051224, 'psi': 0.8223881135682518}-{'f1_val': 0.9832091184619611, 'auprc': 0.9991090050811613, 'loss_val': 0.08305065253891442, 'psi': 0.9895690731096412}
[S9] START round=33 head_norm_before_train=2.019075 cos_to_last_merge=0.9926 (last merge round=27)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9930810051383208, 'auprc': 0.999685579156252, 'loss_val': 0.03637027626145488, 'psi': 0.9957228347454933}-{'f1_val': 0.9966605118138915, 'auprc': 0.9971161773209803, 'loss_val': 0.03362650363787284, 'psi': 0.996842778016727}
[S10] START round=33 head_norm_before_train=2.043418 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9927674780781619, 'loss_val': 0.043596245769206905, 'psi': 0.9928789372490598}-{'f1_val': 0.9929532433629917, 'auprc': 0.9941557913624292, 'loss_val': 0.04548856859640448, 'psi': 0.9934342625627668}
[S11] START round=33 head_norm_before_train=1.775548 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.999286853093379, 'loss_val': 0.033610587976290414, 'psi': 0.9978932952130979}-{'f1_val': 0.9969642566262439, 'auprc': 0.9996107950734818, 'loss_val': 0.03407034016244672, 'psi': 0.998022872005139}
[S13] START round=33 head_norm_before_train=1.381620 cos_to_last_merge=0.9665 (last merge round=27)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5774079318242569, 'auprc': 0.5366692979751972, 'loss_val': 0.9245430250337064, 'psi': 0.5611124782846331}-{'f1_val': 0.6005475407533403, 'auprc': 0.5385287527776137, 'loss_val': 0.8337518970383248, 'psi': 0.5757400255630496}
[S14] START round=33 head_norm_before_train=2.061485 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.369371 metrics={'f1_val': 0.9850833068138605, 'auprc': 0.9960860132625604, 'loss_val': 0.09678169912372761, 'psi': 0.9894843893933404}-{'f1_val': 0.8902043404894513, 'auprc': 0.9962228732608682, 'loss_val': 0.26665976363069444, 'psi': 0.9326117535980181}
[S15] START round=33 head_norm_before_train=1.769107 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.7010443585704017, 'auprc': 0.9910238938952391, 'loss_val': 0.29557354786918794, 'psi': 0.8170361727003368}-{'f1_val': 0.9677159090661562, 'auprc': 0.9986638968072624, 'loss_val': 0.07265249034977934, 'psi': 0.9800951041625987}
[S16] START round=33 head_norm_before_train=1.587294 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8633996497025832, 'auprc': 0.9948682526546478, 'loss_val': 0.5170074194110992, 'psi': 0.915987090883409}-{'f1_val': 0.9404895518076879, 'auprc': 0.9965689934143649, 'loss_val': 0.1775359826252273, 'psi': 0.9629213284503586}
[S17] START round=33 head_norm_before_train=1.311149 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=0.017497 metrics={'f1_val': 0.38769499075158753, 'auprc': 0.6309909292950123, 'loss_val': 1.0796040077994435, 'psi': 0.48501336616895746}-{'f1_val': 0.3528441664805301, 'auprc': 0.6585173036384819, 'loss_val': 0.9880720458674983, 'psi': 0.4751134213437108}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:61009
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:61011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:61017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:61016
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] cosine check vs S6: cos=0.9519
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=0.9786
[S10] RECEIVED delta(kind=head bytes=1797) from S14
[S10] cosine check vs S14: cos=0.9985
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=0.9999
[S17] RoundReady barrier timeout: have=2 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S17] → sending delta(kind=head bytes=1811) to S6@127.0.0.1:61007
[S17] sending update (kind=head size=1811 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1811) from S17
[S6] cosine check vs S17: cos=0.9519
[S8] RoundReady barrier timeout: have=2 need=4 — continuing
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9]  timeout peer S15
[S14]  timeout peer S10
[S8]  timeout peer S4
[S8]  timeout peer S11
[S8]  timeout peer S14
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S7]  timeout peer S13
[S13]  timeout peer S17
[S11]  timeout peer S3
[S11]  timeout peer S5
[S15]  timeout peer S8
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.3877 head_norm=1.324777
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.040415e-01
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.3507 head_norm=1.297797 delta_norm=0.204041
[S17] aggregate: ROLLBACK (f1_val pre=0.388 post=0.351 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.7139 head_norm=1.671902
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.765797e-01
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.7139 head_norm=1.604832 delta_norm=0.176580
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.555016 cos_to_last_merge=0.9980 (last merge round=30)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.860366677476335, 'auprc': 0.9873004785942975, 'loss_val': 0.2347439442245631, 'psi': 0.9111401979235201}-{'f1_val': 0.9770028031163134, 'auprc': 0.9874448949391403, 'loss_val': 0.11806723298631448, 'psi': 0.9811796398454442}
[S3] START round=34 head_norm_before_train=2.205617 (no previous merge yet)
[S3] round=34 local utility u=0.089543 metrics={'f1_val': 0.9336360507827706, 'auprc': 0.9973395227673238, 'loss_val': 0.14480636953256543, 'psi': 0.9591174395765918}-{'f1_val': 0.91417124720573, 'auprc': 0.992108894236841, 'loss_val': 0.19141087258254028, 'psi': 0.9453463060181744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=34 head_norm_before_train=1.915750 (no previous merge yet)
[S4] round=34 local utility u=0.451730 metrics={'f1_val': 0.938097764310518, 'auprc': 0.9237284904946912, 'loss_val': 0.2805629368112754, 'psi': 0.9323500547841873}-{'f1_val': 0.8238543969525833, 'auprc': 0.8937663582815157, 'loss_val': 0.4086757711671116, 'psi': 0.8518191814841563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=34 head_norm_before_train=1.816149 cos_to_last_merge=0.9978 (last merge round=32)
[S5] round=34 local utility u=0.272632 metrics={'f1_val': 0.7677530035931542, 'auprc': 0.9876218403187841, 'loss_val': 0.2671347652811804, 'psi': 0.8557005382834062}-{'f1_val': 0.700868080518019, 'auprc': 0.9662444941583159, 'loss_val': 0.34695742915297734, 'psi': 0.8070186459741377}
[S6] START round=34 head_norm_before_train=1.302607 cos_to_last_merge=0.9975 (last merge round=32)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.720896440845907, 'auprc': 0.8030691591298394, 'loss_val': 0.5776225497374434, 'psi': 0.75376552815948}-{'f1_val': 0.746633139193307, 'auprc': 0.8006221089540474, 'loss_val': 0.5643779618142386, 'psi': 0.7682287270976031}
[S7] START round=34 head_norm_before_train=1.594006 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.42673764716956, 'auprc': 0.7798007128450531, 'loss_val': 1.1260246324720096, 'psi': 0.5679628734397573}-{'f1_val': 0.6820358196941151, 'auprc': 0.9015873276067812, 'loss_val': 0.3076848745891647, 'psi': 0.7698564228591815}
[S8] START round=34 head_norm_before_train=1.604832 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=1.000000 metrics={'f1_val': 0.991875857183659, 'auprc': 0.9988059524944861, 'loss_val': 0.054698440629932406, 'psi': 0.9946478953079898}-{'f1_val': 0.7138880036303916, 'auprc': 0.9851382784750422, 'loss_val': 0.36629806807051224, 'psi': 0.8223881135682518}
[S9] START round=34 head_norm_before_train=2.036831 cos_to_last_merge=0.9914 (last merge round=27)
[S9] round=34 local utility u=0.013867 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.998248667625378, 'loss_val': 0.02845690965044292, 'psi': 0.9975612145574368}-{'f1_val': 0.9930810051383208, 'auprc': 0.999685579156252, 'loss_val': 0.03637027626145488, 'psi': 0.9957228347454933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=34 head_norm_before_train=2.057380 cos_to_last_merge=0.9999 (last merge round=31)
[S10] round=34 local utility u=0.000774 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9935794861381229, 'loss_val': 0.04317138375833009, 'psi': 0.9930724736233736}-{'f1_val': 0.9929532433629917, 'auprc': 0.9927674780781619, 'loss_val': 0.043596245769206905, 'psi': 0.9928789372490598}
[S11] START round=34 head_norm_before_train=1.792081 cos_to_last_merge=0.9999 (last merge round=32)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9993220929146004, 'loss_val': 0.032624081187740114, 'psi': 0.9975142879360613}-{'f1_val': 0.9969642566262439, 'auprc': 0.999286853093379, 'loss_val': 0.033610587976290414, 'psi': 0.9978932952130979}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.406322 cos_to_last_merge=0.9603 (last merge round=27)
[S13] round=34 local utility u=0.143660 metrics={'f1_val': 0.6046611357530517, 'auprc': 0.5455228948480383, 'loss_val': 0.8273037396451024, 'psi': 0.5810058393910463}-{'f1_val': 0.5774079318242569, 'auprc': 0.5366692979751972, 'loss_val': 0.9245430250337064, 'psi': 0.5611124782846331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] sending update (kind=head size=1808 to 1 peers)
[S14] START round=34 head_norm_before_train=2.084345 cos_to_last_merge=0.9999 (last merge round=32)
[S14] round=34 local utility u=0.056603 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9960969558403096, 'loss_val': 0.05496136286808693, 'psi': 0.9966240823863897}-{'f1_val': 0.9850833068138605, 'auprc': 0.9960860132625604, 'loss_val': 0.09678169912372761, 'psi': 0.9894843893933404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=34 head_norm_before_train=1.784954 cos_to_last_merge=0.9999 (last merge round=32)
[S15] round=34 local utility u=1.000000 metrics={'f1_val': 0.9966758836715433, 'auprc': 0.9990601675060395, 'loss_val': 0.03974329542509672, 'psi': 0.9976295972053417}-{'f1_val': 0.7010443585704017, 'auprc': 0.9910238938952391, 'loss_val': 0.29557354786918794, 'psi': 0.8170361727003368}
[S16] START round=34 head_norm_before_train=1.601495 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8385493157380128, 'auprc': 0.9906092330434607, 'loss_val': 0.8526615418583338, 'psi': 0.899373282660192}-{'f1_val': 0.8633996497025832, 'auprc': 0.9948682526546478, 'loss_val': 0.5170074194110992, 'psi': 0.915987090883409}
[S17] START round=34 head_norm_before_train=1.297797 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.529187 metrics={'f1_val': 0.5313758631531191, 'auprc': 0.6599981225917804, 'loss_val': 0.9703369462572154, 'psi': 0.5828247669285836}-{'f1_val': 0.38769499075158753, 'auprc': 0.6309909292950123, 'loss_val': 1.0796040077994435, 'psi': 0.48501336616895746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=34 metric=0.9927 head_norm=2.070180
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.046463e-02
[S10] stored merged vector for next round verification (round=34)
[S10] DEBUG after merge:  round=34 metric=0.9927 head_norm=2.076394 delta_norm=0.060465
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.8385 head_norm=1.618561
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.991845e-02
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.8385 head_norm=1.606207 delta_norm=0.019918
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.7209 head_norm=1.354180
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.430844e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.6543 head_norm=1.317319 delta_norm=0.243084
[S6] aggregate: ROLLBACK (f1_val pre=0.721 post=0.654 tol_abs=0.005 tol_rel=0.0)
[S2] START round=35 head_norm_before_train=1.581638 cos_to_last_merge=0.9968 (last merge round=30)
[S2] round=35 local utility u=0.355330 metrics={'f1_val': 0.9588797763892145, 'auprc': 0.9861592079673552, 'loss_val': 0.11173924749400409, 'psi': 0.9697915490204708}-{'f1_val': 0.860366677476335, 'auprc': 0.9873004785942975, 'loss_val': 0.2347439442245631, 'psi': 0.9111401979235201}
[S3] START round=35 head_norm_before_train=2.216481 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.7268777660374905, 'auprc': 0.9684018875444554, 'loss_val': 0.873605611359932, 'psi': 0.8234874146402765}-{'f1_val': 0.9336360507827706, 'auprc': 0.9973395227673238, 'loss_val': 0.14480636953256543, 'psi': 0.9591174395765918}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.920848 (no previous merge yet)
[S4] round=35 local utility u=0.106057 metrics={'f1_val': 0.9540505247681984, 'auprc': 0.9567564276960475, 'loss_val': 0.263249096618829, 'psi': 0.955132885939338}-{'f1_val': 0.938097764310518, 'auprc': 0.9237284904946912, 'loss_val': 0.2805629368112754, 'psi': 0.9323500547841873}
[S4] not sending this round → trigger blocked (psi=0.955)
[S5] START round=35 head_norm_before_train=1.871312 cos_to_last_merge=0.9919 (last merge round=32)
[S5] round=35 local utility u=0.258088 metrics={'f1_val': 0.8395149252996813, 'auprc': 0.9903968599006978, 'loss_val': 0.189855564484042, 'psi': 0.8998676991400879}-{'f1_val': 0.7677530035931542, 'auprc': 0.9876218403187841, 'loss_val': 0.2671347652811804, 'psi': 0.8557005382834062}
[S6] START round=35 head_norm_before_train=1.317319 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.111214 metrics={'f1_val': 0.720061868416372, 'auprc': 0.8764765317834636, 'loss_val': 0.5704090595666154, 'psi': 0.7826277337632086}-{'f1_val': 0.720896440845907, 'auprc': 0.8030691591298394, 'loss_val': 0.5776225497374434, 'psi': 0.75376552815948}
[S7] START round=35 head_norm_before_train=1.598637 cos_to_last_merge=0.9999 (last merge round=32)
[S7] round=35 local utility u=1.000000 metrics={'f1_val': 0.6314651642159574, 'auprc': 0.84676104335947, 'loss_val': 0.46640663484244976, 'psi': 0.7175835158733626}-{'f1_val': 0.42673764716956, 'auprc': 0.7798007128450531, 'loss_val': 1.1260246324720096, 'psi': 0.5679628734397573}
[S8] START round=35 head_norm_before_train=1.618692 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9917345774119155, 'auprc': 0.9956665054276891, 'loss_val': 0.05134475628029639, 'psi': 0.993307348618225}-{'f1_val': 0.991875857183659, 'auprc': 0.9988059524944861, 'loss_val': 0.054698440629932406, 'psi': 0.9946478953079898}
[S9] START round=35 head_norm_before_train=2.052627 cos_to_last_merge=0.9904 (last merge round=27)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9918452858557183, 'auprc': 0.9997598609679804, 'loss_val': 0.0358174498369174, 'psi': 0.9950111159006232}-{'f1_val': 0.9971029125121428, 'auprc': 0.998248667625378, 'loss_val': 0.02845690965044292, 'psi': 0.9975612145574368}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=2.076394 cos_to_last_merge=1.0000 (last merge round=34)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.991860071323493, 'auprc': 0.995512188044384, 'loss_val': 0.045404949312393986, 'psi': 0.9933209180118494}-{'f1_val': 0.9927344652802075, 'auprc': 0.9935794861381229, 'loss_val': 0.04317138375833009, 'psi': 0.9930724736233736}
[S11] START round=35 head_norm_before_train=1.806841 cos_to_last_merge=0.9998 (last merge round=32)
[S11] round=35 local utility u=0.003855 metrics={'f1_val': 0.9969845827789485, 'auprc': 0.9993501267583538, 'loss_val': 0.029051039544743446, 'psi': 0.9979308003707106}-{'f1_val': 0.9963090846170353, 'auprc': 0.9993220929146004, 'loss_val': 0.032624081187740114, 'psi': 0.9975142879360613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=35 head_norm_before_train=1.426599 cos_to_last_merge=0.9552 (last merge round=27)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5834900250475787, 'auprc': 0.5450919348581457, 'loss_val': 0.9065783570380649, 'psi': 0.5681307889718055}-{'f1_val': 0.6046611357530517, 'auprc': 0.5455228948480383, 'loss_val': 0.8273037396451024, 'psi': 0.5810058393910463}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=2.107037 cos_to_last_merge=0.9996 (last merge round=32)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.996045403725072, 'loss_val': 0.05668592611617707, 'psi': 0.9966034615402947}-{'f1_val': 0.9969755000837764, 'auprc': 0.9960969558403096, 'loss_val': 0.05496136286808693, 'psi': 0.9966240823863897}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.797863 cos_to_last_merge=0.9998 (last merge round=32)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.987155397324273, 'auprc': 0.9991171799640084, 'loss_val': 0.08081401063372053, 'psi': 0.9919401103801673}-{'f1_val': 0.9966758836715433, 'auprc': 0.9990601675060395, 'loss_val': 0.03974329542509672, 'psi': 0.9976295972053417}
[S16] START round=35 head_norm_before_train=1.606207 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.182459 metrics={'f1_val': 0.8573090787460789, 'auprc': 0.9948264820105668, 'loss_val': 0.6129529654787512, 'psi': 0.912316040051874}-{'f1_val': 0.8385493157380128, 'auprc': 0.9906092330434607, 'loss_val': 0.8526615418583338, 'psi': 0.899373282660192}
[S17] START round=35 head_norm_before_train=1.311415 cos_to_last_merge=0.9998 (last merge round=33)
[S17] round=35 local utility u=0.034007 metrics={'f1_val': 0.4222190717515725, 'auprc': 0.8039589450797776, 'loss_val': 0.6792648411985797, 'psi': 0.5749150210828545}-{'f1_val': 0.5313758631531191, 'auprc': 0.6599981225917804, 'loss_val': 0.9703369462572154, 'psi': 0.5828247669285836}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] not sending this round → trigger blocked (psi=0.575)
[S5] not sending this round → trigger blocked (psi=0.900)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.608670 cos_to_last_merge=0.9954 (last merge round=30)
[S2] round=36 local utility u=0.008560 metrics={'f1_val': 0.9606349111659704, 'auprc': 0.9866244896370627, 'loss_val': 0.10654549677318942, 'psi': 0.9710307425544074}-{'f1_val': 0.9588797763892145, 'auprc': 0.9861592079673552, 'loss_val': 0.11173924749400409, 'psi': 0.9697915490204708}
[S3] START round=36 head_norm_before_train=2.225834 (no previous merge yet)
[S3] round=36 local utility u=0.820498 metrics={'f1_val': 0.8870013873430826, 'auprc': 0.9989441634821407, 'loss_val': 0.2849778551371293, 'psi': 0.9317784977987058}-{'f1_val': 0.7268777660374905, 'auprc': 0.9684018875444554, 'loss_val': 0.873605611359932, 'psi': 0.8234874146402765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=36 head_norm_before_train=1.923370 (no previous merge yet)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9387408069080494, 'auprc': 0.9264866372577566, 'loss_val': 0.2803741126179274, 'psi': 0.9338391390479324}-{'f1_val': 0.9540505247681984, 'auprc': 0.9567564276960475, 'loss_val': 0.263249096618829, 'psi': 0.955132885939338}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.919919 cos_to_last_merge=0.9860 (last merge round=32)
[S5] round=36 local utility u=0.529134 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9941594582528768, 'loss_val': 0.08599851151598824, 'psi': 0.9956849643882253}-{'f1_val': 0.8395149252996813, 'auprc': 0.9903968599006978, 'loss_val': 0.189855564484042, 'psi': 0.8998676991400879}
[S6] START round=36 head_norm_before_train=1.362915 cos_to_last_merge=0.9981 (last merge round=34)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.684784688912536, 'auprc': 0.861913798417093, 'loss_val': 0.6088302241854722, 'psi': 0.7556363327143588}-{'f1_val': 0.720061868416372, 'auprc': 0.8764765317834636, 'loss_val': 0.5704090595666154, 'psi': 0.7826277337632086}
[S7] START round=36 head_norm_before_train=1.604708 cos_to_last_merge=0.9998 (last merge round=32)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6350904695890405, 'auprc': 0.8013574553130999, 'loss_val': 0.6122837227425771, 'psi': 0.7015972638786643}-{'f1_val': 0.6314651642159574, 'auprc': 0.84676104335947, 'loss_val': 0.46640663484244976, 'psi': 0.7175835158733626}
[S8] START round=36 head_norm_before_train=1.632316 cos_to_last_merge=0.9999 (last merge round=33)
[S8] round=36 local utility u=0.009131 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.9983314083404633, 'loss_val': 0.04781495928812801, 'psi': 0.995047134706013}-{'f1_val': 0.9917345774119155, 'auprc': 0.9956665054276891, 'loss_val': 0.05134475628029639, 'psi': 0.993307348618225}
[S9] START round=36 head_norm_before_train=2.067211 cos_to_last_merge=0.9894 (last merge round=27)
[S9] round=36 local utility u=0.015008 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9968215641246865, 'loss_val': 0.02587705991990745, 'psi': 0.9967249327382095}-{'f1_val': 0.9918452858557183, 'auprc': 0.9997598609679804, 'loss_val': 0.0358174498369174, 'psi': 0.9950111159006232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=36 head_norm_before_train=2.090214 cos_to_last_merge=1.0000 (last merge round=34)
[S10] round=36 local utility u=0.002408 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9942108482575913, 'loss_val': 0.04193130812954219, 'psi': 0.9933250184711611}-{'f1_val': 0.991860071323493, 'auprc': 0.995512188044384, 'loss_val': 0.045404949312393986, 'psi': 0.9933209180118494}
[S11] START round=36 head_norm_before_train=1.821386 cos_to_last_merge=0.9996 (last merge round=32)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9969845827789485, 'auprc': 0.9992855840711239, 'loss_val': 0.02928187759647598, 'psi': 0.9979049832958187}-{'f1_val': 0.9969845827789485, 'auprc': 0.9993501267583538, 'loss_val': 0.029051039544743446, 'psi': 0.9979308003707106}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.441771 cos_to_last_merge=0.9506 (last merge round=27)
[S13] round=36 local utility u=0.212550 metrics={'f1_val': 0.6156346810331254, 'auprc': 0.5775984912933261, 'loss_val': 0.7718665508092541, 'psi': 0.6004202051372056}-{'f1_val': 0.5834900250475787, 'auprc': 0.5450919348581457, 'loss_val': 0.9065783570380649, 'psi': 0.5681307889718055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=36 head_norm_before_train=2.125181 cos_to_last_merge=0.9992 (last merge round=32)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9865041239629471, 'auprc': 0.9971846609693307, 'loss_val': 0.07911925816658547, 'psi': 0.9907763387655005}-{'f1_val': 0.9969755000837764, 'auprc': 0.996045403725072, 'loss_val': 0.05668592611617707, 'psi': 0.9966034615402947}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.812468 cos_to_last_merge=0.9996 (last merge round=32)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.9025504587347448, 'auprc': 0.9976584180066556, 'loss_val': 0.14201980516784934, 'psi': 0.9405936424435091}-{'f1_val': 0.987155397324273, 'auprc': 0.9991171799640084, 'loss_val': 0.08081401063372053, 'psi': 0.9919401103801673}
[S16] START round=36 head_norm_before_train=1.625031 cos_to_last_merge=0.9999 (last merge round=34)
[S16] round=36 local utility u=0.667930 metrics={'f1_val': 0.9891605922276062, 'auprc': 0.9929292497643925, 'loss_val': 0.06250976789209216, 'psi': 0.9906680552423208}-{'f1_val': 0.8573090787460789, 'auprc': 0.9948264820105668, 'loss_val': 0.6129529654787512, 'psi': 0.912316040051874}
[S17] START round=36 head_norm_before_train=1.324681 cos_to_last_merge=0.9993 (last merge round=33)
[S17] round=36 local utility u=0.068910 metrics={'f1_val': 0.42171436248114436, 'auprc': 0.8297546342157018, 'loss_val': 0.6158040026605373, 'psi': 0.5849304711749674}-{'f1_val': 0.4222190717515725, 'auprc': 0.8039589450797776, 'loss_val': 0.6792648411985797, 'psi': 0.5749150210828545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.991)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.971)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S2] START round=37 head_norm_before_train=1.637934 cos_to_last_merge=0.9938 (last merge round=30)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.9128684351673416, 'auprc': 0.984103651557591, 'loss_val': 0.14806108009579122, 'psi': 0.9413625217234414}-{'f1_val': 0.9606349111659704, 'auprc': 0.9866244896370627, 'loss_val': 0.10654549677318942, 'psi': 0.9710307425544074}
[S3] START round=37 head_norm_before_train=2.233985 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.702615956317913, 'auprc': 0.9778879759828899, 'loss_val': 0.9960427891595464, 'psi': 0.8127247641839037}-{'f1_val': 0.8870013873430826, 'auprc': 0.9989441634821407, 'loss_val': 0.2849778551371293, 'psi': 0.9317784977987058}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.927454 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.7826890700808014, 'auprc': 0.8705005971387514, 'loss_val': 0.4356216503847265, 'psi': 0.8178136809039813}-{'f1_val': 0.9387408069080494, 'auprc': 0.9264866372577566, 'loss_val': 0.2803741126179274, 'psi': 0.9338391390479324}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.948671 cos_to_last_merge=0.9823 (last merge round=32)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.9468526103226975, 'auprc': 0.9907383194653328, 'loss_val': 0.1383831256914817, 'psi': 0.9644068939797517}-{'f1_val': 0.9967019684784577, 'auprc': 0.9941594582528768, 'loss_val': 0.08599851151598824, 'psi': 0.9956849643882253}
[S6] START round=37 head_norm_before_train=1.414760 cos_to_last_merge=0.9929 (last merge round=34)
[S6] round=37 local utility u=0.523788 metrics={'f1_val': 0.8045052321917515, 'auprc': 0.9349699287092614, 'loss_val': 0.49874493387424473, 'psi': 0.8566911107987555}-{'f1_val': 0.684784688912536, 'auprc': 0.861913798417093, 'loss_val': 0.6088302241854722, 'psi': 0.7556363327143588}
[S7] START round=37 head_norm_before_train=1.618643 cos_to_last_merge=0.9996 (last merge round=32)
[S7] round=37 local utility u=0.654676 metrics={'f1_val': 0.6964818408777597, 'auprc': 0.9778868040475761, 'loss_val': 0.20086889383761905, 'psi': 0.8090438261456863}-{'f1_val': 0.6350904695890405, 'auprc': 0.8013574553130999, 'loss_val': 0.6122837227425771, 'psi': 0.7015972638786643}
[S8] START round=37 head_norm_before_train=1.647669 cos_to_last_merge=0.9997 (last merge round=33)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9930498182224239, 'auprc': 0.9938402372595379, 'loss_val': 0.06182341288292321, 'psi': 0.9933659858372694}-{'f1_val': 0.9928576189497129, 'auprc': 0.9983314083404633, 'loss_val': 0.04781495928812801, 'psi': 0.995047134706013}
[S9] START round=37 head_norm_before_train=2.078774 cos_to_last_merge=0.9887 (last merge round=27)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.999759583088832, 'loss_val': 0.027739856028956577, 'psi': 0.9971533327575043}-{'f1_val': 0.9966605118138915, 'auprc': 0.9968215641246865, 'loss_val': 0.02587705991990745, 'psi': 0.9967249327382095}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.104262 cos_to_last_merge=0.9999 (last merge round=34)
[S10] round=37 local utility u=0.000832 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9942916529737227, 'loss_val': 0.04050877397718605, 'psi': 0.9933573403576136}-{'f1_val': 0.9927344652802075, 'auprc': 0.9942108482575913, 'loss_val': 0.04193130812954219, 'psi': 0.9933250184711611}
[S11] START round=37 head_norm_before_train=1.834278 cos_to_last_merge=0.9994 (last merge round=32)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9981539150293807, 'loss_val': 0.02813640475749784, 'psi': 0.9972020483954804}-{'f1_val': 0.9969845827789485, 'auprc': 0.9992855840711239, 'loss_val': 0.02928187759647598, 'psi': 0.9979049832958187}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.453933 cos_to_last_merge=0.9480 (last merge round=27)
[S13] ⚠️ Model drifted since last merge! cos=0.948
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5732248979967016, 'auprc': 0.5349283922759264, 'loss_val': 0.9814154324521248, 'psi': 0.5579062957083916}-{'f1_val': 0.6156346810331254, 'auprc': 0.5775984912933261, 'loss_val': 0.7718665508092541, 'psi': 0.6004202051372056}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=2.141194 cos_to_last_merge=0.9989 (last merge round=32)
[S14] round=37 local utility u=0.035379 metrics={'f1_val': 0.994320097562669, 'auprc': 0.9964974020929498, 'loss_val': 0.053195008700557635, 'psi': 0.9951910193747814}-{'f1_val': 0.9865041239629471, 'auprc': 0.9971846609693307, 'loss_val': 0.07911925816658547, 'psi': 0.9907763387655005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=37 head_norm_before_train=1.826502 cos_to_last_merge=0.9993 (last merge round=32)
[S15] round=37 local utility u=0.327512 metrics={'f1_val': 0.9966587743411154, 'auprc': 0.9971565675444978, 'loss_val': 0.05014034069922095, 'psi': 0.9968578916224684}-{'f1_val': 0.9025504587347448, 'auprc': 0.9976584180066556, 'loss_val': 0.14201980516784934, 'psi': 0.9405936424435091}
[S16] START round=37 head_norm_before_train=1.645071 cos_to_last_merge=0.9998 (last merge round=34)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8695749773310453, 'auprc': 0.9940381145884373, 'loss_val': 0.5169501811982056, 'psi': 0.919360232234002}-{'f1_val': 0.9891605922276062, 'auprc': 0.9929292497643925, 'loss_val': 0.06250976789209216, 'psi': 0.9906680552423208}
[S17] START round=37 head_norm_before_train=1.338644 cos_to_last_merge=0.9986 (last merge round=33)
[S17] round=37 local utility u=0.013504 metrics={'f1_val': 0.42408488958962476, 'auprc': 0.8263413991319435, 'loss_val': 0.592780334570765, 'psi': 0.5849874934065522}-{'f1_val': 0.42171436248114436, 'auprc': 0.8297546342157018, 'loss_val': 0.6158040026605373, 'psi': 0.5849304711749674}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.585)
[S10] not sending this round → trigger blocked (psi=0.993)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.669353 cos_to_last_merge=0.9918 (last merge round=30)
[S2] round=38 local utility u=0.093814 metrics={'f1_val': 0.9371375863086546, 'auprc': 0.984698283155441, 'loss_val': 0.10783090244377347, 'psi': 0.9561618650473691}-{'f1_val': 0.9128684351673416, 'auprc': 0.984103651557591, 'loss_val': 0.14806108009579122, 'psi': 0.9413625217234414}
[S3] START round=38 head_norm_before_train=2.242937 (no previous merge yet)
[S3] round=38 local utility u=1.000000 metrics={'f1_val': 0.9957599844192787, 'auprc': 0.9996282027090755, 'loss_val': 0.02135107367316185, 'psi': 0.9973072717351974}-{'f1_val': 0.702615956317913, 'auprc': 0.9778879759828899, 'loss_val': 0.9960427891595464, 'psi': 0.8127247641839037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=38 head_norm_before_train=1.932179 (no previous merge yet)
[S4] round=38 local utility u=0.700511 metrics={'f1_val': 0.9438487223617704, 'auprc': 0.9661459148174822, 'loss_val': 0.28849326691764526, 'psi': 0.9527675993440551}-{'f1_val': 0.7826890700808014, 'auprc': 0.8705005971387514, 'loss_val': 0.4356216503847265, 'psi': 0.8178136809039813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=38 head_norm_before_train=1.973001 cos_to_last_merge=0.9795 (last merge round=32)
[S5] round=38 local utility u=0.197197 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9984859091220232, 'loss_val': 0.07073663528753202, 'psi': 0.9978563143604046}-{'f1_val': 0.9468526103226975, 'auprc': 0.9907383194653328, 'loss_val': 0.1383831256914817, 'psi': 0.9644068939797517}
[S6] START round=38 head_norm_before_train=1.457113 cos_to_last_merge=0.9876 (last merge round=34)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.6245434486817638, 'auprc': 0.9287009638490016, 'loss_val': 0.6578002823629011, 'psi': 0.7462064547486589}-{'f1_val': 0.8045052321917515, 'auprc': 0.9349699287092614, 'loss_val': 0.49874493387424473, 'psi': 0.8566911107987555}
[S7] START round=38 head_norm_before_train=1.626784 cos_to_last_merge=0.9994 (last merge round=32)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6741240517220156, 'auprc': 0.8488910248759769, 'loss_val': 0.360731835867353, 'psi': 0.7440308409836001}-{'f1_val': 0.6964818408777597, 'auprc': 0.9778868040475761, 'loss_val': 0.20086889383761905, 'psi': 0.8090438261456863}
[S8] START round=38 head_norm_before_train=1.662477 cos_to_last_merge=0.9994 (last merge round=33)
[S8] round=38 local utility u=0.007652 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9952754442840095, 'loss_val': 0.04511055730870963, 'psi': 0.9933685619326229}-{'f1_val': 0.9930498182224239, 'auprc': 0.9938402372595379, 'loss_val': 0.06182341288292321, 'psi': 0.9933659858372694}
[S9] START round=38 head_norm_before_train=2.090002 cos_to_last_merge=0.9878 (last merge round=27)
[S9] round=38 local utility u=0.000822 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9996505244108903, 'loss_val': 0.02576887808176957, 'psi': 0.9971097092863277}-{'f1_val': 0.9954158325366191, 'auprc': 0.999759583088832, 'loss_val': 0.027739856028956577, 'psi': 0.9971533327575043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=38 head_norm_before_train=2.118070 cos_to_last_merge=0.9998 (last merge round=34)
[S10] round=38 local utility u=0.000273 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9942959872902581, 'loss_val': 0.03997551322059033, 'psi': 0.9933590740842277}-{'f1_val': 0.9927344652802075, 'auprc': 0.9942916529737227, 'loss_val': 0.04050877397718605, 'psi': 0.9933573403576136}
[S11] START round=38 head_norm_before_train=1.845510 cos_to_last_merge=0.9992 (last merge round=32)
[S11] round=38 local utility u=0.000430 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9984531328124606, 'loss_val': 0.028173683206488345, 'psi': 0.9973217355087125}-{'f1_val': 0.996567470639547, 'auprc': 0.9981539150293807, 'loss_val': 0.02813640475749784, 'psi': 0.9972020483954804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=38 head_norm_before_train=1.463884 cos_to_last_merge=0.9455 (last merge round=27)
[S13] ⚠️ Model drifted since last merge! cos=0.946
[S13] round=38 local utility u=0.061163 metrics={'f1_val': 0.5820711490745204, 'auprc': 0.5416139864300421, 'loss_val': 0.9322231454810792, 'psi': 0.5658882840167291}-{'f1_val': 0.5732248979967016, 'auprc': 0.5349283922759264, 'loss_val': 0.9814154324521248, 'psi': 0.5579062957083916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=38 head_norm_before_train=2.156338 cos_to_last_merge=0.9984 (last merge round=32)
[S14] round=38 local utility u=0.013005 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9961720764315103, 'loss_val': 0.04707395107022282, 'psi': 0.9971473367285408}-{'f1_val': 0.994320097562669, 'auprc': 0.9964974020929498, 'loss_val': 0.053195008700557635, 'psi': 0.9951910193747814}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=38 head_norm_before_train=1.838186 cos_to_last_merge=0.9990 (last merge round=32)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.9749225391571208, 'auprc': 0.9979789348513933, 'loss_val': 0.058081484053289736, 'psi': 0.9841450974348298}-{'f1_val': 0.9966587743411154, 'auprc': 0.9971565675444978, 'loss_val': 0.05014034069922095, 'psi': 0.9968578916224684}
[S16] START round=38 head_norm_before_train=1.664687 cos_to_last_merge=0.9995 (last merge round=34)
[S16] round=38 local utility u=0.539284 metrics={'f1_val': 0.9754990728667179, 'auprc': 0.9976110365418123, 'loss_val': 0.08464577051385969, 'psi': 0.9843438583367556}-{'f1_val': 0.8695749773310453, 'auprc': 0.9940381145884373, 'loss_val': 0.5169501811982056, 'psi': 0.919360232234002}
[S17] START round=38 head_norm_before_train=1.353840 cos_to_last_merge=0.9977 (last merge round=33)
[S17] round=38 local utility u=0.482524 metrics={'f1_val': 0.5704227373916144, 'auprc': 0.8399466258297736, 'loss_val': 0.5465755549106672, 'psi': 0.6782322927668781}-{'f1_val': 0.42408488958962476, 'auprc': 0.8263413991319435, 'loss_val': 0.592780334570765, 'psi': 0.5849874934065522}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S2] START round=39 head_norm_before_train=1.697500 cos_to_last_merge=0.9899 (last merge round=30)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.8856059795811436, 'auprc': 0.9809622972909516, 'loss_val': 0.22015889562879756, 'psi': 0.9237485066650668}-{'f1_val': 0.9371375863086546, 'auprc': 0.984698283155441, 'loss_val': 0.10783090244377347, 'psi': 0.9561618650473691}
[S3] START round=39 head_norm_before_train=2.252984 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9559596535689642, 'auprc': 0.9969638357689511, 'loss_val': 0.10798878041269716, 'psi': 0.9723613264489589}-{'f1_val': 0.9957599844192787, 'auprc': 0.9996282027090755, 'loss_val': 0.02135107367316185, 'psi': 0.9973072717351974}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.972 u=0.0000 p_local=0.2969 f1=0.956 auprc=0.997 bytes=34143
[S4] START round=39 head_norm_before_train=1.937956 (no previous merge yet)
[S4] round=39 local utility u=0.037226 metrics={'f1_val': 0.9532384568030341, 'auprc': 0.9683805906352232, 'loss_val': 0.2770841684721304, 'psi': 0.9592953103359098}-{'f1_val': 0.9438487223617704, 'auprc': 0.9661459148174822, 'loss_val': 0.28849326691764526, 'psi': 0.9527675993440551}
[S4] not sending this round → trigger blocked (psi=0.959)
[S4] r=40 psi=0.959 u=0.0372 p_local=0.1661 f1=0.953 auprc=0.968 bytes=30574
[S5] START round=39 head_norm_before_train=1.989985 cos_to_last_merge=0.9777 (last merge round=32)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9941927036963267, 'loss_val': 0.06520519519344774, 'psi': 0.9959188166451693}-{'f1_val': 0.9974365845193254, 'auprc': 0.9984859091220232, 'loss_val': 0.07073663528753202, 'psi': 0.9978563143604046}
[S6] START round=39 head_norm_before_train=1.493325 cos_to_last_merge=0.9828 (last merge round=34)
[S6] round=39 local utility u=0.887254 metrics={'f1_val': 0.847415599710041, 'auprc': 0.9561897038295906, 'loss_val': 0.3029910350156603, 'psi': 0.8909252413578608}-{'f1_val': 0.6245434486817638, 'auprc': 0.9287009638490016, 'loss_val': 0.6578002823629011, 'psi': 0.7462064547486589}
[S7] START round=39 head_norm_before_train=1.631160 cos_to_last_merge=0.9993 (last merge round=32)
[S7] round=39 local utility u=0.017988 metrics={'f1_val': 0.6941024874670174, 'auprc': 0.8307165686428826, 'loss_val': 0.39010280430887934, 'psi': 0.7487481199373635}-{'f1_val': 0.6741240517220156, 'auprc': 0.8488910248759769, 'loss_val': 0.360731835867353, 'psi': 0.7440308409836001}
[S8] START round=39 head_norm_before_train=1.673447 cos_to_last_merge=0.9992 (last merge round=33)
[S8] round=39 local utility u=0.001230 metrics={'f1_val': 0.9924932660920454, 'auprc': 0.9953782489054991, 'loss_val': 0.045334745514721976, 'psi': 0.9936472592174268}-{'f1_val': 0.9920973070316986, 'auprc': 0.9952754442840095, 'loss_val': 0.04511055730870963, 'psi': 0.9933685619326229}
[S9] START round=39 head_norm_before_train=2.103073 cos_to_last_merge=0.9869 (last merge round=27)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9953480822663271, 'loss_val': 0.038029793107665896, 'psi': 0.9924703561151268}-{'f1_val': 0.9954158325366191, 'auprc': 0.9996505244108903, 'loss_val': 0.02576887808176957, 'psi': 0.9971097092863277}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.992 u=0.0000 p_local=0.0083 f1=0.991 auprc=0.995 bytes=39579
[S10] START round=39 head_norm_before_train=2.131366 cos_to_last_merge=0.9997 (last merge round=34)
[S10] round=39 local utility u=0.000420 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9947098858720245, 'loss_val': 0.04037780349201313, 'psi': 0.9935246335169343}-{'f1_val': 0.9927344652802075, 'auprc': 0.9942959872902581, 'loss_val': 0.03997551322059033, 'psi': 0.9933590740842277}
[S11] START round=39 head_norm_before_train=1.855873 cos_to_last_merge=0.9990 (last merge round=32)
[S11] round=39 local utility u=0.002280 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9989097648927389, 'loss_val': 0.025914141567065858, 'psi': 0.9975973577060048}-{'f1_val': 0.996567470639547, 'auprc': 0.9984531328124606, 'loss_val': 0.028173683206488345, 'psi': 0.9973217355087125}
[S11] not sending this round → trigger blocked (psi=0.998)
[S11] r=40 psi=0.998 u=0.0023 p_local=0.0056 f1=0.997 auprc=0.999 bytes=43177
[S13] START round=39 head_norm_before_train=1.472664 cos_to_last_merge=0.9440 (last merge round=27)
[S13] ⚠️ Model drifted since last merge! cos=0.944
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5697265984891138, 'auprc': 0.538874871673494, 'loss_val': 1.0136941762056462, 'psi': 0.5573859077628659}-{'f1_val': 0.5820711490745204, 'auprc': 0.5416139864300421, 'loss_val': 0.9322231454810792, 'psi': 0.5658882840167291}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.557 u=0.0000 p_local=0.0562 f1=0.570 auprc=0.539 bytes=35965
[S14] START round=39 head_norm_before_train=2.168409 cos_to_last_merge=0.9980 (last merge round=32)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9060241978286476, 'auprc': 0.9965788087706897, 'loss_val': 0.2083737470118756, 'psi': 0.9422460422054645}-{'f1_val': 0.9977975102598944, 'auprc': 0.9961720764315103, 'loss_val': 0.04707395107022282, 'psi': 0.9971473367285408}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.942 u=0.0000 p_local=0.0373 f1=0.906 auprc=0.997 bytes=37776
[S15] START round=39 head_norm_before_train=1.849466 cos_to_last_merge=0.9987 (last merge round=32)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.8840714856005848, 'auprc': 0.996673708304921, 'loss_val': 0.21096900313498657, 'psi': 0.9291123746823192}-{'f1_val': 0.9749225391571208, 'auprc': 0.9979789348513933, 'loss_val': 0.058081484053289736, 'psi': 0.9841450974348298}
[S16] START round=39 head_norm_before_train=1.678036 cos_to_last_merge=0.9992 (last merge round=34)
[S16] round=39 local utility u=0.061017 metrics={'f1_val': 0.9915293093038144, 'auprc': 0.9945916972186033, 'loss_val': 0.04973500819735673, 'psi': 0.99275426446973}-{'f1_val': 0.9754990728667179, 'auprc': 0.9976110365418123, 'loss_val': 0.08464577051385969, 'psi': 0.9843438583367556}
[S17] START round=39 head_norm_before_train=1.369229 cos_to_last_merge=0.9963 (last merge round=33)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5492453414277159, 'auprc': 0.7376945423919653, 'loss_val': 0.629909764928786, 'psi': 0.6246250218134157}-{'f1_val': 0.5704227373916144, 'auprc': 0.8399466258297736, 'loss_val': 0.5465755549106672, 'psi': 0.6782322927668781}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.994)
[S16] not sending this round → trigger blocked (psi=0.993)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.749 u=0.0180 p_local=0.2237 f1=0.694 auprc=0.831 bytes=30556
[S5] r=40 psi=0.996 u=0.0000 p_local=0.1622 f1=0.997 auprc=0.994 bytes=35985
[S16] r=40 psi=0.993 u=0.0610 p_local=0.2092 f1=0.992 auprc=0.995 bytes=35969
[S6] r=40 psi=0.891 u=0.8873 p_local=0.3601 f1=0.847 auprc=0.956 bytes=32408
[S2] r=40 psi=0.924 u=0.0000 p_local=0.0960 f1=0.886 auprc=0.981 bytes=35953
[S10] r=40 psi=0.994 u=0.0004 p_local=0.0025 f1=0.993 auprc=0.995 bytes=39551
[S15] r=40 psi=0.929 u=0.0000 p_local=0.1493 f1=0.884 auprc=0.997 bytes=32376
[S8] not sending this round → trigger blocked (psi=0.994)
[S17] r=40 psi=0.625 u=0.0000 p_local=0.1318 f1=0.549 auprc=0.738 bytes=35983
[S8] r=40 psi=0.994 u=0.0012 p_local=0.0953 f1=0.992 auprc=0.995 bytes=39554
[S2] START round=40 head_norm_before_train=1.721919 cos_to_last_merge=0.9881 (last merge round=30)
[S2] round=40 local utility u=0.399094 metrics={'f1_val': 0.9896997515515229, 'auprc': 0.9836320727507717, 'loss_val': 0.05454229308226034, 'psi': 0.9872726800312224}-{'f1_val': 0.8856059795811436, 'auprc': 0.9809622972909516, 'loss_val': 0.22015889562879756, 'psi': 0.9237485066650668}
[S3] START round=40 head_norm_before_train=2.262641 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9539462952555848, 'auprc': 0.9934426690893606, 'loss_val': 0.13125319580514053, 'psi': 0.9697448447890951}-{'f1_val': 0.9559596535689642, 'auprc': 0.9969638357689511, 'loss_val': 0.10798878041269716, 'psi': 0.9723613264489589}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.943419 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9404294935195701, 'auprc': 0.9467785811675533, 'loss_val': 0.2994102694162082, 'psi': 0.9429691285787634}-{'f1_val': 0.9532384568030341, 'auprc': 0.9683805906352232, 'loss_val': 0.2770841684721304, 'psi': 0.9592953103359098}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=2.001868 cos_to_last_merge=0.9764 (last merge round=32)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9908208634447193, 'loss_val': 0.08114737999757315, 'psi': 0.9943495264649623}-{'f1_val': 0.9970695586110643, 'auprc': 0.9941927036963267, 'loss_val': 0.06520519519344774, 'psi': 0.9959188166451693}
[S6] START round=40 head_norm_before_train=1.524274 cos_to_last_merge=0.9787 (last merge round=34)
[S6] round=40 local utility u=0.260884 metrics={'f1_val': 0.9105735116642477, 'auprc': 0.9676136566770548, 'loss_val': 0.1944425829237068, 'psi': 0.9333895696693706}-{'f1_val': 0.847415599710041, 'auprc': 0.9561897038295906, 'loss_val': 0.3029910350156603, 'psi': 0.8909252413578608}
[S7] START round=40 head_norm_before_train=1.640850 cos_to_last_merge=0.9990 (last merge round=32)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6590138074485852, 'auprc': 0.8842252564321988, 'loss_val': 0.4211764725738571, 'psi': 0.7490983870420307}-{'f1_val': 0.6941024874670174, 'auprc': 0.8307165686428826, 'loss_val': 0.39010280430887934, 'psi': 0.7487481199373635}
[S8] START round=40 head_norm_before_train=1.684292 cos_to_last_merge=0.9990 (last merge round=33)
[S8] round=40 local utility u=0.005577 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9986600253592751, 'loss_val': 0.04165093936906201, 'psi': 0.9947223943627292}-{'f1_val': 0.9924932660920454, 'auprc': 0.9953782489054991, 'loss_val': 0.045334745514721976, 'psi': 0.9936472592174268}
[S9] START round=40 head_norm_before_train=2.112683 cos_to_last_merge=0.9861 (last merge round=27)
[S9] round=40 local utility u=0.032272 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995656968816095, 'loss_val': 0.022790097800984153, 'psi': 0.9978225858409786}-{'f1_val': 0.9905518720143266, 'auprc': 0.9953480822663271, 'loss_val': 0.038029793107665896, 'psi': 0.9924703561151268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=40 head_norm_before_train=2.144132 cos_to_last_merge=0.9995 (last merge round=34)
[S10] round=40 local utility u=0.000388 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9939200838895476, 'loss_val': 0.03854410645326186, 'psi': 0.9933399795736141}-{'f1_val': 0.9927344652802075, 'auprc': 0.9947098858720245, 'loss_val': 0.04037780349201313, 'psi': 0.9935246335169343}
[S11] START round=40 head_norm_before_train=1.864748 cos_to_last_merge=0.9988 (last merge round=32)
[S11] round=40 local utility u=0.002270 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9994247691279888, 'loss_val': 0.024511182839599015, 'psi': 0.997962618505725}-{'f1_val': 0.9967224195815153, 'auprc': 0.9989097648927389, 'loss_val': 0.025914141567065858, 'psi': 0.9975973577060048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=40 head_norm_before_train=1.481352 cos_to_last_merge=0.9422 (last merge round=27)
[S13] ⚠️ Model drifted since last merge! cos=0.942
[S13] round=40 local utility u=0.334812 metrics={'f1_val': 0.6119549357099534, 'auprc': 0.5976781677163396, 'loss_val': 0.7738490893901188, 'psi': 0.6062442285125079}-{'f1_val': 0.5697265984891138, 'auprc': 0.538874871673494, 'loss_val': 1.0136941762056462, 'psi': 0.5573859077628659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=40 head_norm_before_train=2.180980 cos_to_last_merge=0.9976 (last merge round=32)
[S14] round=40 local utility u=0.153885 metrics={'f1_val': 0.9461047105254711, 'auprc': 0.9964673692560696, 'loss_val': 0.1407527502774613, 'psi': 0.9662497740177105}-{'f1_val': 0.9060241978286476, 'auprc': 0.9965788087706897, 'loss_val': 0.2083737470118756, 'psi': 0.9422460422054645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=40 head_norm_before_train=1.861440 cos_to_last_merge=0.9983 (last merge round=32)
[S15] round=40 local utility u=0.074857 metrics={'f1_val': 0.9013260441437247, 'auprc': 0.9966456247580283, 'loss_val': 0.1646983476877779, 'psi': 0.9394538763894462}-{'f1_val': 0.8840714856005848, 'auprc': 0.996673708304921, 'loss_val': 0.21096900313498657, 'psi': 0.9291123746823192}
[S16] START round=40 head_norm_before_train=1.690219 cos_to_last_merge=0.9989 (last merge round=34)
[S16] round=40 local utility u=0.004469 metrics={'f1_val': 0.9919481237413861, 'auprc': 0.9964213496624929, 'loss_val': 0.04879855330512251, 'psi': 0.9937374141098289}-{'f1_val': 0.9915293093038144, 'auprc': 0.9945916972186033, 'loss_val': 0.04973500819735673, 'psi': 0.99275426446973}
[S17] START round=40 head_norm_before_train=1.387553 cos_to_last_merge=0.9943 (last merge round=33)
[S17] round=40 local utility u=0.119623 metrics={'f1_val': 0.5745720640809431, 'auprc': 0.7837482525828144, 'loss_val': 0.6807849930552593, 'psi': 0.6582425394816916}-{'f1_val': 0.5492453414277159, 'auprc': 0.7376945423919653, 'loss_val': 0.629909764928786, 'psi': 0.6246250218134157}
[S16]  timeout peer S7
[S15]  timeout peer S9
[S10]  timeout peer S14
[S7]  timeout peer S16
[S8]  timeout peer S2
[S8]  timeout peer S15
[S5]  timeout peer S11
[S17]  timeout peer S13
[S6]  timeout peer S17
[S2]  timeout peer S8
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] START round=41 head_norm_before_train=1.744176 cos_to_last_merge=0.9866 (last merge round=30)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.8507231629934684, 'auprc': 0.9194253145145352, 'loss_val': 0.35239852071540223, 'psi': 0.8782040236018952}-{'f1_val': 0.9896997515515229, 'auprc': 0.9836320727507717, 'loss_val': 0.05454229308226034, 'psi': 0.9872726800312224}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.271138 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.6483704404621617, 'auprc': 0.9650541993772137, 'loss_val': 1.2984680011987773, 'psi': 0.7750439440281826}-{'f1_val': 0.9539462952555848, 'auprc': 0.9934426690893606, 'loss_val': 0.13125319580514053, 'psi': 0.9697448447890951}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.953268 (no previous merge yet)
[S4] round=41 local utility u=0.012492 metrics={'f1_val': 0.9422835173319319, 'auprc': 0.9498737979348713, 'loss_val': 0.2948350737871842, 'psi': 0.9453196295731077}-{'f1_val': 0.9404294935195701, 'auprc': 0.9467785811675533, 'loss_val': 0.2994102694162082, 'psi': 0.9429691285787634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=41 head_norm_before_train=2.013224 cos_to_last_merge=0.9752 (last merge round=32)
[S5] round=41 local utility u=0.027104 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9971118850148393, 'loss_val': 0.04801898027070243, 'psi': 0.9970864891725744}-{'f1_val': 0.9967019684784577, 'auprc': 0.9908208634447193, 'loss_val': 0.08114737999757315, 'psi': 0.9943495264649623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=41 head_norm_before_train=1.552215 cos_to_last_merge=0.9748 (last merge round=34)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7140207551490213, 'auprc': 0.9175237359386352, 'loss_val': 0.6324742255522781, 'psi': 0.7954219474648669}-{'f1_val': 0.9105735116642477, 'auprc': 0.9676136566770548, 'loss_val': 0.1944425829237068, 'psi': 0.9333895696693706}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.652369 cos_to_last_merge=0.9985 (last merge round=32)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.6357746687099473, 'auprc': 0.8994022805528242, 'loss_val': 0.42175780782324895, 'psi': 0.7412257134470981}-{'f1_val': 0.6590138074485852, 'auprc': 0.8842252564321988, 'loss_val': 0.4211764725738571, 'psi': 0.7490983870420307}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.695353 cos_to_last_merge=0.9987 (last merge round=33)
[S8] round=41 local utility u=0.008562 metrics={'f1_val': 0.994753542178155, 'auprc': 0.9977732111225209, 'loss_val': 0.03780419955754652, 'psi': 0.9959614097559014}-{'f1_val': 0.9920973070316986, 'auprc': 0.9986600253592751, 'loss_val': 0.04165093936906201, 'psi': 0.9947223943627292}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=41 head_norm_before_train=2.121918 cos_to_last_merge=0.9855 (last merge round=27)
[S9] round=41 local utility u=0.000014 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9994931305037936, 'loss_val': 0.02254538354730414, 'psi': 0.9977935592898524}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995656968816095, 'loss_val': 0.022790097800984153, 'psi': 0.9978225858409786}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=41 head_norm_before_train=2.152254 cos_to_last_merge=0.9994 (last merge round=34)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9916416510309638, 'auprc': 0.99659017557774, 'loss_val': 0.043362829621697664, 'psi': 0.9936210608496743}-{'f1_val': 0.9929532433629917, 'auprc': 0.9939200838895476, 'loss_val': 0.03854410645326186, 'psi': 0.9933399795736141}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.872185 cos_to_last_merge=0.9985 (last merge round=32)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9989344187565183, 'loss_val': 0.031775255301028024, 'psi': 0.9976213757864762}-{'f1_val': 0.9969878514242156, 'auprc': 0.9994247691279888, 'loss_val': 0.024511182839599015, 'psi': 0.997962618505725}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.493991 cos_to_last_merge=0.9414 (last merge round=27)
[S13] ⚠️ Model drifted since last merge! cos=0.941
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5595788271806836, 'auprc': 0.5185265884021961, 'loss_val': 1.1559088176096393, 'psi': 0.5431579316692886}-{'f1_val': 0.6119549357099534, 'auprc': 0.5976781677163396, 'loss_val': 0.7738490893901188, 'psi': 0.6062442285125079}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.192362 cos_to_last_merge=0.9971 (last merge round=32)
[S14] round=41 local utility u=0.201172 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.9962776558735914, 'loss_val': 0.045510896113934114, 'psi': 0.9969410923666404}-{'f1_val': 0.9461047105254711, 'auprc': 0.9964673692560696, 'loss_val': 0.1407527502774613, 'psi': 0.9662497740177105}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=41 head_norm_before_train=1.874509 cos_to_last_merge=0.9979 (last merge round=32)
[S15] round=41 local utility u=0.038749 metrics={'f1_val': 0.9068545863401656, 'auprc': 0.998046540190827, 'loss_val': 0.12457476765639264, 'psi': 0.9433313678804301}-{'f1_val': 0.9013260441437247, 'auprc': 0.9966456247580283, 'loss_val': 0.1646983476877779, 'psi': 0.9394538763894462}
[S15] not sending this round → trigger blocked (psi=0.943)
[S16] START round=41 head_norm_before_train=1.702681 cos_to_last_merge=0.9986 (last merge round=34)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.991361520093188, 'auprc': 0.994710281622865, 'loss_val': 0.04055917239957891, 'psi': 0.9927010247050588}-{'f1_val': 0.9919481237413861, 'auprc': 0.9964213496624929, 'loss_val': 0.04879855330512251, 'psi': 0.9937374141098289}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.408699 cos_to_last_merge=0.9919 (last merge round=33)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.5133387474194979, 'auprc': 0.7022864441521844, 'loss_val': 0.8368730399508466, 'psi': 0.5889178261125725}-{'f1_val': 0.5745720640809431, 'auprc': 0.7837482525828144, 'loss_val': 0.6807849930552593, 'psi': 0.6582425394816916}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.763320 cos_to_last_merge=0.9853 (last merge round=30)
[S2] round=42 local utility u=0.647206 metrics={'f1_val': 0.9869580417590681, 'auprc': 0.9814628693084195, 'loss_val': 0.06150931838355395, 'psi': 0.9847599727788087}-{'f1_val': 0.8507231629934684, 'auprc': 0.9194253145145352, 'loss_val': 0.35239852071540223, 'psi': 0.8782040236018952}
[S2] not sending this round → trigger blocked (psi=0.985)
[S3] START round=42 head_norm_before_train=2.278233 (no previous merge yet)
[S3] round=42 local utility u=1.000000 metrics={'f1_val': 0.9840742528009294, 'auprc': 0.9992508160556546, 'loss_val': 0.044987447237637083, 'psi': 0.9901448781028195}-{'f1_val': 0.6483704404621617, 'auprc': 0.9650541993772137, 'loss_val': 1.2984680011987773, 'psi': 0.7750439440281826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=42 head_norm_before_train=1.958284 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9373618380485075, 'auprc': 0.9143211015337105, 'loss_val': 0.3213010655929273, 'psi': 0.9281455434425887}-{'f1_val': 0.9422835173319319, 'auprc': 0.9498737979348713, 'loss_val': 0.2948350737871842, 'psi': 0.9453196295731077}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=2.031912 cos_to_last_merge=0.9732 (last merge round=32)
[S5] round=42 local utility u=0.003000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9994471974759398, 'loss_val': 0.049025032610001594, 'psi': 0.9980206141570145}-{'f1_val': 0.9970695586110643, 'auprc': 0.9971118850148393, 'loss_val': 0.04801898027070243, 'psi': 0.9970864891725744}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=42 head_norm_before_train=1.575596 cos_to_last_merge=0.9713 (last merge round=34)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6181408053398671, 'auprc': 0.8778627469994572, 'loss_val': 0.9116022515528903, 'psi': 0.7220295820037032}-{'f1_val': 0.7140207551490213, 'auprc': 0.9175237359386352, 'loss_val': 0.6324742255522781, 'psi': 0.7954219474648669}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.668472 cos_to_last_merge=0.9977 (last merge round=32)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5815895777305737, 'auprc': 0.7978119614193512, 'loss_val': 0.7502376649858143, 'psi': 0.6680785312060847}-{'f1_val': 0.6357746687099473, 'auprc': 0.8994022805528242, 'loss_val': 0.42175780782324895, 'psi': 0.7412257134470981}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.705815 cos_to_last_merge=0.9985 (last merge round=33)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9984056836785647, 'loss_val': 0.04105283385907066, 'psi': 0.994620657690445}-{'f1_val': 0.994753542178155, 'auprc': 0.9977732111225209, 'loss_val': 0.03780419955754652, 'psi': 0.9959614097559014}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=2.132128 cos_to_last_merge=0.9848 (last merge round=27)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9918149940667227, 'auprc': 0.9995270092104418, 'loss_val': 0.03327126310861504, 'psi': 0.9948998001242103}-{'f1_val': 0.9966605118138915, 'auprc': 0.9994931305037936, 'loss_val': 0.02254538354730414, 'psi': 0.9977935592898524}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.160197 cos_to_last_merge=0.9992 (last merge round=34)
[S10] round=42 local utility u=0.002065 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9931538508420548, 'loss_val': 0.036792563959888794, 'psi': 0.993033486354617}-{'f1_val': 0.9916416510309638, 'auprc': 0.99659017557774, 'loss_val': 0.043362829621697664, 'psi': 0.9936210608496743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=42 head_norm_before_train=1.880010 cos_to_last_merge=0.9983 (last merge round=32)
[S11] round=42 local utility u=0.002732 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9991932925892408, 'loss_val': 0.02446573987671206, 'psi': 0.9974627678059176}-{'f1_val': 0.9967460138064482, 'auprc': 0.9989344187565183, 'loss_val': 0.031775255301028024, 'psi': 0.9976213757864762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=42 head_norm_before_train=1.502268 cos_to_last_merge=0.9403 (last merge round=27)
[S13] ⚠️ Model drifted since last merge! cos=0.940
[S13] round=42 local utility u=0.153280 metrics={'f1_val': 0.5713464884222231, 'auprc': 0.5502431477810419, 'loss_val': 1.0151039684901677, 'psi': 0.5629051521657507}-{'f1_val': 0.5595788271806836, 'auprc': 0.5185265884021961, 'loss_val': 1.1559088176096393, 'psi': 0.5431579316692886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=42 head_norm_before_train=2.202329 cos_to_last_merge=0.9967 (last merge round=32)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.991440119550567, 'auprc': 0.9968002412217086, 'loss_val': 0.054426131795752106, 'psi': 0.9935841682190236}-{'f1_val': 0.9973833833620065, 'auprc': 0.9962776558735914, 'loss_val': 0.045510896113934114, 'psi': 0.9969410923666404}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.887116 cos_to_last_merge=0.9975 (last merge round=32)
[S15] round=42 local utility u=0.132326 metrics={'f1_val': 0.9421306922724574, 'auprc': 0.9986146849777038, 'loss_val': 0.07328444629622942, 'psi': 0.964724289354556}-{'f1_val': 0.9068545863401656, 'auprc': 0.998046540190827, 'loss_val': 0.12457476765639264, 'psi': 0.9433313678804301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=42 head_norm_before_train=1.711894 cos_to_last_merge=0.9982 (last merge round=34)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8460957469904791, 'auprc': 0.9875957697311601, 'loss_val': 0.8716212874412194, 'psi': 0.9026957560867515}-{'f1_val': 0.991361520093188, 'auprc': 0.994710281622865, 'loss_val': 0.04055917239957891, 'psi': 0.9927010247050588}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.433986 cos_to_last_merge=0.9888 (last merge round=33)
[S17] round=42 local utility u=0.705573 metrics={'f1_val': 0.6480730014280014, 'auprc': 0.8340867468435115, 'loss_val': 0.6295325297199386, 'psi': 0.7224784995942054}-{'f1_val': 0.5133387474194979, 'auprc': 0.7022864441521844, 'loss_val': 0.8368730399508466, 'psi': 0.5889178261125725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S2] START round=43 head_norm_before_train=1.779526 cos_to_last_merge=0.9843 (last merge round=30)
[S2] round=43 local utility u=0.004637 metrics={'f1_val': 0.9883047395142133, 'auprc': 0.9815094661309998, 'loss_val': 0.06045581599841545, 'psi': 0.9855866301609278}-{'f1_val': 0.9869580417590681, 'auprc': 0.9814628693084195, 'loss_val': 0.06150931838355395, 'psi': 0.9847599727788087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=43 head_norm_before_train=2.284959 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.949325095333508, 'auprc': 0.997224698832948, 'loss_val': 0.10281215088128642, 'psi': 0.968484936733284}-{'f1_val': 0.9840742528009294, 'auprc': 0.9992508160556546, 'loss_val': 0.044987447237637083, 'psi': 0.9901448781028195}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.964154 (no previous merge yet)
[S4] round=43 local utility u=0.022892 metrics={'f1_val': 0.9383231317657741, 'auprc': 0.9204504767630017, 'loss_val': 0.2996722047466301, 'psi': 0.9311740697646651}-{'f1_val': 0.9373618380485075, 'auprc': 0.9143211015337105, 'loss_val': 0.3213010655929273, 'psi': 0.9281455434425887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=43 head_norm_before_train=2.055711 cos_to_last_merge=0.9705 (last merge round=32)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.9124090397871039, 'auprc': 0.9900918406343888, 'loss_val': 0.12867183431320658, 'psi': 0.9434821601260178}-{'f1_val': 0.9970695586110643, 'auprc': 0.9994471974759398, 'loss_val': 0.049025032610001594, 'psi': 0.9980206141570145}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.592660 cos_to_last_merge=0.9687 (last merge round=34)
[S6] round=43 local utility u=1.000000 metrics={'f1_val': 0.9686074231162818, 'auprc': 0.953548587500183, 'loss_val': 0.13557625530858308, 'psi': 0.9625838888698423}-{'f1_val': 0.6181408053398671, 'auprc': 0.8778627469994572, 'loss_val': 0.9116022515528903, 'psi': 0.7220295820037032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=43 head_norm_before_train=1.681605 cos_to_last_merge=0.9970 (last merge round=32)
[S7] round=43 local utility u=0.185706 metrics={'f1_val': 0.6128818326689425, 'auprc': 0.8049416638635603, 'loss_val': 0.5879691088914414, 'psi': 0.6897057651467896}-{'f1_val': 0.5815895777305737, 'auprc': 0.7978119614193512, 'loss_val': 0.7502376649858143, 'psi': 0.6680785312060847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=43 head_norm_before_train=1.714307 cos_to_last_merge=0.9983 (last merge round=33)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9917345774119155, 'auprc': 0.998734854866442, 'loss_val': 0.04190281602565492, 'psi': 0.9945346883937262}-{'f1_val': 0.9920973070316986, 'auprc': 0.9984056836785647, 'loss_val': 0.04105283385907066, 'psi': 0.994620657690445}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=2.142235 cos_to_last_merge=0.9841 (last merge round=27)
[S9] round=43 local utility u=0.013849 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9954203468502516, 'loss_val': 0.022518322561880463, 'psi': 0.996183633498958}-{'f1_val': 0.9918149940667227, 'auprc': 0.9995270092104418, 'loss_val': 0.03327126310861504, 'psi': 0.9948998001242103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=43 head_norm_before_train=2.166171 cos_to_last_merge=0.9989 (last merge round=34)
[S10] round=43 local utility u=0.000882 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9938174059438651, 'loss_val': 0.03701857723394778, 'psi': 0.9932989083953412}-{'f1_val': 0.9929532433629917, 'auprc': 0.9931538508420548, 'loss_val': 0.036792563959888794, 'psi': 0.993033486354617}
[S10] not sending this round → trigger blocked (psi=0.993)
[S11] START round=43 head_norm_before_train=1.888939 cos_to_last_merge=0.9981 (last merge round=32)
[S11] round=43 local utility u=0.002654 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9989365699394991, 'loss_val': 0.022317690335952312, 'psi': 0.9977531819515459}-{'f1_val': 0.9963090846170353, 'auprc': 0.9991932925892408, 'loss_val': 0.02446573987671206, 'psi': 0.9974627678059176}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=43 head_norm_before_train=1.505913 cos_to_last_merge=0.9387 (last merge round=27)
[S13] ⚠️ Model drifted since last merge! cos=0.939
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5633381697891426, 'auprc': 0.5491623248181638, 'loss_val': 1.0475726727769452, 'psi': 0.5576678318007511}-{'f1_val': 0.5713464884222231, 'auprc': 0.5502431477810419, 'loss_val': 1.0151039684901677, 'psi': 0.5629051521657507}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.213629 cos_to_last_merge=0.9963 (last merge round=32)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9066659240036979, 'auprc': 0.9964678046831769, 'loss_val': 0.18869192228476306, 'psi': 0.9425866762754895}-{'f1_val': 0.991440119550567, 'auprc': 0.9968002412217086, 'loss_val': 0.054426131795752106, 'psi': 0.9935841682190236}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.898299 cos_to_last_merge=0.9971 (last merge round=32)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.9269573329519754, 'auprc': 0.9979529698594427, 'loss_val': 0.08410877972385067, 'psi': 0.9553555877149623}-{'f1_val': 0.9421306922724574, 'auprc': 0.9986146849777038, 'loss_val': 0.07328444629622942, 'psi': 0.964724289354556}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.722823 cos_to_last_merge=0.9978 (last merge round=34)
[S16] round=43 local utility u=0.491719 metrics={'f1_val': 0.9196283228861281, 'auprc': 0.9962254474880028, 'loss_val': 0.3552670557374639, 'psi': 0.9502671727268779}-{'f1_val': 0.8460957469904791, 'auprc': 0.9875957697311601, 'loss_val': 0.8716212874412194, 'psi': 0.9026957560867515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=43 head_norm_before_train=1.459386 cos_to_last_merge=0.9857 (last merge round=33)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.5735231042535103, 'auprc': 0.7591910754103084, 'loss_val': 0.7188270263597907, 'psi': 0.6477902927162296}-{'f1_val': 0.6480730014280014, 'auprc': 0.8340867468435115, 'loss_val': 0.6295325297199386, 'psi': 0.7224784995942054}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.793490 cos_to_last_merge=0.9833 (last merge round=30)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.8547743663411727, 'auprc': 0.954347673044925, 'loss_val': 0.34578826123256645, 'psi': 0.8946036890226736}-{'f1_val': 0.9883047395142133, 'auprc': 0.9815094661309998, 'loss_val': 0.06045581599841545, 'psi': 0.9855866301609278}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.293063 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9510612893582964, 'auprc': 0.9940612642167352, 'loss_val': 0.13880029226493545, 'psi': 0.9682612793016718}-{'f1_val': 0.949325095333508, 'auprc': 0.997224698832948, 'loss_val': 0.10281215088128642, 'psi': 0.968484936733284}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.969609 (no previous merge yet)
[S4] round=44 local utility u=0.062112 metrics={'f1_val': 0.9415184203020293, 'auprc': 0.9501819370911785, 'loss_val': 0.2838152454395469, 'psi': 0.9449838270176889}-{'f1_val': 0.9383231317657741, 'auprc': 0.9204504767630017, 'loss_val': 0.2996722047466301, 'psi': 0.9311740697646651}
[S4] not sending this round → trigger blocked (psi=0.945)
[S5] START round=44 head_norm_before_train=2.068818 cos_to_last_merge=0.9690 (last merge round=32)
[S5] round=44 local utility u=0.310046 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9987430165087796, 'loss_val': 0.04469835835146933, 'psi': 0.9979591573151071}-{'f1_val': 0.9124090397871039, 'auprc': 0.9900918406343888, 'loss_val': 0.12867183431320658, 'psi': 0.9434821601260178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=44 head_norm_before_train=1.603382 cos_to_last_merge=0.9671 (last merge round=34)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6450711399480007, 'auprc': 0.8307883753344659, 'loss_val': 0.7219320663157454, 'psi': 0.7193580341025868}-{'f1_val': 0.9686074231162818, 'auprc': 0.953548587500183, 'loss_val': 0.13557625530858308, 'psi': 0.9625838888698423}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.688799 cos_to_last_merge=0.9965 (last merge round=32)
[S7] round=44 local utility u=1.000000 metrics={'f1_val': 0.9572674591260057, 'auprc': 0.9938803294191, 'loss_val': 0.19985058114672363, 'psi': 0.9719126072432435}-{'f1_val': 0.6128818326689425, 'auprc': 0.8049416638635603, 'loss_val': 0.5879691088914414, 'psi': 0.6897057651467896}
[S7] not sending this round → trigger blocked (psi=0.972)
[S8] START round=44 head_norm_before_train=1.724170 cos_to_last_merge=0.9981 (last merge round=33)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9917768254438665, 'auprc': 0.9931908007436048, 'loss_val': 0.04434031537527147, 'psi': 0.9923424155637617}-{'f1_val': 0.9917345774119155, 'auprc': 0.998734854866442, 'loss_val': 0.04190281602565492, 'psi': 0.9945346883937262}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=2.151791 cos_to_last_merge=0.9836 (last merge round=27)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9931032914010764, 'auprc': 0.9996739683103669, 'loss_val': 0.026884048144156146, 'psi': 0.9957315621647926}-{'f1_val': 0.9966924912647621, 'auprc': 0.9954203468502516, 'loss_val': 0.022518322561880463, 'psi': 0.996183633498958}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.172799 cos_to_last_merge=0.9987 (last merge round=34)
[S10] round=44 local utility u=0.001710 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9964329696612623, 'loss_val': 0.040132631414740556, 'psi': 0.9942138670326294}-{'f1_val': 0.9929532433629917, 'auprc': 0.9938174059438651, 'loss_val': 0.03701857723394778, 'psi': 0.9932989083953412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=44 head_norm_before_train=1.897209 cos_to_last_merge=0.9978 (last merge round=32)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998318813531865, 'loss_val': 0.02268759195949688, 'psi': 0.9972557281208998}-{'f1_val': 0.9969642566262439, 'auprc': 0.9989365699394991, 'loss_val': 0.022317690335952312, 'psi': 0.9977531819515459}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.509710 cos_to_last_merge=0.9364 (last merge round=27)
[S13] ⚠️ Model drifted since last merge! cos=0.936
[S13] round=44 local utility u=0.215041 metrics={'f1_val': 0.5998591142791831, 'auprc': 0.5582492513329439, 'loss_val': 0.8638773707509667, 'psi': 0.5832151691006875}-{'f1_val': 0.5633381697891426, 'auprc': 0.5491623248181638, 'loss_val': 1.0475726727769452, 'psi': 0.5576678318007511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=44 head_norm_before_train=2.222925 cos_to_last_merge=0.9960 (last merge round=32)
[S14] round=44 local utility u=0.158381 metrics={'f1_val': 0.9490480455956882, 'auprc': 0.9974198285607933, 'loss_val': 0.12907914068183413, 'psi': 0.9683967587817303}-{'f1_val': 0.9066659240036979, 'auprc': 0.9964678046831769, 'loss_val': 0.18869192228476306, 'psi': 0.9425866762754895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=44 head_norm_before_train=1.908468 cos_to_last_merge=0.9968 (last merge round=32)
[S15] round=44 local utility u=0.128893 metrics={'f1_val': 0.9653621075948502, 'auprc': 0.9979611155910579, 'loss_val': 0.05677594061091365, 'psi': 0.9784017107933334}-{'f1_val': 0.9269573329519754, 'auprc': 0.9979529698594427, 'loss_val': 0.08410877972385067, 'psi': 0.9553555877149623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=44 head_norm_before_train=1.734925 cos_to_last_merge=0.9974 (last merge round=34)
[S16] round=44 local utility u=0.374221 metrics={'f1_val': 0.9908722666733435, 'auprc': 0.9979979847495893, 'loss_val': 0.03960664283793675, 'psi': 0.9937225539038419}-{'f1_val': 0.9196283228861281, 'auprc': 0.9962254474880028, 'loss_val': 0.3552670557374639, 'psi': 0.9502671727268779}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=44 head_norm_before_train=1.484051 cos_to_last_merge=0.9826 (last merge round=33)
[S17] round=44 local utility u=0.505702 metrics={'f1_val': 0.6744853505327639, 'auprc': 0.8579333390408372, 'loss_val': 0.6094235319123305, 'psi': 0.7478645459359932}-{'f1_val': 0.5735231042535103, 'auprc': 0.7591910754103084, 'loss_val': 0.7188270263597907, 'psi': 0.6477902927162296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=45 head_norm_before_train=1.807879 cos_to_last_merge=0.9823 (last merge round=30)
[S2] round=45 local utility u=0.591253 metrics={'f1_val': 0.9894962843547117, 'auprc': 0.9800034794310197, 'loss_val': 0.0485812388247836, 'psi': 0.9856991623852349}-{'f1_val': 0.8547743663411727, 'auprc': 0.954347673044925, 'loss_val': 0.34578826123256645, 'psi': 0.8946036890226736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=45 head_norm_before_train=2.301337 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.8313824677238596, 'auprc': 0.9724326659578866, 'loss_val': 0.4857205477069533, 'psi': 0.8878025470174704}-{'f1_val': 0.9510612893582964, 'auprc': 0.9940612642167352, 'loss_val': 0.13880029226493545, 'psi': 0.9682612793016718}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.977700 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.938091134763487, 'auprc': 0.9283464361354454, 'loss_val': 0.29174400982193155, 'psi': 0.9341932553122704}-{'f1_val': 0.9415184203020293, 'auprc': 0.9501819370911785, 'loss_val': 0.2838152454395469, 'psi': 0.9449838270176889}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=2.077281 cos_to_last_merge=0.9681 (last merge round=32)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.714634679148647, 'auprc': 0.8111347061214763, 'loss_val': 0.6515454918520521, 'psi': 0.7532346899377786}-{'f1_val': 0.9974365845193254, 'auprc': 0.9987430165087796, 'loss_val': 0.04469835835146933, 'psi': 0.9979591573151071}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.611652 cos_to_last_merge=0.9655 (last merge round=34)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.5982698822712553, 'auprc': 0.7798737112979506, 'loss_val': 1.0439271921429911, 'psi': 0.6709114138819334}-{'f1_val': 0.6450711399480007, 'auprc': 0.8307883753344659, 'loss_val': 0.7219320663157454, 'psi': 0.7193580341025868}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.694676 cos_to_last_merge=0.9959 (last merge round=32)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6723530093490832, 'auprc': 0.9704456655399343, 'loss_val': 0.3824114858607948, 'psi': 0.7915900718254236}-{'f1_val': 0.9572674591260057, 'auprc': 0.9938803294191, 'loss_val': 0.19985058114672363, 'psi': 0.9719126072432435}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.731326 cos_to_last_merge=0.9978 (last merge round=33)
[S8] round=45 local utility u=0.012739 metrics={'f1_val': 0.9924509553239076, 'auprc': 0.9986110295450616, 'loss_val': 0.039166912822940686, 'psi': 0.9949149850123692}-{'f1_val': 0.9917768254438665, 'auprc': 0.9931908007436048, 'loss_val': 0.04434031537527147, 'psi': 0.9923424155637617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=45 head_norm_before_train=2.161609 cos_to_last_merge=0.9829 (last merge round=27)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9891106000703147, 'auprc': 0.9976284613136106, 'loss_val': 0.04085092233473542, 'psi': 0.992517744567633}-{'f1_val': 0.9931032914010764, 'auprc': 0.9996739683103669, 'loss_val': 0.026884048144156146, 'psi': 0.9957315621647926}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.180762 cos_to_last_merge=0.9985 (last merge round=34)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9936219379714547, 'loss_val': 0.03621854317410326, 'psi': 0.9932207212063769}-{'f1_val': 0.9927344652802075, 'auprc': 0.9964329696612623, 'loss_val': 0.040132631414740556, 'psi': 0.9942138670326294}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.905603 cos_to_last_merge=0.9976 (last merge round=32)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997800984321983, 'loss_val': 0.02269051200889717, 'psi': 0.997048596436947}-{'f1_val': 0.9965470045135896, 'auprc': 0.998318813531865, 'loss_val': 0.02268759195949688, 'psi': 0.9972557281208998}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.515687 cos_to_last_merge=0.9346 (last merge round=27)
[S13] ⚠️ Model drifted since last merge! cos=0.935
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.5539265335424555, 'auprc': 0.5328757470754995, 'loss_val': 1.1214474574081024, 'psi': 0.5455062189556731}-{'f1_val': 0.5998591142791831, 'auprc': 0.5582492513329439, 'loss_val': 0.8638773707509667, 'psi': 0.5832151691006875}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.232219 cos_to_last_merge=0.9956 (last merge round=32)
[S14] round=45 local utility u=0.107950 metrics={'f1_val': 0.9789700756454394, 'auprc': 0.9965478850248927, 'loss_val': 0.09009618044157598, 'psi': 0.9860011993972206}-{'f1_val': 0.9490480455956882, 'auprc': 0.9974198285607933, 'loss_val': 0.12907914068183413, 'psi': 0.9683967587817303}
[S14] not sending this round → trigger blocked (psi=0.986)
[S15] START round=45 head_norm_before_train=1.918793 cos_to_last_merge=0.9964 (last merge round=32)
[S15] round=45 local utility u=0.110512 metrics={'f1_val': 0.9969566159000176, 'auprc': 0.9991167063435291, 'loss_val': 0.028785439868411835, 'psi': 0.9978206520774222}-{'f1_val': 0.9653621075948502, 'auprc': 0.9979611155910579, 'loss_val': 0.05677594061091365, 'psi': 0.9784017107933334}
[S15] not sending this round → trigger blocked (psi=0.998)
[S16] START round=45 head_norm_before_train=1.745069 cos_to_last_merge=0.9971 (last merge round=34)
[S16] round=45 local utility u=0.004450 metrics={'f1_val': 0.991990432657946, 'auprc': 0.9979340588224688, 'loss_val': 0.03722416345765457, 'psi': 0.9943678831237551}-{'f1_val': 0.9908722666733435, 'auprc': 0.9979979847495893, 'loss_val': 0.03960664283793675, 'psi': 0.9937225539038419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=45 head_norm_before_train=1.510704 cos_to_last_merge=0.9792 (last merge round=33)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.5452259619493166, 'auprc': 0.7444827014926466, 'loss_val': 0.79506508612122, 'psi': 0.6249286577666486}-{'f1_val': 0.6744853505327639, 'auprc': 0.8579333390408372, 'loss_val': 0.6094235319123305, 'psi': 0.7478645459359932}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.820040 cos_to_last_merge=0.9815 (last merge round=30)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.8431229593222362, 'auprc': 0.9206491039107157, 'loss_val': 0.40098194766560324, 'psi': 0.874133417157628}-{'f1_val': 0.9894962843547117, 'auprc': 0.9800034794310197, 'loss_val': 0.0485812388247836, 'psi': 0.9856991623852349}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.309284 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.8123722762259257, 'auprc': 0.9948729923164222, 'loss_val': 0.5068004744797829, 'psi': 0.8853725626621243}-{'f1_val': 0.8313824677238596, 'auprc': 0.9724326659578866, 'loss_val': 0.4857205477069533, 'psi': 0.8878025470174704}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.985473 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9363468258405822, 'auprc': 0.9200246100517986, 'loss_val': 0.33037596103775724, 'psi': 0.9298179395250687}-{'f1_val': 0.938091134763487, 'auprc': 0.9283464361354454, 'loss_val': 0.29174400982193155, 'psi': 0.9341932553122704}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=2.082695 cos_to_last_merge=0.9673 (last merge round=32)
[S5] round=46 local utility u=1.000000 metrics={'f1_val': 0.9978756509554264, 'auprc': 0.9993485922567165, 'loss_val': 0.06888133816125153, 'psi': 0.9984648274759425}-{'f1_val': 0.714634679148647, 'auprc': 0.8111347061214763, 'loss_val': 0.6515454918520521, 'psi': 0.7532346899377786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=46 head_norm_before_train=1.619539 cos_to_last_merge=0.9639 (last merge round=34)
[S6] round=46 local utility u=1.000000 metrics={'f1_val': 0.8761664949696579, 'auprc': 0.9632172258196143, 'loss_val': 0.22223958293816842, 'psi': 0.9109867873096404}-{'f1_val': 0.5982698822712553, 'auprc': 0.7798737112979506, 'loss_val': 1.0439271921429911, 'psi': 0.6709114138819334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=46 head_norm_before_train=1.699833 cos_to_last_merge=0.9955 (last merge round=32)
[S7] round=46 local utility u=0.794447 metrics={'f1_val': 0.9004950750193775, 'auprc': 0.992941367252258, 'loss_val': 0.2298575207510478, 'psi': 0.9374735919125297}-{'f1_val': 0.6723530093490832, 'auprc': 0.9704456655399343, 'loss_val': 0.3824114858607948, 'psi': 0.7915900718254236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=46 head_norm_before_train=1.735423 cos_to_last_merge=0.9975 (last merge round=33)
[S8] round=46 local utility u=0.005292 metrics={'f1_val': 0.9945651807947898, 'auprc': 0.998217286227568, 'loss_val': 0.04008795132841507, 'psi': 0.996026022967901}-{'f1_val': 0.9924509553239076, 'auprc': 0.9986110295450616, 'loss_val': 0.039166912822940686, 'psi': 0.9949149850123692}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=46 head_norm_before_train=2.170522 cos_to_last_merge=0.9823 (last merge round=27)
[S9] round=46 local utility u=0.031672 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9970794769247133, 'loss_val': 0.021160141168037515, 'psi': 0.9968280978582202}-{'f1_val': 0.9891106000703147, 'auprc': 0.9976284613136106, 'loss_val': 0.04085092233473542, 'psi': 0.992517744567633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=46 head_norm_before_train=2.189708 cos_to_last_merge=0.9983 (last merge round=34)
[S10] round=46 local utility u=0.002127 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9962165571222563, 'loss_val': 0.03843654790641697, 'psi': 0.994127302017027}-{'f1_val': 0.9929532433629917, 'auprc': 0.9936219379714547, 'loss_val': 0.03621854317410326, 'psi': 0.9932207212063769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=46 head_norm_before_train=1.913915 cos_to_last_merge=0.9974 (last merge round=32)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9972262048832895, 'loss_val': 0.02245426886493692, 'psi': 0.9966735824346324}-{'f1_val': 0.9965470045135896, 'auprc': 0.997800984321983, 'loss_val': 0.02269051200889717, 'psi': 0.997048596436947}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.520994 cos_to_last_merge=0.9335 (last merge round=27)
[S13] ⚠️ Model drifted since last merge! cos=0.934
[S13] round=46 local utility u=0.109349 metrics={'f1_val': 0.5731041098559982, 'auprc': 0.537456709860072, 'loss_val': 1.0315572719668014, 'psi': 0.5588451498576277}-{'f1_val': 0.5539265335424555, 'auprc': 0.5328757470754995, 'loss_val': 1.1214474574081024, 'psi': 0.5455062189556731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=46 head_norm_before_train=2.242501 cos_to_last_merge=0.9952 (last merge round=32)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.8858619521874409, 'auprc': 0.9964653048414306, 'loss_val': 0.3964656020735955, 'psi': 0.9301032932490368}-{'f1_val': 0.9789700756454394, 'auprc': 0.9965478850248927, 'loss_val': 0.09009618044157598, 'psi': 0.9860011993972206}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.929100 cos_to_last_merge=0.9960 (last merge round=32)
[S15] round=46 local utility u=0.000902 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.999156398789746, 'loss_val': 0.028424687812855485, 'psi': 0.9979689627226704}-{'f1_val': 0.9969566159000176, 'auprc': 0.9991167063435291, 'loss_val': 0.028785439868411835, 'psi': 0.9978206520774222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=46 head_norm_before_train=1.756298 cos_to_last_merge=0.9967 (last merge round=34)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.8943800324607346, 'auprc': 0.9899515234485834, 'loss_val': 0.4810609763694745, 'psi': 0.9326086288558741}-{'f1_val': 0.991990432657946, 'auprc': 0.9979340588224688, 'loss_val': 0.03722416345765457, 'psi': 0.9943678831237551}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.533218 cos_to_last_merge=0.9765 (last merge round=33)
[S17] round=46 local utility u=0.426312 metrics={'f1_val': 0.6561685297848546, 'auprc': 0.774865337180895, 'loss_val': 0.6992446793548913, 'psi': 0.7036472527432708}-{'f1_val': 0.5452259619493166, 'auprc': 0.7444827014926466, 'loss_val': 0.79506508612122, 'psi': 0.6249286577666486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=47 head_norm_before_train=1.832055 cos_to_last_merge=0.9808 (last merge round=30)
[S2] round=47 local utility u=0.683294 metrics={'f1_val': 0.9843143951455947, 'auprc': 0.9782550838073495, 'loss_val': 0.05436145411354857, 'psi': 0.9818906706102966}-{'f1_val': 0.8431229593222362, 'auprc': 0.9206491039107157, 'loss_val': 0.40098194766560324, 'psi': 0.874133417157628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=47 head_norm_before_train=2.317475 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.7582034241758497, 'auprc': 0.9735456224475832, 'loss_val': 0.7916675479522117, 'psi': 0.8443403034845431}-{'f1_val': 0.8123722762259257, 'auprc': 0.9948729923164222, 'loss_val': 0.5068004744797829, 'psi': 0.8853725626621243}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.988531 (no previous merge yet)
[S4] round=47 local utility u=0.092103 metrics={'f1_val': 0.940752715384904, 'auprc': 0.9586634836185555, 'loss_val': 0.2885217958814779, 'psi': 0.9479170226783646}-{'f1_val': 0.9363468258405822, 'auprc': 0.9200246100517986, 'loss_val': 0.33037596103775724, 'psi': 0.9298179395250687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=47 head_norm_before_train=2.086592 cos_to_last_merge=0.9669 (last merge round=32)
[S5] round=47 local utility u=0.007366 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9962455889026101, 'loss_val': 0.03779741945606933, 'psi': 0.9965194166481186}-{'f1_val': 0.9978756509554264, 'auprc': 0.9993485922567165, 'loss_val': 0.06888133816125153, 'psi': 0.9984648274759425}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=47 head_norm_before_train=1.625755 cos_to_last_merge=0.9626 (last merge round=34)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.8828475573987306, 'auprc': 0.964459977471896, 'loss_val': 0.3390655688444349, 'psi': 0.9154925254279966}-{'f1_val': 0.8761664949696579, 'auprc': 0.9632172258196143, 'loss_val': 0.22223958293816842, 'psi': 0.9109867873096404}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.705752 cos_to_last_merge=0.9951 (last merge round=32)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5769358987169451, 'auprc': 0.7976680517100782, 'loss_val': 0.7183277330593337, 'psi': 0.6652287599141983}-{'f1_val': 0.9004950750193775, 'auprc': 0.992941367252258, 'loss_val': 0.2298575207510478, 'psi': 0.9374735919125297}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.741542 cos_to_last_merge=0.9972 (last merge round=33)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.992087149933871, 'auprc': 0.9987245491082422, 'loss_val': 0.037930327963826685, 'psi': 0.9947421096036195}-{'f1_val': 0.9945651807947898, 'auprc': 0.998217286227568, 'loss_val': 0.04008795132841507, 'psi': 0.996026022967901}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=2.177885 cos_to_last_merge=0.9819 (last merge round=27)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9912237657809659, 'auprc': 0.9996986380286184, 'loss_val': 0.030585981192105864, 'psi': 0.9946137146800269}-{'f1_val': 0.9966605118138915, 'auprc': 0.9970794769247133, 'loss_val': 0.021160141168037515, 'psi': 0.9968280978582202}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.198869 cos_to_last_merge=0.9980 (last merge round=34)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9922971251862674, 'auprc': 0.9969778195808139, 'loss_val': 0.03950726005306662, 'psi': 0.994169402944086}-{'f1_val': 0.9927344652802075, 'auprc': 0.9962165571222563, 'loss_val': 0.03843654790641697, 'psi': 0.994127302017027}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.918851 cos_to_last_merge=0.9971 (last merge round=32)
[S11] round=47 local utility u=0.001145 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9972793755169646, 'loss_val': 0.02282804918349934, 'psi': 0.996945201955695}-{'f1_val': 0.996305167468861, 'auprc': 0.9972262048832895, 'loss_val': 0.02245426886493692, 'psi': 0.9966735824346324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=47 head_norm_before_train=1.530043 cos_to_last_merge=0.9324 (last merge round=27)
[S13] ⚠️ Model drifted since last merge! cos=0.932
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.5724049482856194, 'auprc': 0.5419627966901656, 'loss_val': 1.0489423086550906, 'psi': 0.5602280876474378}-{'f1_val': 0.5731041098559982, 'auprc': 0.537456709860072, 'loss_val': 1.0315572719668014, 'psi': 0.5588451498576277}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.252012 cos_to_last_merge=0.9948 (last merge round=32)
[S14] round=47 local utility u=0.514438 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9964584957736993, 'loss_val': 0.03033003806908903, 'psi': 0.9963767467043861}-{'f1_val': 0.8858619521874409, 'auprc': 0.9964653048414306, 'loss_val': 0.3964656020735955, 'psi': 0.9301032932490368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=47 head_norm_before_train=1.939648 cos_to_last_merge=0.9955 (last merge round=32)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9982381849651616, 'loss_val': 0.029545547773487977, 'psi': 0.9976016771928367}-{'f1_val': 0.9971773386779533, 'auprc': 0.999156398789746, 'loss_val': 0.028424687812855485, 'psi': 0.9979689627226704}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.767347 cos_to_last_merge=0.9964 (last merge round=34)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8652173253014083, 'auprc': 0.9942660288502705, 'loss_val': 0.7089992794528741, 'psi': 0.9168368067209531}-{'f1_val': 0.8943800324607346, 'auprc': 0.9899515234485834, 'loss_val': 0.4810609763694745, 'psi': 0.9326086288558741}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.552821 cos_to_last_merge=0.9741 (last merge round=33)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5565937762112165, 'auprc': 0.8137338117022086, 'loss_val': 0.8251301562582859, 'psi': 0.6594497904076133}-{'f1_val': 0.6561685297848546, 'auprc': 0.774865337180895, 'loss_val': 0.6992446793548913, 'psi': 0.7036472527432708}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.843696 cos_to_last_merge=0.9801 (last merge round=30)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.850800506610998, 'auprc': 0.933447036736278, 'loss_val': 0.38830939389617963, 'psi': 0.88385911866111}-{'f1_val': 0.9843143951455947, 'auprc': 0.9782550838073495, 'loss_val': 0.05436145411354857, 'psi': 0.9818906706102966}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.325889 (no previous merge yet)
[S3] round=48 local utility u=0.505658 metrics={'f1_val': 0.8518742580162488, 'auprc': 0.9889206532170672, 'loss_val': 0.3885010080580025, 'psi': 0.9066928160965761}-{'f1_val': 0.7582034241758497, 'auprc': 0.9735456224475832, 'loss_val': 0.7916675479522117, 'psi': 0.8443403034845431}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=48 head_norm_before_train=1.987032 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.94034340160104, 'auprc': 0.9411967175479257, 'loss_val': 0.29687989156651434, 'psi': 0.9406847279797943}-{'f1_val': 0.940752715384904, 'auprc': 0.9586634836185555, 'loss_val': 0.2885217958814779, 'psi': 0.9479170226783646}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=2.092014 cos_to_last_merge=0.9663 (last merge round=32)
[S5] round=48 local utility u=0.000141 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9962409291370792, 'loss_val': 0.03970790446755099, 'psi': 0.9967381068214702}-{'f1_val': 0.9967019684784577, 'auprc': 0.9962455889026101, 'loss_val': 0.03779741945606933, 'psi': 0.9965194166481186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=48 head_norm_before_train=1.634841 cos_to_last_merge=0.9613 (last merge round=34)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6070084587028681, 'auprc': 0.9376197192838958, 'loss_val': 0.8111920327444893, 'psi': 0.7392529629352792}-{'f1_val': 0.8828475573987306, 'auprc': 0.964459977471896, 'loss_val': 0.3390655688444349, 'psi': 0.9154925254279966}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.714853 cos_to_last_merge=0.9944 (last merge round=32)
[S7] round=48 local utility u=0.296871 metrics={'f1_val': 0.6011040314442875, 'auprc': 0.885818149386892, 'loss_val': 0.5340448491700944, 'psi': 0.7149896786213292}-{'f1_val': 0.5769358987169451, 'auprc': 0.7976680517100782, 'loss_val': 0.7183277330593337, 'psi': 0.6652287599141983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=48 head_norm_before_train=1.750164 cos_to_last_merge=0.9969 (last merge round=33)
[S8] round=48 local utility u=0.003011 metrics={'f1_val': 0.9927378939946618, 'auprc': 0.9987846660863491, 'loss_val': 0.035992534883236504, 'psi': 0.9951566028313368}-{'f1_val': 0.992087149933871, 'auprc': 0.9987245491082422, 'loss_val': 0.037930327963826685, 'psi': 0.9947421096036195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=48 head_norm_before_train=2.185478 cos_to_last_merge=0.9815 (last merge round=27)
[S9] round=48 local utility u=0.016654 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9996110943623914, 'loss_val': 0.022168403629554388, 'psi': 0.9970939372669281}-{'f1_val': 0.9912237657809659, 'auprc': 0.9996986380286184, 'loss_val': 0.030585981192105864, 'psi': 0.9946137146800269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=48 head_norm_before_train=2.206293 cos_to_last_merge=0.9978 (last merge round=34)
[S10] round=48 local utility u=0.000049 metrics={'f1_val': 0.9936755435702088, 'auprc': 0.9925710995281208, 'loss_val': 0.0344604891065617, 'psi': 0.9932337659533736}-{'f1_val': 0.9922971251862674, 'auprc': 0.9969778195808139, 'loss_val': 0.03950726005306662, 'psi': 0.994169402944086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=48 head_norm_before_train=1.925478 cos_to_last_merge=0.9969 (last merge round=32)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9933634906436086, 'auprc': 0.9990471573489194, 'loss_val': 0.027991106943620597, 'psi': 0.9956369573257329}-{'f1_val': 0.9967224195815153, 'auprc': 0.9972793755169646, 'loss_val': 0.02282804918349934, 'psi': 0.996945201955695}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.537040 cos_to_last_merge=0.9316 (last merge round=27)
[S13] ⚠️ Model drifted since last merge! cos=0.932
[S13] round=48 local utility u=0.274519 metrics={'f1_val': 0.5873418080783667, 'auprc': 0.6135941085677232, 'loss_val': 0.8044192693725796, 'psi': 0.5978427282741092}-{'f1_val': 0.5724049482856194, 'auprc': 0.5419627966901656, 'loss_val': 1.0489423086550906, 'psi': 0.5602280876474378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=48 head_norm_before_train=2.259757 cos_to_last_merge=0.9944 (last merge round=32)
[S14] round=48 local utility u=0.005137 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9986536867357416, 'loss_val': 0.0281003075146497, 'psi': 0.9974006086400726}-{'f1_val': 0.9963222473248441, 'auprc': 0.9964584957736993, 'loss_val': 0.03033003806908903, 'psi': 0.9963767467043861}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=48 head_norm_before_train=1.949751 cos_to_last_merge=0.9951 (last merge round=32)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.9146505456320236, 'auprc': 0.997619821548425, 'loss_val': 0.09200947468871398, 'psi': 0.9478382559985842}-{'f1_val': 0.9971773386779533, 'auprc': 0.9982381849651616, 'loss_val': 0.029545547773487977, 'psi': 0.9976016771928367}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.775403 cos_to_last_merge=0.9958 (last merge round=34)
[S16] round=48 local utility u=0.442082 metrics={'f1_val': 0.9402590321180855, 'auprc': 0.9946679874907942, 'loss_val': 0.2762909182303758, 'psi': 0.962022614267169}-{'f1_val': 0.8652173253014083, 'auprc': 0.9942660288502705, 'loss_val': 0.7089992794528741, 'psi': 0.9168368067209531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=48 head_norm_before_train=1.569261 cos_to_last_merge=0.9720 (last merge round=33)
[S17] round=48 local utility u=0.543126 metrics={'f1_val': 0.6106594422747633, 'auprc': 0.9953620825634433, 'loss_val': 0.6081562234433205, 'psi': 0.7645404983902353}-{'f1_val': 0.5565937762112165, 'auprc': 0.8137338117022086, 'loss_val': 0.8251301562582859, 'psi': 0.6594497904076133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=49 head_norm_before_train=1.852541 cos_to_last_merge=0.9796 (last merge round=30)
[S2] round=49 local utility u=0.637332 metrics={'f1_val': 0.9852080054175114, 'auprc': 0.9777744822179717, 'loss_val': 0.053071852947276746, 'psi': 0.9822345961376956}-{'f1_val': 0.850800506610998, 'auprc': 0.933447036736278, 'loss_val': 0.38830939389617963, 'psi': 0.88385911866111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=49 head_norm_before_train=2.334408 (no previous merge yet)
[S3] round=49 local utility u=0.520193 metrics={'f1_val': 0.9681177385911071, 'auprc': 0.9990728912951263, 'loss_val': 0.0760325008708094, 'psi': 0.9804997996727147}-{'f1_val': 0.8518742580162488, 'auprc': 0.9889206532170672, 'loss_val': 0.3885010080580025, 'psi': 0.9066928160965761}
[S3] not sending this round → trigger blocked (psi=0.980)
[S4] START round=49 head_norm_before_train=1.992389 (no previous merge yet)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9395850876912551, 'auprc': 0.9305788042849727, 'loss_val': 0.30598143518632254, 'psi': 0.9359825743287422}-{'f1_val': 0.94034340160104, 'auprc': 0.9411967175479257, 'loss_val': 0.29687989156651434, 'psi': 0.9406847279797943}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=2.096979 cos_to_last_merge=0.9659 (last merge round=32)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9928282081739694, 'loss_val': 0.05559840611880411, 'psi': 0.995593233981183}-{'f1_val': 0.9970695586110643, 'auprc': 0.9962409291370792, 'loss_val': 0.03970790446755099, 'psi': 0.9967381068214702}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.646531 cos_to_last_merge=0.9597 (last merge round=34)
[S6] round=49 local utility u=0.456680 metrics={'f1_val': 0.7121318430203839, 'auprc': 0.9431757942399435, 'loss_val': 0.5452409273143849, 'psi': 0.8045494235082078}-{'f1_val': 0.6070084587028681, 'auprc': 0.9376197192838958, 'loss_val': 0.8111920327444893, 'psi': 0.7392529629352792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=49 head_norm_before_train=1.721524 cos_to_last_merge=0.9939 (last merge round=32)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5662546256398231, 'auprc': 0.7920291473861506, 'loss_val': 0.7014494191517621, 'psi': 0.6565644343383541}-{'f1_val': 0.6011040314442875, 'auprc': 0.885818149386892, 'loss_val': 0.5340448491700944, 'psi': 0.7149896786213292}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.759272 cos_to_last_merge=0.9967 (last merge round=33)
[S8] round=49 local utility u=0.006619 metrics={'f1_val': 0.994753542178155, 'auprc': 0.9983530692997457, 'loss_val': 0.03355447178335644, 'psi': 0.9961933530267912}-{'f1_val': 0.9927378939946618, 'auprc': 0.9987846660863491, 'loss_val': 0.035992534883236504, 'psi': 0.9951566028313368}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=49 head_norm_before_train=2.192892 cos_to_last_merge=0.9810 (last merge round=27)
[S9] round=49 local utility u=0.004585 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9996400693133125, 'loss_val': 0.0205539386153986, 'psi': 0.9978523348136599}-{'f1_val': 0.9954158325366191, 'auprc': 0.9996110943623914, 'loss_val': 0.022168403629554388, 'psi': 0.9970939372669281}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=49 head_norm_before_train=2.209857 cos_to_last_merge=0.9976 (last merge round=34)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9932136491405474, 'auprc': 0.9930318199064053, 'loss_val': 0.03406003842541649, 'psi': 0.9931409174468906}-{'f1_val': 0.9936755435702088, 'auprc': 0.9925710995281208, 'loss_val': 0.0344604891065617, 'psi': 0.9932337659533736}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.932087 cos_to_last_merge=0.9966 (last merge round=32)
[S11] round=49 local utility u=0.012467 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9983847256863566, 'loss_val': 0.02122437799229993, 'psi': 0.9973873420234518}-{'f1_val': 0.9933634906436086, 'auprc': 0.9990471573489194, 'loss_val': 0.027991106943620597, 'psi': 0.9956369573257329}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=49 head_norm_before_train=1.542757 cos_to_last_merge=0.9314 (last merge round=27)
[S13] ⚠️ Model drifted since last merge! cos=0.931
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5568682131867735, 'auprc': 0.5561573249643721, 'loss_val': 1.0696304465631363, 'psi': 0.556583857897813}-{'f1_val': 0.5873418080783667, 'auprc': 0.6135941085677232, 'loss_val': 0.8044192693725796, 'psi': 0.5978427282741092}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.266468 cos_to_last_merge=0.9940 (last merge round=32)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.8893833020844961, 'auprc': 0.9981845447867441, 'loss_val': 0.28723396178876676, 'psi': 0.9329037991653952}-{'f1_val': 0.9965652232429598, 'auprc': 0.9986536867357416, 'loss_val': 0.0281003075146497, 'psi': 0.9974006086400726}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.959546 cos_to_last_merge=0.9947 (last merge round=32)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.8650578041359112, 'auprc': 0.9976164899675537, 'loss_val': 0.2713229327015217, 'psi': 0.9180812784685682}-{'f1_val': 0.9146505456320236, 'auprc': 0.997619821548425, 'loss_val': 0.09200947468871398, 'psi': 0.9478382559985842}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.781261 cos_to_last_merge=0.9955 (last merge round=34)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9173639246753953, 'auprc': 0.9848430845275377, 'loss_val': 0.43443756621311924, 'psi': 0.9443555886162522}-{'f1_val': 0.9402590321180855, 'auprc': 0.9946679874907942, 'loss_val': 0.2762909182303758, 'psi': 0.962022614267169}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.583880 cos_to_last_merge=0.9703 (last merge round=33)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.5378527393400594, 'auprc': 0.7383383389809919, 'loss_val': 0.9025407157643449, 'psi': 0.6180469791964325}-{'f1_val': 0.6106594422747633, 'auprc': 0.9953620825634433, 'loss_val': 0.6081562234433205, 'psi': 0.7645404983902353}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
