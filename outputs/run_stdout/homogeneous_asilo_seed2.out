[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:33903
[S3] → join 127.0.0.1:33902
[S4] → join 127.0.0.1:33902
[S5] → join 127.0.0.1:33902
[S6] → join 127.0.0.1:33902
[S7] → join 127.0.0.1:33902
[S8] → join 127.0.0.1:33902
[S9] → join 127.0.0.1:33902
[S10] → join 127.0.0.1:33902
[S11] → join 127.0.0.1:33902
[S13] → join 127.0.0.1:33902
[S14] → join 127.0.0.1:33902
[S15] → join 127.0.0.1:33902
[S16] → join 127.0.0.1:33902
[S17] → join 127.0.0.1:33902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.231619 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.167231 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.145088 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.168396 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.171634 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.205723 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.140563 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.138802 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.161467 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.178742 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.265180 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.104373 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.163303 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.179142 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.143936 (no previous merge yet)
[S5]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S3] + discovered S15
[S3] + discovered S9
[S3] + discovered S4
[S3] + discovered S11
[S3] + discovered S8
[S3] + discovered S14
[S3] + discovered S6
[S3] + discovered S13
[S3] + discovered S10
[S4] + discovered S3
[S3] + discovered S7
[S3] + discovered S5
[S4] + discovered S2
[S3] + discovered S16
[S3] + discovered S17
[S4] + discovered S13
[S4] + discovered S16
[S4] + discovered S11
[S5] + discovered S3
[S4] + discovered S17
[S4] + discovered S7
[S4] + discovered S14
[S4] + discovered S6
[S4] + discovered S5
[S4] + discovered S10
[S4] + discovered S9
[S4] + discovered S15
[S5] + discovered S2
[S5] + discovered S4
[S4] + discovered S8
[S5] + discovered S14
[S5] + discovered S9
[S5] + discovered S13
[S5] + discovered S15
[S5] + discovered S8
[S5] + discovered S10
[S6] + discovered S4
[S5] + discovered S11
[S5] + discovered S17
[S6] + discovered S3
[S5] + discovered S6
[S5] + discovered S7
[S6] + discovered S2
[S6] + discovered S5
[S5] + discovered S16
[S6] + discovered S10
[S6] + discovered S14
[S6] + discovered S9
[S7] + discovered S3
[S7] + discovered S5
[S6] + discovered S8
[S7] + discovered S6
[S6] + discovered S17
[S6] + discovered S16
[S6] + discovered S15
[S6] + discovered S7
[S7] + discovered S2
[S7] + discovered S4
[S6] + discovered S11
[S6] + discovered S13
[S7] + discovered S9
[S7] + discovered S17
[S7] + discovered S10
[S8] + discovered S5
[S7] + discovered S15
[S8] + discovered S4
[S8] + discovered S3
[S7] + discovered S14
[S7] + discovered S16
[S8] + discovered S2
[S8] + discovered S7
[S7] + discovered S11
[S7] + discovered S13
[S8] + discovered S6
[S7] + discovered S8
[S8] + discovered S14
[S8] + discovered S10
[S8] + discovered S15
[S9] + discovered S3
[S8] + discovered S13
[S8] + discovered S9
[S9] + discovered S8
[S8] + discovered S17
[S8] + discovered S16
[S8] + discovered S11
[S9] + discovered S6
[S9] + discovered S4
[S9] + discovered S7
[S9] + discovered S2
[S9] + discovered S5
[S9] + discovered S16
[S9] + discovered S14
[S9] + discovered S10
[S10] + discovered S2
[S10] + discovered S9
[S10] + discovered S4
[S10] + discovered S8
[S10] + discovered S7
[S9] + discovered S13
[S9] + discovered S11
[S10] + discovered S6
[S10] + discovered S5
[S10] + discovered S3
[S9] + discovered S17
[S9] + discovered S15
[S11] + discovered S8
[S11] + discovered S10
[S11] + discovered S9
[S11] + discovered S2
[S11] + discovered S6
[S10] + discovered S15
[S10] + discovered S16
[S11] + discovered S4
[S10] + discovered S14
[S10] + discovered S11
[S11] + discovered S5
[S11] + discovered S3
[S11] + discovered S7
[S10] + discovered S13
[S10] + discovered S17
[S13] + discovered S3
[S11] + discovered S17
[S11] + discovered S16
[S11] + discovered S14
[S13] + discovered S4
[S13] + discovered S5
[S13] + discovered S9
[S13] + discovered S10
[S13] + discovered S8
[S13] + discovered S2
[S11] + discovered S13
[S13] + discovered S11
[S11] + discovered S15
[S13] + discovered S6
[S13] + discovered S7
[S14] + discovered S8
[S14] + discovered S7
[S13] + discovered S16
[S14] + discovered S11
[S14] + discovered S9
[S14] + discovered S3
[S14] + discovered S4
[S14] + discovered S10
[S14] + discovered S6
[S14] + discovered S2
[S13] + discovered S14
[S13] + discovered S15
[S14] + discovered S5
[S14] + discovered S13
[S13] + discovered S17
[S15] + discovered S7
[S15] + discovered S9
[S15] + discovered S4
[S15] + discovered S14
[S15] + discovered S3
[S15] + discovered S13
[S14] + discovered S17
[S15] + discovered S2
[S15] + discovered S11
[S15] + discovered S10
[S15] + discovered S6
[S14] + discovered S15
[S15] + discovered S8
[S14] + discovered S16
[S15] + discovered S5
[S16] + discovered S10
[S16] + discovered S13
[S16] + discovered S11
[S16] + discovered S15
[S15] + discovered S16
[S16] + discovered S4
[S16] + discovered S8
[S16] + discovered S14
[S16] + discovered S5
[S16] + discovered S9
[S16] + discovered S7
[S16] + discovered S2
[S16] + discovered S6
[S16] + discovered S3
[S15] + discovered S17
[S17] + discovered S7
[S17] + discovered S3
[S17] + discovered S13
[S17] + discovered S10
[S16] + discovered S17
[S17] + discovered S4
[S17] + discovered S8
[S17] + discovered S9
[S17] + discovered S15
[S17] + discovered S14
[S17] + discovered S2
[S17] + discovered S6
[S17] + discovered S11
[S17] + discovered S5
[S17] + discovered S16
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=1.000 → S10@127.0.0.1:33911
[S13] ⇄ pheromone p=1.000 → S6@127.0.0.1:33907
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:33909
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:33903
[S6] ⇄ pheromone p=1.000 → S5@127.0.0.1:33905
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:33908
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:33904
[S10] ⇄ pheromone p=1.000 → S6@127.0.0.1:33907
[S11] ⇄ pheromone p=1.000 → S4@127.0.0.1:33904
[S8] ⇄ pheromone p=1.000 → S2@127.0.0.1:33902
[S15] ⇄ pheromone p=1.000 → S8@127.0.0.1:33909
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:33907
[S7] ⇄ pheromone p=1.000 → S2@127.0.0.1:33902
[S2] ⇄ pheromone p=1.000 → S3@127.0.0.1:33903
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:33909
[S2] START round=1 head_norm_before_train=1.234507 (no previous merge yet)
[S2] round=1 local utility u=0.009175 metrics={'f1_val': 0.10594122494314769, 'auprc': 0.6047065488799792, 'loss_val': 1.331866674051722, 'psi': 0.3054473545178803}-{'f1_val': 0.10477605118829982, 'auprc': 0.6133032486806047, 'loss_val': 1.3690157621057224, 'psi': 0.3081869301852218}
[S3] START round=1 head_norm_before_train=1.174863 (no previous merge yet)
[S3] round=1 local utility u=0.004833 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.69510569653214, 'loss_val': 1.322510000794268, 'psi': 0.36194631798132026}-{'f1_val': 0.13984006561410703, 'auprc': 0.703321794762802, 'loss_val': 1.356824441123316, 'psi': 0.36523275727358506}
[S4] START round=1 head_norm_before_train=1.145579 (no previous merge yet)
[S4] round=1 local utility u=0.171082 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7597872426847452, 'loss_val': 1.3266570042918424, 'psi': 0.38805087441100855}-{'f1_val': 0.1985898089884988, 'auprc': 0.5414113967026121, 'loss_val': 1.3638723738880205, 'psi': 0.3357184440741441}
[S5] START round=1 head_norm_before_train=1.171424 (no previous merge yet)
[S5] round=1 local utility u=0.014423 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7775386735991957, 'loss_val': 1.3028471529155674, 'psi': 0.39637261229682114}-{'f1_val': 0.14226190476190476, 'auprc': 0.7765594941536946, 'loss_val': 1.3287547291179698, 'psi': 0.3959809405186207}
[S6] START round=1 head_norm_before_train=1.172787 (no previous merge yet)
[S6] round=1 local utility u=1.000000 metrics={'f1_val': 0.3892390441599931, 'auprc': 0.8003758474357762, 'loss_val': 1.3392395352867221, 'psi': 0.5536937654703064}-{'f1_val': 0.08954368264159597, 'auprc': 0.7109145223338834, 'loss_val': 1.3722145339701168, 'psi': 0.338092018518511}
[S7] START round=1 head_norm_before_train=1.205598 (no previous merge yet)
[S7] round=1 local utility u=0.026834 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5586490807231167, 'loss_val': 1.3322294738184182, 'psi': 0.3086937259267017}-{'f1_val': 0.14205682272909165, 'auprc': 0.5516701928311807, 'loss_val': 1.364961628306782, 'psi': 0.30590217076992726}
[S8] START round=1 head_norm_before_train=1.153821 (no previous merge yet)
[S8] round=1 local utility u=0.166211 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6665981042303573, 'loss_val': 1.2921585691705018, 'psi': 0.35061283112791725}-{'f1_val': 0.13995598239295717, 'auprc': 0.566812667047639, 'loss_val': 1.3252234563376892, 'psi': 0.3106986562548299}
[S9] START round=1 head_norm_before_train=1.136103 (no previous merge yet)
[S9] round=1 local utility u=0.095150 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6611808597693154, 'loss_val': 1.3220781462719002, 'psi': 0.3493111181917238}-{'f1_val': 0.141397957139996, 'auprc': 0.6089778465837934, 'loss_val': 1.3557699479907486, 'psi': 0.32842991291751494}
[S10] START round=1 head_norm_before_train=1.166424 (no previous merge yet)
[S10] round=1 local utility u=0.259118 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7749867737778607, 'loss_val': 1.3193945755207008, 'psi': 0.3931676920361787}-{'f1_val': 0.13862163754172394, 'auprc': 0.6101166572420046, 'loss_val': 1.3430210982067108, 'psi': 0.32721964542183624}
[S11] START round=1 head_norm_before_train=1.183022 (no previous merge yet)
[S11] round=1 local utility u=0.348637 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7265865140292221, 'loss_val': 1.3205638090104652, 'psi': 0.3748828156355552}-{'f1_val': 0.14041368337311058, 'auprc': 0.5029973140055639, 'loss_val': 1.347069339888607, 'psi': 0.2854471356260919}
[S13] START round=1 head_norm_before_train=1.265408 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5585591693327407, 'loss_val': 1.3111560585579547, 'psi': 0.30765512527932815}-{'f1_val': 0.6444772143159094, 'auprc': 0.5330121338056116, 'loss_val': 1.3419679230526167, 'psi': 0.5998911821117903}
[S14] START round=1 head_norm_before_train=1.110813 (no previous merge yet)
[S14] round=1 local utility u=1.000000 metrics={'f1_val': 0.3913064433680914, 'auprc': 0.8129557235912652, 'loss_val': 1.3345492909152061, 'psi': 0.559966155457361}-{'f1_val': 0.13450851134846462, 'auprc': 0.618592994612936, 'loss_val': 1.3575882135517763, 'psi': 0.3281423046542532}
[S15] START round=1 head_norm_before_train=1.177489 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7703883481585312, 'loss_val': 1.3099018454348899, 'psi': 0.3919955300803475}-{'f1_val': 0.38594537247460436, 'auprc': 0.7703893300397484, 'loss_val': 1.342659117193649, 'psi': 0.539722955500662}
[S16] START round=1 head_norm_before_train=1.188620 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8495206647432116, 'loss_val': 1.3115498991912686, 'psi': 0.42419073601680657}-{'f1_val': 0.14063745019920318, 'auprc': 0.8978455421486828, 'loss_val': 1.3481510936498402, 'psi': 0.44352068697899505}
[S17] START round=1 head_norm_before_train=1.136122 (no previous merge yet)
[S17] round=1 local utility u=0.392182 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.4909851445919054, 'loss_val': 1.3646619701740927, 'psi': 0.2809634358271928}-{'f1_val': 0.15297605974083023, 'auprc': 0.2123932354040815, 'loss_val': 1.3854133298953837, 'psi': 0.17674293000613073}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S10] → sending delta(kind=head bytes=1785) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S2] → sending delta(kind=head bytes=1785) to S3@127.0.0.1:33903
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S8] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S14] → sending delta(kind=head bytes=1784) to S9@127.0.0.1:33910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:33917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:33908
[S5] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1785 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1785 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1784 to 1 peers)
[S8] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1789) from S8
[S15] cosine check vs S8: cos=0.1048
[S15] RECEIVED delta(kind=head bytes=1790) from S5
[S15] cosine check vs S5: cos=0.0039
[S17] RECEIVED delta(kind=head bytes=1792) from S6
[S17] cosine check vs S6: cos=0.0447
[S9] RECEIVED delta(kind=head bytes=1784) from S14
[S9] cosine check vs S14: cos=-0.0187
[S9] DROPPED delta from S14 (cos=-0.0187 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1793) from S9
[S3] cosine check vs S9: cos=-0.0034
[S3] DROPPED delta from S9 (cos=-0.0034 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S11
[S10] cosine check vs S11: cos=-0.0201
[S10] DROPPED delta from S11 (cos=-0.0201 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1785) from S2
[S3] cosine check vs S2: cos=0.0934
[S5] RECEIVED delta(kind=head bytes=1790) from S4
[S5] cosine check vs S4: cos=-0.0007
[S5] DROPPED delta from S4 (cos=-0.0007 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1791) from S7
[S15] cosine check vs S7: cos=-0.1031
[S15] DROPPED delta from S7 (cos=-0.1031 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1790) from S3
[S7] cosine check vs S3: cos=-0.0033
[S7] DROPPED delta from S3 (cos=-0.0033 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1785) from S10
[S8] cosine check vs S10: cos=0.0379
[S17] sending update (kind=head size=1790 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1790) from S17
[S7] cosine check vs S17: cos=0.0660
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.197990
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.029018e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.755503 delta_norm=0.702902
[S15] aggregate: ACCEPT kept=['S8', 'S5'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.213447
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.037938e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.858639 delta_norm=0.803794
[S7] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.1398 head_norm=1.189236
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.201286e-01
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.1398 head_norm=0.900598 delta_norm=0.820129
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.177746
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.176597e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.849294 delta_norm=0.817660
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.137646
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.024719e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1089 head_norm=0.839178 delta_norm=0.802472
[S17] aggregate: ROLLBACK (f1_val pre=0.141 post=0.109 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=1.246231 (no previous merge yet)
[S2] round=2 local utility u=0.142073 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6141501481252137, 'loss_val': 1.2910661530527527, 'psi': 0.33072633928322553}-{'f1_val': 0.10594122494314769, 'auprc': 0.6047065488799792, 'loss_val': 1.331866674051722, 'psi': 0.3054473545178803}
[S3] START round=2 head_norm_before_train=0.900598 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.344395 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9230347565421047, 'loss_val': 1.3175077561306008, 'psi': 0.4531179419853061}-{'f1_val': 0.13984006561410703, 'auprc': 0.69510569653214, 'loss_val': 1.322510000794268, 'psi': 0.36194631798132026}
[S4] START round=2 head_norm_before_train=1.156720 (no previous merge yet)
[S4] round=2 local utility u=0.070588 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7917778868855678, 'loss_val': 1.2814522492772504, 'psi': 0.40084713209133765}-{'f1_val': 0.14022662889518414, 'auprc': 0.7597872426847452, 'loss_val': 1.3266570042918424, 'psi': 0.38805087441100855}
[S5] START round=2 head_norm_before_train=1.179493 (no previous merge yet)
[S5] round=2 local utility u=0.015339 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7775383949155784, 'loss_val': 1.2721692742013428, 'psi': 0.3963725008233742}-{'f1_val': 0.14226190476190476, 'auprc': 0.7775386735991957, 'loss_val': 1.3028471529155674, 'psi': 0.39637261229682114}
[S6] START round=2 head_norm_before_train=1.184113 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8291999244412469, 'loss_val': 1.2995735500812577, 'psi': 0.416535739007268}-{'f1_val': 0.3892390441599931, 'auprc': 0.8003758474357762, 'loss_val': 1.3392395352867221, 'psi': 0.5536937654703064}
[S7] START round=2 head_norm_before_train=0.858639 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.187873 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.681472404324862, 'loss_val': 1.3249535812651176, 'psi': 0.3578230553673998}-{'f1_val': 0.14205682272909165, 'auprc': 0.5586490807231167, 'loss_val': 1.3322294738184182, 'psi': 0.3086937259267017}
[S8] START round=2 head_norm_before_train=0.849294 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.150868 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7708722095753432, 'loss_val': 1.303244220400135, 'psi': 0.39232247326591163}-{'f1_val': 0.13995598239295717, 'auprc': 0.6665981042303573, 'loss_val': 1.2921585691705018, 'psi': 0.35061283112791725}
[S9] START round=2 head_norm_before_train=1.147280 (no previous merge yet)
[S9] round=2 local utility u=0.047242 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6792511854921418, 'loss_val': 1.2818046021073153, 'psi': 0.35653924848085433}-{'f1_val': 0.141397957139996, 'auprc': 0.6611808597693154, 'loss_val': 1.3220781462719002, 'psi': 0.3493111181917238}
[S10] START round=2 head_norm_before_train=1.180105 (no previous merge yet)
[S10] round=2 local utility u=0.015403 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7756573316386277, 'loss_val': 1.2905997848678235, 'psi': 0.3934359151804855}-{'f1_val': 0.13862163754172394, 'auprc': 0.7749867737778607, 'loss_val': 1.3193945755207008, 'psi': 0.3931676920361787}
[S11] START round=2 head_norm_before_train=1.197078 (no previous merge yet)
[S11] round=2 local utility u=0.096235 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7815729555563933, 'loss_val': 1.2930527229203699, 'psi': 0.39687739224642365}-{'f1_val': 0.14041368337311058, 'auprc': 0.7265865140292221, 'loss_val': 1.3205638090104652, 'psi': 0.3748828156355552}
[S13] START round=2 head_norm_before_train=1.274082 (no previous merge yet)
[S13] round=2 local utility u=0.020492 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5598118736674881, 'loss_val': 1.2739310050545778, 'psi': 0.3081562070132271}-{'f1_val': 0.1403857625770531, 'auprc': 0.5585591693327407, 'loss_val': 1.3111560585579547, 'psi': 0.30765512527932815}
[S14] START round=2 head_norm_before_train=1.127053 (no previous merge yet)
[S14] round=2 local utility u=0.105058 metrics={'f1_val': 0.39149020627729036, 'auprc': 0.8738212521005189, 'loss_val': 1.3081316100375557, 'psi': 0.5844226246065818}-{'f1_val': 0.3913064433680914, 'auprc': 0.8129557235912652, 'loss_val': 1.3345492909152061, 'psi': 0.559966155457361}
[S15] START round=2 head_norm_before_train=0.755503 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7698131687833663, 'loss_val': 1.3115461707516072, 'psi': 0.39176545833028154}-{'f1_val': 0.13973365136155833, 'auprc': 0.7703883481585312, 'loss_val': 1.3099018454348899, 'psi': 0.3919955300803475}
[S16] START round=2 head_norm_before_train=1.206224 (no previous merge yet)
[S16] round=2 local utility u=0.009091 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8431735528315808, 'loss_val': 1.2743272987392842, 'psi': 0.4216518912521543}-{'f1_val': 0.14063745019920318, 'auprc': 0.8495206647432116, 'loss_val': 1.3115498991912686, 'psi': 0.42419073601680657}
[S17] START round=2 head_norm_before_train=0.839178 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.414766 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7667013311520753, 'loss_val': 1.362279175544206, 'psi': 0.3912499104512608}-{'f1_val': 0.14094896331738438, 'auprc': 0.4909851445919054, 'loss_val': 1.3646619701740927, 'psi': 0.2809634358271928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:33914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:33917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:33916
[S7] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1792) from S7
[S17] cosine check vs S7: cos=0.4200
[S14] RECEIVED delta(kind=head bytes=1792) from S5
[S14] cosine check vs S5: cos=0.1359
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=-0.0302
[S17] DROPPED delta from S8 (cos=-0.0302 < 0.0)
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S3
[S16] cosine check vs S3: cos=-0.0851
[S16] DROPPED delta from S3 (cos=-0.0851 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:33917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S11@127.0.0.1:33912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:33908
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S10] → sending delta(kind=head bytes=1787) to S2@127.0.0.1:33902
[S11] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S16] → sending delta(kind=head bytes=1786) to S17@127.0.0.1:33917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S2] → sending delta(kind=head bytes=1787) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S13] → sending delta(kind=head bytes=1786) to S5@127.0.0.1:33905
[S4] sending update (kind=head size=1788 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S11
[S17] cosine check vs S11: cos=-0.0711
[S17] DROPPED delta from S11 (cos=-0.0711 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1788) from S4
[S11] cosine check vs S4: cos=-0.0104
[S11] DROPPED delta from S4 (cos=-0.0104 < 0.0)
[S10] sending update (kind=head size=1787 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1789) from S14
[S7] cosine check vs S14: cos=0.0881
[S2] RECEIVED delta(kind=head bytes=1787) from S10
[S2] cosine check vs S10: cos=0.0119
[S9] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1787 to 1 peers)
[S16] sending update (kind=head size=1786 to 1 peers)
[S13] sending update (kind=head size=1786 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1786) from S16
[S17] cosine check vs S16: cos=-0.0257
[S17] DROPPED delta from S16 (cos=-0.0257 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1787) from S2
[S3] cosine check vs S2: cos=0.7438
[S7] RECEIVED delta(kind=head bytes=1802) from S9
[S7] cosine check vs S9: cos=0.0650
[S5] RECEIVED delta(kind=head bytes=1786) from S13
[S5] cosine check vs S13: cos=0.0447
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:33910
[S17] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S17
[S9] cosine check vs S17: cos=0.0471
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.1421 head_norm=0.872355
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.644538e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1421 head_norm=0.629416 delta_norm=0.564454
[S7] aggregate: ACCEPT kept=['S14', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=2 metric=0.1423 head_norm=1.196612
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.611850e-01
[S5] stored merged vector for next round verification (round=2)
[S5] DEBUG after merge:  round=2 metric=0.1423 head_norm=0.900484 delta_norm=0.861185
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=2 metric=0.1398 head_norm=0.914295
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.233962e-01
[S3] stored merged vector for next round verification (round=2)
[S3] DEBUG after merge:  round=2 metric=0.1398 head_norm=1.020002 delta_norm=0.423396
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=2 metric=0.3915 head_norm=1.153513
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.725613e-01
[S14] stored merged vector for next round verification (round=2)
[S14] DEBUG after merge:  round=2 metric=0.3912 head_norm=0.885655 delta_norm=0.772561
[S14] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=1.266255
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.678343e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.878214 delta_norm=0.867834
[S2] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=1.171729
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.064890e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.738806 delta_norm=0.706489
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=0.846744
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.629993e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.724307 delta_norm=0.462999
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.878214 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.235300 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7676693224740093, 'loss_val': 1.281024219836017, 'psi': 0.3921340090227438}-{'f1_val': 0.1417771333885667, 'auprc': 0.6141501481252137, 'loss_val': 1.2910661530527527, 'psi': 0.33072633928322553}
[S3] START round=3 head_norm_before_train=1.020002 cos_to_last_merge=1.0000 (last merge round=2)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8541515417486113, 'loss_val': 1.292448511853141, 'psi': 0.4255646560679087}-{'f1_val': 0.13984006561410703, 'auprc': 0.9230347565421047, 'loss_val': 1.3175077561306008, 'psi': 0.4531179419853061}
[S4] START round=3 head_norm_before_train=1.177170 (no previous merge yet)
[S4] round=3 local utility u=0.036079 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7932768729885264, 'loss_val': 1.2137907174869813, 'psi': 0.40144672653252106}-{'f1_val': 0.14022662889518414, 'auprc': 0.7917778868855678, 'loss_val': 1.2814522492772504, 'psi': 0.40084713209133765}
[S5] START round=3 head_norm_before_train=0.900484 cos_to_last_merge=1.0000 (last merge round=2)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7776755757095167, 'loss_val': 1.2780458469321632, 'psi': 0.39642737314094956}-{'f1_val': 0.14226190476190476, 'auprc': 0.7775383949155784, 'loss_val': 1.2721692742013428, 'psi': 0.3963725008233742}
[S6] START round=3 head_norm_before_train=1.204246 (no previous merge yet)
[S6] round=3 local utility u=0.034460 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8365908852748657, 'loss_val': 1.25282639727544, 'psi': 0.4194921233407155}-{'f1_val': 0.14142628205128205, 'auprc': 0.8291999244412469, 'loss_val': 1.2995735500812577, 'psi': 0.416535739007268}
[S7] START round=3 head_norm_before_train=0.629416 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5693386508929549, 'loss_val': 1.3151231041409204, 'psi': 0.31296955399463694}-{'f1_val': 0.14205682272909165, 'auprc': 0.681472404324862, 'loss_val': 1.3249535812651176, 'psi': 0.3578230553673998}
[S8] START round=3 head_norm_before_train=0.873341 cos_to_last_merge=0.9971 (last merge round=1)
[S8] round=3 local utility u=0.020609 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7708357458343278, 'loss_val': 1.2619165833228052, 'psi': 0.3923078877695055}-{'f1_val': 0.13995598239295717, 'auprc': 0.7708722095753432, 'loss_val': 1.303244220400135, 'psi': 0.39232247326591163}
[S9] START round=3 head_norm_before_train=0.738806 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.458487 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9873099368796528, 'loss_val': 1.2890070913384357, 'psi': 0.47976274903585875}-{'f1_val': 0.141397957139996, 'auprc': 0.6792511854921418, 'loss_val': 1.2818046021073153, 'psi': 0.35653924848085433}
[S10] START round=3 head_norm_before_train=1.202244 (no previous merge yet)
[S10] round=3 local utility u=0.020533 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7761317566789286, 'loss_val': 1.2509573911698042, 'psi': 0.39362568519660585}-{'f1_val': 0.13862163754172394, 'auprc': 0.7756573316386277, 'loss_val': 1.2905997848678235, 'psi': 0.3934359151804855}
[S11] START round=3 head_norm_before_train=1.219763 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7647106574488558, 'loss_val': 1.2613396313796943, 'psi': 0.3901324730034087}-{'f1_val': 0.14041368337311058, 'auprc': 0.7815729555563933, 'loss_val': 1.2930527229203699, 'psi': 0.39687739224642365}
[S13] START round=3 head_norm_before_train=1.293500 (no previous merge yet)
[S13] round=3 local utility u=0.031356 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5647034907092964, 'loss_val': 1.2258931641536273, 'psi': 0.3101128538299504}-{'f1_val': 0.1403857625770531, 'auprc': 0.5598118736674881, 'loss_val': 1.2739310050545778, 'psi': 0.3081562070132271}
[S14] START round=3 head_norm_before_train=0.885655 cos_to_last_merge=1.0000 (last merge round=2)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8498829099069646, 'loss_val': 1.3034804886858835, 'psi': 0.4241678756924081}-{'f1_val': 0.39149020627729036, 'auprc': 0.8738212521005189, 'loss_val': 1.3081316100375557, 'psi': 0.5844226246065818}
[S15] START round=3 head_norm_before_train=0.781917 cos_to_last_merge=0.9961 (last merge round=1)
[S15] round=3 local utility u=0.019973 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7712345491008217, 'loss_val': 1.275864684897912, 'psi': 0.3923340104572637}-{'f1_val': 0.13973365136155833, 'auprc': 0.7698131687833663, 'loss_val': 1.3115461707516072, 'psi': 0.39176545833028154}
[S16] START round=3 head_norm_before_train=1.229253 (no previous merge yet)
[S16] round=3 local utility u=0.019575 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8423266393063507, 'loss_val': 1.2326375464324368, 'psi': 0.42131312584206215}-{'f1_val': 0.14063745019920318, 'auprc': 0.8431735528315808, 'loss_val': 1.2743272987392842, 'psi': 0.4216518912521543}
[S17] START round=3 head_norm_before_train=0.724307 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7348141924172484, 'loss_val': 1.3415125332409676, 'psi': 0.37849505495733}-{'f1_val': 0.14094896331738438, 'auprc': 0.7667013311520753, 'loss_val': 1.362279175544206, 'psi': 0.3912499104512608}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:33907
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S8@127.0.0.1:33909
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:33909
[S4] sending update (kind=head size=1788 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1790) from S13
[S6] cosine check vs S13: cos=-0.0245
[S6] DROPPED delta from S13 (cos=-0.0245 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S8
[S2] cosine check vs S8: cos=0.4698
[S6] RECEIVED delta(kind=head bytes=1793) from S10
[S6] cosine check vs S10: cos=-0.0438
[S6] DROPPED delta from S10 (cos=-0.0438 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S9
[S10] cosine check vs S9: cos=-0.0130
[S10] DROPPED delta from S9 (cos=-0.0130 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] cosine check vs S15: cos=0.3308
[S6] RECEIVED delta(kind=head bytes=1794) from S16
[S6] cosine check vs S16: cos=0.0437
[S5] RECEIVED delta(kind=head bytes=1800) from S6
[S5] cosine check vs S6: cos=-0.0390
[S5] DROPPED delta from S6 (cos=-0.0390 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1788) from S4
[S8] cosine check vs S4: cos=0.0966
[S3] RECEIVED delta(kind=head bytes=1802) from S2
[S3] cosine check vs S2: cos=0.7122
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=1.034727
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.722205e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.895381 delta_norm=0.372221
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=0.899917
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.648023e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.773865 delta_norm=0.464802
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=1.233343
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.610739e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.899532 delta_norm=0.861074
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1400 head_norm=0.905519
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.142980e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.1400 head_norm=0.663033 delta_norm=0.514298
[S8] aggregate: ACCEPT kept=['S15', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.773865 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7543095716779464, 'loss_val': 1.2702626980233263, 'psi': 0.3867901087043186}-{'f1_val': 0.1417771333885667, 'auprc': 0.7676693224740093, 'loss_val': 1.281024219836017, 'psi': 0.3921340090227438}
[S3] START round=4 head_norm_before_train=0.895381 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7956537164375772, 'loss_val': 1.2534562367692699, 'psi': 0.4021655259434951}-{'f1_val': 0.13984006561410703, 'auprc': 0.8541515417486113, 'loss_val': 1.292448511853141, 'psi': 0.4255646560679087}
[S4] START round=4 head_norm_before_train=1.206354 (no previous merge yet)
[S4] round=4 local utility u=0.049208 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7918236228924266, 'loss_val': 1.1110157896956838, 'psi': 0.40086542649408113}-{'f1_val': 0.14022662889518414, 'auprc': 0.7932768729885264, 'loss_val': 1.2137907174869813, 'psi': 0.40144672653252106}
[S5] START round=4 head_norm_before_train=0.920681 cos_to_last_merge=0.9978 (last merge round=2)
[S5] round=4 local utility u=0.025017 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.776402460995972, 'loss_val': 1.2241916038999119, 'psi': 0.39591812725553166}-{'f1_val': 0.14226190476190476, 'auprc': 0.7776755757095167, 'loss_val': 1.2780458469321632, 'psi': 0.39642737314094956}
[S6] START round=4 head_norm_before_train=0.899532 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8331874013005186, 'loss_val': 1.2526238891717336, 'psi': 0.41813072975097665}-{'f1_val': 0.14142628205128205, 'auprc': 0.8365908852748657, 'loss_val': 1.25282639727544, 'psi': 0.4194921233407155}
[S7] START round=4 head_norm_before_train=0.648975 cos_to_last_merge=0.9948 (last merge round=2)
[S7] round=4 local utility u=0.086368 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6175480863388564, 'loss_val': 1.2870159239184495, 'psi': 0.3322533281729976}-{'f1_val': 0.14205682272909165, 'auprc': 0.5693386508929549, 'loss_val': 1.3151231041409204, 'psi': 0.31296955399463694}
[S8] START round=4 head_norm_before_train=0.663033 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.246890 metrics={'f1_val': 0.21989742588857808, 'auprc': 0.7680438711850361, 'loss_val': 1.2394086748598154, 'psi': 0.43915600400716137}-{'f1_val': 0.13995598239295717, 'auprc': 0.7708357458343278, 'loss_val': 1.2619165833228052, 'psi': 0.3923078877695055}
[S9] START round=4 head_norm_before_train=0.767303 cos_to_last_merge=0.9960 (last merge round=2)
[S9] round=4 local utility u=0.043072 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9962359875722979, 'loss_val': 1.2296411415039439, 'psi': 0.4833331693129168}-{'f1_val': 0.141397957139996, 'auprc': 0.9873099368796528, 'loss_val': 1.2890070913384357, 'psi': 0.47976274903585875}
[S10] START round=4 head_norm_before_train=1.233669 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6585880768072325, 'loss_val': 1.2015151677179703, 'psi': 0.3466082132479274}-{'f1_val': 0.13862163754172394, 'auprc': 0.7761317566789286, 'loss_val': 1.2509573911698042, 'psi': 0.39362568519660585}
[S11] START round=4 head_norm_before_train=1.248066 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7204529302734384, 'loss_val': 1.2271539024633205, 'psi': 0.3724293821332417}-{'f1_val': 0.14041368337311058, 'auprc': 0.7647106574488558, 'loss_val': 1.2613396313796943, 'psi': 0.3901324730034087}
[S13] START round=4 head_norm_before_train=1.320143 (no previous merge yet)
[S13] round=4 local utility u=0.869046 metrics={'f1_val': 0.4156839344320697, 'auprc': 0.5718038480091484, 'loss_val': 1.1608917220338761, 'psi': 0.47813189986290117}-{'f1_val': 0.1403857625770531, 'auprc': 0.5647034907092964, 'loss_val': 1.2258931641536273, 'psi': 0.3101128538299504}
[S14] START round=4 head_norm_before_train=0.913035 cos_to_last_merge=0.9969 (last merge round=2)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7977431124135127, 'loss_val': 1.252977658670645, 'psi': 0.40331195669502734}-{'f1_val': 0.14035785288270378, 'auprc': 0.8498829099069646, 'loss_val': 1.3034804886858835, 'psi': 0.4241678756924081}
[S15] START round=4 head_norm_before_train=0.816675 cos_to_last_merge=0.9868 (last merge round=1)
[S15] round=4 local utility u=0.028589 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7760896760996071, 'loss_val': 1.2332530433367295, 'psi': 0.3942760612567779}-{'f1_val': 0.13973365136155833, 'auprc': 0.7712345491008217, 'loss_val': 1.275864684897912, 'psi': 0.3923340104572637}
[S16] START round=4 head_norm_before_train=1.257011 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6158270258991645, 'loss_val': 1.1816608361879717, 'psi': 0.3307132804791877}-{'f1_val': 0.14063745019920318, 'auprc': 0.8423266393063507, 'loss_val': 1.2326375464324368, 'psi': 0.42131312584206215}
[S17] START round=4 head_norm_before_train=0.742500 cos_to_last_merge=0.9955 (last merge round=2)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6571147906592754, 'loss_val': 1.3044070914726824, 'psi': 0.3474152942541408}-{'f1_val': 0.14094896331738438, 'auprc': 0.7348141924172484, 'loss_val': 1.3415125332409676, 'psi': 0.37849505495733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S4] → sending delta(kind=head bytes=1787) to S8@127.0.0.1:33909
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:33902
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:33902
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:33907
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1787 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1794) from S8
[S2] cosine check vs S8: cos=0.6768
[S2] RECEIVED delta(kind=head bytes=1798) from S7
[S2] cosine check vs S7: cos=-0.0233
[S2] DROPPED delta from S7 (cos=-0.0233 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=0.0069
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] cosine check vs S15: cos=0.5755
[S6] RECEIVED delta(kind=head bytes=1793) from S13
[S6] cosine check vs S13: cos=-0.0228
[S6] DROPPED delta from S13 (cos=-0.0228 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S9
[S10] cosine check vs S9: cos=-0.0101
[S10] DROPPED delta from S9 (cos=-0.0101 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1787) from S4
[S8] cosine check vs S4: cos=0.5269
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.1398 head_norm=0.917359
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.587010e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.1398 head_norm=0.663237 delta_norm=0.658701
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=4 metric=0.1418 head_norm=0.793333
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.032561e-01
[S2] stored merged vector for next round verification (round=4)
[S2] DEBUG after merge:  round=4 metric=0.1418 head_norm=0.684136 delta_norm=0.303256
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.2199 head_norm=0.700453
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.808136e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.3769 head_norm=0.693568 delta_norm=0.280814
[S8] aggregate: ACCEPT kept=['S15', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.684136 cos_to_last_merge=1.0000 (last merge round=4)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.716969804056849, 'loss_val': 1.2531843557470785, 'psi': 0.3718542016558796}-{'f1_val': 0.1417771333885667, 'auprc': 0.7543095716779464, 'loss_val': 1.2702626980233263, 'psi': 0.3867901087043186}
[S3] START round=5 head_norm_before_train=0.663237 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.5974360757271433, 'loss_val': 1.2598452472067192, 'psi': 0.32287846965932154}-{'f1_val': 0.13984006561410703, 'auprc': 0.7956537164375772, 'loss_val': 1.2534562367692699, 'psi': 0.4021655259434951}
[S4] START round=5 head_norm_before_train=1.246097 (no previous merge yet)
[S4] round=5 local utility u=0.900668 metrics={'f1_val': 0.4158291457286432, 'auprc': 0.7961403987464586, 'loss_val': 0.9762458558445603, 'psi': 0.5679536469357693}-{'f1_val': 0.14022662889518414, 'auprc': 0.7918236228924266, 'loss_val': 1.1110157896956838, 'psi': 0.40086542649408113}
[S5] START round=5 head_norm_before_train=0.951837 cos_to_last_merge=0.9905 (last merge round=2)
[S5] round=5 local utility u=0.023691 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7776255124797631, 'loss_val': 1.180478402311056, 'psi': 0.39640734784904813}-{'f1_val': 0.14226190476190476, 'auprc': 0.776402460995972, 'loss_val': 1.2241916038999119, 'psi': 0.39591812725553166}
[S6] START round=5 head_norm_before_train=0.922390 cos_to_last_merge=0.9982 (last merge round=3)
[S6] round=5 local utility u=0.016530 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8326656803836645, 'loss_val': 1.2179983124112934, 'psi': 0.41792204138423505}-{'f1_val': 0.14142628205128205, 'auprc': 0.8331874013005186, 'loss_val': 1.2526238891717336, 'psi': 0.41813072975097665}
[S7] START round=5 head_norm_before_train=0.678434 cos_to_last_merge=0.9799 (last merge round=2)
[S7] round=5 local utility u=0.036744 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6423961997739541, 'loss_val': 1.2880723764418784, 'psi': 0.34219257354703664}-{'f1_val': 0.14205682272909165, 'auprc': 0.6175480863388564, 'loss_val': 1.2870159239184495, 'psi': 0.3322533281729976}
[S8] START round=5 head_norm_before_train=0.693568 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.612662 metrics={'f1_val': 0.41612423579361835, 'auprc': 0.7636086391601293, 'loss_val': 1.178139878939012, 'psi': 0.5551179971402227}-{'f1_val': 0.21989742588857808, 'auprc': 0.7680438711850361, 'loss_val': 1.2394086748598154, 'psi': 0.43915600400716137}
[S9] START round=5 head_norm_before_train=0.808421 cos_to_last_merge=0.9859 (last merge round=2)
[S9] round=5 local utility u=0.076367 metrics={'f1_val': 0.15582549426573752, 'auprc': 0.9893522685856674, 'loss_val': 1.1428214904351957, 'psi': 0.4892362039937095}-{'f1_val': 0.141397957139996, 'auprc': 0.9962359875722979, 'loss_val': 1.2296411415039439, 'psi': 0.4833331693129168}
[S10] START round=5 head_norm_before_train=1.265959 (no previous merge yet)
[S10] round=5 local utility u=0.044790 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6616056112439803, 'loss_val': 1.120988441410785, 'psi': 0.3478152270226265}-{'f1_val': 0.13862163754172394, 'auprc': 0.6585880768072325, 'loss_val': 1.2015151677179703, 'psi': 0.3466082132479274}
[S11] START round=5 head_norm_before_train=1.282390 (no previous merge yet)
[S11] round=5 local utility u=0.059968 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7445222729647465, 'loss_val': 1.1794252731830541, 'psi': 0.38205711920976493}-{'f1_val': 0.14041368337311058, 'auprc': 0.7204529302734384, 'loss_val': 1.2271539024633205, 'psi': 0.3724293821332417}
[S13] START round=5 head_norm_before_train=1.348327 (no previous merge yet)
[S13] round=5 local utility u=0.043407 metrics={'f1_val': 0.41662964849357986, 'auprc': 0.5646007160717651, 'loss_val': 1.0581426909191347, 'psi': 0.47581807552485395}-{'f1_val': 0.4156839344320697, 'auprc': 0.5718038480091484, 'loss_val': 1.1608917220338761, 'psi': 0.47813189986290117}
[S14] START round=5 head_norm_before_train=0.948385 cos_to_last_merge=0.9886 (last merge round=2)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7530636861103247, 'loss_val': 1.1722434303115445, 'psi': 0.38544018617375214}-{'f1_val': 0.14035785288270378, 'auprc': 0.7977431124135127, 'loss_val': 1.252977658670645, 'psi': 0.40331195669502734}
[S15] START round=5 head_norm_before_train=0.854496 cos_to_last_merge=0.9757 (last merge round=1)
[S15] round=5 local utility u=0.271938 metrics={'f1_val': 0.2181544389265512, 'auprc': 0.7765369813948295, 'loss_val': 1.161242711726262, 'psi': 0.44150745591386253}-{'f1_val': 0.13973365136155833, 'auprc': 0.7760896760996071, 'loss_val': 1.2332530433367295, 'psi': 0.3942760612567779}
[S16] START round=5 head_norm_before_train=1.292046 (no previous merge yet)
[S16] round=5 local utility u=0.730366 metrics={'f1_val': 0.4156626648174509, 'auprc': 0.5234864550310908, 'loss_val': 1.0940582196763735, 'psi': 0.45879218090290685}-{'f1_val': 0.14063745019920318, 'auprc': 0.6158270258991645, 'loss_val': 1.1816608361879717, 'psi': 0.3307132804791877}
[S17] START round=5 head_norm_before_train=0.771612 cos_to_last_merge=0.9833 (last merge round=2)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6187125926335755, 'loss_val': 1.2371085009173752, 'psi': 0.3320544150438608}-{'f1_val': 0.14094896331738438, 'auprc': 0.6571147906592754, 'loss_val': 1.3044070914726824, 'psi': 0.3474152942541408}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S5] → sending delta(kind=head bytes=1787) to S3@127.0.0.1:33903
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:33909
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1788 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1787 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] cosine check vs S7: cos=-0.0360
[S2] DROPPED delta from S7 (cos=-0.0360 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S4
[S8] cosine check vs S4: cos=0.7112
[S6] RECEIVED delta(kind=head bytes=1788) from S13
[S6] cosine check vs S13: cos=-0.0211
[S6] DROPPED delta from S13 (cos=-0.0211 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S9
[S10] cosine check vs S9: cos=-0.0110
[S10] DROPPED delta from S9 (cos=-0.0110 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S10
[S6] cosine check vs S10: cos=-0.0041
[S6] DROPPED delta from S10 (cos=-0.0041 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S16
[S6] cosine check vs S16: cos=0.6925
[S2] RECEIVED delta(kind=head bytes=1798) from S8
[S2] cosine check vs S8: cos=0.7313
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=-0.0320
[S4] DROPPED delta from S11 (cos=-0.0320 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1787) from S5
[S3] cosine check vs S5: cos=0.6951
[S8] RECEIVED delta(kind=head bytes=1791) from S15
[S8] cosine check vs S15: cos=0.6401
[S5] RECEIVED delta(kind=head bytes=1804) from S6
[S5] cosine check vs S6: cos=-0.0294
[S5] DROPPED delta from S6 (cos=-0.0294 < 0.0)
[S14] ⇄ pheromone p=0.420 → S7@127.0.0.1:33908
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=0.690879
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.526965e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=0.771760 delta_norm=0.352697
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.363 → S4@127.0.0.1:33904
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.1418 head_norm=0.708148
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.633510e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.1418 head_norm=0.668125 delta_norm=0.263351
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.373 → S3@127.0.0.1:33903
[S7] ⇄ pheromone p=0.370 → S2@127.0.0.1:33902
[S16] ⇄ pheromone p=0.477 → S6@127.0.0.1:33907
[S5] ⇄ pheromone p=0.339 → S3@127.0.0.1:33903
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.949689
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.780087e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=1.048634 delta_norm=0.478009
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.417 → S5@127.0.0.1:33905
[S11] ⇄ pheromone p=0.378 → S4@127.0.0.1:33904
[S4] ⇄ pheromone p=0.542 → S8@127.0.0.1:33909
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.4161 head_norm=0.728022
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.726520e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.4426 head_norm=0.755524 delta_norm=0.172652
[S8] aggregate: ACCEPT kept=['S4', 'S15'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.521 → S2@127.0.0.1:33902
[S13] ⇄ pheromone p=0.482 → S6@127.0.0.1:33907
[S9] ⇄ pheromone p=0.421 → S10@127.0.0.1:33911
[S15] ⇄ pheromone p=0.389 → S8@127.0.0.1:33909
[S10] ⇄ pheromone p=0.362 → S6@127.0.0.1:33907
[S17] ⇄ pheromone p=0.402 → S8@127.0.0.1:33909
[S2] START round=6 head_norm_before_train=0.668125 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.044448 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7409182942437856, 'loss_val': 1.2361329200805948, 'psi': 0.38143359773065433}-{'f1_val': 0.1417771333885667, 'auprc': 0.716969804056849, 'loss_val': 1.2531843557470785, 'psi': 0.3718542016558796}
[S3] START round=6 head_norm_before_train=0.771760 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.021199 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.5974210176503036, 'loss_val': 1.2174019054615703, 'psi': 0.3228724464285857}-{'f1_val': 0.13984006561410703, 'auprc': 0.5974360757271433, 'loss_val': 1.2598452472067192, 'psi': 0.32287846965932154}
[S4] START round=6 head_norm_before_train=1.278680 (no previous merge yet)
[S4] round=6 local utility u=0.862702 metrics={'f1_val': 0.6825925664431185, 'auprc': 0.7867466534887692, 'loss_val': 0.8232406467792115, 'psi': 0.7242542012613787}-{'f1_val': 0.4158291457286432, 'auprc': 0.7961403987464586, 'loss_val': 0.9762458558445603, 'psi': 0.5679536469357693}
[S5] START round=6 head_norm_before_train=0.981175 cos_to_last_merge=0.9822 (last merge round=2)
[S5] round=6 local utility u=0.051094 metrics={'f1_val': 0.1495616403260075, 'auprc': 0.7778235318397028, 'loss_val': 1.1226819995558461, 'psi': 0.4008663969314856}-{'f1_val': 0.14226190476190476, 'auprc': 0.7776255124797631, 'loss_val': 1.180478402311056, 'psi': 0.39640734784904813}
[S6] START round=6 head_norm_before_train=1.048634 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.007989 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8312373770032268, 'loss_val': 1.1977360093786469, 'psi': 0.4173507200320599}-{'f1_val': 0.14142628205128205, 'auprc': 0.8326656803836645, 'loss_val': 1.2179983124112934, 'psi': 0.41792204138423505}
[S7] START round=6 head_norm_before_train=0.697819 cos_to_last_merge=0.9683 (last merge round=2)
[S7] round=6 local utility u=0.206973 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7755557619931001, 'loss_val': 1.2736053189442544, 'psi': 0.39545639843469504}-{'f1_val': 0.14205682272909165, 'auprc': 0.6423961997739541, 'loss_val': 1.2880723764418784, 'psi': 0.34219257354703664}
[S8] START round=6 head_norm_before_train=0.755524 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.972452 metrics={'f1_val': 0.7148118385281752, 'auprc': 0.7794827190386822, 'loss_val': 1.0729846860367043, 'psi': 0.7406801907323779}-{'f1_val': 0.41612423579361835, 'auprc': 0.7636086391601293, 'loss_val': 1.178139878939012, 'psi': 0.5551179971402227}
[S9] START round=6 head_norm_before_train=0.853679 cos_to_last_merge=0.9740 (last merge round=2)
[S9] round=6 local utility u=0.384180 metrics={'f1_val': 0.41677413407000763, 'auprc': 0.6704814649978381, 'loss_val': 0.9835401071893678, 'psi': 0.5182570664411399}-{'f1_val': 0.15582549426573752, 'auprc': 0.9893522685856674, 'loss_val': 1.1428214904351957, 'psi': 0.4892362039937095}
[S10] START round=6 head_norm_before_train=1.296036 (no previous merge yet)
[S10] round=6 local utility u=0.935951 metrics={'f1_val': 0.4264908571679019, 'auprc': 0.6574838695694696, 'loss_val': 0.963936189335562, 'psi': 0.518888062128529}-{'f1_val': 0.13862163754172394, 'auprc': 0.6616056112439803, 'loss_val': 1.120988441410785, 'psi': 0.3478152270226265}
[S11] START round=6 head_norm_before_train=1.313762 (no previous merge yet)
[S11] round=6 local utility u=0.810826 metrics={'f1_val': 0.3746124757265016, 'auprc': 0.7892096124371052, 'loss_val': 1.0970272237970933, 'psi': 0.540451330410743}-{'f1_val': 0.14041368337311058, 'auprc': 0.7445222729647465, 'loss_val': 1.1794252731830541, 'psi': 0.38205711920976493}
[S13] START round=6 head_norm_before_train=1.375626 (no previous merge yet)
[S13] round=6 local utility u=0.003918 metrics={'f1_val': 0.416200286011302, 'auprc': 0.5263737009607532, 'loss_val': 0.9330494195007986, 'psi': 0.4602696519910825}-{'f1_val': 0.41662964849357986, 'auprc': 0.5646007160717651, 'loss_val': 1.0581426909191347, 'psi': 0.47581807552485395}
[S14] START round=6 head_norm_before_train=0.989898 cos_to_last_merge=0.9772 (last merge round=2)
[S14] round=6 local utility u=1.000000 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.9232716719369025, 'loss_val': 1.0153530880350459, 'psi': 0.6072252114219157}-{'f1_val': 0.14035785288270378, 'auprc': 0.7530636861103247, 'loss_val': 1.1722434303115445, 'psi': 0.38544018617375214}
[S15] START round=6 head_norm_before_train=0.901074 cos_to_last_merge=0.9617 (last merge round=1)
[S15] round=6 local utility u=0.696423 metrics={'f1_val': 0.41691903018686227, 'auprc': 0.7989798812672299, 'loss_val': 1.0283122352665601, 'psi': 0.5697433706190094}-{'f1_val': 0.2181544389265512, 'auprc': 0.7765369813948295, 'loss_val': 1.161242711726262, 'psi': 0.44150745591386253}
[S16] START round=6 head_norm_before_train=1.324516 (no previous merge yet)
[S16] round=6 local utility u=0.079813 metrics={'f1_val': 0.4170395601558466, 'auprc': 0.5354673141705963, 'loss_val': 0.9786367889517124, 'psi': 0.4644106617617465}-{'f1_val': 0.4156626648174509, 'auprc': 0.5234864550310908, 'loss_val': 1.0940582196763735, 'psi': 0.45879218090290685}
[S17] START round=6 head_norm_before_train=0.812254 cos_to_last_merge=0.9652 (last merge round=2)
[S17] round=6 local utility u=0.033357 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6055381298391874, 'loss_val': 1.1308705645091721, 'psi': 0.3267846299261056}-{'f1_val': 0.14094896331738438, 'auprc': 0.6187125926335755, 'loss_val': 1.2371085009173752, 'psi': 0.3320544150438608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S6] → sending delta(kind=head bytes=1784) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:33907
[S15] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1784 to 1 peers)
[S10] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] cosine check vs S16: cos=0.9291
[S6] RECEIVED delta(kind=head bytes=1792) from S13
[S6] cosine check vs S13: cos=-0.0051
[S6] DROPPED delta from S13 (cos=-0.0051 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1789) from S10
[S6] cosine check vs S10: cos=0.0295
[S4] RECEIVED delta(kind=head bytes=1797) from S3
[S4] cosine check vs S3: cos=-0.0742
[S4] DROPPED delta from S3 (cos=-0.0742 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] cosine check vs S11: cos=-0.0348
[S4] DROPPED delta from S11 (cos=-0.0348 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1803) from S2
[S3] cosine check vs S2: cos=0.1988
[S5] RECEIVED delta(kind=head bytes=1784) from S6
[S5] cosine check vs S6: cos=-0.0017
[S5] DROPPED delta from S6 (cos=-0.0017 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] cosine check vs S14: cos=0.3925
[S8] RECEIVED delta(kind=head bytes=1792) from S4
[S8] cosine check vs S4: cos=0.7662
[S10] RECEIVED delta(kind=head bytes=1800) from S9
[S10] cosine check vs S9: cos=-0.0155
[S10] DROPPED delta from S9 (cos=-0.0155 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S7
[S2] cosine check vs S7: cos=-0.0463
[S2] DROPPED delta from S7 (cos=-0.0463 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S8
[S2] cosine check vs S8: cos=0.8464
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=0.9291
[S8] RECEIVED delta(kind=head bytes=1793) from S15
[S8] cosine check vs S15: cos=0.6478
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=-0.0324
[S8] DROPPED delta from S17 (cos=-0.0324 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.699608
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.997629e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.731589 delta_norm=0.499763
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=1.067791
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.228537e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.933033 delta_norm=0.422854
[S6] aggregate: ACCEPT kept=['S16', 'S10'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.7148 head_norm=0.782731
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.224241e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.7148 head_norm=0.804823 delta_norm=0.122424
[S8] aggregate: ACCEPT kept=['S4', 'S15'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.1398 head_norm=0.786943
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.135890e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.1398 head_norm=0.682691 delta_norm=0.213589
[S3] aggregate: ACCEPT kept=['S2', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.1418 head_norm=0.692853
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.089817e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.1418 head_norm=0.709002 delta_norm=0.208982
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.709002 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.027151 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7470704905777424, 'loss_val': 1.2002878873691591, 'psi': 0.383894476264237}-{'f1_val': 0.1417771333885667, 'auprc': 0.7409182942437856, 'loss_val': 1.2361329200805948, 'psi': 0.38143359773065433}
[S3] START round=7 head_norm_before_train=0.682691 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.319892 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7957093920058202, 'loss_val': 1.1724830302919347, 'psi': 0.40218779617079237}-{'f1_val': 0.13984006561410703, 'auprc': 0.5974210176503036, 'loss_val': 1.2174019054615703, 'psi': 0.3228724464285857}
[S4] START round=7 head_norm_before_train=1.314686 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.540550283854448, 'auprc': 0.7615544588813516, 'loss_val': 0.7029828519769588, 'psi': 0.6289519538652095}-{'f1_val': 0.6825925664431185, 'auprc': 0.7867466534887692, 'loss_val': 0.8232406467792115, 'psi': 0.7242542012613787}
[S5] START round=7 head_norm_before_train=1.001834 cos_to_last_merge=0.9756 (last merge round=2)
[S5] round=7 local utility u=0.837531 metrics={'f1_val': 0.41734838192522206, 'auprc': 0.7778229855909383, 'loss_val': 1.0543396564297802, 'psi': 0.5615382233915086}-{'f1_val': 0.1495616403260075, 'auprc': 0.7778235318397028, 'loss_val': 1.1226819995558461, 'psi': 0.4008663969314856}
[S6] START round=7 head_norm_before_train=0.933033 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8178946315302202, 'loss_val': 1.1724618615986353, 'psi': 0.41201362184285734}-{'f1_val': 0.14142628205128205, 'auprc': 0.8312373770032268, 'loss_val': 1.1977360093786469, 'psi': 0.4173507200320599}
[S7] START round=7 head_norm_before_train=0.731589 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7783577128633954, 'loss_val': 1.2897451795564032, 'psi': 0.3965771787828132}-{'f1_val': 0.14205682272909165, 'auprc': 0.7755557619931001, 'loss_val': 1.2736053189442544, 'psi': 0.39545639843469504}
[S8] START round=7 head_norm_before_train=0.804823 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.7825444407347332, 'loss_val': 0.9725090843820261, 'psi': 0.5367371966071992}-{'f1_val': 0.7148118385281752, 'auprc': 0.7794827190386822, 'loss_val': 1.0729846860367043, 'psi': 0.7406801907323779}
[S9] START round=7 head_norm_before_train=0.904822 cos_to_last_merge=0.9601 (last merge round=2)
[S9] round=7 local utility u=0.654568 metrics={'f1_val': 0.4375895097534877, 'auprc': 0.9894932848248504, 'loss_val': 0.7563321833777914, 'psi': 0.6583510197820328}-{'f1_val': 0.41677413407000763, 'auprc': 0.6704814649978381, 'loss_val': 0.9835401071893678, 'psi': 0.5182570664411399}
[S10] START round=7 head_norm_before_train=1.334385 (no previous merge yet)
[S10] round=7 local utility u=0.205117 metrics={'f1_val': 0.3865545362765379, 'auprc': 0.8241920609123772, 'loss_val': 0.8142081894973252, 'psi': 0.5616095461308737}-{'f1_val': 0.4264908571679019, 'auprc': 0.6574838695694696, 'loss_val': 0.963936189335562, 'psi': 0.518888062128529}
[S11] START round=7 head_norm_before_train=1.343584 (no previous merge yet)
[S11] round=7 local utility u=0.171621 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.816846111677384, 'loss_val': 0.9683342394075148, 'psi': 0.5646697862266773}-{'f1_val': 0.3746124757265016, 'auprc': 0.7892096124371052, 'loss_val': 1.0970272237970933, 'psi': 0.540451330410743}
[S13] START round=7 head_norm_before_train=1.406953 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.4812464624164123, 'loss_val': 0.8521484120221601, 'psi': 0.44210090472604197}-{'f1_val': 0.416200286011302, 'auprc': 0.5263737009607532, 'loss_val': 0.9330494195007986, 'psi': 0.4602696519910825}
[S14] START round=7 head_norm_before_train=1.039481 cos_to_last_merge=0.9639 (last merge round=2)
[S14] round=7 local utility u=0.888048 metrics={'f1_val': 0.6326356688315283, 'auprc': 0.9757920269053157, 'loss_val': 0.8134671115601764, 'psi': 0.7698982120610434}-{'f1_val': 0.39652757107859105, 'auprc': 0.9232716719369025, 'loss_val': 1.0153530880350459, 'psi': 0.6072252114219157}
[S15] START round=7 head_norm_before_train=0.940853 cos_to_last_merge=0.9488 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=7 local utility u=0.009840 metrics={'f1_val': 0.3903380247657324, 'auprc': 0.7998249911118531, 'loss_val': 0.8516811146149241, 'psi': 0.5541328113041808}-{'f1_val': 0.41691903018686227, 'auprc': 0.7989798812672299, 'loss_val': 1.0283122352665601, 'psi': 0.5697433706190094}
[S16] START round=7 head_norm_before_train=1.352155 (no previous merge yet)
[S16] round=7 local utility u=0.249677 metrics={'f1_val': 0.3840930382813762, 'auprc': 0.7389875582273697, 'loss_val': 0.8921641691667558, 'psi': 0.5260508462597736}-{'f1_val': 0.4170395601558466, 'auprc': 0.5354673141705963, 'loss_val': 0.9786367889517124, 'psi': 0.4644106617617465}
[S17] START round=7 head_norm_before_train=0.861229 cos_to_last_merge=0.9440 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=7 local utility u=0.803896 metrics={'f1_val': 0.39072837433878244, 'auprc': 0.6155878563417008, 'loss_val': 1.051905118266213, 'psi': 0.48067216713994976}-{'f1_val': 0.14094896331738438, 'auprc': 0.6055381298391874, 'loss_val': 1.1308705645091721, 'psi': 0.3267846299261056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:33907
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:33908
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:33909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:33904
[S14] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S2
[S3] cosine check vs S2: cos=0.3683
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] cosine check vs S15: cos=0.6475
[S4] RECEIVED delta(kind=head bytes=1798) from S11
[S4] cosine check vs S11: cos=-0.0386
[S4] DROPPED delta from S11 (cos=-0.0386 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S10
[S6] cosine check vs S10: cos=0.3802
[S4] RECEIVED delta(kind=head bytes=1801) from S3
[S4] cosine check vs S3: cos=0.0493
[S6] RECEIVED delta(kind=head bytes=1794) from S16
[S6] cosine check vs S16: cos=0.9028
[S10] RECEIVED delta(kind=head bytes=1795) from S9
[S10] cosine check vs S9: cos=-0.0225
[S10] DROPPED delta from S9 (cos=-0.0225 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=0.9064
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.8909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=-0.0284
[S8] DROPPED delta from S17 (cos=-0.0284 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.3729 head_norm=0.836612
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.867329e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.3729 head_norm=0.824749 delta_norm=0.386733
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.1414 head_norm=0.950584
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.416367e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.1414 head_norm=0.949972 delta_norm=0.241637
[S6] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.738688
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.771112e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.894498 delta_norm=0.277111
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.5406 head_norm=1.360043
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.495884e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.5031 head_norm=0.780308 delta_norm=0.749588
[S4] aggregate: ROLLBACK (f1_val pre=0.541 post=0.503 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.1398 head_norm=0.701292
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.477200e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.1398 head_norm=0.666216 delta_norm=0.147720
[S3] aggregate: ACCEPT kept=['S2', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.728828 cos_to_last_merge=0.9957 (last merge round=6)
[S2] round=8 local utility u=0.582003 metrics={'f1_val': 0.3161114396276767, 'auprc': 0.7662444675197659, 'loss_val': 1.139809828586579, 'psi': 0.49616465078451244}-{'f1_val': 0.1417771333885667, 'auprc': 0.7470704905777424, 'loss_val': 1.2002878873691591, 'psi': 0.383894476264237}
[S3] START round=8 head_norm_before_train=0.666216 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.890446 metrics={'f1_val': 0.4222985071495892, 'auprc': 0.7961267458145896, 'loss_val': 1.0875935645712345, 'psi': 0.5718298026155895}-{'f1_val': 0.13984006561410703, 'auprc': 0.7957093920058202, 'loss_val': 1.1724830302919347, 'psi': 0.40218779617079237}
[S4] START round=8 head_norm_before_train=0.780308 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.5642455053591268, 'auprc': 0.6784155085898379, 'loss_val': 0.786962975974023, 'psi': 0.6099135066514112}-{'f1_val': 0.540550283854448, 'auprc': 0.7615544588813516, 'loss_val': 0.7029828519769588, 'psi': 0.6289519538652095}
[S5] START round=8 head_norm_before_train=1.031665 cos_to_last_merge=0.9666 (last merge round=2)
[S5] round=8 local utility u=0.071329 metrics={'f1_val': 0.4183961199382637, 'auprc': 0.777821154314739, 'loss_val': 0.9179623658205801, 'psi': 0.5621661336888538}-{'f1_val': 0.41734838192522206, 'auprc': 0.7778229855909383, 'loss_val': 1.0543396564297802, 'psi': 0.5615382233915086}
[S6] START round=8 head_norm_before_train=0.949972 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6548747424537376, 'loss_val': 1.1169578964237459, 'psi': 0.3468056662122642}-{'f1_val': 0.14142628205128205, 'auprc': 0.8178946315302202, 'loss_val': 1.1724618615986353, 'psi': 0.41201362184285734}
[S7] START round=8 head_norm_before_train=0.894498 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.030864 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7949701985443458, 'loss_val': 1.2778537629483007, 'psi': 0.4032221730551933}-{'f1_val': 0.14205682272909165, 'auprc': 0.7783577128633954, 'loss_val': 1.2897451795564032, 'psi': 0.3965771787828132}
[S8] START round=8 head_norm_before_train=0.824749 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.030326 metrics={'f1_val': 0.3731326739016295, 'auprc': 0.7745286320630047, 'loss_val': 0.8894122152293076, 'psi': 0.5336910571661796}-{'f1_val': 0.3728657005221765, 'auprc': 0.7825444407347332, 'loss_val': 0.9725090843820261, 'psi': 0.5367371966071992}
[S9] START round=8 head_norm_before_train=0.956215 cos_to_last_merge=0.9448 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.945
[S9] round=8 local utility u=0.893858 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9905726066102924, 'loss_val': 0.5551173054029387, 'psi': 0.81710909902232}-{'f1_val': 0.4375895097534877, 'auprc': 0.9894932848248504, 'loss_val': 0.7563321833777914, 'psi': 0.6583510197820328}
[S10] START round=8 head_norm_before_train=1.384307 (no previous merge yet)
[S10] round=8 local utility u=0.251849 metrics={'f1_val': 0.381315375246718, 'auprc': 0.9423048797084808, 'loss_val': 0.6334131372580957, 'psi': 0.6057111770314232}-{'f1_val': 0.3865545362765379, 'auprc': 0.8241920609123772, 'loss_val': 0.8142081894973252, 'psi': 0.5616095461308737}
[S11] START round=8 head_norm_before_train=1.379496 (no previous merge yet)
[S11] round=8 local utility u=0.327830 metrics={'f1_val': 0.396484976660716, 'auprc': 0.972389007610393, 'loss_val': 0.7788999869562927, 'psi': 0.6268465890405868}-{'f1_val': 0.39655223592620625, 'auprc': 0.816846111677384, 'loss_val': 0.9683342394075148, 'psi': 0.5646697862266773}
[S13] START round=8 head_norm_before_train=1.438554 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.3865506921062477, 'auprc': 0.47475632759252945, 'loss_val': 0.8573914417053219, 'psi': 0.4218329463007604}-{'f1_val': 0.4160038662657951, 'auprc': 0.4812464624164123, 'loss_val': 0.8521484120221601, 'psi': 0.44210090472604197}
[S14] START round=8 head_norm_before_train=1.099169 cos_to_last_merge=0.9485 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=8 local utility u=0.635504 metrics={'f1_val': 0.8103933418964591, 'auprc': 0.9950665280179027, 'loss_val': 0.6668290847714988, 'psi': 0.8842626163450364}-{'f1_val': 0.6326356688315283, 'auprc': 0.9757920269053157, 'loss_val': 0.8134671115601764, 'psi': 0.7698982120610434}
[S15] START round=8 head_norm_before_train=0.979606 cos_to_last_merge=0.9343 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=8 local utility u=0.157986 metrics={'f1_val': 0.4510360440392975, 'auprc': 0.7431625163619966, 'loss_val': 0.7299105811051612, 'psi': 0.5678866329683772}-{'f1_val': 0.3903380247657324, 'auprc': 0.7998249911118531, 'loss_val': 0.8516811146149241, 'psi': 0.5541328113041808}
[S16] START round=8 head_norm_before_train=1.384143 (no previous merge yet)
[S16] round=8 local utility u=0.033951 metrics={'f1_val': 0.3857708057611384, 'auprc': 0.7447118480560155, 'loss_val': 0.8515021197740325, 'psi': 0.5293472226790893}-{'f1_val': 0.3840930382813762, 'auprc': 0.7389875582273697, 'loss_val': 0.8921641691667558, 'psi': 0.5260508462597736}
[S17] START round=8 head_norm_before_train=0.908583 cos_to_last_merge=0.9237 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.924
[S17] round=8 local utility u=0.125070 metrics={'f1_val': 0.35928763996618185, 'auprc': 0.7375396568909987, 'loss_val': 0.9789763495975877, 'psi': 0.5105884467361086}-{'f1_val': 0.39072837433878244, 'auprc': 0.6155878563417008, 'loss_val': 1.051905118266213, 'psi': 0.48067216713994976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:33904
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:33908
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33903
[S5] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.9740
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=0.8718
[S2] RECEIVED delta(kind=head bytes=1795) from S8
[S2] cosine check vs S8: cos=0.8088
[S6] RECEIVED delta(kind=head bytes=1804) from S10
[S6] cosine check vs S10: cos=0.5580
[S4] RECEIVED delta(kind=head bytes=1796) from S3
[S4] cosine check vs S3: cos=0.5362
[S8] RECEIVED delta(kind=head bytes=1793) from S15
[S8] cosine check vs S15: cos=0.9060
[S3] RECEIVED delta(kind=head bytes=1801) from S2
[S3] cosine check vs S2: cos=0.4882
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] cosine check vs S11: cos=-0.0142
[S4] DROPPED delta from S11 (cos=-0.0142 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S7
[S2] cosine check vs S7: cos=0.0704
[S6] RECEIVED delta(kind=head bytes=1794) from S16
[S6] cosine check vs S16: cos=0.8317
[S10] RECEIVED delta(kind=head bytes=1798) from S9
[S10] cosine check vs S9: cos=-0.0279
[S10] DROPPED delta from S9 (cos=-0.0279 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S17
[S8] cosine check vs S17: cos=0.0015
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.5642 head_norm=0.834321
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.729003e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.5209 head_norm=0.670088 delta_norm=0.372900
[S4] aggregate: ROLLBACK (f1_val pre=0.564 post=0.521 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.1414 head_norm=0.967934
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.593983e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.1414 head_norm=0.992493 delta_norm=0.159398
[S6] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.3161 head_norm=0.754365
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.400686e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.1942 head_norm=0.636302 delta_norm=0.340069
[S2] aggregate: ROLLBACK (f1_val pre=0.316 post=0.194 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.3731 head_norm=0.869279
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.353429e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.3731 head_norm=0.719605 delta_norm=0.335343
[S8] aggregate: ACCEPT kept=['S15', 'S17'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1421 head_norm=0.905829
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.731072e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.1421 head_norm=1.026764 delta_norm=0.173107
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.4223 head_norm=0.692858
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.094741e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.4225 head_norm=0.680645 delta_norm=0.109474
[S3] aggregate: ACCEPT kept=['S5', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.636302 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.251044 metrics={'f1_val': 0.41630530508844577, 'auprc': 0.7245148206135353, 'loss_val': 1.1136963583113388, 'psi': 0.5395891112984816}-{'f1_val': 0.3161114396276767, 'auprc': 0.7662444675197659, 'loss_val': 1.139809828586579, 'psi': 0.49616465078451244}
[S3] START round=9 head_norm_before_train=0.680645 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.3963275517403211, 'auprc': 0.7961256371736948, 'loss_val': 1.007318996568079, 'psi': 0.5562467859136706}-{'f1_val': 0.4222985071495892, 'auprc': 0.7961267458145896, 'loss_val': 1.0875935645712345, 'psi': 0.5718298026155895}
[S4] START round=9 head_norm_before_train=0.670088 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.233546 metrics={'f1_val': 0.6632718282817069, 'auprc': 0.6593932391189172, 'loss_val': 0.8569629319085211, 'psi': 0.6617203926165911}-{'f1_val': 0.5642455053591268, 'auprc': 0.6784155085898379, 'loss_val': 0.786962975974023, 'psi': 0.6099135066514112}
[S5] START round=9 head_norm_before_train=1.071783 cos_to_last_merge=0.9558 (last merge round=2)
[S5] round=9 local utility u=0.942021 metrics={'f1_val': 0.7149582255866307, 'auprc': 0.7775707592845629, 'loss_val': 0.8125411351969241, 'psi': 0.7400032390658036}-{'f1_val': 0.4183961199382637, 'auprc': 0.777821154314739, 'loss_val': 0.9179623658205801, 'psi': 0.5621661336888538}
[S6] START round=9 head_norm_before_train=0.992493 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.960578 metrics={'f1_val': 0.41625250229074906, 'auprc': 0.7076729910907222, 'loss_val': 1.0031530086599034, 'psi': 0.5328206978107384}-{'f1_val': 0.14142628205128205, 'auprc': 0.6548747424537376, 'loss_val': 1.1169578964237459, 'psi': 0.3468056662122642}
[S7] START round=9 head_norm_before_train=1.026764 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.013148 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7946682871038508, 'loss_val': 1.2506521736024643, 'psi': 0.40310140847899534}-{'f1_val': 0.14205682272909165, 'auprc': 0.7949701985443458, 'loss_val': 1.2778537629483007, 'psi': 0.4032221730551933}
[S8] START round=9 head_norm_before_train=0.719605 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.025249 metrics={'f1_val': 0.3727318090052443, 'auprc': 0.7779406324689606, 'loss_val': 0.8467458750018031, 'psi': 0.5348153383907308}-{'f1_val': 0.3731326739016295, 'auprc': 0.7745286320630047, 'loss_val': 0.8894122152293076, 'psi': 0.5336910571661796}
[S9] START round=9 head_norm_before_train=1.007729 cos_to_last_merge=0.9261 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.926
[S9] round=9 local utility u=0.076745 metrics={'f1_val': 0.7012182915391405, 'auprc': 0.9972524892796171, 'loss_val': 0.42017584585311807, 'psi': 0.8196319706353311}-{'f1_val': 0.7014667606303384, 'auprc': 0.9905726066102924, 'loss_val': 0.5551173054029387, 'psi': 0.81710909902232}
[S10] START round=9 head_norm_before_train=1.435711 (no previous merge yet)
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.6890902247203889, 'auprc': 0.9465856027548345, 'loss_val': 0.48563799758732, 'psi': 0.7920883759341673}-{'f1_val': 0.381315375246718, 'auprc': 0.9423048797084808, 'loss_val': 0.6334131372580957, 'psi': 0.6057111770314232}
[S11] START round=9 head_norm_before_train=1.424257 (no previous merge yet)
[S11] round=9 local utility u=0.677325 metrics={'f1_val': 0.5757270935618621, 'auprc': 0.9940691047423671, 'loss_val': 0.5647437600170879, 'psi': 0.7430638980340641}-{'f1_val': 0.396484976660716, 'auprc': 0.972389007610393, 'loss_val': 0.7788999869562927, 'psi': 0.6268465890405868}
[S13] START round=9 head_norm_before_train=1.469975 (no previous merge yet)
[S13] round=9 local utility u=0.357535 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.6314737269422284, 'loss_val': 0.7880121682861019, 'psi': 0.5020738519683097}-{'f1_val': 0.3865506921062477, 'auprc': 0.47475632759252945, 'loss_val': 0.8573914417053219, 'psi': 0.4218329463007604}
[S14] START round=9 head_norm_before_train=1.160988 cos_to_last_merge=0.9329 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.933
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.7486159868388562, 'auprc': 0.9969083076706763, 'loss_val': 0.5507521242588206, 'psi': 0.8479329151715842}-{'f1_val': 0.8103933418964591, 'auprc': 0.9950665280179027, 'loss_val': 0.6668290847714988, 'psi': 0.8842626163450364}
[S15] START round=9 head_norm_before_train=1.027810 cos_to_last_merge=0.9164 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.916
[S15] round=9 local utility u=1.000000 metrics={'f1_val': 0.7009007909820093, 'auprc': 0.9344539517496642, 'loss_val': 0.590407915010314, 'psi': 0.7943220552890713}-{'f1_val': 0.4510360440392975, 'auprc': 0.7431625163619966, 'loss_val': 0.7299105811051612, 'psi': 0.5678866329683772}
[S16] START round=9 head_norm_before_train=1.420798 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.3171758728754762, 'auprc': 0.7613851858802864, 'loss_val': 0.8011524396887746, 'psi': 0.4948595980774003}-{'f1_val': 0.3857708057611384, 'auprc': 0.7447118480560155, 'loss_val': 0.8515021197740325, 'psi': 0.5293472226790893}
[S17] START round=9 head_norm_before_train=0.967005 cos_to_last_merge=0.9002 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.900
[S17] round=9 local utility u=0.100458 metrics={'f1_val': 0.3537291646329559, 'auprc': 0.7807776007920153, 'loss_val': 0.8744233450128188, 'psi': 0.5245485390965796}-{'f1_val': 0.35928763996618185, 'auprc': 0.7375396568909987, 'loss_val': 0.9789763495975877, 'psi': 0.5105884467361086}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:33911
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:33909
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1791) from S9
[S10] cosine check vs S9: cos=-0.0309
[S10] DROPPED delta from S9 (cos=-0.0309 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=0.8396
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] cosine check vs S4: cos=0.4487
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=0.8904
[S2] RECEIVED delta(kind=head bytes=1803) from S7
[S2] cosine check vs S7: cos=0.4443
[S5] RECEIVED delta(kind=head bytes=1793) from S6
[S5] cosine check vs S6: cos=0.0594
[S6] RECEIVED delta(kind=head bytes=1798) from S13
[S6] cosine check vs S13: cos=-0.0020
[S6] DROPPED delta from S13 (cos=-0.0020 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S10
[S6] cosine check vs S10: cos=0.6372
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] cosine check vs S11: cos=0.0048
[S2] RECEIVED delta(kind=head bytes=1797) from S8
[S2] cosine check vs S8: cos=0.8035
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] cosine check vs S2: cos=0.6563
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S17
[S8] cosine check vs S17: cos=0.3295
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.3963 head_norm=0.715517
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.198575e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.3944 head_norm=0.710775 delta_norm=0.119858
[S3] aggregate: ACCEPT kept=['S5', 'S2'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.4163 head_norm=1.012510
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.742772e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.1675 head_norm=1.135663 delta_norm=0.574277
[S6] aggregate: ROLLBACK (f1_val pre=0.416 post=0.167 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.7150 head_norm=1.113990
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.300864e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.7150 head_norm=0.774629 delta_norm=0.730086
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3727 head_norm=0.767551
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.821736e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3727 head_norm=0.657999 delta_norm=0.182174
[S8] aggregate: ACCEPT kept=['S4', 'S15', 'S17'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.4163 head_norm=0.665395
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.459840e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.4163 head_norm=0.647383 delta_norm=0.245984
[S2] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6633 head_norm=0.718824
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.207715e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.3676 head_norm=0.823867 delta_norm=0.820771
[S4] aggregate: ROLLBACK (f1_val pre=0.663 post=0.368 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=0.647383 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.4169384018324798, 'auprc': 0.7009944004401583, 'loss_val': 1.0776172936753967, 'psi': 0.5305608012755512}-{'f1_val': 0.41630530508844577, 'auprc': 0.7245148206135353, 'loss_val': 1.1136963583113388, 'psi': 0.5395891112984816}
[S3] START round=10 head_norm_before_train=0.710775 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.043504 metrics={'f1_val': 0.4002236756049706, 'auprc': 0.7959595717916442, 'loss_val': 0.9431887947552168, 'psi': 0.5585180340796401}-{'f1_val': 0.3963275517403211, 'auprc': 0.7961256371736948, 'loss_val': 1.007318996568079, 'psi': 0.5562467859136706}
[S4] START round=10 head_norm_before_train=0.823867 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.6737133291692886, 'auprc': 0.6296862757009999, 'loss_val': 0.9616346792957265, 'psi': 0.6561025077819731}-{'f1_val': 0.6632718282817069, 'auprc': 0.6593932391189172, 'loss_val': 0.8569629319085211, 'psi': 0.6617203926165911}
[S5] START round=10 head_norm_before_train=0.774629 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.4174665005497404, 'auprc': 0.7778172818325184, 'loss_val': 0.832592351238442, 'psi': 0.5616068130628517}-{'f1_val': 0.7149582255866307, 'auprc': 0.7775707592845629, 'loss_val': 0.8125411351969241, 'psi': 0.7400032390658036}
[S6] START round=10 head_norm_before_train=1.135663 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.065394 metrics={'f1_val': 0.411320083026057, 'auprc': 0.7441022660991253, 'loss_val': 0.9520573189247742, 'psi': 0.5444329562552843}-{'f1_val': 0.41625250229074906, 'auprc': 0.7076729910907222, 'loss_val': 1.0031530086599034, 'psi': 0.5328206978107384}
[S7] START round=10 head_norm_before_train=1.037806 cos_to_last_merge=0.9988 (last merge round=8)
[S7] round=10 local utility u=0.018967 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7950139297567188, 'loss_val': 1.213754693797469, 'psi': 0.4032396655401425}-{'f1_val': 0.14205682272909165, 'auprc': 0.7946682871038508, 'loss_val': 1.2506521736024643, 'psi': 0.40310140847899534}
[S8] START round=10 head_norm_before_train=0.657999 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.347829 metrics={'f1_val': 0.3727318090052443, 'auprc': 0.9955024926019381, 'loss_val': 0.8037725960050659, 'psi': 0.6218400824439219}-{'f1_val': 0.3727318090052443, 'auprc': 0.7779406324689606, 'loss_val': 0.8467458750018031, 'psi': 0.5348153383907308}
[S9] START round=10 head_norm_before_train=1.064665 cos_to_last_merge=0.9041 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.904
[S9] round=10 local utility u=0.058588 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982448151788923, 'loss_val': 0.30596654988252503, 'psi': 0.820027874535568}-{'f1_val': 0.7012182915391405, 'auprc': 0.9972524892796171, 'loss_val': 0.42017584585311807, 'psi': 0.8196319706353311}
[S10] START round=10 head_norm_before_train=1.487909 (no previous merge yet)
[S10] round=10 local utility u=0.125036 metrics={'f1_val': 0.6889385471580445, 'auprc': 0.9905064620269811, 'loss_val': 0.3664193501487184, 'psi': 0.8095657131056191}-{'f1_val': 0.6890902247203889, 'auprc': 0.9465856027548345, 'loss_val': 0.48563799758732, 'psi': 0.7920883759341673}
[S11] START round=10 head_norm_before_train=1.479235 (no previous merge yet)
[S11] round=10 local utility u=0.126547 metrics={'f1_val': 0.6046141890858098, 'auprc': 0.9794916601230564, 'loss_val': 0.44123995736430327, 'psi': 0.7545651775007085}-{'f1_val': 0.5757270935618621, 'auprc': 0.9940691047423671, 'loss_val': 0.5647437600170879, 'psi': 0.7430638980340641}
[S13] START round=10 head_norm_before_train=1.495628 (no previous merge yet)
[S13] round=10 local utility u=0.745000 metrics={'f1_val': 0.6368723508542965, 'auprc': 0.6741230134835552, 'loss_val': 0.7523508323085749, 'psi': 0.651772615906}-{'f1_val': 0.41580726865236384, 'auprc': 0.6314737269422284, 'loss_val': 0.7880121682861019, 'psi': 0.5020738519683097}
[S14] START round=10 head_norm_before_train=1.213814 cos_to_last_merge=0.9202 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.920
[S14] round=10 local utility u=0.252439 metrics={'f1_val': 0.818232079528943, 'auprc': 0.995583700674483, 'loss_val': 0.4595970469837502, 'psi': 0.889172727987159}-{'f1_val': 0.7486159868388562, 'auprc': 0.9969083076706763, 'loss_val': 0.5507521242588206, 'psi': 0.8479329151715842}
[S15] START round=10 head_norm_before_train=1.077466 cos_to_last_merge=0.8991 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.899
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6934421054628501, 'auprc': 0.7818400159093073, 'loss_val': 0.5679008526993636, 'psi': 0.728801269641433}-{'f1_val': 0.7009007909820093, 'auprc': 0.9344539517496642, 'loss_val': 0.590407915010314, 'psi': 0.7943220552890713}
[S16] START round=10 head_norm_before_train=1.460740 (no previous merge yet)
[S16] round=10 local utility u=0.343891 metrics={'f1_val': 0.4372345149649162, 'auprc': 0.7419576719640442, 'loss_val': 0.7754390091265351, 'psi': 0.5591237777645675}-{'f1_val': 0.3171758728754762, 'auprc': 0.7613851858802864, 'loss_val': 0.8011524396887746, 'psi': 0.4948595980774003}
[S17] START round=10 head_norm_before_train=1.028317 cos_to_last_merge=0.8778 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.878
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.3519909574605653, 'auprc': 0.7783422672489382, 'loss_val': 0.8943904204757862, 'psi': 0.5225314813759144}-{'f1_val': 0.3537291646329559, 'auprc': 0.7807776007920153, 'loss_val': 0.8744233450128188, 'psi': 0.5245485390965796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:33907
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:33905
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:33902
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:33907
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=0.9228
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=0.3994
[S4] RECEIVED delta(kind=head bytes=1793) from S11
[S4] cosine check vs S11: cos=0.8580
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] cosine check vs S3: cos=0.3903
[S7] RECEIVED delta(kind=head bytes=1804) from S14
[S7] cosine check vs S14: cos=0.9806
[S10] RECEIVED delta(kind=head bytes=1800) from S9
[S10] cosine check vs S9: cos=-0.0326
[S10] DROPPED delta from S9 (cos=-0.0326 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S6
[S5] cosine check vs S6: cos=0.5888
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] cosine check vs S8: cos=0.8307
[S2] RECEIVED delta(kind=head bytes=1799) from S7
[S2] cosine check vs S7: cos=0.6671
[S6] RECEIVED delta(kind=head bytes=1797) from S13
[S6] cosine check vs S13: cos=-0.0241
[S6] DROPPED delta from S13 (cos=-0.0241 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4175 head_norm=0.821577
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.711941e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.5635 head_norm=0.882918 delta_norm=0.471194
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.361 → S3@127.0.0.1:33903
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6737 head_norm=0.847232
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.757896e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.3676 head_norm=0.844791 delta_norm=0.175790
[S4] aggregate: ROLLBACK (f1_val pre=0.674 post=0.368 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.285 → S8@127.0.0.1:33909
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.4169 head_norm=0.678593
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.544857e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.4169 head_norm=0.680033 delta_norm=0.154486
[S2] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.243 → S3@127.0.0.1:33903
[S16] ⇄ pheromone p=0.262 → S6@127.0.0.1:33907
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.1421 head_norm=1.052322
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.550211e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.1421 head_norm=1.152141 delta_norm=0.155021
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.148 → S2@127.0.0.1:33902
[S3] ⇄ pheromone p=0.276 → S4@127.0.0.1:33904
[S9] ⇄ pheromone p=0.375 → S10@127.0.0.1:33911
[S11] ⇄ pheromone p=0.384 → S4@127.0.0.1:33904
[S8] ⇄ pheromone p=0.328 → S2@127.0.0.1:33902
[S14] ⇄ pheromone p=0.442 → S7@127.0.0.1:33908
[S13] ⇄ pheromone p=0.364 → S6@127.0.0.1:33907
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.4113 head_norm=1.152453
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.351793e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.4995 head_norm=1.105396 delta_norm=0.235179
[S6] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.304 → S5@127.0.0.1:33905
[S10] ⇄ pheromone p=0.434 → S6@127.0.0.1:33907
[S17] ⇄ pheromone p=0.249 → S8@127.0.0.1:33909
[S15] ⇄ pheromone p=0.366 → S8@127.0.0.1:33909
[S2] START round=11 head_norm_before_train=0.680033 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.723563 metrics={'f1_val': 0.6049494080341336, 'auprc': 0.7770427725077718, 'loss_val': 0.9867024497934535, 'psi': 0.6737867538235889}-{'f1_val': 0.4169384018324798, 'auprc': 0.7009944004401583, 'loss_val': 1.0776172936753967, 'psi': 0.5305608012755512}
[S3] START round=11 head_norm_before_train=0.752832 cos_to_last_merge=0.9907 (last merge round=9)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.40448947588906725, 'auprc': 0.7508340969882525, 'loss_val': 0.8755926173684828, 'psi': 0.5430273243287413}-{'f1_val': 0.4002236756049706, 'auprc': 0.7959595717916442, 'loss_val': 0.9431887947552168, 'psi': 0.5585180340796401}
[S4] START round=11 head_norm_before_train=0.844791 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.322216 metrics={'f1_val': 0.6663178225418569, 'auprc': 0.8452676294802972, 'loss_val': 0.9195727910574467, 'psi': 0.7378977453172331}-{'f1_val': 0.6737133291692886, 'auprc': 0.6296862757009999, 'loss_val': 0.9616346792957265, 'psi': 0.6561025077819731}
[S5] START round=11 head_norm_before_train=0.882918 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.431520 metrics={'f1_val': 0.5647091164311817, 'auprc': 0.7770963427002429, 'loss_val': 0.850845488359882, 'psi': 0.6496640069388062}-{'f1_val': 0.4174665005497404, 'auprc': 0.7778172818325184, 'loss_val': 0.832592351238442, 'psi': 0.5616068130628517}
[S6] START round=11 head_norm_before_train=1.105396 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.385378 metrics={'f1_val': 0.4168135083356663, 'auprc': 0.9463691450752504, 'loss_val': 0.8210615922958061, 'psi': 0.6286357630314999}-{'f1_val': 0.411320083026057, 'auprc': 0.7441022660991253, 'loss_val': 0.9520573189247742, 'psi': 0.5444329562552843}
[S7] START round=11 head_norm_before_train=1.152141 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.575366 metrics={'f1_val': 0.4147701524582619, 'auprc': 0.6371626285305518, 'loss_val': 1.225748958503476, 'psi': 0.5037271428871779}-{'f1_val': 0.14205682272909165, 'auprc': 0.7950139297567188, 'loss_val': 1.213754693797469, 'psi': 0.4032396655401425}
[S8] START round=11 head_norm_before_train=0.711002 cos_to_last_merge=0.9927 (last merge round=9)
[S8] round=11 local utility u=0.032116 metrics={'f1_val': 0.3725978128855645, 'auprc': 0.9930578434771693, 'loss_val': 0.7314029845035546, 'psi': 0.6207818251222064}-{'f1_val': 0.3727318090052443, 'auprc': 0.9955024926019381, 'loss_val': 0.8037725960050659, 'psi': 0.6218400824439219}
[S9] START round=11 head_norm_before_train=1.125402 cos_to_last_merge=0.8838 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.884
[S9] round=11 local utility u=0.029297 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9984879006318572, 'loss_val': 0.2481019644154886, 'psi': 0.820125108716754}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982448151788923, 'loss_val': 0.30596654988252503, 'psi': 0.820027874535568}
[S10] START round=11 head_norm_before_train=1.545740 (no previous merge yet)
[S10] round=11 local utility u=0.043293 metrics={'f1_val': 0.6884404070049519, 'auprc': 0.9861079191232387, 'loss_val': 0.2636497275025244, 'psi': 0.8075074118522666}-{'f1_val': 0.6889385471580445, 'auprc': 0.9905064620269811, 'loss_val': 0.3664193501487184, 'psi': 0.8095657131056191}
[S11] START round=11 head_norm_before_train=1.536024 (no previous merge yet)
[S11] round=11 local utility u=1.000000 metrics={'f1_val': 0.9159425273384676, 'auprc': 0.9963447004116757, 'loss_val': 0.28141543207254155, 'psi': 0.9481033965677508}-{'f1_val': 0.6046141890858098, 'auprc': 0.9794916601230564, 'loss_val': 0.44123995736430327, 'psi': 0.7545651775007085}
[S13] START round=11 head_norm_before_train=1.516355 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.514724205941191, 'auprc': 0.678377823705963, 'loss_val': 0.7142013986294599, 'psi': 0.5801856530470998}-{'f1_val': 0.6368723508542965, 'auprc': 0.6741230134835552, 'loss_val': 0.7523508323085749, 'psi': 0.651772615906}
[S14] START round=11 head_norm_before_train=1.263147 cos_to_last_merge=0.9101 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.910
[S14] round=11 local utility u=0.579377 metrics={'f1_val': 0.9935070721336358, 'auprc': 0.9970749870614191, 'loss_val': 0.35696643499279684, 'psi': 0.994934238104749}-{'f1_val': 0.818232079528943, 'auprc': 0.995583700674483, 'loss_val': 0.4595970469837502, 'psi': 0.889172727987159}
[S15] START round=11 head_norm_before_train=1.129066 cos_to_last_merge=0.8830 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.883
[S15] round=11 local utility u=0.087017 metrics={'f1_val': 0.6937862743929353, 'auprc': 0.7995206710551888, 'loss_val': 0.44897455892149596, 'psi': 0.7360800330578368}-{'f1_val': 0.6934421054628501, 'auprc': 0.7818400159093073, 'loss_val': 0.5679008526993636, 'psi': 0.728801269641433}
[S16] START round=11 head_norm_before_train=1.497360 (no previous merge yet)
[S16] round=11 local utility u=0.359270 metrics={'f1_val': 0.5450490590167834, 'auprc': 0.7635469707841432, 'loss_val': 0.7685542935962406, 'psi': 0.6324482237237273}-{'f1_val': 0.4372345149649162, 'auprc': 0.7419576719640442, 'loss_val': 0.7754390091265351, 'psi': 0.5591237777645675}
[S17] START round=11 head_norm_before_train=1.080893 cos_to_last_merge=0.8591 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.859
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3321060923931258, 'auprc': 0.678012831834433, 'loss_val': 1.0852284843430218, 'psi': 0.47046878816964866}-{'f1_val': 0.3519909574605653, 'auprc': 0.7783422672489382, 'loss_val': 0.8943904204757862, 'psi': 0.5225314813759144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:33911
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:33908
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:33907
[S4] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1796) from S9
[S10] cosine check vs S9: cos=-0.0335
[S10] DROPPED delta from S9 (cos=-0.0335 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] cosine check vs S15: cos=0.8034
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.9912
[S5] RECEIVED delta(kind=head bytes=1794) from S6
[S5] cosine check vs S6: cos=0.9104
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=0.8343
[S6] RECEIVED delta(kind=head bytes=1804) from S16
[S6] cosine check vs S16: cos=0.5707
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] cosine check vs S11: cos=0.8623
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=0.5019
[S3] RECEIVED delta(kind=head bytes=1797) from S2
[S3] cosine check vs S2: cos=0.6857
[S2] RECEIVED delta(kind=head bytes=1796) from S7
[S2] cosine check vs S7: cos=0.7505
[S2] RECEIVED delta(kind=head bytes=1793) from S8
[S2] cosine check vs S8: cos=0.7720
[S8] RECEIVED delta(kind=head bytes=1794) from S4
[S8] cosine check vs S4: cos=0.1914
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.4045 head_norm=0.805005
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.749443e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.4045 head_norm=0.678449 delta_norm=0.274944
[S3] aggregate: ACCEPT kept=['S5', 'S2'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6663 head_norm=0.866020
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.729793e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6537 head_norm=1.186337 delta_norm=0.472979
[S4] aggregate: ROLLBACK (f1_val pre=0.666 post=0.654 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.6049 head_norm=0.719427
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.285657e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.6311 head_norm=0.736872 delta_norm=0.128566
[S2] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.4168 head_norm=1.130273
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.391506e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.4167 head_norm=1.125371 delta_norm=0.139151
[S6] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4148 head_norm=1.159206
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.114297e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.3979 head_norm=1.232403 delta_norm=0.111430
[S7] aggregate: ROLLBACK (f1_val pre=0.415 post=0.398 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.5647 head_norm=0.921403
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.399232e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.6839 head_norm=1.002839 delta_norm=0.239923
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3726 head_norm=0.768734
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.885883e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.3726 head_norm=0.715265 delta_norm=0.288588
[S8] aggregate: ACCEPT kept=['S15', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=0.736872 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.243170 metrics={'f1_val': 0.6713467585992524, 'auprc': 0.7769990921130324, 'loss_val': 0.8986163291104976, 'psi': 0.7136076920047645}-{'f1_val': 0.6049494080341336, 'auprc': 0.7770427725077718, 'loss_val': 0.9867024497934535, 'psi': 0.6737867538235889}
[S3] START round=12 head_norm_before_train=0.678449 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.980639 metrics={'f1_val': 0.6924880784557341, 'auprc': 0.7845686069548526, 'loss_val': 0.7435092474293999, 'psi': 0.7293202898553816}-{'f1_val': 0.40448947588906725, 'auprc': 0.7508340969882525, 'loss_val': 0.8755926173684828, 'psi': 0.5430273243287413}
[S4] START round=12 head_norm_before_train=1.186337 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.139333 metrics={'f1_val': 0.6905366030929678, 'auprc': 0.8792503105503144, 'loss_val': 0.8881677493462949, 'psi': 0.7660220860759065}-{'f1_val': 0.6663178225418569, 'auprc': 0.8452676294802972, 'loss_val': 0.9195727910574467, 'psi': 0.7378977453172331}
[S5] START round=12 head_norm_before_train=1.002839 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.497143 metrics={'f1_val': 0.7146937595824697, 'auprc': 0.794603524044659, 'loss_val': 0.8089890364853415, 'psi': 0.7466576653673455}-{'f1_val': 0.5647091164311817, 'auprc': 0.7770963427002429, 'loss_val': 0.850845488359882, 'psi': 0.6496640069388062}
[S6] START round=12 head_norm_before_train=1.125371 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.055989 metrics={'f1_val': 0.4168533127370634, 'auprc': 0.9544415471882829, 'loss_val': 0.7335400002922811, 'psi': 0.6318886065175512}-{'f1_val': 0.4168135083356663, 'auprc': 0.9463691450752504, 'loss_val': 0.8210615922958061, 'psi': 0.6286357630314999}
[S7] START round=12 head_norm_before_train=1.232403 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.216227 metrics={'f1_val': 0.3942778226039638, 'auprc': 0.7889432853135113, 'loss_val': 1.1256827304921402, 'psi': 0.5521440076877828}-{'f1_val': 0.4147701524582619, 'auprc': 0.6371626285305518, 'loss_val': 1.225748958503476, 'psi': 0.5037271428871779}
[S8] START round=12 head_norm_before_train=0.715265 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.021147 metrics={'f1_val': 0.37266438550987346, 'auprc': 0.9950150831185781, 'loss_val': 0.6953811385579454, 'psi': 0.6216046645533554}-{'f1_val': 0.3725978128855645, 'auprc': 0.9930578434771693, 'loss_val': 0.7314029845035546, 'psi': 0.6207818251222064}
[S9] START round=12 head_norm_before_train=1.181151 cos_to_last_merge=0.8669 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.867
[S9] round=12 local utility u=0.034979 metrics={'f1_val': 0.7700101109814215, 'auprc': 0.9436592053253201, 'loss_val': 0.42641994687751383, 'psi': 0.8394697487189808}-{'f1_val': 0.7012165807733519, 'auprc': 0.9984879006318572, 'loss_val': 0.2481019644154886, 'psi': 0.820125108716754}
[S10] START round=12 head_norm_before_train=1.595843 (no previous merge yet)
[S10] round=12 local utility u=0.033061 metrics={'f1_val': 0.6942624605763625, 'auprc': 0.9943501852551377, 'loss_val': 0.2571874880874194, 'psi': 0.8142975504478727}-{'f1_val': 0.6884404070049519, 'auprc': 0.9861079191232387, 'loss_val': 0.2636497275025244, 'psi': 0.8075074118522666}
[S11] START round=12 head_norm_before_train=1.584999 (no previous merge yet)
[S11] round=12 local utility u=0.294105 metrics={'f1_val': 0.9978104421256118, 'auprc': 0.9980242417709891, 'loss_val': 0.18945148035829562, 'psi': 0.9978959619837627}-{'f1_val': 0.9159425273384676, 'auprc': 0.9963447004116757, 'loss_val': 0.28141543207254155, 'psi': 0.9481033965677508}
[S13] START round=12 head_norm_before_train=1.536203 (no previous merge yet)
[S13] round=12 local utility u=0.627563 metrics={'f1_val': 0.7129214090912908, 'auprc': 0.6794397670952639, 'loss_val': 0.6514452515461695, 'psi': 0.6995287522928799}-{'f1_val': 0.514724205941191, 'auprc': 0.678377823705963, 'loss_val': 0.7142013986294599, 'psi': 0.5801856530470998}
[S14] START round=12 head_norm_before_train=1.310995 cos_to_last_merge=0.9014 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.901
[S14] round=12 local utility u=0.051983 metrics={'f1_val': 0.9970855096107042, 'auprc': 0.9977200349445154, 'loss_val': 0.27640606056279154, 'psi': 0.9973393197442286}-{'f1_val': 0.9935070721336358, 'auprc': 0.9970749870614191, 'loss_val': 0.35696643499279684, 'psi': 0.994934238104749}
[S15] START round=12 head_norm_before_train=1.180776 cos_to_last_merge=0.8686 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.869
[S15] round=12 local utility u=0.233270 metrics={'f1_val': 0.6997351160752733, 'auprc': 0.9174872731002228, 'loss_val': 0.37202717890466797, 'psi': 0.786835978885253}-{'f1_val': 0.6937862743929353, 'auprc': 0.7995206710551888, 'loss_val': 0.44897455892149596, 'psi': 0.7360800330578368}
[S16] START round=12 head_norm_before_train=1.533850 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.3880212532488446, 'auprc': 0.7619347783492979, 'loss_val': 0.7447320070018353, 'psi': 0.5375866632890259}-{'f1_val': 0.5450490590167834, 'auprc': 0.7635469707841432, 'loss_val': 0.7685542935962406, 'psi': 0.6324482237237273}
[S17] START round=12 head_norm_before_train=1.122458 cos_to_last_merge=0.8439 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.844
[S17] round=12 local utility u=0.008766 metrics={'f1_val': 0.33695973228042597, 'auprc': 0.6438706904864863, 'loss_val': 0.9943914984684353, 'psi': 0.4597241155628501}-{'f1_val': 0.3321060923931258, 'auprc': 0.678012831834433, 'loss_val': 1.0852284843430218, 'psi': 0.47046878816964866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:33907
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:33903
[S5] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S13
[S6] cosine check vs S13: cos=-0.0147
[S6] DROPPED delta from S13 (cos=-0.0147 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1805) from S11
[S4] cosine check vs S11: cos=0.9642
[S5] RECEIVED delta(kind=head bytes=1799) from S6
[S5] cosine check vs S6: cos=0.9579
[S2] RECEIVED delta(kind=head bytes=1803) from S8
[S2] cosine check vs S8: cos=0.7200
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=0.7790
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=0.2718
[S4] RECEIVED delta(kind=head bytes=1797) from S3
[S4] cosine check vs S3: cos=0.1836
[S2] RECEIVED delta(kind=head bytes=1801) from S7
[S2] cosine check vs S7: cos=0.7879
[S3] RECEIVED delta(kind=head bytes=1805) from S5
[S3] cosine check vs S5: cos=0.5944
[S10] RECEIVED delta(kind=head bytes=1796) from S9
[S10] cosine check vs S9: cos=-0.0334
[S10] DROPPED delta from S9 (cos=-0.0334 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] cosine check vs S15: cos=0.8589
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.9939
[S3] RECEIVED delta(kind=head bytes=1799) from S2
[S3] cosine check vs S2: cos=0.7287
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.1733
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.6925 head_norm=0.735051
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.988998e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.6925 head_norm=0.689391 delta_norm=0.198900
[S3] aggregate: ACCEPT kept=['S5', 'S2'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7147 head_norm=1.036123
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.702497e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7146 head_norm=1.085403 delta_norm=0.170250
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6905 head_norm=1.200210
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.365400e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6873 head_norm=1.039030 delta_norm=0.236540
[S4] aggregate: ACCEPT kept=['S11', 'S3'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.4169 head_norm=1.157851
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.147808e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.6772 head_norm=1.317990 delta_norm=0.514781
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.6713 head_norm=0.781729
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.355294e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.6932 head_norm=0.786190 delta_norm=0.135529
[S2] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.3727 head_norm=0.766890
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.406112e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.3727 head_norm=0.683388 delta_norm=0.240611
[S8] aggregate: ACCEPT kept=['S4', 'S15', 'S17'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.3943 head_norm=1.246509
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.939626e-02
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.4029 head_norm=1.298155 delta_norm=0.089396
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=0.786190 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.150280 metrics={'f1_val': 0.7042238447951776, 'auprc': 0.776146544790022, 'loss_val': 0.7927607809219418, 'psi': 0.7329929247931154}-{'f1_val': 0.6713467585992524, 'auprc': 0.7769990921130324, 'loss_val': 0.8986163291104976, 'psi': 0.7136076920047645}
[S3] START round=13 head_norm_before_train=0.689391 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.6828249896129935, 'loss_val': 0.6687190740153515, 'psi': 0.6935837180863772}-{'f1_val': 0.6924880784557341, 'auprc': 0.7845686069548526, 'loss_val': 0.7435092474293999, 'psi': 0.7293202898553816}
[S4] START round=13 head_norm_before_train=1.039030 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.034909 metrics={'f1_val': 0.6921558838593244, 'auprc': 0.8754176028650679, 'loss_val': 0.8165672556567601, 'psi': 0.7654605714616218}-{'f1_val': 0.6905366030929678, 'auprc': 0.8792503105503144, 'loss_val': 0.8881677493462949, 'psi': 0.7660220860759065}
[S5] START round=13 head_norm_before_train=1.085403 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.032042 metrics={'f1_val': 0.7146937595824697, 'auprc': 0.7913683037152139, 'loss_val': 0.7351998650165413, 'psi': 0.7453635772355675}-{'f1_val': 0.7146937595824697, 'auprc': 0.794603524044659, 'loss_val': 0.8089890364853415, 'psi': 0.7466576653673455}
[S6] START round=13 head_norm_before_train=1.317990 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.897444 metrics={'f1_val': 0.6970424366194762, 'auprc': 0.9556697513857011, 'loss_val': 0.6234715134361559, 'psi': 0.8004933625259661}-{'f1_val': 0.4168533127370634, 'auprc': 0.9544415471882829, 'loss_val': 0.7335400002922811, 'psi': 0.6318886065175512}
[S7] START round=13 head_norm_before_train=1.298155 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.611114 metrics={'f1_val': 0.5805975558446108, 'auprc': 0.7879290280301325, 'loss_val': 1.0183311095798977, 'psi': 0.6635301447188195}-{'f1_val': 0.3942778226039638, 'auprc': 0.7889432853135113, 'loss_val': 1.1256827304921402, 'psi': 0.5521440076877828}
[S8] START round=13 head_norm_before_train=0.683388 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.3725978128855645, 'auprc': 0.9931154697916935, 'loss_val': 0.7114687059893756, 'psi': 0.6208048756480161}-{'f1_val': 0.37266438550987346, 'auprc': 0.9950150831185781, 'loss_val': 0.6953811385579454, 'psi': 0.6216046645533554}
[S9] START round=13 head_norm_before_train=1.232263 cos_to_last_merge=0.8540 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.854
[S9] round=13 local utility u=0.720880 metrics={'f1_val': 0.9534481130156474, 'auprc': 0.9907504710278142, 'loss_val': 0.2265615388883001, 'psi': 0.9683690562205141}-{'f1_val': 0.7700101109814215, 'auprc': 0.9436592053253201, 'loss_val': 0.42641994687751383, 'psi': 0.8394697487189808}
[S10] START round=13 head_norm_before_train=1.632046 (no previous merge yet)
[S10] round=13 local utility u=0.477194 metrics={'f1_val': 0.845917899378551, 'auprc': 0.9942373794260326, 'loss_val': 0.21239314502126966, 'psi': 0.9052456913975437}-{'f1_val': 0.6942624605763625, 'auprc': 0.9943501852551377, 'loss_val': 0.2571874880874194, 'psi': 0.8142975504478727}
[S11] START round=13 head_norm_before_train=1.629096 (no previous merge yet)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.9817338697876977, 'auprc': 0.9981451184469302, 'loss_val': 0.17295889518971536, 'psi': 0.9882983692513907}-{'f1_val': 0.9978104421256118, 'auprc': 0.9980242417709891, 'loss_val': 0.18945148035829562, 'psi': 0.9978959619837627}
[S13] START round=13 head_norm_before_train=1.557049 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6239282697949097, 'auprc': 0.6749989064417258, 'loss_val': 0.6508174217372229, 'psi': 0.6443565244536361}-{'f1_val': 0.7129214090912908, 'auprc': 0.6794397670952639, 'loss_val': 0.6514452515461695, 'psi': 0.6995287522928799}
[S14] START round=13 head_norm_before_train=1.353740 cos_to_last_merge=0.8943 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.894
[S14] round=13 local utility u=0.021312 metrics={'f1_val': 0.9975484281783746, 'auprc': 0.9972028521901576, 'loss_val': 0.23500863848650186, 'psi': 0.9974101977830878}-{'f1_val': 0.9970855096107042, 'auprc': 0.9977200349445154, 'loss_val': 0.27640606056279154, 'psi': 0.9973393197442286}
[S15] START round=13 head_norm_before_train=1.219459 cos_to_last_merge=0.8578 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.858
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.7013506818496502, 'auprc': 0.7993965147248334, 'loss_val': 0.46633117341684355, 'psi': 0.7405690149997235}-{'f1_val': 0.6997351160752733, 'auprc': 0.9174872731002228, 'loss_val': 0.37202717890466797, 'psi': 0.786835978885253}
[S16] START round=13 head_norm_before_train=1.571605 (no previous merge yet)
[S16] round=13 local utility u=0.415649 metrics={'f1_val': 0.5229117905568725, 'auprc': 0.7817916295928715, 'loss_val': 0.7823482346155349, 'psi': 0.6264637261712722}-{'f1_val': 0.3880212532488446, 'auprc': 0.7619347783492979, 'loss_val': 0.7447320070018353, 'psi': 0.5375866632890259}
[S17] START round=13 head_norm_before_train=1.154918 cos_to_last_merge=0.8317 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.832
[S17] round=13 local utility u=0.081055 metrics={'f1_val': 0.3458478966807962, 'auprc': 0.6659380965939643, 'loss_val': 0.9518121500409171, 'psi': 0.4738839766460634}-{'f1_val': 0.33695973228042597, 'auprc': 0.6438706904864863, 'loss_val': 0.9943914984684353, 'psi': 0.4597241155628501}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33903
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33903
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:33908
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:33907
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.9950
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=0.6825
[S10] RECEIVED delta(kind=head bytes=1799) from S9
[S10] cosine check vs S9: cos=-0.0327
[S10] DROPPED delta from S9 (cos=-0.0327 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] cosine check vs S16: cos=0.3277
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] cosine check vs S7: cos=0.8189
[S8] RECEIVED delta(kind=head bytes=1792) from S4
[S8] cosine check vs S4: cos=0.4298
[S6] RECEIVED delta(kind=head bytes=1805) from S10
[S6] cosine check vs S10: cos=0.9510
[S3] RECEIVED delta(kind=head bytes=1802) from S2
[S3] cosine check vs S2: cos=0.7178
[S5] RECEIVED delta(kind=head bytes=1799) from S6
[S5] cosine check vs S6: cos=0.9211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=0.3599
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.3726 head_norm=0.735823
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.476737e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.3726 head_norm=0.667294 delta_norm=0.347674
[S8] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.7008 head_norm=0.751928
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.498825e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.7008 head_norm=0.731420 delta_norm=0.149882
[S3] aggregate: ACCEPT kept=['S5', 'S2'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7147 head_norm=1.119726
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.695728e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7008 head_norm=1.209904 delta_norm=0.269573
[S5] aggregate: ROLLBACK (f1_val pre=0.715 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.7042 head_norm=0.834517
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.970507e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.7004 head_norm=1.028410 delta_norm=0.397051
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.6970 head_norm=1.348810
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.108542e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.6959 head_norm=1.229983 delta_norm=0.310854
[S6] aggregate: ACCEPT kept=['S16', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.5806 head_norm=1.316866
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.655593e-02
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.6083 head_norm=1.351014 delta_norm=0.076556
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.028410 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.041204 metrics={'f1_val': 0.7009202344192332, 'auprc': 0.776742629190455, 'loss_val': 0.6923186315542568, 'psi': 0.731249192327722}-{'f1_val': 0.7042238447951776, 'auprc': 0.776146544790022, 'loss_val': 0.7927607809219418, 'psi': 0.7329929247931154}
[S3] START round=14 head_norm_before_train=0.731420 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.661500324632321, 'loss_val': 0.6318147536048327, 'psi': 0.6849489674481815}-{'f1_val': 0.7007562037352997, 'auprc': 0.6828249896129935, 'loss_val': 0.6687190740153515, 'psi': 0.6935837180863772}
[S4] START round=14 head_norm_before_train=1.061359 cos_to_last_merge=0.9938 (last merge round=12)
[S4] round=14 local utility u=1.000000 metrics={'f1_val': 0.9781910416185591, 'auprc': 0.9341474123189901, 'loss_val': 0.6591622084026378, 'psi': 0.9605735898987315}-{'f1_val': 0.6921558838593244, 'auprc': 0.8754176028650679, 'loss_val': 0.8165672556567601, 'psi': 0.7654605714616218}
[S5] START round=14 head_norm_before_train=1.209904 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7008162875368863, 'auprc': 0.7704103131485707, 'loss_val': 0.6426285107017261, 'psi': 0.72865389778156}-{'f1_val': 0.7146937595824697, 'auprc': 0.7913683037152139, 'loss_val': 0.7351998650165413, 'psi': 0.7453635772355675}
[S6] START round=14 head_norm_before_train=1.229983 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.6917066107217116, 'auprc': 0.8006785925918662, 'loss_val': 0.5966476813796062, 'psi': 0.7352954034697734}-{'f1_val': 0.6970424366194762, 'auprc': 0.9556697513857011, 'loss_val': 0.6234715134361559, 'psi': 0.8004933625259661}
[S7] START round=14 head_norm_before_train=1.351014 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.431028 metrics={'f1_val': 0.707770744695613, 'auprc': 0.787353443406404, 'loss_val': 0.9175876569041255, 'psi': 0.7396038241799294}-{'f1_val': 0.5805975558446108, 'auprc': 0.7879290280301325, 'loss_val': 1.0183311095798977, 'psi': 0.6635301447188195}
[S8] START round=14 head_norm_before_train=0.667294 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.008559 metrics={'f1_val': 0.3725978128855645, 'auprc': 0.9953754386002971, 'loss_val': 0.7011300383928344, 'psi': 0.6217088631714576}-{'f1_val': 0.3725978128855645, 'auprc': 0.9931154697916935, 'loss_val': 0.7114687059893756, 'psi': 0.6208048756480161}
[S9] START round=14 head_norm_before_train=1.275112 cos_to_last_merge=0.8448 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.845
[S9] round=14 local utility u=0.173140 metrics={'f1_val': 0.9908021981609972, 'auprc': 0.9993240877521805, 'loss_val': 0.13012690659228515, 'psi': 0.9942109539974705}-{'f1_val': 0.9534481130156474, 'auprc': 0.9907504710278142, 'loss_val': 0.2265615388883001, 'psi': 0.9683690562205141}
[S10] START round=14 head_norm_before_train=1.654226 (no previous merge yet)
[S10] round=14 local utility u=0.102683 metrics={'f1_val': 0.8821321064106072, 'auprc': 0.9862644760670529, 'loss_val': 0.20039384732320598, 'psi': 0.9237850542731856}-{'f1_val': 0.845917899378551, 'auprc': 0.9942373794260326, 'loss_val': 0.21239314502126966, 'psi': 0.9052456913975437}
[S11] START round=14 head_norm_before_train=1.671234 (no previous merge yet)
[S11] round=14 local utility u=0.072698 metrics={'f1_val': 0.9965882633272201, 'auprc': 0.9987264284993581, 'loss_val': 0.11843406968851722, 'psi': 0.9974435293960753}-{'f1_val': 0.9817338697876977, 'auprc': 0.9981451184469302, 'loss_val': 0.17295889518971536, 'psi': 0.9882983692513907}
[S13] START round=14 head_norm_before_train=1.579777 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5863246042786009, 'auprc': 0.6343816781797003, 'loss_val': 0.679031765893337, 'psi': 0.6055474338390406}-{'f1_val': 0.6239282697949097, 'auprc': 0.6749989064417258, 'loss_val': 0.6508174217372229, 'psi': 0.6443565244536361}
[S14] START round=14 head_norm_before_train=1.388548 cos_to_last_merge=0.8889 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.889
[S14] round=14 local utility u=0.027174 metrics={'f1_val': 0.9976763577590866, 'auprc': 0.9971624236540211, 'loss_val': 0.18130754297066184, 'psi': 0.9974707841170604}-{'f1_val': 0.9975484281783746, 'auprc': 0.9972028521901576, 'loss_val': 0.23500863848650186, 'psi': 0.9974101977830878}
[S15] START round=14 head_norm_before_train=1.255735 cos_to_last_merge=0.8490 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.849
[S15] round=14 local utility u=0.427974 metrics={'f1_val': 0.7216442229279574, 'auprc': 0.9906817201582665, 'loss_val': 0.30600032166390845, 'psi': 0.829259221820081}-{'f1_val': 0.7013506818496502, 'auprc': 0.7993965147248334, 'loss_val': 0.46633117341684355, 'psi': 0.7405690149997235}
[S16] START round=14 head_norm_before_train=1.607604 (no previous merge yet)
[S16] round=14 local utility u=0.903772 metrics={'f1_val': 0.7682792342342812, 'auprc': 0.8267486084516789, 'loss_val': 0.5818789477123585, 'psi': 0.7916669839212402}-{'f1_val': 0.5229117905568725, 'auprc': 0.7817916295928715, 'loss_val': 0.7823482346155349, 'psi': 0.6264637261712722}
[S17] START round=14 head_norm_before_train=1.182245 cos_to_last_merge=0.8219 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.822
[S17] round=14 local utility u=0.035761 metrics={'f1_val': 0.35169382415044237, 'auprc': 0.6754257284269518, 'loss_val': 0.9438294624140372, 'psi': 0.4811865858610461}-{'f1_val': 0.3458478966807962, 'auprc': 0.6659380965939643, 'loss_val': 0.9518121500409171, 'psi': 0.4738839766460634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:33904
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:33902
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.9952
[S8] RECEIVED delta(kind=head bytes=1790) from S4
[S8] cosine check vs S4: cos=0.5623
[S2] RECEIVED delta(kind=head bytes=1797) from S8
[S2] cosine check vs S8: cos=0.4079
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] cosine check vs S15: cos=0.4970
[S2] RECEIVED delta(kind=head bytes=1804) from S7
[S2] cosine check vs S7: cos=0.9530
[S10] RECEIVED delta(kind=head bytes=1802) from S9
[S10] cosine check vs S9: cos=-0.0323
[S10] DROPPED delta from S9 (cos=-0.0323 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S10
[S6] cosine check vs S10: cos=0.8647
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=0.5266
[S3] RECEIVED delta(kind=head bytes=1801) from S2
[S3] cosine check vs S2: cos=0.6301
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9060
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.5992
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.7006 head_norm=0.790995
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.197108e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.6930 head_norm=0.842457 delta_norm=0.419711
[S3] aggregate: ROLLBACK (f1_val pre=0.701 post=0.693 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.6917 head_norm=1.266625
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.742396e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.6822 head_norm=1.221792 delta_norm=0.174240
[S6] aggregate: ROLLBACK (f1_val pre=0.692 post=0.682 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7009 head_norm=1.070565
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.944907e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7009 head_norm=0.946062 delta_norm=0.194491
[S2] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.3726 head_norm=0.715413
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.165146e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.3726 head_norm=0.695957 delta_norm=0.116515
[S8] aggregate: ACCEPT kept=['S4', 'S15', 'S17'] (k=3/3) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9782 head_norm=1.101528
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.256167e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.7128 head_norm=1.374074 delta_norm=0.425617
[S4] aggregate: ROLLBACK (f1_val pre=0.978 post=0.713 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.7078 head_norm=1.374145
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.257827e-02
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.7053 head_norm=1.396772 delta_norm=0.072578
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=0.946062 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7010315658334224, 'auprc': 0.7275509513612584, 'loss_val': 0.5833412964263102, 'psi': 0.7116393200445568}-{'f1_val': 0.7009202344192332, 'auprc': 0.776742629190455, 'loss_val': 0.6923186315542568, 'psi': 0.731249192327722}
[S3] START round=15 head_norm_before_train=0.842457 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.040974 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.6608568977281455, 'loss_val': 0.548984871800322, 'psi': 0.684796481332438}-{'f1_val': 0.7005813959920884, 'auprc': 0.661500324632321, 'loss_val': 0.6318147536048327, 'psi': 0.6849489674481815}
[S4] START round=15 head_norm_before_train=1.374074 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.006892 metrics={'f1_val': 0.9695411353133783, 'auprc': 0.9366033869614777, 'loss_val': 0.6008470725809213, 'psi': 0.956366035972618}-{'f1_val': 0.9781910416185591, 'auprc': 0.9341474123189901, 'loss_val': 0.6591622084026378, 'psi': 0.9605735898987315}
[S5] START round=15 head_norm_before_train=1.242495 cos_to_last_merge=0.9968 (last merge round=13)
[S5] round=15 local utility u=0.206673 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.8587228478529452, 'loss_val': 0.49273704104900945, 'psi': 0.7638306322473363}-{'f1_val': 0.7008162875368863, 'auprc': 0.7704103131485707, 'loss_val': 0.6426285107017261, 'psi': 0.72865389778156}
[S6] START round=15 head_norm_before_train=1.221792 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.319607 metrics={'f1_val': 0.69473569377108, 'auprc': 0.9648274159190683, 'loss_val': 0.4680542143996105, 'psi': 0.8027723826302753}-{'f1_val': 0.6917066107217116, 'auprc': 0.8006785925918662, 'loss_val': 0.5966476813796062, 'psi': 0.7352954034697734}
[S7] START round=15 head_norm_before_train=1.396772 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.5701197185359959, 'auprc': 0.792681226875434, 'loss_val': 0.8370342876567559, 'psi': 0.6591443218717712}-{'f1_val': 0.707770744695613, 'auprc': 0.787353443406404, 'loss_val': 0.9175876569041255, 'psi': 0.7396038241799294}
[S8] START round=15 head_norm_before_train=0.695957 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=1.000000 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9963015483655004, 'loss_val': 0.608498415280963, 'psi': 0.8268143863365562}-{'f1_val': 0.3725978128855645, 'auprc': 0.9953754386002971, 'loss_val': 0.7011300383928344, 'psi': 0.6217088631714576}
[S9] START round=15 head_norm_before_train=1.313591 cos_to_last_merge=0.8376 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.838
[S9] round=15 local utility u=0.026329 metrics={'f1_val': 0.9949999422209534, 'auprc': 0.9991169645456811, 'loss_val': 0.10203386758240493, 'psi': 0.9966467511508446}-{'f1_val': 0.9908021981609972, 'auprc': 0.9993240877521805, 'loss_val': 0.13012690659228515, 'psi': 0.9942109539974705}
[S10] START round=15 head_norm_before_train=1.669839 (no previous merge yet)
[S10] round=15 local utility u=0.240069 metrics={'f1_val': 0.9570324575565938, 'auprc': 0.9935696610095108, 'loss_val': 0.19157354984254932, 'psi': 0.9716473389377607}-{'f1_val': 0.8821321064106072, 'auprc': 0.9862644760670529, 'loss_val': 0.20039384732320598, 'psi': 0.9237850542731856}
[S11] START round=15 head_norm_before_train=1.710291 (no previous merge yet)
[S11] round=15 local utility u=0.021648 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9986623879077272, 'loss_val': 0.07482036528520931, 'psi': 0.9974054375468191}-{'f1_val': 0.9965882633272201, 'auprc': 0.9987264284993581, 'loss_val': 0.11843406968851722, 'psi': 0.9974435293960753}
[S13] START round=15 head_norm_before_train=1.604704 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5317412620733393, 'auprc': 0.7042025945931838, 'loss_val': 0.7626988993301574, 'psi': 0.6007257950812771}-{'f1_val': 0.5863246042786009, 'auprc': 0.6343816781797003, 'loss_val': 0.679031765893337, 'psi': 0.6055474338390406}
[S14] START round=15 head_norm_before_train=1.422745 cos_to_last_merge=0.8842 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.884
[S14] round=15 local utility u=0.017181 metrics={'f1_val': 0.9972408627570057, 'auprc': 0.9971559708684127, 'loss_val': 0.14431322010373668, 'psi': 0.9972069060015685}-{'f1_val': 0.9976763577590866, 'auprc': 0.9971624236540211, 'loss_val': 0.18130754297066184, 'psi': 0.9974707841170604}
[S15] START round=15 head_norm_before_train=1.284373 cos_to_last_merge=0.8422 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.842
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.7011987072828788, 'auprc': 0.7994656026051443, 'loss_val': 0.46643915946157516, 'psi': 0.7405054654117851}-{'f1_val': 0.7216442229279574, 'auprc': 0.9906817201582665, 'loss_val': 0.30600032166390845, 'psi': 0.829259221820081}
[S16] START round=15 head_norm_before_train=1.643170 (no previous merge yet)
[S16] round=15 local utility u=0.352173 metrics={'f1_val': 0.8578701832806511, 'auprc': 0.8702847263792801, 'loss_val': 0.5456868561116429, 'psi': 0.8628360005201027}-{'f1_val': 0.7682792342342812, 'auprc': 0.8267486084516789, 'loss_val': 0.5818789477123585, 'psi': 0.7916669839212402}
[S17] START round=15 head_norm_before_train=1.205234 cos_to_last_merge=0.8139 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=15 local utility u=0.045886 metrics={'f1_val': 0.35332495072624465, 'auprc': 0.6910424324613682, 'loss_val': 0.9086940933304207, 'psi': 0.4884119434202941}-{'f1_val': 0.35169382415044237, 'auprc': 0.6754257284269518, 'loss_val': 0.9438294624140372, 'psi': 0.4811865858610461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:33907
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:33905
[S8] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1793) from S3
[S4] cosine check vs S3: cos=0.1381
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] cosine check vs S5: cos=0.4291
[S5] RECEIVED delta(kind=head bytes=1796) from S6
[S5] cosine check vs S6: cos=0.9529
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=0.6251
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.9956
[S4] RECEIVED delta(kind=head bytes=1804) from S11
[S4] cosine check vs S11: cos=0.9724
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.4658
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=0.8002
[S2] RECEIVED delta(kind=head bytes=1801) from S8
[S2] cosine check vs S8: cos=0.5259
[S10] RECEIVED delta(kind=head bytes=1802) from S9
[S10] cosine check vs S9: cos=-0.0321
[S10] DROPPED delta from S9 (cos=-0.0321 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] cosine check vs S17: cos=0.5541
[S13] ⇄ pheromone p=0.184 → S6@127.0.0.1:33907
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7010 head_norm=0.994738
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.378636e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7010 head_norm=0.764006 delta_norm=0.437864
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.190 → S4@127.0.0.1:33904
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.5701 head_norm=1.423226
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.007362e-02
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.5728 head_norm=1.439748 delta_norm=0.070074
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.265 → S2@127.0.0.1:33902
[S14] ⇄ pheromone p=0.208 → S7@127.0.0.1:33908
[S9] ⇄ pheromone p=0.254 → S10@127.0.0.1:33911
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9695 head_norm=1.404346
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.198135e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9679 head_norm=1.175537 delta_norm=0.319813
[S4] aggregate: ACCEPT kept=['S3', 'S11'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.300 → S8@127.0.0.1:33909
[S10] ⇄ pheromone p=0.275 → S6@127.0.0.1:33907
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.7138 head_norm=0.749236
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.038473e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.5061 head_norm=0.769023 delta_norm=0.303847
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.506 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.314 → S2@127.0.0.1:33902
[S11] ⇄ pheromone p=0.254 → S4@127.0.0.1:33904
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.7008 head_norm=0.899093
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.055167e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.7007 head_norm=0.928452 delta_norm=0.605517
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.199 → S4@127.0.0.1:33904
[S16] ⇄ pheromone p=0.383 → S6@127.0.0.1:33907
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.6947 head_norm=1.256887
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.132592e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.6950 head_norm=1.231962 delta_norm=0.113259
[S6] aggregate: ACCEPT kept=['S16', 'S10'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.316 → S5@127.0.0.1:33905
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7006 head_norm=1.284125
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.955370e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7006 head_norm=1.255443 delta_norm=0.195537
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.250 → S3@127.0.0.1:33903
[S15] ⇄ pheromone p=0.219 → S8@127.0.0.1:33909
[S17] ⇄ pheromone p=0.108 → S8@127.0.0.1:33909
[S2] START round=16 head_norm_before_train=0.764006 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.700670614627973, 'auprc': 0.6687406523891801, 'loss_val': 0.5328179504636017, 'psi': 0.6878986297324559}-{'f1_val': 0.7010315658334224, 'auprc': 0.7275509513612584, 'loss_val': 0.5833412964263102, 'psi': 0.7116393200445568}
[S3] START round=16 head_norm_before_train=0.928452 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.5881721109751065, 'auprc': 0.5977612137388824, 'loss_val': 0.7245086144104014, 'psi': 0.5920077520806168}-{'f1_val': 0.7007562037352997, 'auprc': 0.6608568977281455, 'loss_val': 0.548984871800322, 'psi': 0.684796481332438}
[S4] START round=16 head_norm_before_train=1.175537 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.6821934625858349, 'auprc': 0.9590097487231393, 'loss_val': 0.6102815372141058, 'psi': 0.7929199770407567}-{'f1_val': 0.9695411353133783, 'auprc': 0.9366033869614777, 'loss_val': 0.6008470725809213, 'psi': 0.956366035972618}
[S5] START round=16 head_norm_before_train=1.255443 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.141122 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.942471194487131, 'loss_val': 0.4617379198866622, 'psi': 0.7973299709010107}-{'f1_val': 0.7005691551769304, 'auprc': 0.8587228478529452, 'loss_val': 0.49273704104900945, 'psi': 0.7638306322473363}
[S6] START round=16 head_norm_before_train=1.231962 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.7055152742906186, 'auprc': 0.7787611000161555, 'loss_val': 0.5383477542858277, 'psi': 0.7348136045808333}-{'f1_val': 0.69473569377108, 'auprc': 0.9648274159190683, 'loss_val': 0.4680542143996105, 'psi': 0.8027723826302753}
[S7] START round=16 head_norm_before_train=1.439748 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.045874 metrics={'f1_val': 0.577096594983085, 'auprc': 0.7921119104987733, 'loss_val': 0.7854398360494729, 'psi': 0.6631027211893603}-{'f1_val': 0.5701197185359959, 'auprc': 0.792681226875434, 'loss_val': 0.8370342876567559, 'psi': 0.6591443218717712}
[S8] START round=16 head_norm_before_train=0.769023 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.555237 metrics={'f1_val': 0.9023156077159017, 'auprc': 0.9962686210904461, 'loss_val': 0.6288820531840236, 'psi': 0.9398968130657195}-{'f1_val': 0.7138229449839267, 'auprc': 0.9963015483655004, 'loss_val': 0.608498415280963, 'psi': 0.8268143863365562}
[S9] START round=16 head_norm_before_train=1.352004 cos_to_last_merge=0.8312 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.831
[S9] round=16 local utility u=0.006620 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9993133010166714, 'loss_val': 0.08183700078496818, 'psi': 0.9959706254004936}-{'f1_val': 0.9949999422209534, 'auprc': 0.9991169645456811, 'loss_val': 0.10203386758240493, 'psi': 0.9966467511508446}
[S10] START round=16 head_norm_before_train=1.683249 (no previous merge yet)
[S10] round=16 local utility u=0.139112 metrics={'f1_val': 0.9930922374433311, 'auprc': 0.9976098708655675, 'loss_val': 0.14182921645547272, 'psi': 0.9948992908122256}-{'f1_val': 0.9570324575565938, 'auprc': 0.9935696610095108, 'loss_val': 0.19157354984254932, 'psi': 0.9716473389377607}
[S11] START round=16 head_norm_before_train=1.746410 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.9911394843430346, 'auprc': 0.9986030739778329, 'loss_val': 0.11831637371146958, 'psi': 0.9941249201969539}-{'f1_val': 0.996567470639547, 'auprc': 0.9986623879077272, 'loss_val': 0.07482036528520931, 'psi': 0.9974054375468191}
[S13] START round=16 head_norm_before_train=1.628567 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.5786131320277411, 'auprc': 0.5402267860386201, 'loss_val': 0.7005002364053666, 'psi': 0.5632585936320926}-{'f1_val': 0.5317412620733393, 'auprc': 0.7042025945931838, 'loss_val': 0.7626988993301574, 'psi': 0.6007257950812771}
[S14] START round=16 head_norm_before_train=1.459450 cos_to_last_merge=0.8794 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.879
[S14] round=16 local utility u=0.005322 metrics={'f1_val': 0.9977165309073976, 'auprc': 0.9971572348545992, 'loss_val': 0.13652649597672334, 'psi': 0.9974928124862783}-{'f1_val': 0.9972408627570057, 'auprc': 0.9971559708684127, 'loss_val': 0.14431322010373668, 'psi': 0.9972069060015685}
[S15] START round=16 head_norm_before_train=1.313982 cos_to_last_merge=0.8364 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.836
[S15] round=16 local utility u=0.009297 metrics={'f1_val': 0.6959946729886508, 'auprc': 0.7995566239024158, 'loss_val': 0.4168942918063448, 'psi': 0.7374194533541568}-{'f1_val': 0.7011987072828788, 'auprc': 0.7994656026051443, 'loss_val': 0.46643915946157516, 'psi': 0.7405054654117851}
[S16] START round=16 head_norm_before_train=1.675985 (no previous merge yet)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.8178869326452319, 'auprc': 0.8888506820554694, 'loss_val': 0.5421681241248286, 'psi': 0.8462724324093269}-{'f1_val': 0.8578701832806511, 'auprc': 0.8702847263792801, 'loss_val': 0.5456868561116429, 'psi': 0.8628360005201027}
[S17] START round=16 head_norm_before_train=1.223716 cos_to_last_merge=0.8071 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=16 local utility u=0.045383 metrics={'f1_val': 0.3536636833937797, 'auprc': 0.7149104577902075, 'loss_val': 0.89156458969783, 'psi': 0.4981623931523508}-{'f1_val': 0.35332495072624465, 'auprc': 0.6910424324613682, 'loss_val': 0.9086940933304207, 'psi': 0.4884119434202941}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:33907
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S5
[S6] cosine check vs S5: cos=0.9718
[S10] RECEIVED delta(kind=head bytes=1796) from S9
[S10] cosine check vs S9: cos=-0.0323
[S10] DROPPED delta from S9 (cos=-0.0323 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.9965
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] cosine check vs S15: cos=0.3438
[S6] RECEIVED delta(kind=head bytes=1799) from S10
[S6] cosine check vs S10: cos=0.7629
[S2] RECEIVED delta(kind=head bytes=1802) from S7
[S2] cosine check vs S7: cos=0.7098
[S2] RECEIVED delta(kind=head bytes=1796) from S8
[S2] cosine check vs S8: cos=0.7379
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.6280
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.7055 head_norm=1.261880
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.247182e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.7067 head_norm=1.309258 delta_norm=0.324718
[S6] aggregate: ACCEPT kept=['S5', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.7007 head_norm=0.823114
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.921307e-01
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.7005 head_norm=0.842932 delta_norm=0.192131
[S2] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.5771 head_norm=1.463538
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.391137e-02
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.5765 head_norm=1.479223 delta_norm=0.063911
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9023 head_norm=0.810427
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.570352e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.5466 head_norm=0.794171 delta_norm=0.357035
[S8] aggregate: ROLLBACK (f1_val pre=0.902 post=0.547 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=0.842932 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.031172 metrics={'f1_val': 0.7012120585667497, 'auprc': 0.6676109065607818, 'loss_val': 0.47033422564793376, 'psi': 0.6877715977643626}-{'f1_val': 0.700670614627973, 'auprc': 0.6687406523891801, 'loss_val': 0.5328179504636017, 'psi': 0.6878986297324559}
[S3] START round=17 head_norm_before_train=0.977105 cos_to_last_merge=0.9964 (last merge round=15)
[S3] round=17 local utility u=0.982884 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9428877973036175, 'loss_val': 0.4685769067335462, 'psi': 0.7975039565167}-{'f1_val': 0.5881721109751065, 'auprc': 0.5977612137388824, 'loss_val': 0.7245086144104014, 'psi': 0.5920077520806168}
[S4] START round=17 head_norm_before_train=1.208820 cos_to_last_merge=0.9968 (last merge round=15)
[S4] round=17 local utility u=0.902247 metrics={'f1_val': 0.9516602558619078, 'auprc': 0.9605975311961537, 'loss_val': 0.4273508704769695, 'psi': 0.9552351659956062}-{'f1_val': 0.6821934625858349, 'auprc': 0.9590097487231393, 'loss_val': 0.6102815372141058, 'psi': 0.7929199770407567}
[S5] START round=17 head_norm_before_train=1.292271 cos_to_last_merge=0.9984 (last merge round=15)
[S5] round=17 local utility u=0.085943 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9799141074028003, 'loss_val': 0.40242020059301786, 'psi': 0.8123310993645886}-{'f1_val': 0.7005691551769304, 'auprc': 0.942471194487131, 'loss_val': 0.4617379198866622, 'psi': 0.7973299709010107}
[S6] START round=17 head_norm_before_train=1.309258 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.6771819785728463, 'auprc': 0.7838349283829195, 'loss_val': 0.5405255160725965, 'psi': 0.7198431584968756}-{'f1_val': 0.7055152742906186, 'auprc': 0.7787611000161555, 'loss_val': 0.5383477542858277, 'psi': 0.7348136045808333}
[S7] START round=17 head_norm_before_train=1.479223 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.107793 metrics={'f1_val': 0.5197647388309095, 'auprc': 0.9857901324634781, 'loss_val': 0.8068982561477659, 'psi': 0.7061748962839369}-{'f1_val': 0.577096594983085, 'auprc': 0.7921119104987733, 'loss_val': 0.7854398360494729, 'psi': 0.6631027211893603}
[S8] START round=17 head_norm_before_train=0.794171 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9956557877389562, 'loss_val': 0.5107613592344307, 'psi': 0.8265560820859386}-{'f1_val': 0.9023156077159017, 'auprc': 0.9962686210904461, 'loss_val': 0.6288820531840236, 'psi': 0.9398968130657195}
[S9] START round=17 head_norm_before_train=1.389740 cos_to_last_merge=0.8246 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.825
[S9] round=17 local utility u=0.013323 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9974879923258254, 'loss_val': 0.06473852830622744, 'psi': 0.9967428659098616}-{'f1_val': 0.9937421749897083, 'auprc': 0.9993133010166714, 'loss_val': 0.08183700078496818, 'psi': 0.9959706254004936}
[S10] START round=17 head_norm_before_train=1.695853 (no previous merge yet)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.9931128813411993, 'auprc': 0.9935993416909714, 'loss_val': 0.16100915002942984, 'psi': 0.9933074654811083}-{'f1_val': 0.9930922374433311, 'auprc': 0.9976098708655675, 'loss_val': 0.14182921645547272, 'psi': 0.9948992908122256}
[S11] START round=17 head_norm_before_train=1.775086 (no previous merge yet)
[S11] round=17 local utility u=0.038623 metrics={'f1_val': 0.9961749345434856, 'auprc': 0.9979857553754018, 'loss_val': 0.06943150491715332, 'psi': 0.9968992628762521}-{'f1_val': 0.9911394843430346, 'auprc': 0.9986030739778329, 'loss_val': 0.11831637371146958, 'psi': 0.9941249201969539}
[S13] START round=17 head_norm_before_train=1.648761 (no previous merge yet)
[S13] round=17 local utility u=0.158992 metrics={'f1_val': 0.5656910627314493, 'auprc': 0.6818936991747792, 'loss_val': 0.7299839417598464, 'psi': 0.6121721173087813}-{'f1_val': 0.5786131320277411, 'auprc': 0.5402267860386201, 'loss_val': 0.7005002364053666, 'psi': 0.5632585936320926}
[S14] START round=17 head_norm_before_train=1.497474 cos_to_last_merge=0.8746 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.875
[S14] round=17 local utility u=0.002541 metrics={'f1_val': 0.995836807602862, 'auprc': 0.9957257712548281, 'loss_val': 0.11587190232366804, 'psi': 0.9957923930636484}-{'f1_val': 0.9977165309073976, 'auprc': 0.9971572348545992, 'loss_val': 0.13652649597672334, 'psi': 0.9974928124862783}
[S15] START round=17 head_norm_before_train=1.349507 cos_to_last_merge=0.8308 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.831
[S15] round=17 local utility u=0.000077 metrics={'f1_val': 0.696145912044978, 'auprc': 0.7997286867900911, 'loss_val': 0.41816314768934804, 'psi': 0.7375790219430233}-{'f1_val': 0.6959946729886508, 'auprc': 0.7995566239024158, 'loss_val': 0.4168942918063448, 'psi': 0.7374194533541568}
[S16] START round=17 head_norm_before_train=1.710025 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.8215891787891167, 'auprc': 0.8023918779329503, 'loss_val': 1.0142880829257306, 'psi': 0.8139102584466502}-{'f1_val': 0.8178869326452319, 'auprc': 0.8888506820554694, 'loss_val': 0.5421681241248286, 'psi': 0.8462724324093269}
[S17] START round=17 head_norm_before_train=1.238739 cos_to_last_merge=0.8017 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.802
[S17] round=17 local utility u=0.144237 metrics={'f1_val': 0.3769167571773587, 'auprc': 0.7615143624574455, 'loss_val': 0.8824199559575618, 'psi': 0.5307557992893934}-{'f1_val': 0.3536636833937797, 'auprc': 0.7149104577902075, 'loss_val': 0.89156458969783, 'psi': 0.4981623931523508}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:33914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:33907
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1791) from S3
[S5] cosine check vs S3: cos=0.8547
[S6] RECEIVED delta(kind=head bytes=1798) from S5
[S6] cosine check vs S5: cos=0.9796
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.9285
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=0.6837
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9975
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.7138 head_norm=0.845082
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.484275e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.7138 head_norm=0.801695 delta_norm=0.348428
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9958 head_norm=1.527636
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.499509e-02
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9952 head_norm=1.513404 delta_norm=0.054995
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.9962 head_norm=1.801789
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.956414e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.9962 head_norm=1.499559 delta_norm=0.395641
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.6772 head_norm=1.338167
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.345061e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.6721 head_norm=1.324930 delta_norm=0.134506
[S6] aggregate: ROLLBACK (f1_val pre=0.677 post=0.672 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7006 head_norm=1.325282
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.489323e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7003 head_norm=1.128044 delta_norm=0.348932
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=0.902259 cos_to_last_merge=0.9957 (last merge round=16)
[S2] round=18 local utility u=0.099006 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.7074192568010762, 'loss_val': 0.3923599483419065, 'psi': 0.703756212963917}-{'f1_val': 0.7012120585667497, 'auprc': 0.6676109065607818, 'loss_val': 0.47033422564793376, 'psi': 0.6877715977643626}
[S3] START round=18 head_norm_before_train=1.015924 cos_to_last_merge=0.9902 (last merge round=15)
[S3] round=18 local utility u=0.112674 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9942412680791778, 'loss_val': 0.39833741287707997, 'psi': 0.8181502294728509}-{'f1_val': 0.7005813959920884, 'auprc': 0.9428877973036175, 'loss_val': 0.4685769067335462, 'psi': 0.7975039565167}
[S4] START round=18 head_norm_before_train=1.250589 cos_to_last_merge=0.9891 (last merge round=15)
[S4] round=18 local utility u=0.074103 metrics={'f1_val': 0.9634024151551702, 'auprc': 0.9647676139338168, 'loss_val': 0.36210754894277086, 'psi': 0.9639484946666288}-{'f1_val': 0.9516602558619078, 'auprc': 0.9605975311961537, 'loss_val': 0.4273508704769695, 'psi': 0.9552351659956062}
[S5] START round=18 head_norm_before_train=1.128044 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7099342639255806, 'auprc': 0.791530819038736, 'loss_val': 0.5174086206384539, 'psi': 0.7425728859708427}-{'f1_val': 0.7006090940057808, 'auprc': 0.9799141074028003, 'loss_val': 0.40242020059301786, 'psi': 0.8123310993645886}
[S6] START round=18 head_norm_before_train=1.324930 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.390712 metrics={'f1_val': 0.6943065680333036, 'auprc': 0.9604191063725664, 'loss_val': 0.3916014185233892, 'psi': 0.8007515833690086}-{'f1_val': 0.6771819785728463, 'auprc': 0.7838349283829195, 'loss_val': 0.5405255160725965, 'psi': 0.7198431584968756}
[S7] START round=18 head_norm_before_train=1.501053 cos_to_last_merge=0.9995 (last merge round=16)
[S7] round=18 local utility u=0.102314 metrics={'f1_val': 0.5827831168480561, 'auprc': 0.8798897080522486, 'loss_val': 0.6626792752382553, 'psi': 0.7016257533297331}-{'f1_val': 0.5197647388309095, 'auprc': 0.9857901324634781, 'loss_val': 0.8068982561477659, 'psi': 0.7061748962839369}
[S8] START round=18 head_norm_before_train=0.801695 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.003083 metrics={'f1_val': 0.7139540394217572, 'auprc': 0.9929010376351342, 'loss_val': 0.49711854093494817, 'psi': 0.8255328387071079}-{'f1_val': 0.7138229449839267, 'auprc': 0.9956557877389562, 'loss_val': 0.5107613592344307, 'psi': 0.8265560820859386}
[S9] START round=18 head_norm_before_train=1.423640 cos_to_last_merge=0.8187 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.819
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9908329001136983, 'auprc': 0.9992991527098047, 'loss_val': 0.06346092711064473, 'psi': 0.9942194011521408}-{'f1_val': 0.9962461149658858, 'auprc': 0.9974879923258254, 'loss_val': 0.06473852830622744, 'psi': 0.9967428659098616}
[S10] START round=18 head_norm_before_train=1.707303 (no previous merge yet)
[S10] round=18 local utility u=0.032993 metrics={'f1_val': 0.9939801460484103, 'auprc': 0.9975759909107182, 'loss_val': 0.11215697457919653, 'psi': 0.9954184839933335}-{'f1_val': 0.9931128813411993, 'auprc': 0.9935993416909714, 'loss_val': 0.16100915002942984, 'psi': 0.9933074654811083}
[S11] START round=18 head_norm_before_train=1.499559 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.9920302199914537, 'auprc': 0.9986574400502107, 'loss_val': 0.1241702617971719, 'psi': 0.9946811080149565}-{'f1_val': 0.9961749345434856, 'auprc': 0.9979857553754018, 'loss_val': 0.06943150491715332, 'psi': 0.9968992628762521}
[S13] START round=18 head_norm_before_train=1.665450 (no previous merge yet)
[S13] round=18 local utility u=0.079882 metrics={'f1_val': 0.5863238943821818, 'auprc': 0.6769582023265601, 'loss_val': 0.6792101909682449, 'psi': 0.6225776175599331}-{'f1_val': 0.5656910627314493, 'auprc': 0.6818936991747792, 'loss_val': 0.7299839417598464, 'psi': 0.6121721173087813}
[S14] START round=18 head_norm_before_train=1.513404 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9575656700710635, 'auprc': 0.9970668239785596, 'loss_val': 0.12758200737275754, 'psi': 0.9733661316340619}-{'f1_val': 0.995836807602862, 'auprc': 0.9957257712548281, 'loss_val': 0.11587190232366804, 'psi': 0.9957923930636484}
[S15] START round=18 head_norm_before_train=1.383813 cos_to_last_merge=0.8254 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.825
[S15] round=18 local utility u=1.000000 metrics={'f1_val': 0.9791698095239929, 'auprc': 0.9892808312814959, 'loss_val': 0.18447183539352102, 'psi': 0.9832142182269942}-{'f1_val': 0.696145912044978, 'auprc': 0.7997286867900911, 'loss_val': 0.41816314768934804, 'psi': 0.7375790219430233}
[S16] START round=18 head_norm_before_train=1.743818 (no previous merge yet)
[S16] round=18 local utility u=1.000000 metrics={'f1_val': 0.9595698336570726, 'auprc': 0.9875404715912184, 'loss_val': 0.18670668004069818, 'psi': 0.9707580888307309}-{'f1_val': 0.8215891787891167, 'auprc': 0.8023918779329503, 'loss_val': 1.0142880829257306, 'psi': 0.8139102584466502}
[S17] START round=18 head_norm_before_train=1.258371 cos_to_last_merge=0.7962 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.796
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.3569861337265866, 'auprc': 0.7876331740718454, 'loss_val': 0.9306841046903985, 'psi': 0.5292449498646902}-{'f1_val': 0.3769167571773587, 'auprc': 0.7615143624574455, 'loss_val': 0.8824199559575618, 'psi': 0.5307557992893934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:33916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:33905
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:33914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:33912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:33910
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=0.5124
[S4] RECEIVED delta(kind=head bytes=1797) from S8
[S4] cosine check vs S8: cos=0.4169
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] cosine check vs S10: cos=-0.0333
[S9] DROPPED delta from S10 (cos=-0.0333 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.9979
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] cosine check vs S3: cos=0.9465
[S8] RECEIVED delta(kind=head bytes=1790) from S2
[S8] cosine check vs S2: cos=0.9036
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9642
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9576 head_norm=1.544288
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.089214e-02
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9564 head_norm=1.534846 delta_norm=0.050892
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.9920 head_norm=1.530398
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.226889e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.9918 head_norm=1.398776 delta_norm=0.222689
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7099 head_norm=1.161153
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.892306e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7131 head_norm=1.089233 delta_norm=0.189231
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.9596 head_norm=1.775808
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.935572e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.9102 head_norm=1.363043 delta_norm=0.793557
[S16] aggregate: ROLLBACK (f1_val pre=0.960 post=0.910 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.7140 head_norm=0.853461
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.068913e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.7140 head_norm=0.887156 delta_norm=0.206891
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9634 head_norm=1.292366
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.080587e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9617 head_norm=0.910806 delta_norm=0.608059
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S16
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S11
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S2] START round=19 head_norm_before_train=0.965041 cos_to_last_merge=0.9863 (last merge round=16)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7015730791798309, 'auprc': 0.6624864004360507, 'loss_val': 0.34136364654847967, 'psi': 0.6859384076823188}-{'f1_val': 0.7013141837391442, 'auprc': 0.7074192568010762, 'loss_val': 0.3923599483419065, 'psi': 0.703756212963917}
[S3] START round=19 head_norm_before_train=1.046993 cos_to_last_merge=0.9845 (last merge round=15)
[S3] round=19 local utility u=0.018540 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9992614673942635, 'loss_val': 0.37677199786287185, 'psi': 0.8202036279729918}-{'f1_val': 0.7007562037352997, 'auprc': 0.9942412680791778, 'loss_val': 0.39833741287707997, 'psi': 0.8181502294728509}
[S4] START round=19 head_norm_before_train=0.910806 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.021592 metrics={'f1_val': 0.9729824069587922, 'auprc': 0.9701217223544814, 'loss_val': 0.3924658918274434, 'psi': 0.9718381331170679}-{'f1_val': 0.9634024151551702, 'auprc': 0.9647676139338168, 'loss_val': 0.36210754894277086, 'psi': 0.9639484946666288}
[S5] START round=19 head_norm_before_train=1.089233 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.309780 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9715989301895913, 'loss_val': 0.38037590076466976, 'psi': 0.8088323625361848}-{'f1_val': 0.7099342639255806, 'auprc': 0.791530819038736, 'loss_val': 0.5174086206384539, 'psi': 0.7425728859708427}
[S6] START round=19 head_norm_before_train=1.349720 cos_to_last_merge=0.9996 (last merge round=17)
[S6] round=19 local utility u=0.024754 metrics={'f1_val': 0.6946076997137651, 'auprc': 0.9630922343174211, 'loss_val': 0.35192014481847667, 'psi': 0.8020015135552275}-{'f1_val': 0.6943065680333036, 'auprc': 0.9604191063725664, 'loss_val': 0.3916014185233892, 'psi': 0.8007515833690086}
[S7] START round=19 head_norm_before_train=1.527042 cos_to_last_merge=0.9981 (last merge round=16)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.513004940591836, 'auprc': 0.7615297951202888, 'loss_val': 0.9291832639098272, 'psi': 0.6124148824032172}-{'f1_val': 0.5827831168480561, 'auprc': 0.8798897080522486, 'loss_val': 0.6626792752382553, 'psi': 0.7016257533297331}
[S8] START round=19 head_norm_before_train=0.887156 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.907225 metrics={'f1_val': 0.9965034427716176, 'auprc': 0.9972973012492587, 'loss_val': 0.3911532817970649, 'psi': 0.996820986162674}-{'f1_val': 0.7139540394217572, 'auprc': 0.9929010376351342, 'loss_val': 0.49711854093494817, 'psi': 0.8255328387071079}
[S9] START round=19 head_norm_before_train=1.456959 cos_to_last_merge=0.8137 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.814
[S9] round=19 local utility u=0.022260 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9990723787036307, 'loss_val': 0.04842391235770401, 'psi': 0.9971450340072456}-{'f1_val': 0.9908329001136983, 'auprc': 0.9992991527098047, 'loss_val': 0.06346092711064473, 'psi': 0.9942194011521408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S9] r=20 psi=0.997 u=0.0223 p_local=0.1109 f1=0.996 auprc=0.999 bytes=32360
[S10] START round=19 head_norm_before_train=1.718818 (no previous merge yet)
[S10] round=19 local utility u=0.009894 metrics={'f1_val': 0.9959488122292768, 'auprc': 0.9973335068426195, 'loss_val': 0.10345271191347334, 'psi': 0.9965026900746139}-{'f1_val': 0.9939801460484103, 'auprc': 0.9975759909107182, 'loss_val': 0.11215697457919653, 'psi': 0.9954184839933335}
[S11] START round=19 head_norm_before_train=1.398776 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.026131 metrics={'f1_val': 0.9965882633272201, 'auprc': 0.9985028578413098, 'loss_val': 0.0987930534626971, 'psi': 0.9973541011328559}-{'f1_val': 0.9920302199914537, 'auprc': 0.9986574400502107, 'loss_val': 0.1241702617971719, 'psi': 0.9946811080149565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] r=20 psi=0.997 u=0.0261 p_local=0.1141 f1=0.997 auprc=0.999 bytes=25180
[S13] START round=19 head_norm_before_train=1.680221 (no previous merge yet)
[S13] round=19 local utility u=0.104862 metrics={'f1_val': 0.6219417056872633, 'auprc': 0.6548740148458777, 'loss_val': 0.6169403036598939, 'psi': 0.6351146293507091}-{'f1_val': 0.5863238943821818, 'auprc': 0.6769582023265601, 'loss_val': 0.6792101909682449, 'psi': 0.6225776175599331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S13] r=20 psi=0.635 u=0.1049 p_local=0.1293 f1=0.622 auprc=0.655 bytes=19728
[S14] START round=19 head_norm_before_train=1.534846 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.138036 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.996986333746139, 'loss_val': 0.08685539608451497, 'psi': 0.9968925815937825}-{'f1_val': 0.9575656700710635, 'auprc': 0.9970668239785596, 'loss_val': 0.12758200737275754, 'psi': 0.9733661316340619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S14] r=20 psi=0.997 u=0.1380 p_local=0.1138 f1=0.997 auprc=0.997 bytes=25171
[S15] START round=19 head_norm_before_train=1.418548 cos_to_last_merge=0.8198 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.820
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.7011578199677704, 'auprc': 0.8921116544854842, 'loss_val': 0.33963902397927365, 'psi': 0.777539353774856}-{'f1_val': 0.9791698095239929, 'auprc': 0.9892808312814959, 'loss_val': 0.18447183539352102, 'psi': 0.9832142182269942}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=20 psi=0.778 u=0.0000 p_local=0.2508 f1=0.701 auprc=0.892 bytes=23357
[S16] START round=19 head_norm_before_train=1.363043 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.9404680029876439, 'auprc': 0.9918944744502725, 'loss_val': 0.23833873762214897, 'psi': 0.9610385915726953}-{'f1_val': 0.9595698336570726, 'auprc': 0.9875404715912184, 'loss_val': 0.18670668004069818, 'psi': 0.9707580888307309}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=20 psi=0.961 u=0.0000 p_local=0.3170 f1=0.940 auprc=0.992 bytes=21565
[S17] START round=19 head_norm_before_train=1.273776 cos_to_last_merge=0.7919 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.792
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.3520371884697376, 'auprc': 0.8024017442977378, 'loss_val': 0.975984313826061, 'psi': 0.5321830108009377}-{'f1_val': 0.3569861337265866, 'auprc': 0.7876331740718454, 'loss_val': 0.9306841046903985, 'psi': 0.5292449498646902}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=20 psi=0.532 u=0.0000 p_local=0.0672 f1=0.352 auprc=0.802 bytes=21554
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:33910
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S5] → sending delta(kind=head bytes=1788) to S6@127.0.0.1:33907
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] r=20 psi=0.612 u=0.0000 p_local=0.1434 f1=0.513 auprc=0.762 bytes=26985
[S5] sending update (kind=head size=1788 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] cosine check vs S10: cos=-0.0338
[S9] DROPPED delta from S10 (cos=-0.0338 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1788) from S5
[S6] cosine check vs S5: cos=0.9009
[S5] r=20 psi=0.809 u=0.3098 p_local=0.1898 f1=0.700 auprc=0.972 bytes=26950
[S10] r=20 psi=0.997 u=0.0099 p_local=0.1339 f1=0.996 auprc=0.997 bytes=30540
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:33905
[S3] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] cosine check vs S3: cos=0.9803
[S2] r=20 psi=0.686 u=0.0000 p_local=0.0975 f1=0.702 auprc=0.662 bytes=23363
[S6] RoundReady barrier timeout: have=1 need=2 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:33916
[S3] CommDone barrier timeout: have=0 need=1 — continuing
[S3] r=20 psi=0.820 u=0.0185 p_local=0.2291 f1=0.701 auprc=0.999 bytes=19760
[S8] RoundReady barrier timeout: have=1 need=2 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:33904
[S4] RoundReady barrier timeout: have=1 need=2 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:33912
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1793) from S8
[S4] cosine check vs S8: cos=0.7572
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=0.8214
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.8684
[S3]  timeout peer S2
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S11
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S16
[S5]  timeout peer S6
[S7]  timeout peer S14
[S8]  timeout peer S4
[S8]  timeout peer S15
[S8]  timeout peer S17
[S2]  timeout peer S7
[S2]  timeout peer S8
[S3]  timeout peer S5
[S10]  timeout peer S9
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9730 head_norm=0.959819
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.301827e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9732 head_norm=0.887752 delta_norm=0.330183
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.972 u=0.0216 p_local=0.2546 f1=0.973 auprc=0.970 bytes=26917
[S8] r=20 psi=0.997 u=0.9072 p_local=0.3673 f1=0.997 auprc=0.997 bytes=28743
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.6946 head_norm=1.374135
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.045964e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.6946 head_norm=1.212910 delta_norm=0.304596
[S6] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] r=20 psi=0.802 u=0.0248 p_local=0.1968 f1=0.695 auprc=0.963 bytes=21562
[S2] START round=20 head_norm_before_train=1.020487 cos_to_last_merge=0.9765 (last merge round=16)
[S2] round=20 local utility u=0.054019 metrics={'f1_val': 0.7015730791798309, 'auprc': 0.6899775940107933, 'loss_val': 0.31579848606544964, 'psi': 0.6969348851122159}-{'f1_val': 0.7015730791798309, 'auprc': 0.6624864004360507, 'loss_val': 0.34136364654847967, 'psi': 0.6859384076823188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=20 head_norm_before_train=1.079546 cos_to_last_merge=0.9785 (last merge round=15)
[S3] round=20 local utility u=0.016568 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9990401222337293, 'loss_val': 0.3420664321269391, 'psi': 0.8200246246926925}-{'f1_val': 0.7008317350254774, 'auprc': 0.9992614673942635, 'loss_val': 0.37677199786287185, 'psi': 0.8202036279729918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=20 head_norm_before_train=0.887752 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9413782656266677, 'auprc': 0.9828442452777861, 'loss_val': 0.447897899075719, 'psi': 0.957964657487115}-{'f1_val': 0.9729824069587922, 'auprc': 0.9701217223544814, 'loss_val': 0.3924658918274434, 'psi': 0.9718381331170679}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=20 head_norm_before_train=1.113378 cos_to_last_merge=0.9997 (last merge round=18)
[S5] round=20 local utility u=0.004267 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9675009430041296, 'loss_val': 0.35954817590937777, 'psi': 0.8071931676620001}-{'f1_val': 0.7003213174339138, 'auprc': 0.9715989301895913, 'loss_val': 0.38037590076466976, 'psi': 0.8088323625361848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] sending update (kind=head size=1789 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.7003 head_norm=1.138802
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.176479e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.7003 head_norm=1.103315 delta_norm=0.117648
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] START round=20 head_norm_before_train=1.212910 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.335028 metrics={'f1_val': 0.8317594539965849, 'auprc': 0.9526210517171427, 'loss_val': 0.47336163894219874, 'psi': 0.8801040930848081}-{'f1_val': 0.6946076997137651, 'auprc': 0.9630922343174211, 'loss_val': 0.35192014481847667, 'psi': 0.8020015135552275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=20 head_norm_before_train=1.548882 cos_to_last_merge=0.9962 (last merge round=16)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.5171398342428941, 'auprc': 0.746846288133917, 'loss_val': 0.9904419713371155, 'psi': 0.6090224157993033}-{'f1_val': 0.513004940591836, 'auprc': 0.7615297951202888, 'loss_val': 0.9291832639098272, 'psi': 0.6124148824032172}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=20 head_norm_before_train=0.934343 cos_to_last_merge=0.9971 (last merge round=18)
[S8] round=20 local utility u=0.006202 metrics={'f1_val': 0.9846238771638012, 'auprc': 0.9989926292058116, 'loss_val': 0.3125576569499179, 'psi': 0.9903713779806053}-{'f1_val': 0.9965034427716176, 'auprc': 0.9972973012492587, 'loss_val': 0.3911532817970649, 'psi': 0.996820986162674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=20 head_norm_before_train=1.486117 cos_to_last_merge=0.8101 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.810
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9989316514288883, 'loss_val': 0.051047526348868104, 'psi': 0.9943252594956999}-{'f1_val': 0.9958601375429889, 'auprc': 0.9990723787036307, 'loss_val': 0.04842391235770401, 'psi': 0.9971450340072456}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=20 head_norm_before_train=1.735795 (no previous merge yet)
[S10] round=20 local utility u=0.008333 metrics={'f1_val': 0.9957292349169065, 'auprc': 0.9974900782345997, 'loss_val': 0.08593964243376025, 'psi': 0.9964335722439838}-{'f1_val': 0.9959488122292768, 'auprc': 0.9973335068426195, 'loss_val': 0.10345271191347334, 'psi': 0.9965026900746139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=20 head_norm_before_train=1.434957 cos_to_last_merge=0.9997 (last merge round=18)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.9961065187042659, 'auprc': 0.9987083805820515, 'loss_val': 0.10141693538478724, 'psi': 0.9971472634553802}-{'f1_val': 0.9965882633272201, 'auprc': 0.9985028578413098, 'loss_val': 0.0987930534626971, 'psi': 0.9973541011328559}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.9961 head_norm=1.479117
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.049715e-01
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.9959 head_norm=1.179203 delta_norm=0.404971
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] START round=20 head_norm_before_train=1.696720 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5112237097497079, 'auprc': 0.7230312041996028, 'loss_val': 0.9408278331953164, 'psi': 0.5959467075296658}-{'f1_val': 0.6219417056872633, 'auprc': 0.6548740148458777, 'loss_val': 0.6169403036598939, 'psi': 0.6351146293507091}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=20 head_norm_before_train=1.564443 cos_to_last_merge=0.9998 (last merge round=18)
[S14] round=20 local utility u=0.005416 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.996325739612102, 'loss_val': 0.07549854115034638, 'psi': 0.9967739765465846}-{'f1_val': 0.9968300801588782, 'auprc': 0.996986333746139, 'loss_val': 0.08685539608451497, 'psi': 0.9968925815937825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=20 head_norm_before_train=1.452389 cos_to_last_merge=0.8146 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.815
[S15] round=20 local utility u=0.862938 metrics={'f1_val': 0.9100901276616598, 'auprc': 0.9895238738618066, 'loss_val': 0.15959331832787244, 'psi': 0.9418636261417185}-{'f1_val': 0.7011578199677704, 'auprc': 0.8921116544854842, 'loss_val': 0.33963902397927365, 'psi': 0.777539353774856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=20 head_norm_before_train=1.400281 cos_to_last_merge=0.9994 (last merge round=18)
[S16] round=20 local utility u=0.198778 metrics={'f1_val': 0.9909326213901443, 'auprc': 0.9924101713549626, 'loss_val': 0.14511814752295787, 'psi': 0.9915236413760716}-{'f1_val': 0.9404680029876439, 'auprc': 0.9918944744502725, 'loss_val': 0.23833873762214897, 'psi': 0.9610385915726953}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9909 head_norm=1.448267
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.356399e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9880 head_norm=1.342788 delta_norm=0.435640
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] START round=20 head_norm_before_train=1.292608 cos_to_last_merge=0.7879 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.788
[S17] round=20 local utility u=0.166541 metrics={'f1_val': 0.38864898450661384, 'auprc': 0.8155029829906679, 'loss_val': 0.901876101530036, 'psi': 0.5593905839002354}-{'f1_val': 0.3520371884697376, 'auprc': 0.8024017442977378, 'loss_val': 0.975984313826061, 'psi': 0.5321830108009377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=21 head_norm_before_train=1.068529 cos_to_last_merge=0.9674 (last merge round=16)
[S2] round=21 local utility u=0.240086 metrics={'f1_val': 0.6686247945563881, 'auprc': 0.9685397959787149, 'loss_val': 0.4736227186875382, 'psi': 0.7885907951253188}-{'f1_val': 0.7015730791798309, 'auprc': 0.6899775940107933, 'loss_val': 0.31579848606544964, 'psi': 0.6969348851122159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=21 head_norm_before_train=1.112974 cos_to_last_merge=0.9720 (last merge round=15)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.6444398547791242, 'auprc': 0.89077828429613, 'loss_val': 0.5257814512666856, 'psi': 0.7429752265859266}-{'f1_val': 0.7006809596653347, 'auprc': 0.9990401222337293, 'loss_val': 0.3420664321269391, 'psi': 0.8200246246926925}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=21 head_norm_before_train=0.934500 cos_to_last_merge=0.9964 (last merge round=19)
[S4] round=21 local utility u=0.044330 metrics={'f1_val': 0.9453036722123743, 'auprc': 0.9748245501554124, 'loss_val': 0.3587304474950114, 'psi': 0.9571120233895896}-{'f1_val': 0.9413782656266677, 'auprc': 0.9828442452777861, 'loss_val': 0.447897899075719, 'psi': 0.957964657487115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=21 head_norm_before_train=1.103315 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.043025 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9898702668737949, 'loss_val': 0.34060618443395013, 'psi': 0.8161408972098663}-{'f1_val': 0.7003213174339138, 'auprc': 0.9675009430041296, 'loss_val': 0.35954817590937777, 'psi': 0.8071931676620001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=21 head_norm_before_train=1.235294 cos_to_last_merge=0.9996 (last merge round=19)
[S6] round=21 local utility u=0.447391 metrics={'f1_val': 0.9619113769576157, 'auprc': 0.9538449777004542, 'loss_val': 0.3631629556372364, 'psi': 0.9586848172547512}-{'f1_val': 0.8317594539965849, 'auprc': 0.9526210517171427, 'loss_val': 0.47336163894219874, 'psi': 0.8801040930848081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=21 head_norm_before_train=1.564480 cos_to_last_merge=0.9947 (last merge round=16)
[S7] round=21 local utility u=0.359620 metrics={'f1_val': 0.5728165891294352, 'auprc': 0.7940095417509069, 'loss_val': 0.7467517880852987, 'psi': 0.6612937701780239}-{'f1_val': 0.5171398342428941, 'auprc': 0.746846288133917, 'loss_val': 0.9904419713371155, 'psi': 0.6090224157993033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=21 head_norm_before_train=0.982186 cos_to_last_merge=0.9904 (last merge round=18)
[S8] round=21 local utility u=0.064392 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.99898263758585, 'loss_val': 0.25411866032431235, 'psi': 0.9974048999957148}-{'f1_val': 0.9846238771638012, 'auprc': 0.9989926292058116, 'loss_val': 0.3125576569499179, 'psi': 0.9903713779806053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=21 head_norm_before_train=1.510344 cos_to_last_merge=0.8076 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.808
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9849970844012769, 'auprc': 0.9881800380914705, 'loss_val': 0.0732724916539715, 'psi': 0.9862702658773543}-{'f1_val': 0.991254331540241, 'auprc': 0.9989316514288883, 'loss_val': 0.051047526348868104, 'psi': 0.9943252594956999}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=21 head_norm_before_train=1.752935 (no previous merge yet)
[S10] round=21 local utility u=0.005532 metrics={'f1_val': 0.9952903046828353, 'auprc': 0.9972456592079126, 'loss_val': 0.07150853458883931, 'psi': 0.9960724464928662}-{'f1_val': 0.9957292349169065, 'auprc': 0.9974900782345997, 'loss_val': 0.08593964243376025, 'psi': 0.9964335722439838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=21 head_norm_before_train=1.179203 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9983569347636547, 'loss_val': 0.13069131671173342, 'psi': 0.9971381537185297}-{'f1_val': 0.9961065187042659, 'auprc': 0.9987083805820515, 'loss_val': 0.10141693538478724, 'psi': 0.9971472634553802}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=21 head_norm_before_train=1.709103 (no previous merge yet)
[S13] round=21 local utility u=0.296822 metrics={'f1_val': 0.5951214042482873, 'auprc': 0.6704010989928677, 'loss_val': 0.6926797897645403, 'psi': 0.6252332821461195}-{'f1_val': 0.5112237097497079, 'auprc': 0.7230312041996028, 'loss_val': 0.9408278331953164, 'psi': 0.5959467075296658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=21 head_norm_before_train=1.594067 cos_to_last_merge=0.9993 (last merge round=18)
[S14] round=21 local utility u=0.007725 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969288680363995, 'loss_val': 0.06286322231286597, 'psi': 0.9971157612380357}-{'f1_val': 0.9970728011695729, 'auprc': 0.996325739612102, 'loss_val': 0.07549854115034638, 'psi': 0.9967739765465846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=21 head_norm_before_train=1.485880 cos_to_last_merge=0.8100 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.810
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7600166214363601, 'auprc': 0.9441877204379393, 'loss_val': 0.31391153014066764, 'psi': 0.8336850610369917}-{'f1_val': 0.9100901276616598, 'auprc': 0.9895238738618066, 'loss_val': 0.15959331832787244, 'psi': 0.9418636261417185}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=1.342788 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.9406975768640811, 'auprc': 0.9955513280473272, 'loss_val': 0.23498831742377801, 'psi': 0.9626390773373795}-{'f1_val': 0.9909326213901443, 'auprc': 0.9924101713549626, 'loss_val': 0.14511814752295787, 'psi': 0.9915236413760716}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=21 head_norm_before_train=1.313514 cos_to_last_merge=0.7840 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.784
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.359445021485176, 'auprc': 0.7148654827003191, 'loss_val': 1.1050130174045238, 'psi': 0.5016132059712333}-{'f1_val': 0.38864898450661384, 'auprc': 0.8155029829906679, 'loss_val': 0.901876101530036, 'psi': 0.5593905839002354}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=22 head_norm_before_train=1.108051 cos_to_last_merge=0.9607 (last merge round=16)
[S2] round=22 local utility u=0.025002 metrics={'f1_val': 0.7016512288906386, 'auprc': 0.8595458756054736, 'loss_val': 0.294795986562643, 'psi': 0.7648090875765725}-{'f1_val': 0.6686247945563881, 'auprc': 0.9685397959787149, 'loss_val': 0.4736227186875382, 'psi': 0.7885907951253188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=22 head_norm_before_train=1.137534 cos_to_last_merge=0.9670 (last merge round=15)
[S3] round=22 local utility u=0.440213 metrics={'f1_val': 0.7002765683645327, 'auprc': 0.9981254779635773, 'loss_val': 0.3024173854788407, 'psi': 0.8194161322041504}-{'f1_val': 0.6444398547791242, 'auprc': 0.89077828429613, 'loss_val': 0.5257814512666856, 'psi': 0.7429752265859266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=22 head_norm_before_train=0.983005 cos_to_last_merge=0.9887 (last merge round=19)
[S4] round=22 local utility u=0.022643 metrics={'f1_val': 0.9417068963214128, 'auprc': 0.9776128557592811, 'loss_val': 0.300228704347399, 'psi': 0.9560692800965601}-{'f1_val': 0.9453036722123743, 'auprc': 0.9748245501554124, 'loss_val': 0.3587304474950114, 'psi': 0.9571120233895896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=22 head_norm_before_train=1.132192 cos_to_last_merge=0.9994 (last merge round=20)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.700661579346747, 'auprc': 0.8336563489475144, 'loss_val': 0.4013933684700153, 'psi': 0.753859487187054}-{'f1_val': 0.7003213174339138, 'auprc': 0.9898702668737949, 'loss_val': 0.34060618443395013, 'psi': 0.8161408972098663}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=1.257245 cos_to_last_merge=0.9986 (last merge round=19)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.41604531394212996, 'auprc': 0.8948926408728262, 'loss_val': 1.157389750068221, 'psi': 0.6075842447144084}-{'f1_val': 0.9619113769576157, 'auprc': 0.9538449777004542, 'loss_val': 0.3631629556372364, 'psi': 0.9586848172547512}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=22 head_norm_before_train=1.575501 cos_to_last_merge=0.9937 (last merge round=16)
[S7] round=22 local utility u=0.908844 metrics={'f1_val': 0.6997906003834956, 'auprc': 0.9928651542975981, 'loss_val': 0.2874747166890656, 'psi': 0.8170204219491366}-{'f1_val': 0.5728165891294352, 'auprc': 0.7940095417509069, 'loss_val': 0.7467517880852987, 'psi': 0.6612937701780239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=22 head_norm_before_train=1.025583 cos_to_last_merge=0.9828 (last merge round=18)
[S8] round=22 local utility u=0.010249 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9959031732364781, 'loss_val': 0.22348237689110134, 'psi': 0.996083131334683}-{'f1_val': 0.9963530749356245, 'auprc': 0.99898263758585, 'loss_val': 0.25411866032431235, 'psi': 0.9974048999957148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=22 head_norm_before_train=1.525567 cos_to_last_merge=0.8056 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.806
[S9] round=22 local utility u=0.064948 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9956980595696715, 'loss_val': 0.03856650457242157, 'psi': 0.9965409713351543}-{'f1_val': 0.9849970844012769, 'auprc': 0.9881800380914705, 'loss_val': 0.0732724916539715, 'psi': 0.9862702658773543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=22 head_norm_before_train=1.774750 (no previous merge yet)
[S10] round=22 local utility u=0.005620 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9966797427549113, 'loss_val': 0.05998370375807245, 'psi': 0.9959874420564316}-{'f1_val': 0.9952903046828353, 'auprc': 0.9972456592079126, 'loss_val': 0.07150853458883931, 'psi': 0.9960724464928662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=22 head_norm_before_train=1.229403 cos_to_last_merge=0.9991 (last merge round=20)
[S11] round=22 local utility u=0.011374 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9987101753977905, 'loss_val': 0.11045412056249579, 'psi': 0.9974245525428445}-{'f1_val': 0.9963256330217796, 'auprc': 0.9983569347636547, 'loss_val': 0.13069131671173342, 'psi': 0.9971381537185297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=22 head_norm_before_train=1.717293 (no previous merge yet)
[S13] round=22 local utility u=0.165903 metrics={'f1_val': 0.6468165639953278, 'auprc': 0.6395543619403533, 'loss_val': 0.5785038979404186, 'psi': 0.643911683173338}-{'f1_val': 0.5951214042482873, 'auprc': 0.6704010989928677, 'loss_val': 0.6926797897645403, 'psi': 0.6252332821461195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=22 head_norm_before_train=1.623580 cos_to_last_merge=0.9985 (last merge round=18)
[S14] round=22 local utility u=0.002817 metrics={'f1_val': 0.9968524173284324, 'auprc': 0.9968037613299368, 'loss_val': 0.05452541356699131, 'psi': 0.9968329549290342}-{'f1_val': 0.997240356705793, 'auprc': 0.9969288680363995, 'loss_val': 0.06286322231286597, 'psi': 0.9971157612380357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=22 head_norm_before_train=1.515150 cos_to_last_merge=0.8067 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.807
[S15] round=22 local utility u=0.137069 metrics={'f1_val': 0.776158736578117, 'auprc': 0.9883030925740817, 'loss_val': 0.26897234100686923, 'psi': 0.8610164789765029}-{'f1_val': 0.7600166214363601, 'auprc': 0.9441877204379393, 'loss_val': 0.31391153014066764, 'psi': 0.8336850610369917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S16] START round=22 head_norm_before_train=1.391317 cos_to_last_merge=0.9989 (last merge round=20)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8328950546046422, 'auprc': 0.8952132794966317, 'loss_val': 0.7335436104950602, 'psi': 0.8578223445614379}-{'f1_val': 0.9406975768640811, 'auprc': 0.9955513280473272, 'loss_val': 0.23498831742377801, 'psi': 0.9626390773373795}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=1.340366 cos_to_last_merge=0.7809 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.781
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.2127032174572389, 'auprc': 0.6802406512947303, 'loss_val': 1.6855374989748806, 'psi': 0.3997181909922355}-{'f1_val': 0.359445021485176, 'auprc': 0.7148654827003191, 'loss_val': 1.1050130174045238, 'psi': 0.5016132059712333}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=23 head_norm_before_train=1.139476 cos_to_last_merge=0.9552 (last merge round=16)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6638918639371911, 'loss_val': 0.28752924790856893, 'psi': 0.6864993809980255}-{'f1_val': 0.7016512288906386, 'auprc': 0.8595458756054736, 'loss_val': 0.294795986562643, 'psi': 0.7648090875765725}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=23 head_norm_before_train=1.153794 cos_to_last_merge=0.9636 (last merge round=15)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.5566080382041729, 'auprc': 0.8236199482348283, 'loss_val': 0.5900148297587154, 'psi': 0.6634128022164351}-{'f1_val': 0.7002765683645327, 'auprc': 0.9981254779635773, 'loss_val': 0.3024173854788407, 'psi': 0.8194161322041504}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=1.037669 cos_to_last_merge=0.9783 (last merge round=19)
[S4] round=23 local utility u=0.034215 metrics={'f1_val': 0.9492479408429105, 'auprc': 0.9788237644587844, 'loss_val': 0.28067789448326974, 'psi': 0.9610782702892601}-{'f1_val': 0.9417068963214128, 'auprc': 0.9776128557592811, 'loss_val': 0.300228704347399, 'psi': 0.9560692800965601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=23 head_norm_before_train=1.161017 cos_to_last_merge=0.9981 (last merge round=20)
[S5] round=23 local utility u=0.286583 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9921002094342404, 'loss_val': 0.3015180890657886, 'psi': 0.8170328742340445}-{'f1_val': 0.700661579346747, 'auprc': 0.8336563489475144, 'loss_val': 0.4013933684700153, 'psi': 0.753859487187054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] START round=23 head_norm_before_train=1.280045 cos_to_last_merge=0.9970 (last merge round=19)
[S6] round=23 local utility u=1.000000 metrics={'f1_val': 0.8810738165495694, 'auprc': 0.9552342768269986, 'loss_val': 0.3387184686568248, 'psi': 0.9107380006605411}-{'f1_val': 0.41604531394212996, 'auprc': 0.8948926408728262, 'loss_val': 1.157389750068221, 'psi': 0.6075842447144084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=23 head_norm_before_train=1.585920 cos_to_last_merge=0.9930 (last merge round=16)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.4004485133202371, 'auprc': 0.7285475596190081, 'loss_val': 1.237647734177103, 'psi': 0.5316881318397455}-{'f1_val': 0.6997906003834956, 'auprc': 0.9928651542975981, 'loss_val': 0.2874747166890656, 'psi': 0.8170204219491366}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=23 head_norm_before_train=1.063684 cos_to_last_merge=0.9755 (last merge round=18)
[S8] round=23 local utility u=0.019366 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9992167979173335, 'loss_val': 0.1955903790669485, 'psi': 0.9974985641283082}-{'f1_val': 0.9962031034001528, 'auprc': 0.9959031732364781, 'loss_val': 0.22348237689110134, 'psi': 0.996083131334683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=23 head_norm_before_train=1.535155 cos_to_last_merge=0.8041 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.804
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.988413286695067, 'auprc': 0.9980498031396634, 'loss_val': 0.054726902171674245, 'psi': 0.9922678932729055}-{'f1_val': 0.9971029125121428, 'auprc': 0.9956980595696715, 'loss_val': 0.03856650457242157, 'psi': 0.9965409713351543}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=23 head_norm_before_train=1.797489 (no previous merge yet)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9947781979029806, 'auprc': 0.9940947739612706, 'loss_val': 0.058638262157268375, 'psi': 0.9945048283262965}-{'f1_val': 0.9955259082574451, 'auprc': 0.9966797427549113, 'loss_val': 0.05998370375807245, 'psi': 0.9959874420564316}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=23 head_norm_before_train=1.277385 cos_to_last_merge=0.9970 (last merge round=20)
[S11] round=23 local utility u=0.010318 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9984320272512663, 'loss_val': 0.08753231862342478, 'psi': 0.9971681907135743}-{'f1_val': 0.996567470639547, 'auprc': 0.9987101753977905, 'loss_val': 0.11045412056249579, 'psi': 0.9974245525428445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=23 head_norm_before_train=1.723567 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5606122035617948, 'auprc': 0.6875989279558936, 'loss_val': 0.7844395008163176, 'psi': 0.6114068933194343}-{'f1_val': 0.6468165639953278, 'auprc': 0.6395543619403533, 'loss_val': 0.5785038979404186, 'psi': 0.643911683173338}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=23 head_norm_before_train=1.649992 cos_to_last_merge=0.9975 (last merge round=18)
[S14] round=23 local utility u=0.002762 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9970508866188363, 'loss_val': 0.04960836016927998, 'psi': 0.9969184027428615}-{'f1_val': 0.9968524173284324, 'auprc': 0.9968037613299368, 'loss_val': 0.05452541356699131, 'psi': 0.9968329549290342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=23 head_norm_before_train=1.546268 cos_to_last_merge=0.8037 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.804
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6979203908227263, 'auprc': 0.8344091105018678, 'loss_val': 0.4600583647832878, 'psi': 0.7525158786943829}-{'f1_val': 0.776158736578117, 'auprc': 0.9883030925740817, 'loss_val': 0.26897234100686923, 'psi': 0.8610164789765029}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=1.443315 cos_to_last_merge=0.9960 (last merge round=20)
[S16] round=23 local utility u=0.934021 metrics={'f1_val': 0.9904153271608916, 'auprc': 0.99346738616429, 'loss_val': 0.10538480424442077, 'psi': 0.991636150762251}-{'f1_val': 0.8328950546046422, 'auprc': 0.8952132794966317, 'loss_val': 0.7335436104950602, 'psi': 0.8578223445614379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=23 head_norm_before_train=1.369967 cos_to_last_merge=0.7780 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.778
[S17] round=23 local utility u=0.964109 metrics={'f1_val': 0.36900014762070793, 'auprc': 0.8083882397314208, 'loss_val': 1.0795444360780972, 'psi': 0.544755384464993}-{'f1_val': 0.2127032174572389, 'auprc': 0.6802406512947303, 'loss_val': 1.6855374989748806, 'psi': 0.3997181909922355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=24 head_norm_before_train=1.165313 cos_to_last_merge=0.9507 (last merge round=16)
[S2] round=24 local utility u=0.002600 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.6658930241141383, 'loss_val': 0.2878563982773093, 'psi': 0.6872522993839629}-{'f1_val': 0.7015710590385817, 'auprc': 0.6638918639371911, 'loss_val': 0.28752924790856893, 'psi': 0.6864993809980255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=24 head_norm_before_train=1.169025 cos_to_last_merge=0.9607 (last merge round=15)
[S3] round=24 local utility u=0.795673 metrics={'f1_val': 0.6995786553134029, 'auprc': 0.9844404088980776, 'loss_val': 0.33895473248003605, 'psi': 0.8135233567472728}-{'f1_val': 0.5566080382041729, 'auprc': 0.8236199482348283, 'loss_val': 0.5900148297587154, 'psi': 0.6634128022164351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=24 head_norm_before_train=1.094916 cos_to_last_merge=0.9675 (last merge round=19)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9411561565867217, 'auprc': 0.9749446755006755, 'loss_val': 0.25079072630312577, 'psi': 0.9546715641523031}-{'f1_val': 0.9492479408429105, 'auprc': 0.9788237644587844, 'loss_val': 0.28067789448326974, 'psi': 0.9610782702892601}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=24 head_norm_before_train=1.181932 cos_to_last_merge=0.9967 (last merge round=20)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8368503070024532, 'loss_val': 0.3775034470388294, 'psi': 0.7549324818957968}-{'f1_val': 0.7003213174339138, 'auprc': 0.9921002094342404, 'loss_val': 0.3015180890657886, 'psi': 0.8170328742340445}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=24 head_norm_before_train=1.294673 cos_to_last_merge=0.9957 (last merge round=19)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.6148192320143615, 'auprc': 0.9212570322276595, 'loss_val': 0.5038231814742398, 'psi': 0.7373943520996807}-{'f1_val': 0.8810738165495694, 'auprc': 0.9552342768269986, 'loss_val': 0.3387184686568248, 'psi': 0.9107380006605411}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=1.591544 cos_to_last_merge=0.9925 (last merge round=16)
[S7] round=24 local utility u=1.000000 metrics={'f1_val': 0.6872174982587562, 'auprc': 0.900284969069746, 'loss_val': 0.38939168076081265, 'psi': 0.7724444865831521}-{'f1_val': 0.4004485133202371, 'auprc': 0.7285475596190081, 'loss_val': 1.237647734177103, 'psi': 0.5316881318397455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=24 head_norm_before_train=1.097814 cos_to_last_merge=0.9688 (last merge round=18)
[S8] round=24 local utility u=0.015026 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9981092143607697, 'loss_val': 0.16131610805604316, 'psi': 0.9969655477843996}-{'f1_val': 0.9963530749356245, 'auprc': 0.9992167979173335, 'loss_val': 0.1955903790669485, 'psi': 0.9974985641283082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=24 head_norm_before_train=1.549551 cos_to_last_merge=0.8029 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.803
[S9] round=24 local utility u=0.028212 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9946696970579637, 'loss_val': 0.03518436834900239, 'psi': 0.9956179356907521}-{'f1_val': 0.988413286695067, 'auprc': 0.9980498031396634, 'loss_val': 0.054726902171674245, 'psi': 0.9922678932729055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=24 head_norm_before_train=1.818488 (no previous merge yet)
[S10] round=24 local utility u=0.004900 metrics={'f1_val': 0.993924439075923, 'auprc': 0.997393987205664, 'loss_val': 0.05361376892653767, 'psi': 0.9953122583278193}-{'f1_val': 0.9947781979029806, 'auprc': 0.9940947739612706, 'loss_val': 0.058638262157268375, 'psi': 0.9945048283262965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=24 head_norm_before_train=1.318680 cos_to_last_merge=0.9945 (last merge round=20)
[S11] round=24 local utility u=0.005975 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9987391385099464, 'loss_val': 0.07795546974587826, 'psi': 0.9974361377877068}-{'f1_val': 0.9963256330217796, 'auprc': 0.9984320272512663, 'loss_val': 0.08753231862342478, 'psi': 0.9971681907135743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=24 head_norm_before_train=1.729094 (no previous merge yet)
[S13] round=24 local utility u=0.117116 metrics={'f1_val': 0.5890370299249874, 'auprc': 0.6818373536315303, 'loss_val': 0.7034717836908989, 'psi': 0.6261571594076045}-{'f1_val': 0.5606122035617948, 'auprc': 0.6875989279558936, 'loss_val': 0.7844395008163176, 'psi': 0.6114068933194343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=24 head_norm_before_train=1.675619 cos_to_last_merge=0.9965 (last merge round=18)
[S14] round=24 local utility u=0.003299 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969664097949928, 'loss_val': 0.045217874496928476, 'psi': 0.997130777941473}-{'f1_val': 0.9968300801588782, 'auprc': 0.9970508866188363, 'loss_val': 0.04960836016927998, 'psi': 0.9969184027428615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=24 head_norm_before_train=1.575919 cos_to_last_merge=0.8010 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.801
[S15] round=24 local utility u=1.000000 metrics={'f1_val': 0.986249753819943, 'auprc': 0.996744785031707, 'loss_val': 0.08543949365084047, 'psi': 0.9904477663046486}-{'f1_val': 0.6979203908227263, 'auprc': 0.8344091105018678, 'loss_val': 0.4600583647832878, 'psi': 0.7525158786943829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=24 head_norm_before_train=1.490680 cos_to_last_merge=0.9925 (last merge round=20)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8473125135639756, 'auprc': 0.9649060352784995, 'loss_val': 0.43397615787294114, 'psi': 0.8943499222497853}-{'f1_val': 0.9904153271608916, 'auprc': 0.99346738616429, 'loss_val': 0.10538480424442077, 'psi': 0.991636150762251}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=24 head_norm_before_train=1.395445 cos_to_last_merge=0.7744 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.774
[S17] round=24 local utility u=0.125145 metrics={'f1_val': 0.39416029922671647, 'auprc': 0.8110667236222868, 'loss_val': 0.9882506468725998, 'psi': 0.5609228689849446}-{'f1_val': 0.36900014762070793, 'auprc': 0.8083882397314208, 'loss_val': 1.0795444360780972, 'psi': 0.544755384464993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=25 head_norm_before_train=1.187389 cos_to_last_merge=0.9475 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.947
[S2] round=25 local utility u=0.005590 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.6695729881579455, 'loss_val': 0.2897565418764856, 'psi': 0.6889282895559156}-{'f1_val': 0.7014918162305126, 'auprc': 0.6658930241141383, 'loss_val': 0.2878563982773093, 'psi': 0.6872522993839629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=25 head_norm_before_train=1.183925 cos_to_last_merge=0.9579 (last merge round=15)
[S3] round=25 local utility u=0.053980 metrics={'f1_val': 0.7002765683645327, 'auprc': 0.9982308600863512, 'loss_val': 0.27655274934442436, 'psi': 0.8194582850532601}-{'f1_val': 0.6995786553134029, 'auprc': 0.9844404088980776, 'loss_val': 0.33895473248003605, 'psi': 0.8135233567472728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=25 head_norm_before_train=1.137406 cos_to_last_merge=0.9594 (last merge round=19)
[S4] round=25 local utility u=0.034059 metrics={'f1_val': 0.9579703799432631, 'auprc': 0.9591365293622908, 'loss_val': 0.23613444726565283, 'psi': 0.9584368397108741}-{'f1_val': 0.9411561565867217, 'auprc': 0.9749446755006755, 'loss_val': 0.25079072630312577, 'psi': 0.9546715641523031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=25 head_norm_before_train=1.199785 cos_to_last_merge=0.9955 (last merge round=20)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7005801584103919, 'auprc': 0.8077098325880581, 'loss_val': 0.38250538253862665, 'psi': 0.7434320280814584}-{'f1_val': 0.700320598491359, 'auprc': 0.8368503070024532, 'loss_val': 0.3775034470388294, 'psi': 0.7549324818957968}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=1.305964 cos_to_last_merge=0.9946 (last merge round=19)
[S6] round=25 local utility u=1.000000 metrics={'f1_val': 0.9609333937438221, 'auprc': 0.9583369636908586, 'loss_val': 0.35286118134965966, 'psi': 0.9598948217226367}-{'f1_val': 0.6148192320143615, 'auprc': 0.9212570322276595, 'loss_val': 0.5038231814742398, 'psi': 0.7373943520996807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=25 head_norm_before_train=1.596420 cos_to_last_merge=0.9921 (last merge round=16)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.4626530844253433, 'auprc': 0.7813674158440056, 'loss_val': 1.0028432634561957, 'psi': 0.5901388169928082}-{'f1_val': 0.6872174982587562, 'auprc': 0.900284969069746, 'loss_val': 0.38939168076081265, 'psi': 0.7724444865831521}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=25 head_norm_before_train=1.134138 cos_to_last_merge=0.9610 (last merge round=18)
[S8] round=25 local utility u=0.011925 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.998224273154893, 'loss_val': 0.13781202009670662, 'psi': 0.9970115713020489}-{'f1_val': 0.9962031034001528, 'auprc': 0.9981092143607697, 'loss_val': 0.16131610805604316, 'psi': 0.9969655477843996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=25 head_norm_before_train=1.566050 cos_to_last_merge=0.8015 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.801
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.998334923535899, 'loss_val': 0.03680296576003245, 'psi': 0.996098159183981}-{'f1_val': 0.9962500947792776, 'auprc': 0.9946696970579637, 'loss_val': 0.03518436834900239, 'psi': 0.9956179356907521}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=25 head_norm_before_train=1.837891 (no previous merge yet)
[S10] round=25 local utility u=0.004773 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9950644638050096, 'loss_val': 0.04587307872273215, 'psi': 0.9952597861384365}-{'f1_val': 0.993924439075923, 'auprc': 0.997393987205664, 'loss_val': 0.05361376892653767, 'psi': 0.9953122583278193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=25 head_norm_before_train=1.362090 cos_to_last_merge=0.9917 (last merge round=20)
[S11] round=25 local utility u=0.006876 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9986740727936577, 'loss_val': 0.06400913693312649, 'psi': 0.9974101115011913}-{'f1_val': 0.996567470639547, 'auprc': 0.9987391385099464, 'loss_val': 0.07795546974587826, 'psi': 0.9974361377877068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=25 head_norm_before_train=1.737724 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5595834151930581, 'auprc': 0.6749687262716889, 'loss_val': 0.7861009636518619, 'psi': 0.6057375396245104}-{'f1_val': 0.5890370299249874, 'auprc': 0.6818373536315303, 'loss_val': 0.7034717836908989, 'psi': 0.6261571594076045}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=25 head_norm_before_train=1.698011 cos_to_last_merge=0.9954 (last merge round=18)
[S14] round=25 local utility u=0.004031 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9969976049552504, 'loss_val': 0.03971434635264984, 'psi': 0.9973897128120123}-{'f1_val': 0.997240356705793, 'auprc': 0.9969664097949928, 'loss_val': 0.045217874496928476, 'psi': 0.997130777941473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=25 head_norm_before_train=1.594683 cos_to_last_merge=0.7993 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.799
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.7994475705486321, 'loss_val': 0.5294740077554156, 'psi': 0.7403305388404534}-{'f1_val': 0.986249753819943, 'auprc': 0.996744785031707, 'loss_val': 0.08543949365084047, 'psi': 0.9904477663046486}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=25 head_norm_before_train=1.536802 cos_to_last_merge=0.9887 (last merge round=20)
[S16] round=25 local utility u=0.655967 metrics={'f1_val': 0.9913583318001885, 'auprc': 0.992085088569663, 'loss_val': 0.06785376530547346, 'psi': 0.9916490345079783}-{'f1_val': 0.8473125135639756, 'auprc': 0.9649060352784995, 'loss_val': 0.43397615787294114, 'psi': 0.8943499222497853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=25 head_norm_before_train=1.423548 cos_to_last_merge=0.7703 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.770
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.38356800180251005, 'auprc': 0.8143439124905417, 'loss_val': 1.0870608050824817, 'psi': 0.5558783660777227}-{'f1_val': 0.39416029922671647, 'auprc': 0.8110667236222868, 'loss_val': 0.9882506468725998, 'psi': 0.5609228689849446}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=26 head_norm_before_train=1.207496 cos_to_last_merge=0.9452 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.945
[S2] round=26 local utility u=0.002138 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.6691749385975725, 'loss_val': 0.2842855694847817, 'psi': 0.6887690697317663}-{'f1_val': 0.7018318238212289, 'auprc': 0.6695729881579455, 'loss_val': 0.2897565418764856, 'psi': 0.6889282895559156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=26 head_norm_before_train=1.201486 cos_to_last_merge=0.9545 (last merge round=15)
[S3] round=26 local utility u=0.004599 metrics={'f1_val': 0.7005313319257805, 'auprc': 0.9982288710966668, 'loss_val': 0.2688767778623509, 'psi': 0.8196103475941351}-{'f1_val': 0.7002765683645327, 'auprc': 0.9982308600863512, 'loss_val': 0.27655274934442436, 'psi': 0.8194582850532601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] sending update (kind=head size=1789 to 1 peers)
[S4] START round=26 head_norm_before_train=1.172932 cos_to_last_merge=0.9527 (last merge round=19)
[S4] round=26 local utility u=0.053940 metrics={'f1_val': 0.95783676444613, 'auprc': 0.9763035801152934, 'loss_val': 0.1789531231956872, 'psi': 0.9652234907137953}-{'f1_val': 0.9579703799432631, 'auprc': 0.9591365293622908, 'loss_val': 0.23613444726565283, 'psi': 0.9584368397108741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=26 head_norm_before_train=1.219553 cos_to_last_merge=0.9947 (last merge round=20)
[S5] round=26 local utility u=0.314960 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9894592490917022, 'loss_val': 0.2962765820560209, 'psi': 0.8159760587314964}-{'f1_val': 0.7005801584103919, 'auprc': 0.8077098325880581, 'loss_val': 0.38250538253862665, 'psi': 0.7434320280814584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=26 head_norm_before_train=1.316783 cos_to_last_merge=0.9935 (last merge round=19)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.7389215727109646, 'auprc': 0.9445801980815876, 'loss_val': 0.45743422607644585, 'psi': 0.8211850228592138}-{'f1_val': 0.9609333937438221, 'auprc': 0.9583369636908586, 'loss_val': 0.35286118134965966, 'psi': 0.9598948217226367}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=1.602169 cos_to_last_merge=0.9915 (last merge round=16)
[S7] round=26 local utility u=1.000000 metrics={'f1_val': 0.6939526849406568, 'auprc': 0.9124192654777381, 'loss_val': 0.3277454518143809, 'psi': 0.7813393171554893}-{'f1_val': 0.4626530844253433, 'auprc': 0.7813674158440056, 'loss_val': 1.0028432634561957, 'psi': 0.5901388169928082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=26 head_norm_before_train=1.169865 cos_to_last_merge=0.9531 (last merge round=18)
[S8] round=26 local utility u=0.007465 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9982676830622741, 'loss_val': 0.12301284961782023, 'psi': 0.9970289352650014}-{'f1_val': 0.9962031034001528, 'auprc': 0.998224273154893, 'loss_val': 0.13781202009670662, 'psi': 0.9970115713020489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=26 head_norm_before_train=1.579737 cos_to_last_merge=0.8008 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.801
[S9] round=26 local utility u=0.007544 metrics={'f1_val': 0.9962748907591257, 'auprc': 0.998390003152645, 'loss_val': 0.03188748790693878, 'psi': 0.9971209357165334}-{'f1_val': 0.9946069829493691, 'auprc': 0.998334923535899, 'loss_val': 0.03680296576003245, 'psi': 0.996098159183981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=26 head_norm_before_train=1.853533 (no previous merge yet)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9947781979029806, 'auprc': 0.9934400769366413, 'loss_val': 0.04614905043416034, 'psi': 0.9942429495164449}-{'f1_val': 0.9953900010273877, 'auprc': 0.9950644638050096, 'loss_val': 0.04587307872273215, 'psi': 0.9952597861384365}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=26 head_norm_before_train=1.405340 cos_to_last_merge=0.9887 (last merge round=20)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9961749345434856, 'auprc': 0.9975485947983438, 'loss_val': 0.06314878164630824, 'psi': 0.9967243986454288}-{'f1_val': 0.996567470639547, 'auprc': 0.9986740727936577, 'loss_val': 0.06400913693312649, 'psi': 0.9974101115011913}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=26 head_norm_before_train=1.746704 (no previous merge yet)
[S13] round=26 local utility u=0.158161 metrics={'f1_val': 0.5989156972718039, 'auprc': 0.6675045687219677, 'loss_val': 0.6833803716610467, 'psi': 0.6263512458518694}-{'f1_val': 0.5595834151930581, 'auprc': 0.6749687262716889, 'loss_val': 0.7861009636518619, 'psi': 0.6057375396245104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=26 head_norm_before_train=1.718213 cos_to_last_merge=0.9945 (last merge round=18)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9969663628562762, 'loss_val': 0.03980072457644546, 'psi': 0.9973772159724226}-{'f1_val': 0.9976511180498535, 'auprc': 0.9969976049552504, 'loss_val': 0.03971434635264984, 'psi': 0.9973897128120123}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=1.610115 cos_to_last_merge=0.7982 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.798
[S15] round=26 local utility u=0.851732 metrics={'f1_val': 0.831649981395285, 'auprc': 0.9923260708497901, 'loss_val': 0.18903053265182415, 'psi': 0.895920417177087}-{'f1_val': 0.7009191843683342, 'auprc': 0.7994475705486321, 'loss_val': 0.5294740077554156, 'psi': 0.7403305388404534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=26 head_norm_before_train=1.578183 cos_to_last_merge=0.9851 (last merge round=20)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.9387965906225975, 'auprc': 0.9923056912410531, 'loss_val': 0.23548261354259187, 'psi': 0.9602002308699797}-{'f1_val': 0.9913583318001885, 'auprc': 0.992085088569663, 'loss_val': 0.06785376530547346, 'psi': 0.9916490345079783}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=1.452088 cos_to_last_merge=0.7665 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.767
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.3897501365095637, 'auprc': 0.8081706408711827, 'loss_val': 1.1279869585711935, 'psi': 0.5571183382542113}-{'f1_val': 0.38356800180251005, 'auprc': 0.8143439124905417, 'loss_val': 1.0870608050824817, 'psi': 0.5558783660777227}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=27 head_norm_before_train=1.223774 cos_to_last_merge=0.9429 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.943
[S2] round=27 local utility u=0.002396 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.6692596931384134, 'loss_val': 0.279748105491103, 'psi': 0.6888029715481028}-{'f1_val': 0.7018318238212289, 'auprc': 0.6691749385975725, 'loss_val': 0.2842855694847817, 'psi': 0.6887690697317663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=27 head_norm_before_train=1.219375 cos_to_last_merge=0.9509 (last merge round=15)
[S3] round=27 local utility u=0.619863 metrics={'f1_val': 0.9042240106023417, 'auprc': 0.998584815297713, 'loss_val': 0.2523753912937104, 'psi': 0.9419683324804903}-{'f1_val': 0.7005313319257805, 'auprc': 0.9982288710966668, 'loss_val': 0.2688767778623509, 'psi': 0.8196103475941351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=27 head_norm_before_train=1.206218 cos_to_last_merge=0.9463 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9425194383341413, 'auprc': 0.9761569852952772, 'loss_val': 0.2492726038507096, 'psi': 0.9559744571185956}-{'f1_val': 0.95783676444613, 'auprc': 0.9763035801152934, 'loss_val': 0.1789531231956872, 'psi': 0.9652234907137953}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.234216 cos_to_last_merge=0.9939 (last merge round=20)
[S5] round=27 local utility u=0.002848 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9894617391102403, 'loss_val': 0.2905881442276565, 'psi': 0.8159770547389116}-{'f1_val': 0.700320598491359, 'auprc': 0.9894592490917022, 'loss_val': 0.2962765820560209, 'psi': 0.8159760587314964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=27 head_norm_before_train=1.331533 cos_to_last_merge=0.9919 (last merge round=19)
[S6] round=27 local utility u=0.293802 metrics={'f1_val': 0.8224797115705099, 'auprc': 0.9493140026956796, 'loss_val': 0.38538079199203157, 'psi': 0.8732134280205778}-{'f1_val': 0.7389215727109646, 'auprc': 0.9445801980815876, 'loss_val': 0.45743422607644585, 'psi': 0.8211850228592138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=27 head_norm_before_train=1.608404 cos_to_last_merge=0.9908 (last merge round=16)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5726108525327955, 'auprc': 0.7944260955071516, 'loss_val': 0.7921467236319769, 'psi': 0.661336949722538}-{'f1_val': 0.6939526849406568, 'auprc': 0.9124192654777381, 'loss_val': 0.3277454518143809, 'psi': 0.7813393171554893}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=27 head_norm_before_train=1.202150 cos_to_last_merge=0.9462 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=27 local utility u=0.006584 metrics={'f1_val': 0.9950949602617258, 'auprc': 0.9993743299907855, 'loss_val': 0.10651634026082984, 'psi': 0.9968067081533496}-{'f1_val': 0.9962031034001528, 'auprc': 0.9982676830622741, 'loss_val': 0.12301284961782023, 'psi': 0.9970289352650014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=27 head_norm_before_train=1.593189 cos_to_last_merge=0.8003 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.800
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9983347610952863, 'loss_val': 0.03125606324069003, 'psi': 0.9968499869639078}-{'f1_val': 0.9962748907591257, 'auprc': 0.998390003152645, 'loss_val': 0.03188748790693878, 'psi': 0.9971209357165334}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=1.870288 (no previous merge yet)
[S10] round=27 local utility u=0.001561 metrics={'f1_val': 0.9935109650886941, 'auprc': 0.9965197371580735, 'loss_val': 0.04466299274805296, 'psi': 0.9947144739164459}-{'f1_val': 0.9947781979029806, 'auprc': 0.9934400769366413, 'loss_val': 0.04614905043416034, 'psi': 0.9942429495164449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=27 head_norm_before_train=1.446470 cos_to_last_merge=0.9856 (last merge round=20)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9965919014202035, 'auprc': 0.9963470482995677, 'loss_val': 0.08670644257613414, 'psi': 0.9964939601719491}-{'f1_val': 0.9961749345434856, 'auprc': 0.9975485947983438, 'loss_val': 0.06314878164630824, 'psi': 0.9967243986454288}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=1.755084 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5684819684080631, 'auprc': 0.6869207788971109, 'loss_val': 0.83154780570764, 'psi': 0.6158574926036822}-{'f1_val': 0.5989156972718039, 'auprc': 0.6675045687219677, 'loss_val': 0.6833803716610467, 'psi': 0.6263512458518694}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=1.733155 cos_to_last_merge=0.9935 (last merge round=18)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9943183518468823, 'auprc': 0.9969675945533357, 'loss_val': 0.05006456335432386, 'psi': 0.9953780489294637}-{'f1_val': 0.9976511180498535, 'auprc': 0.9969663628562762, 'loss_val': 0.03980072457644546, 'psi': 0.9973772159724226}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=1.625776 cos_to_last_merge=0.7968 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.797
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.7706317008372111, 'auprc': 0.9839721298410901, 'loss_val': 0.34710884650283114, 'psi': 0.8559678724387627}-{'f1_val': 0.831649981395285, 'auprc': 0.9923260708497901, 'loss_val': 0.18903053265182415, 'psi': 0.895920417177087}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=1.615232 cos_to_last_merge=0.9819 (last merge round=20)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.9336076292278338, 'auprc': 0.9950436360668686, 'loss_val': 0.2690497760174916, 'psi': 0.9581820319634478}-{'f1_val': 0.9387965906225975, 'auprc': 0.9923056912410531, 'loss_val': 0.23548261354259187, 'psi': 0.9602002308699797}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=27 head_norm_before_train=1.480859 cos_to_last_merge=0.7632 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.763
[S17] round=27 local utility u=0.015592 metrics={'f1_val': 0.3980184714797858, 'auprc': 0.8086113937550901, 'loss_val': 1.1477353070318002, 'psi': 0.5622556403899075}-{'f1_val': 0.3897501365095637, 'auprc': 0.8081706408711827, 'loss_val': 1.1279869585711935, 'psi': 0.5571183382542113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=28 head_norm_before_train=1.238346 cos_to_last_merge=0.9406 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.941
[S2] round=28 local utility u=0.039843 metrics={'f1_val': 0.7013037712404606, 'auprc': 0.7049765565433008, 'loss_val': 0.30404430635342256, 'psi': 0.7027728853615967}-{'f1_val': 0.7018318238212289, 'auprc': 0.6692596931384134, 'loss_val': 0.279748105491103, 'psi': 0.6888029715481028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=28 head_norm_before_train=1.242857 cos_to_last_merge=0.9473 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.947
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.7088776853471166, 'auprc': 0.9989811968229793, 'loss_val': 0.2230424210615772, 'psi': 0.8249190899374617}-{'f1_val': 0.9042240106023417, 'auprc': 0.998584815297713, 'loss_val': 0.2523753912937104, 'psi': 0.9419683324804903}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=1.239651 cos_to_last_merge=0.9404 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.940
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.841008044056677, 'auprc': 0.9101883631780998, 'loss_val': 0.38756063441804944, 'psi': 0.8686801717052461}-{'f1_val': 0.9425194383341413, 'auprc': 0.9761569852952772, 'loss_val': 0.2492726038507096, 'psi': 0.9559744571185956}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.247545 cos_to_last_merge=0.9932 (last merge round=20)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9653365356905986, 'loss_val': 0.3140137788330638, 'psi': 0.8063269733710549}-{'f1_val': 0.700320598491359, 'auprc': 0.9894617391102403, 'loss_val': 0.2905881442276565, 'psi': 0.8159770547389116}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.353004 cos_to_last_merge=0.9891 (last merge round=19)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.785234952139163, 'auprc': 0.9356217978248649, 'loss_val': 0.43008322268894883, 'psi': 0.8453896904134437}-{'f1_val': 0.8224797115705099, 'auprc': 0.9493140026956796, 'loss_val': 0.38538079199203157, 'psi': 0.8732134280205778}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.618821 cos_to_last_merge=0.9892 (last merge round=16)
[S7] round=28 local utility u=0.762548 metrics={'f1_val': 0.6941123541773475, 'auprc': 0.9120668364390311, 'loss_val': 0.348982849174948, 'psi': 0.7812941470820209}-{'f1_val': 0.5726108525327955, 'auprc': 0.7944260955071516, 'loss_val': 0.7921467236319769, 'psi': 0.661336949722538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=28 head_norm_before_train=1.234608 cos_to_last_merge=0.9392 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.939
[S8] round=28 local utility u=0.005616 metrics={'f1_val': 0.9950949602617258, 'auprc': 0.9989987663731138, 'loss_val': 0.09415721163967836, 'psi': 0.9966564827062809}-{'f1_val': 0.9950949602617258, 'auprc': 0.9993743299907855, 'loss_val': 0.10651634026082984, 'psi': 0.9968067081533496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=28 head_norm_before_train=1.607957 cos_to_last_merge=0.7995 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.800
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9981078551050986, 'loss_val': 0.03783691295913276, 'psi': 0.993995740966184}-{'f1_val': 0.9958601375429889, 'auprc': 0.9983347610952863, 'loss_val': 0.03125606324069003, 'psi': 0.9968499869639078}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.884237 (no previous merge yet)
[S10] round=28 local utility u=0.001688 metrics={'f1_val': 0.9947781979029806, 'auprc': 0.9937372610495969, 'loss_val': 0.040542081142401716, 'psi': 0.9943618231616271}-{'f1_val': 0.9935109650886941, 'auprc': 0.9965197371580735, 'loss_val': 0.04466299274805296, 'psi': 0.9947144739164459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=28 head_norm_before_train=1.486745 cos_to_last_merge=0.9825 (last merge round=20)
[S11] round=28 local utility u=0.024085 metrics={'f1_val': 0.9961749345434856, 'auprc': 0.9982776880272116, 'loss_val': 0.041826734129187824, 'psi': 0.997016035936976}-{'f1_val': 0.9965919014202035, 'auprc': 0.9963470482995677, 'loss_val': 0.08670644257613414, 'psi': 0.9964939601719491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=28 head_norm_before_train=1.763672 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5368376758137756, 'auprc': 0.6796172535715036, 'loss_val': 0.8136547315032987, 'psi': 0.5939495069168668}-{'f1_val': 0.5684819684080631, 'auprc': 0.6869207788971109, 'loss_val': 0.83154780570764, 'psi': 0.6158574926036822}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.745849 cos_to_last_merge=0.9925 (last merge round=18)
[S14] round=28 local utility u=0.016482 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9974338804964306, 'loss_val': 0.038495019174319106, 'psi': 0.9975642230284844}-{'f1_val': 0.9943183518468823, 'auprc': 0.9969675945533357, 'loss_val': 0.05006456335432386, 'psi': 0.9953780489294637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=28 head_norm_before_train=1.643553 cos_to_last_merge=0.7952 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.795
[S15] round=28 local utility u=0.452881 metrics={'f1_val': 0.8842223067223755, 'auprc': 0.9903673588944387, 'loss_val': 0.1420766796578941, 'psi': 0.9266803275912008}-{'f1_val': 0.7706317008372111, 'auprc': 0.9839721298410901, 'loss_val': 0.34710884650283114, 'psi': 0.8559678724387627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=28 head_norm_before_train=1.646672 cos_to_last_merge=0.9791 (last merge round=20)
[S16] round=28 local utility u=0.032818 metrics={'f1_val': 0.9384285310513354, 'auprc': 0.9955233476812815, 'loss_val': 0.23377821721150102, 'psi': 0.9612664577033139}-{'f1_val': 0.9336076292278338, 'auprc': 0.9950436360668686, 'loss_val': 0.2690497760174916, 'psi': 0.9581820319634478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=28 head_norm_before_train=1.499840 cos_to_last_merge=0.7606 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.761
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.36987575459527655, 'auprc': 0.7960581564702951, 'loss_val': 1.3275587846013466, 'psi': 0.540348715345284}-{'f1_val': 0.3980184714797858, 'auprc': 0.8086113937550901, 'loss_val': 1.1477353070318002, 'psi': 0.5622556403899075}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.252173 cos_to_last_merge=0.9384 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.938
[S2] round=29 local utility u=0.060612 metrics={'f1_val': 0.7009507050715648, 'auprc': 0.7393316298396122, 'loss_val': 0.2837680209290374, 'psi': 0.7163030749787838}-{'f1_val': 0.7013037712404606, 'auprc': 0.7049765565433008, 'loss_val': 0.30404430635342256, 'psi': 0.7027728853615967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=29 head_norm_before_train=1.269434 cos_to_last_merge=0.9441 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.7030679722274212, 'auprc': 0.9993435212625132, 'loss_val': 0.20554859104011183, 'psi': 0.8215781918414581}-{'f1_val': 0.7088776853471166, 'auprc': 0.9989811968229793, 'loss_val': 0.2230424210615772, 'psi': 0.8249190899374617}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=1.265325 cos_to_last_merge=0.9360 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.936
[S4] round=29 local utility u=0.445991 metrics={'f1_val': 0.9390023513442032, 'auprc': 0.9697462657809095, 'loss_val': 0.26221873643087584, 'psi': 0.9512999171188856}-{'f1_val': 0.841008044056677, 'auprc': 0.9101883631780998, 'loss_val': 0.38756063441804944, 'psi': 0.8686801717052461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=29 head_norm_before_train=1.260902 cos_to_last_merge=0.9921 (last merge round=20)
[S5] round=29 local utility u=0.063392 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9902652041132308, 'loss_val': 0.26201600065145925, 'psi': 0.8162984407401077}-{'f1_val': 0.700320598491359, 'auprc': 0.9653365356905986, 'loss_val': 0.3140137788330638, 'psi': 0.8063269733710549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=29 head_norm_before_train=1.373295 cos_to_last_merge=0.9862 (last merge round=19)
[S6] round=29 local utility u=0.259766 metrics={'f1_val': 0.8506922918103448, 'auprc': 0.9373275343880595, 'loss_val': 0.3084126244014666, 'psi': 0.8853463888414306}-{'f1_val': 0.785234952139163, 'auprc': 0.9356217978248649, 'loss_val': 0.43008322268894883, 'psi': 0.8453896904134437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=29 head_norm_before_train=1.627231 cos_to_last_merge=0.9882 (last merge round=16)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.4868809546632572, 'auprc': 0.7489090822639178, 'loss_val': 1.213408383686917, 'psi': 0.5916922057035214}-{'f1_val': 0.6941123541773475, 'auprc': 0.9120668364390311, 'loss_val': 0.348982849174948, 'psi': 0.7812941470820209}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=29 head_norm_before_train=1.263608 cos_to_last_merge=0.9333 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.933
[S8] round=29 local utility u=0.004921 metrics={'f1_val': 0.9950949602617258, 'auprc': 0.9991987548530992, 'loss_val': 0.08491616164257486, 'psi': 0.9967364780982751}-{'f1_val': 0.9950949602617258, 'auprc': 0.9989987663731138, 'loss_val': 0.09415721163967836, 'psi': 0.9966564827062809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=29 head_norm_before_train=1.623439 cos_to_last_merge=0.7986 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.799
[S9] round=29 local utility u=0.020507 metrics={'f1_val': 0.9962748907591257, 'auprc': 0.998378441379218, 'loss_val': 0.02775823136677805, 'psi': 0.9971163110071626}-{'f1_val': 0.991254331540241, 'auprc': 0.9981078551050986, 'loss_val': 0.03783691295913276, 'psi': 0.993995740966184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=29 head_norm_before_train=1.896845 (no previous merge yet)
[S10] round=29 local utility u=0.000464 metrics={'f1_val': 0.9945588208961169, 'auprc': 0.9937582709141789, 'loss_val': 0.03836167448078413, 'psi': 0.9942386009033417}-{'f1_val': 0.9947781979029806, 'auprc': 0.9937372610495969, 'loss_val': 0.040542081142401716, 'psi': 0.9943618231616271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=29 head_norm_before_train=1.524880 cos_to_last_merge=0.9796 (last merge round=20)
[S11] round=29 local utility u=0.004305 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9994662705324009, 'loss_val': 0.03665846343574551, 'psi': 0.9974789930594076}-{'f1_val': 0.9961749345434856, 'auprc': 0.9982776880272116, 'loss_val': 0.041826734129187824, 'psi': 0.997016035936976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=29 head_norm_before_train=1.771690 (no previous merge yet)
[S13] round=29 local utility u=0.062407 metrics={'f1_val': 0.5992122573566033, 'auprc': 0.5755092003634205, 'loss_val': 0.7507634598426542, 'psi': 0.5897310345593302}-{'f1_val': 0.5368376758137756, 'auprc': 0.6796172535715036, 'loss_val': 0.8136547315032987, 'psi': 0.5939495069168668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=29 head_norm_before_train=1.757779 cos_to_last_merge=0.9915 (last merge round=18)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.996965286081413, 'loss_val': 0.03671144887489629, 'psi': 0.9972310761336005}-{'f1_val': 0.9976511180498535, 'auprc': 0.9974338804964306, 'loss_val': 0.038495019174319106, 'psi': 0.9975642230284844}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=1.662316 cos_to_last_merge=0.7934 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.793
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.8213516782962007, 'auprc': 0.9882596013157782, 'loss_val': 0.21711530431788112, 'psi': 0.8881148475040317}-{'f1_val': 0.8842223067223755, 'auprc': 0.9903673588944387, 'loss_val': 0.1420766796578941, 'psi': 0.9266803275912008}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=1.674972 cos_to_last_merge=0.9766 (last merge round=20)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.9357177831549804, 'auprc': 0.9954813774327497, 'loss_val': 0.257146501033371, 'psi': 0.9596232208660882}-{'f1_val': 0.9384285310513354, 'auprc': 0.9955233476812815, 'loss_val': 0.23377821721150102, 'psi': 0.9612664577033139}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.516542 cos_to_last_merge=0.7579 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.758
[S17] round=29 local utility u=0.807598 metrics={'f1_val': 0.6182118547220692, 'auprc': 0.8041477099521321, 'loss_val': 1.2266483359432476, 'psi': 0.6925861968140943}-{'f1_val': 0.36987575459527655, 'auprc': 0.7960581564702951, 'loss_val': 1.3275587846013466, 'psi': 0.540348715345284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=30 head_norm_before_train=1.265560 cos_to_last_merge=0.9371 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.937
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.7012333617836406, 'auprc': 0.7197910441127857, 'loss_val': 0.2904027998082723, 'psi': 0.7086564347152986}-{'f1_val': 0.7009507050715648, 'auprc': 0.7393316298396122, 'loss_val': 0.2837680209290374, 'psi': 0.7163030749787838}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.294676 cos_to_last_merge=0.9409 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=30 local utility u=0.789251 metrics={'f1_val': 0.9619616648309319, 'auprc': 0.99935952158541, 'loss_val': 0.18045678461359854, 'psi': 0.9769208075327231}-{'f1_val': 0.7030679722274212, 'auprc': 0.9993435212625132, 'loss_val': 0.20554859104011183, 'psi': 0.8215781918414581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=30 head_norm_before_train=1.283849 cos_to_last_merge=0.9331 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.933
[S4] round=30 local utility u=0.003889 metrics={'f1_val': 0.9370262706908419, 'auprc': 0.9665129981220154, 'loss_val': 0.23288384203049745, 'psi': 0.9488209616633113}-{'f1_val': 0.9390023513442032, 'auprc': 0.9697462657809095, 'loss_val': 0.26221873643087584, 'psi': 0.9512999171188856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=30 head_norm_before_train=1.276062 cos_to_last_merge=0.9906 (last merge round=20)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8415314816344488, 'loss_val': 0.32483160159880026, 'psi': 0.7568049517485949}-{'f1_val': 0.700320598491359, 'auprc': 0.9902652041132308, 'loss_val': 0.26201600065145925, 'psi': 0.8162984407401077}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.395973 cos_to_last_merge=0.9828 (last merge round=19)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.6023145716188221, 'auprc': 0.9074924391447673, 'loss_val': 0.726944435811112, 'psi': 0.7243857186292002}-{'f1_val': 0.8506922918103448, 'auprc': 0.9373275343880595, 'loss_val': 0.3084126244014666, 'psi': 0.8853463888414306}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.630962 cos_to_last_merge=0.9878 (last merge round=16)
[S7] round=30 local utility u=0.872020 metrics={'f1_val': 0.63957531665495, 'auprc': 0.8056659325556003, 'loss_val': 0.5558048630593987, 'psi': 0.7060115630152102}-{'f1_val': 0.4868809546632572, 'auprc': 0.7489090822639178, 'loss_val': 1.213408383686917, 'psi': 0.5916922057035214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=30 head_norm_before_train=1.290586 cos_to_last_merge=0.9280 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.928
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9991919674442891, 'loss_val': 0.0826550408448273, 'psi': 0.9956371888986395}-{'f1_val': 0.9950949602617258, 'auprc': 0.9991987548530992, 'loss_val': 0.08491616164257486, 'psi': 0.9967364780982751}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.639024 cos_to_last_merge=0.7976 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.798
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.995377618690834, 'loss_val': 0.026479397241180376, 'psi': 0.9964127949836192}-{'f1_val': 0.9962748907591257, 'auprc': 0.998378441379218, 'loss_val': 0.02775823136677805, 'psi': 0.9971163110071626}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.912753 (no previous merge yet)
[S10] round=30 local utility u=0.003820 metrics={'f1_val': 0.9942928605461898, 'auprc': 0.9963872778068614, 'loss_val': 0.037013112418553575, 'psi': 0.9951306274504585}-{'f1_val': 0.9945588208961169, 'auprc': 0.9937582709141789, 'loss_val': 0.03836167448078413, 'psi': 0.9942386009033417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=30 head_norm_before_train=1.559038 cos_to_last_merge=0.9770 (last merge round=20)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9958445741966941, 'auprc': 0.9987729186344513, 'loss_val': 0.03478919867311936, 'psi': 0.997015911971797}-{'f1_val': 0.9961541414107454, 'auprc': 0.9994662705324009, 'loss_val': 0.03665846343574551, 'psi': 0.9974789930594076}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=1.781090 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5527046364150585, 'auprc': 0.6807747797668031, 'loss_val': 0.801663260464338, 'psi': 0.6039326937557563}-{'f1_val': 0.5992122573566033, 'auprc': 0.5755092003634205, 'loss_val': 0.7507634598426542, 'psi': 0.5897310345593302}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.772655 cos_to_last_merge=0.9906 (last merge round=18)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9955709227491966, 'auprc': 0.9969647455281169, 'loss_val': 0.04167368139437094, 'psi': 0.9961284518607647}-{'f1_val': 0.9974082695017256, 'auprc': 0.996965286081413, 'loss_val': 0.03671144887489629, 'psi': 0.9972310761336005}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=1.683610 cos_to_last_merge=0.7915 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.791
[S15] round=30 local utility u=0.554104 metrics={'f1_val': 0.9814761704464512, 'auprc': 0.9908671793823587, 'loss_val': 0.07747754912828303, 'psi': 0.9852325740208142}-{'f1_val': 0.8213516782962007, 'auprc': 0.9882596013157782, 'loss_val': 0.21711530431788112, 'psi': 0.8881148475040317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=30 head_norm_before_train=1.700444 cos_to_last_merge=0.9744 (last merge round=20)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8748485197199973, 'auprc': 0.9958536100514317, 'loss_val': 0.48392021318345907, 'psi': 0.9232505558525711}-{'f1_val': 0.9357177831549804, 'auprc': 0.9954813774327497, 'loss_val': 0.257146501033371, 'psi': 0.9596232208660882}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.534797 cos_to_last_merge=0.7546 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.755
[S17] round=30 local utility u=0.274926 metrics={'f1_val': 0.6661627562722174, 'auprc': 0.8235778929558959, 'loss_val': 1.0227924098075598, 'psi': 0.7291288109456888}-{'f1_val': 0.6182118547220692, 'auprc': 0.8041477099521321, 'loss_val': 1.2266483359432476, 'psi': 0.6925861968140943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=31 head_norm_before_train=1.279026 cos_to_last_merge=0.9359 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.936
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.5069208550700021, 'auprc': 0.6941543519243324, 'loss_val': 1.0813606434192347, 'psi': 0.5818142538117342}-{'f1_val': 0.7012333617836406, 'auprc': 0.7197910441127857, 'loss_val': 0.2904027998082723, 'psi': 0.7086564347152986}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=1.321873 cos_to_last_merge=0.9370 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9010985055288723, 'auprc': 0.9472005770144388, 'loss_val': 0.24787301457870067, 'psi': 0.9195393341230989}-{'f1_val': 0.9619616648309319, 'auprc': 0.99935952158541, 'loss_val': 0.18045678461359854, 'psi': 0.9769208075327231}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.302761 cos_to_last_merge=0.9304 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.930
[S4] round=31 local utility u=0.038257 metrics={'f1_val': 0.9490227702119131, 'auprc': 0.9640273661715452, 'loss_val': 0.22089230675736882, 'psi': 0.9550246085957659}-{'f1_val': 0.9370262706908419, 'auprc': 0.9665129981220154, 'loss_val': 0.23288384203049745, 'psi': 0.9488209616633113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=31 head_norm_before_train=1.290770 cos_to_last_merge=0.9895 (last merge round=20)
[S5] round=31 local utility u=0.262891 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9909125396784348, 'loss_val': 0.24719321962243876, 'psi': 0.8165573749661894}-{'f1_val': 0.700320598491359, 'auprc': 0.8415314816344488, 'loss_val': 0.32483160159880026, 'psi': 0.7568049517485949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=31 head_norm_before_train=1.413773 cos_to_last_merge=0.9799 (last merge round=19)
[S6] round=31 local utility u=0.893344 metrics={'f1_val': 0.822461149497326, 'auprc': 0.9337326175869399, 'loss_val': 0.3398562145352532, 'psi': 0.8669697367331715}-{'f1_val': 0.6023145716188221, 'auprc': 0.9074924391447673, 'loss_val': 0.726944435811112, 'psi': 0.7243857186292002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=31 head_norm_before_train=1.633568 cos_to_last_merge=0.9877 (last merge round=16)
[S7] round=31 local utility u=0.377567 metrics={'f1_val': 0.6953211283011208, 'auprc': 0.8757339222300315, 'loss_val': 0.3453502981708977, 'psi': 0.7674862458726851}-{'f1_val': 0.63957531665495, 'auprc': 0.8056659325556003, 'loss_val': 0.5558048630593987, 'psi': 0.7060115630152102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=31 head_norm_before_train=1.311794 cos_to_last_merge=0.9241 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.924
[S8] round=31 local utility u=0.000297 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9991482387839429, 'loss_val': 0.08192889402459644, 'psi': 0.9956196974345011}-{'f1_val': 0.9932673365348732, 'auprc': 0.9991919674442891, 'loss_val': 0.0826550408448273, 'psi': 0.9956371888986395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=31 head_norm_before_train=1.653425 cos_to_last_merge=0.7966 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.797
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9981022466511313, 'loss_val': 0.03128302599667634, 'psi': 0.9957547225107921}-{'f1_val': 0.9971029125121428, 'auprc': 0.995377618690834, 'loss_val': 0.026479397241180376, 'psi': 0.9964127949836192}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.930355 (no previous merge yet)
[S10] round=31 local utility u=0.002224 metrics={'f1_val': 0.9949509212940392, 'auprc': 0.9960476599859909, 'loss_val': 0.03549473871278416, 'psi': 0.9953896167708198}-{'f1_val': 0.9942928605461898, 'auprc': 0.9963872778068614, 'loss_val': 0.037013112418553575, 'psi': 0.9951306274504585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=31 head_norm_before_train=1.590327 cos_to_last_merge=0.9746 (last merge round=20)
[S11] round=31 local utility u=0.003265 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982982787384141, 'loss_val': 0.031172666482655084, 'psi': 0.9972597938790939}-{'f1_val': 0.9958445741966941, 'auprc': 0.9987729186344513, 'loss_val': 0.03478919867311936, 'psi': 0.997015911971797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=31 head_norm_before_train=1.788759 (no previous merge yet)
[S13] round=31 local utility u=0.118689 metrics={'f1_val': 0.57603942893098, 'auprc': 0.6735928619479299, 'loss_val': 0.6827481055955861, 'psi': 0.6150608021377599}-{'f1_val': 0.5527046364150585, 'auprc': 0.6807747797668031, 'loss_val': 0.801663260464338, 'psi': 0.6039326937557563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=31 head_norm_before_train=1.785767 cos_to_last_merge=0.9900 (last merge round=18)
[S14] round=31 local utility u=0.010165 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969661190918784, 'loss_val': 0.03136403718966513, 'psi': 0.9971306616602271}-{'f1_val': 0.9955709227491966, 'auprc': 0.9969647455281169, 'loss_val': 0.04167368139437094, 'psi': 0.9961284518607647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=31 head_norm_before_train=1.705654 cos_to_last_merge=0.7895 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.790
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.9151783423442379, 'auprc': 0.9909197793052533, 'loss_val': 0.11042988518164532, 'psi': 0.9454749171286441}-{'f1_val': 0.9814761704464512, 'auprc': 0.9908671793823587, 'loss_val': 0.07747754912828303, 'psi': 0.9852325740208142}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.721398 cos_to_last_merge=0.9724 (last merge round=20)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8758123143840778, 'auprc': 0.9922684202142229, 'loss_val': 0.5014520579533721, 'psi': 0.9223947567161358}-{'f1_val': 0.8748485197199973, 'auprc': 0.9958536100514317, 'loss_val': 0.48392021318345907, 'psi': 0.9232505558525711}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=1.556166 cos_to_last_merge=0.7505 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.751
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6108478492958677, 'auprc': 0.8039204282159931, 'loss_val': 1.20194569970631, 'psi': 0.6880768808639178}-{'f1_val': 0.6661627562722174, 'auprc': 0.8235778929558959, 'loss_val': 1.0227924098075598, 'psi': 0.7291288109456888}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.291954 cos_to_last_merge=0.9347 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.935
[S2] round=32 local utility u=0.931914 metrics={'f1_val': 0.7012985964239116, 'auprc': 0.6748802514417633, 'loss_val': 0.325976121019225, 'psi': 0.6907312584310523}-{'f1_val': 0.5069208550700021, 'auprc': 0.6941543519243324, 'loss_val': 1.0813606434192347, 'psi': 0.5818142538117342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=32 head_norm_before_train=1.347497 cos_to_last_merge=0.9329 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.8722031833012516, 'auprc': 0.915269304939076, 'loss_val': 0.26626461531504114, 'psi': 0.8894296319563813}-{'f1_val': 0.9010985055288723, 'auprc': 0.9472005770144388, 'loss_val': 0.24787301457870067, 'psi': 0.9195393341230989}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.317373 cos_to_last_merge=0.9274 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.927
[S4] round=32 local utility u=0.033443 metrics={'f1_val': 0.9593849082861483, 'auprc': 0.9667303670071872, 'loss_val': 0.22428726495435167, 'psi': 0.9623230917745639}-{'f1_val': 0.9490227702119131, 'auprc': 0.9640273661715452, 'loss_val': 0.22089230675736882, 'psi': 0.9550246085957659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=32 head_norm_before_train=1.305405 cos_to_last_merge=0.9882 (last merge round=20)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.7044790512341164, 'auprc': 0.8305501595901983, 'loss_val': 0.41449979974490925, 'psi': 0.7549074945765492}-{'f1_val': 0.700320598491359, 'auprc': 0.9909125396784348, 'loss_val': 0.24719321962243876, 'psi': 0.8165573749661894}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.427626 cos_to_last_merge=0.9777 (last merge round=19)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.741922826741174, 'auprc': 0.909751984031257, 'loss_val': 0.5250758639280607, 'psi': 0.8090544896572072}-{'f1_val': 0.822461149497326, 'auprc': 0.9337326175869399, 'loss_val': 0.3398562145352532, 'psi': 0.8669697367331715}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.639219 cos_to_last_merge=0.9876 (last merge round=16)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5711438249169535, 'auprc': 0.7852189170277583, 'loss_val': 0.7771181382570631, 'psi': 0.6567738617612754}-{'f1_val': 0.6953211283011208, 'auprc': 0.8757339222300315, 'loss_val': 0.3453502981708977, 'psi': 0.7674862458726851}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.330777 cos_to_last_merge=0.9206 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.921
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.993632801855294, 'auprc': 0.9911680596742676, 'loss_val': 0.07171174836146108, 'psi': 0.9926469049828834}-{'f1_val': 0.9932673365348732, 'auprc': 0.9991482387839429, 'loss_val': 0.08192889402459644, 'psi': 0.9956196974345011}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.666602 cos_to_last_merge=0.7961 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.796
[S9] round=32 local utility u=0.007573 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9982508382001464, 'loss_val': 0.026605077653349213, 'psi': 0.9968164178058518}-{'f1_val': 0.9941897064172326, 'auprc': 0.9981022466511313, 'loss_val': 0.03128302599667634, 'psi': 0.9957547225107921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=32 head_norm_before_train=1.948259 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9947781979029806, 'auprc': 0.9935029662622605, 'loss_val': 0.035905475849277724, 'psi': 0.9942681052466926}-{'f1_val': 0.9949509212940392, 'auprc': 0.9960476599859909, 'loss_val': 0.03549473871278416, 'psi': 0.9953896167708198}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.619248 cos_to_last_merge=0.9725 (last merge round=20)
[S11] round=32 local utility u=0.000767 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982040763347202, 'loss_val': 0.029356170679610445, 'psi': 0.9972221129176163}-{'f1_val': 0.996567470639547, 'auprc': 0.9982982787384141, 'loss_val': 0.031172666482655084, 'psi': 0.9972597938790939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=32 head_norm_before_train=1.792685 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5283986023878195, 'auprc': 0.699763045093637, 'loss_val': 0.9861083292925062, 'psi': 0.5969443794701466}-{'f1_val': 0.57603942893098, 'auprc': 0.6735928619479299, 'loss_val': 0.6827481055955861, 'psi': 0.6150608021377599}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.798828 cos_to_last_merge=0.9893 (last merge round=18)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9980052074650323, 'loss_val': 0.03402459448420821, 'psi': 0.9972703874902962}-{'f1_val': 0.997240356705793, 'auprc': 0.9969661190918784, 'loss_val': 0.03136403718966513, 'psi': 0.9971306616602271}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.725039 cos_to_last_merge=0.7879 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.788
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.8495561239660034, 'auprc': 0.9931455105885896, 'loss_val': 0.1810012435454178, 'psi': 0.9069918786150379}-{'f1_val': 0.9151783423442379, 'auprc': 0.9909197793052533, 'loss_val': 0.11042988518164532, 'psi': 0.9454749171286441}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.737146 cos_to_last_merge=0.9707 (last merge round=20)
[S16] round=32 local utility u=0.260936 metrics={'f1_val': 0.9118817618758512, 'auprc': 0.9931658728644166, 'loss_val': 0.1986898261019865, 'psi': 0.9443954062712774}-{'f1_val': 0.8758123143840778, 'auprc': 0.9922684202142229, 'loss_val': 0.5014520579533721, 'psi': 0.9223947567161358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=32 head_norm_before_train=1.573044 cos_to_last_merge=0.7474 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.747
[S17] round=32 local utility u=0.166815 metrics={'f1_val': 0.6439069216792324, 'auprc': 0.8183903598880908, 'loss_val': 1.1100802226035553, 'psi': 0.7137002969627757}-{'f1_val': 0.6108478492958677, 'auprc': 0.8039204282159931, 'loss_val': 1.20194569970631, 'psi': 0.6880768808639178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=33 head_norm_before_train=1.303432 cos_to_last_merge=0.9333 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.933
[S2] round=33 local utility u=0.005208 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6716710940548978, 'loss_val': 0.3075673325330362, 'psi': 0.6896110730451082}-{'f1_val': 0.7012985964239116, 'auprc': 0.6748802514417633, 'loss_val': 0.325976121019225, 'psi': 0.6907312584310523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=33 head_norm_before_train=1.373133 cos_to_last_merge=0.9287 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.7026724134074418, 'auprc': 0.8260348737477052, 'loss_val': 0.4569903858778727, 'psi': 0.7520173975435471}-{'f1_val': 0.8722031833012516, 'auprc': 0.915269304939076, 'loss_val': 0.26626461531504114, 'psi': 0.8894296319563813}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.325951 cos_to_last_merge=0.9250 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.925
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.6660495020196455, 'auprc': 0.922301089845348, 'loss_val': 0.477413296920883, 'psi': 0.7685501371499266}-{'f1_val': 0.9593849082861483, 'auprc': 0.9667303670071872, 'loss_val': 0.22428726495435167, 'psi': 0.9623230917745639}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.318536 cos_to_last_merge=0.9870 (last merge round=20)
[S5] round=33 local utility u=0.156716 metrics={'f1_val': 0.700320598491359, 'auprc': 0.911209906149526, 'loss_val': 0.3180965979973689, 'psi': 0.7846763215546257}-{'f1_val': 0.7044790512341164, 'auprc': 0.8305501595901983, 'loss_val': 0.41449979974490925, 'psi': 0.7549074945765492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=33 head_norm_before_train=1.439890 cos_to_last_merge=0.9756 (last merge round=19)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6992122683484373, 'auprc': 0.9146859596448801, 'loss_val': 0.5887869106696629, 'psi': 0.7854017448670144}-{'f1_val': 0.741922826741174, 'auprc': 0.909751984031257, 'loss_val': 0.5250758639280607, 'psi': 0.8090544896572072}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.645861 cos_to_last_merge=0.9873 (last merge round=16)
[S7] round=33 local utility u=1.000000 metrics={'f1_val': 0.9941187862300136, 'auprc': 0.9977895949588438, 'loss_val': 0.24344351371335848, 'psi': 0.9955871097215457}-{'f1_val': 0.5711438249169535, 'auprc': 0.7852189170277583, 'loss_val': 0.7771181382570631, 'psi': 0.6567738617612754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=33 head_norm_before_train=1.347694 cos_to_last_merge=0.9177 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.918
[S8] round=33 local utility u=0.010476 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9991727845687242, 'loss_val': 0.06820518849273594, 'psi': 0.9951919485767908}-{'f1_val': 0.993632801855294, 'auprc': 0.9911680596742676, 'loss_val': 0.07171174836146108, 'psi': 0.9926469049828834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=33 head_norm_before_train=1.676432 cos_to_last_merge=0.7955 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.795
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9956264346292261, 'loss_val': 0.02452001174297945, 'psi': 0.996000630719257}-{'f1_val': 0.9958601375429889, 'auprc': 0.9982508382001464, 'loss_val': 0.026605077653349213, 'psi': 0.9968164178058518}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.962338 (no previous merge yet)
[S10] round=33 local utility u=0.005898 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9958857073265598, 'loss_val': 0.03361177653242897, 'psi': 0.9954565371596342}-{'f1_val': 0.9947781979029806, 'auprc': 0.9935029662622605, 'loss_val': 0.035905475849277724, 'psi': 0.9942681052466926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=33 head_norm_before_train=1.645381 cos_to_last_merge=0.9705 (last merge round=20)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9951227841624052, 'auprc': 0.9986364112671381, 'loss_val': 0.02988016575994195, 'psi': 0.9965282350042983}-{'f1_val': 0.996567470639547, 'auprc': 0.9982040763347202, 'loss_val': 0.029356170679610445, 'psi': 0.9972221129176163}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.797929 (no previous merge yet)
[S13] round=33 local utility u=0.062793 metrics={'f1_val': 0.5316410244192072, 'auprc': 0.6918772314130943, 'loss_val': 0.8563195520716408, 'psi': 0.595735507216762}-{'f1_val': 0.5283986023878195, 'auprc': 0.699763045093637, 'loss_val': 0.9861083292925062, 'psi': 0.5969443794701466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=33 head_norm_before_train=1.811634 cos_to_last_merge=0.9887 (last merge round=18)
[S14] round=33 local utility u=0.004806 metrics={'f1_val': 0.9972835715563582, 'auprc': 0.9986542205453744, 'loss_val': 0.02937744711399473, 'psi': 0.9978318311519647}-{'f1_val': 0.9967805075071389, 'auprc': 0.9980052074650323, 'loss_val': 0.03402459448420821, 'psi': 0.9972703874902962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=33 head_norm_before_train=1.743470 cos_to_last_merge=0.7865 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.786
[S15] round=33 local utility u=0.477232 metrics={'f1_val': 0.9870063829398494, 'auprc': 0.9954446605094106, 'loss_val': 0.058136634578751845, 'psi': 0.990381693967674}-{'f1_val': 0.8495561239660034, 'auprc': 0.9931455105885896, 'loss_val': 0.1810012435454178, 'psi': 0.9069918786150379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=33 head_norm_before_train=1.752992 cos_to_last_merge=0.9692 (last merge round=20)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9171265623938576, 'auprc': 0.9921818445832207, 'loss_val': 0.36259161018765645, 'psi': 0.9471486752696028}-{'f1_val': 0.9118817618758512, 'auprc': 0.9931658728644166, 'loss_val': 0.1986898261019865, 'psi': 0.9443954062712774}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.591881 cos_to_last_merge=0.7446 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.745
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6137171421205704, 'auprc': 0.8075179513080791, 'loss_val': 1.2066707324474613, 'psi': 0.6912374657955739}-{'f1_val': 0.6439069216792324, 'auprc': 0.8183903598880908, 'loss_val': 1.1100802226035553, 'psi': 0.7137002969627757}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.313140 cos_to_last_merge=0.9323 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.932
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.689209365150221, 'auprc': 0.6922042114427583, 'loss_val': 0.34589749211536347, 'psi': 0.6904073036672359}-{'f1_val': 0.7015710590385817, 'auprc': 0.6716710940548978, 'loss_val': 0.3075673325330362, 'psi': 0.6896110730451082}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.397710 cos_to_last_merge=0.9246 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=34 local utility u=0.237135 metrics={'f1_val': 0.7579160247048915, 'auprc': 0.8536442169971192, 'loss_val': 0.3970092712126329, 'psi': 0.7962073016217825}-{'f1_val': 0.7026724134074418, 'auprc': 0.8260348737477052, 'loss_val': 0.4569903858778727, 'psi': 0.7520173975435471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=34 head_norm_before_train=1.333027 cos_to_last_merge=0.9235 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.924
[S4] round=34 local utility u=0.990104 metrics={'f1_val': 0.9385322408649533, 'auprc': 0.9563850910624394, 'loss_val': 0.234353869255647, 'psi': 0.9456733809439477}-{'f1_val': 0.6660495020196455, 'auprc': 0.922301089845348, 'loss_val': 0.477413296920883, 'psi': 0.7685501371499266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=34 head_norm_before_train=1.331555 cos_to_last_merge=0.9859 (last merge round=20)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8612059721103998, 'loss_val': 0.326627348912582, 'psi': 0.7646747479389753}-{'f1_val': 0.700320598491359, 'auprc': 0.911209906149526, 'loss_val': 0.3180965979973689, 'psi': 0.7846763215546257}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.452749 cos_to_last_merge=0.9736 (last merge round=19)
[S6] round=34 local utility u=0.317204 metrics={'f1_val': 0.7793505010172753, 'auprc': 0.9322615411543392, 'loss_val': 0.4879349536041654, 'psi': 0.8405149170721009}-{'f1_val': 0.6992122683484373, 'auprc': 0.9146859596448801, 'loss_val': 0.5887869106696629, 'psi': 0.7854017448670144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=34 head_norm_before_train=1.652145 cos_to_last_merge=0.9868 (last merge round=16)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5833930913783931, 'auprc': 0.7924581946143462, 'loss_val': 0.7007116727219452, 'psi': 0.6670191326727744}-{'f1_val': 0.9941187862300136, 'auprc': 0.9977895949588438, 'loss_val': 0.24344351371335848, 'psi': 0.9955871097215457}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.366363 cos_to_last_merge=0.9142 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.914
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9908201289063332, 'loss_val': 0.06224032138055084, 'psi': 0.9925032538312313}-{'f1_val': 0.9925380579155019, 'auprc': 0.9991727845687242, 'loss_val': 0.06820518849273594, 'psi': 0.9951919485767908}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.685350 cos_to_last_merge=0.7947 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.795
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9908329001136983, 'auprc': 0.997714809164628, 'loss_val': 0.0355052889683966, 'psi': 0.9935856637340701}-{'f1_val': 0.9962500947792776, 'auprc': 0.9956264346292261, 'loss_val': 0.02452001174297945, 'psi': 0.996000630719257}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.975272 (no previous merge yet)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9947406295555868, 'loss_val': 0.03248568663808358, 'psi': 0.9951302524386674}-{'f1_val': 0.9951704237150173, 'auprc': 0.9958857073265598, 'loss_val': 0.03361177653242897, 'psi': 0.9954565371596342}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.668618 cos_to_last_merge=0.9687 (last merge round=20)
[S11] round=34 local utility u=0.002842 metrics={'f1_val': 0.9958445741966941, 'auprc': 0.9985905317270912, 'loss_val': 0.028389190701484, 'psi': 0.996942957208853}-{'f1_val': 0.9951227841624052, 'auprc': 0.9986364112671381, 'loss_val': 0.02988016575994195, 'psi': 0.9965282350042983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=34 head_norm_before_train=1.803407 (no previous merge yet)
[S13] round=34 local utility u=0.318752 metrics={'f1_val': 0.6115876243378071, 'auprc': 0.6550843712702422, 'loss_val': 0.5881171643174254, 'psi': 0.6289863231107812}-{'f1_val': 0.5316410244192072, 'auprc': 0.6918772314130943, 'loss_val': 0.8563195520716408, 'psi': 0.595735507216762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=34 head_norm_before_train=1.820911 cos_to_last_merge=0.9881 (last merge round=18)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9969661493342139, 'loss_val': 0.030086255585074325, 'psi': 0.9971009326937779}-{'f1_val': 0.9972835715563582, 'auprc': 0.9986542205453744, 'loss_val': 0.02937744711399473, 'psi': 0.9978318311519647}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.761820 cos_to_last_merge=0.7850 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.785
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7010713433702593, 'auprc': 0.8193642129504741, 'loss_val': 0.5989539987843422, 'psi': 0.7483884912023453}-{'f1_val': 0.9870063829398494, 'auprc': 0.9954446605094106, 'loss_val': 0.058136634578751845, 'psi': 0.990381693967674}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.765776 cos_to_last_merge=0.9679 (last merge round=20)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8570363391168035, 'auprc': 0.9847564862042313, 'loss_val': 0.7037327295986846, 'psi': 0.9081243979517746}-{'f1_val': 0.9171265623938576, 'auprc': 0.9921818445832207, 'loss_val': 0.36259161018765645, 'psi': 0.9471486752696028}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.615660 cos_to_last_merge=0.7408 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.741
[S17] round=34 local utility u=0.142570 metrics={'f1_val': 0.6319684181854276, 'auprc': 0.8304641130671084, 'loss_val': 1.0998778438173635, 'psi': 0.7113666961381}-{'f1_val': 0.6137171421205704, 'auprc': 0.8075179513080791, 'loss_val': 1.2066707324474613, 'psi': 0.6912374657955739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=35 head_norm_before_train=1.322974 cos_to_last_merge=0.9315 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.931
[S2] round=35 local utility u=0.146875 metrics={'f1_val': 0.7008493303286023, 'auprc': 0.7537690717400138, 'loss_val': 0.3066819161061471, 'psi': 0.7220172268931669}-{'f1_val': 0.689209365150221, 'auprc': 0.6922042114427583, 'loss_val': 0.34589749211536347, 'psi': 0.6904073036672359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=35 head_norm_before_train=1.418702 cos_to_last_merge=0.9211 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.7368856196133611, 'auprc': 0.8297078998179366, 'loss_val': 0.418930891078864, 'psi': 0.7740145316951913}-{'f1_val': 0.7579160247048915, 'auprc': 0.8536442169971192, 'loss_val': 0.3970092712126329, 'psi': 0.7962073016217825}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.341712 cos_to_last_merge=0.9218 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.922
[S4] round=35 local utility u=0.053532 metrics={'f1_val': 0.9461793005193786, 'auprc': 0.974604294027806, 'loss_val': 0.22782895572827555, 'psi': 0.9575492979227496}-{'f1_val': 0.9385322408649533, 'auprc': 0.9563850910624394, 'loss_val': 0.234353869255647, 'psi': 0.9456733809439477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=35 head_norm_before_train=1.342686 cos_to_last_merge=0.9839 (last merge round=20)
[S5] round=35 local utility u=0.216327 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9893703990765232, 'loss_val': 0.2784656614752072, 'psi': 0.8159405187254247}-{'f1_val': 0.700320598491359, 'auprc': 0.8612059721103998, 'loss_val': 0.326627348912582, 'psi': 0.7646747479389753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=35 head_norm_before_train=1.468448 cos_to_last_merge=0.9712 (last merge round=19)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.690266628349896, 'auprc': 0.9156069410207159, 'loss_val': 0.6456561394571385, 'psi': 0.7804027534182241}-{'f1_val': 0.7793505010172753, 'auprc': 0.9322615411543392, 'loss_val': 0.4879349536041654, 'psi': 0.8405149170721009}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.657432 cos_to_last_merge=0.9863 (last merge round=16)
[S7] round=35 local utility u=0.477013 metrics={'f1_val': 0.6728231692010683, 'auprc': 0.8322970710285755, 'loss_val': 0.4027825203805355, 'psi': 0.7366127299320713}-{'f1_val': 0.5833930913783931, 'auprc': 0.7924581946143462, 'loss_val': 0.7007116727219452, 'psi': 0.6670191326727744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=35 head_norm_before_train=1.382985 cos_to_last_merge=0.9112 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.911
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9867772337158929, 'loss_val': 0.06022840940723711, 'psi': 0.9908860957550552}-{'f1_val': 0.9936253371144965, 'auprc': 0.9908201289063332, 'loss_val': 0.06224032138055084, 'psi': 0.9925032538312313}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.694758 cos_to_last_merge=0.7941 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.794
[S9] round=35 local utility u=0.013487 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.997911825587084, 'loss_val': 0.02926258308539442, 'psi': 0.9956785540851731}-{'f1_val': 0.9908329001136983, 'auprc': 0.997714809164628, 'loss_val': 0.0355052889683966, 'psi': 0.9935856637340701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=35 head_norm_before_train=1.989889 (no previous merge yet)
[S10] round=35 local utility u=0.000993 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.995116037261671, 'loss_val': 0.031625493147374936, 'psi': 0.995280415521101}-{'f1_val': 0.9953900010273877, 'auprc': 0.9947406295555868, 'loss_val': 0.03248568663808358, 'psi': 0.9951302524386674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] sending update (kind=head size=1790 to 1 peers)
[S11] START round=35 head_norm_before_train=1.687786 cos_to_last_merge=0.9673 (last merge round=20)
[S11] round=35 local utility u=0.003405 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9984874486424373, 'loss_val': 0.02560707339145549, 'psi': 0.9973354618407031}-{'f1_val': 0.9958445741966941, 'auprc': 0.9985905317270912, 'loss_val': 0.028389190701484, 'psi': 0.996942957208853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=35 head_norm_before_train=1.809483 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5444102446939301, 'auprc': 0.6981746407639333, 'loss_val': 0.9844600453643219, 'psi': 0.6059160031219313}-{'f1_val': 0.6115876243378071, 'auprc': 0.6550843712702422, 'loss_val': 0.5881171643174254, 'psi': 0.6289863231107812}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.826014 cos_to_last_merge=0.9877 (last merge round=18)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969678636630791, 'loss_val': 0.029020660442107698, 'psi': 0.9969856503598307}-{'f1_val': 0.9971907882668205, 'auprc': 0.9969661493342139, 'loss_val': 0.030086255585074325, 'psi': 0.9971009326937779}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.778021 cos_to_last_merge=0.7837 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.784
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6998700924264248, 'auprc': 0.8040928126419453, 'loss_val': 0.6125111160815759, 'psi': 0.741559180512633}-{'f1_val': 0.7010713433702593, 'auprc': 0.8193642129504741, 'loss_val': 0.5989539987843422, 'psi': 0.7483884912023453}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.773587 cos_to_last_merge=0.9669 (last merge round=20)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.7964290547893814, 'auprc': 0.9254113289935553, 'loss_val': 0.9001215432096004, 'psi': 0.8480219644710509}-{'f1_val': 0.8570363391168035, 'auprc': 0.9847564862042313, 'loss_val': 0.7037327295986846, 'psi': 0.9081243979517746}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.635248 cos_to_last_merge=0.7375 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.737
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.4766237326993988, 'auprc': 0.7782205398508729, 'loss_val': 1.8685680530881967, 'psi': 0.5972624555599884}-{'f1_val': 0.6319684181854276, 'auprc': 0.8304641130671084, 'loss_val': 1.0998778438173635, 'psi': 0.7113666961381}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.331621 cos_to_last_merge=0.9305 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.931
[S2] round=36 local utility u=0.000865 metrics={'f1_val': 0.7100779132589743, 'auprc': 0.746536076321846, 'loss_val': 0.3386240693489189, 'psi': 0.724661178484123}-{'f1_val': 0.7008493303286023, 'auprc': 0.7537690717400138, 'loss_val': 0.3066819161061471, 'psi': 0.7220172268931669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=36 head_norm_before_train=1.435885 cos_to_last_merge=0.9183 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.918
[S3] round=36 local utility u=1.000000 metrics={'f1_val': 0.9684582483455857, 'auprc': 0.9995024393773765, 'loss_val': 0.08512914672283635, 'psi': 0.980875924758302}-{'f1_val': 0.7368856196133611, 'auprc': 0.8297078998179366, 'loss_val': 0.418930891078864, 'psi': 0.7740145316951913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=36 head_norm_before_train=1.352034 cos_to_last_merge=0.9203 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9378024388030464, 'auprc': 0.944564558960252, 'loss_val': 0.24596483577583392, 'psi': 0.9405072868659285}-{'f1_val': 0.9461793005193786, 'auprc': 0.974604294027806, 'loss_val': 0.22782895572827555, 'psi': 0.9575492979227496}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.353097 cos_to_last_merge=0.9825 (last merge round=20)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8220249555377945, 'loss_val': 0.3340347971034397, 'psi': 0.7490023413099332}-{'f1_val': 0.700320598491359, 'auprc': 0.9893703990765232, 'loss_val': 0.2784656614752072, 'psi': 0.8159405187254247}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.484108 cos_to_last_merge=0.9688 (last merge round=19)
[S6] round=36 local utility u=0.296202 metrics={'f1_val': 0.7658529091675663, 'auprc': 0.9267029831586318, 'loss_val': 0.540058805423066, 'psi': 0.8301929387639925}-{'f1_val': 0.690266628349896, 'auprc': 0.9156069410207159, 'loss_val': 0.6456561394571385, 'psi': 0.7804027534182241}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=36 head_norm_before_train=1.661834 cos_to_last_merge=0.9858 (last merge round=16)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6658751212032741, 'auprc': 0.8103409020841494, 'loss_val': 0.4675581773015161, 'psi': 0.7236614335556242}-{'f1_val': 0.6728231692010683, 'auprc': 0.8322970710285755, 'loss_val': 0.4027825203805355, 'psi': 0.7366127299320713}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.398671 cos_to_last_merge=0.9085 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.909
[S8] round=36 local utility u=0.015699 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9983982058943265, 'loss_val': 0.05717008311896059, 'psi': 0.9948821171070317}-{'f1_val': 0.9936253371144965, 'auprc': 0.9867772337158929, 'loss_val': 0.06022840940723711, 'psi': 0.9908860957550552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=36 head_norm_before_train=1.704733 cos_to_last_merge=0.7932 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.793
[S9] round=36 local utility u=0.009903 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9974339753415974, 'loss_val': 0.023020294729486614, 'psi': 0.9969870791153421}-{'f1_val': 0.9941897064172326, 'auprc': 0.997911825587084, 'loss_val': 0.02926258308539442, 'psi': 0.9956785540851731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=36 head_norm_before_train=2.005376 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9945437664365436, 'loss_val': 0.031148608779609302, 'psi': 0.9950515071910501}-{'f1_val': 0.9953900010273877, 'auprc': 0.995116037261671, 'loss_val': 0.031625493147374936, 'psi': 0.995280415521101}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.705403 cos_to_last_merge=0.9658 (last merge round=20)
[S11] round=36 local utility u=0.000080 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982574035405365, 'loss_val': 0.02475726506832128, 'psi': 0.9972434437999429}-{'f1_val': 0.996567470639547, 'auprc': 0.9984874486424373, 'loss_val': 0.02560707339145549, 'psi': 0.9973354618407031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=36 head_norm_before_train=1.814914 (no previous merge yet)
[S13] round=36 local utility u=0.160818 metrics={'f1_val': 0.5823040657289769, 'auprc': 0.6843398332788464, 'loss_val': 0.8486832419592985, 'psi': 0.6231183727489247}-{'f1_val': 0.5444102446939301, 'auprc': 0.6981746407639333, 'loss_val': 0.9844600453643219, 'psi': 0.6059160031219313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=36 head_norm_before_train=1.834571 cos_to_last_merge=0.9871 (last merge round=18)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9812826630753781, 'auprc': 0.9976479530222037, 'loss_val': 0.05195673204743691, 'psi': 0.9878287790541084}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969678636630791, 'loss_val': 0.029020660442107698, 'psi': 0.9969856503598307}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.792607 cos_to_last_merge=0.7825 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.783
[S15] round=36 local utility u=1.000000 metrics={'f1_val': 0.9842884566625083, 'auprc': 0.9917374305254375, 'loss_val': 0.09956701803256744, 'psi': 0.9872680462076799}-{'f1_val': 0.6998700924264248, 'auprc': 0.8040928126419453, 'loss_val': 0.6125111160815759, 'psi': 0.741559180512633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=36 head_norm_before_train=1.783061 cos_to_last_merge=0.9659 (last merge round=20)
[S16] round=36 local utility u=1.000000 metrics={'f1_val': 0.9923873926502049, 'auprc': 0.9952555808276363, 'loss_val': 0.0375648499195233, 'psi': 0.9935346679211775}-{'f1_val': 0.7964290547893814, 'auprc': 0.9254113289935553, 'loss_val': 0.9001215432096004, 'psi': 0.8480219644710509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=36 head_norm_before_train=1.655370 cos_to_last_merge=0.7349 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.735
[S17] round=36 local utility u=0.294512 metrics={'f1_val': 0.5408884827724636, 'auprc': 0.781718918986283, 'loss_val': 1.6756277377276398, 'psi': 0.6372206572579914}-{'f1_val': 0.4766237326993988, 'auprc': 0.7782205398508729, 'loss_val': 1.8685680530881967, 'psi': 0.5972624555599884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=37 head_norm_before_train=1.339642 cos_to_last_merge=0.9295 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.930
[S2] round=37 local utility u=0.110980 metrics={'f1_val': 0.7090882904618524, 'auprc': 0.813103048739191, 'loss_val': 0.31042797237499936, 'psi': 0.7506941937727878}-{'f1_val': 0.7100779132589743, 'auprc': 0.746536076321846, 'loss_val': 0.3386240693489189, 'psi': 0.724661178484123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=37 head_norm_before_train=1.449986 cos_to_last_merge=0.9160 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.916
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.6458778226444668, 'auprc': 0.809529879390733, 'loss_val': 0.5992009499813779, 'psi': 0.7113386453429733}-{'f1_val': 0.9684582483455857, 'auprc': 0.9995024393773765, 'loss_val': 0.08512914672283635, 'psi': 0.980875924758302}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.361700 cos_to_last_merge=0.9190 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.919
[S4] round=37 local utility u=0.040747 metrics={'f1_val': 0.939917329889907, 'auprc': 0.9689675520552171, 'loss_val': 0.25036819671426214, 'psi': 0.951537418756031}-{'f1_val': 0.9378024388030464, 'auprc': 0.944564558960252, 'loss_val': 0.24596483577583392, 'psi': 0.9405072868659285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=37 head_norm_before_train=1.364669 cos_to_last_merge=0.9819 (last merge round=20)
[S5] round=37 local utility u=0.296061 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9907160425868935, 'loss_val': 0.24798698991803209, 'psi': 0.8164787761295729}-{'f1_val': 0.700320598491359, 'auprc': 0.8220249555377945, 'loss_val': 0.3340347971034397, 'psi': 0.7490023413099332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=37 head_norm_before_train=1.499717 cos_to_last_merge=0.9666 (last merge round=19)
[S6] round=37 local utility u=0.118398 metrics={'f1_val': 0.7960366297014992, 'auprc': 0.9313078755572127, 'loss_val': 0.498180266438173, 'psi': 0.8501451280437846}-{'f1_val': 0.7658529091675663, 'auprc': 0.9267029831586318, 'loss_val': 0.540058805423066, 'psi': 0.8301929387639925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=37 head_norm_before_train=1.667838 cos_to_last_merge=0.9851 (last merge round=16)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.6045596039701024, 'auprc': 0.7962675116809057, 'loss_val': 0.6914272222004535, 'psi': 0.6812427670544238}-{'f1_val': 0.6658751212032741, 'auprc': 0.8103409020841494, 'loss_val': 0.4675581773015161, 'psi': 0.7236614335556242}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.414900 cos_to_last_merge=0.9058 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.906
[S8] round=37 local utility u=0.004839 metrics={'f1_val': 0.993632801855294, 'auprc': 0.9982481676286626, 'loss_val': 0.053610467732412986, 'psi': 0.9954789481646416}-{'f1_val': 0.9925380579155019, 'auprc': 0.9983982058943265, 'loss_val': 0.05717008311896059, 'psi': 0.9948821171070317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=37 head_norm_before_train=1.714567 cos_to_last_merge=0.7924 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.792
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9979816870287198, 'loss_val': 0.02525395017434084, 'psi': 0.9962069254599653}-{'f1_val': 0.9966891482978385, 'auprc': 0.9974339753415974, 'loss_val': 0.023020294729486614, 'psi': 0.9969870791153421}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.020543 (no previous merge yet)
[S10] round=37 local utility u=0.000888 metrics={'f1_val': 0.9949509212940392, 'auprc': 0.9960438144550008, 'loss_val': 0.031238080676853793, 'psi': 0.9953880785584239}-{'f1_val': 0.9953900010273877, 'auprc': 0.9945437664365436, 'loss_val': 0.031148608779609302, 'psi': 0.9950515071910501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] sending update (kind=head size=1790 to 1 peers)
[S11] START round=37 head_norm_before_train=1.722333 cos_to_last_merge=0.9645 (last merge round=20)
[S11] round=37 local utility u=0.000865 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9986406743861453, 'loss_val': 0.024177563349967013, 'psi': 0.9973967521381863}-{'f1_val': 0.996567470639547, 'auprc': 0.9982574035405365, 'loss_val': 0.02475726506832128, 'psi': 0.9972434437999429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=37 head_norm_before_train=1.819233 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5742177780109179, 'auprc': 0.665876971224806, 'loss_val': 0.7702560706268997, 'psi': 0.6108814552964732}-{'f1_val': 0.5823040657289769, 'auprc': 0.6843398332788464, 'loss_val': 0.8486832419592985, 'psi': 0.6231183727489247}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.844355 cos_to_last_merge=0.9865 (last merge round=18)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9421443098158218, 'auprc': 0.9955856739989009, 'loss_val': 0.10164379908649547, 'psi': 0.9635208554890533}-{'f1_val': 0.9812826630753781, 'auprc': 0.9976479530222037, 'loss_val': 0.05195673204743691, 'psi': 0.9878287790541084}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.805660 cos_to_last_merge=0.7816 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.782
[S15] round=37 local utility u=0.034290 metrics={'f1_val': 0.9877454362011411, 'auprc': 0.9946929562271376, 'loss_val': 0.06059502961430455, 'psi': 0.9905244442115397}-{'f1_val': 0.9842884566625083, 'auprc': 0.9917374305254375, 'loss_val': 0.09956701803256744, 'psi': 0.9872680462076799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=37 head_norm_before_train=1.794209 cos_to_last_merge=0.9648 (last merge round=20)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9394552905275351, 'auprc': 0.9922849189326551, 'loss_val': 0.249492315629949, 'psi': 0.960587141889583}-{'f1_val': 0.9923873926502049, 'auprc': 0.9952555808276363, 'loss_val': 0.0375648499195233, 'psi': 0.9935346679211775}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.675486 cos_to_last_merge=0.7332 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.733
[S17] round=37 local utility u=1.000000 metrics={'f1_val': 0.809919980844244, 'auprc': 0.8956068158469064, 'loss_val': 0.8489093425442938, 'psi': 0.844194714845309}-{'f1_val': 0.5408884827724636, 'auprc': 0.781718918986283, 'loss_val': 1.6756277377276398, 'psi': 0.6372206572579914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=38 head_norm_before_train=1.349346 cos_to_last_merge=0.9283 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=38 local utility u=0.298391 metrics={'f1_val': 0.8043302131933368, 'auprc': 0.8320343367066388, 'loss_val': 0.3418905931112424, 'psi': 0.8154118625986576}-{'f1_val': 0.7090882904618524, 'auprc': 0.813103048739191, 'loss_val': 0.31042797237499936, 'psi': 0.7506941937727878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=38 head_norm_before_train=1.460305 cos_to_last_merge=0.9142 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.914
[S3] round=38 local utility u=1.000000 metrics={'f1_val': 0.9914901573534766, 'auprc': 0.9995351487917035, 'loss_val': 0.15071676467785228, 'psi': 0.9947081539287674}-{'f1_val': 0.6458778226444668, 'auprc': 0.809529879390733, 'loss_val': 0.5992009499813779, 'psi': 0.7113386453429733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=38 head_norm_before_train=1.371480 cos_to_last_merge=0.9174 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9394024233051609, 'auprc': 0.9684575648116184, 'loss_val': 0.25885447274873924, 'psi': 0.9510244799077439}-{'f1_val': 0.939917329889907, 'auprc': 0.9689675520552171, 'loss_val': 0.25036819671426214, 'psi': 0.951537418756031}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.377343 cos_to_last_merge=0.9814 (last merge round=20)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9250634446347932, 'loss_val': 0.3262275338334311, 'psi': 0.7902177369487327}-{'f1_val': 0.700320598491359, 'auprc': 0.9907160425868935, 'loss_val': 0.24798698991803209, 'psi': 0.8164787761295729}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.514161 cos_to_last_merge=0.9646 (last merge round=19)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.7646224548580931, 'auprc': 0.9293515115035365, 'loss_val': 0.5739281820922888, 'psi': 0.8305140775162705}-{'f1_val': 0.7960366297014992, 'auprc': 0.9313078755572127, 'loss_val': 0.498180266438173, 'psi': 0.8501451280437846}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.674624 cos_to_last_merge=0.9846 (last merge round=16)
[S7] round=38 local utility u=0.027215 metrics={'f1_val': 0.6120904842276973, 'auprc': 0.794246476185148, 'loss_val': 0.6761191585876348, 'psi': 0.6849528810106775}-{'f1_val': 0.6045596039701024, 'auprc': 0.7962675116809057, 'loss_val': 0.6914272222004535, 'psi': 0.6812427670544238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=38 head_norm_before_train=1.431889 cos_to_last_merge=0.9028 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.903
[S8] round=38 local utility u=0.002162 metrics={'f1_val': 0.993632801855294, 'auprc': 0.9989902766282148, 'loss_val': 0.0515130038139027, 'psi': 0.9957757917644624}-{'f1_val': 0.993632801855294, 'auprc': 0.9982481676286626, 'loss_val': 0.053610467732412986, 'psi': 0.9954789481646416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=38 head_norm_before_train=1.724747 cos_to_last_merge=0.7917 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.792
[S9] round=38 local utility u=0.003224 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9977727280421772, 'loss_val': 0.023197484962017956, 'psi': 0.9966251737426641}-{'f1_val': 0.9950237510807955, 'auprc': 0.9979816870287198, 'loss_val': 0.02525395017434084, 'psi': 0.9962069254599653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=38 head_norm_before_train=2.035017 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9947091308659339, 'loss_val': 0.030763061143841277, 'psi': 0.9949859065753839}-{'f1_val': 0.9949509212940392, 'auprc': 0.9960438144550008, 'loss_val': 0.031238080676853793, 'psi': 0.9953880785584239}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.738767 cos_to_last_merge=0.9632 (last merge round=20)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9958445741966941, 'auprc': 0.9985968093349422, 'loss_val': 0.02427665728568456, 'psi': 0.9969454682519934}-{'f1_val': 0.996567470639547, 'auprc': 0.9986406743861453, 'loss_val': 0.024177563349967013, 'psi': 0.9973967521381863}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.824607 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5755107433228034, 'auprc': 0.6522478050619436, 'loss_val': 0.8753208624043961, 'psi': 0.6062055680184595}-{'f1_val': 0.5742177780109179, 'auprc': 0.665876971224806, 'loss_val': 0.7702560706268997, 'psi': 0.6108814552964732}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.850606 cos_to_last_merge=0.9859 (last merge round=18)
[S14] round=38 local utility u=0.203031 metrics={'f1_val': 0.9975988769325926, 'auprc': 0.9970622148947229, 'loss_val': 0.03273963968353406, 'psi': 0.9973842121174448}-{'f1_val': 0.9421443098158218, 'auprc': 0.9955856739989009, 'loss_val': 0.10164379908649547, 'psi': 0.9635208554890533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S14] sending update (kind=head size=1808 to 1 peers)
[S15] START round=38 head_norm_before_train=1.818169 cos_to_last_merge=0.7808 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.781
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7009180804352899, 'auprc': 0.7990672136856729, 'loss_val': 0.6618959290196532, 'psi': 0.7401777337354432}-{'f1_val': 0.9877454362011411, 'auprc': 0.9946929562271376, 'loss_val': 0.06059502961430455, 'psi': 0.9905244442115397}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.807129 cos_to_last_merge=0.9636 (last merge round=20)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8533302473738523, 'auprc': 0.9856275939801689, 'loss_val': 0.8049312668183283, 'psi': 0.9062491860163789}-{'f1_val': 0.9394552905275351, 'auprc': 0.9922849189326551, 'loss_val': 0.249492315629949, 'psi': 0.960587141889583}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.690528 cos_to_last_merge=0.7318 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.732
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.5999289227233129, 'auprc': 0.8010294649793334, 'loss_val': 1.4167455376590852, 'psi': 0.6803691396257211}-{'f1_val': 0.809919980844244, 'auprc': 0.8956068158469064, 'loss_val': 0.8489093425442938, 'psi': 0.844194714845309}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.362776 cos_to_last_merge=0.9267 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.927
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.569920116973371, 'auprc': 0.6827336032297701, 'loss_val': 0.8067099046063648, 'psi': 0.6150455114759306}-{'f1_val': 0.8043302131933368, 'auprc': 0.8320343367066388, 'loss_val': 0.3418905931112424, 'psi': 0.8154118625986576}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.615 u=0.0000 p_local=0.1178 f1=0.570 auprc=0.683 bytes=50365
[S3] START round=39 head_norm_before_train=1.468473 cos_to_last_merge=0.9129 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.913
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.5863868305653417, 'auprc': 0.8034252096568458, 'loss_val': 0.7665355389673706, 'psi': 0.6732021822019434}-{'f1_val': 0.9914901573534766, 'auprc': 0.9995351487917035, 'loss_val': 0.15071676467785228, 'psi': 0.9947081539287674}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.673 u=0.0000 p_local=0.3184 f1=0.586 auprc=0.803 bytes=37721
[S4] START round=39 head_norm_before_train=1.379388 cos_to_last_merge=0.9159 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.916
[S4] round=39 local utility u=0.004545 metrics={'f1_val': 0.9403361470070523, 'auprc': 0.9709791447238111, 'loss_val': 0.2629322652830891, 'psi': 0.9525933460937558}-{'f1_val': 0.9394024233051609, 'auprc': 0.9684575648116184, 'loss_val': 0.25885447274873924, 'psi': 0.9510244799077439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S4] r=40 psi=0.953 u=0.0045 p_local=0.0920 f1=0.940 auprc=0.971 bytes=50294
[S5] START round=39 head_norm_before_train=1.387507 cos_to_last_merge=0.9801 (last merge round=20)
[S5] round=39 local utility u=0.092876 metrics={'f1_val': 0.700320598491359, 'auprc': 0.971093590932225, 'loss_val': 0.2785665767901397, 'psi': 0.8086297954677054}-{'f1_val': 0.700320598491359, 'auprc': 0.9250634446347932, 'loss_val': 0.3262275338334311, 'psi': 0.7902177369487327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S5] r=40 psi=0.809 u=0.0929 p_local=0.1001 f1=0.700 auprc=0.971 bytes=46708
[S6] START round=39 head_norm_before_train=1.526324 cos_to_last_merge=0.9627 (last merge round=19)
[S6] round=39 local utility u=0.226843 metrics={'f1_val': 0.8214385148582664, 'auprc': 0.9331704258552529, 'loss_val': 0.4725949522340515, 'psi': 0.866131279257061}-{'f1_val': 0.7646224548580931, 'auprc': 0.9293515115035365, 'loss_val': 0.5739281820922888, 'psi': 0.8305140775162705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S6] r=40 psi=0.866 u=0.2268 p_local=0.1705 f1=0.821 auprc=0.933 bytes=41369
[S7] START round=39 head_norm_before_train=1.678989 cos_to_last_merge=0.9843 (last merge round=16)
[S7] round=39 local utility u=0.439861 metrics={'f1_val': 0.6783905866825686, 'auprc': 0.8441607779628986, 'loss_val': 0.3439405143855839, 'psi': 0.7446986631947006}-{'f1_val': 0.6120904842276973, 'auprc': 0.794246476185148, 'loss_val': 0.6761191585876348, 'psi': 0.6849528810106775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S7] r=40 psi=0.745 u=0.4399 p_local=0.2581 f1=0.678 auprc=0.844 bytes=46808
[S8] START round=39 head_norm_before_train=1.448071 cos_to_last_merge=0.9002 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.900
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9932775562128633, 'auprc': 0.9886339128781314, 'loss_val': 0.05494287060151749, 'psi': 0.9914200988789705}-{'f1_val': 0.993632801855294, 'auprc': 0.9989902766282148, 'loss_val': 0.0515130038139027, 'psi': 0.9957757917644624}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.991 u=0.0000 p_local=0.0084 f1=0.993 auprc=0.989 bytes=55754
[S9] START round=39 head_norm_before_train=1.734052 cos_to_last_merge=0.7910 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.791
[S9] round=39 local utility u=0.001700 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9969139287279227, 'loss_val': 0.022023031637372636, 'psi': 0.9967618785795039}-{'f1_val': 0.9958601375429889, 'auprc': 0.9977727280421772, 'loss_val': 0.023197484962017956, 'psi': 0.9966251737426641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S9] r=40 psi=0.997 u=0.0017 p_local=0.0056 f1=0.997 auprc=0.997 bytes=48545
[S10] START round=39 head_norm_before_train=2.045667 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9949746627565785, 'auprc': 0.9945648950403986, 'loss_val': 0.030387138867940987, 'psi': 0.9948107556701065}-{'f1_val': 0.9951704237150173, 'auprc': 0.9947091308659339, 'loss_val': 0.030763061143841277, 'psi': 0.9949859065753839}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0024 f1=0.995 auprc=0.995 bytes=53891
[S11] START round=39 head_norm_before_train=1.751941 cos_to_last_merge=0.9621 (last merge round=20)
[S11] round=39 local utility u=0.000755 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9979835210958409, 'loss_val': 0.023813997959932585, 'psi': 0.9969887882514041}-{'f1_val': 0.9958445741966941, 'auprc': 0.9985968093349422, 'loss_val': 0.02427665728568456, 'psi': 0.9969454682519934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S11] r=40 psi=0.997 u=0.0008 p_local=0.0029 f1=0.996 auprc=0.998 bytes=48581
[S13] START round=39 head_norm_before_train=1.828960 (no previous merge yet)
[S13] round=39 local utility u=0.147171 metrics={'f1_val': 0.5972345363766722, 'auprc': 0.6618745542014349, 'loss_val': 0.7402022434252672, 'psi': 0.6230905435065773}-{'f1_val': 0.5755107433228034, 'auprc': 0.6522478050619436, 'loss_val': 0.8753208624043961, 'psi': 0.6062055680184595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S13] r=40 psi=0.623 u=0.1472 p_local=0.0813 f1=0.597 auprc=0.662 bytes=37724
[S14] START round=39 head_norm_before_train=1.856606 cos_to_last_merge=0.9855 (last merge round=18)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970635179406248, 'loss_val': 0.029313500437958284, 'psi': 0.997023912070849}-{'f1_val': 0.9975988769325926, 'auprc': 0.9970622148947229, 'loss_val': 0.03273963968353406, 'psi': 0.9973842121174448}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.997 u=0.0000 p_local=0.0348 f1=0.997 auprc=0.997 bytes=43204
[S15] START round=39 head_norm_before_train=1.828705 cos_to_last_merge=0.7802 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.780
[S15] round=39 local utility u=0.549415 metrics={'f1_val': 0.7628503355019719, 'auprc': 0.9786474421983347, 'loss_val': 0.4733997004896475, 'psi': 0.8491691781805171}-{'f1_val': 0.7009180804352899, 'auprc': 0.7990672136856729, 'loss_val': 0.6618959290196532, 'psi': 0.7401777337354432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S15] r=40 psi=0.849 u=0.5494 p_local=0.2867 f1=0.763 auprc=0.979 bytes=41319
[S16] START round=39 head_norm_before_train=1.817686 cos_to_last_merge=0.9624 (last merge round=20)
[S16] round=39 local utility u=0.817310 metrics={'f1_val': 0.9921683156157222, 'auprc': 0.997038446784843, 'loss_val': 0.03757206835294263, 'psi': 0.9941163680833706}-{'f1_val': 0.8533302473738523, 'auprc': 0.9856275939801689, 'loss_val': 0.8049312668183283, 'psi': 0.9062491860163789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S16] r=40 psi=0.994 u=0.8173 p_local=0.2926 f1=0.992 auprc=0.997 bytes=34172
[S17] START round=39 head_norm_before_train=1.698702 cos_to_last_merge=0.7309 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.731
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5904326747390765, 'auprc': 0.8034448512798258, 'loss_val': 1.434901993716288, 'psi': 0.6756375453553762}-{'f1_val': 0.5999289227233129, 'auprc': 0.8010294649793334, 'loss_val': 1.4167455376590852, 'psi': 0.6803691396257211}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.676 u=0.0000 p_local=0.2070 f1=0.590 auprc=0.803 bytes=39545
[S2] START round=40 head_norm_before_train=1.379173 cos_to_last_merge=0.9246 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.925
[S2] round=40 local utility u=0.884819 metrics={'f1_val': 0.7133160108341251, 'auprc': 0.8608556674959221, 'loss_val': 0.43181260360328333, 'psi': 0.772331873498844}-{'f1_val': 0.569920116973371, 'auprc': 0.6827336032297701, 'loss_val': 0.8067099046063648, 'psi': 0.6150455114759306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=40 head_norm_before_train=1.476207 cos_to_last_merge=0.9118 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=40 local utility u=1.000000 metrics={'f1_val': 0.981109793383862, 'auprc': 0.9993975061931265, 'loss_val': 0.08040315620844861, 'psi': 0.9884248785075678}-{'f1_val': 0.5863868305653417, 'auprc': 0.8034252096568458, 'loss_val': 0.7665355389673706, 'psi': 0.6732021822019434}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=40 head_norm_before_train=1.389829 cos_to_last_merge=0.9140 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.914
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9392819486040516, 'auprc': 0.9465857206183772, 'loss_val': 0.2916372631012878, 'psi': 0.9422034574097818}-{'f1_val': 0.9403361470070523, 'auprc': 0.9709791447238111, 'loss_val': 0.2629322652830891, 'psi': 0.9525933460937558}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.396383 cos_to_last_merge=0.9791 (last merge round=20)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.7005170999735133, 'auprc': 0.7837303450475006, 'loss_val': 0.3958120311689166, 'psi': 0.7338023980031083}-{'f1_val': 0.700320598491359, 'auprc': 0.971093590932225, 'loss_val': 0.2785665767901397, 'psi': 0.8086297954677054}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.539932 cos_to_last_merge=0.9605 (last merge round=19)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.7237813164572671, 'auprc': 0.9133553732844588, 'loss_val': 0.6595432017201381, 'psi': 0.7996109391881439}-{'f1_val': 0.8214385148582664, 'auprc': 0.9331704258552529, 'loss_val': 0.4725949522340515, 'psi': 0.866131279257061}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.683371 cos_to_last_merge=0.9840 (last merge round=16)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.546833191992835, 'auprc': 0.7838828183592121, 'loss_val': 0.9975985228193147, 'psi': 0.6416530425393858}-{'f1_val': 0.6783905866825686, 'auprc': 0.8441607779628986, 'loss_val': 0.3439405143855839, 'psi': 0.7446986631947006}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.462919 cos_to_last_merge=0.8977 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.898
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.984696985774439, 'auprc': 0.9991199665980977, 'loss_val': 0.0720228110395764, 'psi': 0.9904661781039025}-{'f1_val': 0.9932775562128633, 'auprc': 0.9886339128781314, 'loss_val': 0.05494287060151749, 'psi': 0.9914200988789705}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.740323 cos_to_last_merge=0.7904 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.790
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9909624519078992, 'auprc': 0.9975021544412793, 'loss_val': 0.0308916388622492, 'psi': 0.9935783329212512}-{'f1_val': 0.9966605118138915, 'auprc': 0.9969139287279227, 'loss_val': 0.022023031637372636, 'psi': 0.9967618785795039}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.052825 (no previous merge yet)
[S10] round=40 local utility u=0.002632 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9958017774146335, 'loss_val': 0.030007831284266928, 'psi': 0.9954229651948637}-{'f1_val': 0.9949746627565785, 'auprc': 0.9945648950403986, 'loss_val': 0.030387138867940987, 'psi': 0.9948107556701065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=40 head_norm_before_train=1.761495 cos_to_last_merge=0.9614 (last merge round=20)
[S11] round=40 local utility u=0.001395 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9980629881446798, 'loss_val': 0.022712517628035486, 'psi': 0.9971656776416001}-{'f1_val': 0.9963256330217796, 'auprc': 0.9979835210958409, 'loss_val': 0.023813997959932585, 'psi': 0.9969887882514041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=40 head_norm_before_train=1.833224 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.5826900495942354, 'auprc': 0.6905079084050614, 'loss_val': 0.8734634654410914, 'psi': 0.6258171931185659}-{'f1_val': 0.5972345363766722, 'auprc': 0.6618745542014349, 'loss_val': 0.7402022434252672, 'psi': 0.6230905435065773}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.865101 cos_to_last_merge=0.9850 (last merge round=18)
[S14] round=40 local utility u=0.001446 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9973765737711543, 'loss_val': 0.027516511992958452, 'psi': 0.9971646431150086}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970635179406248, 'loss_val': 0.029313500437958284, 'psi': 0.997023912070849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=40 head_norm_before_train=1.836694 cos_to_last_merge=0.7795 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.779
[S15] round=40 local utility u=0.810999 metrics={'f1_val': 0.9742994039723414, 'auprc': 0.9837280063655033, 'loss_val': 0.13533785701521428, 'psi': 0.978070844929606}-{'f1_val': 0.7628503355019719, 'auprc': 0.9786474421983347, 'loss_val': 0.4733997004896475, 'psi': 0.8491691781805171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=40 head_norm_before_train=1.824594 cos_to_last_merge=0.9616 (last merge round=20)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8644868544502611, 'auprc': 0.9696734621842056, 'loss_val': 0.5237321107544269, 'psi': 0.9065614975438389}-{'f1_val': 0.9921683156157222, 'auprc': 0.997038446784843, 'loss_val': 0.03757206835294263, 'psi': 0.9941163680833706}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.707377 cos_to_last_merge=0.7299 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.730
[S17] round=40 local utility u=0.374806 metrics={'f1_val': 0.6447173849313766, 'auprc': 0.8410357702457173, 'loss_val': 1.1237714513473072, 'psi': 0.7232447390571128}-{'f1_val': 0.5904326747390765, 'auprc': 0.8034448512798258, 'loss_val': 1.434901993716288, 'psi': 0.6756375453553762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=41 head_norm_before_train=1.392202 cos_to_last_merge=0.9228 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.923
[S2] round=41 local utility u=0.229070 metrics={'f1_val': 0.7189365905022613, 'auprc': 0.9668658530937408, 'loss_val': 0.32542744314885214, 'psi': 0.8181082955388531}-{'f1_val': 0.7133160108341251, 'auprc': 0.8608556674959221, 'loss_val': 0.43181260360328333, 'psi': 0.772331873498844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=41 head_norm_before_train=1.483654 cos_to_last_merge=0.9108 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.751808874985126, 'auprc': 0.8292351456640892, 'loss_val': 0.45154423813768074, 'psi': 0.7827793832567114}-{'f1_val': 0.981109793383862, 'auprc': 0.9993975061931265, 'loss_val': 0.08040315620844861, 'psi': 0.9884248785075678}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.401643 cos_to_last_merge=0.9124 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.912
[S4] round=41 local utility u=0.047386 metrics={'f1_val': 0.9398094602340681, 'auprc': 0.9710453914061806, 'loss_val': 0.27340993541593145, 'psi': 0.9523038327029131}-{'f1_val': 0.9392819486040516, 'auprc': 0.9465857206183772, 'loss_val': 0.2916372631012878, 'psi': 0.9422034574097818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=41 head_norm_before_train=1.404685 cos_to_last_merge=0.9783 (last merge round=20)
[S5] round=41 local utility u=0.410403 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9919652184326317, 'loss_val': 0.19853610562971652, 'psi': 0.816978877833401}-{'f1_val': 0.7005170999735133, 'auprc': 0.7837303450475006, 'loss_val': 0.3958120311689166, 'psi': 0.7338023980031083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=41 head_norm_before_train=1.552882 cos_to_last_merge=0.9587 (last merge round=19)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.6043079689990676, 'auprc': 0.9040054002817651, 'loss_val': 0.6829673691636691, 'psi': 0.7241869415121467}-{'f1_val': 0.7237813164572671, 'auprc': 0.9133553732844588, 'loss_val': 0.6595432017201381, 'psi': 0.7996109391881439}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.690863 cos_to_last_merge=0.9833 (last merge round=16)
[S7] round=41 local utility u=0.784888 metrics={'f1_val': 0.6829588140835006, 'auprc': 0.8365655114621606, 'loss_val': 0.4026250104010731, 'psi': 0.7444014930349645}-{'f1_val': 0.546833191992835, 'auprc': 0.7838828183592121, 'loss_val': 0.9975985228193147, 'psi': 0.6416530425393858}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=41 head_norm_before_train=1.475221 cos_to_last_merge=0.8955 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.896
[S8] round=41 local utility u=0.022903 metrics={'f1_val': 0.9932775562128633, 'auprc': 0.990317798715933, 'loss_val': 0.0512937131894805, 'psi': 0.9920936532140912}-{'f1_val': 0.984696985774439, 'auprc': 0.9991199665980977, 'loss_val': 0.0720228110395764, 'psi': 0.9904661781039025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=41 head_norm_before_train=1.749008 cos_to_last_merge=0.7899 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.790
[S9] round=41 local utility u=0.001934 metrics={'f1_val': 0.9913832191636107, 'auprc': 0.9976595780448188, 'loss_val': 0.030020513441511344, 'psi': 0.993893762716094}-{'f1_val': 0.9909624519078992, 'auprc': 0.9975021544412793, 'loss_val': 0.0308916388622492, 'psi': 0.9935783329212512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=41 head_norm_before_train=2.062430 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9945992518335007, 'loss_val': 0.029347937680169765, 'psi': 0.995073701349833}-{'f1_val': 0.9951704237150173, 'auprc': 0.9958017774146335, 'loss_val': 0.030007831284266928, 'psi': 0.9954229651948637}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.773267 cos_to_last_merge=0.9605 (last merge round=20)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9944020895701797, 'auprc': 0.9983997876326554, 'loss_val': 0.027287785776143103, 'psi': 0.99600116879517}-{'f1_val': 0.996567470639547, 'auprc': 0.9980629881446798, 'loss_val': 0.022712517628035486, 'psi': 0.9971656776416001}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.837702 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5594603851277948, 'auprc': 0.7044936652610917, 'loss_val': 0.9238125660561027, 'psi': 0.6174736971811136}-{'f1_val': 0.5826900495942354, 'auprc': 0.6905079084050614, 'loss_val': 0.8734634654410914, 'psi': 0.6258171931185659}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.874709 cos_to_last_merge=0.9845 (last merge round=18)
[S14] round=41 local utility u=0.002238 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9979964747759513, 'loss_val': 0.026221319889403034, 'psi': 0.9975447269678039}-{'f1_val': 0.9970233560109115, 'auprc': 0.9973765737711543, 'loss_val': 0.027516511992958452, 'psi': 0.9971646431150086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=41 head_norm_before_train=1.842654 cos_to_last_merge=0.7789 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.779
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.7010713433702593, 'auprc': 0.7993511688613101, 'loss_val': 0.6411470469791888, 'psi': 0.7403832735666797}-{'f1_val': 0.9742994039723414, 'auprc': 0.9837280063655033, 'loss_val': 0.13533785701521428, 'psi': 0.978070844929606}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.833899 cos_to_last_merge=0.9607 (last merge round=20)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8467616607182444, 'auprc': 0.890229032315536, 'loss_val': 0.9547571470744205, 'psi': 0.864148609357161}-{'f1_val': 0.8644868544502611, 'auprc': 0.9696734621842056, 'loss_val': 0.5237321107544269, 'psi': 0.9065614975438389}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.720287 cos_to_last_merge=0.7286 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.729
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6325880311304354, 'auprc': 0.8309933240523706, 'loss_val': 1.2656817536051252, 'psi': 0.7119501482992094}-{'f1_val': 0.6447173849313766, 'auprc': 0.8410357702457173, 'loss_val': 1.1237714513473072, 'psi': 0.7232447390571128}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.404347 cos_to_last_merge=0.9210 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.921
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.7321284056327771, 'auprc': 0.7395044942116279, 'loss_val': 0.689885584186046, 'psi': 0.7350788410643174}-{'f1_val': 0.7189365905022613, 'auprc': 0.9668658530937408, 'loss_val': 0.32542744314885214, 'psi': 0.8181082955388531}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.492422 cos_to_last_merge=0.9095 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.910
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.7042941164888077, 'auprc': 0.8154955383652011, 'loss_val': 0.5725207559921731, 'psi': 0.7487746852393651}-{'f1_val': 0.751808874985126, 'auprc': 0.8292351456640892, 'loss_val': 0.45154423813768074, 'psi': 0.7827793832567114}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.413268 cos_to_last_merge=0.9111 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.911
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.940040402278374, 'auprc': 0.9704371226923827, 'loss_val': 0.27402565640002263, 'psi': 0.9521990904439775}-{'f1_val': 0.9398094602340681, 'auprc': 0.9710453914061806, 'loss_val': 0.27340993541593145, 'psi': 0.9523038327029131}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.411193 cos_to_last_merge=0.9775 (last merge round=20)
[S5] round=42 local utility u=0.016018 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9943400236500817, 'loss_val': 0.17362405532368738, 'psi': 0.8179287999203809}-{'f1_val': 0.7003213174339138, 'auprc': 0.9919652184326317, 'loss_val': 0.19853610562971652, 'psi': 0.816978877833401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=42 head_norm_before_train=1.566924 cos_to_last_merge=0.9571 (last merge round=19)
[S6] round=42 local utility u=0.521148 metrics={'f1_val': 0.760239514196529, 'auprc': 0.9182838686157617, 'loss_val': 0.6190951900538693, 'psi': 0.8234572559642221}-{'f1_val': 0.6043079689990676, 'auprc': 0.9040054002817651, 'loss_val': 0.6829673691636691, 'psi': 0.7241869415121467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=42 head_norm_before_train=1.700856 cos_to_last_merge=0.9822 (last merge round=16)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5958894625711231, 'auprc': 0.794891210233612, 'loss_val': 0.8087150075611012, 'psi': 0.6754901616361186}-{'f1_val': 0.6829588140835006, 'auprc': 0.8365655114621606, 'loss_val': 0.4026250104010731, 'psi': 0.7444014930349645}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.486555 cos_to_last_merge=0.8937 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.894
[S8] round=42 local utility u=0.015718 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9990295128325888, 'loss_val': 0.045931024286219625, 'psi': 0.9955722070539594}-{'f1_val': 0.9932775562128633, 'auprc': 0.990317798715933, 'loss_val': 0.0512937131894805, 'psi': 0.9920936532140912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=42 head_norm_before_train=1.758272 cos_to_last_merge=0.7892 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.789
[S9] round=42 local utility u=0.011616 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9934806658612791, 'loss_val': 0.02345221132386644, 'psi': 0.9951423232120782}-{'f1_val': 0.9913832191636107, 'auprc': 0.9976595780448188, 'loss_val': 0.030020513441511344, 'psi': 0.993893762716094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=42 head_norm_before_train=2.067765 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9949746627565785, 'auprc': 0.9943380472672494, 'loss_val': 0.02919840932577025, 'psi': 0.9947200165608469}-{'f1_val': 0.9953900010273877, 'auprc': 0.9945992518335007, 'loss_val': 0.029347937680169765, 'psi': 0.995073701349833}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.781429 cos_to_last_merge=0.9598 (last merge round=20)
[S11] round=42 local utility u=0.006898 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9978170371847744, 'loss_val': 0.02225499176310098, 'psi': 0.996819299720357}-{'f1_val': 0.9944020895701797, 'auprc': 0.9983997876326554, 'loss_val': 0.027287785776143103, 'psi': 0.99600116879517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=42 head_norm_before_train=1.842358 (no previous merge yet)
[S13] round=42 local utility u=0.209885 metrics={'f1_val': 0.6070658232475573, 'auprc': 0.6928677771645675, 'loss_val': 0.7547971790631223, 'psi': 0.6413866048143614}-{'f1_val': 0.5594603851277948, 'auprc': 0.7044936652610917, 'loss_val': 0.9238125660561027, 'psi': 0.6174736971811136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=42 head_norm_before_train=1.884778 cos_to_last_merge=0.9841 (last merge round=18)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9969319335187382, 'loss_val': 0.027716344533987816, 'psi': 0.996973201336042}-{'f1_val': 0.9972435617623723, 'auprc': 0.9979964747759513, 'loss_val': 0.026221319889403034, 'psi': 0.9975447269678039}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.848467 cos_to_last_merge=0.7786 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.779
[S15] round=42 local utility u=1.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9959501478865307, 'loss_val': 0.03155913399971019, 'psi': 0.9961795056638968}-{'f1_val': 0.7010713433702593, 'auprc': 0.7993511688613101, 'loss_val': 0.6411470469791888, 'psi': 0.7403832735666797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=42 head_norm_before_train=1.841734 cos_to_last_merge=0.9601 (last merge round=20)
[S16] round=42 local utility u=0.771180 metrics={'f1_val': 0.9419049891192829, 'auprc': 0.9836694517818861, 'loss_val': 0.263577428964446, 'psi': 0.9586107741843242}-{'f1_val': 0.8467616607182444, 'auprc': 0.890229032315536, 'loss_val': 0.9547571470744205, 'psi': 0.864148609357161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=42 head_norm_before_train=1.737381 cos_to_last_merge=0.7271 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.727
[S17] round=42 local utility u=0.496042 metrics={'f1_val': 0.7139500752073633, 'auprc': 0.8819658253037241, 'loss_val': 0.9146874314224054, 'psi': 0.7811563752459076}-{'f1_val': 0.6325880311304354, 'auprc': 0.8309933240523706, 'loss_val': 1.2656817536051252, 'psi': 0.7119501482992094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=43 head_norm_before_train=1.415651 cos_to_last_merge=0.9194 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.919
[S2] round=43 local utility u=0.556037 metrics={'f1_val': 0.8167734172124451, 'auprc': 0.8262884465508291, 'loss_val': 0.34603268488235595, 'psi': 0.8205794289477987}-{'f1_val': 0.7321284056327771, 'auprc': 0.7395044942116279, 'loss_val': 0.689885584186046, 'psi': 0.7350788410643174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=43 head_norm_before_train=1.497838 cos_to_last_merge=0.9086 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.909
[S3] round=43 local utility u=1.000000 metrics={'f1_val': 0.9971202529699166, 'auprc': 0.9994079218594881, 'loss_val': 0.05627776187488991, 'psi': 0.9980353205257452}-{'f1_val': 0.7042941164888077, 'auprc': 0.8154955383652011, 'loss_val': 0.5725207559921731, 'psi': 0.7487746852393651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=43 head_norm_before_train=1.422308 cos_to_last_merge=0.9104 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.910
[S4] round=43 local utility u=0.008301 metrics={'f1_val': 0.9410094780985184, 'auprc': 0.9723311110571642, 'loss_val': 0.26892021808627725, 'psi': 0.9535381312819767}-{'f1_val': 0.940040402278374, 'auprc': 0.9704371226923827, 'loss_val': 0.27402565640002263, 'psi': 0.9521990904439775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=43 head_norm_before_train=1.417968 cos_to_last_merge=0.9769 (last merge round=20)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.6335199990307033, 'auprc': 0.7799440009740053, 'loss_val': 0.7250289297926603, 'psi': 0.6920895998080241}-{'f1_val': 0.7003213174339138, 'auprc': 0.9943400236500817, 'loss_val': 0.17362405532368738, 'psi': 0.8179287999203809}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.578293 cos_to_last_merge=0.9558 (last merge round=19)
[S6] round=43 local utility u=0.257360 metrics={'f1_val': 0.8191672586485302, 'auprc': 0.9370377528505999, 'loss_val': 0.5142029398975488, 'psi': 0.866315456329358}-{'f1_val': 0.760239514196529, 'auprc': 0.9182838686157617, 'loss_val': 0.6190951900538693, 'psi': 0.8234572559642221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=43 head_norm_before_train=1.706450 cos_to_last_merge=0.9816 (last merge round=16)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5649922482465429, 'auprc': 0.7862766992877251, 'loss_val': 0.9144432391569361, 'psi': 0.6535060286630159}-{'f1_val': 0.5958894625711231, 'auprc': 0.794891210233612, 'loss_val': 0.8087150075611012, 'psi': 0.6754901616361186}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.495971 cos_to_last_merge=0.8924 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.892
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9889384063943332, 'auprc': 0.9991353925988938, 'loss_val': 0.05280070828393745, 'psi': 0.9930172008761574}-{'f1_val': 0.9932673365348732, 'auprc': 0.9990295128325888, 'loss_val': 0.045931024286219625, 'psi': 0.9955722070539594}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.766780 cos_to_last_merge=0.7887 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.789
[S9] round=43 local utility u=0.004145 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9976531895110831, 'loss_val': 0.02267342685832018, 'psi': 0.9963107753264047}-{'f1_val': 0.9962500947792776, 'auprc': 0.9934806658612791, 'loss_val': 0.02345221132386644, 'psi': 0.9951423232120782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=43 head_norm_before_train=2.073750 (no previous merge yet)
[S10] round=43 local utility u=0.002051 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9947516648746085, 'loss_val': 0.028830202464524897, 'psi': 0.995134666566276}-{'f1_val': 0.9949746627565785, 'auprc': 0.9943380472672494, 'loss_val': 0.02919840932577025, 'psi': 0.9947200165608469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=43 head_norm_before_train=1.792181 cos_to_last_merge=0.9590 (last merge round=20)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9977021470022251, 'loss_val': 0.022046216596582215, 'psi': 0.9967733436473373}-{'f1_val': 0.9961541414107454, 'auprc': 0.9978170371847744, 'loss_val': 0.02225499176310098, 'psi': 0.996819299720357}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.845129 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5931778371620775, 'auprc': 0.7141343326302957, 'loss_val': 0.8819296760263166, 'psi': 0.6415604353493647}-{'f1_val': 0.6070658232475573, 'auprc': 0.6928677771645675, 'loss_val': 0.7547971790631223, 'psi': 0.6413866048143614}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.890847 cos_to_last_merge=0.9836 (last merge round=18)
[S14] round=43 local utility u=0.000507 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9969630017609479, 'loss_val': 0.026795370988313475, 'psi': 0.9969856286329258}-{'f1_val': 0.9970007132142444, 'auprc': 0.9969319335187382, 'loss_val': 0.027716344533987816, 'psi': 0.996973201336042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=43 head_norm_before_train=1.856190 cos_to_last_merge=0.7779 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.778
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.8361226233637913, 'auprc': 0.9887073450612123, 'loss_val': 0.19602155786911288, 'psi': 0.8971565120427596}-{'f1_val': 0.9963324108488076, 'auprc': 0.9959501478865307, 'loss_val': 0.03155913399971019, 'psi': 0.9961795056638968}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.849616 cos_to_last_merge=0.9595 (last merge round=20)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8178102252311481, 'auprc': 0.9396025348747572, 'loss_val': 0.897218865728865, 'psi': 0.8665271490885917}-{'f1_val': 0.9419049891192829, 'auprc': 0.9836694517818861, 'loss_val': 0.263577428964446, 'psi': 0.9586107741843242}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.753692 cos_to_last_merge=0.7258 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.726
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6558469467412547, 'auprc': 0.8449607386131412, 'loss_val': 1.1256768526108962, 'psi': 0.7314924634900093}-{'f1_val': 0.7139500752073633, 'auprc': 0.8819658253037241, 'loss_val': 0.9146874314224054, 'psi': 0.7811563752459076}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.424199 cos_to_last_merge=0.9182 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.918
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.7214357238935063, 'auprc': 0.9475039127617835, 'loss_val': 0.3589084388793661, 'psi': 0.8118629994408171}-{'f1_val': 0.8167734172124451, 'auprc': 0.8262884465508291, 'loss_val': 0.34603268488235595, 'psi': 0.8205794289477987}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.503063 cos_to_last_merge=0.9078 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.908
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.6519410139299301, 'auprc': 0.8110585705251394, 'loss_val': 0.6340910694086286, 'psi': 0.7155880365680138}-{'f1_val': 0.9971202529699166, 'auprc': 0.9994079218594881, 'loss_val': 0.05627776187488991, 'psi': 0.9980353205257452}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.429964 cos_to_last_merge=0.9090 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.909
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9403823651494003, 'auprc': 0.9695976192725977, 'loss_val': 0.2670932469146846, 'psi': 0.9520684667986793}-{'f1_val': 0.9410094780985184, 'auprc': 0.9723311110571642, 'loss_val': 0.26892021808627725, 'psi': 0.9535381312819767}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.423141 cos_to_last_merge=0.9764 (last merge round=20)
[S5] round=44 local utility u=0.590836 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9020964372781, 'loss_val': 0.31061755299794147, 'psi': 0.7810309340060554}-{'f1_val': 0.6335199990307033, 'auprc': 0.7799440009740053, 'loss_val': 0.7250289297926603, 'psi': 0.6920895998080241}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=44 head_norm_before_train=1.586546 cos_to_last_merge=0.9550 (last merge round=19)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.7921357669616371, 'auprc': 0.9420627230252288, 'loss_val': 0.49995597404175396, 'psi': 0.8521065493870738}-{'f1_val': 0.8191672586485302, 'auprc': 0.9370377528505999, 'loss_val': 0.5142029398975488, 'psi': 0.866315456329358}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.709477 cos_to_last_merge=0.9811 (last merge round=16)
[S7] round=44 local utility u=0.793795 metrics={'f1_val': 0.6895730208148476, 'auprc': 0.8589712453490788, 'loss_val': 0.29242233422639674, 'psi': 0.7573323106285401}-{'f1_val': 0.5649922482465429, 'auprc': 0.7862766992877251, 'loss_val': 0.9144432391569361, 'psi': 0.6535060286630159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=44 head_norm_before_train=1.506985 cos_to_last_merge=0.8906 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.891
[S8] round=44 local utility u=0.013700 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9983938488713578, 'loss_val': 0.044774218342140765, 'psi': 0.9948803742978443}-{'f1_val': 0.9889384063943332, 'auprc': 0.9991353925988938, 'loss_val': 0.05280070828393745, 'psi': 0.9930172008761574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=44 head_norm_before_train=1.776145 cos_to_last_merge=0.7881 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.788
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9709903666600215, 'auprc': 0.9714986505720332, 'loss_val': 0.09285852256321181, 'psi': 0.9711936802248262}-{'f1_val': 0.9954158325366191, 'auprc': 0.9976531895110831, 'loss_val': 0.02267342685832018, 'psi': 0.9963107753264047}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.082154 (no previous merge yet)
[S10] round=44 local utility u=0.000088 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9947184914918291, 'loss_val': 0.028554367066038755, 'psi': 0.9951213972131643}-{'f1_val': 0.9953900010273877, 'auprc': 0.9947516648746085, 'loss_val': 0.028830202464524897, 'psi': 0.995134666566276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=44 head_norm_before_train=1.803777 cos_to_last_merge=0.9581 (last merge round=20)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9899322769592894, 'auprc': 0.9977706216765818, 'loss_val': 0.05071018203574821, 'psi': 0.9930676148462064}-{'f1_val': 0.9961541414107454, 'auprc': 0.9977021470022251, 'loss_val': 0.022046216596582215, 'psi': 0.9967733436473373}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.849903 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5950258119037336, 'auprc': 0.6702882881472884, 'loss_val': 0.8563170633547923, 'psi': 0.6251308024011555}-{'f1_val': 0.5931778371620775, 'auprc': 0.7141343326302957, 'loss_val': 0.8819296760263166, 'psi': 0.6415604353493647}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.900606 cos_to_last_merge=0.9829 (last merge round=18)
[S14] round=44 local utility u=0.000861 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969693113947606, 'loss_val': 0.025072138397512, 'psi': 0.9969862294525034}-{'f1_val': 0.9970007132142444, 'auprc': 0.9969630017609479, 'loss_val': 0.026795370988313475, 'psi': 0.9969856286329258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=44 head_norm_before_train=1.866471 cos_to_last_merge=0.7771 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.777
[S15] round=44 local utility u=0.568097 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9919085726245073, 'loss_val': 0.03069093890398521, 'psi': 0.9945628755590874}-{'f1_val': 0.8361226233637913, 'auprc': 0.9887073450612123, 'loss_val': 0.19602155786911288, 'psi': 0.8971565120427596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=44 head_norm_before_train=1.856844 cos_to_last_merge=0.9586 (last merge round=20)
[S16] round=44 local utility u=1.000000 metrics={'f1_val': 0.9928680781018704, 'auprc': 0.9923965181552445, 'loss_val': 0.034916556022987016, 'psi': 0.9926794541232201}-{'f1_val': 0.8178102252311481, 'auprc': 0.9396025348747572, 'loss_val': 0.897218865728865, 'psi': 0.8665271490885917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=44 head_norm_before_train=1.765454 cos_to_last_merge=0.7248 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.725
[S17] round=44 local utility u=0.553741 metrics={'f1_val': 0.7245320653270236, 'auprc': 0.9132891689347954, 'loss_val': 0.6352914211292809, 'psi': 0.8000349067701324}-{'f1_val': 0.6558469467412547, 'auprc': 0.8449607386131412, 'loss_val': 1.1256768526108962, 'psi': 0.7314924634900093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=45 head_norm_before_train=1.432819 cos_to_last_merge=0.9170 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.917
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.8019197800841289, 'auprc': 0.7495635800440309, 'loss_val': 0.4747385200407475, 'psi': 0.7809773000680897}-{'f1_val': 0.7214357238935063, 'auprc': 0.9475039127617835, 'loss_val': 0.3589084388793661, 'psi': 0.8118629994408171}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.508134 cos_to_last_merge=0.9071 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.907
[S3] round=45 local utility u=1.000000 metrics={'f1_val': 0.8828902056696118, 'auprc': 0.9711457606771627, 'loss_val': 0.21315095660283562, 'psi': 0.9181924276726322}-{'f1_val': 0.6519410139299301, 'auprc': 0.8110585705251394, 'loss_val': 0.6340910694086286, 'psi': 0.7155880365680138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=45 head_norm_before_train=1.437126 cos_to_last_merge=0.9082 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.908
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9389328742648353, 'auprc': 0.965945467522531, 'loss_val': 0.27758493860259437, 'psi': 0.9497379115679135}-{'f1_val': 0.9403823651494003, 'auprc': 0.9695976192725977, 'loss_val': 0.2670932469146846, 'psi': 0.9520684667986793}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.426590 cos_to_last_merge=0.9761 (last merge round=20)
[S5] round=45 local utility u=0.164348 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9891489179102833, 'loss_val': 0.24307879085379266, 'psi': 0.8158519262589288}-{'f1_val': 0.700320598491359, 'auprc': 0.9020964372781, 'loss_val': 0.31061755299794147, 'psi': 0.7810309340060554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=45 head_norm_before_train=1.594485 cos_to_last_merge=0.9541 (last merge round=19)
[S6] round=45 local utility u=0.097071 metrics={'f1_val': 0.8066779720367703, 'auprc': 0.9340595291030844, 'loss_val': 0.36905797835596815, 'psi': 0.857630594863296}-{'f1_val': 0.7921357669616371, 'auprc': 0.9420627230252288, 'loss_val': 0.49995597404175396, 'psi': 0.8521065493870738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=45 head_norm_before_train=1.712132 cos_to_last_merge=0.9808 (last merge round=16)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6169528785052216, 'auprc': 0.7939871215112506, 'loss_val': 0.5984505445239795, 'psi': 0.6877665757076332}-{'f1_val': 0.6895730208148476, 'auprc': 0.8589712453490788, 'loss_val': 0.29242233422639674, 'psi': 0.7573323106285401}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.515871 cos_to_last_merge=0.8889 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.889
[S8] round=45 local utility u=0.005384 metrics={'f1_val': 0.993632801855294, 'auprc': 0.9990868725694653, 'loss_val': 0.04265400105356886, 'psi': 0.9958144301409626}-{'f1_val': 0.9925380579155019, 'auprc': 0.9983938488713578, 'loss_val': 0.044774218342140765, 'psi': 0.9948803742978443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=45 head_norm_before_train=1.783243 cos_to_last_merge=0.7875 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.788
[S9] round=45 local utility u=0.147449 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.994388923257718, 'loss_val': 0.020651238306064065, 'psi': 0.995751876391422}-{'f1_val': 0.9709903666600215, 'auprc': 0.9714986505720332, 'loss_val': 0.09285852256321181, 'psi': 0.9711936802248262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=45 head_norm_before_train=2.091682 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9945903090132864, 'loss_val': 0.02840308541963034, 'psi': 0.9950701242217472}-{'f1_val': 0.9953900010273877, 'auprc': 0.9947184914918291, 'loss_val': 0.028554367066038755, 'psi': 0.9951213972131643}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.811573 cos_to_last_merge=0.9577 (last merge round=20)
[S11] round=45 local utility u=0.032976 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.997640212404252, 'loss_val': 0.021697800332682215, 'psi': 0.9967485698081481}-{'f1_val': 0.9899322769592894, 'auprc': 0.9977706216765818, 'loss_val': 0.05071018203574821, 'psi': 0.9930676148462064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=45 head_norm_before_train=1.858868 (no previous merge yet)
[S13] round=45 local utility u=0.159958 metrics={'f1_val': 0.6164350958976437, 'auprc': 0.708200961541028, 'loss_val': 0.7785949207414711, 'psi': 0.6531414421549974}-{'f1_val': 0.5950258119037336, 'auprc': 0.6702882881472884, 'loss_val': 0.8563170633547923, 'psi': 0.6251308024011555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=45 head_norm_before_train=1.909608 cos_to_last_merge=0.9825 (last merge round=18)
[S14] round=45 local utility u=0.001398 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969692389613503, 'loss_val': 0.023733105439155893, 'psi': 0.997131909608016}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969693113947606, 'loss_val': 0.025072138397512, 'psi': 0.9969862294525034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=45 head_norm_before_train=1.876505 cos_to_last_merge=0.7764 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.776
[S15] round=45 local utility u=0.001405 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9937887965703622, 'loss_val': 0.03352158419452661, 'psi': 0.9953149651374295}-{'f1_val': 0.9963324108488076, 'auprc': 0.9919085726245073, 'loss_val': 0.03069093890398521, 'psi': 0.9945628755590874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] START round=45 head_norm_before_train=1.862138 cos_to_last_merge=0.9578 (last merge round=20)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9922158355346136, 'auprc': 0.9897687357284566, 'loss_val': 0.03785028245914504, 'psi': 0.9912369956121507}-{'f1_val': 0.9928680781018704, 'auprc': 0.9923965181552445, 'loss_val': 0.034916556022987016, 'psi': 0.9926794541232201}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.781782 cos_to_last_merge=0.7235 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.723
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.673183117564337, 'auprc': 0.843662145121889, 'loss_val': 1.0155137391149551, 'psi': 0.7413747285873578}-{'f1_val': 0.7245320653270236, 'auprc': 0.9132891689347954, 'loss_val': 0.6352914211292809, 'psi': 0.8000349067701324}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.441226 cos_to_last_merge=0.9158 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.916
[S2] round=46 local utility u=0.080548 metrics={'f1_val': 0.7198368319488362, 'auprc': 0.9370206659930546, 'loss_val': 0.38351616413847717, 'psi': 0.8067103655665235}-{'f1_val': 0.8019197800841289, 'auprc': 0.7495635800440309, 'loss_val': 0.4747385200407475, 'psi': 0.7809773000680897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=46 head_norm_before_train=1.512819 cos_to_last_merge=0.9064 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.906
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.7210062023763479, 'auprc': 0.8177548493955045, 'loss_val': 0.545943836429188, 'psi': 0.7597056611840105}-{'f1_val': 0.8828902056696118, 'auprc': 0.9711457606771627, 'loss_val': 0.21315095660283562, 'psi': 0.9181924276726322}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.445547 cos_to_last_merge=0.9073 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.907
[S4] round=46 local utility u=0.011383 metrics={'f1_val': 0.939928702583116, 'auprc': 0.9702214614485307, 'loss_val': 0.2736212092427414, 'psi': 0.9520458061292819}-{'f1_val': 0.9389328742648353, 'auprc': 0.965945467522531, 'loss_val': 0.27758493860259437, 'psi': 0.9497379115679135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S5] START round=46 head_norm_before_train=1.429916 cos_to_last_merge=0.9755 (last merge round=20)
[S5] round=46 local utility u=0.019790 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9899679802821673, 'loss_val': 0.20699223532032476, 'psi': 0.8162831689941583}-{'f1_val': 0.700320598491359, 'auprc': 0.9891489179102833, 'loss_val': 0.24307879085379266, 'psi': 0.8158519262589288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=46 head_norm_before_train=1.602087 cos_to_last_merge=0.9530 (last merge round=19)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6691560576988281, 'auprc': 0.9249008042015274, 'loss_val': 0.651257484700008, 'psi': 0.7714539562999079}-{'f1_val': 0.8066779720367703, 'auprc': 0.9340595291030844, 'loss_val': 0.36905797835596815, 'psi': 0.857630594863296}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.716926 cos_to_last_merge=0.9802 (last merge round=16)
[S7] round=46 local utility u=0.221552 metrics={'f1_val': 0.6524649489976851, 'auprc': 0.8095578398041506, 'loss_val': 0.415131238113418, 'psi': 0.7153021053202714}-{'f1_val': 0.6169528785052216, 'auprc': 0.7939871215112506, 'loss_val': 0.5984505445239795, 'psi': 0.6877665757076332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=46 head_norm_before_train=1.526065 cos_to_last_merge=0.8871 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.887
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9903754849676576, 'auprc': 0.9991507749239499, 'loss_val': 0.04831244829419284, 'psi': 0.9938856009501744}-{'f1_val': 0.993632801855294, 'auprc': 0.9990868725694653, 'loss_val': 0.04265400105356886, 'psi': 0.9958144301409626}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.789443 cos_to_last_merge=0.7869 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.787
[S9] round=46 local utility u=0.001476 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9960406661135689, 'loss_val': 0.02016735868773513, 'psi': 0.9961639354249591}-{'f1_val': 0.9966605118138915, 'auprc': 0.994388923257718, 'loss_val': 0.020651238306064065, 'psi': 0.995751876391422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=46 head_norm_before_train=2.098697 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9949746627565785, 'auprc': 0.9943870796538316, 'loss_val': 0.02847882906396428, 'psi': 0.9947396295154798}-{'f1_val': 0.9953900010273877, 'auprc': 0.9945903090132864, 'loss_val': 0.02840308541963034, 'psi': 0.9950701242217472}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.818606 cos_to_last_merge=0.9573 (last merge round=20)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9975055722019189, 'loss_val': 0.021835806628394336, 'psi': 0.9966947137272149}-{'f1_val': 0.9961541414107454, 'auprc': 0.997640212404252, 'loss_val': 0.021697800332682215, 'psi': 0.9967485698081481}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.864029 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6082293035296594, 'auprc': 0.7276378723011844, 'loss_val': 0.9647265855715673, 'psi': 0.6559927310382694}-{'f1_val': 0.6164350958976437, 'auprc': 0.708200961541028, 'loss_val': 0.7785949207414711, 'psi': 0.6531414421549974}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.919115 cos_to_last_merge=0.9820 (last merge round=18)
[S14] round=46 local utility u=0.000381 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969612497295581, 'loss_val': 0.022947558317127935, 'psi': 0.9971287139152991}-{'f1_val': 0.997240356705793, 'auprc': 0.9969692389613503, 'loss_val': 0.023733105439155893, 'psi': 0.997131909608016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=46 head_norm_before_train=1.886985 cos_to_last_merge=0.7757 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.776
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7729574682053657, 'auprc': 0.9866063357493337, 'loss_val': 0.4480638997101811, 'psi': 0.8584170152229529}-{'f1_val': 0.9963324108488076, 'auprc': 0.9937887965703622, 'loss_val': 0.03352158419452661, 'psi': 0.9953149651374295}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.864886 cos_to_last_merge=0.9575 (last merge round=20)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9919965598033159, 'auprc': 0.9885476675100873, 'loss_val': 0.040115969618473586, 'psi': 0.9906170028860245}-{'f1_val': 0.9922158355346136, 'auprc': 0.9897687357284566, 'loss_val': 0.03785028245914504, 'psi': 0.9912369956121507}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.794471 cos_to_last_merge=0.7228 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.723
[S17] round=46 local utility u=0.218385 metrics={'f1_val': 0.7008692149818044, 'auprc': 0.869513846908397, 'loss_val': 0.8224153296774354, 'psi': 0.7683270677524414}-{'f1_val': 0.673183117564337, 'auprc': 0.843662145121889, 'loss_val': 1.0155137391149551, 'psi': 0.7413747285873578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=47 head_norm_before_train=1.450727 cos_to_last_merge=0.9144 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.914
[S2] round=47 local utility u=0.232731 metrics={'f1_val': 0.8028393914445546, 'auprc': 0.9299673682222933, 'loss_val': 0.3949102177192539, 'psi': 0.8536905821556501}-{'f1_val': 0.7198368319488362, 'auprc': 0.9370206659930546, 'loss_val': 0.38351616413847717, 'psi': 0.8067103655665235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=47 head_norm_before_train=1.519723 cos_to_last_merge=0.9056 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.906
[S3] round=47 local utility u=1.000000 metrics={'f1_val': 0.9971176001226143, 'auprc': 0.9992305050451773, 'loss_val': 0.05318767714157193, 'psi': 0.9979627620916396}-{'f1_val': 0.7210062023763479, 'auprc': 0.8177548493955045, 'loss_val': 0.545943836429188, 'psi': 0.7597056611840105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=47 head_norm_before_train=1.451806 cos_to_last_merge=0.9065 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.907
[S4] round=47 local utility u=0.004727 metrics={'f1_val': 0.9406725889435114, 'auprc': 0.9716633805700738, 'loss_val': 0.2729555403520391, 'psi': 0.9530689055941364}-{'f1_val': 0.939928702583116, 'auprc': 0.9702214614485307, 'loss_val': 0.2736212092427414, 'psi': 0.9520458061292819}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=47 head_norm_before_train=1.436493 cos_to_last_merge=0.9742 (last merge round=20)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.7004057807153181, 'auprc': 0.9071521036577123, 'loss_val': 0.3685225445344287, 'psi': 0.7831043098922759}-{'f1_val': 0.7004932948021524, 'auprc': 0.9899679802821673, 'loss_val': 0.20699223532032476, 'psi': 0.8162831689941583}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.608415 cos_to_last_merge=0.9518 (last merge round=19)
[S6] round=47 local utility u=1.000000 metrics={'f1_val': 0.9299109728412791, 'auprc': 0.9467951039635044, 'loss_val': 0.2745212483901381, 'psi': 0.9366646252901693}-{'f1_val': 0.6691560576988281, 'auprc': 0.9249008042015274, 'loss_val': 0.651257484700008, 'psi': 0.7714539562999079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=47 head_norm_before_train=1.723611 cos_to_last_merge=0.9796 (last merge round=16)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6114776559205601, 'auprc': 0.7943020303673954, 'loss_val': 0.6999102790412169, 'psi': 0.6846074056992942}-{'f1_val': 0.6524649489976851, 'auprc': 0.8095578398041506, 'loss_val': 0.415131238113418, 'psi': 0.7153021053202714}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.535839 cos_to_last_merge=0.8853 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.885
[S8] round=47 local utility u=0.008533 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9974387579775488, 'loss_val': 0.041271399999033086, 'psi': 0.9947169567502052}-{'f1_val': 0.9903754849676576, 'auprc': 0.9991507749239499, 'loss_val': 0.04831244829419284, 'psi': 0.9938856009501744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=47 head_norm_before_train=1.794983 cos_to_last_merge=0.7868 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.787
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9884538934865174, 'auprc': 0.990082185813359, 'loss_val': 0.04512008243896035, 'psi': 0.989105210417254}-{'f1_val': 0.9962461149658858, 'auprc': 0.9960406661135689, 'loss_val': 0.02016735868773513, 'psi': 0.9961639354249591}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.102702 (no previous merge yet)
[S10] round=47 local utility u=0.003536 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9958431585868911, 'loss_val': 0.028267771296260895, 'psi': 0.9955712640511891}-{'f1_val': 0.9949746627565785, 'auprc': 0.9943870796538316, 'loss_val': 0.02847882906396428, 'psi': 0.9947396295154798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=47 head_norm_before_train=1.822914 cos_to_last_merge=0.9569 (last merge round=20)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9942288708308418, 'auprc': 0.9979009463846213, 'loss_val': 0.025287799194719993, 'psi': 0.9956977010523536}-{'f1_val': 0.9961541414107454, 'auprc': 0.9975055722019189, 'loss_val': 0.021835806628394336, 'psi': 0.9966947137272149}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.867195 (no previous merge yet)
[S13] round=47 local utility u=0.006174 metrics={'f1_val': 0.597028587758592, 'auprc': 0.7100054591746183, 'loss_val': 0.8322774932236348, 'psi': 0.6422193363250026}-{'f1_val': 0.6082293035296594, 'auprc': 0.7276378723011844, 'loss_val': 0.9647265855715673, 'psi': 0.6559927310382694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=47 head_norm_before_train=1.927985 cos_to_last_merge=0.9815 (last merge round=18)
[S14] round=47 local utility u=0.002693 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9986089677854939, 'loss_val': 0.02250447906147686, 'psi': 0.9977878011376734}-{'f1_val': 0.997240356705793, 'auprc': 0.9969612497295581, 'loss_val': 0.022947558317127935, 'psi': 0.9971287139152991}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=47 head_norm_before_train=1.898623 cos_to_last_merge=0.7749 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.775
[S15] round=47 local utility u=0.634169 metrics={'f1_val': 0.9245210513722044, 'auprc': 0.99147161847656, 'loss_val': 0.10370264482032464, 'psi': 0.9513012782139467}-{'f1_val': 0.7729574682053657, 'auprc': 0.9866063357493337, 'loss_val': 0.4480638997101811, 'psi': 0.8584170152229529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=47 head_norm_before_train=1.868809 cos_to_last_merge=0.9567 (last merge round=20)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9919699867408596, 'auprc': 0.9886909423113817, 'loss_val': 0.04126697279490408, 'psi': 0.9906583689690684}-{'f1_val': 0.9919965598033159, 'auprc': 0.9885476675100873, 'loss_val': 0.040115969618473586, 'psi': 0.9906170028860245}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.804633 cos_to_last_merge=0.7221 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.722
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.687189924485404, 'auprc': 0.8693689698870145, 'loss_val': 1.0254327343513805, 'psi': 0.7600615426460482}-{'f1_val': 0.7008692149818044, 'auprc': 0.869513846908397, 'loss_val': 0.8224153296774354, 'psi': 0.7683270677524414}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.463518 cos_to_last_merge=0.9124 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.912
[S2] round=48 local utility u=0.056513 metrics={'f1_val': 0.813050966365504, 'auprc': 0.9387880153095948, 'loss_val': 0.36961649721435014, 'psi': 0.8633457859431404}-{'f1_val': 0.8028393914445546, 'auprc': 0.9299673682222933, 'loss_val': 0.3949102177192539, 'psi': 0.8536905821556501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=48 head_norm_before_train=1.525652 cos_to_last_merge=0.9048 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.905
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.7513879391577678, 'auprc': 0.8297875363904192, 'loss_val': 0.46011834276977137, 'psi': 0.7827477780508284}-{'f1_val': 0.9971176001226143, 'auprc': 0.9992305050451773, 'loss_val': 0.05318767714157193, 'psi': 0.9979627620916396}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.458710 cos_to_last_merge=0.9051 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.905
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9406725889435114, 'auprc': 0.9717908819734747, 'loss_val': 0.27414558132819083, 'psi': 0.9531199061554967}-{'f1_val': 0.9406725889435114, 'auprc': 0.9716633805700738, 'loss_val': 0.2729555403520391, 'psi': 0.9530689055941364}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.445028 cos_to_last_merge=0.9732 (last merge round=20)
[S5] round=48 local utility u=0.418668 metrics={'f1_val': 0.7655932186093461, 'auprc': 0.9921252302830252, 'loss_val': 0.1772315331292422, 'psi': 0.8562060232788178}-{'f1_val': 0.7004057807153181, 'auprc': 0.9071521036577123, 'loss_val': 0.3685225445344287, 'psi': 0.7831043098922759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=48 head_norm_before_train=1.616935 cos_to_last_merge=0.9507 (last merge round=19)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.8009034800144531, 'auprc': 0.9259638317160072, 'loss_val': 0.5968234952147909, 'psi': 0.8509276206950747}-{'f1_val': 0.9299109728412791, 'auprc': 0.9467951039635044, 'loss_val': 0.2745212483901381, 'psi': 0.9366646252901693}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.730845 cos_to_last_merge=0.9790 (last merge round=16)
[S7] round=48 local utility u=0.139709 metrics={'f1_val': 0.6279894410200825, 'auprc': 0.8038921533469321, 'loss_val': 0.5483337789670274, 'psi': 0.6983505259508224}-{'f1_val': 0.6114776559205601, 'auprc': 0.7943020303673954, 'loss_val': 0.6999102790412169, 'psi': 0.6846074056992942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=48 head_norm_before_train=1.544720 cos_to_last_merge=0.8835 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.883
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.993632801855294, 'auprc': 0.9913969214550375, 'loss_val': 0.039778083763956425, 'psi': 0.9927384496951914}-{'f1_val': 0.9929024225986427, 'auprc': 0.9974387579775488, 'loss_val': 0.041271399999033086, 'psi': 0.9947169567502052}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.797788 cos_to_last_merge=0.7869 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.787
[S9] round=48 local utility u=0.043513 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9943438448217554, 'loss_val': 0.020118646177859165, 'psi': 0.995733845017037}-{'f1_val': 0.9884538934865174, 'auprc': 0.990082185813359, 'loss_val': 0.04512008243896035, 'psi': 0.989105210417254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=48 head_norm_before_train=2.109429 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9956781070597335, 'loss_val': 0.028032138671129195, 'psi': 0.995505243440326}-{'f1_val': 0.9953900010273877, 'auprc': 0.9958431585868911, 'loss_val': 0.028267771296260895, 'psi': 0.9955712640511891}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.828381 cos_to_last_merge=0.9566 (last merge round=20)
[S11] round=48 local utility u=0.007764 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9977547549532428, 'loss_val': 0.020873605780728412, 'psi': 0.9967943868277443}-{'f1_val': 0.9942288708308418, 'auprc': 0.9979009463846213, 'loss_val': 0.025287799194719993, 'psi': 0.9956977010523536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=48 head_norm_before_train=1.870261 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.5889189912145972, 'auprc': 0.7079072635322843, 'loss_val': 0.7873898587165971, 'psi': 0.636514300141672}-{'f1_val': 0.597028587758592, 'auprc': 0.7100054591746183, 'loss_val': 0.8322774932236348, 'psi': 0.6422193363250026}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.937444 cos_to_last_merge=0.9809 (last merge round=18)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9968628995864561, 'loss_val': 0.026699628789487093, 'psi': 0.9974368706149135}-{'f1_val': 0.997240356705793, 'auprc': 0.9986089677854939, 'loss_val': 0.02250447906147686, 'psi': 0.9977878011376734}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.910724 cos_to_last_merge=0.7741 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.774
[S15] round=48 local utility u=0.147464 metrics={'f1_val': 0.9659579114815917, 'auprc': 0.9937215074572846, 'loss_val': 0.0641463579605255, 'psi': 0.9770633498718689}-{'f1_val': 0.9245210513722044, 'auprc': 0.99147161847656, 'loss_val': 0.10370264482032464, 'psi': 0.9513012782139467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=48 head_norm_before_train=1.876588 cos_to_last_merge=0.9557 (last merge round=20)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.990860069844249, 'auprc': 0.9866753386307571, 'loss_val': 0.04784713046346172, 'psi': 0.9891861773588522}-{'f1_val': 0.9919699867408596, 'auprc': 0.9886909423113817, 'loss_val': 0.04126697279490408, 'psi': 0.9906583689690684}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.814903 cos_to_last_merge=0.7212 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.721
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6217986360495851, 'auprc': 0.8292824383604571, 'loss_val': 1.451165662501384, 'psi': 0.7047921569739339}-{'f1_val': 0.687189924485404, 'auprc': 0.8693689698870145, 'loss_val': 1.0254327343513805, 'psi': 0.7600615426460482}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.479332 cos_to_last_merge=0.9100 (last merge round=16)
[S2] ⚠️ Model drifted since last merge! cos=0.910
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.8018595598846163, 'auprc': 0.8180182352617844, 'loss_val': 0.4618056629404549, 'psi': 0.8083230300354836}-{'f1_val': 0.813050966365504, 'auprc': 0.9387880153095948, 'loss_val': 0.36961649721435014, 'psi': 0.8633457859431404}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.532453 cos_to_last_merge=0.9037 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=49 local utility u=0.719463 metrics={'f1_val': 0.8778440981217178, 'auprc': 0.9728103175539995, 'loss_val': 0.20899811921530562, 'psi': 0.9158305858946305}-{'f1_val': 0.7513879391577678, 'auprc': 0.8297875363904192, 'loss_val': 0.46011834276977137, 'psi': 0.7827477780508284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=49 head_norm_before_train=1.467837 cos_to_last_merge=0.9040 (last merge round=19)
[S4] ⚠️ Model drifted since last merge! cos=0.904
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9399380110993869, 'auprc': 0.9722334288563861, 'loss_val': 0.2769618989848476, 'psi': 0.9528561782021866}-{'f1_val': 0.9406725889435114, 'auprc': 0.9717908819734747, 'loss_val': 0.27414558132819083, 'psi': 0.9531199061554967}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.452953 cos_to_last_merge=0.9721 (last merge round=20)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.6395228845440379, 'auprc': 0.7771168166536195, 'loss_val': 0.8106624261858567, 'psi': 0.6945604573878705}-{'f1_val': 0.7655932186093461, 'auprc': 0.9921252302830252, 'loss_val': 0.1772315331292422, 'psi': 0.8562060232788178}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.623419 cos_to_last_merge=0.9499 (last merge round=19)
[S6] ⚠️ Model drifted since last merge! cos=0.950
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.7251760001122632, 'auprc': 0.9292916521027818, 'loss_val': 0.7505440547117542, 'psi': 0.8068222609084706}-{'f1_val': 0.8009034800144531, 'auprc': 0.9259638317160072, 'loss_val': 0.5968234952147909, 'psi': 0.8509276206950747}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.735741 cos_to_last_merge=0.9786 (last merge round=16)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5343055378884894, 'auprc': 0.7834466488505785, 'loss_val': 1.058160817705331, 'psi': 0.6339619822733251}-{'f1_val': 0.6279894410200825, 'auprc': 0.8038921533469321, 'loss_val': 0.5483337789670274, 'psi': 0.6983505259508224}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.554224 cos_to_last_merge=0.8819 (last merge round=18)
[S8] ⚠️ Model drifted since last merge! cos=0.882
[S8] round=49 local utility u=0.007475 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9989690899456835, 'loss_val': 0.04097661565738961, 'psi': 0.9951104707275745}-{'f1_val': 0.993632801855294, 'auprc': 0.9913969214550375, 'loss_val': 0.039778083763956425, 'psi': 0.9927384496951914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=49 head_norm_before_train=1.804473 cos_to_last_merge=0.7863 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.786
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9907882209391965, 'loss_val': 0.022530680048890594, 'psi': 0.9940653452432452}-{'f1_val': 0.9966605118138915, 'auprc': 0.9943438448217554, 'loss_val': 0.020118646177859165, 'psi': 0.995733845017037}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.117736 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9945952528961889, 'loss_val': 0.027716828003837377, 'psi': 0.9950721017749082}-{'f1_val': 0.9953900010273877, 'auprc': 0.9956781070597335, 'loss_val': 0.028032138671129195, 'psi': 0.995505243440326}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.834794 cos_to_last_merge=0.9562 (last merge round=20)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9975229365282305, 'loss_val': 0.021287325122886322, 'psi': 0.9965565568870791}-{'f1_val': 0.9961541414107454, 'auprc': 0.9977547549532428, 'loss_val': 0.020873605780728412, 'psi': 0.9967943868277443}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.872296 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5782449869638961, 'auprc': 0.7255993785905003, 'loss_val': 0.9673699481105169, 'psi': 0.6371867436145378}-{'f1_val': 0.5889189912145972, 'auprc': 0.7079072635322843, 'loss_val': 0.7873898587165971, 'psi': 0.636514300141672}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.940670 cos_to_last_merge=0.9808 (last merge round=18)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9969743394813666, 'loss_val': 0.024704736899539916, 'psi': 0.9971026569946606}-{'f1_val': 0.9978195179672185, 'auprc': 0.9968628995864561, 'loss_val': 0.026699628789487093, 'psi': 0.9974368706149135}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.922424 cos_to_last_merge=0.7734 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.773
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7566195970454114, 'auprc': 0.9411488073567491, 'loss_val': 0.5204764078032406, 'psi': 0.8304312811699465}-{'f1_val': 0.9659579114815917, 'auprc': 0.9937215074572846, 'loss_val': 0.0641463579605255, 'psi': 0.9770633498718689}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.886086 cos_to_last_merge=0.9548 (last merge round=20)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9460139288895909, 'auprc': 0.9826701993388229, 'loss_val': 0.2746206922127931, 'psi': 0.9606764370692837}-{'f1_val': 0.990860069844249, 'auprc': 0.9866753386307571, 'loss_val': 0.04784713046346172, 'psi': 0.9891861773588522}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.826389 cos_to_last_merge=0.7202 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.720
[S17] round=49 local utility u=0.533579 metrics={'f1_val': 0.7101384176922688, 'auprc': 0.8812454225941153, 'loss_val': 1.069935976550012, 'psi': 0.7785812196530074}-{'f1_val': 0.6217986360495851, 'auprc': 0.8292824383604571, 'loss_val': 1.451165662501384, 'psi': 0.7047921569739339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
