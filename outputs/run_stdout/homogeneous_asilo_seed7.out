[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:51903
[S3] → join 127.0.0.1:51902
[S4] → join 127.0.0.1:51902
[S5] → join 127.0.0.1:51902
[S6] → join 127.0.0.1:51902
[S7] → join 127.0.0.1:51902
[S8] → join 127.0.0.1:51902
[S9] → join 127.0.0.1:51902
[S10] → join 127.0.0.1:51902
[S11] → join 127.0.0.1:51902
[S13] → join 127.0.0.1:51902
[S14] → join 127.0.0.1:51902
[S15] → join 127.0.0.1:51902
[S16] → join 127.0.0.1:51902
[S17] → join 127.0.0.1:51902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.134575 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.098406 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.193815 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.205328 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.158965 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.103647 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.148778 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.132097 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.160216 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.132844 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.149630 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.155384 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.146864 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.236205 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.202660 (no previous merge yet)
[S14]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S3] + discovered S14
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S16
[S3] + discovered S11
[S3] + discovered S6
[S3] + discovered S17
[S3] + discovered S4
[S3] + discovered S15
[S3] + discovered S13
[S3] + discovered S10
[S3] + discovered S8
[S3] + discovered S9
[S3] + discovered S5
[S3] + discovered S7
[S5] + discovered S2
[S4] + discovered S5
[S4] + discovered S10
[S4] + discovered S7
[S5] + discovered S4
[S5] + discovered S3
[S4] + discovered S14
[S4] + discovered S15
[S4] + discovered S13
[S4] + discovered S6
[S4] + discovered S8
[S4] + discovered S16
[S4] + discovered S11
[S4] + discovered S17
[S4] + discovered S9
[S5] + discovered S7
[S5] + discovered S13
[S5] + discovered S14
[S6] + discovered S5
[S5] + discovered S10
[S6] + discovered S2
[S5] + discovered S17
[S5] + discovered S9
[S5] + discovered S8
[S6] + discovered S3
[S5] + discovered S16
[S5] + discovered S11
[S6] + discovered S4
[S5] + discovered S15
[S5] + discovered S6
[S6] + discovered S16
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S3
[S6] + discovered S15
[S6] + discovered S11
[S6] + discovered S9
[S7] + discovered S5
[S6] + discovered S14
[S7] + discovered S6
[S6] + discovered S8
[S6] + discovered S13
[S6] + discovered S17
[S6] + discovered S10
[S6] + discovered S7
[S8] + discovered S5
[S7] + discovered S8
[S7] + discovered S11
[S7] + discovered S13
[S7] + discovered S10
[S7] + discovered S9
[S8] + discovered S6
[S7] + discovered S17
[S7] + discovered S15
[S8] + discovered S3
[S8] + discovered S2
[S8] + discovered S4
[S8] + discovered S7
[S7] + discovered S16
[S7] + discovered S14
[S8] + discovered S11
[S9] + discovered S3
[S9] + discovered S8
[S9] + discovered S4
[S9] + discovered S6
[S9] + discovered S5
[S8] + discovered S10
[S8] + discovered S13
[S9] + discovered S2
[S9] + discovered S7
[S8] + discovered S17
[S8] + discovered S15
[S8] + discovered S14
[S8] + discovered S9
[S8] + discovered S16
[S10] + discovered S7
[S10] + discovered S8
[S9] + discovered S15
[S9] + discovered S16
[S9] + discovered S17
[S9] + discovered S14
[S10] + discovered S9
[S9] + discovered S13
[S9] + discovered S11
[S10] + discovered S2
[S9] + discovered S10
[S10] + discovered S6
[S10] + discovered S5
[S10] + discovered S4
[S10] + discovered S3
[S11] + discovered S2
[S11] + discovered S5
[S10] + discovered S17
[S11] + discovered S9
[S11] + discovered S10
[S11] + discovered S7
[S10] + discovered S14
[S11] + discovered S8
[S11] + discovered S6
[S10] + discovered S15
[S10] + discovered S13
[S11] + discovered S3
[S10] + discovered S11
[S11] + discovered S4
[S10] + discovered S16
[S11] + discovered S13
[S13] + discovered S4
[S13] + discovered S6
[S13] + discovered S5
[S13] + discovered S8
[S13] + discovered S3
[S11] + discovered S16
[S13] + discovered S2
[S13] + discovered S9
[S13] + discovered S10
[S13] + discovered S11
[S11] + discovered S17
[S11] + discovered S15
[S13] + discovered S7
[S11] + discovered S14
[S13] + discovered S16
[S13] + discovered S14
[S13] + discovered S17
[S14] + discovered S4
[S14] + discovered S5
[S14] + discovered S11
[S14] + discovered S9
[S14] + discovered S6
[S14] + discovered S8
[S14] + discovered S3
[S14] + discovered S10
[S14] + discovered S13
[S14] + discovered S7
[S14] + discovered S2
[S13] + discovered S15
[S14] + discovered S17
[S15] + discovered S13
[S15] + discovered S3
[S15] + discovered S14
[S15] + discovered S5
[S15] + discovered S10
[S15] + discovered S8
[S15] + discovered S9
[S15] + discovered S7
[S15] + discovered S2
[S15] + discovered S4
[S15] + discovered S6
[S15] + discovered S11
[S14] + discovered S16
[S14] + discovered S15
[S16] + discovered S7
[S16] + discovered S4
[S16] + discovered S8
[S16] + discovered S11
[S16] + discovered S5
[S16] + discovered S9
[S16] + discovered S6
[S16] + discovered S10
[S15] + discovered S16
[S16] + discovered S2
[S16] + discovered S13
[S16] + discovered S15
[S16] + discovered S3
[S16] + discovered S14
[S15] + discovered S17
[S16] + discovered S17
[S17] + discovered S5
[S17] + discovered S11
[S17] + discovered S7
[S17] + discovered S15
[S17] + discovered S14
[S17] + discovered S13
[S17] + discovered S2
[S17] + discovered S10
[S17] + discovered S6
[S17] + discovered S3
[S17] + discovered S16
[S17] + discovered S4
[S17] + discovered S9
[S17] + discovered S8
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=1.000 → S6@127.0.0.1:51907
[S3] ⇄ pheromone p=1.000 → S9@127.0.0.1:51910
[S5] ⇄ pheromone p=1.000 → S11@127.0.0.1:51912
[S9] ⇄ pheromone p=1.000 → S2@127.0.0.1:51902
[S7] ⇄ pheromone p=1.000 → S5@127.0.0.1:51905
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:51917
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:51915
[S2] ⇄ pheromone p=1.000 → S17@127.0.0.1:51917
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:51908
[S13] ⇄ pheromone p=1.000 → S5@127.0.0.1:51905
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:51905
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:51908
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:51912
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:51913
[S17] ⇄ pheromone p=1.000 → S16@127.0.0.1:51916
[S2] START round=1 head_norm_before_train=1.137553 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6084733182509008, 'loss_val': 1.3265520411625056, 'psi': 0.3284556073335004}-{'f1_val': 0.3321096517119244, 'auprc': 0.46891897887601275, 'loss_val': 1.3592260229375466, 'psi': 0.3868333825775597}
[S3] START round=1 head_norm_before_train=1.093877 (no previous merge yet)
[S3] round=1 local utility u=0.469379 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.707960109477525, 'loss_val': 1.3464279647456439, 'psi': 0.36708808315947417}-{'f1_val': 0.13984006561410703, 'auprc': 0.4040475556615209, 'loss_val': 1.3734481040010342, 'psi': 0.24552306163307258}
[S4] START round=1 head_norm_before_train=1.210330 (no previous merge yet)
[S4] round=1 local utility u=0.048673 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7675507955271041, 'loss_val': 1.3004468448871194, 'psi': 0.39115629554795217}-{'f1_val': 0.14022662889518414, 'auprc': 0.745493183422524, 'loss_val': 1.3316200536189993, 'psi': 0.3823332507061201}
[S5] START round=1 head_norm_before_train=1.203727 (no previous merge yet)
[S5] round=1 local utility u=1.000000 metrics={'f1_val': 0.41710539449208295, 'auprc': 0.7604402137354314, 'loss_val': 1.3382830252259512, 'psi': 0.5544393221894224}-{'f1_val': 0.0885440438156093, 'auprc': 0.577252739996265, 'loss_val': 1.3801068035857924, 'psi': 0.2840275222878716}
[S6] START round=1 head_norm_before_train=1.169333 (no previous merge yet)
[S6] round=1 local utility u=0.246560 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7804476337985845, 'loss_val': 1.2899276136240607, 'psi': 0.397034822750203}-{'f1_val': 0.14142628205128205, 'auprc': 0.6275730389210358, 'loss_val': 1.3244246670901627, 'psi': 0.33588498479918355}
[S7] START round=1 head_norm_before_train=1.108198 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7910823675324352, 'loss_val': 1.3463533447136384, 'psi': 0.4016670406504291}-{'f1_val': 0.21575692500205212, 'auprc': 0.749720923169726, 'loss_val': 1.3774710041557463, 'psi': 0.4293425242691217}
[S8] START round=1 head_norm_before_train=1.149481 (no previous merge yet)
[S8] round=1 local utility u=0.718233 metrics={'f1_val': 0.3316703468700333, 'auprc': 0.6714135055708498, 'loss_val': 1.3360870884981149, 'psi': 0.4675676103503599}-{'f1_val': 0.10450549450549451, 'auprc': 0.6579592283576872, 'loss_val': 1.3692010619763284, 'psi': 0.3258869880463716}
[S9] START round=1 head_norm_before_train=1.143803 (no previous merge yet)
[S9] round=1 local utility u=0.109979 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9824680594068181, 'loss_val': 1.2888349130231278, 'psi': 0.4778259980467249}-{'f1_val': 0.141397957139996, 'auprc': 0.921961872301091, 'loss_val': 1.3272741046828296, 'psi': 0.453623523204434}
[S10] START round=1 head_norm_before_train=1.175883 (no previous merge yet)
[S10] round=1 local utility u=0.060823 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5872995825482006, 'loss_val': 1.3140562146862342, 'psi': 0.31809281554431457}-{'f1_val': 0.13862163754172394, 'auprc': 0.5570476727296985, 'loss_val': 1.3449460148902732, 'psi': 0.3059920516169138}
[S11] START round=1 head_norm_before_train=1.139462 (no previous merge yet)
[S11] round=1 local utility u=1.000000 metrics={'f1_val': 0.39679166723085046, 'auprc': 0.8776856070595629, 'loss_val': 1.324109498307207, 'psi': 0.5891492431623354}-{'f1_val': 0.10359570269677702, 'auprc': 0.6670423704042384, 'loss_val': 1.3631781837708081, 'psi': 0.3289743697797616}
[S13] START round=1 head_norm_before_train=1.152066 (no previous merge yet)
[S13] round=1 local utility u=0.977100 metrics={'f1_val': 0.4160404975377924, 'auprc': 0.7303893947304858, 'loss_val': 1.3320437073518516, 'psi': 0.5417800564148698}-{'f1_val': 0.09037372593431484, 'auprc': 0.7398886107697761, 'loss_val': 1.360740195424306, 'psi': 0.35017967986849935}
[S14] START round=1 head_norm_before_train=1.150679 (no previous merge yet)
[S14] round=1 local utility u=0.137665 metrics={'f1_val': 0.1038107752956636, 'auprc': 0.7539412281522571, 'loss_val': 1.341638125108136, 'psi': 0.363862956438301}-{'f1_val': 0.1038107752956636, 'auprc': 0.670992967066424, 'loss_val': 1.3681240770766445, 'psi': 0.33068365200396777}
[S15] START round=1 head_norm_before_train=1.158212 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7680725888681329, 'loss_val': 1.3061569504644674, 'psi': 0.39106922636418817}-{'f1_val': 0.31812347608655084, 'auprc': 0.7650428925442169, 'loss_val': 1.3357597391370017, 'psi': 0.49689124266961726}
[S16] START round=1 head_norm_before_train=1.234938 (no previous merge yet)
[S16] round=1 local utility u=0.926392 metrics={'f1_val': 0.1668636256204207, 'auprc': 0.7980595297179853, 'loss_val': 1.3584893323077625, 'psi': 0.4193419872594466}-{'f1_val': 0.0545679012345679, 'auprc': 0.41465422211336495, 'loss_val': 1.3872825218670561, 'psi': 0.19860242958608673}
[S17] START round=1 head_norm_before_train=1.202057 (no previous merge yet)
[S17] round=1 local utility u=1.000000 metrics={'f1_val': 0.32678031894671544, 'auprc': 0.767970801526934, 'loss_val': 1.3401625870578995, 'psi': 0.5032565119788028}-{'f1_val': 0.09754189944134078, 'auprc': 0.5373152225411081, 'loss_val': 1.3661052018429267, 'psi': 0.2734512286812477}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S4] → sending delta(kind=head bytes=1787) to S15@127.0.0.1:51915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:51909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S5] → sending delta(kind=head bytes=1783) to S4@127.0.0.1:51904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:51905
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S16] → sending delta(kind=head bytes=1784) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:51905
[S11] sending update (kind=head size=1788 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1787 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S16] sending update (kind=head size=1784 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1783 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1790) from S6
[S13] cosine check vs S6: cos=0.0609
[S4] RECEIVED delta(kind=head bytes=1783) from S5
[S4] cosine check vs S5: cos=-0.0099
[S4] DROPPED delta from S5 (cos=-0.0099 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1789) from S3
[S5] cosine check vs S3: cos=0.0633
[S13] RECEIVED delta(kind=head bytes=1791) from S9
[S13] cosine check vs S9: cos=0.0470
[S5] RECEIVED delta(kind=head bytes=1788) from S11
[S5] cosine check vs S11: cos=0.1405
[S8] RECEIVED delta(kind=head bytes=1790) from S10
[S8] cosine check vs S10: cos=-0.0081
[S8] DROPPED delta from S10 (cos=-0.0081 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1784) from S16
[S6] cosine check vs S16: cos=0.0095
[S6] RECEIVED delta(kind=head bytes=1792) from S8
[S6] cosine check vs S8: cos=0.0634
[S2] RECEIVED delta(kind=head bytes=1791) from S13
[S2] cosine check vs S13: cos=0.0188
[S15] RECEIVED delta(kind=head bytes=1790) from S14
[S15] cosine check vs S14: cos=-0.0260
[S15] DROPPED delta from S14 (cos=-0.0260 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1787) from S4
[S15] cosine check vs S4: cos=0.0801
[S17] sending update (kind=head size=1789 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1789) from S17
[S5] cosine check vs S17: cos=-0.1358
[S5] DROPPED delta from S17 (cos=-0.1358 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.149438
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.090407e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.824376 delta_norm=0.809041
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.177198
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.178749e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.886142 delta_norm=0.817875
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.4160 head_norm=1.160637
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.851919e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.736984 delta_norm=0.685192
[S13] aggregate: ROLLBACK (f1_val pre=0.416 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.4171 head_norm=1.213772
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.779954e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.4249 head_norm=0.774971 delta_norm=0.677995
[S5] aggregate: ACCEPT kept=['S3', 'S11'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.187425
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.221165e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.756337 delta_norm=0.722116
[S6] aggregate: ACCEPT kept=['S16', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.824376 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.240101 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7694686626731236, 'loss_val': 1.32933634453757, 'psi': 0.3928537451023895}-{'f1_val': 0.1417771333885667, 'auprc': 0.6084733182509008, 'loss_val': 1.3265520411625056, 'psi': 0.3284556073335004}
[S3] START round=2 head_norm_before_train=1.100481 (no previous merge yet)
[S3] round=2 local utility u=0.069244 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7447976813220144, 'loss_val': 1.3184526353678225, 'psi': 0.38182311189727003}-{'f1_val': 0.13984006561410703, 'auprc': 0.707960109477525, 'loss_val': 1.3464279647456439, 'psi': 0.36708808315947417}
[S4] START round=2 head_norm_before_train=1.233911 (no previous merge yet)
[S4] round=2 local utility u=0.031273 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7751667475942573, 'loss_val': 1.2607491780633864, 'psi': 0.39420267637481343}-{'f1_val': 0.14022662889518414, 'auprc': 0.7675507955271041, 'loss_val': 1.3004468448871194, 'psi': 0.39115629554795217}
[S5] START round=2 head_norm_before_train=0.774971 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7378078018733732, 'loss_val': 1.3165230565881627, 'psi': 0.3804802636064922}-{'f1_val': 0.41710539449208295, 'auprc': 0.7604402137354314, 'loss_val': 1.3382830252259512, 'psi': 0.5544393221894224}
[S6] START round=2 head_norm_before_train=0.756337 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7012480304179618, 'loss_val': 1.3000602541223476, 'psi': 0.3653549813979539}-{'f1_val': 0.14142628205128205, 'auprc': 0.7804476337985845, 'loss_val': 1.2899276136240607, 'psi': 0.397034822750203}
[S7] START round=2 head_norm_before_train=1.123758 (no previous merge yet)
[S7] round=2 local utility u=0.012849 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7879405203467427, 'loss_val': 1.3112295651244141, 'psi': 0.40041030177615206}-{'f1_val': 0.14205682272909165, 'auprc': 0.7910823675324352, 'loss_val': 1.3463533447136384, 'psi': 0.4016670406504291}
[S8] START round=2 head_norm_before_train=1.158339 (no previous merge yet)
[S8] round=2 local utility u=0.155173 metrics={'f1_val': 0.37479686758384845, 'auprc': 0.6766073147009599, 'loss_val': 1.3000820104189466, 'psi': 0.49552104643069306}-{'f1_val': 0.3316703468700333, 'auprc': 0.6714135055708498, 'loss_val': 1.3360870884981149, 'psi': 0.4675676103503599}
[S9] START round=2 head_norm_before_train=1.164109 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9589339060605325, 'loss_val': 1.2364169120711015, 'psi': 0.46841233670821064}-{'f1_val': 0.141397957139996, 'auprc': 0.9824680594068181, 'loss_val': 1.2888349130231278, 'psi': 0.4778259980467249}
[S10] START round=2 head_norm_before_train=1.197709 (no previous merge yet)
[S10] round=2 local utility u=0.034082 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.598279496167349, 'loss_val': 1.2788310441518513, 'psi': 0.322484780991974}-{'f1_val': 0.13862163754172394, 'auprc': 0.5872995825482006, 'loss_val': 1.3140562146862342, 'psi': 0.31809281554431457}
[S11] START round=2 head_norm_before_train=1.156263 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8832108162763184, 'loss_val': 1.2696025765210766, 'psi': 0.4375325365343937}-{'f1_val': 0.39679166723085046, 'auprc': 0.8776856070595629, 'loss_val': 1.324109498307207, 'psi': 0.5891492431623354}
[S13] START round=2 head_norm_before_train=0.736984 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.758612161017904, 'loss_val': 1.334622800048526, 'psi': 0.38767632195339347}-{'f1_val': 0.4160404975377924, 'auprc': 0.7303893947304858, 'loss_val': 1.3320437073518516, 'psi': 0.5417800564148698}
[S14] START round=2 head_norm_before_train=1.157684 (no previous merge yet)
[S14] round=2 local utility u=0.991304 metrics={'f1_val': 0.38832870085351767, 'auprc': 0.8357405022560452, 'loss_val': 1.3115356415355643, 'psi': 0.5672934214145287}-{'f1_val': 0.1038107752956636, 'auprc': 0.7539412281522571, 'loss_val': 1.341638125108136, 'psi': 0.363862956438301}
[S15] START round=2 head_norm_before_train=0.886142 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7643682929189775, 'loss_val': 1.3090521220296008, 'psi': 0.389587507984526}-{'f1_val': 0.13973365136155833, 'auprc': 0.7680725888681329, 'loss_val': 1.3061569504644674, 'psi': 0.39106922636418817}
[S16] START round=2 head_norm_before_train=1.242504 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7969061539980098, 'loss_val': 1.3221863591582959, 'psi': 0.4031449317187259}-{'f1_val': 0.1668636256204207, 'auprc': 0.7980595297179853, 'loss_val': 1.3584893323077625, 'psi': 0.4193419872594466}
[S17] START round=2 head_norm_before_train=1.212345 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.746559970341583, 'loss_val': 1.3055446775586155, 'psi': 0.38319336612706384}-{'f1_val': 0.32678031894671544, 'auprc': 0.767970801526934, 'loss_val': 1.3401625870578995, 'psi': 0.5032565119788028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:51914
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:51910
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:51909
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:51904
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] cosine check vs S14: cos=0.0620
[S4] RECEIVED delta(kind=head bytes=1797) from S2
[S4] cosine check vs S2: cos=-0.0477
[S4] DROPPED delta from S2 (cos=-0.0477 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S10
[S9] cosine check vs S10: cos=0.0519
[S11] RECEIVED delta(kind=head bytes=1790) from S8
[S11] cosine check vs S8: cos=0.1081
[S13] RECEIVED delta(kind=head bytes=1795) from S4
[S13] cosine check vs S4: cos=-0.0215
[S13] DROPPED delta from S4 (cos=-0.0215 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1790) from S7
[S14] cosine check vs S7: cos=0.0021
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] cosine check vs S3: cos=-0.0461
[S8] DROPPED delta from S3 (cos=-0.0461 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=1.193747
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.322818e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.876671 delta_norm=0.832282
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=1.182615
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.721388e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.3210 head_norm=0.754963 delta_norm=0.672139
[S11] aggregate: ACCEPT kept=['S14', 'S8'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=2 metric=0.3883 head_norm=1.175429
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.195950e-01
[S14] stored merged vector for next round verification (round=2)
[S14] DEBUG after merge:  round=2 metric=0.3678 head_norm=0.821347 delta_norm=0.819595
[S14] aggregate: ROLLBACK (f1_val pre=0.388 post=0.368 tol_abs=0.005 tol_rel=0.0)
[S2] START round=3 head_norm_before_train=0.840789 cos_to_last_merge=0.9970 (last merge round=1)
[S2] round=3 local utility u=0.033384 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.779628079132708, 'loss_val': 1.2930467742441536, 'psi': 0.3969175116862233}-{'f1_val': 0.1417771333885667, 'auprc': 0.7694686626731236, 'loss_val': 1.32933634453757, 'psi': 0.3928537451023895}
[S3] START round=3 head_norm_before_train=1.116562 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6901342638439959, 'loss_val': 1.283333729206863, 'psi': 0.3599577449060626}-{'f1_val': 0.13984006561410703, 'auprc': 0.7447976813220144, 'loss_val': 1.3184526353678225, 'psi': 0.38182311189727003}
[S4] START round=3 head_norm_before_train=1.265705 (no previous merge yet)
[S4] round=3 local utility u=0.032988 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7783125763780977, 'loss_val': 1.2042102930058902, 'psi': 0.3954610078883496}-{'f1_val': 0.14022662889518414, 'auprc': 0.7751667475942573, 'loss_val': 1.2607491780633864, 'psi': 0.39420267637481343}
[S5] START round=3 head_norm_before_train=0.794834 cos_to_last_merge=0.9963 (last merge round=1)
[S5] round=3 local utility u=0.017007 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7348991906194664, 'loss_val': 1.2737824611687796, 'psi': 0.3793168191049294}-{'f1_val': 0.14226190476190476, 'auprc': 0.7378078018733732, 'loss_val': 1.3165230565881627, 'psi': 0.3804802636064922}
[S6] START round=3 head_norm_before_train=0.779728 cos_to_last_merge=0.9963 (last merge round=1)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6689896509678399, 'loss_val': 1.2558654569680172, 'psi': 0.35245162961790516}-{'f1_val': 0.14142628205128205, 'auprc': 0.7012480304179618, 'loss_val': 1.3000602541223476, 'psi': 0.3653549813979539}
[S7] START round=3 head_norm_before_train=1.145016 (no previous merge yet)
[S7] round=3 local utility u=0.018700 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7864283945755264, 'loss_val': 1.2692924326605666, 'psi': 0.39980545146766555}-{'f1_val': 0.14205682272909165, 'auprc': 0.7879405203467427, 'loss_val': 1.3112295651244141, 'psi': 0.40041030177615206}
[S8] START round=3 head_norm_before_train=1.175632 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6755883877724229, 'loss_val': 1.2496377711362316, 'psi': 0.3542089445447435}-{'f1_val': 0.37479686758384845, 'auprc': 0.6766073147009599, 'loss_val': 1.3000820104189466, 'psi': 0.49552104643069306}
[S9] START round=3 head_norm_before_train=0.876671 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8661976025316449, 'loss_val': 1.2411610072485129, 'psi': 0.4313178152966556}-{'f1_val': 0.141397957139996, 'auprc': 0.9589339060605325, 'loss_val': 1.2364169120711015, 'psi': 0.46841233670821064}
[S10] START round=3 head_norm_before_train=1.223706 (no previous merge yet)
[S10] round=3 local utility u=0.103491 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6551491658029374, 'loss_val': 1.242457545769781, 'psi': 0.3452326488462093}-{'f1_val': 0.13862163754172394, 'auprc': 0.598279496167349, 'loss_val': 1.2788310441518513, 'psi': 0.322484780991974}
[S11] START round=3 head_norm_before_train=0.754963 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.023840 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8950850529022668, 'loss_val': 1.2575450767573704, 'psi': 0.4422822311847731}-{'f1_val': 0.14041368337311058, 'auprc': 0.8832108162763184, 'loss_val': 1.2696025765210766, 'psi': 0.4375325365343937}
[S13] START round=3 head_norm_before_train=0.745735 cos_to_last_merge=0.9957 (last merge round=1)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7451472023763854, 'loss_val': 1.3093812252593182, 'psi': 0.382290338496786}-{'f1_val': 0.1403857625770531, 'auprc': 0.758612161017904, 'loss_val': 1.334622800048526, 'psi': 0.38767632195339347}
[S14] START round=3 head_norm_before_train=0.821347 cos_to_last_merge=1.0000 (last merge round=2)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8070062469014463, 'loss_val': 1.3202627465715275, 'psi': 0.4070172104902008}-{'f1_val': 0.38832870085351767, 'auprc': 0.8357405022560452, 'loss_val': 1.3115356415355643, 'psi': 0.5672934214145287}
[S15] START round=3 head_norm_before_train=0.903558 cos_to_last_merge=0.9975 (last merge round=1)
[S15] round=3 local utility u=0.019415 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.765831369778597, 'loss_val': 1.27461145899286, 'psi': 0.3901727387283738}-{'f1_val': 0.13973365136155833, 'auprc': 0.7643682929189775, 'loss_val': 1.3090521220296008, 'psi': 0.389587507984526}
[S16] START round=3 head_norm_before_train=1.261315 (no previous merge yet)
[S16] round=3 local utility u=0.012600 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7907845537701148, 'loss_val': 1.278622023116575, 'psi': 0.4006962916275678}-{'f1_val': 0.14063745019920318, 'auprc': 0.7969061539980098, 'loss_val': 1.3221863591582959, 'psi': 0.4031449317187259}
[S17] START round=3 head_norm_before_train=1.231147 (no previous merge yet)
[S17] round=3 local utility u=0.047463 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7605733049504669, 'loss_val': 1.2526579456577474, 'psi': 0.38879869997061745}-{'f1_val': 0.14094896331738438, 'auprc': 0.746559970341583, 'loss_val': 1.3055446775586155, 'psi': 0.38319336612706384}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:51912
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:51905
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:51908
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:51912
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:51907
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1793) from S2
[S17] cosine check vs S2: cos=0.0016
[S7] RECEIVED delta(kind=head bytes=1792) from S16
[S7] cosine check vs S16: cos=-0.0317
[S7] DROPPED delta from S16 (cos=-0.0317 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1791) from S5
[S11] cosine check vs S5: cos=0.3787
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.0812
[S5] RECEIVED delta(kind=head bytes=1797) from S7
[S5] cosine check vs S7: cos=0.0613
[S13] RECEIVED delta(kind=head bytes=1795) from S11
[S13] cosine check vs S11: cos=-0.0529
[S13] DROPPED delta from S11 (cos=-0.0529 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.1044
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=0.0016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:51916
[S17] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S17
[S16] cosine check vs S17: cos=0.0223
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=0.811118
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.436959e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.744793 delta_norm=0.743696
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=0.822604
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.089810e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.573249 delta_norm=0.508981
[S5] aggregate: ACCEPT kept=['S7', 'S15'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.288263
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.897498e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.909844 delta_norm=0.889750
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=0.785733
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.767669e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.625514 delta_norm=0.476767
[S11] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=1.256710
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.619137e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.763082 delta_norm=0.761914
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.863883 cos_to_last_merge=0.9887 (last merge round=1)
[S2] round=4 local utility u=0.029028 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7853364857667817, 'loss_val': 1.252115787030462, 'psi': 0.39920087433985274}-{'f1_val': 0.1417771333885667, 'auprc': 0.779628079132708, 'loss_val': 1.2930467742441536, 'psi': 0.3969175116862233}
[S3] START round=4 head_norm_before_train=1.141781 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6597167320937523, 'loss_val': 1.2355696933567626, 'psi': 0.3477907322059651}-{'f1_val': 0.13984006561410703, 'auprc': 0.6901342638439959, 'loss_val': 1.283333729206863, 'psi': 0.3599577449060626}
[S4] START round=4 head_norm_before_train=1.303634 (no previous merge yet)
[S4] round=4 local utility u=0.053280 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.782841676666875, 'loss_val': 1.1112375499956928, 'psi': 0.3972726480038605}-{'f1_val': 0.14022662889518414, 'auprc': 0.7783125763780977, 'loss_val': 1.2042102930058902, 'psi': 0.3954610078883496}
[S5] START round=4 head_norm_before_train=0.573249 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7289494485714132, 'loss_val': 1.2678085925140425, 'psi': 0.37693692228570813}-{'f1_val': 0.14226190476190476, 'auprc': 0.7348991906194664, 'loss_val': 1.2737824611687796, 'psi': 0.3793168191049294}
[S6] START round=4 head_norm_before_train=0.744793 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6498668640596095, 'loss_val': 1.2623443787869988, 'psi': 0.344802514854613}-{'f1_val': 0.14142628205128205, 'auprc': 0.6689896509678399, 'loss_val': 1.2558654569680172, 'psi': 0.35245162961790516}
[S7] START round=4 head_norm_before_train=1.170775 (no previous merge yet)
[S7] round=4 local utility u=0.018557 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7863208125755489, 'loss_val': 1.231856063550354, 'psi': 0.39976241866767454}-{'f1_val': 0.14205682272909165, 'auprc': 0.7864283945755264, 'loss_val': 1.2692924326605666, 'psi': 0.39980545146766555}
[S8] START round=4 head_norm_before_train=1.204054 (no previous merge yet)
[S8] round=4 local utility u=0.130296 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7429437213666696, 'loss_val': 1.1911111844159668, 'psi': 0.3811510779824422}-{'f1_val': 0.13995598239295717, 'auprc': 0.6755883877724229, 'loss_val': 1.2496377711362316, 'psi': 0.3542089445447435}
[S9] START round=4 head_norm_before_train=0.905167 cos_to_last_merge=0.9965 (last merge round=2)
[S9] round=4 local utility u=0.041578 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8662345965627453, 'loss_val': 1.158115616918957, 'psi': 0.43133261290909575}-{'f1_val': 0.141397957139996, 'auprc': 0.8661976025316449, 'loss_val': 1.2411610072485129, 'psi': 0.4313178152966556}
[S10] START round=4 head_norm_before_train=1.248074 (no previous merge yet)
[S10] round=4 local utility u=0.104686 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7109467725287643, 'loss_val': 1.2004780616246435, 'psi': 0.36755169153654005}-{'f1_val': 0.13862163754172394, 'auprc': 0.6551491658029374, 'loss_val': 1.242457545769781, 'psi': 0.3452326488462093}
[S11] START round=4 head_norm_before_train=0.625514 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.061493 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9249285877546742, 'loss_val': 1.2240904407510094, 'psi': 0.45421964512573604}-{'f1_val': 0.14041368337311058, 'auprc': 0.8950850529022668, 'loss_val': 1.2575450767573704, 'psi': 0.4422822311847731}
[S13] START round=4 head_norm_before_train=0.766712 cos_to_last_merge=0.9845 (last merge round=1)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.689416185809093, 'loss_val': 1.2753726936029879, 'psi': 0.35999793186986906}-{'f1_val': 0.1403857625770531, 'auprc': 0.7451472023763854, 'loss_val': 1.3093812252593182, 'psi': 0.382290338496786}
[S14] START round=4 head_norm_before_train=0.843337 cos_to_last_merge=0.9967 (last merge round=2)
[S14] round=4 local utility u=0.062862 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8356250525574145, 'loss_val': 1.2803944193241223, 'psi': 0.41846473275258805}-{'f1_val': 0.14035785288270378, 'auprc': 0.8070062469014463, 'loss_val': 1.3202627465715275, 'psi': 0.4070172104902008}
[S15] START round=4 head_norm_before_train=0.932352 cos_to_last_merge=0.9904 (last merge round=1)
[S15] round=4 local utility u=0.027472 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.768856876537282, 'loss_val': 1.2287437312208724, 'psi': 0.3913829414318478}-{'f1_val': 0.13973365136155833, 'auprc': 0.765831369778597, 'loss_val': 1.27461145899286, 'psi': 0.3901727387283738}
[S16] START round=4 head_norm_before_train=0.909844 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.025450 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.804370275573373, 'loss_val': 1.2684783611943493, 'psi': 0.4061305803488712}-{'f1_val': 0.14063745019920318, 'auprc': 0.7907845537701148, 'loss_val': 1.278622023116575, 'psi': 0.4006962916275678}
[S17] START round=4 head_norm_before_train=0.763082 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7026895632473853, 'loss_val': 1.2404824615178849, 'psi': 0.36564520328938477}-{'f1_val': 0.14094896331738438, 'auprc': 0.7605733049504669, 'loss_val': 1.2526579456577474, 'psi': 0.38879869997061745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:51917
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:51913
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:51905
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:51912
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:51908
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=0.0848
[S2] RECEIVED delta(kind=head bytes=1799) from S9
[S2] cosine check vs S9: cos=0.0731
[S17] RECEIVED delta(kind=head bytes=1794) from S2
[S17] cosine check vs S2: cos=0.5513
[S6] RECEIVED delta(kind=head bytes=1793) from S10
[S6] cosine check vs S10: cos=0.8120
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.5561
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.6555
[S5] RECEIVED delta(kind=head bytes=1794) from S7
[S5] cosine check vs S7: cos=0.4900
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=-0.0246
[S13] DROPPED delta from S11 (cos=-0.0246 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:51908
[S16] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] cosine check vs S16: cos=-0.0307
[S7] DROPPED delta from S16 (cos=-0.0307 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:51905
[S15] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S15
[S5] cosine check vs S15: cos=0.4078
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.1414 head_norm=0.766191
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.906928e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.968716 delta_norm=0.390693
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.604958
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.736071e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.609883 delta_norm=0.273607
[S5] aggregate: ACCEPT kept=['S7', 'S15'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=0.658875
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.625539e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.900446 delta_norm=0.562554
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=1.198857
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.548619e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.945912 delta_norm=0.454862
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=4 metric=0.1418 head_norm=0.894501
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.249281e-01
[S2] stored merged vector for next round verification (round=4)
[S2] DEBUG after merge:  round=4 metric=0.1418 head_norm=0.672372 delta_norm=0.624928
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.1409 head_norm=0.789312
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.336116e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.1409 head_norm=0.651083 delta_norm=0.433612
[S17] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.672372 cos_to_last_merge=1.0000 (last merge round=4)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7118322041291334, 'loss_val': 1.2542631601675753, 'psi': 0.36979916168479343}-{'f1_val': 0.1417771333885667, 'auprc': 0.7853364857667817, 'loss_val': 1.252115787030462, 'psi': 0.39920087433985274}
[S3] START round=5 head_norm_before_train=1.176273 (no previous merge yet)
[S3] round=5 local utility u=0.012489 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6495893267900084, 'loss_val': 1.180208847211388, 'psi': 0.34373977008446754}-{'f1_val': 0.13984006561410703, 'auprc': 0.6597167320937523, 'loss_val': 1.2355696933567626, 'psi': 0.3477907322059651}
[S4] START round=5 head_norm_before_train=1.349230 (no previous merge yet)
[S4] round=5 local utility u=1.000000 metrics={'f1_val': 0.5446048728357309, 'auprc': 0.7848642283923942, 'loss_val': 0.9390288219249349, 'psi': 0.6407086150583963}-{'f1_val': 0.14022662889518414, 'auprc': 0.782841676666875, 'loss_val': 1.1112375499956928, 'psi': 0.3972726480038605}
[S5] START round=5 head_norm_before_train=0.609883 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.007275 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7288280101989824, 'loss_val': 1.2528949599104056, 'psi': 0.3768883469367358}-{'f1_val': 0.14226190476190476, 'auprc': 0.7289494485714132, 'loss_val': 1.2678085925140425, 'psi': 0.37693692228570813}
[S6] START round=5 head_norm_before_train=0.968716 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6138428750524164, 'loss_val': 1.2376660170528317, 'psi': 0.3303929192517358}-{'f1_val': 0.14142628205128205, 'auprc': 0.6498668640596095, 'loss_val': 1.2623443787869988, 'psi': 0.344802514854613}
[S7] START round=5 head_norm_before_train=0.945912 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.021420 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7947382841314357, 'loss_val': 1.2142693323953984, 'psi': 0.4031294072900293}-{'f1_val': 0.14205682272909165, 'auprc': 0.7863208125755489, 'loss_val': 1.231856063550354, 'psi': 0.39976241866767454}
[S8] START round=5 head_norm_before_train=1.232497 (no previous merge yet)
[S8] round=5 local utility u=1.000000 metrics={'f1_val': 0.6289984954157177, 'auprc': 0.766279933755981, 'loss_val': 1.109992161411284, 'psi': 0.683911070751823}-{'f1_val': 0.13995598239295717, 'auprc': 0.7429437213666696, 'loss_val': 1.1911111844159668, 'psi': 0.3811510779824422}
[S9] START round=5 head_norm_before_train=0.940800 cos_to_last_merge=0.9880 (last merge round=2)
[S9] round=5 local utility u=0.896417 metrics={'f1_val': 0.39839774825087854, 'auprc': 0.8947014154070752, 'loss_val': 0.9926813201128893, 'psi': 0.5969192151133572}-{'f1_val': 0.141397957139996, 'auprc': 0.8662345965627453, 'loss_val': 1.158115616918957, 'psi': 0.43133261290909575}
[S10] START round=5 head_norm_before_train=1.262955 (no previous merge yet)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6642452721938835, 'loss_val': 1.1280233367132106, 'psi': 0.34887109140258776}-{'f1_val': 0.13862163754172394, 'auprc': 0.7109467725287643, 'loss_val': 1.2004780616246435, 'psi': 0.36755169153654005}
[S11] START round=5 head_norm_before_train=0.900446 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8256603068292646, 'loss_val': 1.196127138842365, 'psi': 0.4145123327555722}-{'f1_val': 0.14041368337311058, 'auprc': 0.9249285877546742, 'loss_val': 1.2240904407510094, 'psi': 0.45421964512573604}
[S13] START round=5 head_norm_before_train=0.797376 cos_to_last_merge=0.9690 (last merge round=1)
[S13] round=5 local utility u=0.014962 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6811224479853785, 'loss_val': 1.220567338694846, 'psi': 0.35668043674038324}-{'f1_val': 0.1403857625770531, 'auprc': 0.689416185809093, 'loss_val': 1.2753726936029879, 'psi': 0.35999793186986906}
[S14] START round=5 head_norm_before_train=0.875238 cos_to_last_merge=0.9875 (last merge round=2)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7449274745287083, 'loss_val': 1.2361253537270522, 'psi': 0.3821857015411056}-{'f1_val': 0.14035785288270378, 'auprc': 0.8356250525574145, 'loss_val': 1.2803944193241223, 'psi': 0.41846473275258805}
[S15] START round=5 head_norm_before_train=0.967927 cos_to_last_merge=0.9806 (last merge round=1)
[S15] round=5 local utility u=0.044592 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7756490371970075, 'loss_val': 1.1599360238439276, 'psi': 0.39409980569573805}-{'f1_val': 0.13973365136155833, 'auprc': 0.768856876537282, 'loss_val': 1.2287437312208724, 'psi': 0.3913829414318478}
[S16] START round=5 head_norm_before_train=0.938127 cos_to_last_merge=0.9974 (last merge round=3)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5602083403718148, 'loss_val': 1.226637934452324, 'psi': 0.3084658062682478}-{'f1_val': 0.14063745019920318, 'auprc': 0.804370275573373, 'loss_val': 1.2684783611943493, 'psi': 0.4061305803488712}
[S17] START round=5 head_norm_before_train=0.651083 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6885051935203642, 'loss_val': 1.2071120192265856, 'psi': 0.35997145539857633}-{'f1_val': 0.14094896331738438, 'auprc': 0.7026895632473853, 'loss_val': 1.2404824615178849, 'psi': 0.36564520328938477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:51917
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:51902
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:51905
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:51910
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:51912
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=0.5235
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=0.5258
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] cosine check vs S3: cos=-0.0767
[S9] DROPPED delta from S3 (cos=-0.0767 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S7
[S5] cosine check vs S7: cos=0.6047
[S11] RECEIVED delta(kind=head bytes=1797) from S5
[S11] cosine check vs S5: cos=0.3990
[S2] RECEIVED delta(kind=head bytes=1795) from S9
[S2] cosine check vs S9: cos=0.7207
[S5] RECEIVED delta(kind=head bytes=1794) from S13
[S5] cosine check vs S13: cos=0.0390
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9322
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.451 → S7@127.0.0.1:51908
[S6] ⇄ pheromone p=0.348 → S15@127.0.0.1:51915
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.917527
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.856901e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.866601 delta_norm=0.185690
[S11] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.422 → S13@127.0.0.1:51913
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.1418 head_norm=0.699613
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.389664e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.1418 head_norm=0.779674 delta_norm=0.338966
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.361 → S17@127.0.0.1:51917
[S10] ⇄ pheromone p=0.366 → S6@127.0.0.1:51907
[S3] ⇄ pheromone p=0.376 → S9@127.0.0.1:51910
[S15] ⇄ pheromone p=0.343 → S5@127.0.0.1:51905
[S4] ⇄ pheromone p=0.548 → S11@127.0.0.1:51912
[S9] ⇄ pheromone p=0.523 → S2@127.0.0.1:51902
[S13] ⇄ pheromone p=0.411 → S5@127.0.0.1:51905
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.637788
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.384419e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.527470 delta_norm=0.238442
[S5] aggregate: ACCEPT kept=['S15', 'S7', 'S13'] (k=3/3) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.413 → S11@127.0.0.1:51912
[S7] ⇄ pheromone p=0.339 → S5@127.0.0.1:51905
[S8] ⇄ pheromone p=0.623 → S17@127.0.0.1:51917
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=0.679277
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.380366e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1409 head_norm=0.859346 delta_norm=0.538037
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.416 → S16@127.0.0.1:51916
[S16] ⇄ pheromone p=0.409 → S7@127.0.0.1:51908
[S2] START round=6 head_norm_before_train=0.779674 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.043194 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7365107811663216, 'loss_val': 1.241911295323748, 'psi': 0.3796705924996687}-{'f1_val': 0.1417771333885667, 'auprc': 0.7118322041291334, 'loss_val': 1.2542631601675753, 'psi': 0.36979916168479343}
[S3] START round=6 head_norm_before_train=1.205094 (no previous merge yet)
[S3] round=6 local utility u=0.163871 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7244772806549196, 'loss_val': 1.0771300920883586, 'psi': 0.3736949516304321}-{'f1_val': 0.13984006561410703, 'auprc': 0.6495893267900084, 'loss_val': 1.180208847211388, 'psi': 0.34373977008446754}
[S4] START round=6 head_norm_before_train=1.402402 (no previous merge yet)
[S4] round=6 local utility u=0.283610 metrics={'f1_val': 0.665570942342453, 'auprc': 0.660795360298971, 'loss_val': 0.7253991434283612, 'psi': 0.6636607095250602}-{'f1_val': 0.5446048728357309, 'auprc': 0.7848642283923942, 'loss_val': 0.9390288219249349, 'psi': 0.6407086150583963}
[S5] START round=6 head_norm_before_train=0.527470 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.010855 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.728819037803095, 'loss_val': 1.2311583915203639, 'psi': 0.37688475797838084}-{'f1_val': 0.14226190476190476, 'auprc': 0.7288280101989824, 'loss_val': 1.2528949599104056, 'psi': 0.3768883469367358}
[S6] START round=6 head_norm_before_train=0.977819 cos_to_last_merge=0.9969 (last merge round=4)
[S6] round=6 local utility u=0.038223 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6139139616697237, 'loss_val': 1.161433488858833, 'psi': 0.3304213538986587}-{'f1_val': 0.14142628205128205, 'auprc': 0.6138428750524164, 'loss_val': 1.2376660170528317, 'psi': 0.3303929192517358}
[S7] START round=6 head_norm_before_train=0.974641 cos_to_last_merge=0.9984 (last merge round=4)
[S7] round=6 local utility u=0.034709 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7950039470110402, 'loss_val': 1.145647753976301, 'psi': 0.4032356724418711}-{'f1_val': 0.14205682272909165, 'auprc': 0.7947382841314357, 'loss_val': 1.2142693323953984, 'psi': 0.4031294072900293}
[S8] START round=6 head_norm_before_train=1.262735 (no previous merge yet)
[S8] round=6 local utility u=0.340162 metrics={'f1_val': 0.7153199448606985, 'auprc': 0.7769656773602824, 'loss_val': 0.9796537964772651, 'psi': 0.7399782378605321}-{'f1_val': 0.6289984954157177, 'auprc': 0.766279933755981, 'loss_val': 1.109992161411284, 'psi': 0.683911070751823}
[S9] START round=6 head_norm_before_train=0.977814 cos_to_last_merge=0.9770 (last merge round=2)
[S9] round=6 local utility u=0.981785 metrics={'f1_val': 0.6495781971815676, 'auprc': 0.9757056548641712, 'loss_val': 0.7792066201732772, 'psi': 0.7800291802546091}-{'f1_val': 0.39839774825087854, 'auprc': 0.8947014154070752, 'loss_val': 0.9926813201128893, 'psi': 0.5969192151133572}
[S10] START round=6 head_norm_before_train=1.284184 (no previous merge yet)
[S10] round=6 local utility u=0.907182 metrics={'f1_val': 0.4170758964666951, 'auprc': 0.6699836555421494, 'loss_val': 1.001600803879843, 'psi': 0.5182390000968768}-{'f1_val': 0.13862163754172394, 'auprc': 0.6642452721938835, 'loss_val': 1.1280233367132106, 'psi': 0.34887109140258776}
[S11] START round=6 head_norm_before_train=0.866601 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.052079 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8381016031892153, 'loss_val': 1.1292931755817297, 'psi': 0.4194888512995525}-{'f1_val': 0.14041368337311058, 'auprc': 0.8256603068292646, 'loss_val': 1.196127138842365, 'psi': 0.4145123327555722}
[S13] START round=6 head_norm_before_train=0.834688 cos_to_last_merge=0.9519 (last merge round=1)
[S13] round=6 local utility u=0.778951 metrics={'f1_val': 0.3651671591576185, 'auprc': 0.7193985738745454, 'loss_val': 1.1261815466000085, 'psi': 0.5068597250443893}-{'f1_val': 0.1403857625770531, 'auprc': 0.6811224479853785, 'loss_val': 1.220567338694846, 'psi': 0.35668043674038324}
[S14] START round=6 head_norm_before_train=0.915106 cos_to_last_merge=0.9759 (last merge round=2)
[S14] round=6 local utility u=0.023483 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7378065366987068, 'loss_val': 1.1677966222661555, 'psi': 0.37933732640910495}-{'f1_val': 0.14035785288270378, 'auprc': 0.7449274745287083, 'loss_val': 1.2361253537270522, 'psi': 0.3821857015411056}
[S15] START round=6 head_norm_before_train=1.009567 cos_to_last_merge=0.9695 (last merge round=1)
[S15] round=6 local utility u=0.894334 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7770531084440921, 'loss_val': 1.0353325738457857, 'psi': 0.5606467470820033}-{'f1_val': 0.13973365136155833, 'auprc': 0.7756490371970075, 'loss_val': 1.1599360238439276, 'psi': 0.39409980569573805}
[S16] START round=6 head_norm_before_train=0.967377 cos_to_last_merge=0.9900 (last merge round=3)
[S16] round=6 local utility u=0.833220 metrics={'f1_val': 0.41428462841297564, 'auprc': 0.5427017711212627, 'loss_val': 1.1495616658055932, 'psi': 0.4656514854962905}-{'f1_val': 0.14063745019920318, 'auprc': 0.5602083403718148, 'loss_val': 1.226637934452324, 'psi': 0.3084658062682478}
[S17] START round=6 head_norm_before_train=0.859346 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.853515 metrics={'f1_val': 0.3840860495837689, 'auprc': 0.7404732146375193, 'loss_val': 1.1148077269629022, 'psi': 0.526640915605269}-{'f1_val': 0.14094896331738438, 'auprc': 0.6885051935203642, 'loss_val': 1.2071120192265856, 'psi': 0.35997145539857633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S6] → sending delta(kind=head bytes=1788) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:51905
[S11] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1789) from S13
[S5] cosine check vs S13: cos=0.3255
[S5] RECEIVED delta(kind=head bytes=1791) from S7
[S5] cosine check vs S7: cos=0.5820
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.8261
[S7] RECEIVED delta(kind=head bytes=1789) from S16
[S7] cosine check vs S16: cos=-0.0334
[S7] DROPPED delta from S16 (cos=-0.0334 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1803) from S9
[S2] cosine check vs S9: cos=0.9303
[S5] RECEIVED delta(kind=head bytes=1794) from S15
[S5] cosine check vs S15: cos=0.5430
[S6] RECEIVED delta(kind=head bytes=1796) from S10
[S6] cosine check vs S10: cos=0.9384
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] cosine check vs S3: cos=-0.0732
[S9] DROPPED delta from S3 (cos=-0.0732 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.9334
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] cosine check vs S5: cos=0.5021
[S15] RECEIVED delta(kind=head bytes=1788) from S6
[S15] cosine check vs S6: cos=0.0077
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=0.9216
[S17] RECEIVED delta(kind=head bytes=1796) from S2
[S17] cosine check vs S2: cos=0.1120
[S13] RECEIVED delta(kind=head bytes=1792) from S11
[S13] cosine check vs S11: cos=-0.0201
[S13] DROPPED delta from S11 (cos=-0.0201 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:51916
[S17] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S17
[S16] cosine check vs S17: cos=0.2636
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.1418 head_norm=0.795443
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.048166e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.1418 head_norm=0.895779 delta_norm=0.204817
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=0.990886
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.574222e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=1.134981 delta_norm=0.257422
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.4164 head_norm=1.049649
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.189564e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.4162 head_norm=0.724507 delta_norm=0.718956
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.1404 head_norm=0.886602
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.291262e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.862470 delta_norm=0.129126
[S11] aggregate: ACCEPT kept=['S4', 'S5'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.1423 head_norm=0.560230
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.424379e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1423 head_norm=0.528232 delta_norm=0.142438
[S5] aggregate: ACCEPT kept=['S13', 'S7', 'S15'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=1.001853
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.893122e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.934831 delta_norm=0.289312
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4143 head_norm=0.998753
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.736338e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.3236 head_norm=0.749937 delta_norm=0.573634
[S16] aggregate: ROLLBACK (f1_val pre=0.414 post=0.324 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3841 head_norm=0.886237
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.388387e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.1675 head_norm=0.789780 delta_norm=0.238839
[S17] aggregate: ROLLBACK (f1_val pre=0.384 post=0.168 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=0.895779 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.072933 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7742954680431419, 'loss_val': 1.2093988152164308, 'psi': 0.3947844672503968}-{'f1_val': 0.1417771333885667, 'auprc': 0.7365107811663216, 'loss_val': 1.241911295323748, 'psi': 0.3796705924996687}
[S3] START round=7 head_norm_before_train=1.245510 (no previous merge yet)
[S3] round=7 local utility u=1.000000 metrics={'f1_val': 0.7085734681399771, 'auprc': 0.7959729563691773, 'loss_val': 0.9416160689466812, 'psi': 0.7435332634316572}-{'f1_val': 0.13984006561410703, 'auprc': 0.7244772806549196, 'loss_val': 1.0771300920883586, 'psi': 0.3736949516304321}
[S4] START round=7 head_norm_before_train=1.456121 (no previous merge yet)
[S4] round=7 local utility u=0.081171 metrics={'f1_val': 0.6646094466154784, 'auprc': 0.6596008117434946, 'loss_val': 0.553704123161157, 'psi': 0.662605992666685}-{'f1_val': 0.665570942342453, 'auprc': 0.660795360298971, 'loss_val': 0.7253991434283612, 'psi': 0.6636607095250602}
[S5] START round=7 head_norm_before_train=0.528232 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.036084 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.736701099634377, 'loss_val': 1.1826372411039996, 'psi': 0.38003758271089366}-{'f1_val': 0.14226190476190476, 'auprc': 0.728819037803095, 'loss_val': 1.2311583915203639, 'psi': 0.37688475797838084}
[S6] START round=7 head_norm_before_train=1.134981 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.042001 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6137923573643375, 'loss_val': 1.0770669438069682, 'psi': 0.3303727121765042}-{'f1_val': 0.14142628205128205, 'auprc': 0.6139139616697237, 'loss_val': 1.161433488858833, 'psi': 0.3304213538986587}
[S7] START round=7 head_norm_before_train=0.934831 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.930240 metrics={'f1_val': 0.454648292059629, 'auprc': 0.777986305537456, 'loss_val': 1.109662663444817, 'psi': 0.5839834974507598}-{'f1_val': 0.14205682272909165, 'auprc': 0.7950039470110402, 'loss_val': 1.145647753976301, 'psi': 0.4032356724418711}
[S8] START round=7 head_norm_before_train=1.291073 (no previous merge yet)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.37307134877987713, 'auprc': 0.7775692718816429, 'loss_val': 0.8474655234824863, 'psi': 0.5348705180205835}-{'f1_val': 0.7153199448606985, 'auprc': 0.7769656773602824, 'loss_val': 0.9796537964772651, 'psi': 0.7399782378605321}
[S9] START round=7 head_norm_before_train=1.027623 cos_to_last_merge=0.9622 (last merge round=2)
[S9] round=7 local utility u=0.247036 metrics={'f1_val': 0.6912131199149979, 'auprc': 0.9997868686944611, 'loss_val': 0.6071871548080708, 'psi': 0.8146426194267832}-{'f1_val': 0.6495781971815676, 'auprc': 0.9757056548641712, 'loss_val': 0.7792066201732772, 'psi': 0.7800291802546091}
[S10] START round=7 head_norm_before_train=1.314170 (no previous merge yet)
[S10] round=7 local utility u=0.968147 metrics={'f1_val': 0.7021253048547452, 'auprc': 0.6844816002592424, 'loss_val': 0.8190965280367789, 'psi': 0.6950678230165441}-{'f1_val': 0.4170758964666951, 'auprc': 0.6699836555421494, 'loss_val': 1.001600803879843, 'psi': 0.5182390000968768}
[S11] START round=7 head_norm_before_train=0.862470 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.871391 metrics={'f1_val': 0.3966199105536595, 'auprc': 0.8804637315727051, 'loss_val': 1.0508348422835931, 'psi': 0.5901574389612778}-{'f1_val': 0.14041368337311058, 'auprc': 0.8381016031892153, 'loss_val': 1.1292931755817297, 'psi': 0.4194888512995525}
[S13] START round=7 head_norm_before_train=0.882251 cos_to_last_merge=0.9323 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.932
[S13] round=7 local utility u=0.136416 metrics={'f1_val': 0.416200286011302, 'auprc': 0.6736646595412403, 'loss_val': 1.022346153518741, 'psi': 0.5191860354232773}-{'f1_val': 0.3651671591576185, 'auprc': 0.7193985738745454, 'loss_val': 1.1261815466000085, 'psi': 0.5068597250443893}
[S14] START round=7 head_norm_before_train=0.954731 cos_to_last_merge=0.9646 (last merge round=2)
[S14] round=7 local utility u=0.789303 metrics={'f1_val': 0.3915311964828873, 'auprc': 0.7364722342801672, 'loss_val': 1.0922272320162187, 'psi': 0.5295076116017993}-{'f1_val': 0.14035785288270378, 'auprc': 0.7378065366987068, 'loss_val': 1.1677966222661555, 'psi': 0.37933732640910495}
[S15] START round=7 head_norm_before_train=0.724507 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.533607 metrics={'f1_val': 0.5892905573196339, 'auprc': 0.7770489201658523, 'loss_val': 1.0055938392601254, 'psi': 0.6643939024581212}-{'f1_val': 0.4163758395072774, 'auprc': 0.7770531084440921, 'loss_val': 1.0353325738457857, 'psi': 0.5606467470820033}
[S16] START round=7 head_norm_before_train=0.749937 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.005523 metrics={'f1_val': 0.41683695810830534, 'auprc': 0.5237823641211773, 'loss_val': 1.097071020029843, 'psi': 0.4596151205134541}-{'f1_val': 0.41428462841297564, 'auprc': 0.5427017711212627, 'loss_val': 1.1495616658055932, 'psi': 0.4656514854962905}
[S17] START round=7 head_norm_before_train=0.789780 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.126976 metrics={'f1_val': 0.4119556860785679, 'auprc': 0.7349650257184329, 'loss_val': 1.0115488837733777, 'psi': 0.5411594219345139}-{'f1_val': 0.3840860495837689, 'auprc': 0.7404732146375193, 'loss_val': 1.1148077269629022, 'psi': 0.526640915605269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:51908
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:51917
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.9334
[S17] RECEIVED delta(kind=head bytes=1796) from S2
[S17] cosine check vs S2: cos=0.2813
[S11] RECEIVED delta(kind=head bytes=1797) from S5
[S11] cosine check vs S5: cos=0.5142
[S9] RECEIVED delta(kind=head bytes=1797) from S3
[S9] cosine check vs S3: cos=-0.0701
[S9] DROPPED delta from S3 (cos=-0.0701 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S6
[S15] cosine check vs S6: cos=0.6522
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9330
[S2] RECEIVED delta(kind=head bytes=1799) from S9
[S2] cosine check vs S9: cos=0.9718
[S5] RECEIVED delta(kind=head bytes=1796) from S7
[S5] cosine check vs S7: cos=0.4925
[S5] RECEIVED delta(kind=head bytes=1795) from S13
[S5] cosine check vs S13: cos=0.4774
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:51905
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:51907
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=-0.0071
[S7] DROPPED delta from S16 (cos=-0.0071 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S15
[S5] cosine check vs S15: cos=0.3360
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1788) from S11
[S13] cosine check vs S11: cos=0.0288
[S6] RECEIVED delta(kind=head bytes=1796) from S10
[S6] cosine check vs S10: cos=0.9779
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:51916
[S17] sending update (kind=head size=1791 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1791) from S17
[S16] cosine check vs S17: cos=0.6965
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.1418 head_norm=0.908896
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.466848e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.1418 head_norm=0.989304 delta_norm=0.146685
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.1414 head_norm=1.146033
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.701883e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.1414 head_norm=1.247185 delta_norm=0.170188
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.1423 head_norm=0.557474
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.692257e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.1423 head_norm=0.492091 delta_norm=0.169226
[S5] aggregate: ACCEPT kept=['S7', 'S13', 'S15'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.4546 head_norm=0.955090
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.791012e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.3935 head_norm=0.959062 delta_norm=0.179101
[S7] aggregate: ROLLBACK (f1_val pre=0.455 post=0.393 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4162 head_norm=0.928519
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.329452e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4163 head_norm=0.651405 delta_norm=0.632945
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3966 head_norm=0.887553
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.166481e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3966 head_norm=0.876375 delta_norm=0.116648
[S11] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.5893 head_norm=0.761634
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.344088e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.4167 head_norm=0.870648 delta_norm=0.434409
[S15] aggregate: ROLLBACK (f1_val pre=0.589 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4168 head_norm=0.784894
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.139573e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4161 head_norm=0.741098 delta_norm=0.313957
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.4120 head_norm=0.824337
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.205961e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.4570 head_norm=0.694112 delta_norm=0.520596
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.989304 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6647459067468896, 'loss_val': 1.1538850533266192, 'psi': 0.35096464273189587}-{'f1_val': 0.1417771333885667, 'auprc': 0.7742954680431419, 'loss_val': 1.2093988152164308, 'psi': 0.3947844672503968}
[S3] START round=8 head_norm_before_train=1.284446 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.48845090667380586, 'auprc': 0.7962221015211529, 'loss_val': 0.7633830722227283, 'psi': 0.6115593846127447}-{'f1_val': 0.7085734681399771, 'auprc': 0.7959729563691773, 'loss_val': 0.9416160689466812, 'psi': 0.7435332634316572}
[S4] START round=8 head_norm_before_train=1.514901 (no previous merge yet)
[S4] round=8 local utility u=0.019749 metrics={'f1_val': 0.6646597260842257, 'auprc': 0.6578593904531796, 'loss_val': 0.5092840135106463, 'psi': 0.6619395918318074}-{'f1_val': 0.6646094466154784, 'auprc': 0.6596008117434946, 'loss_val': 0.553704123161157, 'psi': 0.662605992666685}
[S5] START round=8 head_norm_before_train=0.492091 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.876481 metrics={'f1_val': 0.41714700908202623, 'auprc': 0.7571895147846502, 'loss_val': 1.140451980634697, 'psi': 0.5531640113630758}-{'f1_val': 0.14226190476190476, 'auprc': 0.736701099634377, 'loss_val': 1.1826372411039996, 'psi': 0.38003758271089366}
[S6] START round=8 head_norm_before_train=1.247185 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.985930 metrics={'f1_val': 0.4164909323537405, 'auprc': 0.6770699525364507, 'loss_val': 0.9454285248116284, 'psi': 0.5207225404268246}-{'f1_val': 0.14142628205128205, 'auprc': 0.6137923573643375, 'loss_val': 1.0770669438069682, 'psi': 0.3303727121765042}
[S7] START round=8 head_norm_before_train=0.959062 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.491585 metrics={'f1_val': 0.6077438994032291, 'auprc': 0.7725723057101131, 'loss_val': 1.0288235972907254, 'psi': 0.6736752619259827}-{'f1_val': 0.454648292059629, 'auprc': 0.777986305537456, 'loss_val': 1.109662663444817, 'psi': 0.5839834974507598}
[S8] START round=8 head_norm_before_train=1.322488 (no previous merge yet)
[S8] round=8 local utility u=0.080357 metrics={'f1_val': 0.3729322731464855, 'auprc': 0.7955379132508849, 'loss_val': 0.739822659634186, 'psi': 0.5419745291882453}-{'f1_val': 0.37307134877987713, 'auprc': 0.7775692718816429, 'loss_val': 0.8474655234824863, 'psi': 0.5348705180205835}
[S9] START round=8 head_norm_before_train=1.083691 cos_to_last_merge=0.9441 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.944
[S9] round=8 local utility u=0.108061 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9992912090755611, 'loss_val': 0.4509336826102106, 'psi': 0.8205799637991973}-{'f1_val': 0.6912131199149979, 'auprc': 0.9997868686944611, 'loss_val': 0.6071871548080708, 'psi': 0.8146426194267832}
[S10] START round=8 head_norm_before_train=1.362160 (no previous merge yet)
[S10] round=8 local utility u=0.309559 metrics={'f1_val': 0.6895276463969079, 'auprc': 0.8713467671903049, 'loss_val': 0.6849881856066314, 'psi': 0.7622552947142667}-{'f1_val': 0.7021253048547452, 'auprc': 0.6844816002592424, 'loss_val': 0.8190965280367789, 'psi': 0.6950678230165441}
[S11] START round=8 head_norm_before_train=0.876375 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.135533 metrics={'f1_val': 0.39658602128368947, 'auprc': 0.942423691101969, 'loss_val': 0.9654455407494097, 'psi': 0.6149210892110013}-{'f1_val': 0.3966199105536595, 'auprc': 0.8804637315727051, 'loss_val': 1.0508348422835931, 'psi': 0.5901574389612778}
[S13] START round=8 head_norm_before_train=0.651405 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.002553 metrics={'f1_val': 0.3893839035933124, 'auprc': 0.7254972267928206, 'loss_val': 1.0118404837322506, 'psi': 0.5238292328731157}-{'f1_val': 0.416200286011302, 'auprc': 0.6736646595412403, 'loss_val': 1.022346153518741, 'psi': 0.5191860354232773}
[S14] START round=8 head_norm_before_train=0.995770 cos_to_last_merge=0.9529 (last merge round=2)
[S14] round=8 local utility u=0.143248 metrics={'f1_val': 0.3915416722537795, 'auprc': 0.7755231595877414, 'loss_val': 0.922947757372856, 'psi': 0.5451342671873642}-{'f1_val': 0.3915311964828873, 'auprc': 0.7364722342801672, 'loss_val': 1.0922272320162187, 'psi': 0.5295076116017993}
[S15] START round=8 head_norm_before_train=0.870648 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.4643014223072459, 'auprc': 0.7768265546983559, 'loss_val': 0.9320120722972206, 'psi': 0.5893114752636899}-{'f1_val': 0.5892905573196339, 'auprc': 0.7770489201658523, 'loss_val': 1.0055938392601254, 'psi': 0.6643939024581212}
[S16] START round=8 head_norm_before_train=0.741098 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.011327 metrics={'f1_val': 0.41696372269722326, 'auprc': 0.5244110391052382, 'loss_val': 1.077062797747077, 'psi': 0.45994264926042927}-{'f1_val': 0.41683695810830534, 'auprc': 0.5237823641211773, 'loss_val': 1.097071020029843, 'psi': 0.4596151205134541}
[S17] START round=8 head_norm_before_train=0.694112 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.39070222148265243, 'auprc': 0.7270234492355315, 'loss_val': 1.0086365064668632, 'psi': 0.525230712583804}-{'f1_val': 0.4119556860785679, 'auprc': 0.7349650257184329, 'loss_val': 1.0115488837733777, 'psi': 0.5411594219345139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:51912
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:51908
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] cosine check vs S5: cos=0.4848
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] cosine check vs S14: cos=0.9639
[S2] RECEIVED delta(kind=head bytes=1801) from S9
[S2] cosine check vs S9: cos=0.9821
[S5] RECEIVED delta(kind=head bytes=1800) from S7
[S5] cosine check vs S7: cos=0.4821
[S5] RECEIVED delta(kind=head bytes=1798) from S13
[S5] cosine check vs S13: cos=0.6968
[S6] RECEIVED delta(kind=head bytes=1800) from S10
[S6] cosine check vs S10: cos=0.9878
[S13] RECEIVED delta(kind=head bytes=1790) from S11
[S13] cosine check vs S11: cos=0.6973
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9334
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:51908
[S16] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:51917
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:51915
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=-0.0018
[S7] DROPPED delta from S16 (cos=-0.0018 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S6
[S15] cosine check vs S6: cos=0.9116
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.5143
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.1418 head_norm=1.006421
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.222130e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.1418 head_norm=1.069931 delta_norm=0.122213
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.6077 head_norm=0.985462
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.396411e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.6556 head_norm=1.006517 delta_norm=0.139641
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4171 head_norm=0.524136
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.841878e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4173 head_norm=0.533263 delta_norm=0.184188
[S5] aggregate: ACCEPT kept=['S7', 'S13'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.3894 head_norm=0.689556
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.264208e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4160 head_norm=0.736753 delta_norm=0.326421
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.4643 head_norm=0.902753
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.869656e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.4174 head_norm=1.058189 delta_norm=0.286966
[S15] aggregate: ROLLBACK (f1_val pre=0.464 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3966 head_norm=0.907317
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.129191e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3966 head_norm=0.890314 delta_norm=0.112919
[S11] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.4165 head_norm=1.260660
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.306931e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.3406 head_norm=1.335412 delta_norm=0.130693
[S6] aggregate: ROLLBACK (f1_val pre=0.416 post=0.341 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3907 head_norm=0.735280
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.829034e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.4044 head_norm=0.923882 delta_norm=0.582903
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.069931 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.979183 metrics={'f1_val': 0.4160938496492347, 'auprc': 0.7427796497128083, 'loss_val': 1.0755207341098625, 'psi': 0.5467681696746641}-{'f1_val': 0.1417771333885667, 'auprc': 0.6647459067468896, 'loss_val': 1.1538850533266192, 'psi': 0.35096464273189587}
[S3] START round=9 head_norm_before_train=1.332586 (no previous merge yet)
[S3] round=9 local utility u=0.094439 metrics={'f1_val': 0.4045316402820668, 'auprc': 0.9981445132605716, 'loss_val': 0.6767574291839187, 'psi': 0.6419767894734687}-{'f1_val': 0.48845090667380586, 'auprc': 0.7962221015211529, 'loss_val': 0.7633830722227283, 'psi': 0.6115593846127447}
[S4] START round=9 head_norm_before_train=1.569646 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.665433739993406, 'auprc': 0.6534391206880105, 'loss_val': 0.5132944793026947, 'psi': 0.6606358922712479}-{'f1_val': 0.6646597260842257, 'auprc': 0.6578593904531796, 'loss_val': 0.5092840135106463, 'psi': 0.6619395918318074}
[S5] START round=9 head_norm_before_train=0.533263 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.040880 metrics={'f1_val': 0.4174279751372442, 'auprc': 0.7586008104022363, 'loss_val': 1.0646126293327738, 'psi': 0.553897109243241}-{'f1_val': 0.41714700908202623, 'auprc': 0.7571895147846502, 'loss_val': 1.140451980634697, 'psi': 0.5531640113630758}
[S6] START round=9 head_norm_before_train=1.335412 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.789650 metrics={'f1_val': 0.6201789593095625, 'auprc': 0.7509557596497525, 'loss_val': 0.8099140027279683, 'psi': 0.6724896794456385}-{'f1_val': 0.4164909323537405, 'auprc': 0.6770699525364507, 'loss_val': 0.9454285248116284, 'psi': 0.5207225404268246}
[S7] START round=9 head_norm_before_train=1.006517 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.091044 metrics={'f1_val': 0.6313978921650847, 'auprc': 0.7702993043233974, 'loss_val': 0.9818404935239141, 'psi': 0.6869584570284097}-{'f1_val': 0.6077438994032291, 'auprc': 0.7725723057101131, 'loss_val': 1.0288235972907254, 'psi': 0.6736752619259827}
[S8] START round=9 head_norm_before_train=1.358687 (no previous merge yet)
[S8] round=9 local utility u=0.291759 metrics={'f1_val': 0.3731322377369826, 'auprc': 0.956075850274683, 'loss_val': 0.6391180518351948, 'psi': 0.6063096827520628}-{'f1_val': 0.3729322731464855, 'auprc': 0.7955379132508849, 'loss_val': 0.739822659634186, 'psi': 0.5419745291882453}
[S9] START round=9 head_norm_before_train=1.143020 cos_to_last_merge=0.9257 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.926
[S9] round=9 local utility u=0.032819 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9991183656444163, 'loss_val': 0.3858311885449373, 'psi': 0.8206162556887036}-{'f1_val': 0.7014391336149548, 'auprc': 0.9992912090755611, 'loss_val': 0.4509336826102106, 'psi': 0.8205799637991973}
[S10] START round=9 head_norm_before_train=1.418291 (no previous merge yet)
[S10] round=9 local utility u=0.202714 metrics={'f1_val': 0.7003378746167876, 'auprc': 0.9391929171945543, 'loss_val': 0.5479604805338171, 'psi': 0.7958798916478944}-{'f1_val': 0.6895276463969079, 'auprc': 0.8713467671903049, 'loss_val': 0.6849881856066314, 'psi': 0.7622552947142667}
[S11] START round=9 head_norm_before_train=0.890314 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.037801 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9428219157275343, 'loss_val': 0.8908363789850638, 'psi': 0.6150601078467375}-{'f1_val': 0.39658602128368947, 'auprc': 0.942423691101969, 'loss_val': 0.9654455407494097, 'psi': 0.6149210892110013}
[S13] START round=9 head_norm_before_train=0.736753 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.846097 metrics={'f1_val': 0.6740506694728764, 'auprc': 0.7081450443927904, 'loss_val': 0.9755899650596954, 'psi': 0.687688419440842}-{'f1_val': 0.3893839035933124, 'auprc': 0.7254972267928206, 'loss_val': 1.0118404837322506, 'psi': 0.5238292328731157}
[S14] START round=9 head_norm_before_train=1.045953 cos_to_last_merge=0.9386 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=9 local utility u=0.266842 metrics={'f1_val': 0.3915416722537795, 'auprc': 0.8943981568642465, 'loss_val': 0.7458882702645108, 'psi': 0.5926842660979663}-{'f1_val': 0.3915416722537795, 'auprc': 0.7755231595877414, 'loss_val': 0.922947757372856, 'psi': 0.5451342671873642}
[S15] START round=9 head_norm_before_train=1.058189 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=1.000000 metrics={'f1_val': 0.6997377472079731, 'auprc': 0.997514390585304, 'loss_val': 0.7918312608619005, 'psi': 0.8188484045589055}-{'f1_val': 0.4643014223072459, 'auprc': 0.7768265546983559, 'loss_val': 0.9320120722972206, 'psi': 0.5893114752636899}
[S16] START round=9 head_norm_before_train=0.777721 cos_to_last_merge=0.9933 (last merge round=7)
[S16] round=9 local utility u=0.118918 metrics={'f1_val': 0.3536036449884551, 'auprc': 0.7237512313598147, 'loss_val': 1.0570873273342976, 'psi': 0.501662679536999}-{'f1_val': 0.41696372269722326, 'auprc': 0.5244110391052382, 'loss_val': 1.077062797747077, 'psi': 0.45994264926042927}
[S17] START round=9 head_norm_before_train=0.923882 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.337890590216245, 'auprc': 0.6043954257600699, 'loss_val': 0.9998276272730034, 'psi': 0.44449252443377496}-{'f1_val': 0.39070222148265243, 'auprc': 0.7270234492355315, 'loss_val': 1.0086365064668632, 'psi': 0.525230712583804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:51913
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:51917
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S13
[S5] cosine check vs S13: cos=0.6153
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=0.9912
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] cosine check vs S5: cos=0.4944
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] cosine check vs S11: cos=0.9130
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.9180
[S17] RECEIVED delta(kind=head bytes=1802) from S2
[S17] cosine check vs S2: cos=0.2940
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.9731
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=-0.0121
[S7] DROPPED delta from S16 (cos=-0.0121 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=-0.0631
[S9] DROPPED delta from S3 (cos=-0.0631 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S6
[S15] cosine check vs S6: cos=0.9642
[S5] RECEIVED delta(kind=head bytes=1793) from S15
[S5] cosine check vs S15: cos=0.0131
[S2] RECEIVED delta(kind=head bytes=1802) from S9
[S2] cosine check vs S9: cos=0.9867
[S5] RECEIVED delta(kind=head bytes=1795) from S7
[S5] cosine check vs S7: cos=0.6509
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.6741 head_norm=0.770429
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.922266e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.6540 head_norm=0.829104 delta_norm=0.192227
[S13] aggregate: ROLLBACK (f1_val pre=0.674 post=0.654 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.6314 head_norm=1.037064
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.279797e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.6117 head_norm=1.061566 delta_norm=0.127980
[S7] aggregate: ROLLBACK (f1_val pre=0.631 post=0.612 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.3966 head_norm=0.924753
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.059568e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.3966 head_norm=0.652690 delta_norm=0.405957
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.6997 head_norm=1.090368
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.102226e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.6938 head_norm=1.212595 delta_norm=0.210223
[S15] aggregate: ROLLBACK (f1_val pre=0.700 post=0.694 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.6202 head_norm=1.356560
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.089735e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.5350 head_norm=1.409318 delta_norm=0.108974
[S6] aggregate: ROLLBACK (f1_val pre=0.620 post=0.535 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4174 head_norm=0.571350
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.016418e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4174 head_norm=0.520012 delta_norm=0.201642
[S5] aggregate: ACCEPT kept=['S13', 'S15', 'S7'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.4161 head_norm=1.091356
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.063149e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.4165 head_norm=1.139022 delta_norm=0.106315
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3379 head_norm=0.961632
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.977324e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3408 head_norm=0.900334 delta_norm=0.197732
[S17] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.139022 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.074494 metrics={'f1_val': 0.41714901250782, 'auprc': 0.7541850234049019, 'loss_val': 0.9670792078923857, 'psi': 0.5519634168666527}-{'f1_val': 0.4160938496492347, 'auprc': 0.7427796497128083, 'loss_val': 1.0755207341098625, 'psi': 0.5467681696746641}
[S3] START round=10 head_norm_before_train=1.384639 (no previous merge yet)
[S3] round=10 local utility u=0.428973 metrics={'f1_val': 0.534226066181489, 'auprc': 0.9985838761334701, 'loss_val': 0.5982964142740331, 'psi': 0.7199691901622816}-{'f1_val': 0.4045316402820668, 'auprc': 0.9981445132605716, 'loss_val': 0.6767574291839187, 'psi': 0.6419767894734687}
[S4] START round=10 head_norm_before_train=1.613707 (no previous merge yet)
[S4] round=10 local utility u=0.356144 metrics={'f1_val': 0.666500449081013, 'auprc': 0.8914110577377621, 'loss_val': 0.5213216311897693, 'psi': 0.7564646925437126}-{'f1_val': 0.665433739993406, 'auprc': 0.6534391206880105, 'loss_val': 0.5132944793026947, 'psi': 0.6606358922712479}
[S5] START round=10 head_norm_before_train=0.520012 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.4173066123054898, 'auprc': 0.7200432480938955, 'loss_val': 1.0193040431105351, 'psi': 0.5384012666208521}-{'f1_val': 0.4174279751372442, 'auprc': 0.7586008104022363, 'loss_val': 1.0646126293327738, 'psi': 0.553897109243241}
[S6] START round=10 head_norm_before_train=1.409318 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.425305 metrics={'f1_val': 0.7069004141085647, 'auprc': 0.8201996787310109, 'loss_val': 0.6873647542291518, 'psi': 0.7522201199575431}-{'f1_val': 0.6201789593095625, 'auprc': 0.7509557596497525, 'loss_val': 0.8099140027279683, 'psi': 0.6724896794456385}
[S7] START round=10 head_norm_before_train=1.061566 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.5042612785488065, 'auprc': 0.7715545474421242, 'loss_val': 0.9404528322756678, 'psi': 0.6111785861061336}-{'f1_val': 0.6313978921650847, 'auprc': 0.7702993043233974, 'loss_val': 0.9818404935239141, 'psi': 0.6869584570284097}
[S8] START round=10 head_norm_before_train=1.398503 (no previous merge yet)
[S8] round=10 local utility u=0.083400 metrics={'f1_val': 0.3727983816295533, 'auprc': 0.99334463037715, 'loss_val': 0.5821207660421733, 'psi': 0.621016881128592}-{'f1_val': 0.3731322377369826, 'auprc': 0.956075850274683, 'loss_val': 0.6391180518351948, 'psi': 0.6063096827520628}
[S9] START round=10 head_norm_before_train=1.194275 cos_to_last_merge=0.9093 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.909
[S9] round=10 local utility u=0.030295 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9986762342310607, 'loss_val': 0.3234700792519557, 'psi': 0.8203948922135875}-{'f1_val': 0.7016148490515617, 'auprc': 0.9991183656444163, 'loss_val': 0.3858311885449373, 'psi': 0.8206162556887036}
[S10] START round=10 head_norm_before_train=1.468282 (no previous merge yet)
[S10] round=10 local utility u=0.154957 metrics={'f1_val': 0.7002428651507397, 'auprc': 0.9946437914147488, 'loss_val': 0.4038285274834118, 'psi': 0.8180032356563434}-{'f1_val': 0.7003378746167876, 'auprc': 0.9391929171945543, 'loss_val': 0.5479604805338171, 'psi': 0.7958798916478944}
[S11] START round=10 head_norm_before_train=0.652690 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.3972692472692473, 'auprc': 0.9423033871308251, 'loss_val': 0.8998060897721197, 'psi': 0.6152829032138784}-{'f1_val': 0.39655223592620625, 'auprc': 0.9428219157275343, 'loss_val': 0.8908363789850638, 'psi': 0.6150601078467375}
[S13] START round=10 head_norm_before_train=0.829104 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.063304 metrics={'f1_val': 0.7119061509349174, 'auprc': 0.668315077222066, 'loss_val': 0.9566247121220607, 'psi': 0.6944697214497768}-{'f1_val': 0.6740506694728764, 'auprc': 0.7081450443927904, 'loss_val': 0.9755899650596954, 'psi': 0.687688419440842}
[S14] START round=10 head_norm_before_train=1.100500 cos_to_last_merge=0.9234 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.923
[S14] round=10 local utility u=1.000000 metrics={'f1_val': 0.7125647824055895, 'auprc': 0.9469874430499284, 'loss_val': 0.6100130848900965, 'psi': 0.8063338466633251}-{'f1_val': 0.3915416722537795, 'auprc': 0.8943981568642465, 'loss_val': 0.7458882702645108, 'psi': 0.5926842660979663}
[S15] START round=10 head_norm_before_train=1.212595 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6972823971884495, 'auprc': 0.9216009239159184, 'loss_val': 0.6651489662134888, 'psi': 0.7870098078794371}-{'f1_val': 0.6997377472079731, 'auprc': 0.997514390585304, 'loss_val': 0.7918312608619005, 'psi': 0.8188484045589055}
[S16] START round=10 head_norm_before_train=0.828668 cos_to_last_merge=0.9759 (last merge round=7)
[S16] round=10 local utility u=0.106114 metrics={'f1_val': 0.37854887021630734, 'auprc': 0.7225747664322817, 'loss_val': 0.9910019542667173, 'psi': 0.516159228702697}-{'f1_val': 0.3536036449884551, 'auprc': 0.7237512313598147, 'loss_val': 1.0570873273342976, 'psi': 0.501662679536999}
[S17] START round=10 head_norm_before_train=0.900334 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.34343388942939257, 'auprc': 0.578354269502054, 'loss_val': 0.9984190218922123, 'psi': 0.4374020414584572}-{'f1_val': 0.337890590216245, 'auprc': 0.6043954257600699, 'loss_val': 0.9998276272730034, 'psi': 0.44449252443377496}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:51912
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:51907
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:51917
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] cosine check vs S14: cos=0.9770
[S9] RECEIVED delta(kind=head bytes=1801) from S3
[S9] cosine check vs S3: cos=-0.0556
[S9] DROPPED delta from S3 (cos=-0.0556 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] cosine check vs S6: cos=0.9785
[S6] RECEIVED delta(kind=head bytes=1799) from S10
[S6] cosine check vs S10: cos=0.9922
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.8541
[S5] RECEIVED delta(kind=head bytes=1794) from S13
[S5] cosine check vs S13: cos=0.6715
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.7693
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] cosine check vs S2: cos=0.4453
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:51908
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=-0.0231
[S7] DROPPED delta from S16 (cos=-0.0231 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S9] → sending delta(kind=head bytes=1810) to S2@127.0.0.1:51902
[S9] sending update (kind=head size=1810 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1810) from S9
[S2] cosine check vs S9: cos=0.9886
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.3973 head_norm=0.695806
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.001524e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.5732 head_norm=1.115124 delta_norm=0.600152
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.255 → S13@127.0.0.1:51913
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4173 head_norm=0.559927
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.192687e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.4172 head_norm=0.652543 delta_norm=0.319269
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.259 → S11@127.0.0.1:51912
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.5043 head_norm=1.091472
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.244450e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.5056 head_norm=1.116455 delta_norm=0.124445
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.287 → S5@127.0.0.1:51905
[S3] ⇄ pheromone p=0.340 → S9@127.0.0.1:51910
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.7069 head_norm=1.439297
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.881870e-02
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.6786 head_norm=1.472677 delta_norm=0.098819
[S6] aggregate: ROLLBACK (f1_val pre=0.707 post=0.679 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.459 → S15@127.0.0.1:51915
[S14] ⇄ pheromone p=0.491 → S7@127.0.0.1:51908
[S10] ⇄ pheromone p=0.396 → S6@127.0.0.1:51907
[S13] ⇄ pheromone p=0.361 → S5@127.0.0.1:51905
[S4] ⇄ pheromone p=0.285 → S11@127.0.0.1:51912
[S8] ⇄ pheromone p=0.306 → S17@127.0.0.1:51917
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.4171 head_norm=1.167519
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.854880e-02
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.4171 head_norm=1.202036 delta_norm=0.098549
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.301 → S17@127.0.0.1:51917
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.6973 head_norm=1.248979
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.685126e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.6969 head_norm=1.336924 delta_norm=0.168513
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.400 → S5@127.0.0.1:51905
[S16] ⇄ pheromone p=0.245 → S7@127.0.0.1:51908
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3434 head_norm=0.937336
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.433694e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3423 head_norm=0.916211 delta_norm=0.143369
[S17] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.219 → S16@127.0.0.1:51916
[S9] ⇄ pheromone p=0.302 → S2@127.0.0.1:51902
[S2] START round=11 head_norm_before_train=1.202036 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.951403 metrics={'f1_val': 0.7011893795727207, 'auprc': 0.7750788081602269, 'loss_val': 0.8311958147044931, 'psi': 0.7307451510077232}-{'f1_val': 0.41714901250782, 'auprc': 0.7541850234049019, 'loss_val': 0.9670792078923857, 'psi': 0.5519634168666527}
[S3] START round=11 head_norm_before_train=1.432749 (no previous merge yet)
[S3] round=11 local utility u=0.585074 metrics={'f1_val': 0.7010863553524592, 'auprc': 0.9986034938649444, 'loss_val': 0.42936924679417576, 'psi': 0.8200932107574533}-{'f1_val': 0.534226066181489, 'auprc': 0.9985838761334701, 'loss_val': 0.5982964142740331, 'psi': 0.7199691901622816}
[S4] START round=11 head_norm_before_train=1.650218 (no previous merge yet)
[S4] round=11 local utility u=0.074740 metrics={'f1_val': 0.6670121421478854, 'auprc': 0.9437287792065754, 'loss_val': 0.5318639896332766, 'psi': 0.7776987969713614}-{'f1_val': 0.666500449081013, 'auprc': 0.8914110577377621, 'loss_val': 0.5213216311897693, 'psi': 0.7564646925437126}
[S5] START round=11 head_norm_before_train=0.652543 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.41718547513587745, 'auprc': 0.6583478683840253, 'loss_val': 0.9357332261601993, 'psi': 0.5136504324351365}-{'f1_val': 0.4173066123054898, 'auprc': 0.7200432480938955, 'loss_val': 1.0193040431105351, 'psi': 0.5384012666208521}
[S6] START round=11 head_norm_before_train=1.472677 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.6211919336012239, 'auprc': 0.7856308161625168, 'loss_val': 0.6349541955116427, 'psi': 0.6869674866257411}-{'f1_val': 0.7069004141085647, 'auprc': 0.8201996787310109, 'loss_val': 0.6873647542291518, 'psi': 0.7522201199575431}
[S7] START round=11 head_norm_before_train=1.116455 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.39863383406346986, 'auprc': 0.5567071588415073, 'loss_val': 1.07462585116853, 'psi': 0.46186316397468485}-{'f1_val': 0.5042612785488065, 'auprc': 0.7715545474421242, 'loss_val': 0.9404528322756678, 'psi': 0.6111785861061336}
[S8] START round=11 head_norm_before_train=1.437054 (no previous merge yet)
[S8] round=11 local utility u=1.000000 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9949501021938982, 'loss_val': 0.4294554663933619, 'psi': 0.8262738078679154}-{'f1_val': 0.3727983816295533, 'auprc': 0.99334463037715, 'loss_val': 0.5821207660421733, 'psi': 0.621016881128592}
[S9] START round=11 head_norm_before_train=1.243423 cos_to_last_merge=0.8938 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.894
[S9] round=11 local utility u=0.022114 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9984413452812194, 'loss_val': 0.2770364118353973, 'psi': 0.8201508282370258}-{'f1_val': 0.7015406642019387, 'auprc': 0.9986762342310607, 'loss_val': 0.3234700792519557, 'psi': 0.8203948922135875}
[S10] START round=11 head_norm_before_train=1.511790 (no previous merge yet)
[S10] round=11 local utility u=0.046743 metrics={'f1_val': 0.7000134762741985, 'auprc': 0.9971527732791521, 'loss_val': 0.31649278914613055, 'psi': 0.81886919507618}-{'f1_val': 0.7002428651507397, 'auprc': 0.9946437914147488, 'loss_val': 0.4038285274834118, 'psi': 0.8180032356563434}
[S11] START round=11 head_norm_before_train=1.115124 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=1.000000 metrics={'f1_val': 0.701890640953942, 'auprc': 0.9484470742664023, 'loss_val': 0.6669409040384642, 'psi': 0.8005132142789262}-{'f1_val': 0.3972692472692473, 'auprc': 0.9423033871308251, 'loss_val': 0.8998060897721197, 'psi': 0.6152829032138784}
[S13] START round=11 head_norm_before_train=0.861378 cos_to_last_merge=0.9929 (last merge round=9)
[S13] round=11 local utility u=0.103052 metrics={'f1_val': 0.7113104823159138, 'auprc': 0.6841065431238409, 'loss_val': 0.7943210847466722, 'psi': 0.7004289066390846}-{'f1_val': 0.7119061509349174, 'auprc': 0.668315077222066, 'loss_val': 0.9566247121220607, 'psi': 0.6944697214497768}
[S14] START round=11 head_norm_before_train=1.154386 cos_to_last_merge=0.9075 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.908
[S14] round=11 local utility u=1.000000 metrics={'f1_val': 0.9940252997910746, 'auprc': 0.9981837172366773, 'loss_val': 0.4024244184427468, 'psi': 0.9956886667693157}-{'f1_val': 0.7125647824055895, 'auprc': 0.9469874430499284, 'loss_val': 0.6100130848900965, 'psi': 0.8063338466633251}
[S15] START round=11 head_norm_before_train=1.336924 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6986592290218648, 'auprc': 0.659102673748393, 'loss_val': 0.5573697405250324, 'psi': 0.682836606912476}-{'f1_val': 0.6972823971884495, 'auprc': 0.9216009239159184, 'loss_val': 0.6651489662134888, 'psi': 0.7870098078794371}
[S16] START round=11 head_norm_before_train=0.883720 cos_to_last_merge=0.9548 (last merge round=7)
[S16] round=11 local utility u=0.249248 metrics={'f1_val': 0.42989279629354876, 'auprc': 0.7438472798344566, 'loss_val': 0.864387918923934, 'psi': 0.5554745897099119}-{'f1_val': 0.37854887021630734, 'auprc': 0.7225747664322817, 'loss_val': 0.9910019542667173, 'psi': 0.516159228702697}
[S17] START round=11 head_norm_before_train=0.916211 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.001436 metrics={'f1_val': 0.335001934610176, 'auprc': 0.5945236710232462, 'loss_val': 0.9934631531442106, 'psi': 0.43881062917540414}-{'f1_val': 0.34343388942939257, 'auprc': 0.578354269502054, 'loss_val': 0.9984190218922123, 'psi': 0.4374020414584572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:51908
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:51905
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S13
[S5] cosine check vs S13: cos=0.9260
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=0.8061
[S6] RECEIVED delta(kind=head bytes=1793) from S10
[S6] cosine check vs S10: cos=0.9923
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] cosine check vs S2: cos=0.5310
[S9] RECEIVED delta(kind=head bytes=1806) from S3
[S9] cosine check vs S3: cos=-0.0457
[S9] DROPPED delta from S3 (cos=-0.0457 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] cosine check vs S14: cos=0.9820
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:51908
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S11] → sending delta(kind=head bytes=1787) to S13@127.0.0.1:51913
[S16] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:51902
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=-0.0295
[S7] DROPPED delta from S16 (cos=-0.0295 < 0.0)
[S9] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1787 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S9
[S2] cosine check vs S9: cos=0.9899
[S13] RECEIVED delta(kind=head bytes=1787) from S11
[S13] cosine check vs S11: cos=0.8985
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] cosine check vs S4: cos=0.9700
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:51916
[S17] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S17
[S16] cosine check vs S17: cos=0.7091
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.4172 head_norm=0.696143
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.856439e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.4172 head_norm=0.786835 delta_norm=0.185644
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.6212 head_norm=1.508947
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.748492e-02
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.6280 head_norm=1.528765 delta_norm=0.097485
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.3986 head_norm=1.144341
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.162268e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.3992 head_norm=1.171179 delta_norm=0.116227
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7012 head_norm=1.236722
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.310330e-02
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.7012 head_norm=1.258631 delta_norm=0.093103
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.7113 head_norm=0.906935
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.629588e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.7109 head_norm=1.006569 delta_norm=0.262959
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7019 head_norm=1.158501
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.122086e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7021 head_norm=1.409381 delta_norm=0.312209
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4299 head_norm=0.934283
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.604640e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.4217 head_norm=0.873412 delta_norm=0.360464
[S16] aggregate: ROLLBACK (f1_val pre=0.430 post=0.422 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3350 head_norm=0.955343
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.204566e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3360 head_norm=0.946559 delta_norm=0.120457
[S17] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.258631 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.089979 metrics={'f1_val': 0.7013698608266565, 'auprc': 0.7763101395962348, 'loss_val': 0.6560144249310395, 'psi': 0.731345972334488}-{'f1_val': 0.7011893795727207, 'auprc': 0.7750788081602269, 'loss_val': 0.8311958147044931, 'psi': 0.7307451510077232}
[S3] START round=12 head_norm_before_train=1.473219 (no previous merge yet)
[S3] round=12 local utility u=0.033957 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9986655692078606, 'loss_val': 0.3601134194870799, 'psi': 0.8199652686984307}-{'f1_val': 0.7010863553524592, 'auprc': 0.9986034938649444, 'loss_val': 0.42936924679417576, 'psi': 0.8200932107574533}
[S4] START round=12 head_norm_before_train=1.680933 (no previous merge yet)
[S4] round=12 local utility u=0.880561 metrics={'f1_val': 0.9573523702129623, 'auprc': 0.942633768473145, 'loss_val': 0.5094986777240049, 'psi': 0.9514649295170353}-{'f1_val': 0.6670121421478854, 'auprc': 0.9437287792065754, 'loss_val': 0.5318639896332766, 'psi': 0.7776987969713614}
[S5] START round=12 head_norm_before_train=0.786835 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.065240 metrics={'f1_val': 0.41718547513587745, 'auprc': 0.683690586000683, 'loss_val': 0.8812817442811044, 'psi': 0.5237875194817996}-{'f1_val': 0.41718547513587745, 'auprc': 0.6583478683840253, 'loss_val': 0.9357332261601993, 'psi': 0.5136504324351365}
[S6] START round=12 head_norm_before_train=1.528765 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.087807 metrics={'f1_val': 0.6216591627007259, 'auprc': 0.8156026128634958, 'loss_val': 0.5520588412486532, 'psi': 0.6992365427658338}-{'f1_val': 0.6211919336012239, 'auprc': 0.7856308161625168, 'loss_val': 0.6349541955116427, 'psi': 0.6869674866257411}
[S7] START round=12 head_norm_before_train=1.171179 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.41168637458406443, 'auprc': 0.5128496401514117, 'loss_val': 1.1382092293461465, 'psi': 0.4521516808110033}-{'f1_val': 0.39863383406346986, 'auprc': 0.5567071588415073, 'loss_val': 1.07462585116853, 'psi': 0.46186316397468485}
[S8] START round=12 head_norm_before_train=1.474669 (no previous merge yet)
[S8] round=12 local utility u=0.050141 metrics={'f1_val': 0.7137586021136586, 'auprc': 0.997649642804592, 'loss_val': 0.3368851334399329, 'psi': 0.827315018390032}-{'f1_val': 0.7138229449839267, 'auprc': 0.9949501021938982, 'loss_val': 0.4294554663933619, 'psi': 0.8262738078679154}
[S9] START round=12 head_norm_before_train=1.286919 cos_to_last_merge=0.8801 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.880
[S9] round=12 local utility u=0.014611 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982304394671556, 'loss_val': 0.24673865513633103, 'psi': 0.8200221242508734}-{'f1_val': 0.7012904835408967, 'auprc': 0.9984413452812194, 'loss_val': 0.2770364118353973, 'psi': 0.8201508282370258}
[S10] START round=12 head_norm_before_train=1.554454 (no previous merge yet)
[S10] round=12 local utility u=0.022408 metrics={'f1_val': 0.6998932897468348, 'auprc': 0.9942797675955621, 'loss_val': 0.2623367513539307, 'psi': 0.8176478808863258}-{'f1_val': 0.7000134762741985, 'auprc': 0.9971527732791521, 'loss_val': 0.31649278914613055, 'psi': 0.81886919507618}
[S11] START round=12 head_norm_before_train=1.409381 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.079671 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.9428934267563128, 'loss_val': 0.49199378758839707, 'psi': 0.7983972687694891}-{'f1_val': 0.701890640953942, 'auprc': 0.9484470742664023, 'loss_val': 0.6669409040384642, 'psi': 0.8005132142789262}
[S13] START round=12 head_norm_before_train=1.006569 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6881984880872, 'auprc': 0.6629009609449581, 'loss_val': 0.7978699199481379, 'psi': 0.6780794772303032}-{'f1_val': 0.7113104823159138, 'auprc': 0.6841065431238409, 'loss_val': 0.7943210847466722, 'psi': 0.7004289066390846}
[S14] START round=12 head_norm_before_train=1.208645 cos_to_last_merge=0.8916 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.892
[S14] round=12 local utility u=0.038900 metrics={'f1_val': 0.9918453634793917, 'auprc': 0.9986023917030485, 'loss_val': 0.312800096887952, 'psi': 0.9945481747688545}-{'f1_val': 0.9940252997910746, 'auprc': 0.9981837172366773, 'loss_val': 0.4024244184427468, 'psi': 0.9956886667693157}
[S15] START round=12 head_norm_before_train=1.373353 cos_to_last_merge=0.9977 (last merge round=10)
[S15] round=12 local utility u=0.511005 metrics={'f1_val': 0.6958205651339209, 'auprc': 0.9673117487227256, 'loss_val': 0.44295449171664025, 'psi': 0.8044170385694427}-{'f1_val': 0.6986592290218648, 'auprc': 0.659102673748393, 'loss_val': 0.5573697405250324, 'psi': 0.682836606912476}
[S16] START round=12 head_norm_before_train=0.873412 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.4261323218432632, 'auprc': 0.7526568189536299, 'loss_val': 0.8736971483798796, 'psi': 0.5567421206874099}-{'f1_val': 0.42989279629354876, 'auprc': 0.7438472798344566, 'loss_val': 0.864387918923934, 'psi': 0.5554745897099119}
[S17] START round=12 head_norm_before_train=0.946559 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.3349386850367591, 'auprc': 0.5943574789952899, 'loss_val': 0.9959557390418843, 'psi': 0.43870620262017146}-{'f1_val': 0.335001934610176, 'auprc': 0.5945236710232462, 'loss_val': 0.9934631531442106, 'psi': 0.43881062917540414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:51912
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S9] → sending delta(kind=head bytes=1809) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:51913
[S8] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1809 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S3
[S9] cosine check vs S3: cos=-0.0385
[S9] DROPPED delta from S3 (cos=-0.0385 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.9893
[S15] RECEIVED delta(kind=head bytes=1799) from S6
[S15] cosine check vs S6: cos=0.9736
[S2] RECEIVED delta(kind=head bytes=1809) from S9
[S2] cosine check vs S9: cos=0.9911
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=0.0473
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=0.9389
[S6] RECEIVED delta(kind=head bytes=1800) from S10
[S6] cosine check vs S10: cos=0.9930
[S17] RECEIVED delta(kind=head bytes=1804) from S2
[S17] cosine check vs S2: cos=0.5773
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.7779
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.9881
[S11] RECEIVED delta(kind=head bytes=1793) from S5
[S11] cosine check vs S5: cos=0.8185
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4117 head_norm=1.193781
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.957923e-02
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.4127 head_norm=1.221574 delta_norm=0.099579
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6958 head_norm=1.413433
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.861955e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6955 head_norm=1.477724 delta_norm=0.186195
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.4172 head_norm=0.825289
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.013268e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.3174 head_norm=0.835059 delta_norm=0.801327
[S5] aggregate: ROLLBACK (f1_val pre=0.417 post=0.317 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.6217 head_norm=1.561692
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.491086e-02
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.6569 head_norm=1.575722 delta_norm=0.094911
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7014 head_norm=1.301494
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.870965e-02
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7014 head_norm=1.311151 delta_norm=0.088710
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7021 head_norm=1.449238
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.680015e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7021 head_norm=1.319402 delta_norm=0.168002
[S11] aggregate: ACCEPT kept=['S4', 'S5'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.6882 head_norm=1.040681
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.963188e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.7099 head_norm=1.226315 delta_norm=0.296319
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3349 head_norm=0.982864
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.078279e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3352 head_norm=0.978151 delta_norm=0.107828
[S17] aggregate: ACCEPT kept=['S2', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.311151 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7001067232112512, 'auprc': 0.664919957998004, 'loss_val': 0.5261913858435651, 'psi': 0.6860320171259524}-{'f1_val': 0.7013698608266565, 'auprc': 0.7763101395962348, 'loss_val': 0.6560144249310395, 'psi': 0.731345972334488}
[S3] START round=13 head_norm_before_train=1.513730 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.6658418468966302, 'auprc': 0.9990347751131503, 'loss_val': 0.4095188679009113, 'psi': 0.7991190181832382}-{'f1_val': 0.7008317350254774, 'auprc': 0.9986655692078606, 'loss_val': 0.3601134194870799, 'psi': 0.8199652686984307}
[S4] START round=13 head_norm_before_train=1.706145 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.8659368608481957, 'auprc': 0.9249909285680764, 'loss_val': 0.49017895383284227, 'psi': 0.889558487936148}-{'f1_val': 0.9573523702129623, 'auprc': 0.942633768473145, 'loss_val': 0.5094986777240049, 'psi': 0.9514649295170353}
[S5] START round=13 head_norm_before_train=0.835059 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.047616 metrics={'f1_val': 0.3740996777327228, 'auprc': 0.8444467381497991, 'loss_val': 1.0098043136848012, 'psi': 0.5622385018995533}-{'f1_val': 0.41718547513587745, 'auprc': 0.683690586000683, 'loss_val': 0.8812817442811044, 'psi': 0.5237875194817996}
[S6] START round=13 head_norm_before_train=1.575722 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.6203975333601128, 'auprc': 0.8110830562496094, 'loss_val': 0.5524186925190493, 'psi': 0.6966717425159115}-{'f1_val': 0.6216591627007259, 'auprc': 0.8156026128634958, 'loss_val': 0.5520588412486532, 'psi': 0.6992365427658338}
[S7] START round=13 head_norm_before_train=1.221574 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.965546 metrics={'f1_val': 0.5795261899307409, 'auprc': 0.7225254971322287, 'loss_val': 0.8431838464166318, 'psi': 0.6367259128113361}-{'f1_val': 0.41168637458406443, 'auprc': 0.5128496401514117, 'loss_val': 1.1382092293461465, 'psi': 0.4521516808110033}
[S8] START round=13 head_norm_before_train=1.506385 (no previous merge yet)
[S8] round=13 local utility u=0.561352 metrics={'f1_val': 0.8907608597925079, 'auprc': 0.997644831590913, 'loss_val': 0.27617986132896927, 'psi': 0.9335144485118699}-{'f1_val': 0.7137586021136586, 'auprc': 0.997649642804592, 'loss_val': 0.3368851334399329, 'psi': 0.827315018390032}
[S9] START round=13 head_norm_before_train=1.326682 cos_to_last_merge=0.8687 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.869
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.6138797205695524, 'auprc': 0.9054215012849058, 'loss_val': 0.3875338987519211, 'psi': 0.7304964328556938}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982304394671556, 'loss_val': 0.24673865513633103, 'psi': 0.8200221242508734}
[S10] START round=13 head_norm_before_train=1.595285 (no previous merge yet)
[S10] round=13 local utility u=0.767940 metrics={'f1_val': 0.9483101069042776, 'auprc': 0.99114389023494, 'loss_val': 0.20754942025487078, 'psi': 0.9654436202365426}-{'f1_val': 0.6998932897468348, 'auprc': 0.9942797675955621, 'loss_val': 0.2623367513539307, 'psi': 0.8176478808863258}
[S11] START round=13 head_norm_before_train=1.319402 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.062771 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9624142020883633, 'loss_val': 0.42316956561328445, 'psi': 0.8060210438322242}-{'f1_val': 0.7020664967782734, 'auprc': 0.9428934267563128, 'loss_val': 0.49199378758839707, 'psi': 0.7983972687694891}
[S13] START round=13 head_norm_before_train=1.226315 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6283728469751095, 'auprc': 0.7022568432747072, 'loss_val': 0.7903493949223503, 'psi': 0.6579264454949485}-{'f1_val': 0.6881984880872, 'auprc': 0.6629009609449581, 'loss_val': 0.7978699199481379, 'psi': 0.6780794772303032}
[S14] START round=13 head_norm_before_train=1.256665 cos_to_last_merge=0.8795 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.879
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.9807651384774921, 'auprc': 0.9988201544168516, 'loss_val': 0.2572939231505081, 'psi': 0.987987144853236}-{'f1_val': 0.9918453634793917, 'auprc': 0.9986023917030485, 'loss_val': 0.312800096887952, 'psi': 0.9945481747688545}
[S15] START round=13 head_norm_before_train=1.477724 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.049626 metrics={'f1_val': 0.6979167364263772, 'auprc': 0.9818056413380573, 'loss_val': 0.3997621907969682, 'psi': 0.8114722983910492}-{'f1_val': 0.6958205651339209, 'auprc': 0.9673117487227256, 'loss_val': 0.44295449171664025, 'psi': 0.8044170385694427}
[S16] START round=13 head_norm_before_train=0.921233 cos_to_last_merge=0.9968 (last merge round=11)
[S16] round=13 local utility u=0.120920 metrics={'f1_val': 0.4456358901129088, 'auprc': 0.7718770633270503, 'loss_val': 0.8065386093116259, 'psi': 0.5761323593985654}-{'f1_val': 0.4261323218432632, 'auprc': 0.7526568189536299, 'loss_val': 0.8736971483798796, 'psi': 0.5567421206874099}
[S17] START round=13 head_norm_before_train=0.978151 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.021907 metrics={'f1_val': 0.3423079590696736, 'auprc': 0.5962212303836752, 'loss_val': 1.0019481162098385, 'psi': 0.44387326759527423}-{'f1_val': 0.3349386850367591, 'auprc': 0.5943574789952899, 'loss_val': 0.9959557390418843, 'psi': 0.43870620262017146}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:51905
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:51915
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:51917
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:51908
[S8] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S15
[S5] cosine check vs S15: cos=0.8291
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=-0.0248
[S7] DROPPED delta from S16 (cos=-0.0248 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S5
[S15] cosine check vs S5: cos=0.8291
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] cosine check vs S11: cos=0.9892
[S6] RECEIVED delta(kind=head bytes=1801) from S10
[S6] cosine check vs S10: cos=0.9945
[S17] RECEIVED delta(kind=head bytes=1800) from S7
[S17] cosine check vs S7: cos=-0.0031
[S17] DROPPED delta from S7 (cos=-0.0031 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.7618
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:51916
[S17] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S17
[S16] cosine check vs S17: cos=0.8555
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.6204 head_norm=1.609263
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.574828e-02
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.6216 head_norm=1.617327 delta_norm=0.085748
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.6284 head_norm=1.249567
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.095954e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.6326 head_norm=1.299787 delta_norm=0.109595
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6979 head_norm=1.516366
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.693097e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6980 head_norm=1.137713 delta_norm=0.469310
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.3741 head_norm=0.854353
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.693097e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.3174 head_norm=1.137713 delta_norm=0.469310
[S5] aggregate: ROLLBACK (f1_val pre=0.374 post=0.317 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.4456 head_norm=0.976629
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.677002e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.4493 head_norm=0.957461 delta_norm=0.267700
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3423 head_norm=1.011428
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.033412e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3340 head_norm=1.198231 delta_norm=0.503341
[S17] aggregate: ROLLBACK (f1_val pre=0.342 post=0.334 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.361161 cos_to_last_merge=0.9984 (last merge round=12)
[S2] round=14 local utility u=0.070256 metrics={'f1_val': 0.7012120585667497, 'auprc': 0.6662423766253649, 'loss_val': 0.39627830677716797, 'psi': 0.6872241857901957}-{'f1_val': 0.7001067232112512, 'auprc': 0.664919957998004, 'loss_val': 0.5261913858435651, 'psi': 0.6860320171259524}
[S3] START round=14 head_norm_before_train=1.549315 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.5914148550297247, 'auprc': 0.9921986391647932, 'loss_val': 0.4970549614456368, 'psi': 0.7517283686837521}-{'f1_val': 0.6658418468966302, 'auprc': 0.9990347751131503, 'loss_val': 0.4095188679009113, 'psi': 0.7991190181832382}
[S4] START round=14 head_norm_before_train=1.726534 (no previous merge yet)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.6264974366399119, 'auprc': 0.9434727475482516, 'loss_val': 0.5180052795390324, 'psi': 0.7532875610032478}-{'f1_val': 0.8659368608481957, 'auprc': 0.9249909285680764, 'loss_val': 0.49017895383284227, 'psi': 0.889558487936148}
[S5] START round=14 head_norm_before_train=1.137713 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.190257 metrics={'f1_val': 0.37393786825828995, 'auprc': 0.9846845915044974, 'loss_val': 1.049033269761707, 'psi': 0.618236557556773}-{'f1_val': 0.3740996777327228, 'auprc': 0.8444467381497991, 'loss_val': 1.0098043136848012, 'psi': 0.5622385018995533}
[S6] START round=14 head_norm_before_train=1.617327 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.444747 metrics={'f1_val': 0.7320595792672057, 'auprc': 0.8450451215241173, 'loss_val': 0.43478368528036887, 'psi': 0.7772537961699704}-{'f1_val': 0.6203975333601128, 'auprc': 0.8110830562496094, 'loss_val': 0.5524186925190493, 'psi': 0.6966717425159115}
[S7] START round=14 head_norm_before_train=1.240993 cos_to_last_merge=0.9993 (last merge round=12)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.4799946853432483, 'auprc': 0.6762864492984887, 'loss_val': 1.016551362400206, 'psi': 0.5585113909253444}-{'f1_val': 0.5795261899307409, 'auprc': 0.7225254971322287, 'loss_val': 0.8431838464166318, 'psi': 0.6367259128113361}
[S8] START round=14 head_norm_before_train=1.534678 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7602843492344957, 'auprc': 0.9978156078983865, 'loss_val': 0.2200660066359887, 'psi': 0.8552968527000521}-{'f1_val': 0.8907608597925079, 'auprc': 0.997644831590913, 'loss_val': 0.27617986132896927, 'psi': 0.9335144485118699}
[S9] START round=14 head_norm_before_train=1.364192 cos_to_last_merge=0.8595 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.859
[S9] round=14 local utility u=1.000000 metrics={'f1_val': 0.9890975148541, 'auprc': 0.9982136532001044, 'loss_val': 0.14793239851978696, 'psi': 0.9927439701925018}-{'f1_val': 0.6138797205695524, 'auprc': 0.9054215012849058, 'loss_val': 0.3875338987519211, 'psi': 0.7304964328556938}
[S10] START round=14 head_norm_before_train=1.629870 (no previous merge yet)
[S10] round=14 local utility u=0.031623 metrics={'f1_val': 0.9558557964810999, 'auprc': 0.9941009625485389, 'loss_val': 0.1984484364213984, 'psi': 0.9711538629080755}-{'f1_val': 0.9483101069042776, 'auprc': 0.99114389023494, 'loss_val': 0.20754942025487078, 'psi': 0.9654436202365426}
[S11] START round=14 head_norm_before_train=1.357018 cos_to_last_merge=0.9987 (last merge round=12)
[S11] round=14 local utility u=0.075217 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9917781805265906, 'loss_val': 0.3604342954044097, 'psi': 0.8177273599627912}-{'f1_val': 0.7017589383281313, 'auprc': 0.9624142020883633, 'loss_val': 0.42316956561328445, 'psi': 0.8060210438322242}
[S13] START round=14 head_norm_before_train=1.299787 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.024847 metrics={'f1_val': 0.6152352086801499, 'auprc': 0.7322048679490876, 'loss_val': 0.7516744522986354, 'psi': 0.662023072387725}-{'f1_val': 0.6283728469751095, 'auprc': 0.7022568432747072, 'loss_val': 0.7903493949223503, 'psi': 0.6579264454949485}
[S14] START round=14 head_norm_before_train=1.304720 cos_to_last_merge=0.8688 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.869
[S14] round=14 local utility u=0.050934 metrics={'f1_val': 0.9898122932714338, 'auprc': 0.9984190397194965, 'loss_val': 0.2085045517520817, 'psi': 0.9932549918506588}-{'f1_val': 0.9807651384774921, 'auprc': 0.9988201544168516, 'loss_val': 0.2572939231505081, 'psi': 0.987987144853236}
[S15] START round=14 head_norm_before_train=1.137713 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6900657301881792, 'auprc': 0.97982412370849, 'loss_val': 0.3801078726514156, 'psi': 0.8059690875963035}-{'f1_val': 0.6979167364263772, 'auprc': 0.9818056413380573, 'loss_val': 0.3997621907969682, 'psi': 0.8114722983910492}
[S16] START round=14 head_norm_before_train=0.957461 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.382807 metrics={'f1_val': 0.5561116162353759, 'auprc': 0.8176696657241238, 'loss_val': 0.8411568112883667, 'psi': 0.6607348360308751}-{'f1_val': 0.4456358901129088, 'auprc': 0.7718770633270503, 'loss_val': 0.8065386093116259, 'psi': 0.5761323593985654}
[S17] START round=14 head_norm_before_train=1.198231 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.037952 metrics={'f1_val': 0.3340316429295036, 'auprc': 0.6558161721404163, 'loss_val': 1.0551712761018583, 'psi': 0.46274545461386873}-{'f1_val': 0.3423079590696736, 'auprc': 0.5962212303836752, 'loss_val': 1.0019481162098385, 'psi': 0.44387326759527423}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:51904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:51915
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:51903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:51911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:51910
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:51912
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:51909
[S9] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S2
[S9] cosine check vs S2: cos=0.9839
[S17] RECEIVED delta(kind=head bytes=1795) from S16
[S17] cosine check vs S16: cos=0.9127
[S15] RECEIVED delta(kind=head bytes=1792) from S5
[S15] cosine check vs S5: cos=0.9957
[S10] RECEIVED delta(kind=head bytes=1803) from S6
[S10] cosine check vs S6: cos=0.9960
[S4] RECEIVED delta(kind=head bytes=1802) from S11
[S4] cosine check vs S11: cos=0.9742
[S11] RECEIVED delta(kind=head bytes=1800) from S13
[S11] cosine check vs S13: cos=0.9911
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] cosine check vs S9: cos=-0.0290
[S3] DROPPED delta from S9 (cos=-0.0290 < 0.0)
[S17] sending update (kind=head size=1790 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1790) from S17
[S8] cosine check vs S17: cos=0.9535
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.6265 head_norm=1.738895
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.471408e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9458 head_norm=1.556250 delta_norm=0.247141
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.7603 head_norm=1.569674
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.729428e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.7142 head_norm=1.380840 delta_norm=0.272943
[S8] aggregate: ROLLBACK (f1_val pre=0.760 post=0.714 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.9559 head_norm=1.659131
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.413176e-02
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.9017 head_norm=1.652625 delta_norm=0.074132
[S10] aggregate: ROLLBACK (f1_val pre=0.956 post=0.902 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6901 head_norm=1.183011
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.776029e-02
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6900 head_norm=1.161656 delta_norm=0.057760
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.9891 head_norm=1.399143
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.262295e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7012 head_norm=1.400716 delta_norm=0.126229
[S9] aggregate: ROLLBACK (f1_val pre=0.989 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7017 head_norm=1.393639
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.691051e-02
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7019 head_norm=1.355821 delta_norm=0.096911
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3340 head_norm=1.224157
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.561846e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3341 head_norm=1.091082 delta_norm=0.256185
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.413604 cos_to_last_merge=0.9944 (last merge round=12)
[S2] round=15 local utility u=0.022796 metrics={'f1_val': 0.7013925629565125, 'auprc': 0.6622827634579258, 'loss_val': 0.3398898210285687, 'psi': 0.6857486431570778}-{'f1_val': 0.7012120585667497, 'auprc': 0.6662423766253649, 'loss_val': 0.39627830677716797, 'psi': 0.6872241857901957}
[S3] START round=15 head_norm_before_train=1.579858 (no previous merge yet)
[S3] round=15 local utility u=0.441326 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9966879202063843, 'loss_val': 0.2843721064149213, 'psi': 0.8191742090978402}-{'f1_val': 0.5914148550297247, 'auprc': 0.9921986391647932, 'loss_val': 0.4970549614456368, 'psi': 0.7517283686837521}
[S4] START round=15 head_norm_before_train=1.556250 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.955551 metrics={'f1_val': 0.9425581474369867, 'auprc': 0.9446204093539324, 'loss_val': 0.5067104628373704, 'psi': 0.943383052203765}-{'f1_val': 0.6264974366399119, 'auprc': 0.9434727475482516, 'loss_val': 0.5180052795390324, 'psi': 0.7532875610032478}
[S5] START round=15 head_norm_before_train=1.142823 cos_to_last_merge=0.9967 (last merge round=13)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.41698423964269166, 'auprc': 0.8298270214570094, 'loss_val': 0.8982315980646242, 'psi': 0.5821213523684188}-{'f1_val': 0.37393786825828995, 'auprc': 0.9846845915044974, 'loss_val': 1.049033269761707, 'psi': 0.618236557556773}
[S6] START round=15 head_norm_before_train=1.649429 cos_to_last_merge=0.9995 (last merge round=13)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.5751762793164643, 'auprc': 0.7881067535922348, 'loss_val': 0.675489158418144, 'psi': 0.6603484690267725}-{'f1_val': 0.7320595792672057, 'auprc': 0.8450451215241173, 'loss_val': 0.43478368528036887, 'psi': 0.7772537961699704}
[S7] START round=15 head_norm_before_train=1.258837 cos_to_last_merge=0.9977 (last merge round=12)
[S7] round=15 local utility u=0.342557 metrics={'f1_val': 0.5488475595381601, 'auprc': 0.733199245456251, 'loss_val': 0.9152920850990496, 'psi': 0.6225882339053965}-{'f1_val': 0.4799946853432483, 'auprc': 0.6762864492984887, 'loss_val': 1.016551362400206, 'psi': 0.5585113909253444}
[S8] START round=15 head_norm_before_train=1.380840 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.723027 metrics={'f1_val': 0.9967904835007894, 'auprc': 0.9994752121436926, 'loss_val': 0.19802715603606746, 'psi': 0.9978643749579508}-{'f1_val': 0.7602843492344957, 'auprc': 0.9978156078983865, 'loss_val': 0.2200660066359887, 'psi': 0.8552968527000521}
[S9] START round=15 head_norm_before_train=1.400716 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.9852543644376418, 'auprc': 0.9982035450899178, 'loss_val': 0.14226061898867243, 'psi': 0.9904340366985522}-{'f1_val': 0.9890975148541, 'auprc': 0.9982136532001044, 'loss_val': 0.14793239851978696, 'psi': 0.9927439701925018}
[S10] START round=15 head_norm_before_train=1.652625 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.7848708948694906, 'auprc': 0.9977822385977424, 'loss_val': 0.19219178655588307, 'psi': 0.8700354323607913}-{'f1_val': 0.9558557964810999, 'auprc': 0.9941009625485389, 'loss_val': 0.1984484364213984, 'psi': 0.9711538629080755}
[S11] START round=15 head_norm_before_train=1.355821 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.020119 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9966840665666692, 'loss_val': 0.3363651134112827, 'psi': 0.8198348166056597}-{'f1_val': 0.7016934795869249, 'auprc': 0.9917781805265906, 'loss_val': 0.3604342954044097, 'psi': 0.8177273599627912}
[S13] START round=15 head_norm_before_train=1.324029 cos_to_last_merge=0.9983 (last merge round=13)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5852477325072285, 'auprc': 0.7581100998858055, 'loss_val': 0.7577804513085733, 'psi': 0.6543926794586593}-{'f1_val': 0.6152352086801499, 'auprc': 0.7322048679490876, 'loss_val': 0.7516744522986354, 'psi': 0.662023072387725}
[S14] START round=15 head_norm_before_train=1.349964 cos_to_last_merge=0.8596 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.860
[S14] round=15 local utility u=0.013357 metrics={'f1_val': 0.9917429507816165, 'auprc': 0.9971144531500076, 'loss_val': 0.18946044590125788, 'psi': 0.9938915517289729}-{'f1_val': 0.9898122932714338, 'auprc': 0.9984190397194965, 'loss_val': 0.2085045517520817, 'psi': 0.9932549918506588}
[S15] START round=15 head_norm_before_train=1.161656 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.010213 metrics={'f1_val': 0.6956446265572926, 'auprc': 0.980362884690892, 'loss_val': 0.3947715238584872, 'psi': 0.8095319298107324}-{'f1_val': 0.6900657301881792, 'auprc': 0.97982412370849, 'loss_val': 0.3801078726514156, 'psi': 0.8059690875963035}
[S16] START round=15 head_norm_before_train=1.006787 cos_to_last_merge=0.9972 (last merge round=13)
[S16] round=15 local utility u=0.112016 metrics={'f1_val': 0.5362881888048601, 'auprc': 0.8668232845556809, 'loss_val': 0.645645072554188, 'psi': 0.6685022271051884}-{'f1_val': 0.5561116162353759, 'auprc': 0.8176696657241238, 'loss_val': 0.8411568112883667, 'psi': 0.6607348360308751}
[S17] START round=15 head_norm_before_train=1.091082 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.050842 metrics={'f1_val': 0.3380564041648251, 'auprc': 0.6735326203443502, 'loss_val': 1.030785133987567, 'psi': 0.47224689063663516}-{'f1_val': 0.3340316429295036, 'auprc': 0.6558161721404163, 'loss_val': 1.0551712761018583, 'psi': 0.46274545461386873}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:51904
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:51914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:51917
[S15] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S2
[S9] cosine check vs S2: cos=0.9911
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] cosine check vs S11: cos=0.9853
[S6] RECEIVED delta(kind=head bytes=1793) from S15
[S6] cosine check vs S15: cos=0.9336
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.9800
[S17] RECEIVED delta(kind=head bytes=1792) from S16
[S17] cosine check vs S16: cos=0.9662
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:51909
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.9325
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9968 head_norm=1.415475
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.749701e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9938 head_norm=1.245065 delta_norm=0.274970
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9426 head_norm=1.570237
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.561467e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9471 head_norm=1.473341 delta_norm=0.156147
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.128 → S15@127.0.0.1:51915
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.5752 head_norm=1.681267
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.510430e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.6085 head_norm=1.421588 delta_norm=0.351043
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.231 → S10@127.0.0.1:51911
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9853 head_norm=1.430839
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.779126e-02
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7923 head_norm=1.442363 delta_norm=0.097791
[S9] aggregate: ROLLBACK (f1_val pre=0.985 post=0.792 tol_abs=0.005 tol_rel=0.0)
[S9] ⇄ pheromone p=0.262 → S3@127.0.0.1:51903
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9917 head_norm=1.390644
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.450199e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9925 head_norm=1.326263 delta_norm=0.145020
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.131 → S11@127.0.0.1:51912
[S11] ⇄ pheromone p=0.198 → S4@127.0.0.1:51904
[S2] ⇄ pheromone p=0.202 → S9@127.0.0.1:51910
[S15] ⇄ pheromone p=0.192 → S6@127.0.0.1:51907
[S16] ⇄ pheromone p=0.200 → S17@127.0.0.1:51917
[S7] ⇄ pheromone p=0.286 → S14@127.0.0.1:51914
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3381 head_norm=1.117149
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.441707e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3397 head_norm=1.080124 delta_norm=0.144171
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.091 → S8@127.0.0.1:51909
[S2] START round=16 head_norm_before_train=1.460359 cos_to_last_merge=0.9897 (last merge round=12)
[S2] round=16 local utility u=0.010621 metrics={'f1_val': 0.7013925629565125, 'auprc': 0.6617460240061024, 'loss_val': 0.3170366081893927, 'psi': 0.6855339473763484}-{'f1_val': 0.7013925629565125, 'auprc': 0.6622827634579258, 'loss_val': 0.3398898210285687, 'psi': 0.6857486431570778}
[S3] START round=16 head_norm_before_train=1.608493 (no previous merge yet)
[S3] round=16 local utility u=0.005280 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9954884137364379, 'loss_val': 0.2702140058730949, 'psi': 0.8186944065098616}-{'f1_val': 0.7008317350254774, 'auprc': 0.9966879202063843, 'loss_val': 0.2843721064149213, 'psi': 0.8191742090978402}
[S4] START round=16 head_norm_before_train=1.473341 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.036739 metrics={'f1_val': 0.9542835408394066, 'auprc': 0.9273478853477409, 'loss_val': 0.45176700242563017, 'psi': 0.9435092786427404}-{'f1_val': 0.9425581474369867, 'auprc': 0.9446204093539324, 'loss_val': 0.5067104628373704, 'psi': 0.943383052203765}
[S5] START round=16 head_norm_before_train=1.157066 cos_to_last_merge=0.9867 (last merge round=13)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.41698423964269166, 'auprc': 0.6697761673957405, 'loss_val': 0.8515168163731857, 'psi': 0.5181010107439112}-{'f1_val': 0.41698423964269166, 'auprc': 0.8298270214570094, 'loss_val': 0.8982315980646242, 'psi': 0.5821213523684188}
[S6] START round=16 head_norm_before_train=1.421588 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=1.000000 metrics={'f1_val': 0.9610798423095663, 'auprc': 0.9746327823533006, 'loss_val': 0.30673143073904713, 'psi': 0.96650101832706}-{'f1_val': 0.5751762793164643, 'auprc': 0.7881067535922348, 'loss_val': 0.675489158418144, 'psi': 0.6603484690267725}
[S7] START round=16 head_norm_before_train=1.275192 cos_to_last_merge=0.9957 (last merge round=12)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.45448532821159776, 'auprc': 0.7213002339649454, 'loss_val': 1.0182006083652217, 'psi': 0.5612112905129367}-{'f1_val': 0.5488475595381601, 'auprc': 0.733199245456251, 'loss_val': 0.9152920850990496, 'psi': 0.6225882339053965}
[S8] START round=16 head_norm_before_train=1.245065 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7217107345581406, 'auprc': 0.9949463644794501, 'loss_val': 0.23902498478213363, 'psi': 0.8310049865266644}-{'f1_val': 0.9967904835007894, 'auprc': 0.9994752121436926, 'loss_val': 0.19802715603606746, 'psi': 0.9978643749579508}
[S9] START round=16 head_norm_before_train=1.442363 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.018610 metrics={'f1_val': 0.9882473538397808, 'auprc': 0.9981990206613631, 'loss_val': 0.12298461111901132, 'psi': 0.9922280205684137}-{'f1_val': 0.9852543644376418, 'auprc': 0.9982035450899178, 'loss_val': 0.14226061898867243, 'psi': 0.9904340366985522}
[S10] START round=16 head_norm_before_train=1.674122 cos_to_last_merge=0.9998 (last merge round=14)
[S10] round=16 local utility u=0.285435 metrics={'f1_val': 0.8733209017942927, 'auprc': 0.9977734281004513, 'loss_val': 0.1519945330519287, 'psi': 0.9231019123167561}-{'f1_val': 0.7848708948694906, 'auprc': 0.9977822385977424, 'loss_val': 0.19219178655588307, 'psi': 0.8700354323607913}
[S11] START round=16 head_norm_before_train=1.387295 cos_to_last_merge=0.9995 (last merge round=14)
[S11] round=16 local utility u=0.012421 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9966981907633863, 'loss_val': 0.3101151173077835, 'psi': 0.8196953640575094}-{'f1_val': 0.7019353166316534, 'auprc': 0.9966840665666692, 'loss_val': 0.3363651134112827, 'psi': 0.8198348166056597}
[S13] START round=16 head_norm_before_train=1.352492 cos_to_last_merge=0.9935 (last merge round=13)
[S13] round=16 local utility u=0.295906 metrics={'f1_val': 0.5997753011694026, 'auprc': 0.9030273088352956, 'loss_val': 0.6878855259557977, 'psi': 0.7210761042357599}-{'f1_val': 0.5852477325072285, 'auprc': 0.7581100998858055, 'loss_val': 0.7577804513085733, 'psi': 0.6543926794586593}
[S14] START round=16 head_norm_before_train=1.326263 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.019145 metrics={'f1_val': 0.9959623555822243, 'auprc': 0.9988521489149504, 'loss_val': 0.1817003203029921, 'psi': 0.9971182729153147}-{'f1_val': 0.9917429507816165, 'auprc': 0.9971144531500076, 'loss_val': 0.18946044590125788, 'psi': 0.9938915517289729}
[S15] START round=16 head_norm_before_train=1.208978 cos_to_last_merge=0.9990 (last merge round=14)
[S15] round=16 local utility u=0.015102 metrics={'f1_val': 0.6918841052953955, 'auprc': 0.977062821954159, 'loss_val': 0.3321036345953832, 'psi': 0.805955591958901}-{'f1_val': 0.6956446265572926, 'auprc': 0.980362884690892, 'loss_val': 0.3947715238584872, 'psi': 0.8095319298107324}
[S16] START round=16 head_norm_before_train=1.061549 cos_to_last_merge=0.9906 (last merge round=13)
[S16] round=16 local utility u=0.305075 metrics={'f1_val': 0.6035430006543934, 'auprc': 0.9171433952140876, 'loss_val': 0.5899846118848896, 'psi': 0.7289831584782711}-{'f1_val': 0.5362881888048601, 'auprc': 0.8668232845556809, 'loss_val': 0.645645072554188, 'psi': 0.6685022271051884}
[S17] START round=16 head_norm_before_train=1.080124 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.036166 metrics={'f1_val': 0.34290758436649105, 'auprc': 0.6879530428275591, 'loss_val': 1.0308210337792263, 'psi': 0.48092576775091833}-{'f1_val': 0.3380564041648251, 'auprc': 0.6735326203443502, 'loss_val': 1.030785133987567, 'psi': 0.47224689063663516}
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S14
[S5]  timeout peer S16
[S5]  timeout peer S17
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S16
[S6]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:51903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:51911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:51907
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:51907
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:51912
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:51910
[S6] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S6
[S10] cosine check vs S6: cos=0.9825
[S6] RECEIVED delta(kind=head bytes=1793) from S15
[S6] cosine check vs S15: cos=0.9719
[S11] RECEIVED delta(kind=head bytes=1806) from S13
[S11] cosine check vs S13: cos=0.9830
[S17] RECEIVED delta(kind=head bytes=1795) from S16
[S17] cosine check vs S16: cos=0.9853
[S11] RECEIVED delta(kind=head bytes=1803) from S4
[S11] cosine check vs S4: cos=0.9934
[S9] RECEIVED delta(kind=head bytes=1803) from S2
[S9] cosine check vs S2: cos=0.9941
[S9] RECEIVED delta(kind=head bytes=1805) from S3
[S9] cosine check vs S3: cos=-0.0211
[S9] DROPPED delta from S3 (cos=-0.0211 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1805) from S10
[S6] cosine check vs S10: cos=0.9825
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] cosine check vs S9: cos=-0.0211
[S3] DROPPED delta from S9 (cos=-0.0211 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.8733 head_norm=1.692374
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.903902e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.8595 head_norm=1.563943 delta_norm=0.190390
[S10] aggregate: ROLLBACK (f1_val pre=0.873 post=0.860 tol_abs=0.005 tol_rel=0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:51909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:51904
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.9882 head_norm=1.470245
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.204003e-02
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9870 head_norm=1.483294 delta_norm=0.082040
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.9611 head_norm=1.449208
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.443195e-02
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.9608 head_norm=1.446545 delta_norm=0.054432
[S6] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S17] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=0.9420
[S4] RECEIVED delta(kind=head bytes=1803) from S11
[S4] cosine check vs S11: cos=0.9934
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:51908
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.9909
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7017 head_norm=1.411823
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.182998e-02
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7017 head_norm=1.418374 delta_norm=0.071830
[S11] aggregate: ACCEPT kept=['S13', 'S4'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3429 head_norm=1.104139
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.548801e-02
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3437 head_norm=1.106112 delta_norm=0.095488
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.500721 cos_to_last_merge=0.9851 (last merge round=12)
[S2] round=17 local utility u=0.008218 metrics={'f1_val': 0.7013925629565125, 'auprc': 0.6628786578659176, 'loss_val': 0.30399926244691533, 'psi': 0.6859870009202746}-{'f1_val': 0.7013925629565125, 'auprc': 0.6617460240061024, 'loss_val': 0.3170366081893927, 'psi': 0.6855339473763484}
[S3] START round=17 head_norm_before_train=1.634784 (no previous merge yet)
[S3] round=17 local utility u=0.003116 metrics={'f1_val': 0.7010863553524592, 'auprc': 0.9954894721930918, 'loss_val': 0.26551366806344817, 'psi': 0.8188476020887123}-{'f1_val': 0.7008317350254774, 'auprc': 0.9954884137364379, 'loss_val': 0.2702140058730949, 'psi': 0.8186944065098616}
[S4] START round=17 head_norm_before_train=1.493395 cos_to_last_merge=0.9997 (last merge round=15)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9443006776178703, 'auprc': 0.9424294462244867, 'loss_val': 0.4574347073217042, 'psi': 0.9435521850605169}-{'f1_val': 0.9542835408394066, 'auprc': 0.9273478853477409, 'loss_val': 0.45176700242563017, 'psi': 0.9435092786427404}
[S5] START round=17 head_norm_before_train=1.177720 cos_to_last_merge=0.9758 (last merge round=13)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.41698423964269166, 'auprc': 0.6598548026360412, 'loss_val': 0.8293851231157385, 'psi': 0.5141324648400315}-{'f1_val': 0.41698423964269166, 'auprc': 0.6697761673957405, 'loss_val': 0.8515168163731857, 'psi': 0.5181010107439112}
[S6] START round=17 head_norm_before_train=1.446545 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.46204328321216825, 'auprc': 0.7577894331269821, 'loss_val': 0.7111651525901171, 'psi': 0.5803417431780937}-{'f1_val': 0.9610798423095663, 'auprc': 0.9746327823533006, 'loss_val': 0.30673143073904713, 'psi': 0.96650101832706}
[S7] START round=17 head_norm_before_train=1.287954 cos_to_last_merge=0.9937 (last merge round=12)
[S7] round=17 local utility u=1.000000 metrics={'f1_val': 0.6879596338258849, 'auprc': 0.9120706759627457, 'loss_val': 0.429859438755535, 'psi': 0.7776040506806292}-{'f1_val': 0.45448532821159776, 'auprc': 0.7213002339649454, 'loss_val': 1.0182006083652217, 'psi': 0.5612112905129367}
[S8] START round=17 head_norm_before_train=1.276012 cos_to_last_merge=0.9994 (last merge round=15)
[S8] round=17 local utility u=0.858353 metrics={'f1_val': 0.9958988148339301, 'auprc': 0.9994285105421008, 'loss_val': 0.18089427761870594, 'psi': 0.9973106931171983}-{'f1_val': 0.7217107345581406, 'auprc': 0.9949463644794501, 'loss_val': 0.23902498478213363, 'psi': 0.8310049865266644}
[S9] START round=17 head_norm_before_train=1.483294 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.037242 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9983305460847822, 'loss_val': 0.09437197403729586, 'psi': 0.9968282494524241}-{'f1_val': 0.9882473538397808, 'auprc': 0.9981990206613631, 'loss_val': 0.12298461111901132, 'psi': 0.9922280205684137}
[S10] START round=17 head_norm_before_train=1.563943 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.365629 metrics={'f1_val': 0.9957529764387818, 'auprc': 0.9966637346515673, 'loss_val': 0.1519995309712911, 'psi': 0.996117279723896}-{'f1_val': 0.8733209017942927, 'auprc': 0.9977734281004513, 'loss_val': 0.1519945330519287, 'psi': 0.9231019123167561}
[S11] START round=17 head_norm_before_train=1.418374 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.004809 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.996746085522118, 'loss_val': 0.302484896940236, 'psi': 0.8198988997763864}-{'f1_val': 0.7016934795869249, 'auprc': 0.9966981907633863, 'loss_val': 0.3101151173077835, 'psi': 0.8196953640575094}
[S13] START round=17 head_norm_before_train=1.382668 cos_to_last_merge=0.9871 (last merge round=13)
[S13] round=17 local utility u=0.027148 metrics={'f1_val': 0.6137281872333532, 'auprc': 0.8970468277714899, 'loss_val': 0.699366035502103, 'psi': 0.727055643448608}-{'f1_val': 0.5997753011694026, 'auprc': 0.9030273088352956, 'loss_val': 0.6878855259557977, 'psi': 0.7210761042357599}
[S14] START round=17 head_norm_before_train=1.359151 cos_to_last_merge=0.9997 (last merge round=15)
[S14] round=17 local utility u=0.011722 metrics={'f1_val': 0.9967166623769315, 'auprc': 0.9956918033924682, 'loss_val': 0.15330094033072192, 'psi': 0.9963067187831461}-{'f1_val': 0.9959623555822243, 'auprc': 0.9988521489149504, 'loss_val': 0.1817003203029921, 'psi': 0.9971182729153147}
[S15] START round=17 head_norm_before_train=1.256278 cos_to_last_merge=0.9969 (last merge round=14)
[S15] round=17 local utility u=0.057829 metrics={'f1_val': 0.6997779907284447, 'auprc': 0.9856584666344281, 'loss_val': 0.28959534018855476, 'psi': 0.8141301810908381}-{'f1_val': 0.6918841052953955, 'auprc': 0.977062821954159, 'loss_val': 0.3321036345953832, 'psi': 0.805955591958901}
[S16] START round=17 head_norm_before_train=1.116279 cos_to_last_merge=0.9825 (last merge round=13)
[S16] round=17 local utility u=0.616947 metrics={'f1_val': 0.8438705450207616, 'auprc': 0.8760799906435898, 'loss_val': 0.6748650043375785, 'psi': 0.8567543232698929}-{'f1_val': 0.6035430006543934, 'auprc': 0.9171433952140876, 'loss_val': 0.5899846118848896, 'psi': 0.7289831584782711}
[S17] START round=17 head_norm_before_train=1.106112 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.32130349454828283, 'auprc': 0.7203890135779699, 'loss_val': 1.0468552861284366, 'psi': 0.48093770216015763}-{'f1_val': 0.34290758436649105, 'auprc': 0.6879530428275591, 'loss_val': 1.0308210337792263, 'psi': 0.48092576775091833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:51910
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:51910
[S16] sending update (kind=head size=1795 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9443 head_norm=1.515584
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.085417e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9470 head_norm=1.460595 delta_norm=0.108542
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:51914
[S14] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:51903
[S2] sending update (kind=head size=1804 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=0.9102
[S6] RECEIVED delta(kind=head bytes=1805) from S10
[S6] cosine check vs S10: cos=0.9945
[S11] RECEIVED delta(kind=head bytes=1805) from S13
[S11] cosine check vs S13: cos=0.9823
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] cosine check vs S3: cos=-0.0179
[S9] DROPPED delta from S3 (cos=-0.0179 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1804) from S2
[S9] cosine check vs S2: cos=0.9954
[S17] RECEIVED delta(kind=head bytes=1795) from S16
[S17] cosine check vs S16: cos=0.9922
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.9871
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:51907
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9959 head_norm=1.308805
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.365130e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9968 head_norm=1.187480 delta_norm=0.236513
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:51904
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9871
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=-0.0179
[S3] DROPPED delta from S9 (cos=-0.0179 < 0.0)
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S15
[S6] cosine check vs S15: cos=0.9683
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.4620 head_norm=1.476597
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.256919e-02
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.4617 head_norm=1.448150 delta_norm=0.062569
[S6] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] cosine check vs S11: cos=0.9980
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.6880 head_norm=1.300088
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.094293e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.6874 head_norm=1.332769 delta_norm=0.109429
[S7] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9958 head_norm=1.510030
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.392070e-02
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9946 head_norm=1.520045 delta_norm=0.073921
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.3213 head_norm=1.126740
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.205246e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.4528 head_norm=1.156376 delta_norm=0.120525
[S17] aggregate: ACCEPT kept=['S8', 'S16'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7020 head_norm=1.439002
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.347474e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7020 head_norm=1.418126 delta_norm=0.134747
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.533561 cos_to_last_merge=0.9812 (last merge round=12)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7012900746650139, 'auprc': 0.6576943579882749, 'loss_val': 0.30184282077429975, 'psi': 0.6838517879943182}-{'f1_val': 0.7013925629565125, 'auprc': 0.6628786578659176, 'loss_val': 0.30399926244691533, 'psi': 0.6859870009202746}
[S3] START round=18 head_norm_before_train=1.656351 (no previous merge yet)
[S3] round=18 local utility u=0.006400 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9967345760087827, 'loss_val': 0.2544675947775098, 'psi': 0.8191475526446929}-{'f1_val': 0.7010863553524592, 'auprc': 0.9954894721930918, 'loss_val': 0.26551366806344817, 'psi': 0.8188476020887123}
[S4] START round=18 head_norm_before_train=1.460595 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9467927005242548, 'auprc': 0.925946490240096, 'loss_val': 0.4634981272624399, 'psi': 0.9384542164105912}-{'f1_val': 0.9443006776178703, 'auprc': 0.9424294462244867, 'loss_val': 0.4574347073217042, 'psi': 0.9435521850605169}
[S5] START round=18 head_norm_before_train=1.197602 cos_to_last_merge=0.9671 (last merge round=13)
[S5] round=18 local utility u=0.027329 metrics={'f1_val': 0.41698423964269166, 'auprc': 0.6740181804214819, 'loss_val': 0.8172168714378718, 'psi': 0.5197978159542078}-{'f1_val': 0.41698423964269166, 'auprc': 0.6598548026360412, 'loss_val': 0.8293851231157385, 'psi': 0.5141324648400315}
[S6] START round=18 head_norm_before_train=1.448150 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=1.000000 metrics={'f1_val': 0.9518094530865836, 'auprc': 0.965040072772511, 'loss_val': 0.3240517027092159, 'psi': 0.9571017009609546}-{'f1_val': 0.46204328321216825, 'auprc': 0.7577894331269821, 'loss_val': 0.7111651525901171, 'psi': 0.5803417431780937}
[S7] START round=18 head_norm_before_train=1.332769 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.45764598701644604, 'auprc': 0.7236603557056204, 'loss_val': 1.0225433782080275, 'psi': 0.5640517344921158}-{'f1_val': 0.6879596338258849, 'auprc': 0.9120706759627457, 'loss_val': 0.429859438755535, 'psi': 0.7776040506806292}
[S8] START round=18 head_norm_before_train=1.187480 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.7471920089119103, 'auprc': 0.9972049993183026, 'loss_val': 0.23924246286323503, 'psi': 0.8471972050744672}-{'f1_val': 0.9958988148339301, 'auprc': 0.9994285105421008, 'loss_val': 0.18089427761870594, 'psi': 0.9973106931171983}
[S9] START round=18 head_norm_before_train=1.520045 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.006478 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9982746521735651, 'loss_val': 0.07875332424667393, 'psi': 0.996556353622563}-{'f1_val': 0.9958267183641853, 'auprc': 0.9983305460847822, 'loss_val': 0.09437197403729586, 'psi': 0.9968282494524241}
[S10] START round=18 head_norm_before_train=1.585411 cos_to_last_merge=0.9996 (last merge round=16)
[S10] round=18 local utility u=0.017708 metrics={'f1_val': 0.9954430117283648, 'auprc': 0.9971608175918754, 'loss_val': 0.11621588920637005, 'psi': 0.9961301340737689}-{'f1_val': 0.9957529764387818, 'auprc': 0.9966637346515673, 'loss_val': 0.1519995309712911, 'psi': 0.996117279723896}
[S11] START round=18 head_norm_before_train=1.418126 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.010265 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9967233421587279, 'loss_val': 0.2800425600719861, 'psi': 0.8197054246156461}-{'f1_val': 0.7020007759458987, 'auprc': 0.996746085522118, 'loss_val': 0.302484896940236, 'psi': 0.8198988997763864}
[S13] START round=18 head_norm_before_train=1.409875 cos_to_last_merge=0.9811 (last merge round=13)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6054449604810324, 'auprc': 0.8087929955717232, 'loss_val': 0.7164639489858494, 'psi': 0.6867841745173087}-{'f1_val': 0.6137281872333532, 'auprc': 0.8970468277714899, 'loss_val': 0.699366035502103, 'psi': 0.727055643448608}
[S14] START round=18 head_norm_before_train=1.387810 cos_to_last_merge=0.9991 (last merge round=15)
[S14] round=18 local utility u=0.016455 metrics={'f1_val': 0.9975054147531532, 'auprc': 0.9971579337074867, 'loss_val': 0.12952204937658476, 'psi': 0.9973664223348866}-{'f1_val': 0.9967166623769315, 'auprc': 0.9956918033924682, 'loss_val': 0.15330094033072192, 'psi': 0.9963067187831461}
[S15] START round=18 head_norm_before_train=1.299691 cos_to_last_merge=0.9943 (last merge round=14)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.697239082889915, 'auprc': 0.9231341336219614, 'loss_val': 0.4027182601434976, 'psi': 0.7875971031827336}-{'f1_val': 0.6997779907284447, 'auprc': 0.9856584666344281, 'loss_val': 0.28959534018855476, 'psi': 0.8141301810908381}
[S16] START round=18 head_norm_before_train=1.165608 cos_to_last_merge=0.9744 (last merge round=13)
[S16] round=18 local utility u=0.498734 metrics={'f1_val': 0.9034766384306309, 'auprc': 0.9734887693937377, 'loss_val': 0.3272601524131947, 'psi': 0.9314814908158736}-{'f1_val': 0.8438705450207616, 'auprc': 0.8760799906435898, 'loss_val': 0.6748650043375785, 'psi': 0.8567543232698929}
[S17] START round=18 head_norm_before_train=1.156376 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.3374101590835563, 'auprc': 0.6855637571610115, 'loss_val': 1.0675474127752118, 'psi': 0.4766715983145384}-{'f1_val': 0.32130349454828283, 'auprc': 0.7203890135779699, 'loss_val': 1.0468552861284366, 'psi': 0.48093770216015763}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:51917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9468 head_norm=1.480640
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.048105e-02
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9473 head_norm=1.458716 delta_norm=0.060481
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:51911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:51903
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1798) from S16
[S17] cosine check vs S16: cos=0.9777
[S6] RECEIVED delta(kind=head bytes=1801) from S10
[S6] cosine check vs S10: cos=0.9904
[S9] RECEIVED delta(kind=head bytes=1801) from S3
[S9] cosine check vs S3: cos=-0.0149
[S9] DROPPED delta from S3 (cos=-0.0149 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.9941
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9975 head_norm=1.414169
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.302897e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9973 head_norm=1.352064 delta_norm=0.130290
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:51904
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:51915
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] cosine check vs S9: cos=-0.0149
[S3] DROPPED delta from S9 (cos=-0.0149 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S6
[S10] cosine check vs S6: cos=0.9904
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.4576 head_norm=1.348719
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.202513e-02
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.4555 head_norm=1.379395 delta_norm=0.082025
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] cosine check vs S11: cos=0.9933
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] cosine check vs S5: cos=0.9589
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.9518 head_norm=1.471435
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.275750e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.9526 head_norm=1.537914 delta_norm=0.127575
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.6972 head_norm=1.337142
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.926077e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.6974 head_norm=1.262714 delta_norm=0.192608
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.3374 head_norm=1.173141
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.277093e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.3388 head_norm=1.186604 delta_norm=0.127709
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.559439 cos_to_last_merge=0.9781 (last merge round=12)
[S2] round=19 local utility u=0.000804 metrics={'f1_val': 0.7012900746650139, 'auprc': 0.6625690295083521, 'loss_val': 0.3148582009395143, 'psi': 0.6858016566023492}-{'f1_val': 0.7012900746650139, 'auprc': 0.6576943579882749, 'loss_val': 0.30184282077429975, 'psi': 0.6838517879943182}
[S3] START round=19 head_norm_before_train=1.672615 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7010863553524592, 'auprc': 0.9956961793884158, 'loss_val': 0.2578101094732704, 'psi': 0.8189302849668418}-{'f1_val': 0.7007562037352997, 'auprc': 0.9967345760087827, 'loss_val': 0.2544675947775098, 'psi': 0.8191475526446929}
[S4] START round=19 head_norm_before_train=1.458716 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.059720 metrics={'f1_val': 0.9477901849857829, 'auprc': 0.9447857284261099, 'loss_val': 0.406561550585452, 'psi': 0.9465884023619137}-{'f1_val': 0.9467927005242548, 'auprc': 0.925946490240096, 'loss_val': 0.4634981272624399, 'psi': 0.9384542164105912}
[S5] START round=19 head_norm_before_train=1.214554 cos_to_last_merge=0.9603 (last merge round=13)
[S5] round=19 local utility u=0.019493 metrics={'f1_val': 0.41698423964269166, 'auprc': 0.6845848249076324, 'loss_val': 0.8099305796356706, 'psi': 0.5240244737486679}-{'f1_val': 0.41698423964269166, 'auprc': 0.6740181804214819, 'loss_val': 0.8172168714378718, 'psi': 0.5197978159542078}
[S6] START round=19 head_norm_before_train=1.537914 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.6032513999532485, 'auprc': 0.8044836935342653, 'loss_val': 0.5779957930834028, 'psi': 0.6837443173856552}-{'f1_val': 0.9518094530865836, 'auprc': 0.965040072772511, 'loss_val': 0.3240517027092159, 'psi': 0.9571017009609546}
[S7] START round=19 head_norm_before_train=1.379395 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.530475 metrics={'f1_val': 0.586086455766821, 'auprc': 0.7547720456147595, 'loss_val': 0.8255711398529341, 'psi': 0.6535606917059964}-{'f1_val': 0.45764598701644604, 'auprc': 0.7236603557056204, 'loss_val': 1.0225433782080275, 'psi': 0.5640517344921158}
[S8] START round=19 head_norm_before_train=1.224860 cos_to_last_merge=0.9994 (last merge round=17)
[S8] round=19 local utility u=0.780234 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9982187467566621, 'loss_val': 0.17850190349488199, 'psi': 0.9972714232913246}-{'f1_val': 0.7471920089119103, 'auprc': 0.9972049993183026, 'loss_val': 0.23924246286323503, 'psi': 0.8471972050744672}
[S9] START round=19 head_norm_before_train=1.547784 cos_to_last_merge=0.9993 (last merge round=17)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9984357076153421, 'loss_val': 0.06892470557493965, 'psi': 0.9930873501169629}-{'f1_val': 0.9954108212552283, 'auprc': 0.9982746521735651, 'loss_val': 0.07875332424667393, 'psi': 0.996556353622563}
[S10] START round=19 head_norm_before_train=1.611767 cos_to_last_merge=0.9985 (last merge round=16)
[S10] round=19 local utility u=0.009955 metrics={'f1_val': 0.9950868285240967, 'auprc': 0.996751473665156, 'loss_val': 0.09294001376468237, 'psi': 0.9957526865805204}-{'f1_val': 0.9954430117283648, 'auprc': 0.9971608175918754, 'loss_val': 0.11621588920637005, 'psi': 0.9961301340737689}
[S11] START round=19 head_norm_before_train=1.437997 cos_to_last_merge=0.9996 (last merge round=17)
[S11] round=19 local utility u=0.017833 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9966792014226182, 'loss_val': 0.24569523899811116, 'psi': 0.8198328705480393}-{'f1_val': 0.7016934795869249, 'auprc': 0.9967233421587279, 'loss_val': 0.2800425600719861, 'psi': 0.8197054246156461}
[S13] START round=19 head_norm_before_train=1.433311 cos_to_last_merge=0.9762 (last merge round=13)
[S13] round=19 local utility u=0.112582 metrics={'f1_val': 0.6124855573967434, 'auprc': 0.858137406866607, 'loss_val': 0.6815759166024603, 'psi': 0.7107462971846887}-{'f1_val': 0.6054449604810324, 'auprc': 0.8087929955717232, 'loss_val': 0.7164639489858494, 'psi': 0.6867841745173087}
[S14] START round=19 head_norm_before_train=1.352064 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.993812237138557, 'auprc': 0.9971452848111527, 'loss_val': 0.16252558808275538, 'psi': 0.9951454562075953}-{'f1_val': 0.9975054147531532, 'auprc': 0.9971579337074867, 'loss_val': 0.12952204937658476, 'psi': 0.9973664223348866}
[S15] START round=19 head_norm_before_train=1.262714 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.090157 metrics={'f1_val': 0.6935664325942448, 'auprc': 0.96862189228737, 'loss_val': 0.3368316282878699, 'psi': 0.8035886164714949}-{'f1_val': 0.697239082889915, 'auprc': 0.9231341336219614, 'loss_val': 0.4027182601434976, 'psi': 0.7875971031827336}
[S16] START round=19 head_norm_before_train=1.213432 cos_to_last_merge=0.9666 (last merge round=13)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8983038726068185, 'auprc': 0.9871688568249875, 'loss_val': 0.45696713060631466, 'psi': 0.9338498662940862}-{'f1_val': 0.9034766384306309, 'auprc': 0.9734887693937377, 'loss_val': 0.3272601524131947, 'psi': 0.9314814908158736}
[S17] START round=19 head_norm_before_train=1.186604 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.210756 metrics={'f1_val': 0.39962611362180767, 'auprc': 0.7103619125974641, 'loss_val': 1.0937250978379722, 'psi': 0.5239204332120702}-{'f1_val': 0.3374101590835563, 'auprc': 0.6855637571610115, 'loss_val': 1.0675474127752118, 'psi': 0.4766715983145384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:51917
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] → sending delta(kind=head bytes=1808) to S9@127.0.0.1:51910
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:51912
[S3] r=20 psi=0.819 u=0.0000 p_local=0.1048 f1=0.701 auprc=0.996 bytes=23391
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] r=20 psi=0.995 u=0.0000 p_local=0.1117 f1=0.994 auprc=0.997 bytes=26987
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:51914
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1808 to 1 peers)
[S16] r=20 psi=0.934 u=0.0000 p_local=0.2718 f1=0.898 auprc=0.987 bytes=26919
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.9489
[S9] RECEIVED delta(kind=head bytes=1808) from S2
[S9] cosine check vs S2: cos=0.9923
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.9919
[S11] RECEIVED delta(kind=head bytes=1801) from S13
[S11] cosine check vs S13: cos=0.9867
[S6] RECEIVED delta(kind=head bytes=1799) from S10
[S6] cosine check vs S10: cos=0.9966
[S8] r=20 psi=0.997 u=0.7802 p_local=0.4313 f1=0.997 auprc=0.998 bytes=25165
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:51909
[S2] r=20 psi=0.686 u=0.0008 p_local=0.0849 f1=0.701 auprc=0.663 bytes=25199
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:51915
[S7] sending update (kind=head size=1804 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9478 head_norm=1.476402
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.389766e-02
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9522 head_norm=1.454298 delta_norm=0.093898
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.947 u=0.0597 p_local=0.1716 f1=0.948 auprc=0.945 bytes=25187
[S13] r=20 psi=0.711 u=0.1126 p_local=0.1098 f1=0.612 auprc=0.858 bytes=21563
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:51904
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=0.9998
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:51907
[S5] sending update (kind=head size=1803 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9895 head_norm=1.575840
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.787054e-02
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9895 head_norm=1.575228 delta_norm=0.097871
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.993 u=0.0000 p_local=0.1151 f1=0.990 auprc=0.998 bytes=25222
[S17] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.9828
[S8] RECEIVED delta(kind=head bytes=1793) from S17
[S8] cosine check vs S17: cos=0.9489
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] cosine check vs S11: cos=0.9977
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S15
[S6] cosine check vs S15: cos=0.9427
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9951 head_norm=1.635111
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.419372e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9953 head_norm=1.548938 delta_norm=0.141937
[S10] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.996 u=0.0100 p_local=0.1789 f1=0.995 auprc=0.997 bytes=30567
[S7] r=20 psi=0.654 u=0.5305 p_local=0.3512 f1=0.586 auprc=0.755 bytes=21564
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.6033 head_norm=1.556466
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.104209e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.6147 head_norm=1.493841 delta_norm=0.110421
[S6] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] r=20 psi=0.684 u=0.0000 p_local=0.3568 f1=0.603 auprc=0.804 bytes=17967
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.6936 head_norm=1.296433
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.216077e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.6924 head_norm=1.258119 delta_norm=0.121608
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.804 u=0.0902 p_local=0.1056 f1=0.694 auprc=0.969 bytes=21560
[S5] r=20 psi=0.524 u=0.0195 p_local=0.0607 f1=0.417 auprc=0.685 bytes=21552
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.7019 head_norm=1.459740
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.980837e-02
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.7019 head_norm=1.454949 delta_norm=0.049808
[S11] aggregate: ACCEPT kept=['S4', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] r=20 psi=0.820 u=0.0178 p_local=0.0881 f1=0.702 auprc=0.997 bytes=28738
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.3996 head_norm=1.204329
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.004015e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.4624 head_norm=1.221549 delta_norm=0.200402
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] r=20 psi=0.524 u=0.2108 p_local=0.0831 f1=0.400 auprc=0.710 bytes=17940
[S2] START round=20 head_norm_before_train=1.580687 cos_to_last_merge=0.9758 (last merge round=12)
[S2] round=20 local utility u=0.004466 metrics={'f1_val': 0.7008510845794864, 'auprc': 0.6633808440143604, 'loss_val': 0.3057280779644726, 'psi': 0.685862988353436}-{'f1_val': 0.7012900746650139, 'auprc': 0.6625690295083521, 'loss_val': 0.3148582009395143, 'psi': 0.6858016566023492}
[S3] START round=20 head_norm_before_train=1.687349 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9956312489622908, 'loss_val': 0.25461983844192315, 'psi': 0.8186013371801694}-{'f1_val': 0.7010863553524592, 'auprc': 0.9956961793884158, 'loss_val': 0.2578101094732704, 'psi': 0.8189302849668418}
[S4] START round=20 head_norm_before_train=1.454298 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.016901 metrics={'f1_val': 0.946473664949548, 'auprc': 0.9511107528168102, 'loss_val': 0.383835336357483, 'psi': 0.9483285000964529}-{'f1_val': 0.9477901849857829, 'auprc': 0.9447857284261099, 'loss_val': 0.406561550585452, 'psi': 0.9465884023619137}
[S5] START round=20 head_norm_before_train=1.230678 cos_to_last_merge=0.9540 (last merge round=13)
[S5] round=20 local utility u=0.019708 metrics={'f1_val': 0.41698423964269166, 'auprc': 0.6950855468923217, 'loss_val': 0.8020166720401466, 'psi': 0.5282247625425437}-{'f1_val': 0.41698423964269166, 'auprc': 0.6845848249076324, 'loss_val': 0.8099305796356706, 'psi': 0.5240244737486679}
[S6] START round=20 head_norm_before_train=1.493841 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=1.000000 metrics={'f1_val': 0.9620760736959346, 'auprc': 0.974711945372655, 'loss_val': 0.2596732331125259, 'psi': 0.9671304223666228}-{'f1_val': 0.6032513999532485, 'auprc': 0.8044836935342653, 'loss_val': 0.5779957930834028, 'psi': 0.6837443173856552}
[S7] START round=20 head_norm_before_train=1.399944 cos_to_last_merge=0.9997 (last merge round=18)
[S7] round=20 local utility u=0.222688 metrics={'f1_val': 0.6246177516774899, 'auprc': 0.7840259116518233, 'loss_val': 0.699145408265742, 'psi': 0.6883810156672232}-{'f1_val': 0.586086455766821, 'auprc': 0.7547720456147595, 'loss_val': 0.8255711398529341, 'psi': 0.6535606917059964}
[S8] START round=20 head_norm_before_train=1.270542 cos_to_last_merge=0.9972 (last merge round=17)
[S8] round=20 local utility u=0.008981 metrics={'f1_val': 0.9934116751513793, 'auprc': 0.9992437168147329, 'loss_val': 0.14424477174003947, 'psi': 0.9957444918167206}-{'f1_val': 0.9966398743144329, 'auprc': 0.9982187467566621, 'loss_val': 0.17850190349488199, 'psi': 0.9972714232913246}
[S9] START round=20 head_norm_before_train=1.575228 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.023025 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9984311936122527, 'loss_val': 0.05822498506288758, 'psi': 0.9966219769668726}-{'f1_val': 0.9895217784513768, 'auprc': 0.9984357076153421, 'loss_val': 0.06892470557493965, 'psi': 0.9930873501169629}
[S10] START round=20 head_norm_before_train=1.548938 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.000915 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9964521756924176, 'loss_val': 0.09416540899042489, 'psi': 0.9960282067240134}-{'f1_val': 0.9950868285240967, 'auprc': 0.996751473665156, 'loss_val': 0.09294001376468237, 'psi': 0.9957526865805204}
[S11] START round=20 head_norm_before_train=1.454949 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.795238 metrics={'f1_val': 0.9597194965484097, 'auprc': 0.9978546681901911, 'loss_val': 0.20545073086443705, 'psi': 0.9749735652051222}-{'f1_val': 0.7019353166316534, 'auprc': 0.9966792014226182, 'loss_val': 0.24569523899811116, 'psi': 0.8198328705480393}
[S13] START round=20 head_norm_before_train=1.451855 cos_to_last_merge=0.9723 (last merge round=13)
[S13] round=20 local utility u=0.161809 metrics={'f1_val': 0.6299175137724787, 'auprc': 0.9040582656977951, 'loss_val': 0.6003128912006414, 'psi': 0.7395738145426054}-{'f1_val': 0.6124855573967434, 'auprc': 0.858137406866607, 'loss_val': 0.6815759166024603, 'psi': 0.7107462971846887}
[S14] START round=20 head_norm_before_train=1.370694 cos_to_last_merge=0.9999 (last merge round=18)
[S14] round=20 local utility u=0.026878 metrics={'f1_val': 0.9972630104447024, 'auprc': 0.9971569624095942, 'loss_val': 0.12950908778990505, 'psi': 0.9972205912306591}-{'f1_val': 0.993812237138557, 'auprc': 0.9971452848111527, 'loss_val': 0.16252558808275538, 'psi': 0.9951454562075953}
[S15] START round=20 head_norm_before_train=1.258119 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6989910142795035, 'auprc': 0.9666019705225117, 'loss_val': 0.4234945926158565, 'psi': 0.8060353967767069}-{'f1_val': 0.6935664325942448, 'auprc': 0.96862189228737, 'loss_val': 0.3368316282878699, 'psi': 0.8035886164714949}
[S16] START round=20 head_norm_before_train=1.261235 cos_to_last_merge=0.9592 (last merge round=13)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8742795352488368, 'auprc': 0.9895662900444503, 'loss_val': 0.5151284495152469, 'psi': 0.9203942371670821}-{'f1_val': 0.8983038726068185, 'auprc': 0.9871688568249875, 'loss_val': 0.45696713060631466, 'psi': 0.9338498662940862}
[S17] START round=20 head_norm_before_train=1.221549 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.157758 metrics={'f1_val': 0.4609457023769291, 'auprc': 0.704499868613234, 'loss_val': 1.1285400696307324, 'psi': 0.5583673688714511}-{'f1_val': 0.39962611362180767, 'auprc': 0.7103619125974641, 'loss_val': 1.0937250978379722, 'psi': 0.5239204332120702}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:51917
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:51907
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S16] ⇄ pheromone p=0.217 → S17@127.0.0.1:51917
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:51911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:51914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:51903
[S3] ⇄ pheromone p=0.084 → S9@127.0.0.1:51910
[S11] RECEIVED delta(kind=head bytes=1804) from S13
[S11] cosine check vs S13: cos=0.9857
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.9821
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.9992
[S6] RECEIVED delta(kind=head bytes=1801) from S10
[S6] cosine check vs S10: cos=0.9980
[S9] RECEIVED delta(kind=head bytes=1805) from S2
[S9] cosine check vs S2: cos=0.9957
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9964
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9973 head_norm=1.395348
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.060770e-02
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9973 head_norm=1.397496 delta_norm=0.020608
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.095 → S7@127.0.0.1:51908
[S6] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:51909
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9465 head_norm=1.476446
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.628098e-02
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9485 head_norm=1.466620 delta_norm=0.066281
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.141 → S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:51904
[S9] sending update (kind=head size=1801 to 1 peers)
[S2] ⇄ pheromone p=0.069 → S9@127.0.0.1:51910
[S13] ⇄ pheromone p=0.120 → S11@127.0.0.1:51912
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9934 head_norm=1.322373
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.263847e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9941 head_norm=1.244303 delta_norm=0.226385
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.347 → S17@127.0.0.1:51917
[S10] ⇄ pheromone p=0.143 → S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:51915
[S7] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S7
[S14] cosine check vs S7: cos=0.9996
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=-0.0154
[S3] DROPPED delta from S9 (cos=-0.0154 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S6
[S10] cosine check vs S6: cos=0.9980
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S17] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S5
[S15] cosine check vs S5: cos=0.9915
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.9994
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] cosine check vs S11: cos=0.9991
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9954 head_norm=1.598838
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.443736e-02
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9958 head_norm=1.596350 delta_norm=0.074437
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.097 → S3@127.0.0.1:51903
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6246 head_norm=1.417796
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.018091e-02
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.6250 head_norm=1.406293 delta_norm=0.030181
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.326 → S16@127.0.0.1:51916
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.9621 head_norm=1.508818
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.860528e-02
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.9619 head_norm=1.539952 delta_norm=0.058605
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.485 → S15@127.0.0.1:51915
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.6990 head_norm=1.294699
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.670744e-02
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.6990 head_norm=1.265509 delta_norm=0.086707
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.084 → S6@127.0.0.1:51907
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.4609 head_norm=1.238727
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.281267e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.4491 head_norm=1.274811 delta_norm=0.128127
[S17] aggregate: ROLLBACK (f1_val pre=0.461 post=0.449 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.098 → S8@127.0.0.1:51909
[S5] ⇄ pheromone p=0.052 → S15@127.0.0.1:51915
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.9597 head_norm=1.481349
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.526113e-02
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.9550 head_norm=1.470624 delta_norm=0.055261
[S11] aggregate: ACCEPT kept=['S13', 'S4'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.230 → S5@127.0.0.1:51905
[S2] START round=21 head_norm_before_train=1.597330 cos_to_last_merge=0.9738 (last merge round=12)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7010315658334224, 'auprc': 0.6632873903241517, 'loss_val': 0.30704147771321955, 'psi': 0.6859338956297141}-{'f1_val': 0.7008510845794864, 'auprc': 0.6633808440143604, 'loss_val': 0.3057280779644726, 'psi': 0.685862988353436}
[S3] START round=21 head_norm_before_train=1.701964 (no previous merge yet)
[S3] round=21 local utility u=0.016262 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9957366688486121, 'loss_val': 0.22090926742131867, 'psi': 0.8184932189513621}-{'f1_val': 0.7005813959920884, 'auprc': 0.9956312489622908, 'loss_val': 0.25461983844192315, 'psi': 0.8186013371801694}
[S4] START round=21 head_norm_before_train=1.466620 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9422810557553453, 'auprc': 0.9548365102579908, 'loss_val': 0.37103040239427776, 'psi': 0.9473032375564034}-{'f1_val': 0.946473664949548, 'auprc': 0.9511107528168102, 'loss_val': 0.383835336357483, 'psi': 0.9483285000964529}
[S5] START round=21 head_norm_before_train=1.241700 cos_to_last_merge=0.9502 (last merge round=13)
[S5] round=21 local utility u=0.041378 metrics={'f1_val': 0.41698423964269166, 'auprc': 0.7218312349783199, 'loss_val': 0.7994970232618713, 'psi': 0.538923037776943}-{'f1_val': 0.41698423964269166, 'auprc': 0.6950855468923217, 'loss_val': 0.8020166720401466, 'psi': 0.5282247625425437}
[S6] START round=21 head_norm_before_train=1.539952 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.5324250336068965, 'auprc': 0.779261924424844, 'loss_val': 0.6760324995342639, 'psi': 0.6311597899340755}-{'f1_val': 0.9620760736959346, 'auprc': 0.974711945372655, 'loss_val': 0.2596732331125259, 'psi': 0.9671304223666228}
[S7] START round=21 head_norm_before_train=1.406293 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.5030881196002341, 'auprc': 0.7326809546885231, 'loss_val': 1.0123991754011985, 'psi': 0.5949252536355497}-{'f1_val': 0.6246177516774899, 'auprc': 0.7840259116518233, 'loss_val': 0.699145408265742, 'psi': 0.6883810156672232}
[S8] START round=21 head_norm_before_train=1.244303 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9950136499820015, 'auprc': 0.9981174248341756, 'loss_val': 0.15813243379499925, 'psi': 0.9962551599228712}-{'f1_val': 0.9934116751513793, 'auprc': 0.9992437168147329, 'loss_val': 0.14424477174003947, 'psi': 0.9957444918167206}
[S9] START round=21 head_norm_before_train=1.596350 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9984298052918019, 'loss_val': 0.056412830580700006, 'psi': 0.9961184308122876}-{'f1_val': 0.9954158325366191, 'auprc': 0.9984311936122527, 'loss_val': 0.05822498506288758, 'psi': 0.9966219769668726}
[S10] START round=21 head_norm_before_train=1.572654 cos_to_last_merge=0.9998 (last merge round=19)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9947853937174467, 'auprc': 0.9971616314221772, 'loss_val': 0.09166036627795231, 'psi': 0.9957358887993388}-{'f1_val': 0.9957455607450773, 'auprc': 0.9964521756924176, 'loss_val': 0.09416540899042489, 'psi': 0.9960282067240134}
[S11] START round=21 head_norm_before_train=1.470624 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.127628 metrics={'f1_val': 0.996960829744628, 'auprc': 0.997983699258397, 'loss_val': 0.17402996739880394, 'psi': 0.9973699775501356}-{'f1_val': 0.9597194965484097, 'auprc': 0.9978546681901911, 'loss_val': 0.20545073086443705, 'psi': 0.9749735652051222}
[S13] START round=21 head_norm_before_train=1.465628 cos_to_last_merge=0.9697 (last merge round=13)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6088106363270473, 'auprc': 0.872746216512158, 'loss_val': 0.6788749109538532, 'psi': 0.7143848684010916}-{'f1_val': 0.6299175137724787, 'auprc': 0.9040582656977951, 'loss_val': 0.6003128912006414, 'psi': 0.7395738145426054}
[S14] START round=21 head_norm_before_train=1.397496 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.009599 metrics={'f1_val': 0.9976737714957896, 'auprc': 0.9971273642361845, 'loss_val': 0.11268763174977299, 'psi': 0.9974552085919475}-{'f1_val': 0.9972630104447024, 'auprc': 0.9971569624095942, 'loss_val': 0.12950908778990505, 'psi': 0.9972205912306591}
[S15] START round=21 head_norm_before_train=1.265509 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.957336 metrics={'f1_val': 0.9648426132103096, 'auprc': 0.9913370006003998, 'loss_val': 0.1781366927673948, 'psi': 0.9754403681663457}-{'f1_val': 0.6989910142795035, 'auprc': 0.9666019705225117, 'loss_val': 0.4234945926158565, 'psi': 0.8060353967767069}
[S16] START round=21 head_norm_before_train=1.305123 cos_to_last_merge=0.9525 (last merge round=13)
[S16] round=21 local utility u=0.161642 metrics={'f1_val': 0.9069160134212069, 'auprc': 0.9929162670008943, 'loss_val': 0.397712807064839, 'psi': 0.9413161148530818}-{'f1_val': 0.8742795352488368, 'auprc': 0.9895662900444503, 'loss_val': 0.5151284495152469, 'psi': 0.9203942371670821}
[S17] START round=21 head_norm_before_train=1.274811 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.2896202941387111, 'auprc': 0.7041895949836505, 'loss_val': 1.4028830030311357, 'psi': 0.4554480144766869}-{'f1_val': 0.4609457023769291, 'auprc': 0.704499868613234, 'loss_val': 1.1285400696307324, 'psi': 0.5583673688714511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:51917
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:51908
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9948 head_norm=1.598208
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.447020e-02
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9948 head_norm=1.552371 delta_norm=0.074470
[S10] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1795 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9423 head_norm=1.499390
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.519284e-02
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9425 head_norm=1.489374 delta_norm=0.055193
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9950 head_norm=1.285498
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.015156e-02
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9950 head_norm=1.261333 delta_norm=0.050152
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.9993
[S9] RECEIVED delta(kind=head bytes=1798) from S3
[S9] cosine check vs S3: cos=-0.0140
[S9] DROPPED delta from S3 (cos=-0.0140 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S16
[S17] cosine check vs S16: cos=0.9241
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:51915
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9977 head_norm=1.428450
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.210605e-02
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9977 head_norm=1.422771 delta_norm=0.032106
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S15
[S6] cosine check vs S15: cos=0.9256
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.5324 head_norm=1.552198
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.015691e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.5591 head_norm=1.399716 delta_norm=0.301569
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.5031 head_norm=1.419325
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.772111e-02
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.5027 head_norm=1.423625 delta_norm=0.027721
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=0.9945
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] cosine check vs S11: cos=0.2862
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.9648 head_norm=1.300376
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.112509e-02
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.9578 head_norm=1.273724 delta_norm=0.071125
[S15] aggregate: ROLLBACK (f1_val pre=0.965 post=0.958 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.2896 head_norm=1.291655
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.569004e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.3188 head_norm=1.288661 delta_norm=0.256900
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.4170 head_norm=1.250554
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.271947e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.4170 head_norm=1.104871 delta_norm=0.827195
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.611598 cos_to_last_merge=0.9722 (last merge round=12)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7012120585667497, 'auprc': 0.6636182143459322, 'loss_val': 0.3204819905389824, 'psi': 0.6861745208784227}-{'f1_val': 0.7010315658334224, 'auprc': 0.6632873903241517, 'loss_val': 0.30704147771321955, 'psi': 0.6859338956297141}
[S3] START round=22 head_norm_before_train=1.717338 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.6776966016110191, 'auprc': 0.9933949402760227, 'loss_val': 0.2635835651538047, 'psi': 0.8039759370770205}-{'f1_val': 0.700330919019862, 'auprc': 0.9957366688486121, 'loss_val': 0.22090926742131867, 'psi': 0.8184932189513621}
[S4] START round=22 head_norm_before_train=1.489374 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.010803 metrics={'f1_val': 0.9418439203043751, 'auprc': 0.9551452695733367, 'loss_val': 0.3477285072591576, 'psi': 0.9471644600119598}-{'f1_val': 0.9422810557553453, 'auprc': 0.9548365102579908, 'loss_val': 0.37103040239427776, 'psi': 0.9473032375564034}
[S5] START round=22 head_norm_before_train=1.104871 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.035548 metrics={'f1_val': 0.41698423964269166, 'auprc': 0.7471793547806079, 'loss_val': 0.8044454365535271, 'psi': 0.5490622856978582}-{'f1_val': 0.41698423964269166, 'auprc': 0.7218312349783199, 'loss_val': 0.7994970232618713, 'psi': 0.538923037776943}
[S6] START round=22 head_norm_before_train=1.399716 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=1.000000 metrics={'f1_val': 0.9581326311986649, 'auprc': 0.9571077551809807, 'loss_val': 0.2505419019490671, 'psi': 0.9577226807915913}-{'f1_val': 0.5324250336068965, 'auprc': 0.779261924424844, 'loss_val': 0.6760324995342639, 'psi': 0.6311597899340755}
[S7] START round=22 head_norm_before_train=1.423625 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.439306 metrics={'f1_val': 0.5877786542780904, 'auprc': 0.777135629268073, 'loss_val': 0.7752937042803276, 'psi': 0.6635214442740835}-{'f1_val': 0.5030881196002341, 'auprc': 0.7326809546885231, 'loss_val': 1.0123991754011985, 'psi': 0.5949252536355497}
[S8] START round=22 head_norm_before_train=1.261333 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.008237 metrics={'f1_val': 0.9947983930821034, 'auprc': 0.9986400280651784, 'loss_val': 0.14193525249595024, 'psi': 0.9963350470753334}-{'f1_val': 0.9950136499820015, 'auprc': 0.9981174248341756, 'loss_val': 0.15813243379499925, 'psi': 0.9962551599228712}
[S9] START round=22 head_norm_before_train=1.618873 cos_to_last_merge=0.9996 (last merge round=20)
[S9] round=22 local utility u=0.010495 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9982236466047838, 'loss_val': 0.044815418965428025, 'psi': 0.997037127621445}-{'f1_val': 0.9945775144926113, 'auprc': 0.9984298052918019, 'loss_val': 0.056412830580700006, 'psi': 0.9961184308122876}
[S10] START round=22 head_norm_before_train=1.552371 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.993924439075923, 'auprc': 0.9966992503951003, 'loss_val': 0.08776057176832652, 'psi': 0.9950343636035939}-{'f1_val': 0.9947853937174467, 'auprc': 0.9971616314221772, 'loss_val': 0.09166036627795231, 'psi': 0.9957358887993388}
[S11] START round=22 head_norm_before_train=1.498698 cos_to_last_merge=0.9995 (last merge round=20)
[S11] round=22 local utility u=0.019263 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977756230803568, 'loss_val': 0.13239727925350148, 'psi': 0.9970384519402965}-{'f1_val': 0.996960829744628, 'auprc': 0.997983699258397, 'loss_val': 0.17402996739880394, 'psi': 0.9973699775501356}
[S13] START round=22 head_norm_before_train=1.476869 cos_to_last_merge=0.9669 (last merge round=13)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5826756187374792, 'auprc': 0.8890337640814747, 'loss_val': 0.7710022597321969, 'psi': 0.7052188768750774}-{'f1_val': 0.6088106363270473, 'auprc': 0.872746216512158, 'loss_val': 0.6788749109538532, 'psi': 0.7143848684010916}
[S14] START round=22 head_norm_before_train=1.422771 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.008385 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9970899095682968, 'loss_val': 0.09712563536670059, 'psi': 0.9975722672636476}-{'f1_val': 0.9976737714957896, 'auprc': 0.9971273642361845, 'loss_val': 0.11268763174977299, 'psi': 0.9974552085919475}
[S15] START round=22 head_norm_before_train=1.273724 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6964521418702215, 'auprc': 0.9802087400691273, 'loss_val': 0.39960429955707844, 'psi': 0.8099547811497838}-{'f1_val': 0.9648426132103096, 'auprc': 0.9913370006003998, 'loss_val': 0.1781366927673948, 'psi': 0.9754403681663457}
[S16] START round=22 head_norm_before_train=1.336007 cos_to_last_merge=0.9475 (last merge round=13)
[S16] ⚠️ Model drifted since last merge! cos=0.947
[S16] round=22 local utility u=0.097564 metrics={'f1_val': 0.9139746281319222, 'auprc': 0.9866686269436771, 'loss_val': 0.22619395369782638, 'psi': 0.9430522276566242}-{'f1_val': 0.9069160134212069, 'auprc': 0.9929162670008943, 'loss_val': 0.397712807064839, 'psi': 0.9413161148530818}
[S17] START round=22 head_norm_before_train=1.288661 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.14538126478603625, 'auprc': 0.6589344007739366, 'loss_val': 1.9446432477432367, 'psi': 0.35080251918119637}-{'f1_val': 0.2896202941387111, 'auprc': 0.7041895949836505, 'loss_val': 1.4028830030311357, 'psi': 0.4554480144766869}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:51908
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:51912
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:51917
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:51903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:51916
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.9867
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.9994
[S11] RECEIVED delta(kind=head bytes=1805) from S4
[S11] cosine check vs S4: cos=0.9961
[S7] sending update (kind=head size=1802 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1806 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] cosine check vs S7: cos=-0.0326
[S16] DROPPED delta from S7 (cos=-0.0326 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1806) from S9
[S3] cosine check vs S9: cos=-0.0174
[S3] DROPPED delta from S9 (cos=-0.0174 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.5878 head_norm=1.436428
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.829222e-02
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.5858 head_norm=1.448744 delta_norm=0.028292
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:51911
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S16
[S17] cosine check vs S16: cos=0.9788
[S6] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:51915
[S10] RECEIVED delta(kind=head bytes=1797) from S6
[S10] cosine check vs S6: cos=0.9834
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S11
[S5] cosine check vs S11: cos=0.8376
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.7575
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.1454 head_norm=1.306582
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.173354e-02
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.1461 head_norm=1.309781 delta_norm=0.031734
[S17] aggregate: ACCEPT kept=['S8', 'S16'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.6965 head_norm=1.308379
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.315461e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.6964 head_norm=1.136569 delta_norm=0.431546
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.4170 head_norm=1.115431
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.252950e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.4170 head_norm=1.268096 delta_norm=0.425295
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.9965 head_norm=1.527645
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.774360e-02
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.9965 head_norm=1.526093 delta_norm=0.067744
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.623952 cos_to_last_merge=0.9707 (last merge round=12)
[S2] round=23 local utility u=0.001082 metrics={'f1_val': 0.7015730791798309, 'auprc': 0.6699474445700034, 'loss_val': 0.33947280476143, 'psi': 0.6889228253358999}-{'f1_val': 0.7012120585667497, 'auprc': 0.6636182143459322, 'loss_val': 0.3204819905389824, 'psi': 0.6861745208784227}
[S3] START round=23 head_norm_before_train=1.732627 (no previous merge yet)
[S3] round=23 local utility u=0.096206 metrics={'f1_val': 0.6985736745320306, 'auprc': 0.9945360324017976, 'loss_val': 0.19985669361518993, 'psi': 0.8169586176799374}-{'f1_val': 0.6776966016110191, 'auprc': 0.9933949402760227, 'loss_val': 0.2635835651538047, 'psi': 0.8039759370770205}
[S4] START round=23 head_norm_before_train=1.527546 cos_to_last_merge=0.9991 (last merge round=21)
[S4] round=23 local utility u=0.040654 metrics={'f1_val': 0.9460074053843596, 'auprc': 0.9618980264287781, 'loss_val': 0.3116597406307746, 'psi': 0.952363653802127}-{'f1_val': 0.9418439203043751, 'auprc': 0.9551452695733367, 'loss_val': 0.3477285072591576, 'psi': 0.9471644600119598}
[S5] START round=23 head_norm_before_train=1.268096 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.044338 metrics={'f1_val': 0.41702366566144455, 'auprc': 0.7756967632077116, 'loss_val': 0.8015590756973535, 'psi': 0.5604929046799514}-{'f1_val': 0.41698423964269166, 'auprc': 0.7471793547806079, 'loss_val': 0.8044454365535271, 'psi': 0.5490622856978582}
[S6] START round=23 head_norm_before_train=1.413904 cos_to_last_merge=0.9999 (last merge round=21)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.4619785448622763, 'auprc': 0.7542809511085704, 'loss_val': 0.8142426051377225, 'psi': 0.5788995073607939}-{'f1_val': 0.9581326311986649, 'auprc': 0.9571077551809807, 'loss_val': 0.2505419019490671, 'psi': 0.9577226807915913}
[S7] START round=23 head_norm_before_train=1.448744 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.077210 metrics={'f1_val': 0.6010359565701704, 'auprc': 0.7857774119170504, 'loss_val': 0.7263431443369879, 'psi': 0.6749325387089224}-{'f1_val': 0.5877786542780904, 'auprc': 0.777135629268073, 'loss_val': 0.7752937042803276, 'psi': 0.6635214442740835}
[S8] START round=23 head_norm_before_train=1.304538 cos_to_last_merge=0.9990 (last merge round=21)
[S8] round=23 local utility u=0.009680 metrics={'f1_val': 0.9952032626987092, 'auprc': 0.9981875666849654, 'loss_val': 0.1236479880567314, 'psi': 0.9963969842932117}-{'f1_val': 0.9947983930821034, 'auprc': 0.9986400280651784, 'loss_val': 0.14193525249595024, 'psi': 0.9963350470753334}
[S9] START round=23 head_norm_before_train=1.639616 cos_to_last_merge=0.9984 (last merge round=20)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9143752594585095, 'auprc': 0.9918389830820906, 'loss_val': 0.1309135728287087, 'psi': 0.945360748907942}-{'f1_val': 0.9962461149658858, 'auprc': 0.9982236466047838, 'loss_val': 0.044815418965428025, 'psi': 0.997037127621445}
[S10] START round=23 head_norm_before_train=1.575938 cos_to_last_merge=0.9998 (last merge round=21)
[S10] round=23 local utility u=0.008040 metrics={'f1_val': 0.9937298155689185, 'auprc': 0.9966267361019681, 'loss_val': 0.07029469112327733, 'psi': 0.9948885837821383}-{'f1_val': 0.993924439075923, 'auprc': 0.9966992503951003, 'loss_val': 0.08776057176832652, 'psi': 0.9950343636035939}
[S11] START round=23 head_norm_before_train=1.526093 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.009722 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979537088580089, 'loss_val': 0.11348708624267047, 'psi': 0.9971096862513573}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977756230803568, 'loss_val': 0.13239727925350148, 'psi': 0.9970384519402965}
[S13] START round=23 head_norm_before_train=1.489718 cos_to_last_merge=0.9631 (last merge round=13)
[S13] round=23 local utility u=0.285069 metrics={'f1_val': 0.6262964932412751, 'auprc': 0.935505653143898, 'loss_val': 0.6020043417352215, 'psi': 0.7499801572023244}-{'f1_val': 0.5826756187374792, 'auprc': 0.8890337640814747, 'loss_val': 0.7710022597321969, 'psi': 0.7052188768750774}
[S14] START round=23 head_norm_before_train=1.461504 cos_to_last_merge=0.9995 (last merge round=21)
[S14] round=23 local utility u=0.009674 metrics={'f1_val': 0.9976516241010662, 'auprc': 0.9970599662113959, 'loss_val': 0.07623478125496963, 'psi': 0.9974149609451981}-{'f1_val': 0.9978938390605482, 'auprc': 0.9970899095682968, 'loss_val': 0.09712563536670059, 'psi': 0.9975722672636476}
[S15] START round=23 head_norm_before_train=1.136569 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.969042 metrics={'f1_val': 0.9830279753369399, 'auprc': 0.9941291353442966, 'loss_val': 0.2227365844927315, 'psi': 0.9874684393398825}-{'f1_val': 0.6964521418702215, 'auprc': 0.9802087400691273, 'loss_val': 0.39960429955707844, 'psi': 0.8099547811497838}
[S16] START round=23 head_norm_before_train=1.366273 cos_to_last_merge=0.9427 (last merge round=13)
[S16] ⚠️ Model drifted since last merge! cos=0.943
[S16] round=23 local utility u=0.286264 metrics={'f1_val': 0.9899764845261607, 'auprc': 0.9868221252719582, 'loss_val': 0.11013683956682767, 'psi': 0.9887147408244797}-{'f1_val': 0.9139746281319222, 'auprc': 0.9866686269436771, 'loss_val': 0.22619395369782638, 'psi': 0.9430522276566242}
[S17] START round=23 head_norm_before_train=1.309781 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=1.000000 metrics={'f1_val': 0.3887719628997175, 'auprc': 0.728380264039631, 'loss_val': 1.3736814403077218, 'psi': 0.5246152833556829}-{'f1_val': 0.14538126478603625, 'auprc': 0.6589344007739366, 'loss_val': 1.9446432477432367, 'psi': 0.35080251918119637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:51917
[S2] sending update (kind=head size=1807 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:51916
[S9] RECEIVED delta(kind=head bytes=1797) from S3
[S9] cosine check vs S3: cos=-0.0213
[S9] DROPPED delta from S3 (cos=-0.0213 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S4
[S11] cosine check vs S4: cos=0.9961
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] cosine check vs S16: cos=0.9790
[S17] RECEIVED delta(kind=head bytes=1794) from S8
[S17] cosine check vs S8: cos=0.9806
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.9985
[S9] RECEIVED delta(kind=head bytes=1807) from S2
[S9] cosine check vs S2: cos=0.9924
[S11] RECEIVED delta(kind=head bytes=1799) from S13
[S11] cosine check vs S13: cos=0.9748
[S6] RECEIVED delta(kind=head bytes=1799) from S10
[S6] cosine check vs S10: cos=0.9819
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9937 head_norm=1.602925
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.727259e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9937 head_norm=1.501470 delta_norm=0.172726
[S10] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:51909
[S16] RECEIVED delta(kind=head bytes=1803) from S7
[S16] cosine check vs S7: cos=-0.0341
[S16] DROPPED delta from S7 (cos=-0.0341 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:51907
[S11] sending update (kind=head size=1801 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.4620 head_norm=1.426551
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.687776e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.4620 head_norm=1.507887 delta_norm=0.168778
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9144 head_norm=1.656452
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.019783e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.8968 head_norm=1.642570 delta_norm=0.101978
[S9] aggregate: ROLLBACK (f1_val pre=0.914 post=0.897 tol_abs=0.005 tol_rel=0.0)
[S5] sending update (kind=head size=1806 to 1 peers)
[S17] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1806) from S5
[S15] cosine check vs S5: cos=0.7502
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9806
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] cosine check vs S11: cos=0.9666
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S15
[S6] cosine check vs S15: cos=0.8527
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6010 head_norm=1.465088
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.459804e-02
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6010 head_norm=1.483991 delta_norm=0.044598
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.9830 head_norm=1.172146
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.362865e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.9824 head_norm=1.147123 delta_norm=0.436287
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.3888 head_norm=1.329916
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.479104e-02
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.3916 head_norm=1.337436 delta_norm=0.034791
[S17] aggregate: ACCEPT kept=['S16', 'S8'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9965 head_norm=1.556632
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.818357e-02
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9965 head_norm=1.536593 delta_norm=0.088184
[S11] aggregate: ACCEPT kept=['S4', 'S13'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.4170 head_norm=1.280057
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.288017e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.4176 head_norm=1.406582 delta_norm=0.228802
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.634943 cos_to_last_merge=0.9696 (last merge round=12)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7008510845794864, 'auprc': 0.6663029528473168, 'loss_val': 0.3381692679167298, 'psi': 0.6870318318866185}-{'f1_val': 0.7015730791798309, 'auprc': 0.6699474445700034, 'loss_val': 0.33947280476143, 'psi': 0.6889228253358999}
[S3] START round=24 head_norm_before_train=1.748645 (no previous merge yet)
[S3] round=24 local utility u=0.021790 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9973108597504994, 'loss_val': 0.17664658843794234, 'psi': 0.8192731814954528}-{'f1_val': 0.6985736745320306, 'auprc': 0.9945360324017976, 'loss_val': 0.19985669361518993, 'psi': 0.8169586176799374}
[S4] START round=24 head_norm_before_train=1.563351 cos_to_last_merge=0.9968 (last merge round=21)
[S4] round=24 local utility u=0.008628 metrics={'f1_val': 0.9496690619436909, 'auprc': 0.9547966584847691, 'loss_val': 0.2950695954678709, 'psi': 0.9517201005601222}-{'f1_val': 0.9460074053843596, 'auprc': 0.9618980264287781, 'loss_val': 0.3116597406307746, 'psi': 0.952363653802127}
[S5] START round=24 head_norm_before_train=1.406582 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.428952 metrics={'f1_val': 0.5498378315435809, 'auprc': 0.7903814261588576, 'loss_val': 0.7845943277355435, 'psi': 0.6460552693896916}-{'f1_val': 0.41702366566144455, 'auprc': 0.7756967632077116, 'loss_val': 0.8015590756973535, 'psi': 0.5604929046799514}
[S6] START round=24 head_norm_before_train=1.507887 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.7215014617426689, 'auprc': 0.90248553895155, 'loss_val': 0.5150218102247578, 'psi': 0.7938950926262214}-{'f1_val': 0.4619785448622763, 'auprc': 0.7542809511085704, 'loss_val': 0.8142426051377225, 'psi': 0.5788995073607939}
[S7] START round=24 head_norm_before_train=1.483991 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.141879 metrics={'f1_val': 0.6285888947082648, 'auprc': 0.7962446972966545, 'loss_val': 0.639305101958511, 'psi': 0.6956512157436208}-{'f1_val': 0.6010359565701704, 'auprc': 0.7857774119170504, 'loss_val': 0.7263431443369879, 'psi': 0.6749325387089224}
[S8] START round=24 head_norm_before_train=1.346366 cos_to_last_merge=0.9969 (last merge round=21)
[S8] round=24 local utility u=0.009116 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9979739991760064, 'loss_val': 0.10143236567238989, 'psi': 0.9959771786280285}-{'f1_val': 0.9952032626987092, 'auprc': 0.9981875666849654, 'loss_val': 0.1236479880567314, 'psi': 0.9963969842932117}
[S9] START round=24 head_norm_before_train=1.642570 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.289385 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9933582108692822, 'loss_val': 0.047949773643568415, 'psi': 0.9950933412152795}-{'f1_val': 0.9143752594585095, 'auprc': 0.9918389830820906, 'loss_val': 0.1309135728287087, 'psi': 0.945360748907942}
[S10] START round=24 head_norm_before_train=1.501470 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9932921870059098, 'auprc': 0.9966229960925532, 'loss_val': 0.07856027706053569, 'psi': 0.9946245106405671}-{'f1_val': 0.9937298155689185, 'auprc': 0.9966267361019681, 'loss_val': 0.07029469112327733, 'psi': 0.9948885837821383}
[S11] START round=24 head_norm_before_train=1.536593 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.005257 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978748084661491, 'loss_val': 0.10273543039784096, 'psi': 0.9970781260946133}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979537088580089, 'loss_val': 0.11348708624267047, 'psi': 0.9971096862513573}
[S13] START round=24 head_norm_before_train=1.504295 cos_to_last_merge=0.9596 (last merge round=13)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6068068014874982, 'auprc': 0.89350568742537, 'loss_val': 0.6992616772380521, 'psi': 0.721486355862647}-{'f1_val': 0.6262964932412751, 'auprc': 0.935505653143898, 'loss_val': 0.6020043417352215, 'psi': 0.7499801572023244}
[S14] START round=24 head_norm_before_train=1.503979 cos_to_last_merge=0.9982 (last merge round=21)
[S14] round=24 local utility u=0.006816 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9970530177747476, 'loss_val': 0.06403511282622242, 'psi': 0.997557510546228}-{'f1_val': 0.9976516241010662, 'auprc': 0.9970599662113959, 'loss_val': 0.07623478125496963, 'psi': 0.9974149609451981}
[S15] START round=24 head_norm_before_train=1.147123 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6987271871293922, 'auprc': 0.8444578424273983, 'loss_val': 0.44280092274346333, 'psi': 0.7570194492485947}-{'f1_val': 0.9830279753369399, 'auprc': 0.9941291353442966, 'loss_val': 0.2227365844927315, 'psi': 0.9874684393398825}
[S16] START round=24 head_norm_before_train=1.397293 cos_to_last_merge=0.9383 (last merge round=13)
[S16] ⚠️ Model drifted since last merge! cos=0.938
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.89722641394074, 'auprc': 0.994715904608962, 'loss_val': 0.39288669857037645, 'psi': 0.9362222102080288}-{'f1_val': 0.9899764845261607, 'auprc': 0.9868221252719582, 'loss_val': 0.11013683956682767, 'psi': 0.9887147408244797}
[S17] START round=24 head_norm_before_train=1.337436 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.263280 metrics={'f1_val': 0.41538391519616813, 'auprc': 0.764635686052811, 'loss_val': 1.1155597794767542, 'psi': 0.5550846235388253}-{'f1_val': 0.3887719628997175, 'auprc': 0.728380264039631, 'loss_val': 1.3736814403077218, 'psi': 0.5246152833556829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S4] → sending delta(kind=head bytes=1810) to S11@127.0.0.1:51912
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:51917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:51910
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:51903
[S8] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:51916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:51911
[S4] sending update (kind=head size=1810 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1810) from S4
[S11] cosine check vs S4: cos=0.9929
[S17] RECEIVED delta(kind=head bytes=1794) from S8
[S17] cosine check vs S8: cos=0.9763
[S9] RECEIVED delta(kind=head bytes=1804) from S3
[S9] cosine check vs S3: cos=-0.0185
[S9] DROPPED delta from S3 (cos=-0.0185 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.9982
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9946 head_norm=1.387322
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.516809e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9946 head_norm=1.350431 delta_norm=0.151681
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:51909
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:51915
[S9] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:51905
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=-0.0185
[S3] DROPPED delta from S9 (cos=-0.0185 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S6
[S10] cosine check vs S6: cos=0.9996
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=-0.0339
[S16] DROPPED delta from S7 (cos=-0.0339 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S11
[S5] cosine check vs S11: cos=0.9915
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=0.9938
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=0.8747
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.7215 head_norm=1.516786
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.017070e-01
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.7453 head_norm=1.294571 delta_norm=0.401707
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.6286 head_norm=1.504523
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.007714e-02
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.6280 head_norm=1.524059 delta_norm=0.050077
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.6987 head_norm=1.183990
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.448039e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.6985 head_norm=1.259976 delta_norm=0.344804
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.4154 head_norm=1.360169
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.500594e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.4034 head_norm=1.365593 delta_norm=0.150059
[S17] aggregate: ROLLBACK (f1_val pre=0.415 post=0.403 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9965 head_norm=1.567964
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.515708e-02
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9965 head_norm=1.578594 delta_norm=0.095157
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.5498 head_norm=1.418105
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.228484e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7140 head_norm=1.489857 delta_norm=0.122848
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.644771 cos_to_last_merge=0.9687 (last merge round=12)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6990436580055711, 'auprc': 0.6682746167931185, 'loss_val': 0.3674128515291183, 'psi': 0.6867360415205901}-{'f1_val': 0.7008510845794864, 'auprc': 0.6663029528473168, 'loss_val': 0.3381692679167298, 'psi': 0.6870318318866185}
[S3] START round=25 head_norm_before_train=1.771091 (no previous merge yet)
[S3] round=25 local utility u=0.807120 metrics={'f1_val': 0.960651231474942, 'auprc': 0.9989122540245817, 'loss_val': 0.1276300761907232, 'psi': 0.9759556404947979}-{'f1_val': 0.7005813959920884, 'auprc': 0.9973108597504994, 'loss_val': 0.17664658843794234, 'psi': 0.8192731814954528}
[S4] START round=25 head_norm_before_train=1.594841 cos_to_last_merge=0.9941 (last merge round=21)
[S4] round=25 local utility u=0.017932 metrics={'f1_val': 0.9543005635836932, 'auprc': 0.9521699366889982, 'loss_val': 0.27911375632365726, 'psi': 0.9534483128258152}-{'f1_val': 0.9496690619436909, 'auprc': 0.9547966584847691, 'loss_val': 0.2950695954678709, 'psi': 0.9517201005601222}
[S5] START round=25 head_norm_before_train=1.489857 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.4171435078150064, 'auprc': 0.7902382401595254, 'loss_val': 0.7522898870766518, 'psi': 0.5663814007528141}-{'f1_val': 0.5498378315435809, 'auprc': 0.7903814261588576, 'loss_val': 0.7845943277355435, 'psi': 0.6460552693896916}
[S6] START round=25 head_norm_before_train=1.294571 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=0.942592 metrics={'f1_val': 0.9610198422717251, 'auprc': 0.9761584422750341, 'loss_val': 0.2879659660131433, 'psi': 0.9670752822730487}-{'f1_val': 0.7215014617426689, 'auprc': 0.90248553895155, 'loss_val': 0.5150218102247578, 'psi': 0.7938950926262214}
[S7] START round=25 head_norm_before_train=1.524059 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.488005586272222, 'auprc': 0.7350672193758692, 'loss_val': 1.1358777964325524, 'psi': 0.5868302395136809}-{'f1_val': 0.6285888947082648, 'auprc': 0.7962446972966545, 'loss_val': 0.639305101958511, 'psi': 0.6956512157436208}
[S8] START round=25 head_norm_before_train=1.350431 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.991384145019477, 'auprc': 0.9991353587306071, 'loss_val': 0.10920239065437166, 'psi': 0.994484630503929}-{'f1_val': 0.9946459649293765, 'auprc': 0.9979739991760064, 'loss_val': 0.10143236567238989, 'psi': 0.9959771786280285}
[S9] START round=25 head_norm_before_train=1.654215 cos_to_last_merge=0.9999 (last merge round=23)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.9984379887839094, 'loss_val': 0.055847783666668045, 'psi': 0.992852531359544}-{'f1_val': 0.9962500947792776, 'auprc': 0.9933582108692822, 'loss_val': 0.047949773643568415, 'psi': 0.9950933412152795}
[S10] START round=25 head_norm_before_train=1.535395 cos_to_last_merge=0.9997 (last merge round=23)
[S10] round=25 local utility u=0.007754 metrics={'f1_val': 0.9944754122691798, 'auprc': 0.9933411651632046, 'loss_val': 0.060306652589405235, 'psi': 0.9940217134267897}-{'f1_val': 0.9932921870059098, 'auprc': 0.9966229960925532, 'loss_val': 0.07856027706053569, 'psi': 0.9946245106405671}
[S11] START round=25 head_norm_before_train=1.578594 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.010435 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997916256154413, 'loss_val': 0.0819904999643953, 'psi': 0.9970947051699189}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978748084661491, 'loss_val': 0.10273543039784096, 'psi': 0.9970781260946133}
[S13] START round=25 head_norm_before_train=1.515865 cos_to_last_merge=0.9573 (last merge round=13)
[S13] round=25 local utility u=0.184037 metrics={'f1_val': 0.629525840458691, 'auprc': 0.9336177544454409, 'loss_val': 0.5878387977642834, 'psi': 0.7511626060533909}-{'f1_val': 0.6068068014874982, 'auprc': 0.89350568742537, 'loss_val': 0.6992616772380521, 'psi': 0.721486355862647}
[S14] START round=25 head_norm_before_train=1.544971 cos_to_last_merge=0.9961 (last merge round=21)
[S14] round=25 local utility u=0.001266 metrics={'f1_val': 0.9972338922372435, 'auprc': 0.9970567265726928, 'loss_val': 0.05755447885298984, 'psi': 0.9971630259714233}-{'f1_val': 0.9978938390605482, 'auprc': 0.9970530177747476, 'loss_val': 0.06403511282622242, 'psi': 0.997557510546228}
[S15] START round=25 head_norm_before_train=1.259976 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=1.000000 metrics={'f1_val': 0.9924248591659374, 'auprc': 0.9957577496529788, 'loss_val': 0.2701432127009329, 'psi': 0.9937580153607539}-{'f1_val': 0.6987271871293922, 'auprc': 0.8444578424273983, 'loss_val': 0.44280092274346333, 'psi': 0.7570194492485947}
[S16] START round=25 head_norm_before_train=1.427596 cos_to_last_merge=0.9345 (last merge round=13)
[S16] ⚠️ Model drifted since last merge! cos=0.934
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.850265917321354, 'auprc': 0.9938277088358367, 'loss_val': 0.6566986649554077, 'psi': 0.9076906339271471}-{'f1_val': 0.89722641394074, 'auprc': 0.994715904608962, 'loss_val': 0.39288669857037645, 'psi': 0.9362222102080288}
[S17] START round=25 head_norm_before_train=1.365593 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.33727202790819333, 'auprc': 0.8919182253857545, 'loss_val': 1.1240590156686745, 'psi': 0.5591305068992178}-{'f1_val': 0.41538391519616813, 'auprc': 0.764635686052811, 'loss_val': 1.1155597794767542, 'psi': 0.5550846235388253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:51907
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:51912
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:51908
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9914 head_norm=1.392338
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.610339e-02
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9917 head_norm=1.372988 delta_norm=0.096103
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.117 → S17@127.0.0.1:51917
[S2] ⇄ pheromone p=0.023 → S9@127.0.0.1:51910
[S4] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:51911
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] ⇄ pheromone p=0.131 → S17@127.0.0.1:51917
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.9985
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.9964
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=0.9694
[S11] RECEIVED delta(kind=head bytes=1804) from S13
[S11] cosine check vs S13: cos=0.9694
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] cosine check vs S3: cos=-0.0221
[S9] DROPPED delta from S3 (cos=-0.0221 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:51907
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9945 head_norm=1.575128
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.896136e-02
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9945 head_norm=1.545457 delta_norm=0.048961
[S10] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.050 → S6@127.0.0.1:51907
[S6] sending update (kind=head size=1798 to 1 peers)
[S4] ⇄ pheromone p=0.057 → S11@127.0.0.1:51912
[S13] ⇄ pheromone p=0.113 → S11@127.0.0.1:51912
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.206 → S9@127.0.0.1:51910
[S14] ⇄ pheromone p=0.035 → S7@127.0.0.1:51908
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:51905
[S10] RECEIVED delta(kind=head bytes=1798) from S6
[S10] cosine check vs S6: cos=0.9714
[S15] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S15
[S6] cosine check vs S15: cos=0.6545
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.4880 head_norm=1.539805
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.643923e-02
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.4865 head_norm=1.556590 delta_norm=0.046439
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.184 → S16@127.0.0.1:51916
[S9] ⇄ pheromone p=0.079 → S3@127.0.0.1:51903
[S11] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S11
[S5] cosine check vs S11: cos=0.9951
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.9610 head_norm=1.310760
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.794140e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.9607 head_norm=1.260478 delta_norm=0.179414
[S6] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.610 → S15@127.0.0.1:51915
[S15] ⇄ pheromone p=0.430 → S6@127.0.0.1:51907
[S17] ⇄ pheromone p=0.202 → S2@127.0.0.1:51902
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9965 head_norm=1.610385
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.097747e-02
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9965 head_norm=1.581559 delta_norm=0.090977
[S11] aggregate: ACCEPT kept=['S4', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.092 → S5@127.0.0.1:51905
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.4171 head_norm=1.499515
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.487674e-02
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.6116 head_norm=1.553042 delta_norm=0.094877
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.099 → S15@127.0.0.1:51915
[S2] START round=26 head_norm_before_train=1.653845 cos_to_last_merge=0.9679 (last merge round=12)
[S2] round=26 local utility u=0.023877 metrics={'f1_val': 0.7010315658334224, 'auprc': 0.6680429331347764, 'loss_val': 0.3308906579975706, 'psi': 0.687836112753964}-{'f1_val': 0.6990436580055711, 'auprc': 0.6682746167931185, 'loss_val': 0.3674128515291183, 'psi': 0.6867360415205901}
[S3] START round=26 head_norm_before_train=1.791767 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9548069309636095, 'auprc': 0.999120156094345, 'loss_val': 0.12219409805026696, 'psi': 0.9725322210159038}-{'f1_val': 0.960651231474942, 'auprc': 0.9989122540245817, 'loss_val': 0.1276300761907232, 'psi': 0.9759556404947979}
[S4] START round=26 head_norm_before_train=1.620350 cos_to_last_merge=0.9919 (last merge round=21)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9505827509122043, 'auprc': 0.9523188504428619, 'loss_val': 0.2866626431739899, 'psi': 0.9512771907244674}-{'f1_val': 0.9543005635836932, 'auprc': 0.9521699366889982, 'loss_val': 0.27911375632365726, 'psi': 0.9534483128258152}
[S5] START round=26 head_norm_before_train=1.553042 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=1.000000 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.8801258127301751, 'loss_val': 0.6602438583270774, 'psi': 0.7723918181982283}-{'f1_val': 0.4171435078150064, 'auprc': 0.7902382401595254, 'loss_val': 0.7522898870766518, 'psi': 0.5663814007528141}
[S6] START round=26 head_norm_before_train=1.260478 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.523423868039998, 'auprc': 0.7809266244955976, 'loss_val': 0.6947021868362686, 'psi': 0.6264249706222378}-{'f1_val': 0.9610198422717251, 'auprc': 0.9761584422750341, 'loss_val': 0.2879659660131433, 'psi': 0.9670752822730487}
[S7] START round=26 head_norm_before_train=1.556590 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.469913161152692, 'auprc': 0.7538685382199879, 'loss_val': 1.115084709566347, 'psi': 0.5834953119796104}-{'f1_val': 0.488005586272222, 'auprc': 0.7350672193758692, 'loss_val': 1.1358777964325524, 'psi': 0.5868302395136809}
[S8] START round=26 head_norm_before_train=1.372988 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9937036553844988, 'auprc': 0.9902888985682403, 'loss_val': 0.12730158152828278, 'psi': 0.9923377526579954}-{'f1_val': 0.991384145019477, 'auprc': 0.9991353587306071, 'loss_val': 0.10920239065437166, 'psi': 0.994484630503929}
[S9] START round=26 head_norm_before_train=1.666009 cos_to_last_merge=0.9996 (last merge round=23)
[S9] round=26 local utility u=0.016048 metrics={'f1_val': 0.9925154678702236, 'auprc': 0.9984291569781638, 'loss_val': 0.04404432416001105, 'psi': 0.9948809435133997}-{'f1_val': 0.9891288930766337, 'auprc': 0.9984379887839094, 'loss_val': 0.055847783666668045, 'psi': 0.992852531359544}
[S10] START round=26 head_norm_before_train=1.545457 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.004931 metrics={'f1_val': 0.9941677348444804, 'auprc': 0.9966931473845264, 'loss_val': 0.058655494646647044, 'psi': 0.9951778998604988}-{'f1_val': 0.9944754122691798, 'auprc': 0.9933411651632046, 'loss_val': 0.060306652589405235, 'psi': 0.9940217134267897}
[S11] START round=26 head_norm_before_train=1.581559 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.005455 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981845643035857, 'loss_val': 0.07188486680288682, 'psi': 0.997202028429588}-{'f1_val': 0.9965470045135896, 'auprc': 0.997916256154413, 'loss_val': 0.0819904999643953, 'psi': 0.9970947051699189}
[S13] START round=26 head_norm_before_train=1.528512 cos_to_last_merge=0.9546 (last merge round=13)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6070096123040308, 'auprc': 0.9188049476812132, 'loss_val': 0.7366829678808152, 'psi': 0.7317277464549038}-{'f1_val': 0.629525840458691, 'auprc': 0.9336177544454409, 'loss_val': 0.5878387977642834, 'psi': 0.7511626060533909}
[S14] START round=26 head_norm_before_train=1.574565 cos_to_last_merge=0.9942 (last merge round=21)
[S14] round=26 local utility u=0.005763 metrics={'f1_val': 0.9974306056599991, 'auprc': 0.9970652298928881, 'loss_val': 0.04723508607258448, 'psi': 0.9972844553531548}-{'f1_val': 0.9972338922372435, 'auprc': 0.9970567265726928, 'loss_val': 0.05755447885298984, 'psi': 0.9971630259714233}
[S15] START round=26 head_norm_before_train=1.296133 cos_to_last_merge=0.9976 (last merge round=24)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7028755115313576, 'auprc': 0.8382252280575487, 'loss_val': 0.42077734906698805, 'psi': 0.757015398141834}-{'f1_val': 0.9924248591659374, 'auprc': 0.9957577496529788, 'loss_val': 0.2701432127009329, 'psi': 0.9937580153607539}
[S16] START round=26 head_norm_before_train=1.456165 cos_to_last_merge=0.9311 (last merge round=13)
[S16] ⚠️ Model drifted since last merge! cos=0.931
[S16] round=26 local utility u=0.691755 metrics={'f1_val': 0.9887218806493279, 'auprc': 0.9860811966641189, 'loss_val': 0.080685028076254, 'psi': 0.9876656070552443}-{'f1_val': 0.850265917321354, 'auprc': 0.9938277088358367, 'loss_val': 0.6566986649554077, 'psi': 0.9076906339271471}
[S17] START round=26 head_norm_before_train=1.388454 cos_to_last_merge=0.9997 (last merge round=24)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.2986723392928834, 'auprc': 0.7948850005154214, 'loss_val': 1.3684356523650707, 'psi': 0.49715740378189865}-{'f1_val': 0.33727202790819333, 'auprc': 0.8919182253857545, 'loss_val': 1.1240590156686745, 'psi': 0.5591305068992178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:51908
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:51907
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:51910
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1807 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:51903
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1807) from S2
[S9] cosine check vs S2: cos=0.9946
[S6] RECEIVED delta(kind=head bytes=1797) from S10
[S6] cosine check vs S10: cos=0.9426
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.9988
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9942 head_norm=1.576497
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.211377e-01
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9944 head_norm=1.432765 delta_norm=0.221138
[S10] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:51915
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] cosine check vs S9: cos=-0.0257
[S3] DROPPED delta from S9 (cos=-0.0257 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:51917
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.4699 head_norm=1.566527
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.271238e-02
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.4676 head_norm=1.584548 delta_norm=0.042712
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.5234 head_norm=1.286527
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.814257e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.5067 head_norm=1.411044 delta_norm=0.281426
[S6] aggregate: ROLLBACK (f1_val pre=0.523 post=0.507 tol_abs=0.005 tol_rel=0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9135
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S16
[S17] cosine check vs S16: cos=0.9452
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:51905
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9925 head_norm=1.677432
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.738506e-02
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9925 head_norm=1.667871 delta_norm=0.087385
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1803 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.7029 head_norm=1.341131
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.205608e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.7002 head_norm=1.419802 delta_norm=0.320561
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] cosine check vs S11: cos=0.9980
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.2987 head_norm=1.410191
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.421703e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.3159 head_norm=1.426878 delta_norm=0.242170
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.7006 head_norm=1.561590
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.634291e-02
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.7006 head_norm=1.586604 delta_norm=0.056343
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.662854 cos_to_last_merge=0.9671 (last merge round=12)
[S2] round=27 local utility u=0.133221 metrics={'f1_val': 0.7014823038224168, 'auprc': 0.7626697238777714, 'loss_val': 0.35103412649707033, 'psi': 0.7259572718445586}-{'f1_val': 0.7010315658334224, 'auprc': 0.6680429331347764, 'loss_val': 0.3308906579975706, 'psi': 0.687836112753964}
[S3] START round=27 head_norm_before_train=1.816119 (no previous merge yet)
[S3] round=27 local utility u=0.149777 metrics={'f1_val': 0.9973956967430226, 'auprc': 0.9991193491658528, 'loss_val': 0.07817052931120506, 'psi': 0.9980851577121547}-{'f1_val': 0.9548069309636095, 'auprc': 0.999120156094345, 'loss_val': 0.12219409805026696, 'psi': 0.9725322210159038}
[S4] START round=27 head_norm_before_train=1.642146 cos_to_last_merge=0.9901 (last merge round=21)
[S4] round=27 local utility u=0.006689 metrics={'f1_val': 0.9479018203993306, 'auprc': 0.9611999912138354, 'loss_val': 0.2838421406506225, 'psi': 0.9532210887251324}-{'f1_val': 0.9505827509122043, 'auprc': 0.9523188504428619, 'loss_val': 0.2866626431739899, 'psi': 0.9512771907244674}
[S5] START round=27 head_norm_before_train=1.586604 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.041180 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.8737654999057227, 'loss_val': 0.5588069296165329, 'psi': 0.7698481607920548}-{'f1_val': 0.7005691551769304, 'auprc': 0.8801258127301751, 'loss_val': 0.6602438583270774, 'psi': 0.7723918181982283}
[S6] START round=27 head_norm_before_train=1.411044 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.628335 metrics={'f1_val': 0.6358913780639135, 'auprc': 0.9399828418282342, 'loss_val': 0.5900066388591112, 'psi': 0.7575279635696418}-{'f1_val': 0.523423868039998, 'auprc': 0.7809266244955976, 'loss_val': 0.6947021868362686, 'psi': 0.6264249706222378}
[S7] START round=27 head_norm_before_train=1.584548 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.760909 metrics={'f1_val': 0.616614772016019, 'auprc': 0.798216867086689, 'loss_val': 0.6065207926123545, 'psi': 0.689255610044287}-{'f1_val': 0.469913161152692, 'auprc': 0.7538685382199879, 'loss_val': 1.115084709566347, 'psi': 0.5834953119796104}
[S8] START round=27 head_norm_before_train=1.407479 cos_to_last_merge=0.9996 (last merge round=25)
[S8] round=27 local utility u=0.028159 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.9984807092695129, 'loss_val': 0.09028756285819206, 'psi': 0.9950872810554164}-{'f1_val': 0.9937036553844988, 'auprc': 0.9902888985682403, 'loss_val': 0.12730158152828278, 'psi': 0.9923377526579954}
[S9] START round=27 head_norm_before_train=1.667871 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.003019 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9928807964501267, 'loss_val': 0.04376982100168422, 'psi': 0.9949023754476173}-{'f1_val': 0.9925154678702236, 'auprc': 0.9984291569781638, 'loss_val': 0.04404432416001105, 'psi': 0.9948809435133997}
[S10] START round=27 head_norm_before_train=1.432765 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9943624847472301, 'auprc': 0.9967307365187809, 'loss_val': 0.07137640163374348, 'psi': 0.9953097854558504}-{'f1_val': 0.9941677348444804, 'auprc': 0.9966931473845264, 'loss_val': 0.058655494646647044, 'psi': 0.9951778998604988}
[S11] START round=27 head_norm_before_train=1.613199 cos_to_last_merge=0.9996 (last merge round=25)
[S11] round=27 local utility u=0.006192 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981001107751843, 'loss_val': 0.05924710561154905, 'psi': 0.9971682470182275}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981845643035857, 'loss_val': 0.07188486680288682, 'psi': 0.997202028429588}
[S13] START round=27 head_norm_before_train=1.538739 cos_to_last_merge=0.9529 (last merge round=13)
[S13] round=27 local utility u=0.120232 metrics={'f1_val': 0.6260946562063721, 'auprc': 0.9267629979447829, 'loss_val': 0.6346039255030509, 'psi': 0.7463619929017364}-{'f1_val': 0.6070096123040308, 'auprc': 0.9188049476812132, 'loss_val': 0.7366829678808152, 'psi': 0.7317277464549038}
[S14] START round=27 head_norm_before_train=1.603504 cos_to_last_merge=0.9922 (last merge round=21)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9934807235898097, 'auprc': 0.99705312207773, 'loss_val': 0.06634776870557946, 'psi': 0.9949096829849778}-{'f1_val': 0.9974306056599991, 'auprc': 0.9970652298928881, 'loss_val': 0.04723508607258448, 'psi': 0.9972844553531548}
[S15] START round=27 head_norm_before_train=1.419802 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.042880 metrics={'f1_val': 0.7114151325132771, 'auprc': 0.8479011000156904, 'loss_val': 0.4152829095924366, 'psi': 0.7660095195142425}-{'f1_val': 0.7028755115313576, 'auprc': 0.8382252280575487, 'loss_val': 0.42077734906698805, 'psi': 0.757015398141834}
[S16] START round=27 head_norm_before_train=1.483447 cos_to_last_merge=0.9279 (last merge round=13)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=27 local utility u=0.025949 metrics={'f1_val': 0.9915877882385774, 'auprc': 0.992684938009823, 'loss_val': 0.06579427440948374, 'psi': 0.9920266481470756}-{'f1_val': 0.9887218806493279, 'auprc': 0.9860811966641189, 'loss_val': 0.080685028076254, 'psi': 0.9876656070552443}
[S17] START round=27 head_norm_before_train=1.426878 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.39278196332149107, 'auprc': 0.7647620870611372, 'loss_val': 2.0554931387135817, 'psi': 0.5415740128173495}-{'f1_val': 0.2986723392928834, 'auprc': 0.7948850005154214, 'loss_val': 1.3684356523650707, 'psi': 0.49715740378189865}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S2] → sending delta(kind=head bytes=1809) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:51910
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:51917
[S2] sending update (kind=head size=1809 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S9] → sending delta(kind=head bytes=1810) to S3@127.0.0.1:51903
[S4] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:51916
[S3] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:51915
[S8] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S16
[S17] cosine check vs S16: cos=0.9849
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] cosine check vs S3: cos=-0.0232
[S9] DROPPED delta from S3 (cos=-0.0232 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S13
[S11] cosine check vs S13: cos=0.9749
[S9] RECEIVED delta(kind=head bytes=1809) from S2
[S9] cosine check vs S2: cos=0.9977
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9868
[S11] RECEIVED delta(kind=head bytes=1805) from S4
[S11] cosine check vs S4: cos=0.9909
[S7] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1810 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:51905
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] cosine check vs S7: cos=-0.0345
[S16] DROPPED delta from S7 (cos=-0.0345 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1810) from S9
[S3] cosine check vs S9: cos=-0.0232
[S3] DROPPED delta from S9 (cos=-0.0232 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:51907
[S11] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] cosine check vs S11: cos=0.9985
[S15] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S15
[S6] cosine check vs S15: cos=0.4869
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9963 head_norm=1.680821
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.656260e-02
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9963 head_norm=1.674970 delta_norm=0.056563
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.3928 head_norm=1.445848
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.400530e-02
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.3914 head_norm=1.449965 delta_norm=0.034005
[S17] aggregate: ACCEPT kept=['S16', 'S8'] (k=2/2) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:51915
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9965 head_norm=1.643571
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.242163e-02
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9965 head_norm=1.611404 delta_norm=0.082422
[S11] aggregate: ACCEPT kept=['S13', 'S4'] (k=2/2) mode=median trim_p=0.1
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.9649
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.7006 head_norm=1.595917
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.999471e-02
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.7006 head_norm=1.619147 delta_norm=0.049995
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S6
[S15] cosine check vs S6: cos=0.4869
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.7114 head_norm=1.454566
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.875688e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.7248 head_norm=1.308424 delta_norm=0.287569
[S15] aggregate: ACCEPT kept=['S5', 'S6'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.6359 head_norm=1.438197
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.326037e-01
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.7337 head_norm=1.247148 delta_norm=0.732604
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.671014 cos_to_last_merge=0.9665 (last merge round=12)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7069770257264352, 'auprc': 0.6689337161983704, 'loss_val': 0.34526211606142326, 'psi': 0.6917597019152093}-{'f1_val': 0.7014823038224168, 'auprc': 0.7626697238777714, 'loss_val': 0.35103412649707033, 'psi': 0.7259572718445586}
[S3] START round=28 head_norm_before_train=1.838918 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.7229364652973485, 'auprc': 0.9988639541810005, 'loss_val': 0.16626540676495996, 'psi': 0.8333074608508093}-{'f1_val': 0.9973956967430226, 'auprc': 0.9991193491658528, 'loss_val': 0.07817052931120506, 'psi': 0.9980851577121547}
[S4] START round=28 head_norm_before_train=1.659015 cos_to_last_merge=0.9884 (last merge round=21)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9373696668708394, 'auprc': 0.9129245938199477, 'loss_val': 0.32613339038173317, 'psi': 0.9275916376504827}-{'f1_val': 0.9479018203993306, 'auprc': 0.9611999912138354, 'loss_val': 0.2838421406506225, 'psi': 0.9532210887251324}
[S5] START round=28 head_norm_before_train=1.619147 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7141740326016373, 'auprc': 0.791329821203031, 'loss_val': 0.5827265704363721, 'psi': 0.7450363480421948}-{'f1_val': 0.7005699347162762, 'auprc': 0.8737654999057227, 'loss_val': 0.5588069296165329, 'psi': 0.7698481607920548}
[S6] START round=28 head_norm_before_train=1.247148 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.740238 metrics={'f1_val': 0.8441338012902998, 'auprc': 0.9693574563949922, 'loss_val': 0.44710962552868416, 'psi': 0.8942232633321767}-{'f1_val': 0.6358913780639135, 'auprc': 0.9399828418282342, 'loss_val': 0.5900066388591112, 'psi': 0.7575279635696418}
[S7] START round=28 head_norm_before_train=1.591589 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=28 local utility u=0.289883 metrics={'f1_val': 0.673575151110597, 'auprc': 0.8208669802070444, 'loss_val': 0.4364680698034924, 'psi': 0.732491882749176}-{'f1_val': 0.616614772016019, 'auprc': 0.798216867086689, 'loss_val': 0.6065207926123545, 'psi': 0.689255610044287}
[S8] START round=28 head_norm_before_train=1.441223 cos_to_last_merge=0.9987 (last merge round=25)
[S8] round=28 local utility u=0.010733 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9980824766965924, 'loss_val': 0.07855185761351169, 'psi': 0.996020569636263}-{'f1_val': 0.9928249955793521, 'auprc': 0.9984807092695129, 'loss_val': 0.09028756285819206, 'psi': 0.9950872810554164}
[S9] START round=28 head_norm_before_train=1.674970 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9899766087340214, 'auprc': 0.9983700154298005, 'loss_val': 0.05766185497204011, 'psi': 0.993333971412333}-{'f1_val': 0.9962500947792776, 'auprc': 0.9928807964501267, 'loss_val': 0.04376982100168422, 'psi': 0.9949023754476173}
[S10] START round=28 head_norm_before_train=1.467307 cos_to_last_merge=0.9998 (last merge round=26)
[S10] round=28 local utility u=0.007856 metrics={'f1_val': 0.9950868285240967, 'auprc': 0.9967409136889485, 'loss_val': 0.060040584536870015, 'psi': 0.9957484625900374}-{'f1_val': 0.9943624847472301, 'auprc': 0.9967307365187809, 'loss_val': 0.07137640163374348, 'psi': 0.9953097854558504}
[S11] START round=28 head_norm_before_train=1.611404 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9974652767387722, 'loss_val': 0.07184676458784654, 'psi': 0.9966663156434945}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981001107751843, 'loss_val': 0.05924710561154905, 'psi': 0.9971682470182275}
[S13] START round=28 head_norm_before_train=1.546360 cos_to_last_merge=0.9522 (last merge round=13)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6118960021658633, 'auprc': 0.9312738074289701, 'loss_val': 0.683789400991563, 'psi': 0.739647124271106}-{'f1_val': 0.6260946562063721, 'auprc': 0.9267629979447829, 'loss_val': 0.6346039255030509, 'psi': 0.7463619929017364}
[S14] START round=28 head_norm_before_train=1.630181 cos_to_last_merge=0.9902 (last merge round=21)
[S14] round=28 local utility u=0.013424 metrics={'f1_val': 0.9949791102532123, 'auprc': 0.9969592757247834, 'loss_val': 0.04820929719685512, 'psi': 0.9957711764418407}-{'f1_val': 0.9934807235898097, 'auprc': 0.99705312207773, 'loss_val': 0.06634776870557946, 'psi': 0.9949096829849778}
[S15] START round=28 head_norm_before_train=1.308424 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=1.000000 metrics={'f1_val': 0.9948263292880074, 'auprc': 0.9950402751225078, 'loss_val': 0.1547256431986053, 'psi': 0.9949119076218076}-{'f1_val': 0.7114151325132771, 'auprc': 0.8479011000156904, 'loss_val': 0.4152829095924366, 'psi': 0.7660095195142425}
[S16] START round=28 head_norm_before_train=1.507162 cos_to_last_merge=0.9251 (last merge round=13)
[S16] ⚠️ Model drifted since last merge! cos=0.925
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.990413545719282, 'auprc': 0.9929367568537137, 'loss_val': 0.06407588653532793, 'psi': 0.9914228301730548}-{'f1_val': 0.9915877882385774, 'auprc': 0.992684938009823, 'loss_val': 0.06579427440948374, 'psi': 0.9920266481470756}
[S17] START round=28 head_norm_before_train=1.449965 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.848546 metrics={'f1_val': 0.5420367854449644, 'auprc': 0.8117057046873583, 'loss_val': 1.3947617316440428, 'psi': 0.649904353141922}-{'f1_val': 0.39278196332149107, 'auprc': 0.7647620870611372, 'loss_val': 2.0554931387135817, 'psi': 0.5415740128173495}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:51917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:51907
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:51915
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:51914
[S7] RECEIVED delta(kind=head bytes=1805) from S14
[S7] cosine check vs S14: cos=0.9984
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=0.8451
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9838
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:51916
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1795) from S6
[S15] cosine check vs S6: cos=0.9395
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.9984
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:51907
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S17
[S16] cosine check vs S17: cos=0.9847
[S15] sending update (kind=head size=1806 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1806) from S15
[S6] cosine check vs S15: cos=0.9395
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.8441 head_norm=1.269779
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.682656e-02
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.8523 head_norm=1.275305 delta_norm=0.096827
[S6] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6736 head_norm=1.597477
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.383727e-02
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.6652 head_norm=1.623965 delta_norm=0.053837
[S7] aggregate: ROLLBACK (f1_val pre=0.674 post=0.665 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.9948 head_norm=1.357398
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.324286e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.9952 head_norm=1.293604 delta_norm=0.232429
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.5420 head_norm=1.469898
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.325746e-01
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.5332 head_norm=1.468225 delta_norm=0.132575
[S17] aggregate: ROLLBACK (f1_val pre=0.542 post=0.533 tol_abs=0.005 tol_rel=0.0)
[S2] START round=29 head_norm_before_train=1.679552 cos_to_last_merge=0.9657 (last merge round=12)
[S2] round=29 local utility u=0.109936 metrics={'f1_val': 0.7014850359349303, 'auprc': 0.7530668802091527, 'loss_val': 0.3448377728878841, 'psi': 0.7221177736446193}-{'f1_val': 0.7069770257264352, 'auprc': 0.6689337161983704, 'loss_val': 0.34526211606142326, 'psi': 0.6917597019152093}
[S3] START round=29 head_norm_before_train=1.857597 (no previous merge yet)
[S3] round=29 local utility u=0.879801 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9992345773683247, 'loss_val': 0.05718998976834134, 'psi': 0.9983971874272172}-{'f1_val': 0.7229364652973485, 'auprc': 0.9988639541810005, 'loss_val': 0.16626540676495996, 'psi': 0.8333074608508093}
[S4] START round=29 head_norm_before_train=1.674068 cos_to_last_merge=0.9868 (last merge round=21)
[S4] round=29 local utility u=0.053498 metrics={'f1_val': 0.9406651441789906, 'auprc': 0.9364945311283397, 'loss_val': 0.30961980353403956, 'psi': 0.9389968989587303}-{'f1_val': 0.9373696668708394, 'auprc': 0.9129245938199477, 'loss_val': 0.32613339038173317, 'psi': 0.9275916376504827}
[S5] START round=29 head_norm_before_train=1.627311 cos_to_last_merge=0.9998 (last merge round=27)
[S5] round=29 local utility u=0.337583 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9918360189333401, 'loss_val': 0.42744959811895034, 'psi': 0.8170759006794943}-{'f1_val': 0.7141740326016373, 'auprc': 0.791329821203031, 'loss_val': 0.5827265704363721, 'psi': 0.7450363480421948}
[S6] START round=29 head_norm_before_train=1.275305 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.7182980719898608, 'auprc': 0.9321100700219065, 'loss_val': 0.4166467408307281, 'psi': 0.8038228712026791}-{'f1_val': 0.8441338012902998, 'auprc': 0.9693574563949922, 'loss_val': 0.44710962552868416, 'psi': 0.8942232633321767}
[S7] START round=29 head_norm_before_train=1.623965 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5513731295101676, 'auprc': 0.7747102568552486, 'loss_val': 0.9370180556830287, 'psi': 0.6407079804482001}-{'f1_val': 0.673575151110597, 'auprc': 0.8208669802070444, 'loss_val': 0.4364680698034924, 'psi': 0.732491882749176}
[S8] START round=29 head_norm_before_train=1.478486 cos_to_last_merge=0.9972 (last merge round=25)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9935219944084961, 'auprc': 0.9976744506213662, 'loss_val': 0.07449943775689222, 'psi': 0.9951829768936442}-{'f1_val': 0.9946459649293765, 'auprc': 0.9980824766965924, 'loss_val': 0.07855185761351169, 'psi': 0.996020569636263}
[S9] START round=29 head_norm_before_train=1.688045 cos_to_last_merge=0.9999 (last merge round=27)
[S9] round=29 local utility u=0.027719 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9975135694274144, 'loss_val': 0.039930184026078785, 'psi': 0.9970189167496689}-{'f1_val': 0.9899766087340214, 'auprc': 0.9983700154298005, 'loss_val': 0.05766185497204011, 'psi': 0.993333971412333}
[S10] START round=29 head_norm_before_train=1.504665 cos_to_last_merge=0.9991 (last merge round=26)
[S10] round=29 local utility u=0.002026 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9945566626287745, 'loss_val': 0.05207115135717676, 'psi': 0.9951382100059769}-{'f1_val': 0.9950868285240967, 'auprc': 0.9967409136889485, 'loss_val': 0.060040584536870015, 'psi': 0.9957484625900374}
[S11] START round=29 head_norm_before_train=1.639671 cos_to_last_merge=0.9998 (last merge round=27)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.8563762392012391, 'auprc': 0.9961988215881511, 'loss_val': 0.19300811822810124, 'psi': 0.9123052721560039}-{'f1_val': 0.9961336749133093, 'auprc': 0.9974652767387722, 'loss_val': 0.07184676458784654, 'psi': 0.9966663156434945}
[S13] START round=29 head_norm_before_train=1.552466 cos_to_last_merge=0.9511 (last merge round=13)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5738925482248872, 'auprc': 0.8916518027218501, 'loss_val': 0.9093523848924835, 'psi': 0.7009962500236724}-{'f1_val': 0.6118960021658633, 'auprc': 0.9312738074289701, 'loss_val': 0.683789400991563, 'psi': 0.739647124271106}
[S14] START round=29 head_norm_before_train=1.651783 cos_to_last_merge=0.9883 (last merge round=21)
[S14] round=29 local utility u=0.013161 metrics={'f1_val': 0.9972626935085508, 'auprc': 0.9970590832436586, 'loss_val': 0.03588783595482313, 'psi': 0.997181249402594}-{'f1_val': 0.9949791102532123, 'auprc': 0.9969592757247834, 'loss_val': 0.04820929719685512, 'psi': 0.9957711764418407}
[S15] START round=29 head_norm_before_train=1.293604 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.6995409746811546, 'auprc': 0.8407375260840084, 'loss_val': 0.4363290309478207, 'psi': 0.7560195952422961}-{'f1_val': 0.9948263292880074, 'auprc': 0.9950402751225078, 'loss_val': 0.1547256431986053, 'psi': 0.9949119076218076}
[S16] START round=29 head_norm_before_train=1.530336 cos_to_last_merge=0.9226 (last merge round=13)
[S16] ⚠️ Model drifted since last merge! cos=0.923
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.9087469104883306, 'auprc': 0.9921850620867441, 'loss_val': 0.4156068941568514, 'psi': 0.9421221711276959}-{'f1_val': 0.990413545719282, 'auprc': 0.9929367568537137, 'loss_val': 0.06407588653532793, 'psi': 0.9914228301730548}
[S17] START round=29 head_norm_before_train=1.468225 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.301313 metrics={'f1_val': 0.6102933879411125, 'auprc': 0.7856461480369742, 'loss_val': 1.1234973473610297, 'psi': 0.6804344919794572}-{'f1_val': 0.5420367854449644, 'auprc': 0.8117057046873583, 'loss_val': 1.3947617316440428, 'psi': 0.649904353141922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:51907
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:51910
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:51912
[S14] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:51903
[S3] sending update (kind=head size=1797 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9087 head_norm=1.550725
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.408237e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9081 head_norm=1.504275 delta_norm=0.140824
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S10
[S6] cosine check vs S10: cos=0.8872
[S9] RECEIVED delta(kind=head bytes=1797) from S3
[S9] cosine check vs S3: cos=-0.0282
[S9] DROPPED delta from S3 (cos=-0.0282 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.9991
[S11] RECEIVED delta(kind=head bytes=1805) from S4
[S11] cosine check vs S4: cos=0.9883
[S9] sending update (kind=head size=1804 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:51916
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9973 head_norm=1.673238
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.721338e-02
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9973 head_norm=1.634415 delta_norm=0.067213
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] cosine check vs S9: cos=-0.0282
[S3] DROPPED delta from S9 (cos=-0.0282 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.5514 head_norm=1.632616
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.012504e-02
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.5494 head_norm=1.652565 delta_norm=0.040125
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.7183 head_norm=1.307282
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.567074e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.7672 head_norm=1.383603 delta_norm=0.356707
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S17
[S16] cosine check vs S17: cos=0.9840
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.8564 head_norm=1.664682
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.283434e-01
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.8543 head_norm=1.669969 delta_norm=0.128343
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.689054 cos_to_last_merge=0.9649 (last merge round=12)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.7088264685305906, 'auprc': 0.686217680644506, 'loss_val': 0.36089930602316084, 'psi': 0.6997829533761568}-{'f1_val': 0.7014850359349303, 'auprc': 0.7530668802091527, 'loss_val': 0.3448377728878841, 'psi': 0.7221177736446193}
[S3] START round=30 head_norm_before_train=1.873829 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9808347385591735, 'auprc': 0.9988321155404045, 'loss_val': 0.06797542154912853, 'psi': 0.9880336893516659}-{'f1_val': 0.9978389274664787, 'auprc': 0.9992345773683247, 'loss_val': 0.05718998976834134, 'psi': 0.9983971874272172}
[S4] START round=30 head_norm_before_train=1.685044 cos_to_last_merge=0.9857 (last merge round=21)
[S4] round=30 local utility u=0.025552 metrics={'f1_val': 0.9418256589268468, 'auprc': 0.9499270238717565, 'loss_val': 0.3057764284390456, 'psi': 0.9450662049048107}-{'f1_val': 0.9406651441789906, 'auprc': 0.9364945311283397, 'loss_val': 0.30961980353403956, 'psi': 0.9389968989587303}
[S5] START round=30 head_norm_before_train=1.637103 cos_to_last_merge=0.9994 (last merge round=27)
[S5] round=30 local utility u=0.021345 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9918486606789902, 'loss_val': 0.38479689140245965, 'psi': 0.8170809573777544}-{'f1_val': 0.7005691551769304, 'auprc': 0.9918360189333401, 'loss_val': 0.42744959811895034, 'psi': 0.8170759006794943}
[S6] START round=30 head_norm_before_train=1.383603 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.073747 metrics={'f1_val': 0.8185724157090317, 'auprc': 0.8019111275811055, 'loss_val': 0.4802023461220734, 'psi': 0.8119079004578612}-{'f1_val': 0.7182980719898608, 'auprc': 0.9321100700219065, 'loss_val': 0.4166467408307281, 'psi': 0.8038228712026791}
[S7] START round=30 head_norm_before_train=1.652565 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.434732 metrics={'f1_val': 0.6311472238282563, 'auprc': 0.7992485553735273, 'loss_val': 0.6198130318198424, 'psi': 0.6983877564463647}-{'f1_val': 0.5513731295101676, 'auprc': 0.7747102568552486, 'loss_val': 0.9370180556830287, 'psi': 0.6407079804482001}
[S8] START round=30 head_norm_before_train=1.509960 cos_to_last_merge=0.9956 (last merge round=25)
[S8] round=30 local utility u=0.001549 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9991831526259678, 'loss_val': 0.0656616698120585, 'psi': 0.994759841748093}-{'f1_val': 0.9935219944084961, 'auprc': 0.9976744506213662, 'loss_val': 0.07449943775689222, 'psi': 0.9951829768936442}
[S9] START round=30 head_norm_before_train=1.702091 cos_to_last_merge=0.9994 (last merge round=27)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9926752747317622, 'loss_val': 0.0366940551026002, 'psi': 0.9953318573999905}-{'f1_val': 0.9966891482978385, 'auprc': 0.9975135694274144, 'loss_val': 0.039930184026078785, 'psi': 0.9970189167496689}
[S10] START round=30 head_norm_before_train=1.540846 cos_to_last_merge=0.9981 (last merge round=26)
[S10] round=30 local utility u=0.002490 metrics={'f1_val': 0.9946480472226495, 'auprc': 0.9967626834290909, 'loss_val': 0.04844240260882519, 'psi': 0.9954939017052261}-{'f1_val': 0.9955259082574451, 'auprc': 0.9945566626287745, 'loss_val': 0.05207115135717676, 'psi': 0.9951382100059769}
[S11] START round=30 head_norm_before_train=1.669969 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.489655 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9976883155392604, 'loss_val': 0.056711113422332114, 'psi': 0.9967555311636898}-{'f1_val': 0.8563762392012391, 'auprc': 0.9961988215881511, 'loss_val': 0.19300811822810124, 'psi': 0.9123052721560039}
[S13] START round=30 head_norm_before_train=1.561510 cos_to_last_merge=0.9498 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.950
[S13] round=30 local utility u=0.451450 metrics={'f1_val': 0.6374646709187481, 'auprc': 0.9293258841284252, 'loss_val': 0.500907234787233, 'psi': 0.754209156202619}-{'f1_val': 0.5738925482248872, 'auprc': 0.8916518027218501, 'loss_val': 0.9093523848924835, 'psi': 0.7009962500236724}
[S14] START round=30 head_norm_before_train=1.634415 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9970567093919698, 'loss_val': 0.03985706868587759, 'psi': 0.9969207318521147}-{'f1_val': 0.9972626935085508, 'auprc': 0.9970590832436586, 'loss_val': 0.03588783595482313, 'psi': 0.997181249402594}
[S15] START round=30 head_norm_before_train=1.343182 cos_to_last_merge=0.9989 (last merge round=28)
[S15] round=30 local utility u=0.512881 metrics={'f1_val': 0.7727019577085479, 'auprc': 0.9868856237093395, 'loss_val': 0.28797742790881264, 'psi': 0.8583754241088646}-{'f1_val': 0.6995409746811546, 'auprc': 0.8407375260840084, 'loss_val': 0.4363290309478207, 'psi': 0.7560195952422961}
[S16] START round=30 head_norm_before_train=1.504275 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.069188 metrics={'f1_val': 0.9194649475993562, 'auprc': 0.9936327479908142, 'loss_val': 0.3458827816929858, 'psi': 0.9491320677559394}-{'f1_val': 0.9087469104883306, 'auprc': 0.9921850620867441, 'loss_val': 0.4156068941568514, 'psi': 0.9421221711276959}
[S17] START round=30 head_norm_before_train=1.489168 cos_to_last_merge=0.9998 (last merge round=28)
[S17] round=30 local utility u=0.012214 metrics={'f1_val': 0.6070985147452259, 'auprc': 0.8133749705895728, 'loss_val': 1.1630867655846282, 'psi': 0.6896090970829647}-{'f1_val': 0.6102933879411125, 'auprc': 0.7856461480369742, 'loss_val': 1.1234973473610297, 'psi': 0.6804344919794572}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:51912
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:51907
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.224 → S9@127.0.0.1:51910
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.9195 head_norm=1.522566
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.393282e-01
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.9197 head_norm=1.499501 delta_norm=0.139328
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:51914
[S8] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:51915
[S14] ⇄ pheromone p=0.016 → S7@127.0.0.1:51908
[S6] RECEIVED delta(kind=head bytes=1800) from S10
[S6] cosine check vs S10: cos=0.9758
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.9921
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] cosine check vs S4: cos=0.9963
[S10] ⇄ pheromone p=0.018 → S6@127.0.0.1:51907
[S4] ⇄ pheromone p=0.033 → S11@127.0.0.1:51912
[S6] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:51916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S8] ⇄ pheromone p=0.043 → S17@127.0.0.1:51917
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1802) from S6
[S15] cosine check vs S6: cos=0.8712
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:51907
[S9] ⇄ pheromone p=0.032 → S3@127.0.0.1:51903
[S17] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=0.9622
[S16] RECEIVED delta(kind=head bytes=1803) from S17
[S16] cosine check vs S17: cos=0.9952
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S15
[S6] cosine check vs S15: cos=0.8712
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.8186 head_norm=1.416658
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.017642e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.8206 head_norm=1.395875 delta_norm=0.101764
[S6] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.374 → S15@127.0.0.1:51915
[S7] ⇄ pheromone p=0.262 → S14@127.0.0.1:51914
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.7727 head_norm=1.376907
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.550270e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.7746 head_norm=1.351056 delta_norm=0.355027
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.376 → S6@127.0.0.1:51907
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.9961 head_norm=1.693660
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.319684e-02
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.9961 head_norm=1.692351 delta_norm=0.073197
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.129 → S13@127.0.0.1:51913
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.6071 head_norm=1.508835
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.636988e-02
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.6084 head_norm=1.517779 delta_norm=0.096370
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.226 → S16@127.0.0.1:51916
[S2] START round=31 head_norm_before_train=1.697803 cos_to_last_merge=0.9641 (last merge round=12)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.7089059418112323, 'auprc': 0.6836348437003295, 'loss_val': 0.35714176909361084, 'psi': 0.6987975025668711}-{'f1_val': 0.7088264685305906, 'auprc': 0.686217680644506, 'loss_val': 0.36089930602316084, 'psi': 0.6997829533761568}
[S3] START round=31 head_norm_before_train=1.888892 (no previous merge yet)
[S3] round=31 local utility u=0.057457 metrics={'f1_val': 0.9973956967430226, 'auprc': 0.998857247641762, 'loss_val': 0.0525027148337712, 'psi': 0.9979803171025183}-{'f1_val': 0.9808347385591735, 'auprc': 0.9988321155404045, 'loss_val': 0.06797542154912853, 'psi': 0.9880336893516659}
[S4] START round=31 head_norm_before_train=1.694207 cos_to_last_merge=0.9847 (last merge round=21)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.939050724082296, 'auprc': 0.9419669283929784, 'loss_val': 0.3089810543370505, 'psi': 0.940217205806569}-{'f1_val': 0.9418256589268468, 'auprc': 0.9499270238717565, 'loss_val': 0.3057764284390456, 'psi': 0.9450662049048107}
[S5] START round=31 head_norm_before_train=1.648453 cos_to_last_merge=0.9987 (last merge round=27)
[S5] round=31 local utility u=0.012341 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9918440005292294, 'loss_val': 0.35861365601594825, 'psi': 0.81693039067204}-{'f1_val': 0.7005691551769304, 'auprc': 0.9918486606789902, 'loss_val': 0.38479689140245965, 'psi': 0.8170809573777544}
[S6] START round=31 head_norm_before_train=1.395875 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.286997 metrics={'f1_val': 0.8224003232941413, 'auprc': 0.9622002027504721, 'loss_val': 0.4100423837274692, 'psi': 0.8783202750766737}-{'f1_val': 0.8185724157090317, 'auprc': 0.8019111275811055, 'loss_val': 0.4802023461220734, 'psi': 0.8119079004578612}
[S7] START round=31 head_norm_before_train=1.663725 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.615512541836463, 'auprc': 0.7962541298113899, 'loss_val': 0.596741096978944, 'psi': 0.6878091770264337}-{'f1_val': 0.6311472238282563, 'auprc': 0.7992485553735273, 'loss_val': 0.6198130318198424, 'psi': 0.6983877564463647}
[S8] START round=31 head_norm_before_train=1.532741 cos_to_last_merge=0.9942 (last merge round=25)
[S8] round=31 local utility u=0.010181 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9981560305161608, 'loss_val': 0.05922749476429088, 'psi': 0.9960499911640902}-{'f1_val': 0.9918109678295097, 'auprc': 0.9991831526259678, 'loss_val': 0.0656616698120585, 'psi': 0.994759841748093}
[S9] START round=31 head_norm_before_train=1.716727 cos_to_last_merge=0.9988 (last merge round=27)
[S9] round=31 local utility u=0.005905 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9952582890053212, 'loss_val': 0.032632456827625805, 'psi': 0.9963650631094142}-{'f1_val': 0.9971029125121428, 'auprc': 0.9926752747317622, 'loss_val': 0.0366940551026002, 'psi': 0.9953318573999905}
[S10] START round=31 head_norm_before_train=1.574806 cos_to_last_merge=0.9970 (last merge round=26)
[S10] round=31 local utility u=0.002345 metrics={'f1_val': 0.9946480472226495, 'auprc': 0.9967641143391597, 'loss_val': 0.043757121327300204, 'psi': 0.9954944740692536}-{'f1_val': 0.9946480472226495, 'auprc': 0.9967626834290909, 'loss_val': 0.04844240260882519, 'psi': 0.9954939017052261}
[S11] START round=31 head_norm_before_train=1.692351 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.006958 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979155138406272, 'loss_val': 0.04595572034459129, 'psi': 0.9970944082444047}-{'f1_val': 0.9961336749133093, 'auprc': 0.9976883155392604, 'loss_val': 0.056711113422332114, 'psi': 0.9967555311636898}
[S13] START round=31 head_norm_before_train=1.569378 cos_to_last_merge=0.9485 (last merge round=13)
[S13] ⚠️ Model drifted since last merge! cos=0.948
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5931211946444456, 'auprc': 0.7525238854905573, 'loss_val': 0.7719901732667209, 'psi': 0.6568822709828903}-{'f1_val': 0.6374646709187481, 'auprc': 0.9293258841284252, 'loss_val': 0.500907234787233, 'psi': 0.754209156202619}
[S14] START round=31 head_norm_before_train=1.655679 cos_to_last_merge=0.9999 (last merge round=29)
[S14] round=31 local utility u=0.005452 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9984162356790227, 'loss_val': 0.03549248546083159, 'psi': 0.9977107082950849}-{'f1_val': 0.9968300801588782, 'auprc': 0.9970567093919698, 'loss_val': 0.03985706868587759, 'psi': 0.9969207318521147}
[S15] START round=31 head_norm_before_train=1.351056 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.778264 metrics={'f1_val': 0.9942062447313059, 'auprc': 0.9926311445744578, 'loss_val': 0.07771270051935238, 'psi': 0.9935762046685667}-{'f1_val': 0.7727019577085479, 'auprc': 0.9868856237093395, 'loss_val': 0.28797742790881264, 'psi': 0.8583754241088646}
[S16] START round=31 head_norm_before_train=1.499501 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9055084105666749, 'auprc': 0.9929257319204291, 'loss_val': 0.404284096012148, 'psi': 0.9404753391081766}-{'f1_val': 0.9194649475993562, 'auprc': 0.9936327479908142, 'loss_val': 0.3458827816929858, 'psi': 0.9491320677559394}
[S17] START round=31 head_norm_before_train=1.517779 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5535857298605914, 'auprc': 0.7210066200657027, 'loss_val': 1.425486289048686, 'psi': 0.620554085942636}-{'f1_val': 0.6070985147452259, 'auprc': 0.8133749705895728, 'loss_val': 1.1630867655846282, 'psi': 0.6896090970829647}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:51907
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:51917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:51915
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.9055 head_norm=1.519884
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.985363e-02
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.9055 head_norm=1.512263 delta_norm=0.079854
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=31 metric=0.5931 head_norm=1.574849
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.341276e-01
[S13] stored merged vector for next round verification (round=31)
[S13] DEBUG after merge:  round=31 metric=0.5925 head_norm=1.618487 delta_norm=0.234128
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:51903
[S10] sending update (kind=head size=1806 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=-0.0347
[S9] DROPPED delta from S3 (cos=-0.0347 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1806) from S10
[S6] cosine check vs S10: cos=0.9632
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9965
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.9997
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:51907
[S9] sending update (kind=head size=1802 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9972 head_norm=1.677037
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.631694e-02
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9972 head_norm=1.670314 delta_norm=0.016317
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] cosine check vs S6: cos=0.9800
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] cosine check vs S9: cos=-0.0347
[S3] DROPPED delta from S9 (cos=-0.0347 < 0.0)
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S15
[S6] cosine check vs S15: cos=0.9800
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.6155 head_norm=1.674579
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.007790e-02
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.6129 head_norm=1.675688 delta_norm=0.020078
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] cosine check vs S11: cos=0.9862
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.8224 head_norm=1.424220
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.294219e-02
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.8224 head_norm=1.437043 delta_norm=0.052942
[S6] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9942 head_norm=1.373736
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.419978e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.9942 head_norm=1.391982 delta_norm=0.141998
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.5536 head_norm=1.539182
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.543870e-02
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.5523 head_norm=1.546288 delta_norm=0.065439
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.706408 cos_to_last_merge=0.9633 (last merge round=12)
[S2] round=32 local utility u=0.182090 metrics={'f1_val': 0.7088286011885111, 'auprc': 0.8039158188337678, 'loss_val': 0.3533412577593488, 'psi': 0.7468634882466139}-{'f1_val': 0.7089059418112323, 'auprc': 0.6836348437003295, 'loss_val': 0.35714176909361084, 'psi': 0.6987975025668711}
[S3] START round=32 head_norm_before_train=1.905458 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9351504953348844, 'auprc': 0.9991545386381662, 'loss_val': 0.12608765045471035, 'psi': 0.9607521126561971}-{'f1_val': 0.9973956967430226, 'auprc': 0.998857247641762, 'loss_val': 0.0525027148337712, 'psi': 0.9979803171025183}
[S4] START round=32 head_norm_before_train=1.705007 cos_to_last_merge=0.9836 (last merge round=21)
[S4] round=32 local utility u=0.060141 metrics={'f1_val': 0.9452116058139193, 'auprc': 0.9651373239668415, 'loss_val': 0.29517509675279435, 'psi': 0.9531818930750882}-{'f1_val': 0.939050724082296, 'auprc': 0.9419669283929784, 'loss_val': 0.3089810543370505, 'psi': 0.940217205806569}
[S5] START round=32 head_norm_before_train=1.658634 cos_to_last_merge=0.9979 (last merge round=27)
[S5] round=32 local utility u=0.004732 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9918408816186874, 'loss_val': 0.3491359712811758, 'psi': 0.8169287117422903}-{'f1_val': 0.7003213174339138, 'auprc': 0.9918440005292294, 'loss_val': 0.35861365601594825, 'psi': 0.81693039067204}
[S6] START round=32 head_norm_before_train=1.437043 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.6421537771729862, 'auprc': 0.8025501389821531, 'loss_val': 0.5884789086607561, 'psi': 0.7063123218966529}-{'f1_val': 0.8224003232941413, 'auprc': 0.9622002027504721, 'loss_val': 0.4100423837274692, 'psi': 0.8783202750766737}
[S7] START round=32 head_norm_before_train=1.675688 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.6016595829650566, 'auprc': 0.7922701661496734, 'loss_val': 0.6681565446066281, 'psi': 0.6779038162389033}-{'f1_val': 0.615512541836463, 'auprc': 0.7962541298113899, 'loss_val': 0.596741096978944, 'psi': 0.6878091770264337}
[S8] START round=32 head_norm_before_train=1.556114 cos_to_last_merge=0.9927 (last merge round=25)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.9984685190284124, 'loss_val': 0.05474559196439653, 'psi': 0.9950824049589762}-{'f1_val': 0.9946459649293765, 'auprc': 0.9981560305161608, 'loss_val': 0.05922749476429088, 'psi': 0.9960499911640902}
[S9] START round=32 head_norm_before_train=1.731880 cos_to_last_merge=0.9980 (last merge round=27)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9984138115853548, 'loss_val': 0.033935045827217104, 'psi': 0.9958793484844815}-{'f1_val': 0.9971029125121428, 'auprc': 0.9952582890053212, 'loss_val': 0.032632456827625805, 'psi': 0.9963650631094142}
[S10] START round=32 head_norm_before_train=1.608868 cos_to_last_merge=0.9958 (last merge round=26)
[S10] round=32 local utility u=0.002586 metrics={'f1_val': 0.9948674007110037, 'auprc': 0.996757766991714, 'loss_val': 0.039882347005545736, 'psi': 0.9956235472232878}-{'f1_val': 0.9946480472226495, 'auprc': 0.9967641143391597, 'loss_val': 0.043757121327300204, 'psi': 0.9954944740692536}
[S11] START round=32 head_norm_before_train=1.714751 cos_to_last_merge=0.9999 (last merge round=30)
[S11] round=32 local utility u=0.002823 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981506694908623, 'loss_val': 0.04101432577378075, 'psi': 0.9971884705044987}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979155138406272, 'loss_val': 0.04595572034459129, 'psi': 0.9970944082444047}
[S13] START round=32 head_norm_before_train=1.618487 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=32 local utility u=0.425938 metrics={'f1_val': 0.6228383713155365, 'auprc': 0.9278087802717127, 'loss_val': 0.6242716215343193, 'psi': 0.744826534898007}-{'f1_val': 0.5931211946444456, 'auprc': 0.7525238854905573, 'loss_val': 0.7719901732667209, 'psi': 0.6568822709828903}
[S14] START round=32 head_norm_before_train=1.670314 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9968503419529617, 'loss_val': 0.03424362439551896, 'psi': 0.9970843508046605}-{'f1_val': 0.997240356705793, 'auprc': 0.9984162356790227, 'loss_val': 0.03549248546083159, 'psi': 0.9977107082950849}
[S15] START round=32 head_norm_before_train=1.391982 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.7571401695171762, 'auprc': 0.9882683400086112, 'loss_val': 0.33838450607130327, 'psi': 0.8495914377137501}-{'f1_val': 0.9942062447313059, 'auprc': 0.9926311445744578, 'loss_val': 0.07771270051935238, 'psi': 0.9935762046685667}
[S16] START round=32 head_norm_before_train=1.512263 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.8768867700235545, 'auprc': 0.9923139217030676, 'loss_val': 0.5287074545803901, 'psi': 0.9230576306953597}-{'f1_val': 0.9055084105666749, 'auprc': 0.9929257319204291, 'loss_val': 0.404284096012148, 'psi': 0.9404753391081766}
[S17] START round=32 head_norm_before_train=1.546288 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.074223 metrics={'f1_val': 0.5750120058985588, 'auprc': 0.7415627002430538, 'loss_val': 1.4672667841300147, 'psi': 0.6416322836363568}-{'f1_val': 0.5535857298605914, 'auprc': 0.7210066200657027, 'loss_val': 1.425486289048686, 'psi': 0.620554085942636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:51912
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:51912
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1806 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1803) from S13
[S11] cosine check vs S13: cos=0.9852
[S6] RECEIVED delta(kind=head bytes=1799) from S10
[S6] cosine check vs S10: cos=0.9708
[S11] RECEIVED delta(kind=head bytes=1806) from S4
[S11] cosine check vs S4: cos=0.9978
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.6228 head_norm=1.625345
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.485678e-01
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.6224 head_norm=1.664027 delta_norm=0.148568
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:51916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.6422 head_norm=1.464807
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.068408e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.6422 head_norm=1.541347 delta_norm=0.206841
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S17
[S16] cosine check vs S17: cos=0.9894
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:51913
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S11
[S13] cosine check vs S11: cos=0.9964
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9965 head_norm=1.733956
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.585258e-02
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9965 head_norm=1.695443 delta_norm=0.075853
[S11] aggregate: ACCEPT kept=['S13', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.716932 cos_to_last_merge=0.9623 (last merge round=12)
[S2] round=33 local utility u=0.052012 metrics={'f1_val': 0.7088277998969983, 'auprc': 0.8485205305095018, 'loss_val': 0.38312608247061, 'psi': 0.7647048921419997}-{'f1_val': 0.7088286011885111, 'auprc': 0.8039158188337678, 'loss_val': 0.3533412577593488, 'psi': 0.7468634882466139}
[S3] START round=33 head_norm_before_train=1.919972 (no previous merge yet)
[S3] round=33 local utility u=0.229052 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9988553068817358, 'loss_val': 0.043216645040252015, 'psi': 0.9982454792325817}-{'f1_val': 0.9351504953348844, 'auprc': 0.9991545386381662, 'loss_val': 0.12608765045471035, 'psi': 0.9607521126561971}
[S4] START round=33 head_norm_before_train=1.711431 cos_to_last_merge=0.9831 (last merge round=21)
[S4] round=33 local utility u=0.026673 metrics={'f1_val': 0.9546285141800787, 'auprc': 0.9642543183051246, 'loss_val': 0.2956824842602705, 'psi': 0.9584788358300971}-{'f1_val': 0.9452116058139193, 'auprc': 0.9651373239668415, 'loss_val': 0.29517509675279435, 'psi': 0.9531818930750882}
[S5] START round=33 head_norm_before_train=1.667349 cos_to_last_merge=0.9973 (last merge round=27)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8842714904608421, 'loss_val': 0.3655604293834559, 'psi': 0.7739009552791523}-{'f1_val': 0.700320598491359, 'auprc': 0.9918408816186874, 'loss_val': 0.3491359712811758, 'psi': 0.8169287117422903}
[S6] START round=33 head_norm_before_train=1.541347 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=1.000000 metrics={'f1_val': 0.9613382083238537, 'auprc': 0.9730385394042359, 'loss_val': 0.21365529890312002, 'psi': 0.9660183407560066}-{'f1_val': 0.6421537771729862, 'auprc': 0.8025501389821531, 'loss_val': 0.5884789086607561, 'psi': 0.7063123218966529}
[S7] START round=33 head_norm_before_train=1.685410 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.5961586520929624, 'auprc': 0.7875315789285007, 'loss_val': 0.809121468927006, 'psi': 0.6727078228271777}-{'f1_val': 0.6016595829650566, 'auprc': 0.7922701661496734, 'loss_val': 0.6681565446066281, 'psi': 0.6779038162389033}
[S8] START round=33 head_norm_before_train=1.575603 cos_to_last_merge=0.9915 (last merge round=25)
[S8] round=33 local utility u=0.001803 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.9986304496597016, 'loss_val': 0.0516253472689311, 'psi': 0.9951471772114919}-{'f1_val': 0.9928249955793521, 'auprc': 0.9984685190284124, 'loss_val': 0.05474559196439653, 'psi': 0.9950824049589762}
[S9] START round=33 head_norm_before_train=1.746573 cos_to_last_merge=0.9972 (last merge round=27)
[S9] round=33 local utility u=0.010438 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984093854989768, 'loss_val': 0.027871080904141594, 'psi': 0.9973600612879256}-{'f1_val': 0.9941897064172326, 'auprc': 0.9984138115853548, 'loss_val': 0.033935045827217104, 'psi': 0.9958793484844815}
[S10] START round=33 head_norm_before_train=1.640551 cos_to_last_merge=0.9947 (last merge round=26)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9944287677762472, 'auprc': 0.996780239164501, 'loss_val': 0.037979748404639836, 'psi': 0.9953693563315487}-{'f1_val': 0.9948674007110037, 'auprc': 0.996757766991714, 'loss_val': 0.039882347005545736, 'psi': 0.9956235472232878}
[S11] START round=33 head_norm_before_train=1.695443 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9982023932161472, 'loss_val': 0.04318622217644683, 'psi': 0.9970640577677754}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981506694908623, 'loss_val': 0.04101432577378075, 'psi': 0.9971884705044987}
[S13] START round=33 head_norm_before_train=1.664027 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5768682146034319, 'auprc': 0.8052417789244213, 'loss_val': 0.8548963189103347, 'psi': 0.6682176403318276}-{'f1_val': 0.6228383713155365, 'auprc': 0.9278087802717127, 'loss_val': 0.6242716215343193, 'psi': 0.744826534898007}
[S14] START round=33 head_norm_before_train=1.688601 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=33 local utility u=0.001089 metrics={'f1_val': 0.9970427648353635, 'auprc': 0.9970592204688375, 'loss_val': 0.031506480527434, 'psi': 0.9970493470887531}-{'f1_val': 0.997240356705793, 'auprc': 0.9968503419529617, 'loss_val': 0.03424362439551896, 'psi': 0.9970843508046605}
[S15] START round=33 head_norm_before_train=1.412882 cos_to_last_merge=0.9999 (last merge round=31)
[S15] round=33 local utility u=0.394200 metrics={'f1_val': 0.8615736097631115, 'auprc': 0.9932601469697686, 'loss_val': 0.19156144941775874, 'psi': 0.9142482246457744}-{'f1_val': 0.7571401695171762, 'auprc': 0.9882683400086112, 'loss_val': 0.33838450607130327, 'psi': 0.8495914377137501}
[S16] START round=33 head_norm_before_train=1.534536 cos_to_last_merge=0.9999 (last merge round=31)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8559149251665992, 'auprc': 0.9775031744320619, 'loss_val': 0.7355900739059139, 'psi': 0.9045502248727842}-{'f1_val': 0.8768867700235545, 'auprc': 0.9923139217030676, 'loss_val': 0.5287074545803901, 'psi': 0.9230576306953597}
[S17] START round=33 head_norm_before_train=1.562736 cos_to_last_merge=0.9998 (last merge round=31)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.44928054216851093, 'auprc': 0.7670521835010231, 'loss_val': 1.773014889011873, 'psi': 0.5763891987015157}-{'f1_val': 0.5750120058985588, 'auprc': 0.7415627002430538, 'loss_val': 1.4672667841300147, 'psi': 0.6416322836363568}
[S2]  timeout peer S9
[S7]  timeout peer S16
[S5]  timeout peer S7
[S5]  timeout peer S13
[S5]  timeout peer S15
[S17]  timeout peer S2
[S11]  timeout peer S5
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:51908
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:51910
[S3] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:51903
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.5769 head_norm=1.670954
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.246938e-02
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.5768 head_norm=1.700748 delta_norm=0.082469
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.8559 head_norm=1.555657
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.186850e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.8559 head_norm=1.554677 delta_norm=0.118685
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.9996
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] cosine check vs S3: cos=-0.0408
[S9] DROPPED delta from S3 (cos=-0.0408 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1806) from S4
[S11] cosine check vs S4: cos=0.9967
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=33 metric=0.5962 head_norm=1.699621
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.498309e-02
[S7] stored merged vector for next round verification (round=33)
[S7] DEBUG after merge:  round=33 metric=0.5956 head_norm=1.700907 delta_norm=0.024983
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=-0.0408
[S3] DROPPED delta from S9 (cos=-0.0408 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S6
[S15] cosine check vs S6: cos=0.9657
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:51907
[S15] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9971
[S6] RECEIVED delta(kind=head bytes=1807) from S15
[S6] cosine check vs S15: cos=0.9657
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9963 head_norm=1.714013
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.964187e-02
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9963 head_norm=1.714190 delta_norm=0.069642
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.4493 head_norm=1.577094
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.057398e-02
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.4520 head_norm=1.585015 delta_norm=0.060574
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.9613 head_norm=1.561677
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.057547e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.9609 head_norm=1.486344 delta_norm=0.205755
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.8616 head_norm=1.436759
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.057547e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.8732 head_norm=1.486344 delta_norm=0.205755
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.728907 cos_to_last_merge=0.9612 (last merge round=12)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7513520040268915, 'auprc': 0.7006100234153962, 'loss_val': 0.4901791223321772, 'psi': 0.7310552117822934}-{'f1_val': 0.7088277998969983, 'auprc': 0.8485205305095018, 'loss_val': 0.38312608247061, 'psi': 0.7647048921419997}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.930883 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9990464007030273, 'loss_val': 0.09198876276334558, 'psi': 0.9762636115208831}-{'f1_val': 0.9978389274664787, 'auprc': 0.9988553068817358, 'loss_val': 0.043216645040252015, 'psi': 0.9982454792325817}
[S4] START round=34 head_norm_before_train=1.717193 cos_to_last_merge=0.9826 (last merge round=21)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9407984196026722, 'auprc': 0.9462676542577293, 'loss_val': 0.31570278272916186, 'psi': 0.9429861134646951}-{'f1_val': 0.9546285141800787, 'auprc': 0.9642543183051246, 'loss_val': 0.2956824842602705, 'psi': 0.9584788358300971}
[S5] START round=34 head_norm_before_train=1.674139 cos_to_last_merge=0.9968 (last merge round=27)
[S5] round=34 local utility u=0.175433 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9899567744790783, 'loss_val': 0.33175422508460173, 'psi': 0.8161755002519795}-{'f1_val': 0.700320598491359, 'auprc': 0.8842714904608421, 'loss_val': 0.3655604293834559, 'psi': 0.7739009552791523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=34 head_norm_before_train=1.486344 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.6234526056375431, 'auprc': 0.7646908748418202, 'loss_val': 0.6903421034259327, 'psi': 0.6799479133192539}-{'f1_val': 0.9613382083238537, 'auprc': 0.9730385394042359, 'loss_val': 0.21365529890312002, 'psi': 0.9660183407560066}
[S7] START round=34 head_norm_before_train=1.700907 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.4859840293974918, 'auprc': 0.7495185225141099, 'loss_val': 1.2283504992550554, 'psi': 0.5913978266441391}-{'f1_val': 0.5961586520929624, 'auprc': 0.7875315789285007, 'loss_val': 0.809121468927006, 'psi': 0.6727078228271777}
[S8] START round=34 head_norm_before_train=1.595198 cos_to_last_merge=0.9902 (last merge round=25)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9925363510587668, 'loss_val': 0.050000036518291394, 'psi': 0.9938021193811326}-{'f1_val': 0.9928249955793521, 'auprc': 0.9986304496597016, 'loss_val': 0.0516253472689311, 'psi': 0.9951471772114919}
[S9] START round=34 head_norm_before_train=1.759586 cos_to_last_merge=0.9963 (last merge round=27)
[S9] round=34 local utility u=0.000569 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983893124375736, 'loss_val': 0.026672604594033384, 'psi': 0.9973520320633643}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984093854989768, 'loss_val': 0.027871080904141594, 'psi': 0.9973600612879256}
[S10] START round=34 head_norm_before_train=1.669535 cos_to_last_merge=0.9935 (last merge round=26)
[S10] round=34 local utility u=0.003056 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9965758477235764, 'loss_val': 0.03449015640184915, 'psi': 0.9956112510084763}-{'f1_val': 0.9944287677762472, 'auprc': 0.996780239164501, 'loss_val': 0.037979748404639836, 'psi': 0.9953693563315487}
[S11] START round=34 head_norm_before_train=1.714190 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9963760705462275, 'auprc': 0.9974238929336585, 'loss_val': 0.04390602193971442, 'psi': 0.9967951995011999}-{'f1_val': 0.996305167468861, 'auprc': 0.9982023932161472, 'loss_val': 0.04318622217644683, 'psi': 0.9970640577677754}
[S13] START round=34 head_norm_before_train=1.700748 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.443647 metrics={'f1_val': 0.6232422958043103, 'auprc': 0.933835021444588, 'loss_val': 0.6316269175802602, 'psi': 0.7474793860604214}-{'f1_val': 0.5768682146034319, 'auprc': 0.8052417789244213, 'loss_val': 0.8548963189103347, 'psi': 0.6682176403318276}
[S14] START round=34 head_norm_before_train=1.702558 cos_to_last_merge=0.9999 (last merge round=31)
[S14] round=34 local utility u=0.001772 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9987892486022968, 'loss_val': 0.03288127133057806, 'psi': 0.9977142043355178}-{'f1_val': 0.9970427648353635, 'auprc': 0.9970592204688375, 'loss_val': 0.031506480527434, 'psi': 0.9970493470887531}
[S15] START round=34 head_norm_before_train=1.486344 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7553869764079816, 'auprc': 0.9900117352953917, 'loss_val': 0.3321076438601972, 'psi': 0.8492368799629456}-{'f1_val': 0.8615736097631115, 'auprc': 0.9932601469697686, 'loss_val': 0.19156144941775874, 'psi': 0.9142482246457744}
[S16] START round=34 head_norm_before_train=1.554677 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.734975 metrics={'f1_val': 0.9855889024936034, 'auprc': 0.9924885545629958, 'loss_val': 0.08864004882091338, 'psi': 0.9883487633213603}-{'f1_val': 0.8559149251665992, 'auprc': 0.9775031744320619, 'loss_val': 0.7355900739059139, 'psi': 0.9045502248727842}
[S17] START round=34 head_norm_before_train=1.585015 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.4569566070861301, 'auprc': 0.7806587834663035, 'loss_val': 2.0476168300747037, 'psi': 0.5864374776381995}-{'f1_val': 0.44928054216851093, 'auprc': 0.7670521835010231, 'loss_val': 1.773014889011873, 'psi': 0.5763891987015157}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:51912
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:51908
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:51917
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:51903
[S16] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.9997
[S11] RECEIVED delta(kind=head bytes=1799) from S13
[S11] cosine check vs S13: cos=0.9985
[S17] RECEIVED delta(kind=head bytes=1800) from S16
[S17] cosine check vs S16: cos=0.9943
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=0.9709
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=-0.0433
[S3] DROPPED delta from S9 (cos=-0.0433 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=34 metric=0.9964 head_norm=1.729337
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.845602e-02
[S11] stored merged vector for next round verification (round=34)
[S11] DEBUG after merge:  round=34 metric=0.9964 head_norm=1.718654 delta_norm=0.048456
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.6235 head_norm=1.502451
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.150948e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.6279 head_norm=1.586841 delta_norm=0.215095
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=34 metric=0.4570 head_norm=1.597383
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.575216e-02
[S17] stored merged vector for next round verification (round=34)
[S17] DEBUG after merge:  round=34 metric=0.4617 head_norm=1.583976 delta_norm=0.085752
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.739462 cos_to_last_merge=0.9601 (last merge round=12)
[S2] round=35 local utility u=0.071701 metrics={'f1_val': 0.7085523331843615, 'auprc': 0.8104415170841852, 'loss_val': 0.41947431367302185, 'psi': 0.749308006744291}-{'f1_val': 0.7513520040268915, 'auprc': 0.7006100234153962, 'loss_val': 0.4901791223321772, 'psi': 0.7310552117822934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] sending update (kind=head size=1808 to 1 peers)
[S3] START round=35 head_norm_before_train=1.941025 (no previous merge yet)
[S3] round=35 local utility u=0.095746 metrics={'f1_val': 0.9864458943787179, 'auprc': 0.9990740857157154, 'loss_val': 0.05280450830088063, 'psi': 0.9914971709135169}-{'f1_val': 0.9610750853994537, 'auprc': 0.9990464007030273, 'loss_val': 0.09198876276334558, 'psi': 0.9762636115208831}
[S4] START round=35 head_norm_before_train=1.723256 cos_to_last_merge=0.9821 (last merge round=21)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9423874533028969, 'auprc': 0.9328665663464063, 'loss_val': 0.31886463800655707, 'psi': 0.9385790985203006}-{'f1_val': 0.9407984196026722, 'auprc': 0.9462676542577293, 'loss_val': 0.31570278272916186, 'psi': 0.9429861134646951}
[S5] START round=35 head_norm_before_train=1.680152 cos_to_last_merge=0.9963 (last merge round=27)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.7141740326016373, 'auprc': 0.7944417053600749, 'loss_val': 0.5093460837866853, 'psi': 0.7462811017050124}-{'f1_val': 0.7003213174339138, 'auprc': 0.9899567744790783, 'loss_val': 0.33175422508460173, 'psi': 0.8161755002519795}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.586841 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.944581 metrics={'f1_val': 0.8104397355835441, 'auprc': 0.9396478468957932, 'loss_val': 0.4479745443393811, 'psi': 0.8621229801084438}-{'f1_val': 0.6234526056375431, 'auprc': 0.7646908748418202, 'loss_val': 0.6903421034259327, 'psi': 0.6799479133192539}
[S7] START round=35 head_norm_before_train=1.709719 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=35 local utility u=0.835273 metrics={'f1_val': 0.6301986058987366, 'auprc': 0.8032466621236383, 'loss_val': 0.5842772081177617, 'psi': 0.6994178283886973}-{'f1_val': 0.4859840293974918, 'auprc': 0.7495185225141099, 'loss_val': 1.2283504992550554, 'psi': 0.5913978266441391}
[S8] START round=35 head_norm_before_train=1.617567 cos_to_last_merge=0.9885 (last merge round=25)
[S8] round=35 local utility u=0.000594 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9922404495227822, 'loss_val': 0.0479252129982156, 'psi': 0.9936837587667389}-{'f1_val': 0.9946459649293765, 'auprc': 0.9925363510587668, 'loss_val': 0.050000036518291394, 'psi': 0.9938021193811326}
[S9] START round=35 head_norm_before_train=1.768729 cos_to_last_merge=0.9954 (last merge round=27)
[S9] round=35 local utility u=0.000656 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983850147077228, 'loss_val': 0.025347273930186272, 'psi': 0.997350312971424}-{'f1_val': 0.9966605118138915, 'auprc': 0.9983893124375736, 'loss_val': 0.026672604594033384, 'psi': 0.9973520320633643}
[S10] START round=35 head_norm_before_train=1.694491 cos_to_last_merge=0.9924 (last merge round=26)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9963620877416455, 'loss_val': 0.03435068152143644, 'psi': 0.9949990303948264}-{'f1_val': 0.9949681865317428, 'auprc': 0.9965758477235764, 'loss_val': 0.03449015640184915, 'psi': 0.9956112510084763}
[S11] START round=35 head_norm_before_train=1.718654 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=35 local utility u=0.000633 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9978148361994531, 'loss_val': 0.04090801593863732, 'psi': 0.9966610372009297}-{'f1_val': 0.9963760705462275, 'auprc': 0.9974238929336585, 'loss_val': 0.04390602193971442, 'psi': 0.9967951995011999}
[S13] START round=35 head_norm_before_train=1.709279 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6017134218445688, 'auprc': 0.927146534816408, 'loss_val': 0.7510263955515408, 'psi': 0.7318866670333044}-{'f1_val': 0.6232422958043103, 'auprc': 0.933835021444588, 'loss_val': 0.6316269175802602, 'psi': 0.7474793860604214}
[S14] START round=35 head_norm_before_train=1.715301 cos_to_last_merge=0.9997 (last merge round=31)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9968763684001809, 'loss_val': 0.030272074552529817, 'psi': 0.9969490522546713}-{'f1_val': 0.9969975081576651, 'auprc': 0.9987892486022968, 'loss_val': 0.03288127133057806, 'psi': 0.9977142043355178}
[S15] START round=35 head_norm_before_train=1.508984 cos_to_last_merge=0.9999 (last merge round=33)
[S15] round=35 local utility u=0.854855 metrics={'f1_val': 0.9924976185926985, 'auprc': 0.9984619556194283, 'loss_val': 0.07041177632902586, 'psi': 0.9948833534033905}-{'f1_val': 0.7553869764079816, 'auprc': 0.9900117352953917, 'loss_val': 0.3321076438601972, 'psi': 0.8492368799629456}
[S16] START round=35 head_norm_before_train=1.575129 cos_to_last_merge=0.9999 (last merge round=33)
[S16] round=35 local utility u=0.010989 metrics={'f1_val': 0.9877632472238942, 'auprc': 0.9917898903132163, 'loss_val': 0.077612212762337, 'psi': 0.989373904459623}-{'f1_val': 0.9855889024936034, 'auprc': 0.9924885545629958, 'loss_val': 0.08864004882091338, 'psi': 0.9883487633213603}
[S17] START round=35 head_norm_before_train=1.583976 cos_to_last_merge=1.0000 (last merge round=34)
[S17] round=35 local utility u=0.869054 metrics={'f1_val': 0.6008484184460596, 'auprc': 0.802188517139662, 'loss_val': 1.237448911569977, 'psi': 0.6813844579235006}-{'f1_val': 0.4569566070861301, 'auprc': 0.7806587834663035, 'loss_val': 2.0476168300747037, 'psi': 0.5864374776381995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:51914
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:51910
[S3] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1807 to 1 peers)
[S13] ⇄ pheromone p=0.160 → S11@127.0.0.1:51912
[S4] ⇄ pheromone p=0.020 → S11@127.0.0.1:51912
[S16] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:51913
[S8] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:51903
[S14] ⇄ pheromone p=0.006 → S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:51916
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] cosine check vs S16: cos=0.9979
[S14] RECEIVED delta(kind=head bytes=1807) from S7
[S14] cosine check vs S7: cos=0.9993
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] cosine check vs S3: cos=-0.0454
[S9] DROPPED delta from S3 (cos=-0.0454 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.9942
[S8] ⇄ pheromone p=0.015 → S17@127.0.0.1:51917
[S17] sending update (kind=head size=1793 to 1 peers)
[S3] ⇄ pheromone p=0.126 → S9@127.0.0.1:51910
[S16] ⇄ pheromone p=0.158 → S17@127.0.0.1:51917
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.6302 head_norm=1.715642
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.693154e-02
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.6285 head_norm=1.715260 delta_norm=0.026932
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.253 → S14@127.0.0.1:51914
[S16] RECEIVED delta(kind=head bytes=1793) from S17
[S16] cosine check vs S17: cos=0.9979
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] cosine check vs S11: cos=0.9994
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] cosine check vs S9: cos=-0.0454
[S3] DROPPED delta from S9 (cos=-0.0454 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:51907
[S6] sending update (kind=head size=1798 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] cosine check vs S6: cos=0.9901
[S6] RECEIVED delta(kind=head bytes=1804) from S15
[S6] cosine check vs S15: cos=0.9901
[S9] ⇄ pheromone p=0.013 → S3@127.0.0.1:51903
[S11] ⇄ pheromone p=0.043 → S13@127.0.0.1:51913
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=35 metric=0.6008 head_norm=1.594629
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.097648e-02
[S17] stored merged vector for next round verification (round=35)
[S17] DEBUG after merge:  round=35 metric=0.6004 head_norm=1.603783 delta_norm=0.030976
[S17] aggregate: ACCEPT kept=['S16', 'S8'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.255 → S16@127.0.0.1:51916
[S10] ⇄ pheromone p=0.007 → S6@127.0.0.1:51907
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.8104 head_norm=1.598711
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.155099e-01
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.8102 head_norm=1.558895 delta_norm=0.115510
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.463 → S15@127.0.0.1:51915
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.9925 head_norm=1.526799
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.155099e-01
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.9925 head_norm=1.558895 delta_norm=0.115510
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.408 → S6@127.0.0.1:51907
[S2] START round=36 head_norm_before_train=1.748560 cos_to_last_merge=0.9591 (last merge round=12)
[S2] round=36 local utility u=0.015964 metrics={'f1_val': 0.7090863254860077, 'auprc': 0.821210228898215, 'loss_val': 0.4230569641871043, 'psi': 0.7539358868508906}-{'f1_val': 0.7085523331843615, 'auprc': 0.8104415170841852, 'loss_val': 0.41947431367302185, 'psi': 0.749308006744291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=36 head_norm_before_train=1.953212 (no previous merge yet)
[S3] round=36 local utility u=0.040626 metrics={'f1_val': 0.9973956967430226, 'auprc': 0.9990776274929702, 'loss_val': 0.03726265364594509, 'psi': 0.9980684690430016}-{'f1_val': 0.9864458943787179, 'auprc': 0.9990740857157154, 'loss_val': 0.05280450830088063, 'psi': 0.9914971709135169}
[S4] START round=36 head_norm_before_train=1.726441 cos_to_last_merge=0.9819 (last merge round=21)
[S4] round=36 local utility u=0.016361 metrics={'f1_val': 0.9446470615639735, 'auprc': 0.9351412020222641, 'loss_val': 0.30652500483264183, 'psi': 0.9408447177472898}-{'f1_val': 0.9423874533028969, 'auprc': 0.9328665663464063, 'loss_val': 0.31886463800655707, 'psi': 0.9385790985203006}
[S5] START round=36 head_norm_before_train=1.687278 cos_to_last_merge=0.9957 (last merge round=27)
[S5] round=36 local utility u=0.379256 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.9981551260560585, 'loss_val': 0.2803496930759895, 'psi': 0.8196040112521891}-{'f1_val': 0.7141740326016373, 'auprc': 0.7944417053600749, 'loss_val': 0.5093460837866853, 'psi': 0.7462811017050124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=36 head_norm_before_train=1.558895 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.214513 metrics={'f1_val': 0.8492229101186259, 'auprc': 0.9618983961676859, 'loss_val': 0.31839900633178214, 'psi': 0.8942931045382498}-{'f1_val': 0.8104397355835441, 'auprc': 0.9396478468957932, 'loss_val': 0.4479745443393811, 'psi': 0.8621229801084438}
[S7] START round=36 head_norm_before_train=1.715260 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.043085 metrics={'f1_val': 0.6402756621931414, 'auprc': 0.8037087050076308, 'loss_val': 0.559955164556895, 'psi': 0.705648879318937}-{'f1_val': 0.6301986058987366, 'auprc': 0.8032466621236383, 'loss_val': 0.5842772081177617, 'psi': 0.6994178283886973}
[S8] START round=36 head_norm_before_train=1.640928 cos_to_last_merge=0.9867 (last merge round=25)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9903754849676576, 'auprc': 0.9991862034024521, 'loss_val': 0.04896099052268839, 'psi': 0.9938997723415754}-{'f1_val': 0.9946459649293765, 'auprc': 0.9922404495227822, 'loss_val': 0.0479252129982156, 'psi': 0.9936837587667389}
[S9] START round=36 head_norm_before_train=1.779447 cos_to_last_merge=0.9944 (last merge round=27)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9983774102635355, 'loss_val': 0.025687786193098663, 'psi': 0.9968670466312075}-{'f1_val': 0.9966605118138915, 'auprc': 0.9983850147077228, 'loss_val': 0.025347273930186272, 'psi': 0.997350312971424}
[S10] START round=36 head_norm_before_train=1.715055 cos_to_last_merge=0.9913 (last merge round=26)
[S10] round=36 local utility u=0.003625 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9967349878119403, 'loss_val': 0.03216992069798406, 'psi': 0.9955431606563996}-{'f1_val': 0.9940903254969471, 'auprc': 0.9963620877416455, 'loss_val': 0.03435068152143644, 'psi': 0.9949990303948264}
[S11] START round=36 head_norm_before_train=1.731809 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9962860605308037, 'loss_val': 0.040293593489541896, 'psi': 0.996339656357772}-{'f1_val': 0.9958918378685807, 'auprc': 0.9978148361994531, 'loss_val': 0.04090801593863732, 'psi': 0.9966610372009297}
[S13] START round=36 head_norm_before_train=1.717033 cos_to_last_merge=0.9999 (last merge round=33)
[S13] round=36 local utility u=0.042225 metrics={'f1_val': 0.6094319775952639, 'auprc': 0.929577986321874, 'loss_val': 0.7201819723520391, 'psi': 0.7374903810859079}-{'f1_val': 0.6017134218445688, 'auprc': 0.927146534816408, 'loss_val': 0.7510263955515408, 'psi': 0.7318866670333044}
[S14] START round=36 head_norm_before_train=1.730262 cos_to_last_merge=0.9995 (last merge round=31)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9915563358382661, 'auprc': 0.9971365146237405, 'loss_val': 0.0464437081173321, 'psi': 0.9937884073524559}-{'f1_val': 0.9969975081576651, 'auprc': 0.9968763684001809, 'loss_val': 0.030272074552529817, 'psi': 0.9969490522546713}
[S15] START round=36 head_norm_before_train=1.558895 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9881623162813916, 'loss_val': 0.40116668762218766, 'psi': 0.8158151128143307}-{'f1_val': 0.9924976185926985, 'auprc': 0.9984619556194283, 'loss_val': 0.07041177632902586, 'psi': 0.9948833534033905}
[S16] START round=36 head_norm_before_train=1.596732 cos_to_last_merge=0.9996 (last merge round=33)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9415590977365826, 'auprc': 0.9927092288069777, 'loss_val': 0.16508777349817735, 'psi': 0.9620191501647407}-{'f1_val': 0.9877632472238942, 'auprc': 0.9917898903132163, 'loss_val': 0.077612212762337, 'psi': 0.989373904459623}
[S17] START round=36 head_norm_before_train=1.603783 cos_to_last_merge=1.0000 (last merge round=35)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.41972871972685166, 'auprc': 0.7695046154183076, 'loss_val': 1.8021186347524525, 'psi': 0.5596390780034342}-{'f1_val': 0.6008484184460596, 'auprc': 0.802188517139662, 'loss_val': 1.237448911569977, 'psi': 0.6813844579235006}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:51914
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:51912
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:51912
[S4] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:51915
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9916 head_norm=1.740001
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.764927e-02
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9916 head_norm=1.727454 delta_norm=0.037649
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.9416 head_norm=1.617452
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.093387e-02
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.9416 head_norm=1.604925 delta_norm=0.060934
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=0.9825
[S11] RECEIVED delta(kind=head bytes=1804) from S13
[S11] cosine check vs S13: cos=0.9991
[S9] RECEIVED delta(kind=head bytes=1804) from S3
[S9] cosine check vs S3: cos=-0.0473
[S9] DROPPED delta from S3 (cos=-0.0473 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9965
[S6] sending update (kind=head size=1801 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=36 metric=0.6094 head_norm=1.727443
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.588472e-02
[S13] stored merged vector for next round verification (round=36)
[S13] DEBUG after merge:  round=36 metric=0.6092 head_norm=1.729255 delta_norm=0.035885
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1801) from S6
[S15] cosine check vs S6: cos=0.9999
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=36 metric=0.9964 head_norm=1.744994
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.255336e-02
[S11] stored merged vector for next round verification (round=36)
[S11] DEBUG after merge:  round=36 metric=0.9964 head_norm=1.736256 delta_norm=0.032553
[S11] aggregate: ACCEPT kept=['S13', 'S4'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.8492 head_norm=1.564978
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.761734e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.8563 head_norm=1.642934 delta_norm=0.176173
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.7009 head_norm=1.571953
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.263633e-02
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.7009 head_norm=1.568419 delta_norm=0.012636
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.759462 cos_to_last_merge=0.9579 (last merge round=12)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.6946449800813671, 'auprc': 0.6776618469476064, 'loss_val': 0.6189157864018014, 'psi': 0.6878517268278628}-{'f1_val': 0.7090863254860077, 'auprc': 0.821210228898215, 'loss_val': 0.4230569641871043, 'psi': 0.7539358868508906}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.966434 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9854140660193069, 'auprc': 0.9992169297568003, 'loss_val': 0.04625498138567311, 'psi': 0.9909352115143043}-{'f1_val': 0.9973956967430226, 'auprc': 0.9990776274929702, 'loss_val': 0.03726265364594509, 'psi': 0.9980684690430016}
[S4] START round=37 head_norm_before_train=1.734198 cos_to_last_merge=0.9815 (last merge round=21)
[S4] round=37 local utility u=0.030797 metrics={'f1_val': 0.948630117659186, 'auprc': 0.9444614000826608, 'loss_val': 0.2967889684664702, 'psi': 0.9469626306285759}-{'f1_val': 0.9446470615639735, 'auprc': 0.9351412020222641, 'loss_val': 0.30652500483264183, 'psi': 0.9408447177472898}
[S5] START round=37 head_norm_before_train=1.692866 cos_to_last_merge=0.9953 (last merge round=27)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.7144667326210086, 'auprc': 0.7942496604037018, 'loss_val': 0.48911750402330234, 'psi': 0.7463799037340859}-{'f1_val': 0.7005699347162762, 'auprc': 0.9981551260560585, 'loss_val': 0.2803496930759895, 'psi': 0.8196040112521891}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.642934 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.758882160344077, 'auprc': 0.9518660580278716, 'loss_val': 0.549181435805137, 'psi': 0.8360757194175947}-{'f1_val': 0.8492229101186259, 'auprc': 0.9618983961676859, 'loss_val': 0.31839900633178214, 'psi': 0.8942931045382498}
[S7] START round=37 head_norm_before_train=1.720378 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5920948005410442, 'auprc': 0.7951859765269236, 'loss_val': 0.7299779007082859, 'psi': 0.673331270935396}-{'f1_val': 0.6402756621931414, 'auprc': 0.8037087050076308, 'loss_val': 0.559955164556895, 'psi': 0.705648879318937}
[S8] START round=37 head_norm_before_train=1.662977 cos_to_last_merge=0.9851 (last merge round=25)
[S8] round=37 local utility u=0.014150 metrics={'f1_val': 0.993919739519144, 'auprc': 0.9984403703433428, 'loss_val': 0.03969001048538739, 'psi': 0.9957279918488235}-{'f1_val': 0.9903754849676576, 'auprc': 0.9991862034024521, 'loss_val': 0.04896099052268839, 'psi': 0.9938997723415754}
[S9] START round=37 head_norm_before_train=1.789021 cos_to_last_merge=0.9934 (last merge round=27)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.991254331540241, 'auprc': 0.998377480705266, 'loss_val': 0.03254483383237336, 'psi': 0.994103591206251}-{'f1_val': 0.9958601375429889, 'auprc': 0.9983774102635355, 'loss_val': 0.025687786193098663, 'psi': 0.9968670466312075}
[S10] START round=37 head_norm_before_train=1.735334 cos_to_last_merge=0.9903 (last merge round=26)
[S10] round=37 local utility u=0.000499 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9966646150433256, 'loss_val': 0.0309612498528059, 'psi': 0.9955150115489537}-{'f1_val': 0.9947486092193725, 'auprc': 0.9967349878119403, 'loss_val': 0.03216992069798406, 'psi': 0.9955431606563996}
[S11] START round=37 head_norm_before_train=1.736256 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=37 local utility u=0.001385 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9976554787862253, 'loss_val': 0.03872960909509083, 'psi': 0.9965972942356385}-{'f1_val': 0.9963753869090841, 'auprc': 0.9962860605308037, 'loss_val': 0.040293593489541896, 'psi': 0.996339656357772}
[S13] START round=37 head_norm_before_train=1.729255 cos_to_last_merge=1.0000 (last merge round=36)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5796679176621334, 'auprc': 0.8567731524009575, 'loss_val': 0.8968316981237585, 'psi': 0.690510011557663}-{'f1_val': 0.6094319775952639, 'auprc': 0.929577986321874, 'loss_val': 0.7201819723520391, 'psi': 0.7374903810859079}
[S14] START round=37 head_norm_before_train=1.727454 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9330055469485266, 'auprc': 0.9955017393776576, 'loss_val': 0.1504316703239532, 'psi': 0.958004023920179}-{'f1_val': 0.9915563358382661, 'auprc': 0.9971365146237405, 'loss_val': 0.0464437081173321, 'psi': 0.9937884073524559}
[S15] START round=37 head_norm_before_train=1.568419 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=0.653763 metrics={'f1_val': 0.8803823438445876, 'auprc': 0.9910388132647298, 'loss_val': 0.17906297322697767, 'psi': 0.9246449316126444}-{'f1_val': 0.7009169771696235, 'auprc': 0.9881623162813916, 'loss_val': 0.40116668762218766, 'psi': 0.8158151128143307}
[S16] START round=37 head_norm_before_train=1.604925 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8556247787151594, 'auprc': 0.9533220729683916, 'loss_val': 0.8020218519865004, 'psi': 0.8947036964164523}-{'f1_val': 0.9415590977365826, 'auprc': 0.9927092288069777, 'loss_val': 0.16508777349817735, 'psi': 0.9620191501647407}
[S17] START round=37 head_norm_before_train=1.615431 cos_to_last_merge=0.9999 (last merge round=35)
[S17] round=37 local utility u=0.058603 metrics={'f1_val': 0.4407395597201004, 'auprc': 0.7417431154100436, 'loss_val': 1.7276938110384412, 'psi': 0.5611409819960778}-{'f1_val': 0.41972871972685166, 'auprc': 0.7695046154183076, 'loss_val': 1.8021186347524525, 'psi': 0.5596390780034342}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:51917
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:51912
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:51916
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9330 head_norm=1.736811
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.521793e-02
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9330 head_norm=1.728547 delta_norm=0.015218
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:51913
[S4] sending update (kind=head size=1804 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.9934
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] cosine check vs S4: cos=0.9971
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=0.9956
[S11] sending update (kind=head size=1803 to 1 peers)
[S17] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] cosine check vs S11: cos=0.9993
[S16] RECEIVED delta(kind=head bytes=1805) from S17
[S16] cosine check vs S17: cos=0.9985
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=37 metric=0.7589 head_norm=1.648383
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.533729e-02
[S6] stored merged vector for next round verification (round=37)
[S6] DEBUG after merge:  round=37 metric=0.7626 head_norm=1.698674 delta_norm=0.095337
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:51907
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.4407 head_norm=1.626896
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.892605e-02
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.4411 head_norm=1.651008 delta_norm=0.098926
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=37 metric=0.9959 head_norm=1.748460
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.609873e-02
[S11] stored merged vector for next round verification (round=37)
[S11] DEBUG after merge:  round=37 metric=0.9959 head_norm=1.743995 delta_norm=0.066099
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S15
[S6] cosine check vs S15: cos=0.9888
[S2] START round=38 head_norm_before_train=1.768649 cos_to_last_merge=0.9568 (last merge round=12)
[S2] round=38 local utility u=0.390453 metrics={'f1_val': 0.7090857563772126, 'auprc': 0.8459383040210231, 'loss_val': 0.4294837175560327, 'psi': 0.7638267754347368}-{'f1_val': 0.6946449800813671, 'auprc': 0.6776618469476064, 'loss_val': 0.6189157864018014, 'psi': 0.6878517268278628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=38 head_norm_before_train=1.981289 (no previous merge yet)
[S3] round=38 local utility u=0.045718 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9990470391239741, 'loss_val': 0.028513775598218126, 'psi': 0.9982877134765482}-{'f1_val': 0.9854140660193069, 'auprc': 0.9992169297568003, 'loss_val': 0.04625498138567311, 'psi': 0.9909352115143043}
[S4] START round=38 head_norm_before_train=1.742028 cos_to_last_merge=0.9808 (last merge round=21)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9421191384698558, 'auprc': 0.9331606202948735, 'loss_val': 0.31434155432907707, 'psi': 0.9385357311998628}-{'f1_val': 0.948630117659186, 'auprc': 0.9444614000826608, 'loss_val': 0.2967889684664702, 'psi': 0.9469626306285759}
[S5] START round=38 head_norm_before_train=1.697240 cos_to_last_merge=0.9948 (last merge round=27)
[S5] round=38 local utility u=0.366902 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9978253838262967, 'loss_val': 0.2828949298942937, 'psi': 0.8194956099339872}-{'f1_val': 0.7144667326210086, 'auprc': 0.7942496604037018, 'loss_val': 0.48911750402330234, 'psi': 0.7463799037340859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=38 head_norm_before_train=1.698674 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=38 local utility u=0.272696 metrics={'f1_val': 0.8227709384635652, 'auprc': 0.9592030222608164, 'loss_val': 0.4091339742351217, 'psi': 0.8773437719824657}-{'f1_val': 0.758882160344077, 'auprc': 0.9518660580278716, 'loss_val': 0.549181435805137, 'psi': 0.8360757194175947}
[S7] START round=38 head_norm_before_train=1.726287 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5407753429477167, 'auprc': 0.7836618432647335, 'loss_val': 0.9618063516320443, 'psi': 0.6379299430745233}-{'f1_val': 0.5920948005410442, 'auprc': 0.7951859765269236, 'loss_val': 0.7299779007082859, 'psi': 0.673331270935396}
[S8] START round=38 head_norm_before_train=1.680605 cos_to_last_merge=0.9838 (last merge round=25)
[S8] round=38 local utility u=0.001437 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9977677420162553, 'loss_val': 0.03915473418337423, 'psi': 0.995894675764128}-{'f1_val': 0.993919739519144, 'auprc': 0.9984403703433428, 'loss_val': 0.03969001048538739, 'psi': 0.9957279918488235}
[S9] START round=38 head_norm_before_train=1.798619 cos_to_last_merge=0.9924 (last merge round=27)
[S9] round=38 local utility u=0.015475 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.998753214418787, 'loss_val': 0.025339011386752867, 'psi': 0.9965155364159921}-{'f1_val': 0.991254331540241, 'auprc': 0.998377480705266, 'loss_val': 0.03254483383237336, 'psi': 0.994103591206251}
[S10] START round=38 head_norm_before_train=1.752713 cos_to_last_merge=0.9894 (last merge round=26)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9942256070413027, 'auprc': 0.996575897300372, 'loss_val': 0.03084632662459996, 'psi': 0.9951657231449305}-{'f1_val': 0.9947486092193725, 'auprc': 0.9966646150433256, 'loss_val': 0.0309612498528059, 'psi': 0.9955150115489537}
[S11] START round=38 head_norm_before_train=1.743995 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9970810740302027, 'loss_val': 0.040617597364340306, 'psi': 0.9965126345600667}-{'f1_val': 0.9958918378685807, 'auprc': 0.9976554787862253, 'loss_val': 0.03872960909509083, 'psi': 0.9965972942356385}
[S13] START round=38 head_norm_before_train=1.742919 cos_to_last_merge=0.9999 (last merge round=36)
[S13] round=38 local utility u=0.214871 metrics={'f1_val': 0.6131279525413096, 'auprc': 0.8730779937268691, 'loss_val': 0.716765226128674, 'psi': 0.7171079690155334}-{'f1_val': 0.5796679176621334, 'auprc': 0.8567731524009575, 'loss_val': 0.8968316981237585, 'psi': 0.690510011557663}
[S14] START round=38 head_norm_before_train=1.728547 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.253639 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9967543841638221, 'loss_val': 0.033328326849351, 'psi': 0.9971467153665642}-{'f1_val': 0.9330055469485266, 'auprc': 0.9955017393776576, 'loss_val': 0.1504316703239532, 'psi': 0.958004023920179}
[S15] START round=38 head_norm_before_train=1.579884 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=38 local utility u=0.273338 metrics={'f1_val': 0.9638817061055269, 'auprc': 0.9981091817276259, 'loss_val': 0.1545934351601092, 'psi': 0.9775726963543665}-{'f1_val': 0.8803823438445876, 'auprc': 0.9910388132647298, 'loss_val': 0.17906297322697767, 'psi': 0.9246449316126444}
[S16] START round=38 head_norm_before_train=1.622814 cos_to_last_merge=0.9999 (last merge round=36)
[S16] round=38 local utility u=0.544520 metrics={'f1_val': 0.9350383139087768, 'auprc': 0.9907531735508439, 'loss_val': 0.30175650552650995, 'psi': 0.9573242577656037}-{'f1_val': 0.8556247787151594, 'auprc': 0.9533220729683916, 'loss_val': 0.8020218519865004, 'psi': 0.8947036964164523}
[S17] START round=38 head_norm_before_train=1.651008 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.707741 metrics={'f1_val': 0.5961077924336156, 'auprc': 0.7856052893787024, 'loss_val': 1.37600830560714, 'psi': 0.6719067912116503}-{'f1_val': 0.4407395597201004, 'auprc': 0.7417431154100436, 'loss_val': 1.7276938110384412, 'psi': 0.5611409819960778}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:51910
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:51917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:51917
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:51903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:51916
[S13] sending update (kind=head size=1805 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.9977
[S11] RECEIVED delta(kind=head bytes=1805) from S13
[S11] cosine check vs S13: cos=0.9969
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=-0.0501
[S9] DROPPED delta from S3 (cos=-0.0501 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S16
[S17] cosine check vs S16: cos=0.9940
[S6] sending update (kind=head size=1794 to 1 peers)
[S17] sending update (kind=head size=1807 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=38 metric=0.6131 head_norm=1.755910
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.345483e-02
[S13] stored merged vector for next round verification (round=38)
[S13] DEBUG after merge:  round=38 metric=0.6131 head_norm=1.751650 delta_norm=0.043455
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.9350 head_norm=1.639931
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.100602e-02
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.9350 head_norm=1.632630 delta_norm=0.051006
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1807) from S17
[S16] cosine check vs S17: cos=0.9967
[S15] RECEIVED delta(kind=head bytes=1794) from S6
[S15] cosine check vs S6: cos=0.9882
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=-0.0501
[S3] DROPPED delta from S9 (cos=-0.0501 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:51907
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=38 metric=0.9961 head_norm=1.754872
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.938484e-02
[S11] stored merged vector for next round verification (round=38)
[S11] DEBUG after merge:  round=38 metric=0.9961 head_norm=1.754020 delta_norm=0.069385
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:51908
[S15] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S15
[S6] cosine check vs S15: cos=0.9882
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.8228 head_norm=1.708964
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.392369e-01
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.8228 head_norm=1.643172 delta_norm=0.139237
[S6] aggregate: ACCEPT kept=['S15', 'S15'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=38 metric=0.5961 head_norm=1.663355
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.705421e-02
[S17] stored merged vector for next round verification (round=38)
[S17] DEBUG after merge:  round=38 metric=0.5960 head_norm=1.662467 delta_norm=0.027054
[S17] aggregate: ACCEPT kept=['S8', 'S16'] (k=2/2) mode=median trim_p=0.1
[S14] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S14
[S7] cosine check vs S14: cos=0.9998
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.9639 head_norm=1.593939
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.394282e-01
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.9517 head_norm=1.646560 delta_norm=0.139428
[S15] aggregate: ROLLBACK (f1_val pre=0.964 post=0.952 tol_abs=0.005 tol_rel=0.0)
[S2] START round=39 head_norm_before_train=1.776811 cos_to_last_merge=0.9559 (last merge round=12)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.7083952719076652, 'auprc': 0.8105716182244451, 'loss_val': 0.4178217977551082, 'psi': 0.7492658104343772}-{'f1_val': 0.7090857563772126, 'auprc': 0.8459383040210231, 'loss_val': 0.4294837175560327, 'psi': 0.7638267754347368}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.749 u=0.0000 p_local=0.0858 f1=0.708 auprc=0.811 bytes=43258
[S3] START round=39 head_norm_before_train=1.992717 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.7018019993546892, 'auprc': 0.9986599583237135, 'loss_val': 0.31224101212514244, 'psi': 0.820545182942299}-{'f1_val': 0.9977814963782642, 'auprc': 0.9990470391239741, 'loss_val': 0.028513775598218126, 'psi': 0.9982877134765482}
[S4] START round=39 head_norm_before_train=1.749441 cos_to_last_merge=0.9802 (last merge round=21)
[S4] round=39 local utility u=0.038806 metrics={'f1_val': 0.9477311105287893, 'auprc': 0.9431120769582182, 'loss_val': 0.30025490254838255, 'psi': 0.9458834971005609}-{'f1_val': 0.9421191384698558, 'auprc': 0.9331606202948735, 'loss_val': 0.31434155432907707, 'psi': 0.9385357311998628}
[S5] START round=39 head_norm_before_train=1.701472 cos_to_last_merge=0.9944 (last merge round=27)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9921118010953467, 'loss_val': 0.28873892674978696, 'psi': 0.8172097560357432}-{'f1_val': 0.7006090940057808, 'auprc': 0.9978253838262967, 'loss_val': 0.2828949298942937, 'psi': 0.8194956099339872}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.817 u=0.0000 p_local=0.1334 f1=0.701 auprc=0.992 bytes=46760
[S6] START round=39 head_norm_before_train=1.643172 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.6557650230258708, 'auprc': 0.9548604526281671, 'loss_val': 0.6422099781907543, 'psi': 0.7754031948667893}-{'f1_val': 0.8227709384635652, 'auprc': 0.9592030222608164, 'loss_val': 0.4091339742351217, 'psi': 0.8773437719824657}
[S7] START round=39 head_norm_before_train=1.733501 cos_to_last_merge=0.9999 (last merge round=35)
[S7] round=39 local utility u=0.590609 metrics={'f1_val': 0.6511591126410292, 'auprc': 0.8056447359227725, 'loss_val': 0.5088403262173901, 'psi': 0.7129533619537265}-{'f1_val': 0.5407753429477167, 'auprc': 0.7836618432647335, 'loss_val': 0.9618063516320443, 'psi': 0.6379299430745233}
[S8] START round=39 head_norm_before_train=1.696023 cos_to_last_merge=0.9825 (last merge round=25)
[S8] round=39 local utility u=0.000147 metrics={'f1_val': 0.993919739519144, 'auprc': 0.9985984006524207, 'loss_val': 0.036995057653377475, 'psi': 0.9957912039724547}-{'f1_val': 0.9946459649293765, 'auprc': 0.9977677420162553, 'loss_val': 0.03915473418337423, 'psi': 0.995894675764128}
[S9] START round=39 head_norm_before_train=1.809112 cos_to_last_merge=0.9914 (last merge round=27)
[S9] round=39 local utility u=0.001954 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9947134736178882, 'loss_val': 0.02178641214510104, 'psi': 0.996147136954441}-{'f1_val': 0.9950237510807955, 'auprc': 0.998753214418787, 'loss_val': 0.025339011386752867, 'psi': 0.9965155364159921}
[S10] START round=39 head_norm_before_train=1.767299 cos_to_last_merge=0.9885 (last merge round=26)
[S10] round=39 local utility u=0.001538 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9961600923047509, 'loss_val': 0.02966086935378816, 'psi': 0.9953132024535238}-{'f1_val': 0.9942256070413027, 'auprc': 0.996575897300372, 'loss_val': 0.03084632662459996, 'psi': 0.9951657231449305}
[S11] START round=39 head_norm_before_train=1.754020 cos_to_last_merge=1.0000 (last merge round=38)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9962975303079882, 'loss_val': 0.04211492981506799, 'psi': 0.9961992170711809}-{'f1_val': 0.9961336749133093, 'auprc': 0.9970810740302027, 'loss_val': 0.040617597364340306, 'psi': 0.9965126345600667}
[S13] START round=39 head_norm_before_train=1.751650 cos_to_last_merge=1.0000 (last merge round=38)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5855184867277453, 'auprc': 0.7378940274408239, 'loss_val': 0.8513949285326573, 'psi': 0.6464687030129768}-{'f1_val': 0.6131279525413096, 'auprc': 0.8730779937268691, 'loss_val': 0.716765226128674, 'psi': 0.7171079690155334}
[S14] START round=39 head_norm_before_train=1.741494 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=39 local utility u=0.000951 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969375200113898, 'loss_val': 0.029511297745697194, 'psi': 0.996973512899155}-{'f1_val': 0.9974082695017256, 'auprc': 0.9967543841638221, 'loss_val': 0.033328326849351, 'psi': 0.9971467153665642}
[S15] START round=39 head_norm_before_train=1.646560 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.7008103273671928, 'auprc': 0.9341007832261622, 'loss_val': 0.4573615066045995, 'psi': 0.7941265097107806}-{'f1_val': 0.9638817061055269, 'auprc': 0.9981091817276259, 'loss_val': 0.1545934351601092, 'psi': 0.9775726963543665}
[S16] START round=39 head_norm_before_train=1.632630 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9045803032701307, 'auprc': 0.9925605446493293, 'loss_val': 0.45751105393391117, 'psi': 0.9397723998218102}-{'f1_val': 0.9350383139087768, 'auprc': 0.9907531735508439, 'loss_val': 0.30175650552650995, 'psi': 0.9573242577656037}
[S17] START round=39 head_norm_before_train=1.662467 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=39 local utility u=0.016197 metrics={'f1_val': 0.5661465966315993, 'auprc': 0.8172456320758098, 'loss_val': 1.2587679547432093, 'psi': 0.6665862108092835}-{'f1_val': 0.5961077924336156, 'auprc': 0.7856052893787024, 'loss_val': 1.37600830560714, 'psi': 0.6719067912116503}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:51914
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:51917
[S8] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:51903
[S14] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:51916
[S10] r=40 psi=0.995 u=0.0015 p_local=0.0036 f1=0.995 auprc=0.996 bytes=53965
[S3] r=40 psi=0.821 u=0.0000 p_local=0.0633 f1=0.702 auprc=0.999 bytes=43185
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.9046 head_norm=1.649951
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.306657e-02
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.9044 head_norm=1.655055 delta_norm=0.073067
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.940 u=0.0000 p_local=0.1518 f1=0.905 auprc=0.993 bytes=43113
[S7] sending update (kind=head size=1797 to 1 peers)
[S4] r=40 psi=0.946 u=0.0388 p_local=0.0217 f1=0.948 auprc=0.943 bytes=48631
[S13] r=40 psi=0.646 u=0.0000 p_local=0.1044 f1=0.586 auprc=0.738 bytes=37789
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.9996
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.9967
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] cosine check vs S7: cos=0.9996
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=39 metric=0.9970 head_norm=1.753568
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.468348e-02
[S14] stored merged vector for next round verification (round=39)
[S14] DEBUG after merge:  round=39 metric=0.9970 head_norm=1.747563 delta_norm=0.024683
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] r=40 psi=0.997 u=0.0010 p_local=0.0433 f1=0.997 auprc=0.997 bytes=52199
[S8] r=40 psi=0.996 u=0.0001 p_local=0.0083 f1=0.994 auprc=0.999 bytes=48551
[S9] sending update (kind=head size=1801 to 1 peers)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.6512 head_norm=1.741887
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.217971e-02
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.6493 head_norm=1.744565 delta_norm=0.022180
[S7] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] r=40 psi=0.713 u=0.5906 p_local=0.2262 f1=0.651 auprc=0.806 bytes=39566
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=-0.0513
[S3] DROPPED delta from S9 (cos=-0.0513 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S17
[S16] cosine check vs S17: cos=0.9995
[S6] r=40 psi=0.775 u=0.0000 p_local=0.2552 f1=0.656 auprc=0.955 bytes=39556
[S11] r=40 psi=0.996 u=0.0000 p_local=0.0179 f1=0.996 auprc=0.996 bytes=52154
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=39 metric=0.5661 head_norm=1.673877
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.137647e-02
[S17] stored merged vector for next round verification (round=39)
[S17] DEBUG after merge:  round=39 metric=0.5662 head_norm=1.690386 delta_norm=0.071376
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] r=40 psi=0.667 u=0.0162 p_local=0.2286 f1=0.566 auprc=0.817 bytes=37743
[S15] r=40 psi=0.794 u=0.0000 p_local=0.2947 f1=0.701 auprc=0.934 bytes=41383
[S9] r=40 psi=0.996 u=0.0020 p_local=0.0080 f1=0.997 auprc=0.995 bytes=46851
[S2] START round=40 head_norm_before_train=1.786864 cos_to_last_merge=0.9548 (last merge round=12)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.7016298409562312, 'auprc': 0.8021226198575505, 'loss_val': 0.4768857210056136, 'psi': 0.7418269525167589}-{'f1_val': 0.7083952719076652, 'auprc': 0.8105716182244451, 'loss_val': 0.4178217977551082, 'psi': 0.7492658104343772}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.002614 (no previous merge yet)
[S3] round=40 local utility u=1.000000 metrics={'f1_val': 0.9980361160148375, 'auprc': 0.9992266188150927, 'loss_val': 0.028360157227154948, 'psi': 0.9985123171349396}-{'f1_val': 0.7018019993546892, 'auprc': 0.9986599583237135, 'loss_val': 0.31224101212514244, 'psi': 0.820545182942299}
[S4] START round=40 head_norm_before_train=1.758813 cos_to_last_merge=0.9797 (last merge round=21)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9421910098390771, 'auprc': 0.9463836401225348, 'loss_val': 0.3166854291641757, 'psi': 0.9438680619524602}-{'f1_val': 0.9477311105287893, 'auprc': 0.9431120769582182, 'loss_val': 0.30025490254838255, 'psi': 0.9458834971005609}
[S5] START round=40 head_norm_before_train=1.706524 cos_to_last_merge=0.9941 (last merge round=27)
[S5] round=40 local utility u=0.023783 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.996526326849652, 'loss_val': 0.25269405617533064, 'psi': 0.818803321200209}-{'f1_val': 0.7006083926626743, 'auprc': 0.9921118010953467, 'loss_val': 0.28873892674978696, 'psi': 0.8172097560357432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=40 head_norm_before_train=1.655330 cos_to_last_merge=0.9999 (last merge round=38)
[S6] round=40 local utility u=1.000000 metrics={'f1_val': 0.9629414275687305, 'auprc': 0.9686811348392631, 'loss_val': 0.22220674587029327, 'psi': 0.9652373104769435}-{'f1_val': 0.6557650230258708, 'auprc': 0.9548604526281671, 'loss_val': 0.6422099781907543, 'psi': 0.7754031948667893}
[S7] START round=40 head_norm_before_train=1.744565 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.4945595089565114, 'auprc': 0.7799902293939323, 'loss_val': 1.1119547531760199, 'psi': 0.6087317971314797}-{'f1_val': 0.6511591126410292, 'auprc': 0.8056447359227725, 'loss_val': 0.5088403262173901, 'psi': 0.7129533619537265}
[S8] START round=40 head_norm_before_train=1.709718 cos_to_last_merge=0.9818 (last merge round=25)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9970330064147358, 'loss_val': 0.03732101050238807, 'psi': 0.9953805069173124}-{'f1_val': 0.993919739519144, 'auprc': 0.9985984006524207, 'loss_val': 0.036995057653377475, 'psi': 0.9957912039724547}
[S9] START round=40 head_norm_before_train=1.819604 cos_to_last_merge=0.9905 (last merge round=27)
[S9] round=40 local utility u=0.000007 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9946076194751596, 'loss_val': 0.02145400091021836, 'psi': 0.9961047952973495}-{'f1_val': 0.9971029125121428, 'auprc': 0.9947134736178882, 'loss_val': 0.02178641214510104, 'psi': 0.996147136954441}
[S10] START round=40 head_norm_before_train=1.782719 cos_to_last_merge=0.9877 (last merge round=26)
[S10] round=40 local utility u=0.000280 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9961616856674861, 'loss_val': 0.029105767732421423, 'psi': 0.9953138397986179}-{'f1_val': 0.9947486092193725, 'auprc': 0.9961600923047509, 'loss_val': 0.02966086935378816, 'psi': 0.9953132024535238}
[S11] START round=40 head_norm_before_train=1.763551 cos_to_last_merge=1.0000 (last merge round=38)
[S11] round=40 local utility u=0.003459 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9976823149430064, 'loss_val': 0.03790110940837592, 'psi': 0.996608028698351}-{'f1_val': 0.9961336749133093, 'auprc': 0.9962975303079882, 'loss_val': 0.04211492981506799, 'psi': 0.9961992170711809}
[S13] START round=40 head_norm_before_train=1.765364 cos_to_last_merge=0.9999 (last merge round=38)
[S13] round=40 local utility u=0.387905 metrics={'f1_val': 0.6265409096178387, 'auprc': 0.854953061766637, 'loss_val': 0.6728974121112232, 'psi': 0.717905770477358}-{'f1_val': 0.5855184867277453, 'auprc': 0.7378940274408239, 'loss_val': 0.8513949285326573, 'psi': 0.6464687030129768}
[S14] START round=40 head_norm_before_train=1.747563 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9970534367191882, 'loss_val': 0.029343811750641418, 'psi': 0.9967737136541255}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969375200113898, 'loss_val': 0.029511297745697194, 'psi': 0.996973512899155}
[S15] START round=40 head_norm_before_train=1.661061 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=40 local utility u=0.566687 metrics={'f1_val': 0.8282607527625422, 'auprc': 0.9928854451933755, 'loss_val': 0.2650443542232569, 'psi': 0.8941106297348755}-{'f1_val': 0.7008103273671928, 'auprc': 0.9341007832261622, 'loss_val': 0.4573615066045995, 'psi': 0.7941265097107806}
[S16] START round=40 head_norm_before_train=1.655055 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8397273624372364, 'auprc': 0.9789252026288079, 'loss_val': 0.9520894521394795, 'psi': 0.895406498513865}-{'f1_val': 0.9045803032701307, 'auprc': 0.9925605446493293, 'loss_val': 0.45751105393391117, 'psi': 0.9397723998218102}
[S17] START round=40 head_norm_before_train=1.690386 cos_to_last_merge=1.0000 (last merge round=39)
[S17] round=40 local utility u=0.058420 metrics={'f1_val': 0.6081148018648019, 'auprc': 0.7820212905524672, 'loss_val': 1.2880636572069424, 'psi': 0.677677397339868}-{'f1_val': 0.5661465966315993, 'auprc': 0.8172456320758098, 'loss_val': 1.2587679547432093, 'psi': 0.6665862108092835}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:51910
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:51912
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.007 → S17@127.0.0.1:51917
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=40 metric=0.8397 head_norm=1.673034
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.211125e-02
[S16] stored merged vector for next round verification (round=40)
[S16] DEBUG after merge:  round=40 metric=0.8395 head_norm=1.673148 delta_norm=0.032111
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.121 → S17@127.0.0.1:51917
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] ⇄ pheromone p=0.035 → S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:51913
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] ⇄ pheromone p=0.181 → S14@127.0.0.1:51914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:51916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:51915
[S11] RECEIVED delta(kind=head bytes=1804) from S13
[S11] cosine check vs S13: cos=0.9994
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=-0.0516
[S9] DROPPED delta from S3 (cos=-0.0516 < 0.0)
[S3] ⇄ pheromone p=0.251 → S9@127.0.0.1:51910
[S13] ⇄ pheromone p=0.161 → S11@127.0.0.1:51912
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] cosine check vs S11: cos=0.9994
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=0.9985
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] cosine check vs S6: cos=0.9994
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:51907
[S15] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:51903
[S6] RECEIVED delta(kind=head bytes=1802) from S15
[S6] cosine check vs S15: cos=0.9994
[S17] ⇄ pheromone p=0.195 → S16@127.0.0.1:51916
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=40 metric=0.9959 head_norm=1.774190
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.959237e-02
[S11] stored merged vector for next round verification (round=40)
[S11] DEBUG after merge:  round=40 metric=0.9959 head_norm=1.775735 delta_norm=0.029592
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.015 → S13@127.0.0.1:51913
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=40 metric=0.9629 head_norm=1.665736
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.834635e-02
[S6] stored merged vector for next round verification (round=40)
[S6] DEBUG after merge:  round=40 metric=0.9632 head_norm=1.669914 delta_norm=0.028346
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.404 → S15@127.0.0.1:51915
[S9] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] cosine check vs S9: cos=-0.0516
[S3] DROPPED delta from S9 (cos=-0.0516 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.8283 head_norm=1.674561
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.834635e-02
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.8298 head_norm=1.669914 delta_norm=0.028346
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.349 → S6@127.0.0.1:51907
[S9] ⇄ pheromone p=0.006 → S3@127.0.0.1:51903
[S2] START round=41 head_norm_before_train=1.800233 cos_to_last_merge=0.9532 (last merge round=12)
[S2] round=41 local utility u=0.009958 metrics={'f1_val': 0.7029766751829915, 'auprc': 0.8046175176533455, 'loss_val': 0.4725351669412684, 'psi': 0.7436330121711331}-{'f1_val': 0.7016298409562312, 'auprc': 0.8021226198575505, 'loss_val': 0.4768857210056136, 'psi': 0.7418269525167589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=41 head_norm_before_train=2.010966 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9976216349699458, 'auprc': 0.9992266203446887, 'loss_val': 0.029052217251803476, 'psi': 0.9982636291198429}-{'f1_val': 0.9980361160148375, 'auprc': 0.9992266188150927, 'loss_val': 0.028360157227154948, 'psi': 0.9985123171349396}
[S4] START round=41 head_norm_before_train=1.767703 cos_to_last_merge=0.9789 (last merge round=21)
[S4] round=41 local utility u=0.027157 metrics={'f1_val': 0.9436036567316983, 'auprc': 0.9603922082636756, 'loss_val': 0.31287310794656814, 'psi': 0.9503190773444893}-{'f1_val': 0.9421910098390771, 'auprc': 0.9463836401225348, 'loss_val': 0.3166854291641757, 'psi': 0.9438680619524602}
[S5] START round=41 head_norm_before_train=1.714209 cos_to_last_merge=0.9936 (last merge round=27)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9907813009258659, 'loss_val': 0.29444264805739373, 'psi': 0.8165048794651617}-{'f1_val': 0.7003213174339138, 'auprc': 0.996526326849652, 'loss_val': 0.25269405617533064, 'psi': 0.818803321200209}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.669914 cos_to_last_merge=1.0000 (last merge round=40)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.8855741529014804, 'auprc': 0.9647304245783521, 'loss_val': 0.28493863984270923, 'psi': 0.9172366615722292}-{'f1_val': 0.9629414275687305, 'auprc': 0.9686811348392631, 'loss_val': 0.22220674587029327, 'psi': 0.9652373104769435}
[S7] START round=41 head_norm_before_train=1.752963 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=41 local utility u=1.000000 metrics={'f1_val': 0.6750247740956052, 'auprc': 0.8366880599986062, 'loss_val': 0.347818812042002, 'psi': 0.7396900884568056}-{'f1_val': 0.4945595089565114, 'auprc': 0.7799902293939323, 'loss_val': 1.1119547531760199, 'psi': 0.6087317971314797}
[S8] START round=41 head_norm_before_train=1.721835 cos_to_last_merge=0.9813 (last merge round=25)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.7323610195911825, 'auprc': 0.9875128156522545, 'loss_val': 0.230783297682117, 'psi': 0.8344217380156113}-{'f1_val': 0.9942788405856967, 'auprc': 0.9970330064147358, 'loss_val': 0.03732101050238807, 'psi': 0.9953805069173124}
[S9] START round=41 head_norm_before_train=1.827104 cos_to_last_merge=0.9903 (last merge round=27)
[S9] round=41 local utility u=0.005560 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9980551972344733, 'loss_val': 0.020676565393537332, 'psi': 0.997483826401075}-{'f1_val': 0.9971029125121428, 'auprc': 0.9946076194751596, 'loss_val': 0.02145400091021836, 'psi': 0.9961047952973495}
[S10] START round=41 head_norm_before_train=1.797854 cos_to_last_merge=0.9871 (last merge round=26)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.996253567535224, 'loss_val': 0.029241805871647347, 'psi': 0.9950872344052704}-{'f1_val': 0.9947486092193725, 'auprc': 0.9961616856674861, 'loss_val': 0.029105767732421423, 'psi': 0.9953138397986179}
[S11] START round=41 head_norm_before_train=1.775735 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.962199870178851, 'auprc': 0.9964905512632499, 'loss_val': 0.08145620113218155, 'psi': 0.9759161426126105}-{'f1_val': 0.9958918378685807, 'auprc': 0.9976823149430064, 'loss_val': 0.03790110940837592, 'psi': 0.996608028698351}
[S13] START round=41 head_norm_before_train=1.777771 cos_to_last_merge=0.9998 (last merge round=38)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5739293621381196, 'auprc': 0.850475562602378, 'loss_val': 1.0140580290144319, 'psi': 0.6845478423238229}-{'f1_val': 0.6265409096178387, 'auprc': 0.854953061766637, 'loss_val': 0.6728974121112232, 'psi': 0.717905770477358}
[S14] START round=41 head_norm_before_train=1.762968 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=41 local utility u=0.000759 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9970578185744785, 'loss_val': 0.02783859475063942, 'psi': 0.9967754663962416}-{'f1_val': 0.9965872316107504, 'auprc': 0.9970534367191882, 'loss_val': 0.029343811750641418, 'psi': 0.9967737136541255}
[S15] START round=41 head_norm_before_train=1.669914 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=0.619367 metrics={'f1_val': 0.9960143947672967, 'auprc': 0.9978727398946986, 'loss_val': 0.047793251912796784, 'psi': 0.9967577328182575}-{'f1_val': 0.8282607527625422, 'auprc': 0.9928854451933755, 'loss_val': 0.2650443542232569, 'psi': 0.8941106297348755}
[S16] START round=41 head_norm_before_train=1.673148 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=41 local utility u=0.020079 metrics={'f1_val': 0.84290597452953, 'auprc': 0.9782218157739817, 'loss_val': 0.9288932798718963, 'psi': 0.8970323110273106}-{'f1_val': 0.8397273624372364, 'auprc': 0.9789252026288079, 'loss_val': 0.9520894521394795, 'psi': 0.895406498513865}
[S17] START round=41 head_norm_before_train=1.703947 cos_to_last_merge=0.9999 (last merge round=39)
[S17] round=41 local utility u=0.256020 metrics={'f1_val': 0.6562314635878814, 'auprc': 0.7990136063645971, 'loss_val': 1.1157010443732631, 'psi': 0.7133443206985677}-{'f1_val': 0.6081148018648019, 'auprc': 0.7820212905524672, 'loss_val': 1.2880636572069424, 'psi': 0.677677397339868}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:51908
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:51914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:51916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:51903
[S16] sending update (kind=head size=1806 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=41 metric=0.5739 head_norm=1.789045
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.681395e-02
[S13] stored merged vector for next round verification (round=41)
[S13] DEBUG after merge:  round=41 metric=0.5735 head_norm=1.781253 delta_norm=0.036814
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.9998
[S17] RECEIVED delta(kind=head bytes=1806) from S16
[S17] cosine check vs S16: cos=0.9981
[S9] sending update (kind=head size=1800 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.8429 head_norm=1.691099
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.421000e-02
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.8429 head_norm=1.696669 delta_norm=0.054210
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=-0.0520
[S3] DROPPED delta from S9 (cos=-0.0520 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S17
[S16] cosine check vs S17: cos=0.9995
[S7] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:51907
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] cosine check vs S7: cos=0.9998
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=41 metric=0.6562 head_norm=1.717317
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.439959e-02
[S17] stored merged vector for next round verification (round=41)
[S17] DEBUG after merge:  round=41 metric=0.6562 head_norm=1.703390 delta_norm=0.054400
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1798 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=41 metric=0.6750 head_norm=1.758092
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.967243e-02
[S7] stored merged vector for next round verification (round=41)
[S7] DEBUG after merge:  round=41 metric=0.6707 head_norm=1.767950 delta_norm=0.019672
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1798) from S15
[S6] cosine check vs S15: cos=0.9999
[S2] START round=42 head_norm_before_train=1.814779 cos_to_last_merge=0.9514 (last merge round=12)
[S2] round=42 local utility u=0.068323 metrics={'f1_val': 0.7088277923542914, 'auprc': 0.8453788621797016, 'loss_val': 0.49327945776633647, 'psi': 0.7634482202844555}-{'f1_val': 0.7029766751829915, 'auprc': 0.8046175176533455, 'loss_val': 0.4725351669412684, 'psi': 0.7436330121711331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=42 head_norm_before_train=2.022708 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9829377018870677, 'auprc': 0.9986835099625831, 'loss_val': 0.04189539510971823, 'psi': 0.9892360251172739}-{'f1_val': 0.9976216349699458, 'auprc': 0.9992266203446887, 'loss_val': 0.029052217251803476, 'psi': 0.9982636291198429}
[S4] START round=42 head_norm_before_train=1.777757 cos_to_last_merge=0.9782 (last merge round=21)
[S4] round=42 local utility u=0.046472 metrics={'f1_val': 0.9541781904796084, 'auprc': 0.9637492664242555, 'loss_val': 0.29344729437669065, 'psi': 0.9580066208574672}-{'f1_val': 0.9436036567316983, 'auprc': 0.9603922082636756, 'loss_val': 0.31287310794656814, 'psi': 0.9503190773444893}
[S5] START round=42 head_norm_before_train=1.723077 cos_to_last_merge=0.9930 (last merge round=27)
[S5] round=42 local utility u=0.029502 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9920831580108377, 'loss_val': 0.23934463419249308, 'psi': 0.8170256222991505}-{'f1_val': 0.700320598491359, 'auprc': 0.9907813009258659, 'loss_val': 0.29444264805739373, 'psi': 0.8165048794651617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=42 head_norm_before_train=1.679824 cos_to_last_merge=1.0000 (last merge round=40)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.683666452144687, 'auprc': 0.9332855237769722, 'loss_val': 0.6718271499101381, 'psi': 0.7835140807976011}-{'f1_val': 0.8855741529014804, 'auprc': 0.9647304245783521, 'loss_val': 0.28493863984270923, 'psi': 0.9172366615722292}
[S7] START round=42 head_norm_before_train=1.767950 cos_to_last_merge=1.0000 (last merge round=41)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5968514115954694, 'auprc': 0.7972332621116867, 'loss_val': 0.6443708619145087, 'psi': 0.6770041518019563}-{'f1_val': 0.6750247740956052, 'auprc': 0.8366880599986062, 'loss_val': 0.347818812042002, 'psi': 0.7396900884568056}
[S8] START round=42 head_norm_before_train=1.731541 cos_to_last_merge=0.9808 (last merge round=25)
[S8] round=42 local utility u=0.709208 metrics={'f1_val': 0.9530355921379932, 'auprc': 0.9964643639955106, 'loss_val': 0.16326923683240754, 'psi': 0.9704071008810001}-{'f1_val': 0.7323610195911825, 'auprc': 0.9875128156522545, 'loss_val': 0.230783297682117, 'psi': 0.8344217380156113}
[S9] START round=42 head_norm_before_train=1.834953 cos_to_last_merge=0.9900 (last merge round=27)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9983871451404895, 'loss_val': 0.03698096714588377, 'psi': 0.993594652238953}-{'f1_val': 0.9971029125121428, 'auprc': 0.9980551972344733, 'loss_val': 0.020676565393537332, 'psi': 0.997483826401075}
[S10] START round=42 head_norm_before_train=1.812557 cos_to_last_merge=0.9864 (last merge round=26)
[S10] round=42 local utility u=0.000844 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9961811060530499, 'loss_val': 0.028652054743772516, 'psi': 0.9951899065002565}-{'f1_val': 0.9943096789853013, 'auprc': 0.996253567535224, 'loss_val': 0.029241805871647347, 'psi': 0.9950872344052704}
[S11] START round=42 head_norm_before_train=1.784809 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=42 local utility u=0.122257 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963683978474887, 'loss_val': 0.040178931431741075, 'psi': 0.9962275640869811}-{'f1_val': 0.962199870178851, 'auprc': 0.9964905512632499, 'loss_val': 0.08145620113218155, 'psi': 0.9759161426126105}
[S13] START round=42 head_norm_before_train=1.781253 cos_to_last_merge=1.0000 (last merge round=41)
[S13] round=42 local utility u=0.331255 metrics={'f1_val': 0.6019587703175951, 'auprc': 0.9329234011022122, 'loss_val': 0.7670681634207089, 'psi': 0.734344622631442}-{'f1_val': 0.5739293621381196, 'auprc': 0.850475562602378, 'loss_val': 1.0140580290144319, 'psi': 0.6845478423238229}
[S14] START round=42 head_norm_before_train=1.777971 cos_to_last_merge=0.9999 (last merge round=39)
[S14] round=42 local utility u=0.006319 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9985631417584482, 'loss_val': 0.025091574194445243, 'psi': 0.9979151033332718}-{'f1_val': 0.9965872316107504, 'auprc': 0.9970578185744785, 'loss_val': 0.02783859475063942, 'psi': 0.9967754663962416}
[S15] START round=42 head_norm_before_train=1.682308 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7031633787565537, 'auprc': 0.9226023944829171, 'loss_val': 0.4397937795377832, 'psi': 0.790938985047099}-{'f1_val': 0.9960143947672967, 'auprc': 0.9978727398946986, 'loss_val': 0.047793251912796784, 'psi': 0.9967577328182575}
[S16] START round=42 head_norm_before_train=1.696669 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.760540 metrics={'f1_val': 0.9564423142921143, 'auprc': 0.9927689041463545, 'loss_val': 0.13267309159597646, 'psi': 0.9709729502338105}-{'f1_val': 0.84290597452953, 'auprc': 0.9782218157739817, 'loss_val': 0.9288932798718963, 'psi': 0.8970323110273106}
[S17] START round=42 head_norm_before_train=1.703390 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.638175064462835, 'auprc': 0.8310784985473803, 'loss_val': 1.1388048545884317, 'psi': 0.7153364380966531}-{'f1_val': 0.6562314635878814, 'auprc': 0.7990136063645971, 'loss_val': 1.1157010443732631, 'psi': 0.7133443206985677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:51913
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S13
[S11] cosine check vs S13: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1804) from S16
[S17] cosine check vs S16: cos=0.9998
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9958
[S7] RECEIVED delta(kind=head bytes=1806) from S14
[S7] cosine check vs S14: cos=0.9999
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9975 head_norm=1.789038
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.597603e-02
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9975 head_norm=1.773442 delta_norm=0.025976
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=42 metric=0.9564 head_norm=1.713256
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.436834e-02
[S16] stored merged vector for next round verification (round=42)
[S16] DEBUG after merge:  round=42 metric=0.9566 head_norm=1.714943 delta_norm=0.034368
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] cosine check vs S11: cos=0.9999
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=42 metric=0.6837 head_norm=1.690959
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.832179e-02
[S6] stored merged vector for next round verification (round=42)
[S6] DEBUG after merge:  round=42 metric=0.6912 head_norm=1.686540 delta_norm=0.018322
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=42 metric=0.6382 head_norm=1.715047
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.163078e-02
[S17] stored merged vector for next round verification (round=42)
[S17] DEBUG after merge:  round=42 metric=0.6382 head_norm=1.719332 delta_norm=0.041631
[S17] aggregate: ACCEPT kept=['S16', 'S8'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=42 metric=0.9961 head_norm=1.796304
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.503488e-02
[S11] stored merged vector for next round verification (round=42)
[S11] DEBUG after merge:  round=42 metric=0.9961 head_norm=1.793440 delta_norm=0.015035
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.829463 cos_to_last_merge=0.9495 (last merge round=12)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7086177732456276, 'auprc': 0.8105492049491291, 'loss_val': 0.49244795576881584, 'psi': 0.7493903459270281}-{'f1_val': 0.7088277923542914, 'auprc': 0.8453788621797016, 'loss_val': 0.49327945776633647, 'psi': 0.7634482202844555}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.037824 (no previous merge yet)
[S3] round=43 local utility u=0.051113 metrics={'f1_val': 0.9973386888198309, 'auprc': 0.9985028567314025, 'loss_val': 0.025532905742762534, 'psi': 0.9978043559844595}-{'f1_val': 0.9829377018870677, 'auprc': 0.9986835099625831, 'loss_val': 0.04189539510971823, 'psi': 0.9892360251172739}
[S4] START round=43 head_norm_before_train=1.786471 cos_to_last_merge=0.9776 (last merge round=21)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.951237305385376, 'auprc': 0.9423560037908434, 'loss_val': 0.3002125204148528, 'psi': 0.947684784747563}-{'f1_val': 0.9541781904796084, 'auprc': 0.9637492664242555, 'loss_val': 0.29344729437669065, 'psi': 0.9580066208574672}
[S5] START round=43 head_norm_before_train=1.732301 cos_to_last_merge=0.9924 (last merge round=27)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.7007762147434522, 'auprc': 0.9891453730079509, 'loss_val': 0.2745770126098909, 'psi': 0.8161238780492517}-{'f1_val': 0.700320598491359, 'auprc': 0.9920831580108377, 'loss_val': 0.23934463419249308, 'psi': 0.8170256222991505}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.686540 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=43 local utility u=1.000000 metrics={'f1_val': 0.9601253548776232, 'auprc': 0.9727661877384548, 'loss_val': 0.2038299156560229, 'psi': 0.9651816880219559}-{'f1_val': 0.683666452144687, 'auprc': 0.9332855237769722, 'loss_val': 0.6718271499101381, 'psi': 0.7835140807976011}
[S7] START round=43 head_norm_before_train=1.771617 cos_to_last_merge=1.0000 (last merge round=41)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5648983414212821, 'auprc': 0.7913639821160819, 'loss_val': 0.7727897777332238, 'psi': 0.6554845976992021}-{'f1_val': 0.5968514115954694, 'auprc': 0.7972332621116867, 'loss_val': 0.6443708619145087, 'psi': 0.6770041518019563}
[S8] START round=43 head_norm_before_train=1.739523 cos_to_last_merge=0.9802 (last merge round=25)
[S8] round=43 local utility u=0.187748 metrics={'f1_val': 0.9934805280689575, 'auprc': 0.9987256140348603, 'loss_val': 0.03722741455928995, 'psi': 0.9955785624553186}-{'f1_val': 0.9530355921379932, 'auprc': 0.9964643639955106, 'loss_val': 0.16326923683240754, 'psi': 0.9704071008810001}
[S9] START round=43 head_norm_before_train=1.843204 cos_to_last_merge=0.9896 (last merge round=27)
[S9] round=43 local utility u=0.024276 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9955308993329616, 'loss_val': 0.020080273609739963, 'psi': 0.9964741072404704}-{'f1_val': 0.990399656971262, 'auprc': 0.9983871451404895, 'loss_val': 0.03698096714588377, 'psi': 0.993594652238953}
[S10] START round=43 head_norm_before_train=1.823419 cos_to_last_merge=0.9857 (last merge round=26)
[S10] round=43 local utility u=0.000867 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.99613332458121, 'loss_val': 0.02809090151929146, 'psi': 0.9953024953641074}-{'f1_val': 0.9945291067983943, 'auprc': 0.9961811060530499, 'loss_val': 0.028652054743772516, 'psi': 0.9951899065002565}
[S11] START round=43 head_norm_before_train=1.793440 cos_to_last_merge=1.0000 (last merge round=42)
[S11] round=43 local utility u=0.004953 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9976144112228312, 'loss_val': 0.03256051471393081, 'psi': 0.9965808672102809}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963683978474887, 'loss_val': 0.040178931431741075, 'psi': 0.9962275640869811}
[S13] START round=43 head_norm_before_train=1.790699 cos_to_last_merge=1.0000 (last merge round=41)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5777779641514603, 'auprc': 0.804571773270177, 'loss_val': 0.9538288201098415, 'psi': 0.6684954877989471}-{'f1_val': 0.6019587703175951, 'auprc': 0.9329234011022122, 'loss_val': 0.7670681634207089, 'psi': 0.734344622631442}
[S14] START round=43 head_norm_before_train=1.773442 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.998834381033664, 'loss_val': 0.027600158470122062, 'psi': 0.9977322573080647}-{'f1_val': 0.9974830777164877, 'auprc': 0.9985631417584482, 'loss_val': 0.025091574194445243, 'psi': 0.9979151033332718}
[S15] START round=43 head_norm_before_train=1.694469 cos_to_last_merge=0.9999 (last merge round=40)
[S15] round=43 local utility u=0.477896 metrics={'f1_val': 0.8067787505723757, 'auprc': 0.9903432032228491, 'loss_val': 0.30891654603546514, 'psi': 0.8802045316325651}-{'f1_val': 0.7031633787565537, 'auprc': 0.9226023944829171, 'loss_val': 0.4397937795377832, 'psi': 0.790938985047099}
[S16] START round=43 head_norm_before_train=1.714943 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=43 local utility u=0.067451 metrics={'f1_val': 0.9739541017277558, 'auprc': 0.9914409690654336, 'loss_val': 0.09885801612580608, 'psi': 0.9809488486628268}-{'f1_val': 0.9564423142921143, 'auprc': 0.9927689041463545, 'loss_val': 0.13267309159597646, 'psi': 0.9709729502338105}
[S17] START round=43 head_norm_before_train=1.719332 cos_to_last_merge=1.0000 (last merge round=42)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6266009170182083, 'auprc': 0.8275919135529042, 'loss_val': 1.1688790778548093, 'psi': 0.7069973156320866}-{'f1_val': 0.638175064462835, 'auprc': 0.8310784985473803, 'loss_val': 1.1388048545884317, 'psi': 0.7153364380966531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:51910
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:51917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:51903
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=43 metric=0.5649 head_norm=1.774326
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.617757e-02
[S7] stored merged vector for next round verification (round=43)
[S7] DEBUG after merge:  round=43 metric=0.5651 head_norm=1.781624 delta_norm=0.016178
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:51913
[S17] RECEIVED delta(kind=head bytes=1800) from S16
[S17] cosine check vs S16: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.9972
[S9] RECEIVED delta(kind=head bytes=1800) from S3
[S9] cosine check vs S3: cos=-0.0535
[S9] DROPPED delta from S3 (cos=-0.0535 < 0.0)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] cosine check vs S11: cos=0.9998
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] cosine check vs S9: cos=-0.0535
[S3] DROPPED delta from S9 (cos=-0.0535 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S6
[S15] cosine check vs S6: cos=0.9997
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:51907
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=43 metric=0.6266 head_norm=1.729365
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.990115e-02
[S17] stored merged vector for next round verification (round=43)
[S17] DEBUG after merge:  round=43 metric=0.6271 head_norm=1.733409 delta_norm=0.029901
[S17] aggregate: ACCEPT kept=['S16', 'S8'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=43 metric=0.5778 head_norm=1.800961
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.740162e-02
[S13] stored merged vector for next round verification (round=43)
[S13] DEBUG after merge:  round=43 metric=0.5778 head_norm=1.801010 delta_norm=0.017402
[S13] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S15] sending update (kind=head size=1806 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1806) from S15
[S6] cosine check vs S15: cos=0.9997
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=43 metric=0.8068 head_norm=1.707939
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.222961e-02
[S15] stored merged vector for next round verification (round=43)
[S15] DEBUG after merge:  round=43 metric=0.8068 head_norm=1.701518 delta_norm=0.022230
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.842792 cos_to_last_merge=0.9477 (last merge round=12)
[S2] ⚠️ Model drifted since last merge! cos=0.948
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.7029434579594216, 'auprc': 0.8009257107584843, 'loss_val': 0.5115731169456054, 'psi': 0.7421363590790466}-{'f1_val': 0.7086177732456276, 'auprc': 0.8105492049491291, 'loss_val': 0.49244795576881584, 'psi': 0.7493903459270281}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.051013 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9821044489856237, 'auprc': 0.9992173921031999, 'loss_val': 0.04516179905229576, 'psi': 0.9889496262326541}-{'f1_val': 0.9973386888198309, 'auprc': 0.9985028567314025, 'loss_val': 0.025532905742762534, 'psi': 0.9978043559844595}
[S4] START round=44 head_norm_before_train=1.790467 cos_to_last_merge=0.9766 (last merge round=21)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9459630070374534, 'auprc': 0.9431115648582536, 'loss_val': 0.30492976193142923, 'psi': 0.9448224301657735}-{'f1_val': 0.951237305385376, 'auprc': 0.9423560037908434, 'loss_val': 0.3002125204148528, 'psi': 0.947684784747563}
[S5] START round=44 head_norm_before_train=1.742042 cos_to_last_merge=0.9918 (last merge round=27)
[S5] round=44 local utility u=0.041333 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9919213450083564, 'loss_val': 0.19750480063931056, 'psi': 0.8169608970981579}-{'f1_val': 0.7007762147434522, 'auprc': 0.9891453730079509, 'loss_val': 0.2745770126098909, 'psi': 0.8161238780492517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=44 head_norm_before_train=1.695364 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.7149020600327276, 'auprc': 0.8060126700401878, 'loss_val': 0.6837187255583029, 'psi': 0.7513463040357118}-{'f1_val': 0.9601253548776232, 'auprc': 0.9727661877384548, 'loss_val': 0.2038299156560229, 'psi': 0.9651816880219559}
[S7] START round=44 head_norm_before_train=1.781624 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=44 local utility u=0.715337 metrics={'f1_val': 0.6869771652039648, 'auprc': 0.8669027788489425, 'loss_val': 0.30120556057837605, 'psi': 0.7589474106619558}-{'f1_val': 0.5648983414212821, 'auprc': 0.7913639821160819, 'loss_val': 0.7727897777332238, 'psi': 0.6554845976992021}
[S8] START round=44 head_norm_before_train=1.748052 cos_to_last_merge=0.9796 (last merge round=25)
[S8] round=44 local utility u=0.001421 metrics={'f1_val': 0.9933329447925694, 'auprc': 0.9990763536333845, 'loss_val': 0.03455283415767958, 'psi': 0.9956303083288954}-{'f1_val': 0.9934805280689575, 'auprc': 0.9987256140348603, 'loss_val': 0.03722741455928995, 'psi': 0.9955785624553186}
[S9] START round=44 head_norm_before_train=1.851541 cos_to_last_merge=0.9890 (last merge round=27)
[S9] round=44 local utility u=0.000175 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9955373718113159, 'loss_val': 0.019750543583271985, 'psi': 0.996476696231812}-{'f1_val': 0.9971029125121428, 'auprc': 0.9955308993329616, 'loss_val': 0.020080273609739963, 'psi': 0.9964741072404704}
[S10] START round=44 head_norm_before_train=1.833949 cos_to_last_merge=0.9851 (last merge round=26)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9960540173669662, 'loss_val': 0.028475970914958973, 'psi': 0.9948758022449548}-{'f1_val': 0.9947486092193725, 'auprc': 0.99613332458121, 'loss_val': 0.02809090151929146, 'psi': 0.9953024953641074}
[S11] START round=44 head_norm_before_train=1.806177 cos_to_last_merge=1.0000 (last merge round=42)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9951733908869903, 'auprc': 0.9963244287253517, 'loss_val': 0.03397694646721868, 'psi': 0.9956338060223349}-{'f1_val': 0.9958918378685807, 'auprc': 0.9976144112228312, 'loss_val': 0.03256051471393081, 'psi': 0.9965808672102809}
[S13] START round=44 head_norm_before_train=1.801010 cos_to_last_merge=1.0000 (last merge round=43)
[S13] round=44 local utility u=0.022554 metrics={'f1_val': 0.5869735496029673, 'auprc': 0.7634513813854358, 'loss_val': 0.8405323650646922, 'psi': 0.6575646823159547}-{'f1_val': 0.5777779641514603, 'auprc': 0.804571773270177, 'loss_val': 0.9538288201098415, 'psi': 0.6684954877989471}
[S14] START round=44 head_norm_before_train=1.785202 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969729063016485, 'loss_val': 0.024564846094983876, 'psi': 0.9971333765441353}-{'f1_val': 0.9969975081576651, 'auprc': 0.998834381033664, 'loss_val': 0.027600158470122062, 'psi': 0.9977322573080647}
[S15] START round=44 head_norm_before_train=1.701518 cos_to_last_merge=1.0000 (last merge round=43)
[S15] round=44 local utility u=0.705990 metrics={'f1_val': 0.9957940482196013, 'auprc': 0.9988459549699011, 'loss_val': 0.0565375131221307, 'psi': 0.9970148109197212}-{'f1_val': 0.8067787505723757, 'auprc': 0.9903432032228491, 'loss_val': 0.30891654603546514, 'psi': 0.8802045316325651}
[S16] START round=44 head_norm_before_train=1.730930 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.958072307030122, 'auprc': 0.989102835071779, 'loss_val': 0.13524201817361012, 'psi': 0.9704845182467848}-{'f1_val': 0.9739541017277558, 'auprc': 0.9914409690654336, 'loss_val': 0.09885801612580608, 'psi': 0.9809488486628268}
[S17] START round=44 head_norm_before_train=1.733409 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=44 local utility u=0.003310 metrics={'f1_val': 0.6363685278170053, 'auprc': 0.8122678261749876, 'loss_val': 1.1748926888486015, 'psi': 0.7067282471601982}-{'f1_val': 0.6266009170182083, 'auprc': 0.8275919135529042, 'loss_val': 1.1688790778548093, 'psi': 0.7069973156320866}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:51914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:51912
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:51916
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:51903
[S13] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S13
[S11] cosine check vs S13: cos=0.9998
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] cosine check vs S7: cos=0.9999
[S9] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S17
[S16] cosine check vs S17: cos=0.9994
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=-0.0543
[S3] DROPPED delta from S9 (cos=-0.0543 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:51907
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=44 metric=0.9952 head_norm=1.817797
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.696913e-02
[S11] stored merged vector for next round verification (round=44)
[S11] DEBUG after merge:  round=44 metric=0.9952 head_norm=1.814492 delta_norm=0.016969
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S15
[S6] cosine check vs S15: cos=0.9997
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=44 metric=0.7149 head_norm=1.702054
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.344303e-02
[S6] stored merged vector for next round verification (round=44)
[S6] DEBUG after merge:  round=44 metric=0.7166 head_norm=1.706820 delta_norm=0.023443
[S6] aggregate: ACCEPT kept=['S15', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.856205 cos_to_last_merge=0.9459 (last merge round=12)
[S2] ⚠️ Model drifted since last merge! cos=0.946
[S2] round=45 local utility u=0.009278 metrics={'f1_val': 0.7054476908952841, 'auprc': 0.8078709011544489, 'loss_val': 0.5288784433227316, 'psi': 0.74641697499895}-{'f1_val': 0.7029434579594216, 'auprc': 0.8009257107584843, 'loss_val': 0.5115731169456054, 'psi': 0.7421363590790466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=45 head_norm_before_train=2.062572 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9416315898410679, 'auprc': 0.9992048147624898, 'loss_val': 0.12925098869991922, 'psi': 0.9646608798096367}-{'f1_val': 0.9821044489856237, 'auprc': 0.9992173921031999, 'loss_val': 0.04516179905229576, 'psi': 0.9889496262326541}
[S4] START round=45 head_norm_before_train=1.789855 cos_to_last_merge=0.9757 (last merge round=21)
[S4] round=45 local utility u=0.021454 metrics={'f1_val': 0.9450380490527063, 'auprc': 0.9567595332672532, 'loss_val': 0.2974161530937672, 'psi': 0.949726642738525}-{'f1_val': 0.9459630070374534, 'auprc': 0.9431115648582536, 'loss_val': 0.30492976193142923, 'psi': 0.9448224301657735}
[S5] START round=45 head_norm_before_train=1.751613 cos_to_last_merge=0.9913 (last merge round=27)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.7077384547424523, 'auprc': 0.8469350308522625, 'loss_val': 0.43507740127179223, 'psi': 0.7634170851863764}-{'f1_val': 0.700320598491359, 'auprc': 0.9919213450083564, 'loss_val': 0.19750480063931056, 'psi': 0.8169608970981579}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.706820 cos_to_last_merge=1.0000 (last merge round=44)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.4847341906811205, 'auprc': 0.7779714974703573, 'loss_val': 0.8919169501580884, 'psi': 0.6020291133968152}-{'f1_val': 0.7149020600327276, 'auprc': 0.8060126700401878, 'loss_val': 0.6837187255583029, 'psi': 0.7513463040357118}
[S7] START round=45 head_norm_before_train=1.784540 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.574630552018973, 'auprc': 0.7844438218315118, 'loss_val': 0.8151865014856428, 'psi': 0.6585558599439885}-{'f1_val': 0.6869771652039648, 'auprc': 0.8669027788489425, 'loss_val': 0.30120556057837605, 'psi': 0.7589474106619558}
[S8] START round=45 head_norm_before_train=1.757604 cos_to_last_merge=0.9791 (last merge round=25)
[S8] round=45 local utility u=0.002442 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9982786578471166, 'loss_val': 0.035153067788626265, 'psi': 0.9960990420964726}-{'f1_val': 0.9933329447925694, 'auprc': 0.9990763536333845, 'loss_val': 0.03455283415767958, 'psi': 0.9956303083288954}
[S9] START round=45 head_norm_before_train=1.857676 cos_to_last_merge=0.9883 (last merge round=27)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9908329001136983, 'auprc': 0.998776145587814, 'loss_val': 0.034847640055899756, 'psi': 0.9940101983033446}-{'f1_val': 0.9971029125121428, 'auprc': 0.9955373718113159, 'loss_val': 0.019750543583271985, 'psi': 0.996476696231812}
[S10] START round=45 head_norm_before_train=1.845646 cos_to_last_merge=0.9845 (last merge round=26)
[S10] round=45 local utility u=0.001641 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9960228438865797, 'loss_val': 0.027733061309405345, 'psi': 0.9951266016336685}-{'f1_val': 0.9940903254969471, 'auprc': 0.9960540173669662, 'loss_val': 0.028475970914958973, 'psi': 0.9948758022449548}
[S11] START round=45 head_norm_before_train=1.814492 cos_to_last_merge=1.0000 (last merge round=44)
[S11] round=45 local utility u=0.006433 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9977049867349613, 'loss_val': 0.029563941698697162, 'psi': 0.9966170974151329}-{'f1_val': 0.9951733908869903, 'auprc': 0.9963244287253517, 'loss_val': 0.03397694646721868, 'psi': 0.9956338060223349}
[S13] START round=45 head_norm_before_train=1.811339 cos_to_last_merge=1.0000 (last merge round=43)
[S13] round=45 local utility u=0.414982 metrics={'f1_val': 0.6540366449764754, 'auprc': 0.8714702855764644, 'loss_val': 0.7370034998490606, 'psi': 0.7410101012164709}-{'f1_val': 0.5869735496029673, 'auprc': 0.7634513813854358, 'loss_val': 0.8405323650646922, 'psi': 0.6575646823159547}
[S14] START round=45 head_norm_before_train=1.797120 cos_to_last_merge=0.9999 (last merge round=42)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.996964854018865, 'loss_val': 0.025273053488221706, 'psi': 0.996883989702873}-{'f1_val': 0.997240356705793, 'auprc': 0.9969729063016485, 'loss_val': 0.024564846094983876, 'psi': 0.9971333765441353}
[S15] START round=45 head_norm_before_train=1.715875 cos_to_last_merge=1.0000 (last merge round=43)
[S15] round=45 local utility u=0.012018 metrics={'f1_val': 0.9966758836715433, 'auprc': 0.9977541973117383, 'loss_val': 0.03451734777724791, 'psi': 0.9971072091276212}-{'f1_val': 0.9957940482196013, 'auprc': 0.9988459549699011, 'loss_val': 0.0565375131221307, 'psi': 0.9970148109197212}
[S16] START round=45 head_norm_before_train=1.746147 cos_to_last_merge=0.9998 (last merge round=42)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9389530765672617, 'auprc': 0.9865225441402807, 'loss_val': 0.28806612610844573, 'psi': 0.9579808635964693}-{'f1_val': 0.958072307030122, 'auprc': 0.989102835071779, 'loss_val': 0.13524201817361012, 'psi': 0.9704845182467848}
[S17] START round=45 head_norm_before_train=1.744752 cos_to_last_merge=0.9999 (last merge round=43)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6403048047848652, 'auprc': 0.7976777412394296, 'loss_val': 1.2645022507427777, 'psi': 0.703253979366691}-{'f1_val': 0.6363685278170053, 'auprc': 0.8122678261749876, 'loss_val': 1.1748926888486015, 'psi': 0.7067282471601982}
[S4]  timeout peer S11
[S10]  timeout peer S6
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:51912
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:51913
[S3] ⇄ pheromone p=0.089 → S9@127.0.0.1:51910
[S7] ⇄ pheromone p=0.256 → S14@127.0.0.1:51914
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=45 metric=0.9968 head_norm=1.808255
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.935352e-02
[S14] stored merged vector for next round verification (round=45)
[S14] DEBUG after merge:  round=45 metric=0.9968 head_norm=1.796332 delta_norm=0.019354
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.012 → S7@127.0.0.1:51908
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1801) from S13
[S11] cosine check vs S13: cos=0.9998
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:51907
[S13] ⇄ pheromone p=0.173 → S11@127.0.0.1:51912
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=0.9998
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1804) from S15
[S6] cosine check vs S15: cos=0.9998
[S9] ⇄ pheromone p=0.006 → S3@127.0.0.1:51903
[S17] ⇄ pheromone p=0.085 → S16@127.0.0.1:51916
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=45 metric=0.9390 head_norm=1.760516
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.605431e-02
[S16] stored merged vector for next round verification (round=45)
[S16] DEBUG after merge:  round=45 metric=0.9390 head_norm=1.752281 delta_norm=0.036054
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.128 → S17@127.0.0.1:51917
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=45 metric=0.9959 head_norm=1.825394
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.907993e-02
[S11] stored merged vector for next round verification (round=45)
[S11] DEBUG after merge:  round=45 metric=0.9959 head_norm=1.822605 delta_norm=0.019080
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.019 → S13@127.0.0.1:51913
[S15] ⇄ pheromone p=0.342 → S6@127.0.0.1:51907
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=45 metric=0.4847 head_norm=1.712790
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.997493e-02
[S6] stored merged vector for next round verification (round=45)
[S6] DEBUG after merge:  round=45 metric=0.4928 head_norm=1.721623 delta_norm=0.019975
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.260 → S15@127.0.0.1:51915
[S2] START round=46 head_norm_before_train=1.867503 cos_to_last_merge=0.9444 (last merge round=12)
[S2] ⚠️ Model drifted since last merge! cos=0.944
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6942475979708919, 'auprc': 0.7822579406125256, 'loss_val': 0.62682860839756, 'psi': 0.7294517350275453}-{'f1_val': 0.7054476908952841, 'auprc': 0.8078709011544489, 'loss_val': 0.5288784433227316, 'psi': 0.74641697499895}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.073855 (no previous merge yet)
[S3] round=46 local utility u=0.199481 metrics={'f1_val': 0.9932252906909314, 'auprc': 0.9994342319536949, 'loss_val': 0.04053943111452561, 'psi': 0.9957088671960368}-{'f1_val': 0.9416315898410679, 'auprc': 0.9992048147624898, 'loss_val': 0.12925098869991922, 'psi': 0.9646608798096367}
[S4] START round=46 head_norm_before_train=1.787953 cos_to_last_merge=0.9749 (last merge round=21)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9377775361523283, 'auprc': 0.9215687897383624, 'loss_val': 0.3460233457208208, 'psi': 0.931294037586742}-{'f1_val': 0.9450380490527063, 'auprc': 0.9567595332672532, 'loss_val': 0.2974161530937672, 'psi': 0.949726642738525}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.761595 cos_to_last_merge=0.9906 (last merge round=27)
[S5] round=46 local utility u=0.310536 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9942874920050536, 'loss_val': 0.21304605004998783, 'psi': 0.8180564899081797}-{'f1_val': 0.7077384547424523, 'auprc': 0.8469350308522625, 'loss_val': 0.43507740127179223, 'psi': 0.7634170851863764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=46 head_norm_before_train=1.721623 cos_to_last_merge=1.0000 (last merge round=45)
[S6] round=46 local utility u=1.000000 metrics={'f1_val': 0.821887222783592, 'auprc': 0.9519642841904989, 'loss_val': 0.39887861085242726, 'psi': 0.8739180473463548}-{'f1_val': 0.4847341906811205, 'auprc': 0.7779714974703573, 'loss_val': 0.8919169501580884, 'psi': 0.6020291133968152}
[S7] START round=46 head_norm_before_train=1.789508 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=46 local utility u=0.233281 metrics={'f1_val': 0.6191666718221734, 'auprc': 0.7926745829054206, 'loss_val': 0.6405336107227149, 'psi': 0.6885698362554723}-{'f1_val': 0.574630552018973, 'auprc': 0.7844438218315118, 'loss_val': 0.8151865014856428, 'psi': 0.6585558599439885}
[S8] START round=46 head_norm_before_train=1.767741 cos_to_last_merge=0.9784 (last merge round=25)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9916698259783234, 'auprc': 0.993538625100595, 'loss_val': 0.037656311604922096, 'psi': 0.992417345627232}-{'f1_val': 0.9946459649293765, 'auprc': 0.9982786578471166, 'loss_val': 0.035153067788626265, 'psi': 0.9960990420964726}
[S9] START round=46 head_norm_before_train=1.864112 cos_to_last_merge=0.9875 (last merge round=27)
[S9] round=46 local utility u=0.021973 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9987349496912685, 'loss_val': 0.02094166288684282, 'psi': 0.9970100624023006}-{'f1_val': 0.9908329001136983, 'auprc': 0.998776145587814, 'loss_val': 0.034847640055899756, 'psi': 0.9940101983033446}
[S10] START round=46 head_norm_before_train=1.857899 cos_to_last_merge=0.9839 (last merge round=26)
[S10] round=46 local utility u=0.000822 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9959022957451563, 'loss_val': 0.027044634045379847, 'psi': 0.995210083829686}-{'f1_val': 0.9945291067983943, 'auprc': 0.9960228438865797, 'loss_val': 0.027733061309405345, 'psi': 0.9951266016336685}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=46 head_norm_before_train=1.822605 cos_to_last_merge=1.0000 (last merge round=45)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9880331263373447, 'auprc': 0.9963829407014492, 'loss_val': 0.05793913485975516, 'psi': 0.9913730520829864}-{'f1_val': 0.9958918378685807, 'auprc': 0.9977049867349613, 'loss_val': 0.029563941698697162, 'psi': 0.9966170974151329}
[S13] START round=46 head_norm_before_train=1.820012 cos_to_last_merge=0.9998 (last merge round=43)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.56267016192672, 'auprc': 0.722995408519636, 'loss_val': 1.138050713832319, 'psi': 0.6268002605638864}-{'f1_val': 0.6540366449764754, 'auprc': 0.8714702855764644, 'loss_val': 0.7370034998490606, 'psi': 0.7410101012164709}
[S14] START round=46 head_norm_before_train=1.796332 cos_to_last_merge=1.0000 (last merge round=45)
[S14] round=46 local utility u=0.002386 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9985694116369637, 'loss_val': 0.02531526562471646, 'psi': 0.9975258127501123}-{'f1_val': 0.9968300801588782, 'auprc': 0.996964854018865, 'loss_val': 0.025273053488221706, 'psi': 0.996883989702873}
[S15] START round=46 head_norm_before_train=1.730642 cos_to_last_merge=0.9999 (last merge round=43)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7007681293011265, 'auprc': 0.8593940855725617, 'loss_val': 0.5578632287556353, 'psi': 0.7642185118097007}-{'f1_val': 0.9966758836715433, 'auprc': 0.9977541973117383, 'loss_val': 0.03451734777724791, 'psi': 0.9971072091276212}
[S16] START round=46 head_norm_before_train=1.752281 cos_to_last_merge=1.0000 (last merge round=45)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9348373449239901, 'auprc': 0.9889559197656296, 'loss_val': 0.33684366468794236, 'psi': 0.9564847748606458}-{'f1_val': 0.9389530765672617, 'auprc': 0.9865225441402807, 'loss_val': 0.28806612610844573, 'psi': 0.9579808635964693}
[S17] START round=46 head_norm_before_train=1.756368 cos_to_last_merge=0.9998 (last merge round=43)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.44552348131200586, 'auprc': 0.8197574035244123, 'loss_val': 1.6221591630464698, 'psi': 0.5952170501969685}-{'f1_val': 0.6403048047848652, 'auprc': 0.7976777412394296, 'loss_val': 1.2645022507427777, 'psi': 0.703253979366691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:51914
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:51910
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:51908
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=46 metric=0.5627 head_norm=1.827525
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.478884e-02
[S13] stored merged vector for next round verification (round=46)
[S13] DEBUG after merge:  round=46 metric=0.5590 head_norm=1.826291 delta_norm=0.024789
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:51903
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9998
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] cosine check vs S3: cos=-0.0560
[S9] DROPPED delta from S3 (cos=-0.0560 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.9998
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:51915
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=46 metric=0.9968 head_norm=1.808552
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.911244e-02
[S14] stored merged vector for next round verification (round=46)
[S14] DEBUG after merge:  round=46 metric=0.9968 head_norm=1.803259 delta_norm=0.019112
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1799 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=46 metric=0.6192 head_norm=1.798153
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.911245e-02
[S7] stored merged vector for next round verification (round=46)
[S7] DEBUG after merge:  round=46 metric=0.6191 head_norm=1.803259 delta_norm=0.019112
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=-0.0560
[S3] DROPPED delta from S9 (cos=-0.0560 < 0.0)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] cosine check vs S6: cos=0.9998
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=46 metric=0.7008 head_norm=1.742720
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.828500e-02
[S15] stored merged vector for next round verification (round=46)
[S15] DEBUG after merge:  round=46 metric=0.7008 head_norm=1.734231 delta_norm=0.018285
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.877771 cos_to_last_merge=0.9430 (last merge round=12)
[S2] ⚠️ Model drifted since last merge! cos=0.943
[S2] round=47 local utility u=0.153939 metrics={'f1_val': 0.708943972503941, 'auprc': 0.8157201467191958, 'loss_val': 0.5075162392317326, 'psi': 0.751654442190043}-{'f1_val': 0.6942475979708919, 'auprc': 0.7822579406125256, 'loss_val': 0.62682860839756, 'psi': 0.7294517350275453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=47 head_norm_before_train=2.085676 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9637672850740305, 'auprc': 0.9986338218364654, 'loss_val': 0.06120789147902099, 'psi': 0.9777138997790045}-{'f1_val': 0.9932252906909314, 'auprc': 0.9994342319536949, 'loss_val': 0.04053943111452561, 'psi': 0.9957088671960368}
[S4] START round=47 head_norm_before_train=1.786087 cos_to_last_merge=0.9741 (last merge round=21)
[S4] round=47 local utility u=0.035312 metrics={'f1_val': 0.9429914640302383, 'auprc': 0.9225565979393021, 'loss_val': 0.3096471167091872, 'psi': 0.9348175175938638}-{'f1_val': 0.9377775361523283, 'auprc': 0.9215687897383624, 'loss_val': 0.3460233457208208, 'psi': 0.931294037586742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=47 head_norm_before_train=1.768647 cos_to_last_merge=0.9901 (last merge round=27)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.991204997112914, 'loss_val': 0.23915147213765198, 'psi': 0.816777975726457}-{'f1_val': 0.7005691551769304, 'auprc': 0.9942874920050536, 'loss_val': 0.21304605004998783, 'psi': 0.8180564899081797}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.725894 cos_to_last_merge=1.0000 (last merge round=45)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6430058627665914, 'auprc': 0.8382445948776931, 'loss_val': 0.6944910559114593, 'psi': 0.7211013556110322}-{'f1_val': 0.821887222783592, 'auprc': 0.9519642841904989, 'loss_val': 0.39887861085242726, 'psi': 0.8739180473463548}
[S7] START round=47 head_norm_before_train=1.803259 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=47 local utility u=0.450975 metrics={'f1_val': 0.6964346969222677, 'auprc': 0.8359390675632896, 'loss_val': 0.3319857129047747, 'psi': 0.7522364451786765}-{'f1_val': 0.6191666718221734, 'auprc': 0.7926745829054206, 'loss_val': 0.6405336107227149, 'psi': 0.6885698362554723}
[S8] START round=47 head_norm_before_train=1.777580 cos_to_last_merge=0.9776 (last merge round=25)
[S8] round=47 local utility u=0.012547 metrics={'f1_val': 0.9938540024962192, 'auprc': 0.9961892094186199, 'loss_val': 0.033618719954250344, 'psi': 0.9947880852651796}-{'f1_val': 0.9916698259783234, 'auprc': 0.993538625100595, 'loss_val': 0.037656311604922096, 'psi': 0.992417345627232}
[S9] START round=47 head_norm_before_train=1.870931 cos_to_last_merge=0.9869 (last merge round=27)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.993601746155419, 'loss_val': 0.020650982671825534, 'psi': 0.9954561932210249}-{'f1_val': 0.9958601375429889, 'auprc': 0.9987349496912685, 'loss_val': 0.02094166288684282, 'psi': 0.9970100624023006}
[S10] START round=47 head_norm_before_train=1.867899 cos_to_last_merge=0.9833 (last merge round=26)
[S10] round=47 local utility u=0.000232 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9959689650014224, 'loss_val': 0.026779875835011995, 'psi': 0.9952367515321925}-{'f1_val': 0.9947486092193725, 'auprc': 0.9959022957451563, 'loss_val': 0.027044634045379847, 'psi': 0.995210083829686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=47 head_norm_before_train=1.832902 cos_to_last_merge=1.0000 (last merge round=45)
[S11] round=47 local utility u=0.039874 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9976639444779793, 'loss_val': 0.029185555701802576, 'psi': 0.9966006805123402}-{'f1_val': 0.9880331263373447, 'auprc': 0.9963829407014492, 'loss_val': 0.05793913485975516, 'psi': 0.9913730520829864}
[S13] START round=47 head_norm_before_train=1.826291 cos_to_last_merge=1.0000 (last merge round=46)
[S13] round=47 local utility u=1.000000 metrics={'f1_val': 0.8127294125829938, 'auprc': 0.9418007828838115, 'loss_val': 0.5037726015639195, 'psi': 0.8643579607033209}-{'f1_val': 0.56267016192672, 'auprc': 0.722995408519636, 'loss_val': 1.138050713832319, 'psi': 0.6268002605638864}
[S14] START round=47 head_norm_before_train=1.803259 cos_to_last_merge=1.0000 (last merge round=46)
[S14] round=47 local utility u=0.000234 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9985690812794824, 'loss_val': 0.02484711352290659, 'psi': 0.9975256806071198}-{'f1_val': 0.9968300801588782, 'auprc': 0.9985694116369637, 'loss_val': 0.02531526562471646, 'psi': 0.9975258127501123}
[S15] START round=47 head_norm_before_train=1.734231 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=47 local utility u=0.899032 metrics={'f1_val': 0.8795263842677571, 'auprc': 0.9953334790616276, 'loss_val': 0.24016703219157853, 'psi': 0.9258492221853052}-{'f1_val': 0.7007681293011265, 'auprc': 0.8593940855725617, 'loss_val': 0.5578632287556353, 'psi': 0.7642185118097007}
[S16] START round=47 head_norm_before_train=1.766151 cos_to_last_merge=1.0000 (last merge round=45)
[S16] round=47 local utility u=0.059876 metrics={'f1_val': 0.9400145761351821, 'auprc': 0.9899849824704625, 'loss_val': 0.2512422070783082, 'psi': 0.9600027386692943}-{'f1_val': 0.9348373449239901, 'auprc': 0.9889559197656296, 'loss_val': 0.33684366468794236, 'psi': 0.9564847748606458}
[S17] START round=47 head_norm_before_train=1.765330 cos_to_last_merge=0.9996 (last merge round=43)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.3163762802325249, 'auprc': 0.7624016731741801, 'loss_val': 2.0563814278217496, 'psi': 0.49478643740918693}-{'f1_val': 0.44552348131200586, 'auprc': 0.8197574035244123, 'loss_val': 1.6221591630464698, 'psi': 0.5952170501969685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:51914
[S7] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=1.0000
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1801) from S13
[S11] cosine check vs S13: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] cosine check vs S16: cos=0.9991
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:51907
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=47 metric=0.9968 head_norm=1.815536
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.387579e-03
[S14] stored merged vector for next round verification (round=47)
[S14] DEBUG after merge:  round=47 metric=0.9968 head_norm=1.812391 delta_norm=0.008388
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=47 metric=0.6964 head_norm=1.809279
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.387566e-03
[S7] stored merged vector for next round verification (round=47)
[S7] DEBUG after merge:  round=47 metric=0.6930 head_norm=1.812391 delta_norm=0.008388
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S15
[S6] cosine check vs S15: cos=0.9998
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=47 metric=0.3164 head_norm=1.771617
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.821458e-02
[S17] stored merged vector for next round verification (round=47)
[S17] DEBUG after merge:  round=47 metric=0.3183 head_norm=1.774918 delta_norm=0.038215
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:51913
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=0.9999
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=47 metric=0.9959 head_norm=1.839623
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.241038e-02
[S11] stored merged vector for next round verification (round=47)
[S11] DEBUG after merge:  round=47 metric=0.9959 head_norm=1.836111 delta_norm=0.012410
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=47 metric=0.6430 head_norm=1.737972
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.881254e-02
[S6] stored merged vector for next round verification (round=47)
[S6] DEBUG after merge:  round=47 metric=0.6594 head_norm=1.741328 delta_norm=0.018813
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.888092 cos_to_last_merge=0.9416 (last merge round=12)
[S2] ⚠️ Model drifted since last merge! cos=0.942
[S2] round=48 local utility u=0.098042 metrics={'f1_val': 0.7088297013900926, 'auprc': 0.8873552904648925, 'loss_val': 0.525651951573639, 'psi': 0.7802399370200126}-{'f1_val': 0.708943972503941, 'auprc': 0.8157201467191958, 'loss_val': 0.5075162392317326, 'psi': 0.751654442190043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=48 head_norm_before_train=2.097904 (no previous merge yet)
[S3] round=48 local utility u=0.073508 metrics={'f1_val': 0.9842333485359276, 'auprc': 0.998737961600834, 'loss_val': 0.03730005127622173, 'psi': 0.9900351937618902}-{'f1_val': 0.9637672850740305, 'auprc': 0.9986338218364654, 'loss_val': 0.06120789147902099, 'psi': 0.9777138997790045}
[S4] START round=48 head_norm_before_train=1.784968 cos_to_last_merge=0.9738 (last merge round=21)
[S4] round=48 local utility u=0.086725 metrics={'f1_val': 0.9551731676132692, 'auprc': 0.9467573324809628, 'loss_val': 0.2818894047445336, 'psi': 0.9518068335603467}-{'f1_val': 0.9429914640302383, 'auprc': 0.9225565979393021, 'loss_val': 0.3096471167091872, 'psi': 0.9348175175938638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=48 head_norm_before_train=1.774700 cos_to_last_merge=0.9897 (last merge round=27)
[S5] round=48 local utility u=0.006554 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.991512996762212, 'loss_val': 0.22741808044970901, 'psi': 0.8169463047076759}-{'f1_val': 0.7004932948021524, 'auprc': 0.991204997112914, 'loss_val': 0.23915147213765198, 'psi': 0.816777975726457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=48 head_norm_before_train=1.741328 cos_to_last_merge=1.0000 (last merge round=47)
[S6] round=48 local utility u=0.698435 metrics={'f1_val': 0.7773662311742633, 'auprc': 0.9536205125407052, 'loss_val': 0.4499106670719748, 'psi': 0.8478679437208401}-{'f1_val': 0.6430058627665914, 'auprc': 0.8382445948776931, 'loss_val': 0.6944910559114593, 'psi': 0.7211013556110322}
[S7] START round=48 head_norm_before_train=1.812391 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5927847778329958, 'auprc': 0.7839708591189457, 'loss_val': 0.8339419716456786, 'psi': 0.6692592103473758}-{'f1_val': 0.6964346969222677, 'auprc': 0.8359390675632896, 'loss_val': 0.3319857129047747, 'psi': 0.7522364451786765}
[S8] START round=48 head_norm_before_train=1.786718 cos_to_last_merge=0.9769 (last merge round=25)
[S8] round=48 local utility u=0.005364 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9991286064052197, 'loss_val': 0.0320576598190269, 'psi': 0.995998807429096}-{'f1_val': 0.9938540024962192, 'auprc': 0.9961892094186199, 'loss_val': 0.033618719954250344, 'psi': 0.9947880852651796}
[S9] START round=48 head_norm_before_train=1.876776 cos_to_last_merge=0.9865 (last merge round=27)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.988279001546821, 'auprc': 0.9990072576916607, 'loss_val': 0.04394284674562279, 'psi': 0.9925703040047569}-{'f1_val': 0.9966924912647621, 'auprc': 0.993601746155419, 'loss_val': 0.020650982671825534, 'psi': 0.9954561932210249}
[S10] START round=48 head_norm_before_train=1.875656 cos_to_last_merge=0.9827 (last merge round=26)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9961090802079081, 'loss_val': 0.02681234376205178, 'psi': 0.9951610961621998}-{'f1_val': 0.9947486092193725, 'auprc': 0.9959689650014224, 'loss_val': 0.026779875835011995, 'psi': 0.9952367515321925}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.836111 cos_to_last_merge=1.0000 (last merge round=47)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9976811967894923, 'loss_val': 0.030326317291444777, 'psi': 0.9966075814369453}-{'f1_val': 0.9958918378685807, 'auprc': 0.9976639444779793, 'loss_val': 0.029185555701802576, 'psi': 0.9966006805123402}
[S13] START round=48 head_norm_before_train=1.832677 cos_to_last_merge=1.0000 (last merge round=46)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6534702865322264, 'auprc': 0.8219446084965869, 'loss_val': 0.694437957859174, 'psi': 0.7208600153179706}-{'f1_val': 0.8127294125829938, 'auprc': 0.9418007828838115, 'loss_val': 0.5037726015639195, 'psi': 0.8643579607033209}
[S14] START round=48 head_norm_before_train=1.812391 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=48 local utility u=0.000261 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9984604528552562, 'loss_val': 0.02500345608071344, 'psi': 0.9975826860367015}-{'f1_val': 0.9968300801588782, 'auprc': 0.9985690812794824, 'loss_val': 0.02484711352290659, 'psi': 0.9975256806071198}
[S15] START round=48 head_norm_before_train=1.744880 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=48 local utility u=0.434102 metrics={'f1_val': 0.9904796716949915, 'auprc': 0.9967465190872771, 'loss_val': 0.04192177227578881, 'psi': 0.9929864106519057}-{'f1_val': 0.8795263842677571, 'auprc': 0.9953334790616276, 'loss_val': 0.24016703219157853, 'psi': 0.9258492221853052}
[S16] START round=48 head_norm_before_train=1.779034 cos_to_last_merge=0.9999 (last merge round=45)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9346212673395988, 'auprc': 0.9900764766162653, 'loss_val': 0.3400262048861483, 'psi': 0.9568033510502654}-{'f1_val': 0.9400145761351821, 'auprc': 0.9899849824704625, 'loss_val': 0.2512422070783082, 'psi': 0.9600027386692943}
[S17] START round=48 head_norm_before_train=1.774918 cos_to_last_merge=1.0000 (last merge round=47)
[S17] round=48 local utility u=0.327975 metrics={'f1_val': 0.3652981093651937, 'auprc': 0.7971021173898902, 'loss_val': 1.7980632479564869, 'psi': 0.5380197125750723}-{'f1_val': 0.3163762802325249, 'auprc': 0.7624016731741801, 'loss_val': 2.0563814278217496, 'psi': 0.49478643740918693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:51908
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1795 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=48 metric=0.6535 head_norm=1.836914
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.450129e-02
[S13] stored merged vector for next round verification (round=48)
[S13] DEBUG after merge:  round=48 metric=0.6456 head_norm=1.838211 delta_norm=0.014501
[S13] aggregate: ROLLBACK (f1_val pre=0.653 post=0.646 tol_abs=0.005 tol_rel=0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:51916
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=1.0000
[S9] RECEIVED delta(kind=head bytes=1795) from S3
[S9] cosine check vs S3: cos=-0.0564
[S9] DROPPED delta from S3 (cos=-0.0564 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:51915
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=0.9997
[S6] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] cosine check vs S6: cos=0.9998
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:51907
[S15] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S15
[S6] cosine check vs S15: cos=0.9998
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=48 metric=0.9905 head_norm=1.756584
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.922374e-02
[S15] stored merged vector for next round verification (round=48)
[S15] DEBUG after merge:  round=48 metric=0.9909 head_norm=1.754992 delta_norm=0.019224
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=48 metric=0.7774 head_norm=1.753609
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.922374e-02
[S6] stored merged vector for next round verification (round=48)
[S6] DEBUG after merge:  round=48 metric=0.7858 head_norm=1.754992 delta_norm=0.019224
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.898973 cos_to_last_merge=0.9402 (last merge round=12)
[S2] ⚠️ Model drifted since last merge! cos=0.940
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.7051642876518742, 'auprc': 0.8088871390518557, 'loss_val': 0.5101355221571363, 'psi': 0.7466534282118669}-{'f1_val': 0.7088297013900926, 'auprc': 0.8873552904648925, 'loss_val': 0.525651951573639, 'psi': 0.7802399370200126}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.108294 (no previous merge yet)
[S3] round=49 local utility u=0.049668 metrics={'f1_val': 0.9977533136161222, 'auprc': 0.99885380345579, 'loss_val': 0.019431005440857987, 'psi': 0.9981935095519893}-{'f1_val': 0.9842333485359276, 'auprc': 0.998737961600834, 'loss_val': 0.03730005127622173, 'psi': 0.9900351937618902}
[S4] START round=49 head_norm_before_train=1.786297 cos_to_last_merge=0.9733 (last merge round=21)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9414821513710183, 'auprc': 0.935948056787867, 'loss_val': 0.3078136567508186, 'psi': 0.9392685135377578}-{'f1_val': 0.9551731676132692, 'auprc': 0.9467573324809628, 'loss_val': 0.2818894047445336, 'psi': 0.9518068335603467}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.781103 cos_to_last_merge=0.9893 (last merge round=27)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.7007326008090236, 'auprc': 0.9449914049649163, 'loss_val': 0.3655340260445483, 'psi': 0.7984361224713807}-{'f1_val': 0.7005685100046517, 'auprc': 0.991512996762212, 'loss_val': 0.22741808044970901, 'psi': 0.8169463047076759}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.754992 cos_to_last_merge=1.0000 (last merge round=48)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.7249014773007388, 'auprc': 0.9541146954831126, 'loss_val': 0.6285852312151898, 'psi': 0.8165867645736884}-{'f1_val': 0.7773662311742633, 'auprc': 0.9536205125407052, 'loss_val': 0.4499106670719748, 'psi': 0.8478679437208401}
[S7] START round=49 head_norm_before_train=1.815862 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=49 local utility u=0.255770 metrics={'f1_val': 0.6265676269540517, 'auprc': 0.7966744944683818, 'loss_val': 0.5632109537048612, 'psi': 0.6946103739597838}-{'f1_val': 0.5927847778329958, 'auprc': 0.7839708591189457, 'loss_val': 0.8339419716456786, 'psi': 0.6692592103473758}
[S8] START round=49 head_norm_before_train=1.795153 cos_to_last_merge=0.9763 (last merge round=25)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9917351758735767, 'auprc': 0.999235780524555, 'loss_val': 0.03454508921342545, 'psi': 0.994735417733968}-{'f1_val': 0.9939122747783468, 'auprc': 0.9991286064052197, 'loss_val': 0.0320576598190269, 'psi': 0.995998807429096}
[S9] START round=49 head_norm_before_train=1.882389 cos_to_last_merge=0.9861 (last merge round=27)
[S9] round=49 local utility u=0.029486 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9989547489897961, 'loss_val': 0.022781110592303817, 'psi': 0.9963460893655398}-{'f1_val': 0.988279001546821, 'auprc': 0.9990072576916607, 'loss_val': 0.04394284674562279, 'psi': 0.9925703040047569}
[S10] START round=49 head_norm_before_train=1.885107 cos_to_last_merge=0.9821 (last merge round=26)
[S10] round=49 local utility u=0.000805 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9960834615999267, 'loss_val': 0.026442596832291502, 'psi': 0.9952825501715942}-{'f1_val': 0.9945291067983943, 'auprc': 0.9961090802079081, 'loss_val': 0.02681234376205178, 'psi': 0.9951610961621998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=49 head_norm_before_train=1.841839 cos_to_last_merge=1.0000 (last merge round=47)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.8650368677533461, 'auprc': 0.9962087579757893, 'loss_val': 0.2222948234648712, 'psi': 0.9175056238423234}-{'f1_val': 0.9958918378685807, 'auprc': 0.9976811967894923, 'loss_val': 0.030326317291444777, 'psi': 0.9966075814369453}
[S13] START round=49 head_norm_before_train=1.838211 cos_to_last_merge=1.0000 (last merge round=48)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5270974885936981, 'auprc': 0.6889203024507129, 'loss_val': 1.32739395024913, 'psi': 0.5918266141365041}-{'f1_val': 0.6534702865322264, 'auprc': 0.8219446084965869, 'loss_val': 0.694437957859174, 'psi': 0.7208600153179706}
[S14] START round=49 head_norm_before_train=1.820661 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=49 local utility u=0.002527 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.998334276178287, 'loss_val': 0.023491881185028034, 'psi': 0.997924381301227}-{'f1_val': 0.9969975081576651, 'auprc': 0.9984604528552562, 'loss_val': 0.02500345608071344, 'psi': 0.9975826860367015}
[S15] START round=49 head_norm_before_train=1.754992 cos_to_last_merge=1.0000 (last merge round=48)
[S15] round=49 local utility u=0.019629 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9963946587551404, 'loss_val': 0.03662839721623023, 'psi': 0.9963477262746088}-{'f1_val': 0.9904796716949915, 'auprc': 0.9967465190872771, 'loss_val': 0.04192177227578881, 'psi': 0.9929864106519057}
[S16] START round=49 head_norm_before_train=1.790903 cos_to_last_merge=0.9998 (last merge round=45)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8752986885802935, 'auprc': 0.9590828206260412, 'loss_val': 0.7226494406934613, 'psi': 0.9088123413985926}-{'f1_val': 0.9346212673395988, 'auprc': 0.9900764766162653, 'loss_val': 0.3400262048861483, 'psi': 0.9568033510502654}
[S17] START round=49 head_norm_before_train=1.779286 cos_to_last_merge=1.0000 (last merge round=47)
[S17] round=49 local utility u=0.497817 metrics={'f1_val': 0.5084842032483401, 'auprc': 0.7652224010181445, 'loss_val': 1.5659062424263748, 'psi': 0.611179482356262}-{'f1_val': 0.3652981093651937, 'auprc': 0.7971021173898902, 'loss_val': 1.7980632479564869, 'psi': 0.5380197125750723}
[S8]  timeout peer S17
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:51908
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:51914
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:51903
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=49 metric=0.8753 head_norm=1.801498
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.983308e-02
[S16] stored merged vector for next round verification (round=49)
[S16] DEBUG after merge:  round=49 metric=0.8753 head_norm=1.790178 delta_norm=0.029833
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9999
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=49 metric=0.9977 head_norm=1.829494
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.192360e-02
[S14] stored merged vector for next round verification (round=49)
[S14] DEBUG after merge:  round=49 metric=0.9977 head_norm=1.825199 delta_norm=0.011924
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=49 metric=0.6266 head_norm=1.820972
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.340322e-03
[S7] stored merged vector for next round verification (round=49)
[S7] DEBUG after merge:  round=49 metric=0.6264 head_norm=1.822998 delta_norm=0.009340
[S7] aggregate: ACCEPT kept=['S14', 'S14'] (k=2/2) mode=median trim_p=0.1
[S9] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=-0.0575
[S3] DROPPED delta from S9 (cos=-0.0575 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:51907
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S15
[S6] cosine check vs S15: cos=0.9999
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=-0.0575
[S9] DROPPED delta from S3 (cos=-0.0575 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:51916
[S17] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S17
[S16] cosine check vs S17: cos=0.9999
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=49 metric=0.7249 head_norm=1.771403
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.206101e-02
[S6] stored merged vector for next round verification (round=49)
[S6] DEBUG after merge:  round=49 metric=0.7278 head_norm=1.769371 delta_norm=0.012061
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
