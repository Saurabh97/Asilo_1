[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:51903
[S3] → join 127.0.0.1:51902
[S4] → join 127.0.0.1:51902
[S5] → join 127.0.0.1:51902
[S6] → join 127.0.0.1:51902
[S7] → join 127.0.0.1:51902
[S8] → join 127.0.0.1:51902
[S9] → join 127.0.0.1:51902
[S10] → join 127.0.0.1:51902
[S11] → join 127.0.0.1:51902
[S13] → join 127.0.0.1:51902
[S14] → join 127.0.0.1:51902
[S15] → join 127.0.0.1:51902
[S16] → join 127.0.0.1:51902
[S17] → join 127.0.0.1:51902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.157934 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.181109 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.163881 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.162143 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.148002 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.147312 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.143304 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.257825 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.183857 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.166289 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.113090 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.175326 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.156235 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.146859 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.153324 (no previous merge yet)
[S13]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3] + discovered S6
[S3] + discovered S15
[S3] + discovered S10
[S3] + discovered S9
[S3] + discovered S11
[S3] + discovered S16
[S4] + discovered S2
[S3] + discovered S7
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S17
[S3] + discovered S13
[S3] + discovered S8
[S3] + discovered S4
[S4] + discovered S3
[S4] + discovered S7
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S10
[S4] + discovered S11
[S4] + discovered S9
[S4] + discovered S6
[S4] + discovered S16
[S4] + discovered S15
[S4] + discovered S8
[S4] + discovered S17
[S4] + discovered S13
[S4] + discovered S14
[S4] + discovered S5
[S5] + discovered S2
[S5] + discovered S10
[S5] + discovered S13
[S6] + discovered S3
[S5] + discovered S15
[S5] + discovered S11
[S5] + discovered S14
[S6] + discovered S5
[S5] + discovered S7
[S5] + discovered S9
[S5] + discovered S8
[S5] + discovered S16
[S5] + discovered S6
[S6] + discovered S4
[S6] + discovered S2
[S5] + discovered S17
[S6] + discovered S8
[S6] + discovered S9
[S7] + discovered S2
[S7] + discovered S4
[S6] + discovered S14
[S7] + discovered S3
[S7] + discovered S5
[S6] + discovered S7
[S6] + discovered S11
[S6] + discovered S16
[S7] + discovered S6
[S6] + discovered S17
[S6] + discovered S13
[S6] + discovered S15
[S6] + discovered S10
[S7] + discovered S16
[S7] + discovered S15
[S7] + discovered S8
[S7] + discovered S9
[S7] + discovered S10
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S2
[S7] + discovered S17
[S8] + discovered S6
[S7] + discovered S14
[S7] + discovered S11
[S7] + discovered S13
[S8] + discovered S3
[S8] + discovered S5
[S8] + discovered S15
[S8] + discovered S17
[S9] + discovered S8
[S9] + discovered S3
[S8] + discovered S13
[S9] + discovered S5
[S9] + discovered S2
[S9] + discovered S4
[S8] + discovered S16
[S8] + discovered S11
[S9] + discovered S6
[S9] + discovered S7
[S8] + discovered S9
[S8] + discovered S14
[S8] + discovered S10
[S10] + discovered S9
[S10] + discovered S8
[S9] + discovered S13
[S9] + discovered S11
[S10] + discovered S4
[S10] + discovered S5
[S10] + discovered S3
[S10] + discovered S2
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S15
[S9] + discovered S14
[S9] + discovered S10
[S10] + discovered S7
[S10] + discovered S6
[S11] + discovered S6
[S11] + discovered S3
[S11] + discovered S9
[S11] + discovered S5
[S10] + discovered S16
[S11] + discovered S4
[S10] + discovered S17
[S11] + discovered S2
[S11] + discovered S8
[S10] + discovered S14
[S10] + discovered S11
[S11] + discovered S10
[S10] + discovered S13
[S10] + discovered S15
[S11] + discovered S7
[S13] + discovered S2
[S13] + discovered S9
[S13] + discovered S11
[S13] + discovered S7
[S11] + discovered S17
[S11] + discovered S16
[S11] + discovered S15
[S13] + discovered S3
[S11] + discovered S14
[S13] + discovered S5
[S13] + discovered S8
[S13] + discovered S6
[S13] + discovered S10
[S11] + discovered S13
[S13] + discovered S4
[S14] + discovered S9
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S16
[S14] + discovered S4
[S14] + discovered S13
[S14] + discovered S11
[S14] + discovered S10
[S14] + discovered S8
[S14] + discovered S5
[S14] + discovered S6
[S14] + discovered S3
[S13] + discovered S17
[S14] + discovered S2
[S14] + discovered S7
[S15] + discovered S11
[S15] + discovered S10
[S15] + discovered S8
[S14] + discovered S16
[S15] + discovered S4
[S15] + discovered S5
[S15] + discovered S9
[S15] + discovered S2
[S14] + discovered S15
[S15] + discovered S3
[S14] + discovered S17
[S15] + discovered S13
[S15] + discovered S6
[S15] + discovered S7
[S15] + discovered S14
[S16] + discovered S13
[S15] + discovered S16
[S16] + discovered S14
[S16] + discovered S9
[S16] + discovered S8
[S16] + discovered S4
[S16] + discovered S6
[S16] + discovered S10
[S16] + discovered S7
[S16] + discovered S11
[S16] + discovered S15
[S16] + discovered S2
[S15] + discovered S17
[S16] + discovered S3
[S16] + discovered S5
[S17] + discovered S10
[S17] + discovered S11
[S17] + discovered S5
[S17] + discovered S15
[S17] + discovered S9
[S17] + discovered S6
[S17] + discovered S2
[S17] + discovered S7
[S17] + discovered S8
[S17] + discovered S3
[S16] + discovered S17
[S17] + discovered S4
[S17] + discovered S13
[S17] + discovered S16
[S17] + discovered S14
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=1.000 → S11@127.0.0.1:51912
[S2] ⇄ pheromone p=1.000 → S17@127.0.0.1:51917
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:51917
[S7] ⇄ pheromone p=1.000 → S5@127.0.0.1:51905
[S13] ⇄ pheromone p=1.000 → S5@127.0.0.1:51905
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:51912
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:51913
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:51908
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:51905
[S10] ⇄ pheromone p=1.000 → S6@127.0.0.1:51907
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:51915
[S9] ⇄ pheromone p=1.000 → S2@127.0.0.1:51902
[S3] ⇄ pheromone p=1.000 → S9@127.0.0.1:51910
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:51908
[S17] ⇄ pheromone p=1.000 → S16@127.0.0.1:51916
[S2] START round=1 head_norm_before_train=1.164092 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6017692830629775, 'loss_val': 1.3137575833028305, 'psi': 0.32577399325833106}-{'f1_val': 0.38684404908462733, 'auprc': 0.6226737211551321, 'loss_val': 1.3509444371929629, 'psi': 0.4811759179128292}
[S3] START round=1 head_norm_before_train=1.190486 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.16565460286616468, 'auprc': 0.8624444850473029, 'loss_val': 1.3207351199029038, 'psi': 0.44437055573861994}-{'f1_val': 0.3066154987558188, 'auprc': 0.6873053050108456, 'loss_val': 1.3478542308787267, 'psi': 0.4588914212578295}
[S4] START round=1 head_norm_before_train=1.173158 (no previous merge yet)
[S4] round=1 local utility u=0.147859 metrics={'f1_val': 0.3983300191982817, 'auprc': 0.779916946802578, 'loss_val': 1.286500891312961, 'psi': 0.5509647902400002}-{'f1_val': 0.3548346353963798, 'auprc': 0.7807328044663226, 'loss_val': 1.3236934655393675, 'psi': 0.525193903024357}
[S5] START round=1 head_norm_before_train=1.172204 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700261615319314, 'loss_val': 1.308059958761984, 'psi': 0.39336760746991545}-{'f1_val': 0.3936155520894261, 'auprc': 0.7699461749353091, 'loss_val': 1.3505701511808923, 'psi': 0.5441478012277794}
[S6] START round=1 head_norm_before_train=1.155583 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6387217501473813, 'loss_val': 1.3244541512919887, 'psi': 0.34034446928972173}-{'f1_val': 0.371118614358669, 'auprc': 0.6401427815967795, 'loss_val': 1.3588373487049807, 'psi': 0.4787282812539132}
[S7] START round=1 head_norm_before_train=1.152274 (no previous merge yet)
[S7] round=1 local utility u=0.375911 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7232958207390527, 'loss_val': 1.3308893761130962, 'psi': 0.3745524219330761}-{'f1_val': 0.14205682272909165, 'auprc': 0.48258112005652204, 'loss_val': 1.3605680749501146, 'psi': 0.2782665416600638}
[S8] START round=1 head_norm_before_train=1.144188 (no previous merge yet)
[S8] round=1 local utility u=0.016020 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7752465255496974, 'loss_val': 1.3221145359635182, 'psi': 0.3940721996556533}-{'f1_val': 0.13995598239295717, 'auprc': 0.7734757504800462, 'loss_val': 1.3488425055115005, 'psi': 0.39336388962779284}
[S9] START round=1 head_norm_before_train=1.255781 (no previous merge yet)
[S9] round=1 local utility u=0.288703 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7732935923127321, 'loss_val': 1.3278236278818014, 'psi': 0.39415621120909045}-{'f1_val': 0.141397957139996, 'auprc': 0.5933440935223387, 'loss_val': 1.365380597549629, 'psi': 0.3221764116929331}
[S10] START round=1 head_norm_before_train=1.190940 (no previous merge yet)
[S10] round=1 local utility u=0.014168 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7762937020794145, 'loss_val': 1.3131955831927014, 'psi': 0.3936904633568002}-{'f1_val': 0.13862163754172394, 'auprc': 0.7771259028885371, 'loss_val': 1.344027384547366, 'psi': 0.3940233436804492}
[S11] START round=1 head_norm_before_train=1.168683 (no previous merge yet)
[S11] round=1 local utility u=1.000000 metrics={'f1_val': 0.39618743474977425, 'auprc': 0.7838607155539671, 'loss_val': 1.3367661310888381, 'psi': 0.5512567470714513}-{'f1_val': 0.10359570269677702, 'auprc': 0.6499406265346123, 'loss_val': 1.3724357747266436, 'psi': 0.32213367223191114}
[S13] START round=1 head_norm_before_train=1.115277 (no previous merge yet)
[S13] round=1 local utility u=0.972390 metrics={'f1_val': 0.4139022238588657, 'auprc': 0.7135051036413395, 'loss_val': 1.3220731703326203, 'psi': 0.5337433757718553}-{'f1_val': 0.09037372593431484, 'auprc': 0.724214600792753, 'loss_val': 1.3578108276222272, 'psi': 0.3439100758776901}
[S14] START round=1 head_norm_before_train=1.180897 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8352415546250853, 'loss_val': 1.330986521185736, 'psi': 0.4183113335796564}-{'f1_val': 0.14035785288270378, 'auprc': 0.8487539800809729, 'loss_val': 1.3523881003727443, 'psi': 0.4237163037620114}
[S15] START round=1 head_norm_before_train=1.156533 (no previous merge yet)
[S15] round=1 local utility u=0.474455 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7602519785461025, 'loss_val': 1.3491504125226357, 'psi': 0.38794098223537604}-{'f1_val': 0.13973365136155833, 'auprc': 0.45206527047106504, 'loss_val': 1.3734993186294089, 'psi': 0.26466629900536104}
[S16] START round=1 head_norm_before_train=1.148656 (no previous merge yet)
[S16] round=1 local utility u=0.146551 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7589452520474489, 'loss_val': 1.327677886020835, 'psi': 0.38796057093850145}-{'f1_val': 0.16885569301532566, 'auprc': 0.6152698077109283, 'loss_val': 1.3590630340734706, 'psi': 0.34742133889356674}
[S17] START round=1 head_norm_before_train=1.157573 (no previous merge yet)
[S17] round=1 local utility u=0.001230 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6282873693945161, 'loss_val': 1.329756063060393, 'psi': 0.33588432574823707}-{'f1_val': 0.14478746144235682, 'auprc': 0.6298138433586089, 'loss_val': 1.359827464796093, 'psi': 0.3387980142088577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:51907
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:51915
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S16] → sending delta(kind=head bytes=1784) to S5@127.0.0.1:51905
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:51909
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S10] → sending delta(kind=head bytes=1787) to S4@127.0.0.1:51904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:51904
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:51907
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1784 to 1 peers)
[S10] sending update (kind=head size=1787 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1784) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.158947)
[S5] loaded HEAD from S16 (vec_in norm=1.158947)
[S5] cosine check vs S16: cos=0.0722
[S5] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1787) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.205132)
[S4] loaded HEAD from S10 (vec_in norm=1.205132)
[S4] cosine check vs S10: cos=0.0294
[S4] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S13
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.131467)
[S6] loaded HEAD from S13 (vec_in norm=1.131467)
[S6] cosine check vs S13: cos=0.0367
[S6] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1789) from S4
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.195338)
[S15] loaded HEAD from S4 (vec_in norm=1.195338)
[S15] cosine check vs S4: cos=-0.0227
[S15] DROPPED delta from S4 (cos=-0.0227 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1790) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.163546)
[S6] loaded HEAD from S7 (vec_in norm=1.163546)
[S6] cosine check vs S7: cos=-0.0095
[S6] DROPPED delta from S7 (cos=-0.0095 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1790) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.155096)
[S15] loaded HEAD from S8 (vec_in norm=1.155096)
[S15] cosine check vs S8: cos=0.0321
[S15] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.182860)
[S13] loaded HEAD from S11 (vec_in norm=1.182860)
[S13] cosine check vs S11: cos=-0.0867
[S13] DROPPED delta from S11 (cos=-0.0867 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S9
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.259658)
[S8] loaded HEAD from S9 (vec_in norm=1.259658)
[S8] cosine check vs S9: cos=-0.0362
[S8] DROPPED delta from S9 (cos=-0.0362 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1791) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.166709)
[S4] loaded HEAD from S15 (vec_in norm=1.166709)
[S4] cosine check vs S15: cos=-0.0227
[S4] DROPPED delta from S15 (cos=-0.0227 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:51902
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1790) from S17
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.172068)
[S2] loaded HEAD from S17 (vec_in norm=1.172068)
[S2] cosine check vs S17: cos=0.0619
[S2] BUFFERED delta from S17 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.171894
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.994260e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.0895 head_norm=0.829274 delta_norm=0.799426
[S6] aggregate: ROLLBACK (f1_val pre=0.141 post=0.090 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.192230
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.007731e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.860842 delta_norm=0.800773
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.183088
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.064932e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.858074 delta_norm=0.806493
[S2] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.166709
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.076008e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.833972 delta_norm=0.807601
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.3983 head_norm=1.195338
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.361117e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.861107 delta_norm=0.836112
[S4] aggregate: ROLLBACK (f1_val pre=0.398 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=0.858074 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.068340 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6468102240007659, 'loss_val': 1.3121994561804275, 'psi': 0.34379036963344645}-{'f1_val': 0.1417771333885667, 'auprc': 0.6017692830629775, 'loss_val': 1.3137575833028305, 'psi': 0.32577399325833106}
[S3] START round=2 head_norm_before_train=1.209885 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.878554547001035, 'loss_val': 1.2860379558265105, 'psi': 0.43532585816887825}-{'f1_val': 0.16565460286616468, 'auprc': 0.8624444850473029, 'loss_val': 1.3207351199029038, 'psi': 0.44437055573861994}
[S4] START round=2 head_norm_before_train=0.861107 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7815527067115629, 'loss_val': 1.2849490787605389, 'psi': 0.39675706002173566}-{'f1_val': 0.3983300191982817, 'auprc': 0.779916946802578, 'loss_val': 1.286500891312961, 'psi': 0.5509647902400002}
[S5] START round=2 head_norm_before_train=0.860842 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.007882 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700051227831526, 'loss_val': 1.2922327659558486, 'psi': 0.3933591919704039}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700261615319314, 'loss_val': 1.308059958761984, 'psi': 0.39336760746991545}
[S6] START round=2 head_norm_before_train=0.829274 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=1.000000 metrics={'f1_val': 0.4163776497653782, 'auprc': 0.818924073365976, 'loss_val': 1.316588341441013, 'psi': 0.5773962192056173}-{'f1_val': 0.14142628205128205, 'auprc': 0.6387217501473813, 'loss_val': 1.3244541512919887, 'psi': 0.34034446928972173}
[S7] START round=2 head_norm_before_train=1.163546 (no previous merge yet)
[S7] round=2 local utility u=0.100284 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7803684340123722, 'loss_val': 1.301539408048868, 'psi': 0.3973814672424039}-{'f1_val': 0.14205682272909165, 'auprc': 0.7232958207390527, 'loss_val': 1.3308893761130962, 'psi': 0.3745524219330761}
[S8] START round=2 head_norm_before_train=1.155096 (no previous merge yet)
[S8] round=2 local utility u=0.017348 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7757636395375198, 'loss_val': 1.2889691185619234, 'psi': 0.3942790452507823}-{'f1_val': 0.13995598239295717, 'auprc': 0.7752465255496974, 'loss_val': 1.3221145359635182, 'psi': 0.3940721996556533}
[S9] START round=2 head_norm_before_train=1.259658 (no previous merge yet)
[S9] round=2 local utility u=0.348316 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9919716080722998, 'loss_val': 1.2872261831768694, 'psi': 0.48162741751291754}-{'f1_val': 0.141397957139996, 'auprc': 0.7732935923127321, 'loss_val': 1.3278236278818014, 'psi': 0.39415621120909045}
[S10] START round=2 head_norm_before_train=1.205132 (no previous merge yet)
[S10] round=2 local utility u=0.017901 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7763942204339415, 'loss_val': 1.27769424070127, 'psi': 0.39373067069861095}-{'f1_val': 0.13862163754172394, 'auprc': 0.7762937020794145, 'loss_val': 1.3131955831927014, 'psi': 0.3936904633568002}
[S11] START round=2 head_norm_before_train=1.182860 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7831511823906554, 'loss_val': 1.2866069511975147, 'psi': 0.39750868298012854}-{'f1_val': 0.39618743474977425, 'auprc': 0.7838607155539671, 'loss_val': 1.3367661310888381, 'psi': 0.5512567470714513}
[S13] START round=2 head_norm_before_train=1.131467 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7114841244926586, 'loss_val': 1.2810423414017464, 'psi': 0.3688251073432953}-{'f1_val': 0.4139022238588657, 'auprc': 0.7135051036413395, 'loss_val': 1.3220731703326203, 'psi': 0.5337433757718553}
[S14] START round=2 head_norm_before_train=1.195196 (no previous merge yet)
[S14] round=2 local utility u=0.051760 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8621312843381672, 'loss_val': 1.3081356871178198, 'psi': 0.4290672254648892}-{'f1_val': 0.14035785288270378, 'auprc': 0.8352415546250853, 'loss_val': 1.330986521185736, 'psi': 0.4183113335796564}
[S15] START round=2 head_norm_before_train=0.833972 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.025655 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7720916445766152, 'loss_val': 1.3333588883085967, 'psi': 0.39267684864758107}-{'f1_val': 0.13973365136155833, 'auprc': 0.7602519785461025, 'loss_val': 1.3491504125226357, 'psi': 0.38794098223537604}
[S16] START round=2 head_norm_before_train=1.158947 (no previous merge yet)
[S16] round=2 local utility u=0.031306 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7682648761438875, 'loss_val': 1.2930251588077544, 'psi': 0.391688420577077}-{'f1_val': 0.14063745019920318, 'auprc': 0.7589452520474489, 'loss_val': 1.327677886020835, 'psi': 0.38796057093850145}
[S17] START round=2 head_norm_before_train=1.172068 (no previous merge yet)
[S17] round=2 local utility u=0.009381 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6222314320761033, 'loss_val': 1.2928263004059373, 'psi': 0.33346195082087193}-{'f1_val': 0.14094896331738438, 'auprc': 0.6282873693945161, 'loss_val': 1.329756063060393, 'psi': 0.33588432574823707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:51912
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:51917
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:51904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S16] → sending delta(kind=head bytes=1784) to S2@127.0.0.1:51902
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] → sending delta(kind=head bytes=1788) to S14@127.0.0.1:51914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:51903
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1788 to 1 peers)
[S16] sending update (kind=head size=1784 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1784) from S16
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.178352)
[S2] loaded HEAD from S16 (vec_in norm=1.178352)
[S2] cosine check vs S16: cos=0.0171
[S2] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1794) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.272819)
[S13] loaded HEAD from S9 (vec_in norm=1.272819)
[S13] cosine check vs S9: cos=-0.0487
[S13] DROPPED delta from S9 (cos=-0.0487 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1790) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.176832)
[S17] loaded HEAD from S8 (vec_in norm=1.176832)
[S17] cosine check vs S8: cos=0.0890
[S17] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1791) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.883325)
[S11] loaded HEAD from S5 (vec_in norm=0.883325)
[S11] cosine check vs S5: cos=0.0201
[S11] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1788) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.227144)
[S14] loaded HEAD from S10 (vec_in norm=1.227144)
[S14] cosine check vs S10: cos=-0.0315
[S14] DROPPED delta from S10 (cos=-0.0315 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.853160)
[S3] loaded HEAD from S6 (vec_in norm=0.853160)
[S3] cosine check vs S6: cos=0.0144
[S3] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.179537)
[S4] loaded HEAD from S7 (vec_in norm=1.179537)
[S4] cosine check vs S7: cos=-0.0014
[S4] DROPPED delta from S7 (cos=-0.0014 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.216407)
[S17] loaded HEAD from S14 (vec_in norm=1.216407)
[S17] cosine check vs S14: cos=0.0135
[S17] BUFFERED delta from S14 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.877087)
[S6] loaded HEAD from S2 (vec_in norm=0.877087)
[S6] cosine check vs S2: cos=0.0379
[S6] BUFFERED delta from S2 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1799) from S15
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.854833)
[S2] loaded HEAD from S15 (vec_in norm=0.854833)
[S2] cosine check vs S15: cos=0.0467
[S2] BUFFERED delta from S15 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:51911
[S17] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1795) from S17
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.195112)
[S10] loaded HEAD from S17 (vec_in norm=1.195112)
[S10] cosine check vs S17: cos=0.0832
[S10] BUFFERED delta from S17 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=2 metric=0.1398 head_norm=1.237519
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.464738e-01
[S3] stored merged vector for next round verification (round=2)
[S3] DEBUG after merge:  round=2 metric=0.1398 head_norm=0.756600 delta_norm=0.746474
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=1.208295
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.411587e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.4226 head_norm=0.755516 delta_norm=0.741159
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=0.877087
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.652020e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.588043 delta_norm=0.565202
[S2] aggregate: ACCEPT kept=['S16', 'S15'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=1.227144
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.200958e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.891364 delta_norm=0.820096
[S10] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.4164 head_norm=0.853160
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.000983e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.4164 head_norm=0.623269 delta_norm=0.600098
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=1.195112
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.135079e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.762531 delta_norm=0.713508
[S17] aggregate: ACCEPT kept=['S8', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.588043 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.019441 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6549681086698054, 'loss_val': 1.2977910396399426, 'psi': 0.3470535235010622}-{'f1_val': 0.1417771333885667, 'auprc': 0.6468102240007659, 'loss_val': 1.3121994561804275, 'psi': 0.34379036963344645}
[S3] START round=3 head_norm_before_train=0.756600 cos_to_last_merge=1.0000 (last merge round=2)
[S3] round=3 local utility u=0.055013 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9160400154292212, 'loss_val': 1.2884683781906534, 'psi': 0.4503200455401527}-{'f1_val': 0.13984006561410703, 'auprc': 0.878554547001035, 'loss_val': 1.2860379558265105, 'psi': 0.43532585816887825}
[S4] START round=3 head_norm_before_train=0.885874 cos_to_last_merge=0.9969 (last merge round=1)
[S4] round=3 local utility u=0.034765 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7837412874207517, 'loss_val': 1.221985031104971, 'psi': 0.39763249230541114}-{'f1_val': 0.14022662889518414, 'auprc': 0.7815527067115629, 'loss_val': 1.2849490787605389, 'psi': 0.39675706002173566}
[S5] START round=3 head_norm_before_train=0.883325 cos_to_last_merge=0.9967 (last merge round=1)
[S5] round=3 local utility u=0.026244 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7697666081220296, 'loss_val': 1.2390286519185303, 'psi': 0.3932637861059547}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700051227831526, 'loss_val': 1.2922327659558486, 'psi': 0.3933591919704039}
[S6] START round=3 head_norm_before_train=0.623269 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8177112183897826, 'loss_val': 1.305386106204595, 'psi': 0.41194025658668226}-{'f1_val': 0.4163776497653782, 'auprc': 0.818924073365976, 'loss_val': 1.316588341441013, 'psi': 0.5773962192056173}
[S7] START round=3 head_norm_before_train=1.179537 (no previous merge yet)
[S7] round=3 local utility u=0.029518 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7895075549871826, 'loss_val': 1.2699202893720778, 'psi': 0.4010371156323281}-{'f1_val': 0.14205682272909165, 'auprc': 0.7803684340123722, 'loss_val': 1.301539408048868, 'psi': 0.3973814672424039}
[S8] START round=3 head_norm_before_train=1.176832 (no previous merge yet)
[S8] round=3 local utility u=0.010798 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7679907859458933, 'loss_val': 1.2440546655841194, 'psi': 0.3911699038141317}-{'f1_val': 0.13995598239295717, 'auprc': 0.7757636395375198, 'loss_val': 1.2889691185619234, 'psi': 0.3942790452507823}
[S9] START round=3 head_norm_before_train=1.272819 (no previous merge yet)
[S9] round=3 local utility u=0.025264 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9917827586994405, 'loss_val': 1.2361315411231455, 'psi': 0.48155187776377384}-{'f1_val': 0.141397957139996, 'auprc': 0.9919716080722998, 'loss_val': 1.2872261831768694, 'psi': 0.48162741751291754}
[S10] START round=3 head_norm_before_train=0.891364 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.007432 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7764126541314044, 'loss_val': 1.2628861648635161, 'psi': 0.3937380441775961}-{'f1_val': 0.13862163754172394, 'auprc': 0.7763942204339415, 'loss_val': 1.27769424070127, 'psi': 0.39373067069861095}
[S11] START round=3 head_norm_before_train=0.755516 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.130482 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8674056670004328, 'loss_val': 1.278405819160655, 'psi': 0.43121047682403946}-{'f1_val': 0.14041368337311058, 'auprc': 0.7831511823906554, 'loss_val': 1.2866069511975147, 'psi': 0.39750868298012854}
[S13] START round=3 head_norm_before_train=1.154636 (no previous merge yet)
[S13] round=3 local utility u=0.030361 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7151322163848662, 'loss_val': 1.2312647463873452, 'psi': 0.37028434410017835}-{'f1_val': 0.1403857625770531, 'auprc': 0.7114841244926586, 'loss_val': 1.2810423414017464, 'psi': 0.3688251073432953}
[S14] START round=3 head_norm_before_train=1.216407 (no previous merge yet)
[S14] round=3 local utility u=0.023225 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8680441527442899, 'loss_val': 1.2794239226034272, 'psi': 0.43143237282733826}-{'f1_val': 0.14035785288270378, 'auprc': 0.8621312843381672, 'loss_val': 1.3081356871178198, 'psi': 0.4290672254648892}
[S15] START round=3 head_norm_before_train=0.854833 cos_to_last_merge=0.9972 (last merge round=1)
[S15] round=3 local utility u=0.016096 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7715744416910919, 'loss_val': 1.2996162451249909, 'psi': 0.39246996749337176}-{'f1_val': 0.13973365136155833, 'auprc': 0.7720916445766152, 'loss_val': 1.3333588883085967, 'psi': 0.39267684864758107}
[S16] START round=3 head_norm_before_train=1.178352 (no previous merge yet)
[S16] round=3 local utility u=0.026150 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7709610963246785, 'loss_val': 1.2488139088546244, 'psi': 0.39276690864939334}-{'f1_val': 0.14063745019920318, 'auprc': 0.7682648761438875, 'loss_val': 1.2930251588077544, 'psi': 0.391688420577077}
[S17] START round=3 head_norm_before_train=0.762531 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6048768277947839, 'loss_val': 1.2829174214190286, 'psi': 0.32652010910834417}-{'f1_val': 0.14094896331738438, 'auprc': 0.6222314320761033, 'loss_val': 1.2928263004059373, 'psi': 0.33346195082087193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:51917
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:51905
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.208666)
[S17] loaded HEAD from S8 (vec_in norm=1.208666)
[S17] cosine check vs S8: cos=0.4643
[S17] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.613966)
[S17] loaded HEAD from S2 (vec_in norm=0.613966)
[S17] cosine check vs S2: cos=0.5924
[S17] BUFFERED delta from S2 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.788553)
[S9] loaded HEAD from S3 (vec_in norm=0.788553)
[S9] cosine check vs S3: cos=-0.0128
[S9] DROPPED delta from S3 (cos=-0.0128 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1791) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.909693)
[S11] loaded HEAD from S5 (vec_in norm=0.909693)
[S11] cosine check vs S5: cos=0.5710
[S11] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.920283)
[S11] loaded HEAD from S4 (vec_in norm=0.920283)
[S11] cosine check vs S4: cos=0.0373
[S11] BUFFERED delta from S4 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.886206)
[S5] loaded HEAD from S15 (vec_in norm=0.886206)
[S5] cosine check vs S15: cos=0.0347
[S5] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.917619)
[S6] loaded HEAD from S10 (vec_in norm=0.917619)
[S6] cosine check vs S10: cos=0.4145
[S6] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1790) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.206729)
[S7] loaded HEAD from S16 (vec_in norm=1.206729)
[S7] cosine check vs S16: cos=-0.0667
[S7] DROPPED delta from S16 (cos=-0.0667 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S7
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.198550)
[S5] loaded HEAD from S7 (vec_in norm=1.198550)
[S5] cosine check vs S7: cos=-0.0478
[S5] DROPPED delta from S7 (cos=-0.0478 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.786140)
[S13] loaded HEAD from S11 (vec_in norm=0.786140)
[S13] cosine check vs S11: cos=-0.0689
[S13] DROPPED delta from S11 (cos=-0.0689 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.184539)
[S5] loaded HEAD from S13 (vec_in norm=1.184539)
[S5] cosine check vs S13: cos=-0.0064
[S5] DROPPED delta from S13 (cos=-0.0064 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.244795)
[S7] loaded HEAD from S14 (vec_in norm=1.244795)
[S7] cosine check vs S14: cos=0.0009
[S7] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1791) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.297299)
[S2] loaded HEAD from S9 (vec_in norm=1.297299)
[S2] cosine check vs S9: cos=-0.0187
[S2] DROPPED delta from S9 (cos=-0.0187 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=0.654258
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.394302e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1675 head_norm=0.664786 delta_norm=0.439430
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=0.786140
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.904612e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.608380 delta_norm=0.390461
[S11] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=0.909693
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.238772e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.645932 delta_norm=0.623877
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=1.198550
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.636209e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.864394 delta_norm=0.863621
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=0.793763
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.510017e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.700182 delta_norm=0.351002
[S17] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.613966 cos_to_last_merge=0.9929 (last merge round=2)
[S2] round=4 local utility u=0.150499 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7361300870562867, 'loss_val': 1.2402798216331659, 'psi': 0.37951831485565474}-{'f1_val': 0.1417771333885667, 'auprc': 0.6549681086698054, 'loss_val': 1.2977910396399426, 'psi': 0.3470535235010622}
[S3] START round=4 head_norm_before_train=0.788553 cos_to_last_merge=0.9959 (last merge round=2)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8645489123646153, 'loss_val': 1.224178409716472, 'psi': 0.42972360431431034}-{'f1_val': 0.13984006561410703, 'auprc': 0.9160400154292212, 'loss_val': 1.2884683781906534, 'psi': 0.4503200455401527}
[S4] START round=4 head_norm_before_train=0.920283 cos_to_last_merge=0.9888 (last merge round=1)
[S4] round=4 local utility u=0.046678 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7834701609818101, 'loss_val': 1.1278157667621556, 'psi': 0.3975240417298345}-{'f1_val': 0.14022662889518414, 'auprc': 0.7837412874207517, 'loss_val': 1.221985031104971, 'psi': 0.39763249230541114}
[S5] START round=4 head_norm_before_train=0.645932 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.6080328376259947, 'loss_val': 1.2329710854653082, 'psi': 0.32857027790754073}-{'f1_val': 0.14226190476190476, 'auprc': 0.7697666081220296, 'loss_val': 1.2390286519185303, 'psi': 0.3932637861059547}
[S6] START round=4 head_norm_before_train=0.664786 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.014740 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8211469656425812, 'loss_val': 1.2862131380310988, 'psi': 0.4133145554878017}-{'f1_val': 0.14142628205128205, 'auprc': 0.8177112183897826, 'loss_val': 1.305386106204595, 'psi': 0.41194025658668226}
[S7] START round=4 head_norm_before_train=0.864394 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.003661 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7951969058487487, 'loss_val': 1.2796669819284736, 'psi': 0.4033128559769545}-{'f1_val': 0.14205682272909165, 'auprc': 0.7895075549871826, 'loss_val': 1.2699202893720778, 'psi': 0.4010371156323281}
[S8] START round=4 head_norm_before_train=1.208666 (no previous merge yet)
[S8] round=4 local utility u=0.529841 metrics={'f1_val': 0.3045343790733499, 'auprc': 0.7696877710625125, 'loss_val': 1.1769344377377418, 'psi': 0.49059573586901495}-{'f1_val': 0.13995598239295717, 'auprc': 0.7679907859458933, 'loss_val': 1.2440546655841194, 'psi': 0.3911699038141317}
[S9] START round=4 head_norm_before_train=1.297299 (no previous merge yet)
[S9] round=4 local utility u=0.022345 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9895600828807268, 'loss_val': 1.1847742977642655, 'psi': 0.48066280743628836}-{'f1_val': 0.141397957139996, 'auprc': 0.9917827586994405, 'loss_val': 1.2361315411231455, 'psi': 0.48155187776377384}
[S10] START round=4 head_norm_before_train=0.917619 cos_to_last_merge=0.9979 (last merge round=2)
[S10] round=4 local utility u=0.025399 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7763054870922983, 'loss_val': 1.211765856801735, 'psi': 0.3936951773619537}-{'f1_val': 0.13862163754172394, 'auprc': 0.7764126541314044, 'loss_val': 1.2628861648635161, 'psi': 0.3937380441775961}
[S11] START round=4 head_norm_before_train=0.608380 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6842632180752752, 'loss_val': 1.2596987396509658, 'psi': 0.35795349725397646}-{'f1_val': 0.14041368337311058, 'auprc': 0.8674056670004328, 'loss_val': 1.278405819160655, 'psi': 0.43121047682403946}
[S13] START round=4 head_norm_before_train=1.184539 (no previous merge yet)
[S13] round=4 local utility u=0.024399 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7143872537116821, 'loss_val': 1.1802324039889753, 'psi': 0.3699863590309047}-{'f1_val': 0.1403857625770531, 'auprc': 0.7151322163848662, 'loss_val': 1.2312647463873452, 'psi': 0.37028434410017835}
[S14] START round=4 head_norm_before_train=1.244795 (no previous merge yet)
[S14] round=4 local utility u=0.026301 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8742532156011446, 'loss_val': 1.2454492932914984, 'psi': 0.43391599797008007}-{'f1_val': 0.14035785288270378, 'auprc': 0.8680441527442899, 'loss_val': 1.2794239226034272, 'psi': 0.43143237282733826}
[S15] START round=4 head_norm_before_train=0.886206 cos_to_last_merge=0.9891 (last merge round=1)
[S15] round=4 local utility u=0.018955 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7703883172004875, 'loss_val': 1.258147092783895, 'psi': 0.39199551769713004}-{'f1_val': 0.13973365136155833, 'auprc': 0.7715744416910919, 'loss_val': 1.2996162451249909, 'psi': 0.39246996749337176}
[S16] START round=4 head_norm_before_train=1.206729 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7424380510983942, 'loss_val': 1.1975376588549766, 'psi': 0.3813576905588796}-{'f1_val': 0.14063745019920318, 'auprc': 0.7709610963246785, 'loss_val': 1.2488139088546244, 'psi': 0.39276690864939334}
[S17] START round=4 head_norm_before_train=0.700182 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5676632197989392, 'loss_val': 1.247527423731374, 'psi': 0.3116346659100063}-{'f1_val': 0.14094896331738438, 'auprc': 0.6048768277947839, 'loss_val': 1.2829174214190286, 'psi': 0.32652010910834417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:51908
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:51905
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:51917
[S10] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.654416)
[S17] loaded HEAD from S2 (vec_in norm=0.654416)
[S17] cosine check vs S2: cos=0.6904
[S17] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.949768)
[S6] loaded HEAD from S10 (vec_in norm=0.949768)
[S6] cosine check vs S10: cos=0.8682
[S6] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.246827)
[S17] loaded HEAD from S8 (vec_in norm=1.246827)
[S17] cosine check vs S8: cos=0.7498
[S17] BUFFERED delta from S8 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.277696)
[S7] loaded HEAD from S14 (vec_in norm=1.277696)
[S7] cosine check vs S14: cos=0.7013
[S7] BUFFERED delta from S14 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.959680)
[S11] loaded HEAD from S4 (vec_in norm=0.959680)
[S11] cosine check vs S4: cos=0.3966
[S11] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.920746)
[S5] loaded HEAD from S15 (vec_in norm=0.920746)
[S5] cosine check vs S15: cos=0.6837
[S5] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.216302)
[S5] loaded HEAD from S13 (vec_in norm=1.216302)
[S5] cosine check vs S13: cos=0.0104
[S5] BUFFERED delta from S13 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1793) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.328579)
[S2] loaded HEAD from S9 (vec_in norm=1.328579)
[S2] cosine check vs S9: cos=-0.0236
[S2] DROPPED delta from S9 (cos=-0.0236 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S7
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.884836)
[S5] loaded HEAD from S7 (vec_in norm=0.884836)
[S5] cosine check vs S7: cos=-0.0060
[S5] DROPPED delta from S7 (cos=-0.0060 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.691549)
[S15] loaded HEAD from S6 (vec_in norm=0.691549)
[S15] cosine check vs S6: cos=0.0915
[S15] BUFFERED delta from S6 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.675180
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.932499e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.609439 delta_norm=0.393250
[S5] aggregate: ACCEPT kept=['S15', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=0.638870
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.590282e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.673694 delta_norm=0.459028
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.1414 head_norm=0.691549
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.448275e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.4004 head_norm=0.793857 delta_norm=0.244828
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.884836
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.554359e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=1.000150 delta_norm=0.455436
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.1397 head_norm=0.920746
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.498956e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.1397 head_norm=0.600518 delta_norm=0.549896
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.1409 head_norm=0.731885
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.013413e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.1409 head_norm=0.740266 delta_norm=0.201341
[S17] aggregate: ACCEPT kept=['S2', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.654416 cos_to_last_merge=0.9736 (last merge round=2)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6808573282056938, 'loss_val': 1.2046899725912503, 'psi': 0.3574092113154176}-{'f1_val': 0.1417771333885667, 'auprc': 0.7361300870562867, 'loss_val': 1.2402798216331659, 'psi': 0.37951831485565474}
[S3] START round=5 head_norm_before_train=0.829909 cos_to_last_merge=0.9848 (last merge round=2)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6304509285325615, 'loss_val': 1.174524949517301, 'psi': 0.33608441078148876}-{'f1_val': 0.13984006561410703, 'auprc': 0.8645489123646153, 'loss_val': 1.224178409716472, 'psi': 0.42972360431431034}
[S4] START round=5 head_norm_before_train=0.959680 cos_to_last_merge=0.9782 (last merge round=1)
[S4] round=5 local utility u=0.872339 metrics={'f1_val': 0.4079941726820715, 'auprc': 0.786236046485855, 'loss_val': 0.9980404388752838, 'psi': 0.5592909222035849}-{'f1_val': 0.14022662889518414, 'auprc': 0.7834701609818101, 'loss_val': 1.1278157667621556, 'psi': 0.3975240417298345}
[S5] START round=5 head_norm_before_train=0.609439 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.007838 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.6120551849999725, 'loss_val': 1.2293622938989983, 'psi': 0.33017921685713186}-{'f1_val': 0.14226190476190476, 'auprc': 0.6080328376259947, 'loss_val': 1.2329710854653082, 'psi': 0.32857027790754073}
[S6] START round=5 head_norm_before_train=0.793857 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.802487741431728, 'loss_val': 1.246443169483348, 'psi': 0.4058508658034604}-{'f1_val': 0.14142628205128205, 'auprc': 0.8211469656425812, 'loss_val': 1.2862131380310988, 'psi': 0.4133145554878017}
[S7] START round=5 head_norm_before_train=1.000150 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.001421 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7952340052976671, 'loss_val': 1.2769361775548123, 'psi': 0.40332769575652183}-{'f1_val': 0.14205682272909165, 'auprc': 0.7951969058487487, 'loss_val': 1.2796669819284736, 'psi': 0.4033128559769545}
[S8] START round=5 head_norm_before_train=1.246827 (no previous merge yet)
[S8] round=5 local utility u=1.000000 metrics={'f1_val': 0.7149686191926397, 'auprc': 0.7766821692988353, 'loss_val': 1.067510281545408, 'psi': 0.7396540392351179}-{'f1_val': 0.3045343790733499, 'auprc': 0.7696877710625125, 'loss_val': 1.1769344377377418, 'psi': 0.49059573586901495}
[S9] START round=5 head_norm_before_train=1.328579 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8031573705594871, 'loss_val': 1.1102931778581844, 'psi': 0.4061017225077925}-{'f1_val': 0.141397957139996, 'auprc': 0.9895600828807268, 'loss_val': 1.1847742977642655, 'psi': 0.48066280743628836}
[S10] START round=5 head_norm_before_train=0.949768 cos_to_last_merge=0.9920 (last merge round=2)
[S10] round=5 local utility u=0.036141 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7791537748402321, 'loss_val': 1.1480283911794882, 'psi': 0.39483449246112723}-{'f1_val': 0.13862163754172394, 'auprc': 0.7763054870922983, 'loss_val': 1.211765856801735, 'psi': 0.3936951773619537}
[S11] START round=5 head_norm_before_train=0.673694 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.599750633929552, 'loss_val': 1.2394621677001427, 'psi': 0.32414846359568716}-{'f1_val': 0.14041368337311058, 'auprc': 0.6842632180752752, 'loss_val': 1.2596987396509658, 'psi': 0.35795349725397646}
[S13] START round=5 head_norm_before_train=1.216302 (no previous merge yet)
[S13] round=5 local utility u=0.659714 metrics={'f1_val': 0.41607788054795825, 'auprc': 0.5844897658664939, 'loss_val': 1.1252653210147836, 'psi': 0.4834426346753725}-{'f1_val': 0.1403857625770531, 'auprc': 0.7143872537116821, 'loss_val': 1.1802324039889753, 'psi': 0.3699863590309047}
[S14] START round=5 head_norm_before_train=1.277696 (no previous merge yet)
[S14] round=5 local utility u=0.109905 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.932129283839576, 'loss_val': 1.1992675753774598, 'psi': 0.4570664252654527}-{'f1_val': 0.14035785288270378, 'auprc': 0.8742532156011446, 'loss_val': 1.2454492932914984, 'psi': 0.43391599797008007}
[S15] START round=5 head_norm_before_train=0.600518 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.003182 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7730071669091719, 'loss_val': 1.2596405543268283, 'psi': 0.3930430575806038}-{'f1_val': 0.13973365136155833, 'auprc': 0.7703883172004875, 'loss_val': 1.258147092783895, 'psi': 0.39199551769713004}
[S16] START round=5 head_norm_before_train=1.237131 (no previous merge yet)
[S16] round=5 local utility u=0.853609 metrics={'f1_val': 0.41605479710452475, 'auprc': 0.7329599443640925, 'loss_val': 1.1143892182514414, 'psi': 0.542816856008352}-{'f1_val': 0.14063745019920318, 'auprc': 0.7424380510983942, 'loss_val': 1.1975376588549766, 'psi': 0.3813576905588796}
[S17] START round=5 head_norm_before_train=0.740266 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.033504 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5742051431762649, 'loss_val': 1.2001445107742785, 'psi': 0.3142514352609366}-{'f1_val': 0.14094896331738438, 'auprc': 0.5676632197989392, 'loss_val': 1.247527423731374, 'psi': 0.3116346659100063}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:51908
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:51908
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:51905
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:51912
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.290498)
[S17] loaded HEAD from S8 (vec_in norm=1.290498)
[S17] cosine check vs S8: cos=0.8450
[S17] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1802) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.242080)
[S5] loaded HEAD from S13 (vec_in norm=1.242080)
[S5] cosine check vs S13: cos=0.4911
[S5] BUFFERED delta from S13 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1791) from S7
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.008940)
[S5] loaded HEAD from S7 (vec_in norm=1.008940)
[S5] cosine check vs S7: cos=0.0353
[S5] BUFFERED delta from S7 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.632906)
[S11] loaded HEAD from S5 (vec_in norm=0.632906)
[S11] cosine check vs S5: cos=0.1768
[S11] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.272281)
[S7] loaded HEAD from S16 (vec_in norm=1.272281)
[S7] cosine check vs S16: cos=0.0170
[S7] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.308116)
[S7] loaded HEAD from S14 (vec_in norm=1.308116)
[S7] cosine check vs S14: cos=0.9359
[S7] BUFFERED delta from S14 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.003027)
[S11] loaded HEAD from S4 (vec_in norm=1.003027)
[S11] cosine check vs S4: cos=0.8761
[S11] BUFFERED delta from S4 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.635347)
[S5] loaded HEAD from S15 (vec_in norm=0.635347)
[S5] cosine check vs S15: cos=0.6821
[S5] BUFFERED delta from S15 (total buffered=3)
[S6] RECEIVED delta(kind=head bytes=1800) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.981789)
[S6] loaded HEAD from S10 (vec_in norm=0.981789)
[S6] cosine check vs S10: cos=0.9573
[S6] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:51916
[S17] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.766730)
[S16] loaded HEAD from S17 (vec_in norm=0.766730)
[S16] cosine check vs S17: cos=0.2112
[S16] BUFFERED delta from S17 (total buffered=1)
[S2] ⇄ pheromone p=0.361 → S17@127.0.0.1:51917
[S3] ⇄ pheromone p=0.335 → S9@127.0.0.1:51910
[S9] ⇄ pheromone p=0.394 → S2@127.0.0.1:51902
[S4] ⇄ pheromone p=0.526 → S11@127.0.0.1:51912
[S13] ⇄ pheromone p=0.547 → S5@127.0.0.1:51905
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.4161 head_norm=1.272281
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.697932e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.4107 head_norm=0.809113 delta_norm=0.669793
[S16] aggregate: ROLLBACK (f1_val pre=0.416 post=0.411 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.517 → S7@127.0.0.1:51908
[S10] ⇄ pheromone p=0.343 → S6@127.0.0.1:51907
[S14] ⇄ pheromone p=0.362 → S7@127.0.0.1:51908
[S8] ⇄ pheromone p=0.617 → S17@127.0.0.1:51917
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.632906
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.441537e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.539148 delta_norm=0.244154
[S5] aggregate: ACCEPT kept=['S13', 'S7', 'S15'] (k=3/3) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.333 → S11@127.0.0.1:51912
[S15] ⇄ pheromone p=0.375 → S5@127.0.0.1:51905
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=1.008940
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.960825e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.886247 delta_norm=0.396082
[S7] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.373 → S5@127.0.0.1:51905
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.816352
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.547767e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1675 head_norm=0.889503 delta_norm=0.154777
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.432 → S15@127.0.0.1:51915
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.695559
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.032781e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.621166 delta_norm=0.203278
[S11] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.426 → S13@127.0.0.1:51913
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=0.766730
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.811384e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1409 head_norm=0.990638 delta_norm=0.381138
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.335 → S16@127.0.0.1:51916
[S2] START round=6 head_norm_before_train=0.691550 cos_to_last_merge=0.9539 (last merge round=2)
[S2] round=6 local utility u=0.122346 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7400368525590236, 'loss_val': 1.137536154151989, 'psi': 0.3810810210567495}-{'f1_val': 0.1417771333885667, 'auprc': 0.6808573282056938, 'loss_val': 1.2046899725912503, 'psi': 0.3574092113154176}
[S3] START round=6 head_norm_before_train=0.875539 cos_to_last_merge=0.9706 (last merge round=2)
[S3] round=6 local utility u=0.350123 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8120036440702899, 'loss_val': 1.0189374620968061, 'psi': 0.4087054969965802}-{'f1_val': 0.13984006561410703, 'auprc': 0.6304509285325615, 'loss_val': 1.174524949517301, 'psi': 0.33608441078148876}
[S4] START round=6 head_norm_before_train=1.003027 cos_to_last_merge=0.9664 (last merge round=1)
[S4] round=6 local utility u=0.692516 metrics={'f1_val': 0.6723260466983028, 'auprc': 0.6618595479530741, 'loss_val': 0.8258706828456043, 'psi': 0.6681394472002113}-{'f1_val': 0.4079941726820715, 'auprc': 0.786236046485855, 'loss_val': 0.9980404388752838, 'psi': 0.5592909222035849}
[S5] START round=6 head_norm_before_train=0.539148 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.247555 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7727391683609204, 'loss_val': 1.216304573965035, 'psi': 0.394452810201511}-{'f1_val': 0.14226190476190476, 'auprc': 0.6120551849999725, 'loss_val': 1.2293622938989983, 'psi': 0.33017921685713186}
[S6] START round=6 head_norm_before_train=0.889503 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.16874731484442282, 'auprc': 0.6140206449006838, 'loss_val': 1.1743677450131516, 'psi': 0.3468566468669272}-{'f1_val': 0.14142628205128205, 'auprc': 0.802487741431728, 'loss_val': 1.246443169483348, 'psi': 0.4058508658034604}
[S7] START round=6 head_norm_before_train=0.886247 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.007381 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7946842957044167, 'loss_val': 1.26052503083742, 'psi': 0.4031078119192217}-{'f1_val': 0.14205682272909165, 'auprc': 0.7952340052976671, 'loss_val': 1.2769361775548123, 'psi': 0.40332769575652183}
[S8] START round=6 head_norm_before_train=1.290498 (no previous merge yet)
[S8] round=6 local utility u=0.107267 metrics={'f1_val': 0.7146825535339066, 'auprc': 0.7826648642801985, 'loss_val': 0.8692081943947112, 'psi': 0.7418754778324235}-{'f1_val': 0.7149686191926397, 'auprc': 0.7766821692988353, 'loss_val': 1.067510281545408, 'psi': 0.7396540392351179}
[S9] START round=6 head_norm_before_train=1.358468 (no previous merge yet)
[S9] round=6 local utility u=0.914686 metrics={'f1_val': 0.41697558078303143, 'auprc': 0.8135123670643382, 'loss_val': 0.9654513741989285, 'psi': 0.575590295295554}-{'f1_val': 0.141397957139996, 'auprc': 0.8031573705594871, 'loss_val': 1.1102931778581844, 'psi': 0.4061017225077925}
[S10] START round=6 head_norm_before_train=0.981789 cos_to_last_merge=0.9843 (last merge round=2)
[S10] round=6 local utility u=0.902989 metrics={'f1_val': 0.41634224672860876, 'auprc': 0.7973258439761477, 'loss_val': 1.06288990287156, 'psi': 0.5687356856276243}-{'f1_val': 0.13862163754172394, 'auprc': 0.7791537748402321, 'loss_val': 1.1480283911794882, 'psi': 0.39483449246112723}
[S11] START round=6 head_norm_before_train=0.621166 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.014241 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5985017386302283, 'loss_val': 1.20723392965399, 'psi': 0.32364890547595765}-{'f1_val': 0.14041368337311058, 'auprc': 0.599750633929552, 'loss_val': 1.2394621677001427, 'psi': 0.32414846359568716}
[S13] START round=6 head_norm_before_train=1.242080 (no previous merge yet)
[S13] round=6 local utility u=0.271240 metrics={'f1_val': 0.4163539771616168, 'auprc': 0.7276955934305946, 'loss_val': 1.0140592262416472, 'psi': 0.5408906236692079}-{'f1_val': 0.41607788054795825, 'auprc': 0.5844897658664939, 'loss_val': 1.1252653210147836, 'psi': 0.4834426346753725}
[S14] START round=6 head_norm_before_train=1.308116 (no previous merge yet)
[S14] round=6 local utility u=0.065533 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9442815375626117, 'loss_val': 1.1046584157394765, 'psi': 0.46192732675466697}-{'f1_val': 0.14035785288270378, 'auprc': 0.932129283839576, 'loss_val': 1.1992675753774598, 'psi': 0.4570664252654527}
[S15] START round=6 head_norm_before_train=0.635347 cos_to_last_merge=0.9956 (last merge round=4)
[S15] round=6 local utility u=0.037143 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.777048922773815, 'loss_val': 1.1974799390410285, 'psi': 0.394659759926461}-{'f1_val': 0.13973365136155833, 'auprc': 0.7730071669091719, 'loss_val': 1.2596405543268283, 'psi': 0.3930430575806038}
[S16] START round=6 head_norm_before_train=0.809113 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.016652 metrics={'f1_val': 0.4173069283424069, 'auprc': 0.7273904539911722, 'loss_val': 1.0718892852562676, 'psi': 0.5413403386019131}-{'f1_val': 0.41605479710452475, 'auprc': 0.7329599443640925, 'loss_val': 1.1143892182514414, 'psi': 0.542816856008352}
[S17] START round=6 head_norm_before_train=0.990638 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.082982 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6073763843777545, 'loss_val': 1.1336944121397798, 'psi': 0.3275199317415325}-{'f1_val': 0.14094896331738438, 'auprc': 0.5742051431762649, 'loss_val': 1.2001445107742785, 'psi': 0.3142514352609366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:51905
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:51912
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.561483)
[S11] loaded HEAD from S5 (vec_in norm=0.561483)
[S11] cosine check vs S5: cos=0.3371
[S11] BUFFERED delta from S5 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1793) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.847146)
[S7] loaded HEAD from S16 (vec_in norm=0.847146)
[S7] cosine check vs S16: cos=0.4057
[S7] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.721138)
[S17] loaded HEAD from S2 (vec_in norm=0.721138)
[S17] cosine check vs S2: cos=0.4889
[S17] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1791) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.917548)
[S9] loaded HEAD from S3 (vec_in norm=0.917548)
[S9] cosine check vs S3: cos=-0.0038
[S9] DROPPED delta from S3 (cos=-0.0038 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.671690)
[S5] loaded HEAD from S15 (vec_in norm=0.671690)
[S5] cosine check vs S15: cos=0.7257
[S5] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S7
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.896433)
[S5] loaded HEAD from S7 (vec_in norm=0.896433)
[S5] cosine check vs S7: cos=0.3414
[S5] BUFFERED delta from S7 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1802) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.387726)
[S2] loaded HEAD from S9 (vec_in norm=1.387726)
[S2] cosine check vs S9: cos=-0.0311
[S2] DROPPED delta from S9 (cos=-0.0311 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.271582)
[S5] loaded HEAD from S13 (vec_in norm=1.271582)
[S5] cosine check vs S13: cos=0.5743
[S5] BUFFERED delta from S13 (total buffered=3)
[S6] RECEIVED delta(kind=head bytes=1804) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.009807)
[S6] loaded HEAD from S10 (vec_in norm=1.009807)
[S6] cosine check vs S10: cos=0.9775
[S6] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.347182)
[S7] loaded HEAD from S14 (vec_in norm=1.347182)
[S7] cosine check vs S14: cos=0.9021
[S7] BUFFERED delta from S14 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.342908)
[S17] loaded HEAD from S8 (vec_in norm=1.342908)
[S17] cosine check vs S8: cos=0.9639
[S17] BUFFERED delta from S8 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.644365)
[S13] loaded HEAD from S11 (vec_in norm=0.644365)
[S13] cosine check vs S11: cos=0.1289
[S13] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.057389)
[S11] loaded HEAD from S4 (vec_in norm=1.057389)
[S11] cosine check vs S4: cos=0.8868
[S11] BUFFERED delta from S4 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:51916
[S17] sending update (kind=head size=1788 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1788) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.010273)
[S16] loaded HEAD from S17 (vec_in norm=1.010273)
[S16] cosine check vs S17: cos=0.5229
[S16] BUFFERED delta from S17 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1687 head_norm=0.914915
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.124987e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1674 head_norm=0.956940 delta_norm=0.112499
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.1404 head_norm=0.644365
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.345479e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.617411 delta_norm=0.134548
[S11] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.1423 head_norm=0.561483
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.343229e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1423 head_norm=0.539615 delta_norm=0.134323
[S5] aggregate: ACCEPT kept=['S15', 'S7', 'S13'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.896433
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.574874e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.850639 delta_norm=0.157487
[S7] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.4164 head_norm=1.271582
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.747168e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.4165 head_norm=0.748880 delta_norm=0.674717
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4173 head_norm=0.847146
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.591270e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.4160 head_norm=0.811391 delta_norm=0.459127
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.1409 head_norm=1.010273
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.545362e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.1409 head_norm=0.925109 delta_norm=0.154536
[S17] aggregate: ACCEPT kept=['S2', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.721138 cos_to_last_merge=0.9377 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.938
[S2] round=7 local utility u=0.861717 metrics={'f1_val': 0.4160938496492347, 'auprc': 0.7415268908996728, 'loss_val': 1.064472227168454, 'psi': 0.54626706614941}-{'f1_val': 0.1417771333885667, 'auprc': 0.7400368525590236, 'loss_val': 1.137536154151989, 'psi': 0.3810810210567495}
[S3] START round=7 head_norm_before_train=0.917548 cos_to_last_merge=0.9578 (last merge round=2)
[S3] round=7 local utility u=0.817913 metrics={'f1_val': 0.39629664251078706, 'auprc': 0.8114584098636378, 'loss_val': 0.9202155402510265, 'psi': 0.5623613494519274}-{'f1_val': 0.13984006561410703, 'auprc': 0.8120036440702899, 'loss_val': 1.0189374620968061, 'psi': 0.4087054969965802}
[S4] START round=7 head_norm_before_train=1.057389 cos_to_last_merge=0.9519 (last merge round=1)
[S4] round=7 local utility u=0.088910 metrics={'f1_val': 0.6777348069323347, 'auprc': 0.6599785570122201, 'loss_val': 0.6748595678248338, 'psi': 0.6706323069642888}-{'f1_val': 0.6723260466983028, 'auprc': 0.6618595479530741, 'loss_val': 0.8258706828456043, 'psi': 0.6681394472002113}
[S5] START round=7 head_norm_before_train=0.539615 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.842090 metrics={'f1_val': 0.4163396018254457, 'auprc': 0.774689960797852, 'loss_val': 1.1824428051739198, 'psi': 0.5596797454144082}-{'f1_val': 0.14226190476190476, 'auprc': 0.7727391683609204, 'loss_val': 1.216304573965035, 'psi': 0.394452810201511}
[S6] START round=7 head_norm_before_train=0.956940 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.966722 metrics={'f1_val': 0.4172560359570804, 'auprc': 0.7228092622638455, 'loss_val': 1.0583425475565749, 'psi': 0.5394773264797864}-{'f1_val': 0.16874731484442282, 'auprc': 0.6140206449006838, 'loss_val': 1.1743677450131516, 'psi': 0.3468566468669272}
[S7] START round=7 head_norm_before_train=0.850639 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.005064 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7943550626866092, 'loss_val': 1.249410020045297, 'psi': 0.40297611871209865}-{'f1_val': 0.14205682272909165, 'auprc': 0.7946842957044167, 'loss_val': 1.26052503083742, 'psi': 0.4031078119192217}
[S8] START round=7 head_norm_before_train=1.342908 (no previous merge yet)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.3729322731464855, 'auprc': 0.967800246383983, 'loss_val': 0.7497911227064421, 'psi': 0.6108794624414845}-{'f1_val': 0.7146825535339066, 'auprc': 0.7826648642801985, 'loss_val': 0.8692081943947112, 'psi': 0.7418754778324235}
[S9] START round=7 head_norm_before_train=1.387726 (no previous merge yet)
[S9] round=7 local utility u=0.322534 metrics={'f1_val': 0.4170553235748482, 'auprc': 0.9610967554407562, 'loss_val': 0.7636149711265462, 'psi': 0.6346718963212115}-{'f1_val': 0.41697558078303143, 'auprc': 0.8135123670643382, 'loss_val': 0.9654513741989285, 'psi': 0.575590295295554}
[S10] START round=7 head_norm_before_train=1.009807 cos_to_last_merge=0.9771 (last merge round=2)
[S10] round=7 local utility u=0.081399 metrics={'f1_val': 0.4170518629654155, 'auprc': 0.7978544172518033, 'loss_val': 0.905935938189175, 'psi': 0.5693728846799706}-{'f1_val': 0.41634224672860876, 'auprc': 0.7973258439761477, 'loss_val': 1.06288990287156, 'psi': 0.5687356856276243}
[S11] START round=7 head_norm_before_train=0.617411 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.029079 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5986750150866971, 'loss_val': 1.1495965122588379, 'psi': 0.32371821605854517}-{'f1_val': 0.14041368337311058, 'auprc': 0.5985017386302283, 'loss_val': 1.20723392965399, 'psi': 0.32364890547595765}
[S13] START round=7 head_norm_before_train=0.748880 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.4161203556905605, 'auprc': 0.6959313309335383, 'loss_val': 1.0322713399531904, 'psi': 0.5280447457877516}-{'f1_val': 0.4163539771616168, 'auprc': 0.7276955934305946, 'loss_val': 1.0140592262416472, 'psi': 0.5408906236692079}
[S14] START round=7 head_norm_before_train=1.347182 (no previous merge yet)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.5218020681058075, 'auprc': 0.9702341040361748, 'loss_val': 0.9420151219260007, 'psi': 0.7011748824779545}-{'f1_val': 0.14035785288270378, 'auprc': 0.9442815375626117, 'loss_val': 1.1046584157394765, 'psi': 0.46192732675466697}
[S15] START round=7 head_norm_before_train=0.671690 cos_to_last_merge=0.9862 (last merge round=4)
[S15] round=7 local utility u=0.867598 metrics={'f1_val': 0.416567672447929, 'auprc': 0.7770542085099422, 'loss_val': 1.1233036774878908, 'psi': 0.5607622868727343}-{'f1_val': 0.13973365136155833, 'auprc': 0.777048922773815, 'loss_val': 1.1974799390410285, 'psi': 0.394659759926461}
[S16] START round=7 head_norm_before_train=0.811391 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.41683803618324633, 'auprc': 0.53948065997027, 'loss_val': 1.0989948640350744, 'psi': 0.4658950856980558}-{'f1_val': 0.4173069283424069, 'auprc': 0.7273904539911722, 'loss_val': 1.0718892852562676, 'psi': 0.5413403386019131}
[S17] START round=7 head_norm_before_train=0.925109 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.281530 metrics={'f1_val': 0.19262885530977547, 'auprc': 0.6721083969026772, 'loss_val': 1.074909273729584, 'psi': 0.3844206719469362}-{'f1_val': 0.14094896331738438, 'auprc': 0.6073763843777545, 'loss_val': 1.1336944121397798, 'psi': 0.3275199317415325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:51908
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:51912
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:51912
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S17] → sending delta(kind=head bytes=1787) to S16@127.0.0.1:51916
[S3] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.754890)
[S17] loaded HEAD from S2 (vec_in norm=0.754890)
[S17] cosine check vs S2: cos=0.5749
[S17] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.714139)
[S5] loaded HEAD from S15 (vec_in norm=0.714139)
[S5] cosine check vs S15: cos=0.7129
[S5] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.985730)
[S15] loaded HEAD from S6 (vec_in norm=0.985730)
[S15] cosine check vs S6: cos=0.5073
[S15] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.563061)
[S11] loaded HEAD from S5 (vec_in norm=0.563061)
[S11] cosine check vs S5: cos=0.4131
[S11] BUFFERED delta from S5 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S7
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.865100)
[S5] loaded HEAD from S7 (vec_in norm=0.865100)
[S5] cosine check vs S7: cos=0.4881
[S5] BUFFERED delta from S7 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1803) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.049565)
[S6] loaded HEAD from S10 (vec_in norm=1.049565)
[S6] cosine check vs S10: cos=0.9836
[S6] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.643686)
[S13] loaded HEAD from S11 (vec_in norm=0.643686)
[S13] cosine check vs S11: cos=0.5751
[S13] BUFFERED delta from S11 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1793) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.967466)
[S9] loaded HEAD from S3 (vec_in norm=0.967466)
[S9] cosine check vs S3: cos=-0.0047
[S9] DROPPED delta from S3 (cos=-0.0047 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.422080)
[S2] loaded HEAD from S9 (vec_in norm=1.422080)
[S2] cosine check vs S9: cos=-0.0323
[S2] DROPPED delta from S9 (cos=-0.0323 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.390262)
[S7] loaded HEAD from S14 (vec_in norm=1.390262)
[S7] cosine check vs S14: cos=0.8834
[S7] BUFFERED delta from S14 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.121329)
[S11] loaded HEAD from S4 (vec_in norm=1.121329)
[S11] cosine check vs S4: cos=0.8901
[S11] BUFFERED delta from S4 (total buffered=2)
[S17] sending update (kind=head size=1787 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1787) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.951883)
[S16] loaded HEAD from S17 (vec_in norm=0.951883)
[S16] cosine check vs S17: cos=0.8862
[S16] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4161 head_norm=0.789164
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.364818e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4162 head_norm=0.636660 delta_norm=0.336482
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4163 head_norm=0.563061
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.954363e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4163 head_norm=0.548085 delta_norm=0.195436
[S5] aggregate: ACCEPT kept=['S15', 'S7'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.1404 head_norm=0.643686
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.051624e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3555 head_norm=0.638079 delta_norm=0.105162
[S11] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.4173 head_norm=0.985730
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.754392e-02
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.4173 head_norm=1.013465 delta_norm=0.097544
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.865100
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.728929e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=1.096159 delta_norm=0.372893
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.4166 head_norm=0.714139
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.380206e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.7148 head_norm=0.740923 delta_norm=0.438021
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4168 head_norm=0.838662
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.205534e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.3859 head_norm=0.869525 delta_norm=0.220553
[S16] aggregate: ROLLBACK (f1_val pre=0.417 post=0.386 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.1926 head_norm=0.951883
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.030101e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3112 head_norm=0.758652 delta_norm=0.403010
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.754890 cos_to_last_merge=0.9210 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.921
[S2] round=8 local utility u=0.079273 metrics={'f1_val': 0.41714901250782, 'auprc': 0.7661151416507013, 'loss_val': 0.986022566909366, 'psi': 0.5567354641649724}-{'f1_val': 0.4160938496492347, 'auprc': 0.7415268908996728, 'loss_val': 1.064472227168454, 'psi': 0.54626706614941}
[S3] START round=8 head_norm_before_train=0.967466 cos_to_last_merge=0.9409 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=8 local utility u=0.680787 metrics={'f1_val': 0.5114916811177597, 'auprc': 0.9654729119598691, 'loss_val': 0.7118546678961679, 'psi': 0.6930841734546034}-{'f1_val': 0.39629664251078706, 'auprc': 0.8114584098636378, 'loss_val': 0.9202155402510265, 'psi': 0.5623613494519274}
[S4] START round=8 head_norm_before_train=1.121329 cos_to_last_merge=0.9350 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.935
[S4] round=8 local utility u=0.011014 metrics={'f1_val': 0.668229955091418, 'auprc': 0.6572838691083168, 'loss_val': 0.5877193640055226, 'psi': 0.6638515206981775}-{'f1_val': 0.6777348069323347, 'auprc': 0.6599785570122201, 'loss_val': 0.6748595678248338, 'psi': 0.6706323069642888}
[S5] START round=8 head_norm_before_train=0.548085 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.021430 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.77397673362109, 'loss_val': 1.1471143915126585, 'psi': 0.5603615080270878}-{'f1_val': 0.4163396018254457, 'auprc': 0.774689960797852, 'loss_val': 1.1824428051739198, 'psi': 0.5596797454144082}
[S6] START round=8 head_norm_before_train=1.013465 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.030360 metrics={'f1_val': 0.4172958214624881, 'auprc': 0.7053852527707183, 'loss_val': 0.945589434564837, 'psi': 0.5325315939857802}-{'f1_val': 0.4172560359570804, 'auprc': 0.7228092622638455, 'loss_val': 1.0583425475565749, 'psi': 0.5394773264797864}
[S7] START round=8 head_norm_before_train=1.096159 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.018609 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7952888479071633, 'loss_val': 1.214993183910952, 'psi': 0.4033496328003203}-{'f1_val': 0.14205682272909165, 'auprc': 0.7943550626866092, 'loss_val': 1.249410020045297, 'psi': 0.40297611871209865}
[S8] START round=8 head_norm_before_train=1.396413 (no previous merge yet)
[S8] round=8 local utility u=0.099785 metrics={'f1_val': 0.3727983816295533, 'auprc': 0.9961386504928584, 'loss_val': 0.6344329823559879, 'psi': 0.6221344891748753}-{'f1_val': 0.3729322731464855, 'auprc': 0.967800246383983, 'loss_val': 0.7497911227064421, 'psi': 0.6108794624414845}
[S9] START round=8 head_norm_before_train=1.422080 (no previous merge yet)
[S9] round=8 local utility u=1.000000 metrics={'f1_val': 0.7017906989076834, 'auprc': 0.9924358442282688, 'loss_val': 0.5587973996183845, 'psi': 0.8180487570359176}-{'f1_val': 0.4170553235748482, 'auprc': 0.9610967554407562, 'loss_val': 0.7636149711265462, 'psi': 0.6346718963212115}
[S10] START round=8 head_norm_before_train=1.049565 cos_to_last_merge=0.9675 (last merge round=2)
[S10] round=8 local utility u=0.005384 metrics={'f1_val': 0.3866813904384412, 'auprc': 0.8150084474695821, 'loss_val': 0.7644071986456941, 'psi': 0.5580122132508976}-{'f1_val': 0.4170518629654155, 'auprc': 0.7978544172518033, 'loss_val': 0.905935938189175, 'psi': 0.5693728846799706}
[S11] START round=8 head_norm_before_train=0.638079 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=1.000000 metrics={'f1_val': 0.3966199105536595, 'auprc': 0.7560158510111488, 'loss_val': 1.0601164928817433, 'psi': 0.5403782867366552}-{'f1_val': 0.14041368337311058, 'auprc': 0.5986750150866971, 'loss_val': 1.1495965122588379, 'psi': 0.32371821605854517}
[S13] START round=8 head_norm_before_train=0.636660 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.5495598441736562, 'loss_val': 1.0610958623254336, 'psi': 0.46930829886088077}-{'f1_val': 0.4161203556905605, 'auprc': 0.6959313309335383, 'loss_val': 1.0322713399531904, 'psi': 0.5280447457877516}
[S14] START round=8 head_norm_before_train=1.390262 (no previous merge yet)
[S14] round=8 local utility u=0.761295 metrics={'f1_val': 0.7483945909855279, 'auprc': 0.9703758887454705, 'loss_val': 0.7794065127838522, 'psi': 0.837187110089505}-{'f1_val': 0.5218020681058075, 'auprc': 0.9702341040361748, 'loss_val': 0.9420151219260007, 'psi': 0.7011748824779545}
[S15] START round=8 head_norm_before_train=0.740923 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.042207 metrics={'f1_val': 0.4163028592231327, 'auprc': 0.778802143227858, 'loss_val': 1.0425449034240457, 'psi': 0.5613025728250228}-{'f1_val': 0.416567672447929, 'auprc': 0.7770542085099422, 'loss_val': 1.1233036774878908, 'psi': 0.5607622868727343}
[S16] START round=8 head_norm_before_train=0.869525 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.101248 metrics={'f1_val': 0.36838356333438826, 'auprc': 0.7071991963415576, 'loss_val': 1.1089274673004255, 'psi': 0.503909816537256}-{'f1_val': 0.41683803618324633, 'auprc': 0.53948065997027, 'loss_val': 1.0989948640350744, 'psi': 0.4658950856980558}
[S17] START round=8 head_norm_before_train=0.758652 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.547092 metrics={'f1_val': 0.3899963300401365, 'auprc': 0.6000708074475887, 'loss_val': 0.9488168226402042, 'psi': 0.47402612100311736}-{'f1_val': 0.19262885530977547, 'auprc': 0.6721083969026772, 'loss_val': 1.074909273729584, 'psi': 0.3844206719469362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:51907
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.796569)
[S17] loaded HEAD from S2 (vec_in norm=0.796569)
[S17] cosine check vs S2: cos=0.8366
[S17] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.094334)
[S6] loaded HEAD from S10 (vec_in norm=1.094334)
[S6] cosine check vs S10: cos=0.9870
[S6] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1790) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.028295)
[S9] loaded HEAD from S3 (vec_in norm=1.028295)
[S9] cosine check vs S3: cos=-0.0061
[S9] DROPPED delta from S3 (cos=-0.0061 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.568858)
[S11] loaded HEAD from S5 (vec_in norm=0.568858)
[S11] cosine check vs S5: cos=0.4143
[S11] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.184630)
[S11] loaded HEAD from S4 (vec_in norm=1.184630)
[S11] cosine check vs S4: cos=0.8878
[S11] BUFFERED delta from S4 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1794) from S7
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.099642)
[S5] loaded HEAD from S7 (vec_in norm=1.099642)
[S5] cosine check vs S7: cos=0.6058
[S5] BUFFERED delta from S7 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.444150)
[S17] loaded HEAD from S8 (vec_in norm=1.444150)
[S17] cosine check vs S8: cos=0.7154
[S17] BUFFERED delta from S8 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.046513)
[S15] loaded HEAD from S6 (vec_in norm=1.046513)
[S15] cosine check vs S6: cos=0.8673
[S15] BUFFERED delta from S6 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.671339)
[S13] loaded HEAD from S11 (vec_in norm=0.671339)
[S13] cosine check vs S11: cos=0.8348
[S13] BUFFERED delta from S11 (total buffered=1)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:51916
[S16] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.776085)
[S5] loaded HEAD from S15 (vec_in norm=0.776085)
[S5] cosine check vs S15: cos=0.5965
[S5] BUFFERED delta from S15 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1793) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.800975)
[S16] loaded HEAD from S17 (vec_in norm=0.800975)
[S16] cosine check vs S17: cos=0.8959
[S16] BUFFERED delta from S17 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.895698)
[S7] loaded HEAD from S16 (vec_in norm=0.895698)
[S7] cosine check vs S16: cos=0.2012
[S7] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.442581)
[S7] loaded HEAD from S14 (vec_in norm=1.442581)
[S7] cosine check vs S14: cos=0.9772
[S7] BUFFERED delta from S14 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:51902
[S9] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.463254)
[S2] loaded HEAD from S9 (vec_in norm=1.463254)
[S2] cosine check vs S9: cos=-0.0306
[S2] DROPPED delta from S9 (cos=-0.0306 < 0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1421 head_norm=1.099642
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.458514e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.1421 head_norm=0.966727 delta_norm=0.245851
[S7] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4180 head_norm=0.568858
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.019430e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4180 head_norm=0.601596 delta_norm=0.201943
[S5] aggregate: ACCEPT kept=['S7', 'S15'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3966 head_norm=0.671339
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.032450e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3966 head_norm=0.665418 delta_norm=0.103245
[S11] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.4173 head_norm=1.046513
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.956208e-02
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.4172 head_norm=1.066938 delta_norm=0.089562
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.4163 head_norm=0.776085
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.686277e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.4185 head_norm=0.881242 delta_norm=0.268628
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.4158 head_norm=0.678870
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.940424e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4159 head_norm=0.646628 delta_norm=0.194042
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.3684 head_norm=0.895698
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.989189e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.3666 head_norm=0.826045 delta_norm=0.198919
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3900 head_norm=0.800975
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.799137e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3538 head_norm=0.844396 delta_norm=0.179914
[S17] aggregate: ROLLBACK (f1_val pre=0.390 post=0.354 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=0.796569 cos_to_last_merge=0.9013 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.901
[S2] round=9 local utility u=0.445728 metrics={'f1_val': 0.6052940380156795, 'auprc': 0.6472920190920032, 'loss_val': 0.8669673300122994, 'psi': 0.622093230446209}-{'f1_val': 0.41714901250782, 'auprc': 0.7661151416507013, 'loss_val': 0.986022566909366, 'psi': 0.5567354641649724}
[S3] START round=9 head_norm_before_train=1.028295 cos_to_last_merge=0.9205 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.5355236151410893, 'auprc': 0.9259171613241153, 'loss_val': 0.7430445427978735, 'psi': 0.6916810336142997}-{'f1_val': 0.5114916811177597, 'auprc': 0.9654729119598691, 'loss_val': 0.7118546678961679, 'psi': 0.6930841734546034}
[S4] START round=9 head_norm_before_train=1.184630 cos_to_last_merge=0.9179 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=9 local utility u=0.069553 metrics={'f1_val': 0.6738409057956205, 'auprc': 0.6575565778602579, 'loss_val': 0.48309641088170197, 'psi': 0.6673271746214755}-{'f1_val': 0.668229955091418, 'auprc': 0.6572838691083168, 'loss_val': 0.5877193640055226, 'psi': 0.6638515206981775}
[S5] START round=9 head_norm_before_train=0.601596 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.030474 metrics={'f1_val': 0.41770847824441854, 'auprc': 0.7733891864794767, 'loss_val': 1.082945913553919, 'psi': 0.5599807615384418}-{'f1_val': 0.41795135763108626, 'auprc': 0.77397673362109, 'loss_val': 1.1471143915126585, 'psi': 0.5603615080270878}
[S6] START round=9 head_norm_before_train=1.066938 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=1.000000 metrics={'f1_val': 0.6814083596179805, 'auprc': 0.7904465957413541, 'loss_val': 0.7411811613178316, 'psi': 0.72502365406733}-{'f1_val': 0.4172958214624881, 'auprc': 0.7053852527707183, 'loss_val': 0.945589434564837, 'psi': 0.5325315939857802}
[S7] START round=9 head_norm_before_train=0.966727 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.005392 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7837836545149798, 'loss_val': 1.1696945497311475, 'psi': 0.3987475554434469}-{'f1_val': 0.14205682272909165, 'auprc': 0.7952888479071633, 'loss_val': 1.214993183910952, 'psi': 0.4033496328003203}
[S8] START round=9 head_norm_before_train=1.444150 (no previous merge yet)
[S8] round=9 local utility u=1.000000 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9933962843162343, 'loss_val': 0.46609126926566863, 'psi': 0.8256522807168498}-{'f1_val': 0.3727983816295533, 'auprc': 0.9961386504928584, 'loss_val': 0.6344329823559879, 'psi': 0.6221344891748753}
[S9] START round=9 head_norm_before_train=1.463254 (no previous merge yet)
[S9] round=9 local utility u=0.084618 metrics={'f1_val': 0.7017167946673312, 'auprc': 0.9988421981930425, 'loss_val': 0.40833714858693493, 'psi': 0.8205669560776157}-{'f1_val': 0.7017906989076834, 'auprc': 0.9924358442282688, 'loss_val': 0.5587973996183845, 'psi': 0.8180487570359176}
[S10] START round=9 head_norm_before_train=1.094334 cos_to_last_merge=0.9553 (last merge round=2)
[S10] round=9 local utility u=0.352582 metrics={'f1_val': 0.39477545253270124, 'auprc': 0.9946696722298964, 'loss_val': 0.6467913004256505, 'psi': 0.6347331404115792}-{'f1_val': 0.3866813904384412, 'auprc': 0.8150084474695821, 'loss_val': 0.7644071986456941, 'psi': 0.5580122132508976}
[S11] START round=9 head_norm_before_train=0.665418 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.024007 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.7371638859531944, 'loss_val': 0.9551402221186749, 'psi': 0.5327968959370015}-{'f1_val': 0.3966199105536595, 'auprc': 0.7560158510111488, 'loss_val': 1.0601164928817433, 'psi': 0.5403782867366552}
[S13] START round=9 head_norm_before_train=0.646628 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.415989 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.8192503656032669, 'loss_val': 1.038188765068557, 'psi': 0.5771845074327251}-{'f1_val': 0.41580726865236384, 'auprc': 0.5495598441736562, 'loss_val': 1.0610958623254336, 'psi': 0.46930829886088077}
[S14] START round=9 head_norm_before_train=1.442581 (no previous merge yet)
[S14] round=9 local utility u=0.577827 metrics={'f1_val': 0.8918709008711059, 'auprc': 0.9982518549965935, 'loss_val': 0.5682380218841614, 'psi': 0.9344232825213009}-{'f1_val': 0.7483945909855279, 'auprc': 0.9703758887454705, 'loss_val': 0.7794065127838522, 'psi': 0.837187110089505}
[S15] START round=9 head_norm_before_train=0.881242 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.133485 metrics={'f1_val': 0.4315819986031437, 'auprc': 0.799820205869288, 'loss_val': 0.9303041447843924, 'psi': 0.5788772815096015}-{'f1_val': 0.4163028592231327, 'auprc': 0.778802143227858, 'loss_val': 1.0425449034240457, 'psi': 0.5613025728250228}
[S16] START round=9 head_norm_before_train=0.826045 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.40378815946590396, 'auprc': 0.5255994257600186, 'loss_val': 1.040705496807733, 'psi': 0.4525126659835498}-{'f1_val': 0.36838356333438826, 'auprc': 0.7071991963415576, 'loss_val': 1.1089274673004255, 'psi': 0.503909816537256}
[S17] START round=9 head_norm_before_train=0.844396 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.4067628731562403, 'auprc': 0.5157213670184546, 'loss_val': 0.9265555878260308, 'psi': 0.45034627070112604}-{'f1_val': 0.3899963300401365, 'auprc': 0.6000708074475887, 'loss_val': 0.9488168226402042, 'psi': 0.47402612100311736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:51907
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:51912
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:51917
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S7
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.982268)
[S5] loaded HEAD from S7 (vec_in norm=0.982268)
[S5] cosine check vs S7: cos=0.7915
[S5] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.912178)
[S5] loaded HEAD from S15 (vec_in norm=0.912178)
[S5] cosine check vs S15: cos=0.5578
[S5] BUFFERED delta from S15 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.492566)
[S17] loaded HEAD from S8 (vec_in norm=1.492566)
[S17] cosine check vs S8: cos=0.8135
[S17] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1805) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.238117)
[S11] loaded HEAD from S4 (vec_in norm=1.238117)
[S11] cosine check vs S4: cos=0.8874
[S11] BUFFERED delta from S4 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1804) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.100151)
[S15] loaded HEAD from S6 (vec_in norm=1.100151)
[S15] cosine check vs S6: cos=0.9476
[S15] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.621418)
[S11] loaded HEAD from S5 (vec_in norm=0.621418)
[S11] cosine check vs S5: cos=0.4296
[S11] BUFFERED delta from S5 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.496114)
[S7] loaded HEAD from S14 (vec_in norm=1.496114)
[S7] cosine check vs S14: cos=0.9425
[S7] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1790) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.684166)
[S5] loaded HEAD from S13 (vec_in norm=0.684166)
[S5] cosine check vs S13: cos=0.4069
[S5] BUFFERED delta from S13 (total buffered=3)
[S2] RECEIVED delta(kind=head bytes=1798) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.510617)
[S2] loaded HEAD from S9 (vec_in norm=1.510617)
[S2] cosine check vs S9: cos=-0.0279
[S2] DROPPED delta from S9 (cos=-0.0279 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.844829)
[S17] loaded HEAD from S2 (vec_in norm=0.844829)
[S17] cosine check vs S2: cos=0.7413
[S17] BUFFERED delta from S2 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.707368)
[S13] loaded HEAD from S11 (vec_in norm=0.707368)
[S13] cosine check vs S11: cos=0.9070
[S13] BUFFERED delta from S11 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.144981)
[S6] loaded HEAD from S10 (vec_in norm=1.144981)
[S6] cosine check vs S10: cos=0.9885
[S6] BUFFERED delta from S10 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.3966 head_norm=0.707368
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.146202e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.3966 head_norm=0.704386 delta_norm=0.114620
[S11] aggregate: ACCEPT kept=['S4', 'S5'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.4158 head_norm=0.684166
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.504736e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.4158 head_norm=0.679399 delta_norm=0.150474
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.6814 head_norm=1.100151
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.786514e-02
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.6974 head_norm=1.119346 delta_norm=0.087865
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.1421 head_norm=0.982268
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.290602e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.1421 head_norm=1.222016 delta_norm=0.329060
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.4316 head_norm=0.912178
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.874232e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.7024 head_norm=0.993012 delta_norm=0.187423
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4177 head_norm=0.621418
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.098791e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4176 head_norm=0.574215 delta_norm=0.209879
[S5] aggregate: ACCEPT kept=['S7', 'S15', 'S13'] (k=3/3) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.4068 head_norm=0.886835
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.279647e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3370 head_norm=0.912420 delta_norm=0.127965
[S17] aggregate: ROLLBACK (f1_val pre=0.407 post=0.337 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=0.844829 cos_to_last_merge=0.8796 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.880
[S2] round=10 local utility u=0.346316 metrics={'f1_val': 0.6512856792080421, 'auprc': 0.7596282358700208, 'loss_val': 0.7872943766930399, 'psi': 0.6946227018728336}-{'f1_val': 0.6052940380156795, 'auprc': 0.6472920190920032, 'loss_val': 0.8669673300122994, 'psi': 0.622093230446209}
[S3] START round=10 head_norm_before_train=1.087105 cos_to_last_merge=0.9005 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.901
[S3] round=10 local utility u=0.263370 metrics={'f1_val': 0.5710023566874747, 'auprc': 0.9933310006526004, 'loss_val': 0.6314191294779007, 'psi': 0.739933814273525}-{'f1_val': 0.5355236151410893, 'auprc': 0.9259171613241153, 'loss_val': 0.7430445427978735, 'psi': 0.6916810336142997}
[S4] START round=10 head_norm_before_train=1.238117 cos_to_last_merge=0.9028 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.903
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.668724471710239, 'auprc': 0.6537441390985516, 'loss_val': 0.5187270107164675, 'psi': 0.6627323386655639}-{'f1_val': 0.6738409057956205, 'auprc': 0.6575565778602579, 'loss_val': 0.48309641088170197, 'psi': 0.6673271746214755}
[S5] START round=10 head_norm_before_train=0.574215 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.404249 metrics={'f1_val': 0.6045425928918903, 'auprc': 0.643995263299389, 'loss_val': 1.007271237354156, 'psi': 0.6203236610548898}-{'f1_val': 0.41770847824441854, 'auprc': 0.7733891864794767, 'loss_val': 1.082945913553919, 'psi': 0.5599807615384418}
[S6] START round=10 head_norm_before_train=1.119346 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.135003 metrics={'f1_val': 0.7109960590866052, 'auprc': 0.7893506417312247, 'loss_val': 0.6454142784684903, 'psi': 0.742337892144453}-{'f1_val': 0.6814083596179805, 'auprc': 0.7904465957413541, 'loss_val': 0.7411811613178316, 'psi': 0.72502365406733}
[S7] START round=10 head_norm_before_train=1.222016 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.886729 metrics={'f1_val': 0.4096397288990927, 'auprc': 0.7949767414795077, 'loss_val': 1.0353136718793854, 'psi': 0.5637745339312588}-{'f1_val': 0.14205682272909165, 'auprc': 0.7837836545149798, 'loss_val': 1.1696945497311475, 'psi': 0.3987475554434469}
[S8] START round=10 head_norm_before_train=1.492566 (no previous merge yet)
[S8] round=10 local utility u=0.071427 metrics={'f1_val': 0.7141738056351523, 'auprc': 0.9946692383244079, 'loss_val': 0.3291604437010328, 'psi': 0.8263719787108545}-{'f1_val': 0.7138229449839267, 'auprc': 0.9933962843162343, 'loss_val': 0.46609126926566863, 'psi': 0.8256522807168498}
[S9] START round=10 head_norm_before_train=1.510617 (no previous merge yet)
[S9] round=10 local utility u=0.057719 metrics={'f1_val': 0.7017167946673312, 'auprc': 0.9983549092191855, 'loss_val': 0.29143727893854754, 'psi': 0.8203720404880729}-{'f1_val': 0.7017167946673312, 'auprc': 0.9988421981930425, 'loss_val': 0.40833714858693493, 'psi': 0.8205669560776157}
[S10] START round=10 head_norm_before_train=1.144981 cos_to_last_merge=0.9410 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.941
[S10] round=10 local utility u=0.843728 metrics={'f1_val': 0.6565511070026363, 'auprc': 0.9933204452964158, 'loss_val': 0.5259411574401931, 'psi': 0.7912588423201481}-{'f1_val': 0.39477545253270124, 'auprc': 0.9946696722298964, 'loss_val': 0.6467913004256505, 'psi': 0.6347331404115792}
[S11] START round=10 head_norm_before_train=0.704386 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.172128 metrics={'f1_val': 0.4432447611820147, 'auprc': 0.7251881115699736, 'loss_val': 0.8551113745004038, 'psi': 0.5560221013371982}-{'f1_val': 0.39655223592620625, 'auprc': 0.7371638859531944, 'loss_val': 0.9551402221186749, 'psi': 0.5327968959370015}
[S13] START round=10 head_norm_before_train=0.679399 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.38779420149632265, 'auprc': 0.7060681791581649, 'loss_val': 1.016842448939992, 'psi': 0.5151037925610595}-{'f1_val': 0.41580726865236384, 'auprc': 0.8192503656032669, 'loss_val': 1.038188765068557, 'psi': 0.5771845074327251}
[S14] START round=10 head_norm_before_train=1.496114 (no previous merge yet)
[S14] round=10 local utility u=0.159728 metrics={'f1_val': 0.9223828438247015, 'auprc': 0.9941222089188042, 'loss_val': 0.41946538111146375, 'psi': 0.9510785898623426}-{'f1_val': 0.8918709008711059, 'auprc': 0.9982518549965935, 'loss_val': 0.5682380218841614, 'psi': 0.9344232825213009}
[S15] START round=10 head_norm_before_train=0.993012 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.881116 metrics={'f1_val': 0.7010097172191375, 'auprc': 0.7997640364807432, 'loss_val': 0.7844702400682294, 'psi': 0.7405114449237798}-{'f1_val': 0.4315819986031437, 'auprc': 0.799820205869288, 'loss_val': 0.9303041447843924, 'psi': 0.5788772815096015}
[S16] START round=10 head_norm_before_train=0.859433 cos_to_last_merge=0.9935 (last merge round=8)
[S16] round=10 local utility u=0.388135 metrics={'f1_val': 0.42715083411195526, 'auprc': 0.7400731539574493, 'loss_val': 1.0480332429036496, 'psi': 0.552319762050153}-{'f1_val': 0.40378815946590396, 'auprc': 0.5255994257600186, 'loss_val': 1.040705496807733, 'psi': 0.4525126659835498}
[S17] START round=10 head_norm_before_train=0.912420 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.33371844729869465, 'auprc': 0.4813356628999702, 'loss_val': 1.1560989959596748, 'psi': 0.39276533353920484}-{'f1_val': 0.4067628731562403, 'auprc': 0.5157213670184546, 'loss_val': 0.9265555878260308, 'psi': 0.45034627070112604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:51917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.026570)
[S5] loaded HEAD from S15 (vec_in norm=1.026570)
[S5] cosine check vs S15: cos=0.6899
[S5] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1801) from S7
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.239736)
[S5] loaded HEAD from S7 (vec_in norm=1.239736)
[S5] cosine check vs S7: cos=0.5646
[S5] BUFFERED delta from S7 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1792) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.146907)
[S9] loaded HEAD from S3 (vec_in norm=1.146907)
[S9] cosine check vs S3: cos=-0.0108
[S9] DROPPED delta from S3 (cos=-0.0108 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.605953)
[S11] loaded HEAD from S5 (vec_in norm=0.605953)
[S11] cosine check vs S5: cos=0.6666
[S11] BUFFERED delta from S5 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.751799)
[S13] loaded HEAD from S11 (vec_in norm=0.751799)
[S13] cosine check vs S11: cos=0.9304
[S13] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.900214)
[S17] loaded HEAD from S2 (vec_in norm=0.900214)
[S17] cosine check vs S2: cos=0.6936
[S17] BUFFERED delta from S2 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1805) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.155279)
[S15] loaded HEAD from S6 (vec_in norm=1.155279)
[S15] cosine check vs S6: cos=0.9681
[S15] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.546856)
[S7] loaded HEAD from S14 (vec_in norm=1.546856)
[S7] cosine check vs S14: cos=0.9859
[S7] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1795) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.555602)
[S2] loaded HEAD from S9 (vec_in norm=1.555602)
[S2] cosine check vs S9: cos=-0.0243
[S2] DROPPED delta from S9 (cos=-0.0243 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.203445)
[S6] loaded HEAD from S10 (vec_in norm=1.203445)
[S6] cosine check vs S10: cos=0.9889
[S6] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.543289)
[S17] loaded HEAD from S8 (vec_in norm=1.543289)
[S17] cosine check vs S8: cos=0.8504
[S17] BUFFERED delta from S8 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:51908
[S16] sending update (kind=head size=1793 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1793) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.902506)
[S7] loaded HEAD from S16 (vec_in norm=0.902506)
[S7] cosine check vs S16: cos=0.2186
[S7] BUFFERED delta from S16 (total buffered=2)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.398 → S17@127.0.0.1:51917
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.7110 head_norm=1.155279
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.100374e-02
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.7110 head_norm=1.176093 delta_norm=0.091004
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.432 → S15@127.0.0.1:51915
[S9] ⇄ pheromone p=0.390 → S2@127.0.0.1:51902
[S3] ⇄ pheromone p=0.362 → S9@127.0.0.1:51910
[S14] ⇄ pheromone p=0.448 → S7@127.0.0.1:51908
[S2] ⇄ pheromone p=0.367 → S17@127.0.0.1:51917
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.6045 head_norm=0.605953
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.259403e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.4145 head_norm=0.691167 delta_norm=0.225940
[S5] aggregate: ROLLBACK (f1_val pre=0.605 post=0.414 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.304 → S11@127.0.0.1:51912
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.4432 head_norm=0.751799
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.850555e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.4603 head_norm=0.620430 delta_norm=0.285055
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.310 → S13@127.0.0.1:51913
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4096 head_norm=1.239736
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.589927e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4165 head_norm=1.065229 delta_norm=0.258993
[S7] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.304 → S5@127.0.0.1:51905
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.7010 head_norm=1.026570
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.518246e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.7009 head_norm=1.082223 delta_norm=0.151825
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.418 → S5@127.0.0.1:51905
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.3878 head_norm=0.716509
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.380391e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.4158 head_norm=0.721276 delta_norm=0.138039
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.268 → S5@127.0.0.1:51905
[S10] ⇄ pheromone p=0.421 → S6@127.0.0.1:51907
[S4] ⇄ pheromone p=0.251 → S11@127.0.0.1:51912
[S16] ⇄ pheromone p=0.261 → S7@127.0.0.1:51908
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3337 head_norm=0.947165
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.065095e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3558 head_norm=0.963637 delta_norm=0.106509
[S17] aggregate: ACCEPT kept=['S2', 'S8'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.216 → S16@127.0.0.1:51916
[S2] START round=11 head_norm_before_train=0.900214 cos_to_last_merge=0.8565 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.856
[S2] round=11 local utility u=0.106056 metrics={'f1_val': 0.6998101921290396, 'auprc': 0.6924610731161503, 'loss_val': 0.6648269888314661, 'psi': 0.6968705445238839}-{'f1_val': 0.6512856792080421, 'auprc': 0.7596282358700208, 'loss_val': 0.7872943766930399, 'psi': 0.6946227018728336}
[S3] START round=11 head_norm_before_train=1.146907 cos_to_last_merge=0.8825 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.883
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.48067078677718245, 'auprc': 0.8518032911909293, 'loss_val': 0.6974094884982411, 'psi': 0.6291237885426813}-{'f1_val': 0.5710023566874747, 'auprc': 0.9933310006526004, 'loss_val': 0.6314191294779007, 'psi': 0.739933814273525}
[S4] START round=11 head_norm_before_train=1.288232 cos_to_last_merge=0.8894 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.889
[S4] round=11 local utility u=0.014201 metrics={'f1_val': 0.6682580775020678, 'auprc': 0.6542391443436424, 'loss_val': 0.48901235016790345, 'psi': 0.6626505042386976}-{'f1_val': 0.668724471710239, 'auprc': 0.6537441390985516, 'loss_val': 0.5187270107164675, 'psi': 0.6627323386655639}
[S5] START round=11 head_norm_before_train=0.691167 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.559701 metrics={'f1_val': 0.7146275168069246, 'auprc': 0.7729016954279401, 'loss_val': 0.9350989267938035, 'psi': 0.7379371882553307}-{'f1_val': 0.6045425928918903, 'auprc': 0.643995263299389, 'loss_val': 1.007271237354156, 'psi': 0.6203236610548898}
[S6] START round=11 head_norm_before_train=1.176093 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.314692 metrics={'f1_val': 0.7100985646784144, 'auprc': 0.9586372866407494, 'loss_val': 0.518504530147099, 'psi': 0.8095140534633484}-{'f1_val': 0.7109960590866052, 'auprc': 0.7893506417312247, 'loss_val': 0.6454142784684903, 'psi': 0.742337892144453}
[S7] START round=11 head_norm_before_train=1.065229 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.965699 metrics={'f1_val': 0.7145938979314673, 'auprc': 0.7948157121463827, 'loss_val': 0.9331578658212142, 'psi': 0.7466826236174335}-{'f1_val': 0.4096397288990927, 'auprc': 0.7949767414795077, 'loss_val': 1.0353136718793854, 'psi': 0.5637745339312588}
[S8] START round=11 head_norm_before_train=1.543289 (no previous merge yet)
[S8] round=11 local utility u=0.031459 metrics={'f1_val': 0.7141738056351523, 'auprc': 0.9935669126956139, 'loss_val': 0.2629357287469596, 'psi': 0.825931048459337}-{'f1_val': 0.7141738056351523, 'auprc': 0.9946692383244079, 'loss_val': 0.3291604437010328, 'psi': 0.8263719787108545}
[S9] START round=11 head_norm_before_train=1.555602 (no previous merge yet)
[S9] round=11 local utility u=0.025960 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9981636675413841, 'loss_val': 0.2374429585858804, 'psi': 0.8201455233947567}-{'f1_val': 0.7017167946673312, 'auprc': 0.9983549092191855, 'loss_val': 0.29143727893854754, 'psi': 0.8203720404880729}
[S10] START round=11 head_norm_before_train=1.203445 cos_to_last_merge=0.9260 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=11 local utility u=0.180258 metrics={'f1_val': 0.6929227949900373, 'auprc': 0.9961132520035131, 'loss_val': 0.3920335065351574, 'psi': 0.8141989777954277}-{'f1_val': 0.6565511070026363, 'auprc': 0.9933204452964158, 'loss_val': 0.5259411574401931, 'psi': 0.7912588423201481}
[S11] START round=11 head_norm_before_train=0.620430 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.730398 metrics={'f1_val': 0.6624450655612856, 'auprc': 0.7685657434409655, 'loss_val': 0.8396508226829168, 'psi': 0.7048933367131576}-{'f1_val': 0.4432447611820147, 'auprc': 0.7251881115699736, 'loss_val': 0.8551113745004038, 'psi': 0.5560221013371982}
[S13] START round=11 head_norm_before_train=0.721276 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.806822 metrics={'f1_val': 0.6434898691508725, 'auprc': 0.7083488190229815, 'loss_val': 0.9442152704380686, 'psi': 0.669433449099716}-{'f1_val': 0.38779420149632265, 'auprc': 0.7060681791581649, 'loss_val': 1.016842448939992, 'psi': 0.5151037925610595}
[S14] START round=11 head_norm_before_train=1.546856 (no previous merge yet)
[S14] round=11 local utility u=0.290932 metrics={'f1_val': 0.985898569733431, 'auprc': 0.9999908023958329, 'loss_val': 0.23630125208770006, 'psi': 0.9915354627983919}-{'f1_val': 0.9223828438247015, 'auprc': 0.9941222089188042, 'loss_val': 0.41946538111146375, 'psi': 0.9510785898623426}
[S15] START round=11 head_norm_before_train=1.082223 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.081187 metrics={'f1_val': 0.6955193961550213, 'auprc': 0.8183287654751725, 'loss_val': 0.6448484919902734, 'psi': 0.7446431438830818}-{'f1_val': 0.7010097172191375, 'auprc': 0.7997640364807432, 'loss_val': 0.7844702400682294, 'psi': 0.7405114449237798}
[S16] START round=11 head_norm_before_train=0.902506 cos_to_last_merge=0.9791 (last merge round=8)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.3567962009228187, 'auprc': 0.7305374133288145, 'loss_val': 1.0015351914454258, 'psi': 0.506292685885217}-{'f1_val': 0.42715083411195526, 'auprc': 0.7400731539574493, 'loss_val': 1.0480332429036496, 'psi': 0.552319762050153}
[S17] START round=11 head_norm_before_train=0.963637 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.143617 metrics={'f1_val': 0.34766836419108466, 'auprc': 0.48166763066558765, 'loss_val': 0.9535609406287512, 'psi': 0.4012680707808859}-{'f1_val': 0.33371844729869465, 'auprc': 0.4813356628999702, 'loss_val': 1.1560989959596748, 'psi': 0.39276533353920484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:51905
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.336642)
[S11] loaded HEAD from S4 (vec_in norm=1.336642)
[S11] cosine check vs S4: cos=0.6959
[S11] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.265106)
[S6] loaded HEAD from S10 (vec_in norm=1.265106)
[S6] cosine check vs S10: cos=0.9886
[S6] BUFFERED delta from S10 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.598488)
[S2] loaded HEAD from S9 (vec_in norm=1.598488)
[S2] cosine check vs S9: cos=-0.0203
[S2] DROPPED delta from S9 (cos=-0.0203 < 0.0)
[S13] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.759607)
[S5] loaded HEAD from S13 (vec_in norm=0.759607)
[S5] cosine check vs S13: cos=0.5500
[S5] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:51912
[S5] sending update (kind=head size=1794 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1794) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.719519)
[S11] loaded HEAD from S5 (vec_in norm=0.719519)
[S11] cosine check vs S5: cos=0.7752
[S11] BUFFERED delta from S5 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:51908
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1791) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.671742)
[S13] loaded HEAD from S11 (vec_in norm=0.671742)
[S13] cosine check vs S11: cos=0.9203
[S13] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.583622)
[S17] loaded HEAD from S8 (vec_in norm=1.583622)
[S17] cosine check vs S8: cos=0.8649
[S17] BUFFERED delta from S8 (total buffered=1)
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.591486)
[S7] loaded HEAD from S14 (vec_in norm=1.591486)
[S7] cosine check vs S14: cos=0.9506
[S7] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:51905
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:51905
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:51916
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.120759)
[S5] loaded HEAD from S15 (vec_in norm=1.120759)
[S5] cosine check vs S15: cos=0.6836
[S5] BUFFERED delta from S15 (total buffered=2)
[S7] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1793) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.216372)
[S15] loaded HEAD from S6 (vec_in norm=1.216372)
[S15] cosine check vs S6: cos=0.9755
[S15] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1792) from S7
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.088030)
[S5] loaded HEAD from S7 (vec_in norm=1.088030)
[S5] cosine check vs S7: cos=0.7411
[S5] BUFFERED delta from S7 (total buffered=3)
[S17] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:51917
[S16] RECEIVED delta(kind=head bytes=1805) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.995200)
[S16] loaded HEAD from S17 (vec_in norm=0.995200)
[S16] cosine check vs S17: cos=0.8967
[S16] BUFFERED delta from S17 (total buffered=1)
[S2] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.958414)
[S17] loaded HEAD from S2 (vec_in norm=0.958414)
[S17] cosine check vs S2: cos=0.6720
[S17] BUFFERED delta from S2 (total buffered=2)
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7146 head_norm=0.719519
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.837616e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7149 head_norm=0.682294 delta_norm=0.183762
[S5] aggregate: ACCEPT kept=['S13', 'S15', 'S7'] (k=3/3) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6435 head_norm=0.759607
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.491892e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6308 head_norm=0.701329 delta_norm=0.149189
[S13] aggregate: ROLLBACK (f1_val pre=0.643 post=0.631 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.6955 head_norm=1.120759
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.377937e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6953 head_norm=1.161397 delta_norm=0.137794
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.7146 head_norm=1.088030
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.258464e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.6092 head_norm=1.323685 delta_norm=0.325846
[S7] aggregate: ROLLBACK (f1_val pre=0.715 post=0.609 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.6624 head_norm=0.671742
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.892227e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.6432 head_norm=0.731816 delta_norm=0.189223
[S11] aggregate: ROLLBACK (f1_val pre=0.662 post=0.643 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.7101 head_norm=1.216372
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.687263e-02
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.7073 head_norm=1.237191 delta_norm=0.096873
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.3568 head_norm=0.946608
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.219321e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.3776 head_norm=0.945511 delta_norm=0.221932
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3477 head_norm=0.995200
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.646346e-02
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3465 head_norm=1.005668 delta_norm=0.096463
[S17] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=0.958414 cos_to_last_merge=0.8354 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.835
[S2] round=12 local utility u=0.182359 metrics={'f1_val': 0.700670614627973, 'auprc': 0.7772062763515829, 'loss_val': 0.5595062970495447, 'psi': 0.7312848793174169}-{'f1_val': 0.6998101921290396, 'auprc': 0.6924610731161503, 'loss_val': 0.6648269888314661, 'psi': 0.6968705445238839}
[S3] START round=12 head_norm_before_train=1.201938 cos_to_last_merge=0.8666 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.867
[S3] round=12 local utility u=0.815211 metrics={'f1_val': 0.6423099435964327, 'auprc': 0.9926129238091306, 'loss_val': 0.45925148152088036, 'psi': 0.7824311356815119}-{'f1_val': 0.48067078677718245, 'auprc': 0.8518032911909293, 'loss_val': 0.6974094884982411, 'psi': 0.6291237885426813}
[S4] START round=12 head_norm_before_train=1.336642 cos_to_last_merge=0.8780 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.878
[S4] round=12 local utility u=0.007471 metrics={'f1_val': 0.6690241408000799, 'auprc': 0.6554205383172536, 'loss_val': 0.48221038559588325, 'psi': 0.6635826998069494}-{'f1_val': 0.6682580775020678, 'auprc': 0.6542391443436424, 'loss_val': 0.48901235016790345, 'psi': 0.6626505042386976}
[S5] START round=12 head_norm_before_train=0.682294 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.032661 metrics={'f1_val': 0.7144008589453258, 'auprc': 0.7744073498517912, 'loss_val': 0.8729345312141835, 'psi': 0.738403455307912}-{'f1_val': 0.7146275168069246, 'auprc': 0.7729016954279401, 'loss_val': 0.9350989267938035, 'psi': 0.7379371882553307}
[S6] START round=12 head_norm_before_train=1.237191 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.7099929224303602, 'auprc': 0.7859259655432822, 'loss_val': 0.5584992197298955, 'psi': 0.740366139675529}-{'f1_val': 0.7100985646784144, 'auprc': 0.9586372866407494, 'loss_val': 0.518504530147099, 'psi': 0.8095140534633484}
[S7] START round=12 head_norm_before_train=1.323685 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.6639340184906971, 'auprc': 0.7942113932413231, 'loss_val': 0.7536297144229677, 'psi': 0.7160449683909476}-{'f1_val': 0.7145938979314673, 'auprc': 0.7948157121463827, 'loss_val': 0.9331578658212142, 'psi': 0.7466826236174335}
[S8] START round=12 head_norm_before_train=1.583622 (no previous merge yet)
[S8] round=12 local utility u=0.908544 metrics={'f1_val': 0.9961297039822733, 'auprc': 0.9975975036893148, 'loss_val': 0.1496757741835903, 'psi': 0.9967168238650899}-{'f1_val': 0.7141738056351523, 'auprc': 0.9935669126956139, 'loss_val': 0.2629357287469596, 'psi': 0.825931048459337}
[S9] START round=12 head_norm_before_train=1.598488 (no previous merge yet)
[S9] round=12 local utility u=0.021703 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981042512701402, 'loss_val': 0.19235686521462003, 'psi': 0.8199716489720672}-{'f1_val': 0.7014667606303384, 'auprc': 0.9981636675413841, 'loss_val': 0.2374429585858804, 'psi': 0.8201455233947567}
[S10] START round=12 head_norm_before_train=1.265106 cos_to_last_merge=0.9120 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.912
[S10] round=12 local utility u=0.048333 metrics={'f1_val': 0.700942136646399, 'auprc': 0.9910699004824356, 'loss_val': 0.32835432491600075, 'psi': 0.8169932421808137}-{'f1_val': 0.6929227949900373, 'auprc': 0.9961132520035131, 'loss_val': 0.3920335065351574, 'psi': 0.8141989777954277}
[S11] START round=12 head_norm_before_train=0.731816 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.005061 metrics={'f1_val': 0.6630132620594786, 'auprc': 0.716218301574017, 'loss_val': 0.675895821803273, 'psi': 0.684295277865294}-{'f1_val': 0.6624450655612856, 'auprc': 0.7685657434409655, 'loss_val': 0.8396508226829168, 'psi': 0.7048933367131576}
[S13] START round=12 head_norm_before_train=0.701329 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.566831204394953, 'auprc': 0.6812917488543776, 'loss_val': 0.9458630657845987, 'psi': 0.6126154221787229}-{'f1_val': 0.6434898691508725, 'auprc': 0.7083488190229815, 'loss_val': 0.9442152704380686, 'psi': 0.669433449099716}
[S14] START round=12 head_norm_before_train=1.591486 (no previous merge yet)
[S14] round=12 local utility u=0.073388 metrics={'f1_val': 0.9982568154177985, 'auprc': 0.9995116322270505, 'loss_val': 0.16223657351322213, 'psi': 0.9987587421414993}-{'f1_val': 0.985898569733431, 'auprc': 0.9999908023958329, 'loss_val': 0.23630125208770006, 'psi': 0.9915354627983919}
[S15] START round=12 head_norm_before_train=1.161397 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.002704 metrics={'f1_val': 0.6955011552364081, 'auprc': 0.7983880172480814, 'loss_val': 0.5795088721538366, 'psi': 0.7366559000410775}-{'f1_val': 0.6955193961550213, 'auprc': 0.8183287654751725, 'loss_val': 0.6448484919902734, 'psi': 0.7446431438830818}
[S16] START round=12 head_norm_before_train=0.945511 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.127594 metrics={'f1_val': 0.39519679342867353, 'auprc': 0.7394839686784862, 'loss_val': 1.0035904726831388, 'psi': 0.5329116635285986}-{'f1_val': 0.3567962009228187, 'auprc': 0.7305374133288145, 'loss_val': 1.0015351914454258, 'psi': 0.506292685885217}
[S17] START round=12 head_norm_before_train=1.005668 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.051652 metrics={'f1_val': 0.3521865396846887, 'auprc': 0.48912010685219476, 'loss_val': 0.8997237093673744, 'psi': 0.40695996655169114}-{'f1_val': 0.34766836419108466, 'auprc': 0.48166763066558765, 'loss_val': 0.9535609406287512, 'psi': 0.4012680707808859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:51907
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:51917
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:51916
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.255942)
[S9] loaded HEAD from S3 (vec_in norm=1.255942)
[S9] cosine check vs S3: cos=-0.0196
[S9] DROPPED delta from S3 (cos=-0.0196 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.718530)
[S11] loaded HEAD from S5 (vec_in norm=0.718530)
[S11] cosine check vs S5: cos=0.8218
[S11] BUFFERED delta from S5 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.199812)
[S5] loaded HEAD from S15 (vec_in norm=1.199812)
[S5] cosine check vs S15: cos=0.7488
[S5] BUFFERED delta from S15 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.783060)
[S13] loaded HEAD from S11 (vec_in norm=0.783060)
[S13] cosine check vs S11: cos=0.9531
[S13] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.373403)
[S11] loaded HEAD from S4 (vec_in norm=1.373403)
[S11] cosine check vs S4: cos=0.8227
[S11] BUFFERED delta from S4 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.620602)
[S17] loaded HEAD from S8 (vec_in norm=1.620602)
[S17] cosine check vs S8: cos=0.8703
[S17] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.639498)
[S7] loaded HEAD from S14 (vec_in norm=1.639498)
[S7] cosine check vs S14: cos=0.9877
[S7] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.639662)
[S2] loaded HEAD from S9 (vec_in norm=1.639662)
[S2] cosine check vs S9: cos=-0.0160
[S2] DROPPED delta from S9 (cos=-0.0160 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.017337)
[S17] loaded HEAD from S2 (vec_in norm=1.017337)
[S17] cosine check vs S2: cos=0.6637
[S17] BUFFERED delta from S2 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1797) from S10
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.320310)
[S6] loaded HEAD from S10 (vec_in norm=1.320310)
[S6] cosine check vs S10: cos=0.9888
[S6] BUFFERED delta from S10 (total buffered=1)
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.038634)
[S16] loaded HEAD from S17 (vec_in norm=1.038634)
[S16] cosine check vs S17: cos=0.9552
[S16] BUFFERED delta from S17 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:51908
[S16] sending update (kind=head size=1789 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1789) from S16
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.983005)
[S7] loaded HEAD from S16 (vec_in norm=0.983005)
[S7] cosine check vs S16: cos=0.1957
[S7] BUFFERED delta from S16 (total buffered=2)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.5668 head_norm=0.739180
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.185279e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.5763 head_norm=0.752154 delta_norm=0.118528
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.7100 head_norm=1.277657
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.937839e-02
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.7100 head_norm=1.295352 delta_norm=0.099378
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.6639 head_norm=1.350962
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.949383e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.7020 head_norm=1.144877 delta_norm=0.294938
[S7] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7144 head_norm=0.718530
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.076393e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7141 head_norm=0.900970 delta_norm=0.407639
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.6630 head_norm=0.783060
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.359315e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.6850 head_norm=0.831898 delta_norm=0.135931
[S11] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3522 head_norm=1.038634
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.038801e-02
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3522 head_norm=1.044643 delta_norm=0.090388
[S17] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.3952 head_norm=0.983005
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.536911e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4184 head_norm=0.999454 delta_norm=0.153691
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.017337 cos_to_last_merge=0.8187 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.819
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.699329985880033, 'auprc': 0.6707262141546021, 'loss_val': 0.4876534828527991, 'psi': 0.6878884771898606}-{'f1_val': 0.700670614627973, 'auprc': 0.7772062763515829, 'loss_val': 0.5595062970495447, 'psi': 0.7312848793174169}
[S3] START round=13 head_norm_before_train=1.255942 cos_to_last_merge=0.8537 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.854
[S3] round=13 local utility u=0.192035 metrics={'f1_val': 0.6914732575663634, 'auprc': 0.9943759897131448, 'loss_val': 0.3754504515806224, 'psi': 0.8126343504250759}-{'f1_val': 0.6423099435964327, 'auprc': 0.9926129238091306, 'loss_val': 0.45925148152088036, 'psi': 0.7824311356815119}
[S4] START round=13 head_norm_before_train=1.373403 cos_to_last_merge=0.8696 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.870
[S4] round=13 local utility u=0.007166 metrics={'f1_val': 0.6690241408000799, 'auprc': 0.6587244851305329, 'loss_val': 0.4777894252507193, 'psi': 0.6649042785322611}-{'f1_val': 0.6690241408000799, 'auprc': 0.6554205383172536, 'loss_val': 0.48221038559588325, 'psi': 0.6635826998069494}
[S5] START round=13 head_norm_before_train=0.900970 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.6600242052239804, 'loss_val': 0.743655676479902, 'psi': 0.6843511751957505}-{'f1_val': 0.7144008589453258, 'auprc': 0.7744073498517912, 'loss_val': 0.8729345312141835, 'psi': 0.738403455307912}
[S6] START round=13 head_norm_before_train=1.295352 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.343123 metrics={'f1_val': 0.7109039155096886, 'auprc': 0.9594465555474256, 'loss_val': 0.39828182471760304, 'psi': 0.8103209715247834}-{'f1_val': 0.7099929224303602, 'auprc': 0.7859259655432822, 'loss_val': 0.5584992197298955, 'psi': 0.740366139675529}
[S7] START round=13 head_norm_before_train=1.144877 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.5605168029571647, 'auprc': 0.79217332327421, 'loss_val': 0.8303517818873558, 'psi': 0.6531794110839828}-{'f1_val': 0.6639340184906971, 'auprc': 0.7942113932413231, 'loss_val': 0.7536297144229677, 'psi': 0.7160449683909476}
[S8] START round=13 head_norm_before_train=1.620602 (no previous merge yet)
[S8] round=13 local utility u=0.009525 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9959966705178371, 'loss_val': 0.12716263259057053, 'psi': 0.9962105131685096}-{'f1_val': 0.9961297039822733, 'auprc': 0.9975975036893148, 'loss_val': 0.1496757741835903, 'psi': 0.9967168238650899}
[S9] START round=13 head_norm_before_train=1.639662 (no previous merge yet)
[S9] round=13 local utility u=0.871795 metrics={'f1_val': 0.9839631998905876, 'auprc': 0.9980960142798015, 'loss_val': 0.14522153524296685, 'psi': 0.9896163256462731}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981042512701402, 'loss_val': 0.19235686521462003, 'psi': 0.8199716489720672}
[S10] START round=13 head_norm_before_train=1.320310 cos_to_last_merge=0.8992 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.899
[S10] round=13 local utility u=0.007056 metrics={'f1_val': 0.6954084965803329, 'auprc': 0.9958282687213196, 'loss_val': 0.2953155679996929, 'psi': 0.8155764054367276}-{'f1_val': 0.700942136646399, 'auprc': 0.9910699004824356, 'loss_val': 0.32835432491600075, 'psi': 0.8169932421808137}
[S11] START round=13 head_norm_before_train=0.831898 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.102605 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.6743620895147686, 'loss_val': 0.5786490096387945, 'psi': 0.6909060257848996}-{'f1_val': 0.6630132620594786, 'auprc': 0.716218301574017, 'loss_val': 0.675895821803273, 'psi': 0.684295277865294}
[S13] START round=13 head_norm_before_train=0.752154 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.479100 metrics={'f1_val': 0.696538052514867, 'auprc': 0.7152978775801886, 'loss_val': 0.8679225462812189, 'psi': 0.7040419825409956}-{'f1_val': 0.566831204394953, 'auprc': 0.6812917488543776, 'loss_val': 0.9458630657845987, 'psi': 0.6126154221787229}
[S14] START round=13 head_norm_before_train=1.639498 (no previous merge yet)
[S14] round=13 local utility u=0.011734 metrics={'f1_val': 0.9976786118698733, 'auprc': 0.9994429579196842, 'loss_val': 0.135093239913076, 'psi': 0.9983843502897977}-{'f1_val': 0.9982568154177985, 'auprc': 0.9995116322270505, 'loss_val': 0.16223657351322213, 'psi': 0.9987587421414993}
[S15] START round=13 head_norm_before_train=1.199812 cos_to_last_merge=0.9970 (last merge round=11)
[S15] round=13 local utility u=0.229891 metrics={'f1_val': 0.694758680405853, 'auprc': 0.9076303316818057, 'loss_val': 0.44299952194892644, 'psi': 0.779907340916234}-{'f1_val': 0.6955011552364081, 'auprc': 0.7983880172480814, 'loss_val': 0.5795088721538366, 'psi': 0.7366559000410775}
[S16] START round=13 head_norm_before_train=0.999454 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.214394 metrics={'f1_val': 0.45282034471836896, 'auprc': 0.7467436549932532, 'loss_val': 0.9423234657333671, 'psi': 0.5703896688283226}-{'f1_val': 0.39519679342867353, 'auprc': 0.7394839686784862, 'loss_val': 1.0035904726831388, 'psi': 0.5329116635285986}
[S17] START round=13 head_norm_before_train=1.044643 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.063858 metrics={'f1_val': 0.35370270086924227, 'auprc': 0.5197825714074511, 'loss_val': 0.8730916420032548, 'psi': 0.4201346490845258}-{'f1_val': 0.3521865396846887, 'auprc': 0.48912010685219476, 'loss_val': 0.8997237093673744, 'psi': 0.40695996655169114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:51903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:51907
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] sending update (kind=head size=1790 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:51911
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:51909
[S16] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.241767)
[S6] loaded HEAD from S15 (vec_in norm=1.241767)
[S6] cosine check vs S15: cos=0.9690
[S6] BUFFERED delta from S15 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1793) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.880941)
[S5] loaded HEAD from S11 (vec_in norm=0.880941)
[S5] cosine check vs S11: cos=0.7305
[S5] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.784378)
[S11] loaded HEAD from S13 (vec_in norm=0.784378)
[S11] cosine check vs S13: cos=0.9595
[S11] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1791) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.035481)
[S17] loaded HEAD from S16 (vec_in norm=1.035481)
[S17] cosine check vs S16: cos=0.9755
[S17] BUFFERED delta from S16 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.675441)
[S3] loaded HEAD from S9 (vec_in norm=1.675441)
[S3] cosine check vs S9: cos=-0.0234
[S3] DROPPED delta from S9 (cos=-0.0234 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S6
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.321381)
[S10] loaded HEAD from S6 (vec_in norm=1.321381)
[S10] cosine check vs S6: cos=0.9913
[S10] BUFFERED delta from S6 (total buffered=1)
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.078230)
[S8] loaded HEAD from S17 (vec_in norm=1.078230)
[S8] cosine check vs S17: cos=0.8717
[S8] BUFFERED delta from S17 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7006 head_norm=0.933252
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.338436e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7006 head_norm=0.843835 delta_norm=0.333844
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6954 head_norm=1.365486
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.123063e-02
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.6957 head_norm=1.340513 delta_norm=0.091231
[S10] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7019 head_norm=0.880941
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.277039e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7019 head_norm=0.824224 delta_norm=0.127704
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.7109 head_norm=1.321381
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.643310e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.7111 head_norm=1.271618 delta_norm=0.164331
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9964 head_norm=1.652924
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.437226e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.9952 head_norm=1.323056 delta_norm=0.443723
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3537 head_norm=1.078230
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.188155e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3537 head_norm=1.050373 delta_norm=0.118816
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.074424 cos_to_last_merge=0.8041 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.804
[S2] round=14 local utility u=0.044282 metrics={'f1_val': 0.6999488443093624, 'auprc': 0.6652917722286751, 'loss_val': 0.38649910578083163, 'psi': 0.6860860154770875}-{'f1_val': 0.699329985880033, 'auprc': 0.6707262141546021, 'loss_val': 0.4876534828527991, 'psi': 0.6878884771898606}
[S3] START round=14 head_norm_before_train=1.305203 cos_to_last_merge=0.8428 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.843
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.5924380730928738, 'auprc': 0.9410741615635941, 'loss_val': 0.5142982958486801, 'psi': 0.7318925084811619}-{'f1_val': 0.6914732575663634, 'auprc': 0.9943759897131448, 'loss_val': 0.3754504515806224, 'psi': 0.8126343504250759}
[S4] START round=14 head_norm_before_train=1.400253 cos_to_last_merge=0.8641 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.864
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.6683347397982934, 'auprc': 0.658107081582631, 'loss_val': 0.4723097608546739, 'psi': 0.6642436765120284}-{'f1_val': 0.6690241408000799, 'auprc': 0.6587244851305329, 'loss_val': 0.4777894252507193, 'psi': 0.6649042785322611}
[S5] START round=14 head_norm_before_train=0.843835 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.191099 metrics={'f1_val': 0.7010989697974662, 'auprc': 0.7742632829955463, 'loss_val': 0.7073540985225841, 'psi': 0.7303646950766982}-{'f1_val': 0.7005691551769304, 'auprc': 0.6600242052239804, 'loss_val': 0.743655676479902, 'psi': 0.6843511751957505}
[S6] START round=14 head_norm_before_train=1.271618 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.7103954876629905, 'auprc': 0.9556558713513056, 'loss_val': 0.39060309704466034, 'psi': 0.8084996411383165}-{'f1_val': 0.7109039155096886, 'auprc': 0.9594465555474256, 'loss_val': 0.39828182471760304, 'psi': 0.8103209715247834}
[S7] START round=14 head_norm_before_train=1.175282 cos_to_last_merge=0.9987 (last merge round=12)
[S7] round=14 local utility u=0.584022 metrics={'f1_val': 0.7142975413573194, 'auprc': 0.7948102155701144, 'loss_val': 0.5929030136312688, 'psi': 0.7465026110424374}-{'f1_val': 0.5605168029571647, 'auprc': 0.79217332327421, 'loss_val': 0.8303517818873558, 'psi': 0.6531794110839828}
[S8] START round=14 head_norm_before_train=1.323056 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9992732890463915, 'loss_val': 0.19632549512196268, 'psi': 0.828252778857254}-{'f1_val': 0.9963530749356245, 'auprc': 0.9959966705178371, 'loss_val': 0.12716263259057053, 'psi': 0.9962105131685096}
[S9] START round=14 head_norm_before_train=1.675441 (no previous merge yet)
[S9] round=14 local utility u=0.032420 metrics={'f1_val': 0.9886727075027679, 'auprc': 0.9984658046925132, 'loss_val': 0.10974733398501901, 'psi': 0.992589946378666}-{'f1_val': 0.9839631998905876, 'auprc': 0.9980960142798015, 'loss_val': 0.14522153524296685, 'psi': 0.9896163256462731}
[S10] START round=14 head_norm_before_train=1.340513 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.036880 metrics={'f1_val': 0.7007673032853614, 'auprc': 0.9951117047272087, 'loss_val': 0.25155821553554925, 'psi': 0.8185050638621003}-{'f1_val': 0.6954084965803329, 'auprc': 0.9958282687213196, 'loss_val': 0.2953155679996929, 'psi': 0.8155764054367276}
[S11] START round=14 head_norm_before_train=0.824224 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.043000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.6687112540527165, 'loss_val': 0.47569637121576236, 'psi': 0.6886456916000787}-{'f1_val': 0.7019353166316534, 'auprc': 0.6743620895147686, 'loss_val': 0.5786490096387945, 'psi': 0.6909060257848996}
[S13] START round=14 head_norm_before_train=0.784378 cos_to_last_merge=0.9956 (last merge round=12)
[S13] round=14 local utility u=0.094273 metrics={'f1_val': 0.7091683273695742, 'auprc': 0.7112744109333468, 'loss_val': 0.7430879382846491, 'psi': 0.7100107607950832}-{'f1_val': 0.696538052514867, 'auprc': 0.7152978775801886, 'loss_val': 0.8679225462812189, 'psi': 0.7040419825409956}
[S14] START round=14 head_norm_before_train=1.687762 (no previous merge yet)
[S14] round=14 local utility u=0.018164 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9990065350941435, 'loss_val': 0.09831537347912143, 'psi': 0.9982956696503128}-{'f1_val': 0.9976786118698733, 'auprc': 0.9994429579196842, 'loss_val': 0.135093239913076, 'psi': 0.9983843502897977}
[S15] START round=14 head_norm_before_train=1.241767 cos_to_last_merge=0.9909 (last merge round=11)
[S15] round=14 local utility u=0.082097 metrics={'f1_val': 0.7076650657256487, 'auprc': 0.9155602593514174, 'loss_val': 0.3800335718858361, 'psi': 0.7908231431759561}-{'f1_val': 0.694758680405853, 'auprc': 0.9076303316818057, 'loss_val': 0.44299952194892644, 'psi': 0.779907340916234}
[S16] START round=14 head_norm_before_train=1.035481 cos_to_last_merge=0.9974 (last merge round=12)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.43559748902498663, 'auprc': 0.7259736636102603, 'loss_val': 0.9176456245587528, 'psi': 0.5517479588590961}-{'f1_val': 0.45282034471836896, 'auprc': 0.7467436549932532, 'loss_val': 0.9423234657333671, 'psi': 0.5703896688283226}
[S17] START round=14 head_norm_before_train=1.050373 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.038750 metrics={'f1_val': 0.35243068609022554, 'auprc': 0.551594618848601, 'loss_val': 0.883395016570874, 'psi': 0.4320962591935757}-{'f1_val': 0.35370270086924227, 'auprc': 0.5197825714074511, 'loss_val': 0.8730916420032548, 'psi': 0.4201346490845258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:51903
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:51907
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:51912
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:51914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:51909
[S2] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.875191)
[S15] loaded HEAD from S5 (vec_in norm=0.875191)
[S15] cosine check vs S5: cos=0.8518
[S15] BUFFERED delta from S5 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1790) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.880382)
[S5] loaded HEAD from S11 (vec_in norm=0.880382)
[S5] cosine check vs S11: cos=0.9149
[S5] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.203202)
[S14] loaded HEAD from S7 (vec_in norm=1.203202)
[S14] cosine check vs S7: cos=0.9446
[S14] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.131983)
[S9] loaded HEAD from S2 (vec_in norm=1.131983)
[S9] cosine check vs S2: cos=-0.0147
[S9] DROPPED delta from S2 (cos=-0.0147 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.827185)
[S11] loaded HEAD from S13 (vec_in norm=0.827185)
[S11] cosine check vs S13: cos=0.9688
[S11] BUFFERED delta from S13 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.281154)
[S6] loaded HEAD from S15 (vec_in norm=1.281154)
[S6] cosine check vs S15: cos=0.9854
[S6] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.708688)
[S3] loaded HEAD from S9 (vec_in norm=1.708688)
[S3] cosine check vs S9: cos=-0.0277
[S3] DROPPED delta from S9 (cos=-0.0277 < 0.0)
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.081961)
[S8] loaded HEAD from S17 (vec_in norm=1.081961)
[S8] cosine check vs S17: cos=0.9325
[S8] BUFFERED delta from S17 (total buffered=1)
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S9]  timeout peer S2
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S14
[S5]  timeout peer S16
[S5]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.7142 head_norm=1.358787
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.623009e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.7142 head_norm=1.199862 delta_norm=0.262301
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.7104 head_norm=1.298647
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.103875e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.7106 head_norm=1.285198 delta_norm=0.110387
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9978 head_norm=1.727834
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.555794e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9978 head_norm=1.445723 delta_norm=0.355579
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7011 head_norm=0.875191
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.810521e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7014 head_norm=0.858916 delta_norm=0.181052
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7019 head_norm=0.880382
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.098285e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7019 head_norm=0.847108 delta_norm=0.109828
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.7077 head_norm=1.281154
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.525229e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6944 head_norm=1.038935 delta_norm=0.352523
[S15] aggregate: ROLLBACK (f1_val pre=0.708 post=0.694 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.131983 cos_to_last_merge=0.7890 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.789
[S2] round=15 local utility u=0.026211 metrics={'f1_val': 0.7010299569678582, 'auprc': 0.6664666439066242, 'loss_val': 0.34408828227112837, 'psi': 0.6872046317433647}-{'f1_val': 0.6999488443093624, 'auprc': 0.6652917722286751, 'loss_val': 0.38649910578083163, 'psi': 0.6860860154770875}
[S3] START round=15 head_norm_before_train=1.344629 cos_to_last_merge=0.8326 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.833
[S3] round=15 local utility u=0.420753 metrics={'f1_val': 0.680577724024187, 'auprc': 0.9919782756637118, 'loss_val': 0.3543426229945247, 'psi': 0.8051379446799969}-{'f1_val': 0.5924380730928738, 'auprc': 0.9410741615635941, 'loss_val': 0.5142982958486801, 'psi': 0.7318925084811619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=15 head_norm_before_train=1.421089 cos_to_last_merge=0.8600 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.860
[S4] round=15 local utility u=0.000371 metrics={'f1_val': 0.6688953401211517, 'auprc': 0.659387758303643, 'loss_val': 0.4787726670312617, 'psi': 0.6650923073941483}-{'f1_val': 0.6683347397982934, 'auprc': 0.658107081582631, 'loss_val': 0.4723097608546739, 'psi': 0.6642436765120284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=15 head_norm_before_train=0.858916 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.6612884712423978, 'loss_val': 0.634011916779818, 'psi': 0.6848568816031173}-{'f1_val': 0.7010989697974662, 'auprc': 0.7742632829955463, 'loss_val': 0.7073540985225841, 'psi': 0.7303646950766982}
[S6] START round=15 head_norm_before_train=1.285198 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.7096997707708622, 'auprc': 0.817435778594783, 'loss_val': 0.4341845181697514, 'psi': 0.7527941739004305}-{'f1_val': 0.7103954876629905, 'auprc': 0.9556558713513056, 'loss_val': 0.39060309704466034, 'psi': 0.8084996411383165}
[S7] START round=15 head_norm_before_train=1.203202 cos_to_last_merge=0.9961 (last merge round=12)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.5964629511658175, 'auprc': 0.7934088265127829, 'loss_val': 0.7281498306204358, 'psi': 0.6752413013046037}-{'f1_val': 0.7142975413573194, 'auprc': 0.7948102155701144, 'loss_val': 0.5929030136312688, 'psi': 0.7465026110424374}
[S8] START round=15 head_norm_before_train=1.199862 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.839547 metrics={'f1_val': 0.9925351415090421, 'auprc': 0.9991032357604873, 'loss_val': 0.18649848470512873, 'psi': 0.9951623792096201}-{'f1_val': 0.7142391053978291, 'auprc': 0.9992732890463915, 'loss_val': 0.19632549512196268, 'psi': 0.828252778857254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=15 head_norm_before_train=1.708688 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.9861123006036613, 'auprc': 0.998250663587053, 'loss_val': 0.09777875377260943, 'psi': 0.990967645797018}-{'f1_val': 0.9886727075027679, 'auprc': 0.9984658046925132, 'loss_val': 0.10974733398501901, 'psi': 0.992589946378666}
[S10] START round=15 head_norm_before_train=1.372965 cos_to_last_merge=0.9994 (last merge round=13)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.6795586091596495, 'auprc': 0.9804535261928243, 'loss_val': 0.2611421943666066, 'psi': 0.7999165759729194}-{'f1_val': 0.7007673032853614, 'auprc': 0.9951117047272087, 'loss_val': 0.25155821553554925, 'psi': 0.8185050638621003}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=15 head_norm_before_train=0.847108 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.010707 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.6626576056602358, 'loss_val': 0.4361223420946364, 'psi': 0.6862242322430864}-{'f1_val': 0.7019353166316534, 'auprc': 0.6687112540527165, 'loss_val': 0.47569637121576236, 'psi': 0.6886456916000787}
[S13] START round=15 head_norm_before_train=0.827185 cos_to_last_merge=0.9829 (last merge round=12)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6123953342651963, 'auprc': 0.6985373936052706, 'loss_val': 0.7541540338931305, 'psi': 0.6468521580012261}-{'f1_val': 0.7091683273695742, 'auprc': 0.7112744109333468, 'loss_val': 0.7430879382846491, 'psi': 0.7100107607950832}
[S14] START round=15 head_norm_before_train=1.445723 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.9972131247180673, 'auprc': 0.9993670891040256, 'loss_val': 0.12231006900813512, 'psi': 0.9980747104724507}-{'f1_val': 0.9978217593544257, 'auprc': 0.9990065350941435, 'loss_val': 0.09831537347912143, 'psi': 0.9982956696503128}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=15 head_norm_before_train=1.038935 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6942990716990598, 'auprc': 0.8377427135848723, 'loss_val': 0.42886575277159134, 'psi': 0.7516765284533848}-{'f1_val': 0.7076650657256487, 'auprc': 0.9155602593514174, 'loss_val': 0.3800335718858361, 'psi': 0.7908231431759561}
[S16] START round=15 head_norm_before_train=1.074949 cos_to_last_merge=0.9915 (last merge round=12)
[S16] round=15 local utility u=1.000000 metrics={'f1_val': 0.8175908418477029, 'auprc': 0.7752415012331719, 'loss_val': 0.8076325315671077, 'psi': 0.8006511056018906}-{'f1_val': 0.43559748902498663, 'auprc': 0.7259736636102603, 'loss_val': 0.9176456245587528, 'psi': 0.5517479588590961}
[S17] START round=15 head_norm_before_train=1.081961 cos_to_last_merge=0.9986 (last merge round=13)
[S17] round=15 local utility u=0.109570 metrics={'f1_val': 0.3508060290264653, 'auprc': 0.6422621594792541, 'loss_val': 0.926509853559703, 'psi': 0.46738848120758086}-{'f1_val': 0.35243068609022554, 'auprc': 0.551594618848601, 'loss_val': 0.883395016570874, 'psi': 0.4320962591935757}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:51910
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:51917
[S2] sending update (kind=head size=1795 to 1 peers)
[S15] ⇄ pheromone p=0.186 → S6@127.0.0.1:51907
[S13] ⇄ pheromone p=0.230 → S11@127.0.0.1:51912
[S6] ⇄ pheromone p=0.211 → S10@127.0.0.1:51911
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.249 → S3@127.0.0.1:51903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:51909
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.112584)
[S17] loaded HEAD from S16 (vec_in norm=1.112584)
[S17] cosine check vs S16: cos=0.9739
[S17] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1795) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.187066)
[S9] loaded HEAD from S2 (vec_in norm=1.187066)
[S9] cosine check vs S2: cos=-0.0163
[S9] DROPPED delta from S2 (cos=-0.0163 < 0.0)
[S11] sending update (kind=head size=1795 to 1 peers)
[S16] ⇄ pheromone p=0.326 → S17@127.0.0.1:51917
[S2] ⇄ pheromone p=0.160 → S9@127.0.0.1:51910
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.898153)
[S5] loaded HEAD from S11 (vec_in norm=0.898153)
[S5] cosine check vs S11: cos=0.9643
[S5] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.108499)
[S8] loaded HEAD from S17 (vec_in norm=1.108499)
[S8] cosine check vs S17: cos=0.9705
[S8] BUFFERED delta from S17 (total buffered=1)
[S11] ⇄ pheromone p=0.184 → S5@127.0.0.1:51905
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3508 head_norm=1.108499
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.268196e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3507 head_norm=1.103278 delta_norm=0.126820
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.124 → S8@127.0.0.1:51909
[S5] RoundReady barrier timeout: have=1 need=2 — continuing
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] CommDone barrier timeout: have=0 need=1 — continuing
[S15]  timeout peer S6
[S17]  timeout peer S2
[S17]  timeout peer S8
[S6]  timeout peer S10
[S11]  timeout peer S4
[S11]  timeout peer S5
[S2]  timeout peer S9
[S7]  timeout peer S14
[S7]  timeout peer S16
[S13]  timeout peer S11
[S9]  timeout peer S3
[S5]  timeout peer S7
[S5]  timeout peer S13
[S5]  timeout peer S15
[S16]  timeout peer S17
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7006 head_norm=0.887213
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.193881e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7006 head_norm=0.884680 delta_norm=0.119388
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=16 head_norm_before_train=1.187066 cos_to_last_merge=0.7760 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.776
[S2] round=16 local utility u=0.032023 metrics={'f1_val': 0.7015681696058681, 'auprc': 0.6803153441802516, 'loss_val': 0.32481855951420174, 'psi': 0.6930670394356215}-{'f1_val': 0.7010299569678582, 'auprc': 0.6664666439066242, 'loss_val': 0.34408828227112837, 'psi': 0.6872046317433647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=16 head_norm_before_train=1.378681 cos_to_last_merge=0.8234 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.823
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.5717870072756802, 'auprc': 0.8945995689384654, 'loss_val': 0.5528766463947168, 'psi': 0.7009120319407943}-{'f1_val': 0.680577724024187, 'auprc': 0.9919782756637118, 'loss_val': 0.3543426229945247, 'psi': 0.8051379446799969}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=16 head_norm_before_train=1.440345 cos_to_last_merge=0.8572 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.857
[S4] round=16 local utility u=0.271329 metrics={'f1_val': 0.6686782860724569, 'auprc': 0.8409387887554999, 'loss_val': 0.47946516276096457, 'psi': 0.7375824871456741}-{'f1_val': 0.6688953401211517, 'auprc': 0.659387758303643, 'loss_val': 0.4787726670312617, 'psi': 0.6650923073941483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=16 head_norm_before_train=0.884680 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.189937 metrics={'f1_val': 0.714400588689728, 'auprc': 0.7751657786601112, 'loss_val': 0.6787585311014759, 'psi': 0.7387066646778813}-{'f1_val': 0.7005691551769304, 'auprc': 0.6612884712423978, 'loss_val': 0.634011916779818, 'psi': 0.6848568816031173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=16 head_norm_before_train=1.310386 cos_to_last_merge=0.9993 (last merge round=14)
[S6] round=16 local utility u=0.276841 metrics={'f1_val': 0.7103678605477248, 'auprc': 0.9623632420691646, 'loss_val': 0.31929245847862303, 'psi': 0.8111660131563008}-{'f1_val': 0.7096997707708622, 'auprc': 0.817435778594783, 'loss_val': 0.4341845181697514, 'psi': 0.7527941739004305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=16 head_norm_before_train=1.228298 cos_to_last_merge=0.9933 (last merge round=12)
[S7] round=16 local utility u=0.058541 metrics={'f1_val': 0.6075928982159159, 'auprc': 0.7954404771813612, 'loss_val': 0.6839421222369898, 'psi': 0.682731929802094}-{'f1_val': 0.5964629511658175, 'auprc': 0.7934088265127829, 'loss_val': 0.7281498306204358, 'psi': 0.6752413013046037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=16 head_norm_before_train=1.243641 cos_to_last_merge=0.9993 (last merge round=14)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9981121817568122, 'loss_val': 0.20467656472196882, 'psi': 0.8277883359414224}-{'f1_val': 0.9925351415090421, 'auprc': 0.9991032357604873, 'loss_val': 0.18649848470512873, 'psi': 0.9951623792096201}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.7142 head_norm=1.295214
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.838825e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.7142 head_norm=1.191370 delta_norm=0.183883
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] START round=16 head_norm_before_train=1.741526 (no previous merge yet)
[S9] round=16 local utility u=0.047897 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9967982642410058, 'loss_val': 0.060916020360851295, 'psi': 0.9967156127847372}-{'f1_val': 0.9861123006036613, 'auprc': 0.998250663587053, 'loss_val': 0.09777875377260943, 'psi': 0.990967645797018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] sending update (kind=head size=1807 to 1 peers)
[S10] START round=16 head_norm_before_train=1.397392 cos_to_last_merge=0.9980 (last merge round=13)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.6621993493431793, 'auprc': 0.9738549440534255, 'loss_val': 0.29589919551938687, 'psi': 0.7868615872272777}-{'f1_val': 0.6795586091596495, 'auprc': 0.9804535261928243, 'loss_val': 0.2611421943666066, 'psi': 0.7999165759729194}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=16 head_norm_before_train=0.898153 cos_to_last_merge=0.9980 (last merge round=14)
[S11] round=16 local utility u=0.021954 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.6625176498310247, 'loss_val': 0.3917942940090024, 'psi': 0.6861682499114019}-{'f1_val': 0.7019353166316534, 'auprc': 0.6626576056602358, 'loss_val': 0.4361223420946364, 'psi': 0.6862242322430864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=16 head_norm_before_train=0.867238 cos_to_last_merge=0.9686 (last merge round=12)
[S13] round=16 local utility u=0.116684 metrics={'f1_val': 0.652554818042708, 'auprc': 0.6669261628957979, 'loss_val': 0.6669098953540548, 'psi': 0.658303355983944}-{'f1_val': 0.6123953342651963, 'auprc': 0.6985373936052706, 'loss_val': 0.7541540338931305, 'psi': 0.6468521580012261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=16 head_norm_before_train=1.487649 cos_to_last_merge=0.9995 (last merge round=14)
[S14] round=16 local utility u=0.007360 metrics={'f1_val': 0.996333081002392, 'auprc': 0.9988960113376213, 'loss_val': 0.10089627912726998, 'psi': 0.9973582531364837}-{'f1_val': 0.9972131247180673, 'auprc': 0.9993670891040256, 'loss_val': 0.12231006900813512, 'psi': 0.9980747104724507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=16 head_norm_before_train=1.080835 cos_to_last_merge=0.9988 (last merge round=14)
[S15] round=16 local utility u=0.165950 metrics={'f1_val': 0.6982801995913631, 'auprc': 0.9148855026254086, 'loss_val': 0.35228120669553986, 'psi': 0.7849223208049814}-{'f1_val': 0.6942990716990598, 'auprc': 0.8377427135848723, 'loss_val': 0.42886575277159134, 'psi': 0.7516765284533848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=16 head_norm_before_train=1.112584 cos_to_last_merge=0.9848 (last merge round=12)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.48593209036206464, 'auprc': 0.7788816058179141, 'loss_val': 0.7390507398414595, 'psi': 0.6031118965444044}-{'f1_val': 0.8175908418477029, 'auprc': 0.7752415012331719, 'loss_val': 0.8076325315671077, 'psi': 0.8006511056018906}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=16 head_norm_before_train=1.103278 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.012727 metrics={'f1_val': 0.33884687798932844, 'auprc': 0.6930885763301441, 'loss_val': 0.9817810423210868, 'psi': 0.4805435573256547}-{'f1_val': 0.3508060290264653, 'auprc': 0.6422621594792541, 'loss_val': 0.926509853559703, 'psi': 0.46738848120758086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=17 head_norm_before_train=1.232624 cos_to_last_merge=0.7651 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.765
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.701741760924417, 'auprc': 0.6755859916693859, 'loss_val': 0.32404052909178893, 'psi': 0.6912794532224046}-{'f1_val': 0.7015681696058681, 'auprc': 0.6803153441802516, 'loss_val': 0.32481855951420174, 'psi': 0.6930670394356215}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=17 head_norm_before_train=1.403682 cos_to_last_merge=0.8161 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.816
[S3] round=17 local utility u=0.427607 metrics={'f1_val': 0.6555602039647473, 'auprc': 0.954831302828635, 'loss_val': 0.38099711695438343, 'psi': 0.7752686435103024}-{'f1_val': 0.5717870072756802, 'auprc': 0.8945995689384654, 'loss_val': 0.5528766463947168, 'psi': 0.7009120319407943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=17 head_norm_before_train=1.456413 cos_to_last_merge=0.8549 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.855
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.6269231036789928, 'auprc': 0.8695001717054044, 'loss_val': 0.4851370302817464, 'psi': 0.7239539308895575}-{'f1_val': 0.6686782860724569, 'auprc': 0.8409387887554999, 'loss_val': 0.47946516276096457, 'psi': 0.7375824871456741}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=17 head_norm_before_train=0.913410 cos_to_last_merge=0.9987 (last merge round=15)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.6624867389734193, 'loss_val': 0.506516214686381, 'psi': 0.685187486049716}-{'f1_val': 0.714400588689728, 'auprc': 0.7751657786601112, 'loss_val': 0.6787585311014759, 'psi': 0.7387066646778813}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=17 head_norm_before_train=1.332306 cos_to_last_merge=0.9980 (last merge round=14)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.7100580482412503, 'auprc': 0.9535953025087778, 'loss_val': 0.334761952429245, 'psi': 0.8074729499482614}-{'f1_val': 0.7103678605477248, 'auprc': 0.9623632420691646, 'loss_val': 0.31929245847862303, 'psi': 0.8111660131563008}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=17 head_norm_before_train=1.253494 cos_to_last_merge=0.9903 (last merge round=12)
[S7] round=17 local utility u=0.569210 metrics={'f1_val': 0.6811477427492463, 'auprc': 0.9743189369597569, 'loss_val': 0.523487305207898, 'psi': 0.7984162204334506}-{'f1_val': 0.6075928982159159, 'auprc': 0.7954404771813612, 'loss_val': 0.6839421222369898, 'psi': 0.682731929802094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=17 head_norm_before_train=1.191370 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.830299 metrics={'f1_val': 0.9869309474963556, 'auprc': 0.9973449019013015, 'loss_val': 0.177928434988895, 'psi': 0.991096529258334}-{'f1_val': 0.7142391053978291, 'auprc': 0.9981121817568122, 'loss_val': 0.20467656472196882, 'psi': 0.8277883359414224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=17 head_norm_before_train=1.771024 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.702242887499681, 'auprc': 0.9884831654357091, 'loss_val': 0.3280448082762717, 'psi': 0.8167389986740923}-{'f1_val': 0.9966605118138915, 'auprc': 0.9967982642410058, 'loss_val': 0.060916020360851295, 'psi': 0.9967156127847372}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=17 head_norm_before_train=1.419220 cos_to_last_merge=0.9959 (last merge round=13)
[S10] round=17 local utility u=1.000000 metrics={'f1_val': 0.9951515286921992, 'auprc': 0.9966234845473754, 'loss_val': 0.18680741148859692, 'psi': 0.9957403110342696}-{'f1_val': 0.6621993493431793, 'auprc': 0.9738549440534255, 'loss_val': 0.29589919551938687, 'psi': 0.7868615872272777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=17 head_norm_before_train=0.942653 cos_to_last_merge=0.9939 (last merge round=14)
[S11] round=17 local utility u=0.017447 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.6626268817507646, 'loss_val': 0.3557768696320295, 'psi': 0.6860668404524607}-{'f1_val': 0.7019353166316534, 'auprc': 0.6625176498310247, 'loss_val': 0.3917942940090024, 'psi': 0.6861682499114019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=17 head_norm_before_train=0.909406 cos_to_last_merge=0.9529 (last merge round=12)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6302383191471168, 'auprc': 0.6709402397441631, 'loss_val': 0.6461872291332937, 'psi': 0.6465190873859353}-{'f1_val': 0.652554818042708, 'auprc': 0.6669261628957979, 'loss_val': 0.6669098953540548, 'psi': 0.658303355983944}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=17 head_norm_before_train=1.531594 cos_to_last_merge=0.9983 (last merge round=14)
[S14] round=17 local utility u=0.016969 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9991484117319072, 'loss_val': 0.07664786183043863, 'psi': 0.9983524203054183}-{'f1_val': 0.996333081002392, 'auprc': 0.9988960113376213, 'loss_val': 0.10089627912726998, 'psi': 0.9973582531364837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=17 head_norm_before_train=1.129007 cos_to_last_merge=0.9957 (last merge round=14)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6982981750834133, 'auprc': 0.8130304869204807, 'loss_val': 0.38827061242837346, 'psi': 0.7441910998182403}-{'f1_val': 0.6982801995913631, 'auprc': 0.9148855026254086, 'loss_val': 0.35228120669553986, 'psi': 0.7849223208049814}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=17 head_norm_before_train=1.151236 cos_to_last_merge=0.9782 (last merge round=12)
[S16] round=17 local utility u=0.977833 metrics={'f1_val': 0.815214458476435, 'auprc': 0.794073345447129, 'loss_val': 0.8046533915021545, 'psi': 0.8067580132647126}-{'f1_val': 0.48593209036206464, 'auprc': 0.7788816058179141, 'loss_val': 0.7390507398414595, 'psi': 0.6031118965444044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=17 head_norm_before_train=1.128349 cos_to_last_merge=0.9994 (last merge round=15)
[S17] round=17 local utility u=0.107541 metrics={'f1_val': 0.34620108899603097, 'auprc': 0.7620372478950501, 'loss_val': 1.0176703012605894, 'psi': 0.5125355525556387}-{'f1_val': 0.33884687798932844, 'auprc': 0.6930885763301441, 'loss_val': 0.9817810423210868, 'psi': 0.4805435573256547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] START round=18 head_norm_before_train=1.274006 cos_to_last_merge=0.7566 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.757
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7010299569678582, 'auprc': 0.6621668338811365, 'loss_val': 0.2956812360414605, 'psi': 0.6854847077331695}-{'f1_val': 0.701741760924417, 'auprc': 0.6755859916693859, 'loss_val': 0.32404052909178893, 'psi': 0.6912794532224046}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=18 head_norm_before_train=1.423571 cos_to_last_merge=0.8110 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.811
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.46764095906337577, 'auprc': 0.8521876699765187, 'loss_val': 0.7900237867712362, 'psi': 0.621459643428633}-{'f1_val': 0.6555602039647473, 'auprc': 0.954831302828635, 'loss_val': 0.38099711695438343, 'psi': 0.7752686435103024}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=18 head_norm_before_train=1.473235 cos_to_last_merge=0.8528 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.853
[S4] round=18 local utility u=0.085467 metrics={'f1_val': 0.6174071443433617, 'auprc': 0.946637181461308, 'loss_val': 0.48851825150501704, 'psi': 0.7490991591905403}-{'f1_val': 0.6269231036789928, 'auprc': 0.8695001717054044, 'loss_val': 0.4851370302817464, 'psi': 0.7239539308895575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=18 head_norm_before_train=0.943847 cos_to_last_merge=0.9954 (last merge round=15)
[S5] round=18 local utility u=0.222015 metrics={'f1_val': 0.700320598491359, 'auprc': 0.7917407986383096, 'loss_val': 0.4502445366408748, 'psi': 0.7368886785501392}-{'f1_val': 0.7003213174339138, 'auprc': 0.6624867389734193, 'loss_val': 0.506516214686381, 'psi': 0.685187486049716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=18 head_norm_before_train=1.355382 cos_to_last_merge=0.9958 (last merge round=14)
[S6] round=18 local utility u=0.363404 metrics={'f1_val': 0.8124441589937048, 'auprc': 0.965068050627948, 'loss_val': 0.2566878997136448, 'psi': 0.8734937156474021}-{'f1_val': 0.7100580482412503, 'auprc': 0.9535953025087778, 'loss_val': 0.334761952429245, 'psi': 0.8074729499482614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=18 head_norm_before_train=1.279723 cos_to_last_merge=0.9870 (last merge round=12)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5946313090328158, 'auprc': 0.8039314096041205, 'loss_val': 0.6632417986195408, 'psi': 0.6783513492613378}-{'f1_val': 0.6811477427492463, 'auprc': 0.9743189369597569, 'loss_val': 0.523487305207898, 'psi': 0.7984162204334506}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=18 head_norm_before_train=1.241328 cos_to_last_merge=0.9992 (last merge round=16)
[S8] round=18 local utility u=0.041782 metrics={'f1_val': 0.9924605795656339, 'auprc': 0.9990283820066974, 'loss_val': 0.1325926847903755, 'psi': 0.9950877005420593}-{'f1_val': 0.9869309474963556, 'auprc': 0.9973449019013015, 'loss_val': 0.177928434988895, 'psi': 0.991096529258334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=18 head_norm_before_train=1.796272 (no previous merge yet)
[S9] round=18 local utility u=1.000000 metrics={'f1_val': 0.9966857875385419, 'auprc': 0.998341860470131, 'loss_val': 0.042603167362040326, 'psi': 0.9973482167111776}-{'f1_val': 0.702242887499681, 'auprc': 0.9884831654357091, 'loss_val': 0.3280448082762717, 'psi': 0.8167389986740923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=18 head_norm_before_train=1.440814 cos_to_last_merge=0.9931 (last merge round=13)
[S10] round=18 local utility u=0.022749 metrics={'f1_val': 0.9955668669630084, 'auprc': 0.9970010635814532, 'loss_val': 0.14493455559795146, 'psi': 0.9961405456103863}-{'f1_val': 0.9951515286921992, 'auprc': 0.9966234845473754, 'loss_val': 0.18680741148859692, 'psi': 0.9957403110342696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=18 head_norm_before_train=0.987892 cos_to_last_merge=0.9892 (last merge round=14)
[S11] round=18 local utility u=0.013312 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.6635129481461952, 'loss_val': 0.333261176653226, 'psi': 0.6865663692374702}-{'f1_val': 0.7016934795869249, 'auprc': 0.6626268817507646, 'loss_val': 0.3557768696320295, 'psi': 0.6860668404524607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] sending update (kind=head size=1791 to 1 peers)
[S13] START round=18 head_norm_before_train=0.953999 cos_to_last_merge=0.9359 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.936
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6276184765455941, 'auprc': 0.6700207774605629, 'loss_val': 0.6311851742419906, 'psi': 0.6445793969115816}-{'f1_val': 0.6302383191471168, 'auprc': 0.6709402397441631, 'loss_val': 0.6461872291332937, 'psi': 0.6465190873859353}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=18 head_norm_before_train=1.576038 cos_to_last_merge=0.9966 (last merge round=14)
[S14] round=18 local utility u=0.001453 metrics={'f1_val': 0.9965760575063591, 'auprc': 0.9990814436378253, 'loss_val': 0.06606664895967156, 'psi': 0.9975782119589456}-{'f1_val': 0.9978217593544257, 'auprc': 0.9991484117319072, 'loss_val': 0.07664786183043863, 'psi': 0.9983524203054183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=18 head_norm_before_train=1.174214 cos_to_last_merge=0.9917 (last merge round=14)
[S15] round=18 local utility u=1.000000 metrics={'f1_val': 0.9909024255165635, 'auprc': 0.9958484256368945, 'loss_val': 0.2009243125740173, 'psi': 0.9928808255646959}-{'f1_val': 0.6982981750834133, 'auprc': 0.8130304869204807, 'loss_val': 0.38827061242837346, 'psi': 0.7441910998182403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] sending update (kind=head size=1807 to 1 peers)
[S16] START round=18 head_norm_before_train=1.185081 cos_to_last_merge=0.9721 (last merge round=12)
[S16] round=18 local utility u=0.208054 metrics={'f1_val': 0.798719177301503, 'auprc': 0.8703477353117242, 'loss_val': 0.5183967759405023, 'psi': 0.8273706005055914}-{'f1_val': 0.815214458476435, 'auprc': 0.794073345447129, 'loss_val': 0.8046533915021545, 'psi': 0.8067580132647126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=18 head_norm_before_train=1.151521 cos_to_last_merge=0.9978 (last merge round=15)
[S17] round=18 local utility u=0.118580 metrics={'f1_val': 0.35951668699548456, 'auprc': 0.8010715203490016, 'loss_val': 0.9775061044065382, 'psi': 0.5361386203368914}-{'f1_val': 0.34620108899603097, 'auprc': 0.7620372478950501, 'loss_val': 1.0176703012605894, 'psi': 0.5125355525556387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=19 head_norm_before_train=1.305585 cos_to_last_merge=0.7514 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.751
[S2] round=19 local utility u=0.001618 metrics={'f1_val': 0.7011314218236641, 'auprc': 0.6640261894665889, 'loss_val': 0.29863248050746105, 'psi': 0.686289328880834}-{'f1_val': 0.7010299569678582, 'auprc': 0.6621668338811365, 'loss_val': 0.2956812360414605, 'psi': 0.6854847077331695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S2] r=20 psi=0.686 u=0.0016 p_local=0.0692 f1=0.701 auprc=0.664 bytes=25173
[S3] START round=19 head_norm_before_train=1.439898 cos_to_last_merge=0.8063 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.806
[S3] round=19 local utility u=0.311602 metrics={'f1_val': 0.5389532972281805, 'auprc': 0.8670764219998278, 'loss_val': 0.6393603424024856, 'psi': 0.6702025471368394}-{'f1_val': 0.46764095906337577, 'auprc': 0.8521876699765187, 'loss_val': 0.7900237867712362, 'psi': 0.621459643428633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] sending update (kind=head size=1790 to 1 peers)
[S3] r=20 psi=0.670 u=0.3116 p_local=0.2444 f1=0.539 auprc=0.867 bytes=17930
[S4] START round=19 head_norm_before_train=1.486375 cos_to_last_merge=0.8516 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.852
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.61331003637653, 'auprc': 0.9461991602361447, 'loss_val': 0.5018662517325642, 'psi': 0.7464656859203759}-{'f1_val': 0.6174071443433617, 'auprc': 0.946637181461308, 'loss_val': 0.48851825150501704, 'psi': 0.7490991591905403}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=20 psi=0.746 u=0.0000 p_local=0.0763 f1=0.613 auprc=0.946 bytes=25160
[S5] START round=19 head_norm_before_train=0.979182 cos_to_last_merge=0.9905 (last merge round=15)
[S5] round=19 local utility u=0.044333 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8056271273220883, 'loss_val': 0.4032379138394146, 'psi': 0.7424432100236507}-{'f1_val': 0.700320598491359, 'auprc': 0.7917407986383096, 'loss_val': 0.4502445366408748, 'psi': 0.7368886785501392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S5] r=20 psi=0.742 u=0.0443 p_local=0.1373 f1=0.700 auprc=0.806 bytes=25185
[S6] START round=19 head_norm_before_train=1.377892 cos_to_last_merge=0.9936 (last merge round=14)
[S6] round=19 local utility u=0.467448 metrics={'f1_val': 0.962351943680853, 'auprc': 0.9680907672889821, 'loss_val': 0.23030591225851305, 'psi': 0.9646474731241046}-{'f1_val': 0.8124441589937048, 'auprc': 0.965068050627948, 'loss_val': 0.2566878997136448, 'psi': 0.8734937156474021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] sending update (kind=head size=1791 to 1 peers)
[S6] r=20 psi=0.965 u=0.4674 p_local=0.2665 f1=0.962 auprc=0.968 bytes=19790
[S7] START round=19 head_norm_before_train=1.307801 cos_to_last_merge=0.9830 (last merge round=12)
[S7] round=19 local utility u=0.440612 metrics={'f1_val': 0.6804599586685114, 'auprc': 0.8597991759684658, 'loss_val': 0.4645923777447818, 'psi': 0.7521956455884932}-{'f1_val': 0.5946313090328158, 'auprc': 0.8039314096041205, 'loss_val': 0.6632417986195408, 'psi': 0.6783513492613378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S7] r=20 psi=0.752 u=0.4406 p_local=0.2785 f1=0.680 auprc=0.860 bytes=26939
[S8] START round=19 head_norm_before_train=1.283511 cos_to_last_merge=0.9976 (last merge round=16)
[S8] round=19 local utility u=0.001232 metrics={'f1_val': 0.9938873435151911, 'auprc': 0.9982258338750617, 'loss_val': 0.13628073191752713, 'psi': 0.9956227396591393}-{'f1_val': 0.9924605795656339, 'auprc': 0.9990283820066974, 'loss_val': 0.1325926847903755, 'psi': 0.9950877005420593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S8] r=20 psi=0.996 u=0.0012 p_local=0.2751 f1=0.994 auprc=0.998 bytes=28722
[S9] START round=19 head_norm_before_train=1.813940 (no previous merge yet)
[S9] round=19 local utility u=0.003806 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984458561136558, 'loss_val': 0.0378054570290816, 'psi': 0.997640089952748}-{'f1_val': 0.9966857875385419, 'auprc': 0.998341860470131, 'loss_val': 0.042603167362040326, 'psi': 0.9973482167111776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S9] r=20 psi=0.998 u=0.0038 p_local=0.2676 f1=0.997 auprc=0.998 bytes=28762
[S10] START round=19 head_norm_before_train=1.462958 cos_to_last_merge=0.9895 (last merge round=13)
[S10] round=19 local utility u=0.011739 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9964866433025631, 'loss_val': 0.12016968182470308, 'psi': 0.9959604494300371}-{'f1_val': 0.9955668669630084, 'auprc': 0.9970010635814532, 'loss_val': 0.14493455559795146, 'psi': 0.9961405456103863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S10] r=20 psi=0.996 u=0.0117 p_local=0.2013 f1=0.996 auprc=0.996 bytes=30572
[S11] START round=19 head_norm_before_train=1.025357 cos_to_last_merge=0.9847 (last merge round=14)
[S11] round=19 local utility u=0.017978 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.6691100090002007, 'loss_val': 0.31409627742885377, 'psi': 0.6888051935790723}-{'f1_val': 0.7019353166316534, 'auprc': 0.6635129481461952, 'loss_val': 0.333261176653226, 'psi': 0.6865663692374702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S11] r=20 psi=0.689 u=0.0180 p_local=0.0856 f1=0.702 auprc=0.669 bytes=28744
[S13] START round=19 head_norm_before_train=0.992464 cos_to_last_merge=0.9217 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.922
[S13] round=19 local utility u=0.029880 metrics={'f1_val': 0.632364524618059, 'auprc': 0.6630752077162438, 'loss_val': 0.5790641026377544, 'psi': 0.644648797857333}-{'f1_val': 0.6276184765455941, 'auprc': 0.6700207774605629, 'loss_val': 0.6311851742419906, 'psi': 0.6445793969115816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S13] r=20 psi=0.645 u=0.0299 p_local=0.1123 f1=0.632 auprc=0.663 bytes=19765
[S14] START round=19 head_norm_before_train=1.620298 cos_to_last_merge=0.9944 (last merge round=14)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9715648023988184, 'auprc': 0.9991386383082088, 'loss_val': 0.07365389422860866, 'psi': 0.9825943367625745}-{'f1_val': 0.9965760575063591, 'auprc': 0.9990814436378253, 'loss_val': 0.06606664895967156, 'psi': 0.9975782119589456}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=20 psi=0.983 u=0.0000 p_local=0.0780 f1=0.972 auprc=0.999 bytes=28794
[S15] START round=19 head_norm_before_train=1.210849 cos_to_last_merge=0.9877 (last merge round=14)
[S15] round=19 local utility u=0.020147 metrics={'f1_val': 0.9926295421785005, 'auprc': 0.9945014033487719, 'loss_val': 0.16695208411836532, 'psi': 0.9933782866466091}-{'f1_val': 0.9909024255165635, 'auprc': 0.9958484256368945, 'loss_val': 0.2009243125740173, 'psi': 0.9928808255646959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S15] r=20 psi=0.993 u=0.0201 p_local=0.2574 f1=0.993 auprc=0.995 bytes=30568
[S16] START round=19 head_norm_before_train=1.218304 cos_to_last_merge=0.9663 (last merge round=12)
[S16] round=19 local utility u=0.137375 metrics={'f1_val': 0.8449380665980661, 'auprc': 0.8875356369272892, 'loss_val': 0.5725243032738175, 'psi': 0.8619770947297554}-{'f1_val': 0.798719177301503, 'auprc': 0.8703477353117242, 'loss_val': 0.5183967759405023, 'psi': 0.8273706005055914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S16] r=20 psi=0.862 u=0.1374 p_local=0.3195 f1=0.845 auprc=0.888 bytes=23304
[S17] START round=19 head_norm_before_train=1.170326 cos_to_last_merge=0.9965 (last merge round=15)
[S17] round=19 local utility u=0.888892 metrics={'f1_val': 0.6283253799946853, 'auprc': 0.8011287914981247, 'loss_val': 0.812746758132024, 'psi': 0.697446744596061}-{'f1_val': 0.35951668699548456, 'auprc': 0.8010715203490016, 'loss_val': 0.9775061044065382, 'psi': 0.5361386203368914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S17] r=20 psi=0.697 u=0.8889 p_local=0.2626 f1=0.628 auprc=0.801 bytes=26925
[S2] START round=20 head_norm_before_train=1.334558 cos_to_last_merge=0.7487 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.749
[S2] round=20 local utility u=0.002581 metrics={'f1_val': 0.7015719066528542, 'auprc': 0.6644030403299819, 'loss_val': 0.2972437858130622, 'psi': 0.6867043601237053}-{'f1_val': 0.7011314218236641, 'auprc': 0.6640261894665889, 'loss_val': 0.29863248050746105, 'psi': 0.686289328880834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=20 head_norm_before_train=1.457225 cos_to_last_merge=0.8015 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.802
[S3] round=20 local utility u=0.854825 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9931433365441403, 'loss_val': 0.2761758579240891, 'psi': 0.8174558860295733}-{'f1_val': 0.5389532972281805, 'auprc': 0.8670764219998278, 'loss_val': 0.6393603424024856, 'psi': 0.6702025471368394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=20 head_norm_before_train=1.502984 cos_to_last_merge=0.8493 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.849
[S4] round=20 local utility u=0.005105 metrics={'f1_val': 0.6131549658516942, 'auprc': 0.9522479396034895, 'loss_val': 0.5088729546173952, 'psi': 0.7487921553524123}-{'f1_val': 0.61331003637653, 'auprc': 0.9461991602361447, 'loss_val': 0.5018662517325642, 'psi': 0.7464656859203759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=20 head_norm_before_train=1.015664 cos_to_last_merge=0.9848 (last merge round=15)
[S5] round=20 local utility u=0.116643 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8712992086674234, 'loss_val': 0.36696759366497117, 'psi': 0.7687120425617848}-{'f1_val': 0.700320598491359, 'auprc': 0.8056271273220883, 'loss_val': 0.4032379138394146, 'psi': 0.7424432100236507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=20 head_norm_before_train=1.399167 cos_to_last_merge=0.9911 (last merge round=14)
[S6] round=20 local utility u=0.020093 metrics={'f1_val': 0.9632507583035537, 'auprc': 0.9707714414294576, 'loss_val': 0.20355401552152064, 'psi': 0.9662590315539152}-{'f1_val': 0.962351943680853, 'auprc': 0.9680907672889821, 'loss_val': 0.23030591225851305, 'psi': 0.9646474731241046}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=20 head_norm_before_train=1.330160 cos_to_last_merge=0.9795 (last merge round=12)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.621918354772214, 'auprc': 0.8009883120192478, 'loss_val': 0.6128279333412398, 'psi': 0.6935463376710276}-{'f1_val': 0.6804599586685114, 'auprc': 0.8597991759684658, 'loss_val': 0.4645923777447818, 'psi': 0.7521956455884932}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=20 head_norm_before_train=1.316053 cos_to_last_merge=0.9958 (last merge round=16)
[S8] round=20 local utility u=0.010404 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9980852729989275, 'loss_val': 0.10914182717600619, 'psi': 0.9949755627587566}-{'f1_val': 0.9938873435151911, 'auprc': 0.9982258338750617, 'loss_val': 0.13628073191752713, 'psi': 0.9956227396591393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=20 head_norm_before_train=1.831422 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9895530216146718, 'auprc': 0.9984445337166226, 'loss_val': 0.04865573199336398, 'psi': 0.9931096264554521}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984458561136558, 'loss_val': 0.0378054570290816, 'psi': 0.997640089952748}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=20 head_norm_before_train=1.489669 cos_to_last_merge=0.9851 (last merge round=13)
[S10] round=20 local utility u=0.000591 metrics={'f1_val': 0.9947781979029806, 'auprc': 0.9934180152385552, 'loss_val': 0.10479402868737622, 'psi': 0.9942341248372104}-{'f1_val': 0.9956096535150197, 'auprc': 0.9964866433025631, 'loss_val': 0.12016968182470308, 'psi': 0.9959604494300371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=20 head_norm_before_train=1.061673 cos_to_last_merge=0.9796 (last merge round=14)
[S11] round=20 local utility u=0.104538 metrics={'f1_val': 0.6992942365204238, 'auprc': 0.7438347340509388, 'loss_val': 0.31334766328759733, 'psi': 0.7171104355326298}-{'f1_val': 0.7019353166316534, 'auprc': 0.6691100090002007, 'loss_val': 0.31409627742885377, 'psi': 0.6888051935790723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=20 head_norm_before_train=1.025128 cos_to_last_merge=0.9100 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.910
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.6136536381202203, 'auprc': 0.68145170306681, 'loss_val': 0.6567664478066787, 'psi': 0.6407728640988561}-{'f1_val': 0.632364524618059, 'auprc': 0.6630752077162438, 'loss_val': 0.5790641026377544, 'psi': 0.644648797857333}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=20 head_norm_before_train=1.659522 cos_to_last_merge=0.9924 (last merge round=14)
[S14] round=20 local utility u=0.092524 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9993654315300844, 'loss_val': 0.04436259567348726, 'psi': 0.9981927691727306}-{'f1_val': 0.9715648023988184, 'auprc': 0.9991386383082088, 'loss_val': 0.07365389422860866, 'psi': 0.9825943367625745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=20 head_norm_before_train=1.249112 cos_to_last_merge=0.9832 (last merge round=14)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.7718652084217938, 'auprc': 0.9135318555288169, 'loss_val': 0.3001444890295568, 'psi': 0.828531867264603}-{'f1_val': 0.9926295421785005, 'auprc': 0.9945014033487719, 'loss_val': 0.16695208411836532, 'psi': 0.9933782866466091}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=20 head_norm_before_train=1.255719 cos_to_last_merge=0.9598 (last merge round=12)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.841091421214962, 'auprc': 0.9001327493687541, 'loss_val': 0.6104307084940708, 'psi': 0.8647079524764789}-{'f1_val': 0.8449380665980661, 'auprc': 0.8875356369272892, 'loss_val': 0.5725243032738175, 'psi': 0.8619770947297554}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=20 head_norm_before_train=1.187675 cos_to_last_merge=0.9953 (last merge round=15)
[S17] round=20 local utility u=0.286702 metrics={'f1_val': 0.6482903499628356, 'auprc': 0.9090288433173024, 'loss_val': 0.6828336766292818, 'psi': 0.7525857473046224}-{'f1_val': 0.6283253799946853, 'auprc': 0.8011287914981247, 'loss_val': 0.812746758132024, 'psi': 0.697446744596061}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=21 head_norm_before_train=1.359423 cos_to_last_merge=0.7458 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.746
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7014937575602418, 'auprc': 0.6636368570287939, 'loss_val': 0.29905802767730844, 'psi': 0.6863509973476627}-{'f1_val': 0.7015719066528542, 'auprc': 0.6644030403299819, 'loss_val': 0.2972437858130622, 'psi': 0.6867043601237053}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=21 head_norm_before_train=1.477555 cos_to_last_merge=0.8005 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.800
[S3] round=21 local utility u=0.009182 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9956923179463095, 'loss_val': 0.2684643517815685, 'psi': 0.8187759681938103}-{'f1_val': 0.700330919019862, 'auprc': 0.9931433365441403, 'loss_val': 0.2761758579240891, 'psi': 0.8174558860295733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=21 head_norm_before_train=1.518708 cos_to_last_merge=0.8475 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.848
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.6121712584871197, 'auprc': 0.9531023236856095, 'loss_val': 0.5156049570419217, 'psi': 0.7485436845665157}-{'f1_val': 0.6131549658516942, 'auprc': 0.9522479396034895, 'loss_val': 0.5088729546173952, 'psi': 0.7487921553524123}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=21 head_norm_before_train=1.052647 cos_to_last_merge=0.9788 (last merge round=15)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8088736094106416, 'loss_val': 0.352461640766687, 'psi': 0.7437418028590721}-{'f1_val': 0.700320598491359, 'auprc': 0.8712992086674234, 'loss_val': 0.36696759366497117, 'psi': 0.7687120425617848}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=21 head_norm_before_train=1.414323 cos_to_last_merge=0.9891 (last merge round=14)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.9498789341562723, 'auprc': 0.9557307487098685, 'loss_val': 0.2759390079482246, 'psi': 0.9522196599777109}-{'f1_val': 0.9632507583035537, 'auprc': 0.9707714414294576, 'loss_val': 0.20355401552152064, 'psi': 0.9662590315539152}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=21 head_norm_before_train=1.347252 cos_to_last_merge=0.9767 (last merge round=12)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.5899255169932651, 'auprc': 0.7967834639262747, 'loss_val': 0.6623846938929631, 'psi': 0.6726686957664689}-{'f1_val': 0.621918354772214, 'auprc': 0.8009883120192478, 'loss_val': 0.6128279333412398, 'psi': 0.6935463376710276}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=21 head_norm_before_train=1.343833 cos_to_last_merge=0.9940 (last merge round=16)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.7810621593677026, 'auprc': 0.9906892375608286, 'loss_val': 0.1592597643681099, 'psi': 0.8649129906449531}-{'f1_val': 0.9929024225986427, 'auprc': 0.9980852729989275, 'loss_val': 0.10914182717600619, 'psi': 0.9949755627587566}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=21 head_norm_before_train=1.848586 (no previous merge yet)
[S9] round=21 local utility u=0.018848 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9984509111080503, 'loss_val': 0.036114214484361244, 'psi': 0.9956256694370451}-{'f1_val': 0.9895530216146718, 'auprc': 0.9984445337166226, 'loss_val': 0.04865573199336398, 'psi': 0.9931096264554521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=21 head_norm_before_train=1.521095 cos_to_last_merge=0.9801 (last merge round=13)
[S10] round=21 local utility u=0.016383 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9958225217113628, 'loss_val': 0.08423090346529963, 'psi': 0.995694800793557}-{'f1_val': 0.9947781979029806, 'auprc': 0.9934180152385552, 'loss_val': 0.10479402868737622, 'psi': 0.9942341248372104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=21 head_norm_before_train=1.089929 cos_to_last_merge=0.9756 (last merge round=14)
[S11] round=21 local utility u=0.148520 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.8321584688215364, 'loss_val': 0.2956736713934503, 'psi': 0.7538794752807695}-{'f1_val': 0.6992942365204238, 'auprc': 0.7438347340509388, 'loss_val': 0.31334766328759733, 'psi': 0.7171104355326298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=21 head_norm_before_train=1.054962 cos_to_last_merge=0.9000 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.900
[S13] round=21 local utility u=0.098787 metrics={'f1_val': 0.6383998157419097, 'auprc': 0.6667981187162823, 'loss_val': 0.5637090530622101, 'psi': 0.6497591369316588}-{'f1_val': 0.6136536381202203, 'auprc': 0.68145170306681, 'loss_val': 0.6567664478066787, 'psi': 0.6407728640988561}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=21 head_norm_before_train=1.694061 cos_to_last_merge=0.9903 (last merge round=14)
[S14] round=21 local utility u=0.003099 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9990751168713234, 'loss_val': 0.03975736135899756, 'psi': 0.9983231023611848}-{'f1_val': 0.9974109942678281, 'auprc': 0.9993654315300844, 'loss_val': 0.04436259567348726, 'psi': 0.9981927691727306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=21 head_norm_before_train=1.286450 cos_to_last_merge=0.9786 (last merge round=14)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7017752063565317, 'auprc': 0.9127968125003458, 'loss_val': 0.29948246885191004, 'psi': 0.7861838488140573}-{'f1_val': 0.7718652084217938, 'auprc': 0.9135318555288169, 'loss_val': 0.3001444890295568, 'psi': 0.828531867264603}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=1.296257 cos_to_last_merge=0.9529 (last merge round=12)
[S16] round=21 local utility u=0.035546 metrics={'f1_val': 0.8443112932778967, 'auprc': 0.9195470881310359, 'loss_val': 0.6169015601045623, 'psi': 0.8744056112191523}-{'f1_val': 0.841091421214962, 'auprc': 0.9001327493687541, 'loss_val': 0.6104307084940708, 'psi': 0.8647079524764789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=21 head_norm_before_train=1.203981 cos_to_last_merge=0.9935 (last merge round=15)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.40083473105145273, 'auprc': 0.9258228570497554, 'loss_val': 0.6599910050896735, 'psi': 0.6108299814507738}-{'f1_val': 0.6482903499628356, 'auprc': 0.9090288433173024, 'loss_val': 0.6828336766292818, 'psi': 0.7525857473046224}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=22 head_norm_before_train=1.380883 cos_to_last_merge=0.7424 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.742
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7014842933119017, 'auprc': 0.6661176900081801, 'loss_val': 0.3174058859521217, 'psi': 0.6873376519904131}-{'f1_val': 0.7014937575602418, 'auprc': 0.6636368570287939, 'loss_val': 0.29905802767730844, 'psi': 0.6863509973476627}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=22 head_norm_before_train=1.497287 cos_to_last_merge=0.7996 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.800
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.6990814656696018, 'auprc': 0.9931423610695206, 'loss_val': 0.2804334087215199, 'psi': 0.8167058238295692}-{'f1_val': 0.7008317350254774, 'auprc': 0.9956923179463095, 'loss_val': 0.2684643517815685, 'psi': 0.8187759681938103}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=1.534971 cos_to_last_merge=0.8460 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.846
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.6108031566040071, 'auprc': 0.9379070789779567, 'loss_val': 0.5226612211760144, 'psi': 0.741644725553587}-{'f1_val': 0.6121712584871197, 'auprc': 0.9531023236856095, 'loss_val': 0.5156049570419217, 'psi': 0.7485436845665157}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=22 head_norm_before_train=1.086519 cos_to_last_merge=0.9732 (last merge round=15)
[S5] round=22 local utility u=0.121465 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8835306884522498, 'loss_val': 0.33350297219873853, 'psi': 0.7736046344757153}-{'f1_val': 0.700320598491359, 'auprc': 0.8088736094106416, 'loss_val': 0.352461640766687, 'psi': 0.7437418028590721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=22 head_norm_before_train=1.424565 cos_to_last_merge=0.9877 (last merge round=14)
[S6] round=22 local utility u=0.105955 metrics={'f1_val': 0.9631594763643927, 'auprc': 0.9750329371631502, 'loss_val': 0.20161804662236538, 'psi': 0.9679088606838957}-{'f1_val': 0.9498789341562723, 'auprc': 0.9557307487098685, 'loss_val': 0.2759390079482246, 'psi': 0.9522196599777109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=22 head_norm_before_train=1.361956 cos_to_last_merge=0.9743 (last merge round=12)
[S7] round=22 local utility u=0.276364 metrics={'f1_val': 0.6481554859676601, 'auprc': 0.8172569992393977, 'loss_val': 0.5204566468705165, 'psi': 0.7157960912763552}-{'f1_val': 0.5899255169932651, 'auprc': 0.7967834639262747, 'loss_val': 0.6623846938929631, 'psi': 0.6726686957664689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=22 head_norm_before_train=1.377466 cos_to_last_merge=0.9920 (last merge round=16)
[S8] round=22 local utility u=0.689395 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9990832834440305, 'loss_val': 0.07888336335043016, 'psi': 0.9955937152985361}-{'f1_val': 0.7810621593677026, 'auprc': 0.9906892375608286, 'loss_val': 0.1592597643681099, 'psi': 0.8649129906449531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=22 head_norm_before_train=1.865015 (no previous merge yet)
[S9] round=22 local utility u=0.002512 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9935524320658227, 'loss_val': 0.03144237072779609, 'psi': 0.9951710296938956}-{'f1_val': 0.9937421749897083, 'auprc': 0.9984509111080503, 'loss_val': 0.036114214484361244, 'psi': 0.9956256694370451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=22 head_norm_before_train=1.553336 cos_to_last_merge=0.9747 (last merge round=13)
[S10] round=22 local utility u=0.006782 metrics={'f1_val': 0.9955668669630084, 'auprc': 0.9961738906940137, 'loss_val': 0.0714634224959157, 'psi': 0.9958096764554105}-{'f1_val': 0.9956096535150197, 'auprc': 0.9958225217113628, 'loss_val': 0.08423090346529963, 'psi': 0.995694800793557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=22 head_norm_before_train=1.114088 cos_to_last_merge=0.9719 (last merge round=14)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.6825745364076574, 'auprc': 0.8821120086634359, 'loss_val': 0.35304601735541924, 'psi': 0.7623895253099688}-{'f1_val': 0.7016934795869249, 'auprc': 0.8321584688215364, 'loss_val': 0.2956736713934503, 'psi': 0.7538794752807695}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=22 head_norm_before_train=1.081334 cos_to_last_merge=0.8909 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.891
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.6314959696411963, 'auprc': 0.6717483311742011, 'loss_val': 0.581958719106012, 'psi': 0.6475969142543981}-{'f1_val': 0.6383998157419097, 'auprc': 0.6667981187162823, 'loss_val': 0.5637090530622101, 'psi': 0.6497591369316588}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.727020 cos_to_last_merge=0.9884 (last merge round=14)
[S14] round=22 local utility u=0.001685 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9990616139528933, 'loss_val': 0.033882116439437004, 'psi': 0.9980712421418543}-{'f1_val': 0.9978217593544257, 'auprc': 0.9990751168713234, 'loss_val': 0.03975736135899756, 'psi': 0.9983231023611848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=22 head_norm_before_train=1.318254 cos_to_last_merge=0.9745 (last merge round=14)
[S15] round=22 local utility u=1.000000 metrics={'f1_val': 0.991342663619303, 'auprc': 0.9944409430050763, 'loss_val': 0.11354412207280576, 'psi': 0.9925819753736123}-{'f1_val': 0.7017752063565317, 'auprc': 0.9127968125003458, 'loss_val': 0.29948246885191004, 'psi': 0.7861838488140573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] sending update (kind=head size=1807 to 1 peers)
[S16] START round=22 head_norm_before_train=1.337271 cos_to_last_merge=0.9461 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.946
[S16] round=22 local utility u=0.388969 metrics={'f1_val': 0.8951094841068863, 'auprc': 0.9627706948077491, 'loss_val': 0.2734235153786422, 'psi': 0.9221739683872314}-{'f1_val': 0.8443112932778967, 'auprc': 0.9195470881310359, 'loss_val': 0.6169015601045623, 'psi': 0.8744056112191523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=22 head_norm_before_train=1.217351 cos_to_last_merge=0.9922 (last merge round=15)
[S17] round=22 local utility u=0.033063 metrics={'f1_val': 0.40574077127736535, 'auprc': 0.9356572390071467, 'loss_val': 0.6528045882803964, 'psi': 0.6177073583692779}-{'f1_val': 0.40083473105145273, 'auprc': 0.9258228570497554, 'loss_val': 0.6599910050896735, 'psi': 0.6108299814507738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=23 head_norm_before_train=1.400109 cos_to_last_merge=0.7404 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.740
[S2] round=23 local utility u=0.003144 metrics={'f1_val': 0.7015719066528542, 'auprc': 0.6667597909985798, 'loss_val': 0.3135702966783615, 'psi': 0.6876470603911444}-{'f1_val': 0.7014842933119017, 'auprc': 0.6661176900081801, 'loss_val': 0.3174058859521217, 'psi': 0.6873376519904131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=23 head_norm_before_train=1.513094 cos_to_last_merge=0.7963 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.796
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.6351675995376187, 'auprc': 0.9307613702436981, 'loss_val': 0.40680644289304413, 'psi': 0.7534051078200505}-{'f1_val': 0.6990814656696018, 'auprc': 0.9931423610695206, 'loss_val': 0.2804334087215199, 'psi': 0.8167058238295692}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=1.548558 cos_to_last_merge=0.8447 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.845
[S4] round=23 local utility u=0.025920 metrics={'f1_val': 0.6121313561162147, 'auprc': 0.9503990267300708, 'loss_val': 0.5162663261758723, 'psi': 0.7474384243617571}-{'f1_val': 0.6108031566040071, 'auprc': 0.9379070789779567, 'loss_val': 0.5226612211760144, 'psi': 0.741644725553587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=23 head_norm_before_train=1.119284 cos_to_last_merge=0.9679 (last merge round=15)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8512646603027239, 'loss_val': 0.3290361617941612, 'psi': 0.760698223215905}-{'f1_val': 0.700320598491359, 'auprc': 0.8835306884522498, 'loss_val': 0.33350297219873853, 'psi': 0.7736046344757153}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=23 head_norm_before_train=1.437307 cos_to_last_merge=0.9864 (last merge round=14)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.9610949668741082, 'auprc': 0.9662123330095, 'loss_val': 0.219093810881985, 'psi': 0.9631419133282649}-{'f1_val': 0.9631594763643927, 'auprc': 0.9750329371631502, 'loss_val': 0.20161804662236538, 'psi': 0.9679088606838957}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=1.372850 cos_to_last_merge=0.9726 (last merge round=12)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.6501098878473097, 'auprc': 0.8097035627493402, 'loss_val': 0.5193989798258787, 'psi': 0.7139473578081219}-{'f1_val': 0.6481554859676601, 'auprc': 0.8172569992393977, 'loss_val': 0.5204566468705165, 'psi': 0.7157960912763552}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=23 head_norm_before_train=1.414588 cos_to_last_merge=0.9895 (last merge round=16)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9931489740885844, 'auprc': 0.9900055796620243, 'loss_val': 0.09651052659071194, 'psi': 0.9918916163179604}-{'f1_val': 0.9932673365348732, 'auprc': 0.9990832834440305, 'loss_val': 0.07888336335043016, 'psi': 0.9955937152985361}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=23 head_norm_before_train=1.879035 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9876029063437939, 'auprc': 0.9986976068817819, 'loss_val': 0.04872710146811234, 'psi': 0.9920407865589891}-{'f1_val': 0.9962500947792776, 'auprc': 0.9935524320658227, 'loss_val': 0.03144237072779609, 'psi': 0.9951710296938956}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=23 head_norm_before_train=1.584009 cos_to_last_merge=0.9700 (last merge round=13)
[S10] round=23 local utility u=0.004194 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9960669132511233, 'loss_val': 0.06022388207901904, 'psi': 0.9955137967808674}-{'f1_val': 0.9955668669630084, 'auprc': 0.9961738906940137, 'loss_val': 0.0714634224959157, 'psi': 0.9958096764554105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=23 head_norm_before_train=1.134606 cos_to_last_merge=0.9687 (last merge round=14)
[S11] round=23 local utility u=0.121789 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9017327780700158, 'loss_val': 0.2844945192543774, 'psi': 0.7818543012069984}-{'f1_val': 0.6825745364076574, 'auprc': 0.8821120086634359, 'loss_val': 0.35304601735541924, 'psi': 0.7623895253099688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=23 head_norm_before_train=1.107137 cos_to_last_merge=0.8830 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.883
[S13] round=23 local utility u=0.020103 metrics={'f1_val': 0.6359660562315795, 'auprc': 0.6675520192841692, 'loss_val': 0.5559844244227558, 'psi': 0.6486004414526154}-{'f1_val': 0.6314959696411963, 'auprc': 0.6717483311742011, 'loss_val': 0.581958719106012, 'psi': 0.6475969142543981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=23 head_norm_before_train=1.752805 cos_to_last_merge=0.9869 (last merge round=14)
[S14] round=23 local utility u=0.000191 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.999105276502278, 'loss_val': 0.032310529713663855, 'psi': 0.9979565835610036}-{'f1_val': 0.9974109942678281, 'auprc': 0.9990616139528933, 'loss_val': 0.033882116439437004, 'psi': 0.9980712421418543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=23 head_norm_before_train=1.347110 cos_to_last_merge=0.9712 (last merge round=14)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.766681427452782, 'auprc': 0.912969319618405, 'loss_val': 0.30465425892365877, 'psi': 0.8251965843190312}-{'f1_val': 0.991342663619303, 'auprc': 0.9944409430050763, 'loss_val': 0.11354412207280576, 'psi': 0.9925819753736123}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=1.372741 cos_to_last_merge=0.9404 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.940
[S16] round=23 local utility u=0.136481 metrics={'f1_val': 0.9325165084491058, 'auprc': 0.9794160653388109, 'loss_val': 0.27483969502970806, 'psi': 0.9512763312049879}-{'f1_val': 0.8951094841068863, 'auprc': 0.9627706948077491, 'loss_val': 0.2734235153786422, 'psi': 0.9221739683872314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=23 head_norm_before_train=1.232843 cos_to_last_merge=0.9904 (last merge round=15)
[S17] round=23 local utility u=0.568173 metrics={'f1_val': 0.5742792718856533, 'auprc': 0.9555462988911179, 'loss_val': 0.5873575745717436, 'psi': 0.7267860826878392}-{'f1_val': 0.40574077127736535, 'auprc': 0.9356572390071467, 'loss_val': 0.6528045882803964, 'psi': 0.6177073583692779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=24 head_norm_before_train=1.417308 cos_to_last_merge=0.7396 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.740
[S2] round=24 local utility u=0.000961 metrics={'f1_val': 0.7012105951167499, 'auprc': 0.6672769478748265, 'loss_val': 0.3110309956297237, 'psi': 0.6876371362199805}-{'f1_val': 0.7015719066528542, 'auprc': 0.6667597909985798, 'loss_val': 0.3135702966783615, 'psi': 0.6876470603911444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=24 head_norm_before_train=1.528175 cos_to_last_merge=0.7940 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.794
[S3] round=24 local utility u=0.142054 metrics={'f1_val': 0.6586346619094574, 'auprc': 0.956887165864706, 'loss_val': 0.34187852071020747, 'psi': 0.7779356634915569}-{'f1_val': 0.6351675995376187, 'auprc': 0.9307613702436981, 'loss_val': 0.40680644289304413, 'psi': 0.7534051078200505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=24 head_norm_before_train=1.566482 cos_to_last_merge=0.8433 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.843
[S4] round=24 local utility u=0.013291 metrics={'f1_val': 0.6137247588858484, 'auprc': 0.9527324623388755, 'loss_val': 0.5062446534939946, 'psi': 0.7493278402670593}-{'f1_val': 0.6121313561162147, 'auprc': 0.9503990267300708, 'loss_val': 0.5162663261758723, 'psi': 0.7474384243617571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=24 head_norm_before_train=1.149482 cos_to_last_merge=0.9634 (last merge round=15)
[S5] round=24 local utility u=0.213990 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9860405497033282, 'loss_val': 0.3053832969581916, 'psi': 0.8146085789761467}-{'f1_val': 0.700320598491359, 'auprc': 0.8512646603027239, 'loss_val': 0.3290361617941612, 'psi': 0.760698223215905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=24 head_norm_before_train=1.448791 cos_to_last_merge=0.9849 (last merge round=14)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.9580264102568407, 'auprc': 0.9609785089827818, 'loss_val': 0.24372129460273737, 'psi': 0.9592072497472172}-{'f1_val': 0.9610949668741082, 'auprc': 0.9662123330095, 'loss_val': 0.219093810881985, 'psi': 0.9631419133282649}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=1.381855 cos_to_last_merge=0.9711 (last merge round=12)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.647526687797014, 'auprc': 0.8019229078643226, 'loss_val': 0.5491405388604588, 'psi': 0.7092851758239374}-{'f1_val': 0.6501098878473097, 'auprc': 0.8097035627493402, 'loss_val': 0.5193989798258787, 'psi': 0.7139473578081219}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=24 head_norm_before_train=1.451997 cos_to_last_merge=0.9870 (last merge round=16)
[S8] round=24 local utility u=0.031159 metrics={'f1_val': 0.9937111453033, 'auprc': 0.9986162819202062, 'loss_val': 0.06339707585229269, 'psi': 0.9956731999500624}-{'f1_val': 0.9931489740885844, 'auprc': 0.9900055796620243, 'loss_val': 0.09651052659071194, 'psi': 0.9918916163179604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=24 head_norm_before_train=1.892922 (no previous merge yet)
[S9] round=24 local utility u=0.025172 metrics={'f1_val': 0.9933237369199828, 'auprc': 0.9986368538585736, 'loss_val': 0.032525695220894324, 'psi': 0.995448983695419}-{'f1_val': 0.9876029063437939, 'auprc': 0.9986976068817819, 'loss_val': 0.04872710146811234, 'psi': 0.9920407865589891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=24 head_norm_before_train=1.616189 cos_to_last_merge=0.9652 (last merge round=13)
[S10] round=24 local utility u=0.002268 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9951992772506939, 'loss_val': 0.053085523721669255, 'psi': 0.9951667423806957}-{'f1_val': 0.9951450524673635, 'auprc': 0.9960669132511233, 'loss_val': 0.06022388207901904, 'psi': 0.9955137967808674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=24 head_norm_before_train=1.152754 cos_to_last_merge=0.9659 (last merge round=14)
[S11] round=24 local utility u=0.008443 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9060776493794777, 'loss_val': 0.2806423349486004, 'psi': 0.7835922497307831}-{'f1_val': 0.7019353166316534, 'auprc': 0.9017327780700158, 'loss_val': 0.2844945192543774, 'psi': 0.7818543012069984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=24 head_norm_before_train=1.129349 cos_to_last_merge=0.8758 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.876
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5935409653136408, 'auprc': 0.683721846064466, 'loss_val': 0.7509897042057267, 'psi': 0.6296133176139709}-{'f1_val': 0.6359660562315795, 'auprc': 0.6675520192841692, 'loss_val': 0.5559844244227558, 'psi': 0.6486004414526154}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=1.776283 cos_to_last_merge=0.9855 (last merge round=14)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9957218763831894, 'auprc': 0.9991648581141104, 'loss_val': 0.03908968683456266, 'psi': 0.9970990690755578}-{'f1_val': 0.9971907882668205, 'auprc': 0.999105276502278, 'loss_val': 0.032310529713663855, 'psi': 0.9979565835610036}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=24 head_norm_before_train=1.374644 cos_to_last_merge=0.9680 (last merge round=14)
[S15] round=24 local utility u=0.912171 metrics={'f1_val': 0.9937560907415754, 'auprc': 0.9942119596969483, 'loss_val': 0.08648735839717929, 'psi': 0.9939384383237246}-{'f1_val': 0.766681427452782, 'auprc': 0.912969319618405, 'loss_val': 0.30465425892365877, 'psi': 0.8251965843190312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=24 head_norm_before_train=1.405307 cos_to_last_merge=0.9354 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.935
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8359254534762751, 'auprc': 0.9309426496852319, 'loss_val': 0.7853352185142671, 'psi': 0.8739323319598578}-{'f1_val': 0.9325165084491058, 'auprc': 0.9794160653388109, 'loss_val': 0.27483969502970806, 'psi': 0.9512763312049879}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=24 head_norm_before_train=1.246869 cos_to_last_merge=0.9883 (last merge round=15)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.365053875177412, 'auprc': 0.7291109406632639, 'loss_val': 1.1232768099779407, 'psi': 0.5106767013717527}-{'f1_val': 0.5742792718856533, 'auprc': 0.9555462988911179, 'loss_val': 0.5873575745717436, 'psi': 0.7267860826878392}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=25 head_norm_before_train=1.434253 cos_to_last_merge=0.7386 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.739
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.7013912449526117, 'auprc': 0.6697239274772203, 'loss_val': 0.33295537647678475, 'psi': 0.6887243179624551}-{'f1_val': 0.7012105951167499, 'auprc': 0.6672769478748265, 'loss_val': 0.3110309956297237, 'psi': 0.6876371362199805}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=25 head_norm_before_train=1.543879 cos_to_last_merge=0.7923 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.792
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.6360695731283967, 'auprc': 0.9390689371536587, 'loss_val': 0.37751315967791754, 'psi': 0.7572693187385016}-{'f1_val': 0.6586346619094574, 'auprc': 0.956887165864706, 'loss_val': 0.34187852071020747, 'psi': 0.7779356634915569}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=1.584270 cos_to_last_merge=0.8420 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.842
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.6128961326899692, 'auprc': 0.9481390498281297, 'loss_val': 0.5052017979960364, 'psi': 0.7469932995452334}-{'f1_val': 0.6137247588858484, 'auprc': 0.9527324623388755, 'loss_val': 0.5062446534939946, 'psi': 0.7493278402670593}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=25 head_norm_before_train=1.178990 cos_to_last_merge=0.9590 (last merge round=15)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9266505873257714, 'loss_val': 0.3067209752783003, 'psi': 0.790852594025124}-{'f1_val': 0.700320598491359, 'auprc': 0.9860405497033282, 'loss_val': 0.3053832969581916, 'psi': 0.8146085789761467}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=1.459858 cos_to_last_merge=0.9834 (last merge round=14)
[S6] round=25 local utility u=0.058211 metrics={'f1_val': 0.962776198561167, 'auprc': 0.972006173985339, 'loss_val': 0.1888801241171091, 'psi': 0.9664681887308357}-{'f1_val': 0.9580264102568407, 'auprc': 0.9609785089827818, 'loss_val': 0.24372129460273737, 'psi': 0.9592072497472172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=25 head_norm_before_train=1.390685 cos_to_last_merge=0.9698 (last merge round=12)
[S7] round=25 local utility u=0.256301 metrics={'f1_val': 0.6877715652606597, 'auprc': 0.8439291549126664, 'loss_val': 0.40402563038375294, 'psi': 0.7502346011214625}-{'f1_val': 0.647526687797014, 'auprc': 0.8019229078643226, 'loss_val': 0.5491405388604588, 'psi': 0.7092851758239374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=25 head_norm_before_train=1.486775 cos_to_last_merge=0.9847 (last merge round=16)
[S8] round=25 local utility u=0.003036 metrics={'f1_val': 0.9931808101287989, 'auprc': 0.9989706338948607, 'loss_val': 0.055207012252391496, 'psi': 0.9954967396352237}-{'f1_val': 0.9937111453033, 'auprc': 0.9986162819202062, 'loss_val': 0.06339707585229269, 'psi': 0.9956731999500624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=25 head_norm_before_train=1.905653 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9984669964975255, 'loss_val': 0.033953824316443386, 'psi': 0.9937179218076062}-{'f1_val': 0.9933237369199828, 'auprc': 0.9986368538585736, 'loss_val': 0.032525695220894324, 'psi': 0.995448983695419}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=25 head_norm_before_train=1.645077 cos_to_last_merge=0.9608 (last merge round=13)
[S10] round=25 local utility u=0.003833 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9961527157076762, 'loss_val': 0.04696225138424917, 'psi': 0.9954164089272204}-{'f1_val': 0.9951450524673635, 'auprc': 0.9951992772506939, 'loss_val': 0.053085523721669255, 'psi': 0.9951667423806957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=25 head_norm_before_train=1.170449 cos_to_last_merge=0.9629 (last merge round=14)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.696194092126051, 'auprc': 0.9108104247813069, 'loss_val': 0.2933876552878538, 'psi': 0.7820406251881533}-{'f1_val': 0.7019353166316534, 'auprc': 0.9060776493794777, 'loss_val': 0.2806423349486004, 'psi': 0.7835922497307831}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=25 head_norm_before_train=1.148183 cos_to_last_merge=0.8703 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.870
[S13] round=25 local utility u=0.137623 metrics={'f1_val': 0.6309205582494932, 'auprc': 0.6604425460662504, 'loss_val': 0.6301830734307066, 'psi': 0.6427293533761961}-{'f1_val': 0.5935409653136408, 'auprc': 0.683721846064466, 'loss_val': 0.7509897042057267, 'psi': 0.6296133176139709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=25 head_norm_before_train=1.798940 cos_to_last_merge=0.9842 (last merge round=14)
[S14] round=25 local utility u=0.008653 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9991626630364085, 'loss_val': 0.0318792208137769, 'psi': 0.998108383046154}-{'f1_val': 0.9957218763831894, 'auprc': 0.9991648581141104, 'loss_val': 0.03908968683456266, 'psi': 0.9970990690755578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=25 head_norm_before_train=1.403452 cos_to_last_merge=0.9643 (last merge round=14)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.9168076008460757, 'auprc': 0.9910987178514643, 'loss_val': 0.11931082067065991, 'psi': 0.9465240476482312}-{'f1_val': 0.9937560907415754, 'auprc': 0.9942119596969483, 'loss_val': 0.08648735839717929, 'psi': 0.9939384383237246}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=25 head_norm_before_train=1.436784 cos_to_last_merge=0.9305 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.930
[S16] round=25 local utility u=0.091425 metrics={'f1_val': 0.8397508425124999, 'auprc': 0.9762735494117352, 'loss_val': 0.7614302675574556, 'psi': 0.894359925272194}-{'f1_val': 0.8359254534762751, 'auprc': 0.9309426496852319, 'loss_val': 0.7853352185142671, 'psi': 0.8739323319598578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=25 head_norm_before_train=1.264742 cos_to_last_merge=0.9854 (last merge round=15)
[S17] round=25 local utility u=0.204431 metrics={'f1_val': 0.394472190231481, 'auprc': 0.811598429263478, 'loss_val': 1.1383872488685853, 'psi': 0.5613226858442799}-{'f1_val': 0.365053875177412, 'auprc': 0.7291109406632639, 'loss_val': 1.1232768099779407, 'psi': 0.5106767013717527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=26 head_norm_before_train=1.449808 cos_to_last_merge=0.7380 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.738
[S2] round=26 local utility u=0.012101 metrics={'f1_val': 0.7034965585623785, 'auprc': 0.6707261212614875, 'loss_val': 0.32439128728232836, 'psi': 0.690388383642022}-{'f1_val': 0.7013912449526117, 'auprc': 0.6697239274772203, 'loss_val': 0.33295537647678475, 'psi': 0.6887243179624551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=26 head_norm_before_train=1.557206 cos_to_last_merge=0.7907 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.791
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.613303385834324, 'auprc': 0.9348030490535226, 'loss_val': 0.40221223763678743, 'psi': 0.7419032511220034}-{'f1_val': 0.6360695731283967, 'auprc': 0.9390689371536587, 'loss_val': 0.37751315967791754, 'psi': 0.7572693187385016}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.594763 cos_to_last_merge=0.8416 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.842
[S4] round=26 local utility u=0.024919 metrics={'f1_val': 0.6148379130558633, 'auprc': 0.9531912594114855, 'loss_val': 0.4821720896755231, 'psi': 0.7501792515981123}-{'f1_val': 0.6128961326899692, 'auprc': 0.9481390498281297, 'loss_val': 0.5052017979960364, 'psi': 0.7469932995452334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=26 head_norm_before_train=1.204861 cos_to_last_merge=0.9551 (last merge round=15)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.700450568094382, 'auprc': 0.8858098993313727, 'loss_val': 0.331847795789733, 'psi': 0.7745943005891782}-{'f1_val': 0.700320598491359, 'auprc': 0.9266505873257714, 'loss_val': 0.3067209752783003, 'psi': 0.790852594025124}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=26 head_norm_before_train=1.469314 cos_to_last_merge=0.9822 (last merge round=14)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.7973219804624553, 'auprc': 0.9663875129072825, 'loss_val': 0.2455188740741642, 'psi': 0.8649481934403862}-{'f1_val': 0.962776198561167, 'auprc': 0.972006173985339, 'loss_val': 0.1888801241171091, 'psi': 0.9664681887308357}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=1.402222 cos_to_last_merge=0.9681 (last merge round=12)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.6851607102582201, 'auprc': 0.8412263182502229, 'loss_val': 0.4145590698254492, 'psi': 0.7475869534550212}-{'f1_val': 0.6877715652606597, 'auprc': 0.8439291549126664, 'loss_val': 0.40402563038375294, 'psi': 0.7502346011214625}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.518143 cos_to_last_merge=0.9823 (last merge round=16)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9935252750776847, 'auprc': 0.9893920749505156, 'loss_val': 0.06268540134720553, 'psi': 0.9918719950268171}-{'f1_val': 0.9931808101287989, 'auprc': 0.9989706338948607, 'loss_val': 0.055207012252391496, 'psi': 0.9954967396352237}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=26 head_norm_before_train=1.917691 (no previous merge yet)
[S9] round=26 local utility u=0.018176 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9955156702010053, 'loss_val': 0.02539977912131463, 'psi': 0.996202575168737}-{'f1_val': 0.9905518720143266, 'auprc': 0.9984669964975255, 'loss_val': 0.033953824316443386, 'psi': 0.9937179218076062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=26 head_norm_before_train=1.674878 cos_to_last_merge=0.9566 (last merge round=13)
[S10] round=26 local utility u=0.000609 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9951223146121014, 'loss_val': 0.043970245969370755, 'psi': 0.9951359573252587}-{'f1_val': 0.9949255377402499, 'auprc': 0.9961527157076762, 'loss_val': 0.04696225138424917, 'psi': 0.9954164089272204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=26 head_norm_before_train=1.189166 cos_to_last_merge=0.9598 (last merge round=14)
[S11] round=26 local utility u=0.030440 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9127063837651039, 'loss_val': 0.27264337729654065, 'psi': 0.7862437434850336}-{'f1_val': 0.696194092126051, 'auprc': 0.9108104247813069, 'loss_val': 0.2933876552878538, 'psi': 0.7820406251881533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=26 head_norm_before_train=1.165054 cos_to_last_merge=0.8651 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.865
[S13] round=26 local utility u=0.017011 metrics={'f1_val': 0.6448101641806652, 'auprc': 0.6360427541566471, 'loss_val': 0.6062988000097458, 'psi': 0.6413032001710579}-{'f1_val': 0.6309205582494932, 'auprc': 0.6604425460662504, 'loss_val': 0.6301830734307066, 'psi': 0.6427293533761961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=26 head_norm_before_train=1.815683 cos_to_last_merge=0.9833 (last merge round=14)
[S14] round=26 local utility u=0.003549 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9991504174132771, 'loss_val': 0.027241331607310546, 'psi': 0.9983532225779663}-{'f1_val': 0.9974055297193176, 'auprc': 0.9991626630364085, 'loss_val': 0.0318792208137769, 'psi': 0.998108383046154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=26 head_norm_before_train=1.426691 cos_to_last_merge=0.9612 (last merge round=14)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.8583348527605488, 'auprc': 0.9292687721230368, 'loss_val': 0.2610211307795014, 'psi': 0.886708420505544}-{'f1_val': 0.9168076008460757, 'auprc': 0.9910987178514643, 'loss_val': 0.11931082067065991, 'psi': 0.9465240476482312}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=1.466605 cos_to_last_merge=0.9259 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.926
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8347765316130068, 'auprc': 0.9315187213331527, 'loss_val': 0.8491295352015773, 'psi': 0.8734734075010652}-{'f1_val': 0.8397508425124999, 'auprc': 0.9762735494117352, 'loss_val': 0.7614302675574556, 'psi': 0.894359925272194}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=1.286721 cos_to_last_merge=0.9825 (last merge round=15)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.26181809384651744, 'auprc': 0.6574286686079098, 'loss_val': 1.4441595704716303, 'psi': 0.42006232375107444}-{'f1_val': 0.394472190231481, 'auprc': 0.811598429263478, 'loss_val': 1.1383872488685853, 'psi': 0.5613226858442799}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=27 head_norm_before_train=1.463442 cos_to_last_merge=0.7373 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.737
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6685519385816971, 'auprc': 0.6725292974144895, 'loss_val': 0.3315261611892763, 'psi': 0.6701428821148141}-{'f1_val': 0.7034965585623785, 'auprc': 0.6707261212614875, 'loss_val': 0.32439128728232836, 'psi': 0.690388383642022}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=27 head_norm_before_train=1.571458 cos_to_last_merge=0.7892 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.789
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.5355236151410893, 'auprc': 0.8955690280360118, 'loss_val': 0.5396865939521326, 'psi': 0.6795417802990582}-{'f1_val': 0.613303385834324, 'auprc': 0.9348030490535226, 'loss_val': 0.40221223763678743, 'psi': 0.7419032511220034}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=1.606275 cos_to_last_merge=0.8412 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.841
[S4] round=27 local utility u=0.987735 metrics={'f1_val': 0.953049993028799, 'auprc': 0.9391721073337422, 'loss_val': 0.493916931328129, 'psi': 0.9474988387507762}-{'f1_val': 0.6148379130558633, 'auprc': 0.9531912594114855, 'loss_val': 0.4821720896755231, 'psi': 0.7501792515981123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S5] START round=27 head_norm_before_train=1.224176 cos_to_last_merge=0.9519 (last merge round=15)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.6515481973756816, 'auprc': 0.852616537629823, 'loss_val': 0.4208364547238393, 'psi': 0.7319755334773381}-{'f1_val': 0.700450568094382, 'auprc': 0.8858098993313727, 'loss_val': 0.331847795789733, 'psi': 0.7745943005891782}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=1.479086 cos_to_last_merge=0.9813 (last merge round=14)
[S6] round=27 local utility u=0.562307 metrics={'f1_val': 0.9617701938233608, 'auprc': 0.9860030889740943, 'loss_val': 0.16644060234402097, 'psi': 0.9714633518836542}-{'f1_val': 0.7973219804624553, 'auprc': 0.9663875129072825, 'loss_val': 0.2455188740741642, 'psi': 0.8649481934403862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=27 head_norm_before_train=1.410988 cos_to_last_merge=0.9668 (last merge round=12)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5549382680132536, 'auprc': 0.7854128394073647, 'loss_val': 0.7882420165925197, 'psi': 0.6471280965708981}-{'f1_val': 0.6851607102582201, 'auprc': 0.8412263182502229, 'loss_val': 0.4145590698254492, 'psi': 0.7475869534550212}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=27 head_norm_before_train=1.545535 cos_to_last_merge=0.9801 (last merge round=16)
[S8] round=27 local utility u=0.013239 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9989295696705174, 'loss_val': 0.05235726171591734, 'psi': 0.994440770794043}-{'f1_val': 0.9935252750776847, 'auprc': 0.9893920749505156, 'loss_val': 0.06268540134720553, 'psi': 0.9918719950268171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=27 head_norm_before_train=1.928978 (no previous merge yet)
[S9] round=27 local utility u=0.003535 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9984628463459795, 'loss_val': 0.02566967610591617, 'psi': 0.9972312499387244}-{'f1_val': 0.9966605118138915, 'auprc': 0.9955156702010053, 'loss_val': 0.02539977912131463, 'psi': 0.996202575168737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=27 head_norm_before_train=1.703360 cos_to_last_merge=0.9530 (last merge round=13)
[S10] round=27 local utility u=0.001377 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9949760741888447, 'loss_val': 0.04077706655841214, 'psi': 0.995077461155956}-{'f1_val': 0.9951450524673635, 'auprc': 0.9951223146121014, 'loss_val': 0.043970245969370755, 'psi': 0.9951359573252587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=27 head_norm_before_train=1.208571 cos_to_last_merge=0.9576 (last merge round=14)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.696194092126051, 'auprc': 0.923490145836106, 'loss_val': 0.28626923101431306, 'psi': 0.787112513610073}-{'f1_val': 0.7019353166316534, 'auprc': 0.9127063837651039, 'loss_val': 0.27264337729654065, 'psi': 0.7862437434850336}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=1.176923 cos_to_last_merge=0.8616 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.862
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5650812209665176, 'auprc': 0.6916666033593012, 'loss_val': 0.9047978911545983, 'psi': 0.615715373923631}-{'f1_val': 0.6448101641806652, 'auprc': 0.6360427541566471, 'loss_val': 0.6062988000097458, 'psi': 0.6413032001710579}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=1.831729 cos_to_last_merge=0.9824 (last merge round=14)
[S14] round=27 local utility u=0.000854 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9991608392545106, 'loss_val': 0.025565051462114022, 'psi': 0.9983573913144597}-{'f1_val': 0.9978217593544257, 'auprc': 0.9991504174132771, 'loss_val': 0.027241331607310546, 'psi': 0.9983532225779663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] sending update (kind=head size=1791 to 1 peers)
[S15] START round=27 head_norm_before_train=1.445217 cos_to_last_merge=0.9586 (last merge round=14)
[S15] round=27 local utility u=0.562996 metrics={'f1_val': 0.9873522911060467, 'auprc': 0.9908458796394144, 'loss_val': 0.09386504041876541, 'psi': 0.9887497265193939}-{'f1_val': 0.8583348527605488, 'auprc': 0.9292687721230368, 'loss_val': 0.2610211307795014, 'psi': 0.886708420505544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=27 head_norm_before_train=1.493889 cos_to_last_merge=0.9218 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.922
[S16] round=27 local utility u=0.068769 metrics={'f1_val': 0.8467716291472913, 'auprc': 0.9268573559446535, 'loss_val': 0.7695777296373009, 'psi': 0.8788059198662362}-{'f1_val': 0.8347765316130068, 'auprc': 0.9315187213331527, 'loss_val': 0.8491295352015773, 'psi': 0.8734734075010652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=27 head_norm_before_train=1.304600 cos_to_last_merge=0.9802 (last merge round=15)
[S17] round=27 local utility u=0.708682 metrics={'f1_val': 0.3969728763978249, 'auprc': 0.7107381059720222, 'loss_val': 0.9976527459202861, 'psi': 0.5224789682275038}-{'f1_val': 0.26181809384651744, 'auprc': 0.6574286686079098, 'loss_val': 1.4441595704716303, 'psi': 0.42006232375107444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=28 head_norm_before_train=1.477283 cos_to_last_merge=0.7367 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.737
[S2] round=28 local utility u=0.321306 metrics={'f1_val': 0.7058646760394738, 'auprc': 0.8026634077973714, 'loss_val': 0.3031938820994528, 'psi': 0.7445841687426329}-{'f1_val': 0.6685519385816971, 'auprc': 0.6725292974144895, 'loss_val': 0.3315261611892763, 'psi': 0.6701428821148141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=28 head_norm_before_train=1.589886 cos_to_last_merge=0.7880 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.788
[S3] round=28 local utility u=0.442663 metrics={'f1_val': 0.6027282806516893, 'auprc': 0.9919190684340912, 'loss_val': 0.346639606202448, 'psi': 0.75840459576465}-{'f1_val': 0.5355236151410893, 'auprc': 0.8955690280360118, 'loss_val': 0.5396865939521326, 'psi': 0.6795417802990582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=28 head_norm_before_train=1.614266 cos_to_last_merge=0.8408 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.841
[S4] round=28 local utility u=0.031643 metrics={'f1_val': 0.9565406091669869, 'auprc': 0.9457867642486972, 'loss_val': 0.4714194101943033, 'psi': 0.952239071199671}-{'f1_val': 0.953049993028799, 'auprc': 0.9391721073337422, 'loss_val': 0.493916931328129, 'psi': 0.9474988387507762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S5] START round=28 head_norm_before_train=1.241020 cos_to_last_merge=0.9493 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.949
[S5] round=28 local utility u=0.282394 metrics={'f1_val': 0.689534807978826, 'auprc': 0.9308139137033544, 'loss_val': 0.3185596071698401, 'psi': 0.7860464502686374}-{'f1_val': 0.6515481973756816, 'auprc': 0.852616537629823, 'loss_val': 0.4208364547238393, 'psi': 0.7319755334773381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=28 head_norm_before_train=1.484934 cos_to_last_merge=0.9801 (last merge round=14)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.8235005204902279, 'auprc': 0.9521683112119746, 'loss_val': 0.3507273675091647, 'psi': 0.8749676367789266}-{'f1_val': 0.9617701938233608, 'auprc': 0.9860030889740943, 'loss_val': 0.16644060234402097, 'psi': 0.9714633518836542}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.417363 cos_to_last_merge=0.9659 (last merge round=12)
[S7] round=28 local utility u=0.687466 metrics={'f1_val': 0.6888159304116217, 'auprc': 0.8439676886051225, 'loss_val': 0.39224063411027665, 'psi': 0.750876633689022}-{'f1_val': 0.5549382680132536, 'auprc': 0.7854128394073647, 'loss_val': 0.7882420165925197, 'psi': 0.6471280965708981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=28 head_norm_before_train=1.569207 cos_to_last_merge=0.9784 (last merge round=16)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9871891468768156, 'auprc': 0.9894378314521526, 'loss_val': 0.07603454205492066, 'psi': 0.9880886207069504}-{'f1_val': 0.9914482382097267, 'auprc': 0.9989295696705174, 'loss_val': 0.05235726171591734, 'psi': 0.994440770794043}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=1.940440 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9988383455942905, 'loss_val': 0.02685677255816994, 'psi': 0.9958812025733879}-{'f1_val': 0.9964101856672208, 'auprc': 0.9984628463459795, 'loss_val': 0.02566967610591617, 'psi': 0.9972312499387244}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.729507 cos_to_last_merge=0.9503 (last merge round=13)
[S10] round=28 local utility u=0.002133 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9956465152506154, 'loss_val': 0.03852151988227519, 'psi': 0.9953456375806643}-{'f1_val': 0.9951450524673635, 'auprc': 0.9949760741888447, 'loss_val': 0.04077706655841214, 'psi': 0.995077461155956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=28 head_norm_before_train=1.226153 cos_to_last_merge=0.9552 (last merge round=14)
[S11] round=28 local utility u=0.064659 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9486068463497142, 'loss_val': 0.26674798774721425, 'psi': 0.8006039285188777}-{'f1_val': 0.696194092126051, 'auprc': 0.923490145836106, 'loss_val': 0.28626923101431306, 'psi': 0.787112513610073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=28 head_norm_before_train=1.186646 cos_to_last_merge=0.8593 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.859
[S13] round=28 local utility u=0.223175 metrics={'f1_val': 0.6140971033196717, 'auprc': 0.6694902854175211, 'loss_val': 0.6860132791981916, 'psi': 0.6362543761588115}-{'f1_val': 0.5650812209665176, 'auprc': 0.6916666033593012, 'loss_val': 0.9047978911545983, 'psi': 0.615715373923631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=28 head_norm_before_train=1.849270 cos_to_last_merge=0.9813 (last merge round=14)
[S14] round=28 local utility u=0.000869 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9991583730516609, 'loss_val': 0.02381959662591415, 'psi': 0.9983564048333198}-{'f1_val': 0.9978217593544257, 'auprc': 0.9991608392545106, 'loss_val': 0.025565051462114022, 'psi': 0.9983573913144597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=28 head_norm_before_train=1.464859 cos_to_last_merge=0.9557 (last merge round=14)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.6950704036154491, 'auprc': 0.7887837117513619, 'loss_val': 0.5249318686349205, 'psi': 0.7325557268698142}-{'f1_val': 0.9873522911060467, 'auprc': 0.9908458796394144, 'loss_val': 0.09386504041876541, 'psi': 0.9887497265193939}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=1.518096 cos_to_last_merge=0.9181 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.918
[S16] round=28 local utility u=0.097607 metrics={'f1_val': 0.8342190946478807, 'auprc': 0.9456673443013781, 'loss_val': 0.5554792304755971, 'psi': 0.8787983945092797}-{'f1_val': 0.8467716291472913, 'auprc': 0.9268573559446535, 'loss_val': 0.7695777296373009, 'psi': 0.8788059198662362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=28 head_norm_before_train=1.317463 cos_to_last_merge=0.9785 (last merge round=15)
[S17] round=28 local utility u=0.127637 metrics={'f1_val': 0.41107759333804633, 'auprc': 0.7314078425281524, 'loss_val': 0.8890167900207817, 'psi': 0.5392096930140887}-{'f1_val': 0.3969728763978249, 'auprc': 0.7107381059720222, 'loss_val': 0.9976527459202861, 'psi': 0.5224789682275038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=29 head_norm_before_train=1.489332 cos_to_last_merge=0.7363 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.736
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.707126632467362, 'auprc': 0.7751081296619705, 'loss_val': 0.31261896483859913, 'psi': 0.7343192313452054}-{'f1_val': 0.7058646760394738, 'auprc': 0.8026634077973714, 'loss_val': 0.3031938820994528, 'psi': 0.7445841687426329}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=1.610729 cos_to_last_merge=0.7863 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.786
[S3] round=29 local utility u=1.000000 metrics={'f1_val': 0.9878900958715815, 'auprc': 0.9967139010634796, 'loss_val': 0.134254260694846, 'psi': 0.9914196179483407}-{'f1_val': 0.6027282806516893, 'auprc': 0.9919190684340912, 'loss_val': 0.346639606202448, 'psi': 0.75840459576465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=29 head_norm_before_train=1.619649 cos_to_last_merge=0.8406 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.841
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.8479221405252195, 'auprc': 0.9446301680819119, 'loss_val': 0.468541051171752, 'psi': 0.8866053515478964}-{'f1_val': 0.9565406091669869, 'auprc': 0.9457867642486972, 'loss_val': 0.4714194101943033, 'psi': 0.952239071199671}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.258143 cos_to_last_merge=0.9472 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.947
[S5] round=29 local utility u=0.104603 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9679333488901982, 'loss_val': 0.28542681147419874, 'psi': 0.8073656986508947}-{'f1_val': 0.689534807978826, 'auprc': 0.9308139137033544, 'loss_val': 0.3185596071698401, 'psi': 0.7860464502686374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=29 head_norm_before_train=1.491306 cos_to_last_merge=0.9793 (last merge round=14)
[S6] round=29 local utility u=0.550629 metrics={'f1_val': 0.9622791911540107, 'auprc': 0.9823280842613487, 'loss_val': 0.17262131088558796, 'psi': 0.9702987483969459}-{'f1_val': 0.8235005204902279, 'auprc': 0.9521683112119746, 'loss_val': 0.3507273675091647, 'psi': 0.8749676367789266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=29 head_norm_before_train=1.423603 cos_to_last_merge=0.9649 (last merge round=12)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.6466763702842409, 'auprc': 0.8037595809251874, 'loss_val': 0.5371160726557023, 'psi': 0.7095096545406194}-{'f1_val': 0.6888159304116217, 'auprc': 0.8439676886051225, 'loss_val': 0.39224063411027665, 'psi': 0.750876633689022}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=29 head_norm_before_train=1.591474 cos_to_last_merge=0.9769 (last merge round=16)
[S8] round=29 local utility u=0.047056 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9986759162298372, 'loss_val': 0.043865835048618726, 'psi': 0.9952066899709041}-{'f1_val': 0.9871891468768156, 'auprc': 0.9894378314521526, 'loss_val': 0.07603454205492066, 'psi': 0.9880886207069504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=29 head_norm_before_train=1.953486 (no previous merge yet)
[S9] round=29 local utility u=0.001608 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9988403176635408, 'loss_val': 0.026327713885579286, 'psi': 0.9961501205831065}-{'f1_val': 0.993909773892786, 'auprc': 0.9988383455942905, 'loss_val': 0.02685677255816994, 'psi': 0.9958812025733879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=29 head_norm_before_train=1.753714 cos_to_last_merge=0.9477 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=29 local utility u=0.000801 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9956647884602097, 'loss_val': 0.03697482735324324, 'psi': 0.9953529468645019}-{'f1_val': 0.9951450524673635, 'auprc': 0.9956465152506154, 'loss_val': 0.03852151988227519, 'psi': 0.9953456375806643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=29 head_norm_before_train=1.243288 cos_to_last_merge=0.9527 (last merge round=14)
[S11] round=29 local utility u=0.070725 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.994890793543288, 'loss_val': 0.26415009171623327, 'psi': 0.8191175073963073}-{'f1_val': 0.7019353166316534, 'auprc': 0.9486068463497142, 'loss_val': 0.26674798774721425, 'psi': 0.8006039285188777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=29 head_norm_before_train=1.194617 cos_to_last_merge=0.8576 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.858
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.6096136357620329, 'auprc': 0.683872104691214, 'loss_val': 0.707010279757202, 'psi': 0.6393170233337053}-{'f1_val': 0.6140971033196717, 'auprc': 0.6694902854175211, 'loss_val': 0.6860132791981916, 'psi': 0.6362543761588115}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=29 head_norm_before_train=1.867298 cos_to_last_merge=0.9802 (last merge round=14)
[S14] round=29 local utility u=0.000667 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9991657643155587, 'loss_val': 0.02250774337155883, 'psi': 0.9983593613388789}-{'f1_val': 0.9978217593544257, 'auprc': 0.9991583730516609, 'loss_val': 0.02381959662591415, 'psi': 0.9983564048333198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] sending update (kind=head size=1790 to 1 peers)
[S15] START round=29 head_norm_before_train=1.482337 cos_to_last_merge=0.9534 (last merge round=14)
[S15] round=29 local utility u=1.000000 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.9924110792946925, 'loss_val': 0.06188897500096065, 'psi': 0.9949362229319094}-{'f1_val': 0.6950704036154491, 'auprc': 0.7887837117513619, 'loss_val': 0.5249318686349205, 'psi': 0.7325557268698142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=29 head_norm_before_train=1.539696 cos_to_last_merge=0.9150 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.915
[S16] round=29 local utility u=0.237634 metrics={'f1_val': 0.8831401472046267, 'auprc': 0.9931898224008187, 'loss_val': 0.5163049941421166, 'psi': 0.9271600172831035}-{'f1_val': 0.8342190946478807, 'auprc': 0.9456673443013781, 'loss_val': 0.5554792304755971, 'psi': 0.8787983945092797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=29 head_norm_before_train=1.332752 cos_to_last_merge=0.9763 (last merge round=15)
[S17] round=29 local utility u=0.230456 metrics={'f1_val': 0.44065231902434365, 'auprc': 0.7646875064392125, 'loss_val': 0.7053912466453165, 'psi': 0.5702663939902912}-{'f1_val': 0.41107759333804633, 'auprc': 0.7314078425281524, 'loss_val': 0.8890167900207817, 'psi': 0.5392096930140887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=30 head_norm_before_train=1.503317 cos_to_last_merge=0.7354 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.735
[S2] round=30 local utility u=0.174300 metrics={'f1_val': 0.7074884569587803, 'auprc': 0.8995924467722556, 'loss_val': 0.339643654107492, 'psi': 0.7843300528841703}-{'f1_val': 0.707126632467362, 'auprc': 0.7751081296619705, 'loss_val': 0.31261896483859913, 'psi': 0.7343192313452054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=30 head_norm_before_train=1.633451 cos_to_last_merge=0.7845 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.784
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9601864874536103, 'auprc': 0.9985128277219256, 'loss_val': 0.12372084565859977, 'psi': 0.9755170235609365}-{'f1_val': 0.9878900958715815, 'auprc': 0.9967139010634796, 'loss_val': 0.134254260694846, 'psi': 0.9914196179483407}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.624309 cos_to_last_merge=0.8402 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.840
[S4] round=30 local utility u=0.299033 metrics={'f1_val': 0.9507667775701145, 'auprc': 0.9367561003452751, 'loss_val': 0.4639201798776071, 'psi': 0.9451625066801788}-{'f1_val': 0.8479221405252195, 'auprc': 0.9446301680819119, 'loss_val': 0.468541051171752, 'psi': 0.8866053515478964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=30 head_norm_before_train=1.273242 cos_to_last_merge=0.9455 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.945
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.6659240732175079, 'auprc': 0.8506635982492313, 'loss_val': 0.36854726250080455, 'psi': 0.7398198832301972}-{'f1_val': 0.700320598491359, 'auprc': 0.9679333488901982, 'loss_val': 0.28542681147419874, 'psi': 0.8073656986508947}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.497448 cos_to_last_merge=0.9791 (last merge round=14)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.7530144872900983, 'auprc': 0.9579820532616087, 'loss_val': 0.25807044880227786, 'psi': 0.8350015136787025}-{'f1_val': 0.9622791911540107, 'auprc': 0.9823280842613487, 'loss_val': 0.17262131088558796, 'psi': 0.9702987483969459}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.434701 cos_to_last_merge=0.9633 (last merge round=12)
[S7] round=30 local utility u=0.042461 metrics={'f1_val': 0.653643325745571, 'auprc': 0.8075418310626223, 'loss_val': 0.5053419103773314, 'psi': 0.7152027278723916}-{'f1_val': 0.6466763702842409, 'auprc': 0.8037595809251874, 'loss_val': 0.5371160726557023, 'psi': 0.7095096545406194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=30 head_norm_before_train=1.608979 cos_to_last_merge=0.9756 (last merge round=16)
[S8] round=30 local utility u=0.003847 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9983177022746196, 'loss_val': 0.04120663349180313, 'psi': 0.9956744457768558}-{'f1_val': 0.9928938724649488, 'auprc': 0.9986759162298372, 'loss_val': 0.043865835048618726, 'psi': 0.9952066899709041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=30 head_norm_before_train=1.966142 (no previous merge yet)
[S9] round=30 local utility u=0.011401 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992091298977814, 'loss_val': 0.021110446206273156, 'psi': 0.9979453994663983}-{'f1_val': 0.994356655862817, 'auprc': 0.9988403176635408, 'loss_val': 0.026327713885579286, 'psi': 0.9961501205831065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=30 head_norm_before_train=1.772674 cos_to_last_merge=0.9457 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.946
[S10] round=30 local utility u=0.000521 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9958488934003515, 'loss_val': 0.03516805275971575, 'psi': 0.9952948800042907}-{'f1_val': 0.9951450524673635, 'auprc': 0.9956647884602097, 'loss_val': 0.03697482735324324, 'psi': 0.9953529468645019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=30 head_norm_before_train=1.259576 cos_to_last_merge=0.9504 (last merge round=14)
[S11] round=30 local utility u=0.007102 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.998773836544817, 'loss_val': 0.26159562885955595, 'psi': 0.8206707245969189}-{'f1_val': 0.7019353166316534, 'auprc': 0.994890793543288, 'loss_val': 0.26415009171623327, 'psi': 0.8191175073963073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=30 head_norm_before_train=1.205356 cos_to_last_merge=0.8546 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.855
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.600318354435339, 'auprc': 0.6833781422144729, 'loss_val': 0.742294485782441, 'psi': 0.6335422695469926}-{'f1_val': 0.6096136357620329, 'auprc': 0.683872104691214, 'loss_val': 0.707010279757202, 'psi': 0.6393170233337053}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.879005 cos_to_last_merge=0.9795 (last merge round=14)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9961605687915402, 'auprc': 0.9991721897689925, 'loss_val': 0.029870968537940724, 'psi': 0.9973652171825211}-{'f1_val': 0.9978217593544257, 'auprc': 0.9991657643155587, 'loss_val': 0.02250774337155883, 'psi': 0.9983593613388789}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=1.497409 cos_to_last_merge=0.9517 (last merge round=14)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.9950761755130024, 'auprc': 0.9937850645202303, 'loss_val': 0.061215960060801565, 'psi': 0.9945597311158936}-{'f1_val': 0.9966196520233872, 'auprc': 0.9924110792946925, 'loss_val': 0.06188897500096065, 'psi': 0.9949362229319094}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.558896 cos_to_last_merge=0.9125 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.913
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8384441504170628, 'auprc': 0.9624057046430363, 'loss_val': 0.8971324108245202, 'psi': 0.8880287721074522}-{'f1_val': 0.8831401472046267, 'auprc': 0.9931898224008187, 'loss_val': 0.5163049941421166, 'psi': 0.9271600172831035}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.346921 cos_to_last_merge=0.9741 (last merge round=15)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.41031980274267427, 'auprc': 0.7190153269219889, 'loss_val': 0.9148436954012539, 'psi': 0.5337980124144001}-{'f1_val': 0.44065231902434365, 'auprc': 0.7646875064392125, 'loss_val': 0.7053912466453165, 'psi': 0.5702663939902912}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=1.519777 cos_to_last_merge=0.7342 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.734
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.7431478312631792, 'auprc': 0.7505155252504845, 'loss_val': 0.4194443159893085, 'psi': 0.7460949088581013}-{'f1_val': 0.7074884569587803, 'auprc': 0.8995924467722556, 'loss_val': 0.339643654107492, 'psi': 0.7843300528841703}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=1.656232 cos_to_last_merge=0.7823 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.782
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9567797308186143, 'auprc': 0.9987389337800544, 'loss_val': 0.12311896502812432, 'psi': 0.9735634120031904}-{'f1_val': 0.9601864874536103, 'auprc': 0.9985128277219256, 'loss_val': 0.12372084565859977, 'psi': 0.9755170235609365}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.631770 cos_to_last_merge=0.8394 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.839
[S4] round=31 local utility u=0.043614 metrics={'f1_val': 0.9562726669410226, 'auprc': 0.947254237943316, 'loss_val': 0.4412218329812244, 'psi': 0.95266529534194}-{'f1_val': 0.9507667775701145, 'auprc': 0.9367561003452751, 'loss_val': 0.4639201798776071, 'psi': 0.9451625066801788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=31 head_norm_before_train=1.285420 cos_to_last_merge=0.9441 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.944
[S5] round=31 local utility u=0.353617 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9853041624993317, 'loss_val': 0.27161476212831437, 'psi': 0.8143140240945481}-{'f1_val': 0.6659240732175079, 'auprc': 0.8506635982492313, 'loss_val': 0.36854726250080455, 'psi': 0.7398198832301972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=31 head_norm_before_train=1.504337 cos_to_last_merge=0.9783 (last merge round=14)
[S6] round=31 local utility u=0.684613 metrics={'f1_val': 0.9622639335182733, 'auprc': 0.9714050527610352, 'loss_val': 0.18461024994842162, 'psi': 0.965920381215378}-{'f1_val': 0.7530144872900983, 'auprc': 0.9579820532616087, 'loss_val': 0.25807044880227786, 'psi': 0.8350015136787025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=31 head_norm_before_train=1.447789 cos_to_last_merge=0.9614 (last merge round=12)
[S7] round=31 local utility u=0.504681 metrics={'f1_val': 0.6991660632438035, 'auprc': 0.9663376591604647, 'loss_val': 0.2455045399306409, 'psi': 0.806034701610468}-{'f1_val': 0.653643325745571, 'auprc': 0.8075418310626223, 'loss_val': 0.5053419103773314, 'psi': 0.7152027278723916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=31 head_norm_before_train=1.625425 cos_to_last_merge=0.9746 (last merge round=16)
[S8] round=31 local utility u=0.000108 metrics={'f1_val': 0.9935462653440466, 'auprc': 0.9988933790243428, 'loss_val': 0.040521318549917175, 'psi': 0.9956851108161651}-{'f1_val': 0.9939122747783468, 'auprc': 0.9983177022746196, 'loss_val': 0.04120663349180313, 'psi': 0.9956744457768558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=31 head_norm_before_train=1.974705 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9935215919844088, 'auprc': 0.9992218845883752, 'loss_val': 0.02711363896582704, 'psi': 0.9958017090259954}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992091298977814, 'loss_val': 0.021110446206273156, 'psi': 0.9979453994663983}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.789382 cos_to_last_merge=0.9439 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=31 local utility u=0.000754 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9956584658834353, 'loss_val': 0.034405948798987646, 'psi': 0.9953504178337922}-{'f1_val': 0.9949255377402499, 'auprc': 0.9958488934003515, 'loss_val': 0.03516805275971575, 'psi': 0.9952948800042907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=31 head_norm_before_train=1.274478 cos_to_last_merge=0.9486 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.949
[S11] round=31 local utility u=0.001133 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9987977501664136, 'loss_val': 0.2594005675583798, 'psi': 0.8206802900455574}-{'f1_val': 0.7019353166316534, 'auprc': 0.998773836544817, 'loss_val': 0.26159562885955595, 'psi': 0.8206707245969189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=31 head_norm_before_train=1.218569 cos_to_last_merge=0.8505 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.850
[S13] round=31 local utility u=0.129786 metrics={'f1_val': 0.6299000949592972, 'auprc': 0.6722954706865243, 'loss_val': 0.6269643128755544, 'psi': 0.6468582452501881}-{'f1_val': 0.600318354435339, 'auprc': 0.6833781422144729, 'loss_val': 0.742294485782441, 'psi': 0.6335422695469926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=31 head_norm_before_train=1.891123 cos_to_last_merge=0.9788 (last merge round=14)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.8910290177767747, 'auprc': 0.9990579760134323, 'loss_val': 0.33379164840966924, 'psi': 0.9342406010714377}-{'f1_val': 0.9961605687915402, 'auprc': 0.9991721897689925, 'loss_val': 0.029870968537940724, 'psi': 0.9973652171825211}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=31 head_norm_before_train=1.514429 cos_to_last_merge=0.9495 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.8177402382648667, 'auprc': 0.9205123863322433, 'loss_val': 0.3002442305201668, 'psi': 0.8588490974918174}-{'f1_val': 0.9950761755130024, 'auprc': 0.9937850645202303, 'loss_val': 0.061215960060801565, 'psi': 0.9945597311158936}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.576898 cos_to_last_merge=0.9102 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.910
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8350912642747227, 'auprc': 0.9787722784594942, 'loss_val': 0.9486446260204852, 'psi': 0.8925636699486313}-{'f1_val': 0.8384441504170628, 'auprc': 0.9624057046430363, 'loss_val': 0.8971324108245202, 'psi': 0.8880287721074522}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=1.361160 cos_to_last_merge=0.9721 (last merge round=15)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.40171495082870423, 'auprc': 0.6951933128470287, 'loss_val': 1.0160219105028452, 'psi': 0.519106295636034}-{'f1_val': 0.41031980274267427, 'auprc': 0.7190153269219889, 'loss_val': 0.9148436954012539, 'psi': 0.5337980124144001}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.535324 cos_to_last_merge=0.7325 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.733
[S2] round=32 local utility u=0.132126 metrics={'f1_val': 0.7117322800432644, 'auprc': 0.8750096949001143, 'loss_val': 0.34018084502273765, 'psi': 0.7770432459860044}-{'f1_val': 0.7431478312631792, 'auprc': 0.7505155252504845, 'loss_val': 0.4194443159893085, 'psi': 0.7460949088581013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=32 head_norm_before_train=1.674839 cos_to_last_merge=0.7797 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.780
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9002825700489867, 'auprc': 0.9988548349173894, 'loss_val': 0.2184786253723278, 'psi': 0.9397114759963479}-{'f1_val': 0.9567797308186143, 'auprc': 0.9987389337800544, 'loss_val': 0.12311896502812432, 'psi': 0.9735634120031904}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.643403 cos_to_last_merge=0.8384 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.838
[S4] round=32 local utility u=0.016008 metrics={'f1_val': 0.9556390586171936, 'auprc': 0.9502631511499169, 'loss_val': 0.41443105468313823, 'psi': 0.9534886956302828}-{'f1_val': 0.9562726669410226, 'auprc': 0.947254237943316, 'loss_val': 0.4412218329812244, 'psi': 0.95266529534194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=32 head_norm_before_train=1.294499 cos_to_last_merge=0.9432 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.943
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.686707464603804, 'auprc': 0.9321896079629177, 'loss_val': 0.31317917032451975, 'psi': 0.7849003219474495}-{'f1_val': 0.700320598491359, 'auprc': 0.9853041624993317, 'loss_val': 0.27161476212831437, 'psi': 0.8143140240945481}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.511712 cos_to_last_merge=0.9773 (last merge round=14)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.961369930617804, 'auprc': 0.9708641255907019, 'loss_val': 0.19588407870898006, 'psi': 0.9651676086069632}-{'f1_val': 0.9622639335182733, 'auprc': 0.9714050527610352, 'loss_val': 0.18461024994842162, 'psi': 0.965920381215378}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.458871 cos_to_last_merge=0.9598 (last merge round=12)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5171814598863522, 'auprc': 0.7824428019451183, 'loss_val': 0.9385260590038271, 'psi': 0.6232859967098587}-{'f1_val': 0.6991660632438035, 'auprc': 0.9663376591604647, 'loss_val': 0.2455045399306409, 'psi': 0.806034701610468}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.638844 cos_to_last_merge=0.9734 (last merge round=16)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9923946006913721, 'auprc': 0.9878797469540979, 'loss_val': 0.06187943068553551, 'psi': 0.9905886591964623}-{'f1_val': 0.9935462653440466, 'auprc': 0.9988933790243428, 'loss_val': 0.040521318549917175, 'psi': 0.9956851108161651}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.983003 (no previous merge yet)
[S9] round=32 local utility u=0.011987 metrics={'f1_val': 0.9964354604519897, 'auprc': 0.9992149112861117, 'loss_val': 0.02060260128424498, 'psi': 0.9975472407856385}-{'f1_val': 0.9935215919844088, 'auprc': 0.9992218845883752, 'loss_val': 0.02711363896582704, 'psi': 0.9958017090259954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=32 head_norm_before_train=1.806222 cos_to_last_merge=0.9422 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.942
[S10] round=32 local utility u=0.000139 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9958407016679377, 'loss_val': 0.03335693391483509, 'psi': 0.995291603311325}-{'f1_val': 0.9951450524673635, 'auprc': 0.9956584658834353, 'loss_val': 0.034405948798987646, 'psi': 0.9953504178337922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=32 head_norm_before_train=1.287382 cos_to_last_merge=0.9472 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=32 local utility u=0.000475 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9988066441568105, 'loss_val': 0.25847707691647953, 'psi': 0.8206838476417162}-{'f1_val': 0.7019353166316534, 'auprc': 0.9987977501664136, 'loss_val': 0.2594005675583798, 'psi': 0.8206802900455574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] sending update (kind=head size=1791 to 1 peers)
[S13] START round=32 head_norm_before_train=1.232728 cos_to_last_merge=0.8471 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.847
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5751225890712703, 'auprc': 0.688652106775079, 'loss_val': 0.8813878776048394, 'psi': 0.6205343961527938}-{'f1_val': 0.6299000949592972, 'auprc': 0.6722954706865243, 'loss_val': 0.6269643128755544, 'psi': 0.6468582452501881}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.902048 cos_to_last_merge=0.9781 (last merge round=14)
[S14] round=32 local utility u=0.224567 metrics={'f1_val': 0.9368088312726697, 'auprc': 0.9990664132121532, 'loss_val': 0.15936095859432567, 'psi': 0.9617118640484631}-{'f1_val': 0.8910290177767747, 'auprc': 0.9990579760134323, 'loss_val': 0.33379164840966924, 'psi': 0.9342406010714377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=32 head_norm_before_train=1.533875 cos_to_last_merge=0.9471 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=32 local utility u=0.703115 metrics={'f1_val': 0.9792410404755038, 'auprc': 0.9908436472956168, 'loss_val': 0.07401348020902095, 'psi': 0.9838820832035489}-{'f1_val': 0.8177402382648667, 'auprc': 0.9205123863322433, 'loss_val': 0.3002442305201668, 'psi': 0.8588490974918174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=32 head_norm_before_train=1.595222 cos_to_last_merge=0.9079 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.908
[S16] round=32 local utility u=0.505017 metrics={'f1_val': 0.9124769921302116, 'auprc': 0.9938640919179149, 'loss_val': 0.44820009860652177, 'psi': 0.9450318320452928}-{'f1_val': 0.8350912642747227, 'auprc': 0.9787722784594942, 'loss_val': 0.9486446260204852, 'psi': 0.8925636699486313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=32 head_norm_before_train=1.372929 cos_to_last_merge=0.9704 (last merge round=15)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.38339241065301327, 'auprc': 0.6649595270735921, 'loss_val': 1.284851732753605, 'psi': 0.4960192572212448}-{'f1_val': 0.40171495082870423, 'auprc': 0.6951933128470287, 'loss_val': 1.0160219105028452, 'psi': 0.519106295636034}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.549014 cos_to_last_merge=0.7311 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.731
[S2] round=33 local utility u=0.316670 metrics={'f1_val': 0.826763506729863, 'auprc': 0.8491096844574515, 'loss_val': 0.31932892119803247, 'psi': 0.8357019778208984}-{'f1_val': 0.7117322800432644, 'auprc': 0.8750096949001143, 'loss_val': 0.34018084502273765, 'psi': 0.7770432459860044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=33 head_norm_before_train=1.693972 cos_to_last_merge=0.7770 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.777
[S3] round=33 local utility u=0.206392 metrics={'f1_val': 0.9526760704340969, 'auprc': 0.9986902237267746, 'loss_val': 0.11956250065222566, 'psi': 0.971081731751168}-{'f1_val': 0.9002825700489867, 'auprc': 0.9988548349173894, 'loss_val': 0.2184786253723278, 'psi': 0.9397114759963479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=33 head_norm_before_train=1.653610 cos_to_last_merge=0.8380 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.838
[S4] round=33 local utility u=0.018940 metrics={'f1_val': 0.9586002038941694, 'auprc': 0.9460473702381266, 'loss_val': 0.38166994800569803, 'psi': 0.9535790704317523}-{'f1_val': 0.9556390586171936, 'auprc': 0.9502631511499169, 'loss_val': 0.41443105468313823, 'psi': 0.9534886956302828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=33 head_norm_before_train=1.304011 cos_to_last_merge=0.9423 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.942
[S5] round=33 local utility u=0.137836 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9816480923389886, 'loss_val': 0.2675613845069474, 'psi': 0.8128515960304108}-{'f1_val': 0.686707464603804, 'auprc': 0.9321896079629177, 'loss_val': 0.31317917032451975, 'psi': 0.7849003219474495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=33 head_norm_before_train=1.520839 cos_to_last_merge=0.9763 (last merge round=14)
[S6] round=33 local utility u=0.033922 metrics={'f1_val': 0.9606117560182341, 'auprc': 0.9823591090912783, 'loss_val': 0.1579750133748145, 'psi': 0.9693106972474518}-{'f1_val': 0.961369930617804, 'auprc': 0.9708641255907019, 'loss_val': 0.19588407870898006, 'psi': 0.9651676086069632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=33 head_norm_before_train=1.467081 cos_to_last_merge=0.9586 (last merge round=12)
[S7] round=33 local utility u=1.000000 metrics={'f1_val': 0.6969371220982135, 'auprc': 0.879602285010295, 'loss_val': 0.3016970188499555, 'psi': 0.7700031872630462}-{'f1_val': 0.5171814598863522, 'auprc': 0.7824428019451183, 'loss_val': 0.9385260590038271, 'psi': 0.6232859967098587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=33 head_norm_before_train=1.652850 cos_to_last_merge=0.9725 (last merge round=16)
[S8] round=33 local utility u=0.025700 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9988658134385717, 'loss_val': 0.04211453697905471, 'psi': 0.9948508695934957}-{'f1_val': 0.9923946006913721, 'auprc': 0.9878797469540979, 'loss_val': 0.06187943068553551, 'psi': 0.9905886591964623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=33 head_norm_before_train=1.991446 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9963086788792082, 'loss_val': 0.020393645798729508, 'psi': 0.9965197786400182}-{'f1_val': 0.9964354604519897, 'auprc': 0.9992149112861117, 'loss_val': 0.02060260128424498, 'psi': 0.9975472407856385}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.821825 cos_to_last_merge=0.9406 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.941
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9947060979488367, 'auprc': 0.995833925490686, 'loss_val': 0.0327330566755393, 'psi': 0.9951572289655763}-{'f1_val': 0.9949255377402499, 'auprc': 0.9958407016679377, 'loss_val': 0.03335693391483509, 'psi': 0.995291603311325}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.299808 cos_to_last_merge=0.9449 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.6900461046745405, 'auprc': 0.9988017671141594, 'loss_val': 0.3000458933520036, 'psi': 0.813548369650388}-{'f1_val': 0.7019353166316534, 'auprc': 0.9988066441568105, 'loss_val': 0.25847707691647953, 'psi': 0.8206838476417162}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.248299 cos_to_last_merge=0.8437 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.844
[S13] round=33 local utility u=0.146401 metrics={'f1_val': 0.6057008217658439, 'auprc': 0.6804597743598685, 'loss_val': 0.7474778429126359, 'psi': 0.6356044028034538}-{'f1_val': 0.5751225890712703, 'auprc': 0.688652106775079, 'loss_val': 0.8813878776048394, 'psi': 0.6205343961527938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=33 head_norm_before_train=1.912539 cos_to_last_merge=0.9775 (last merge round=14)
[S14] round=33 local utility u=0.048795 metrics={'f1_val': 0.9388554119502449, 'auprc': 0.9991576562328998, 'loss_val': 0.07432341327142353, 'psi': 0.9629763096633068}-{'f1_val': 0.9368088312726697, 'auprc': 0.9990664132121532, 'loss_val': 0.15936095859432567, 'psi': 0.9617118640484631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] sending update (kind=head size=1790 to 1 peers)
[S15] START round=33 head_norm_before_train=1.552256 cos_to_last_merge=0.9446 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.881935726908154, 'auprc': 0.9904975491409088, 'loss_val': 0.22072183147434493, 'psi': 0.925360455801256}-{'f1_val': 0.9792410404755038, 'auprc': 0.9908436472956168, 'loss_val': 0.07401348020902095, 'psi': 0.9838820832035489}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.612037 cos_to_last_merge=0.9057 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.906
[S16] round=33 local utility u=0.433155 metrics={'f1_val': 0.9909027107140825, 'auprc': 0.9945775872031574, 'loss_val': 0.05458494545566176, 'psi': 0.9923726613097126}-{'f1_val': 0.9124769921302116, 'auprc': 0.9938640919179149, 'loss_val': 0.44820009860652177, 'psi': 0.9450318320452928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=33 head_norm_before_train=1.384124 cos_to_last_merge=0.9689 (last merge round=15)
[S17] round=33 local utility u=0.424302 metrics={'f1_val': 0.44035584690098195, 'auprc': 0.7231093399629618, 'loss_val': 0.9524770728776747, 'psi': 0.5534572441257739}-{'f1_val': 0.38339241065301327, 'auprc': 0.6649595270735921, 'loss_val': 1.284851732753605, 'psi': 0.4960192572212448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=34 head_norm_before_train=1.560740 cos_to_last_merge=0.7298 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.730
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.8275459367983915, 'auprc': 0.8224722331465959, 'loss_val': 0.31700554395974384, 'psi': 0.8255164553376733}-{'f1_val': 0.826763506729863, 'auprc': 0.8491096844574515, 'loss_val': 0.31932892119803247, 'psi': 0.8357019778208984}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.709231 cos_to_last_merge=0.7752 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.775
[S3] round=34 local utility u=0.069081 metrics={'f1_val': 0.9697067462627137, 'auprc': 0.9985128996935233, 'loss_val': 0.08305175843511002, 'psi': 0.9812292076350375}-{'f1_val': 0.9526760704340969, 'auprc': 0.9986902237267746, 'loss_val': 0.11956250065222566, 'psi': 0.971081731751168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=34 head_norm_before_train=1.669902 cos_to_last_merge=0.8369 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.837
[S4] round=34 local utility u=0.011153 metrics={'f1_val': 0.9568787452215058, 'auprc': 0.9510522090460047, 'loss_val': 0.3640489005113924, 'psi': 0.9545481307513055}-{'f1_val': 0.9586002038941694, 'auprc': 0.9460473702381266, 'loss_val': 0.38166994800569803, 'psi': 0.9535790704317523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=34 head_norm_before_train=1.314077 cos_to_last_merge=0.9414 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.941
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.5111331464794396, 'auprc': 0.7695623618252682, 'loss_val': 0.7999150932188315, 'psi': 0.6145048326177711}-{'f1_val': 0.700320598491359, 'auprc': 0.9816480923389886, 'loss_val': 0.2675613845069474, 'psi': 0.8128515960304108}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.532134 cos_to_last_merge=0.9752 (last merge round=14)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7411739211268165, 'auprc': 0.82278422097869, 'loss_val': 0.45057657368678933, 'psi': 0.7738180410675659}-{'f1_val': 0.9606117560182341, 'auprc': 0.9823591090912783, 'loss_val': 0.1579750133748145, 'psi': 0.9693106972474518}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.473022 cos_to_last_merge=0.9578 (last merge round=12)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6433082040034346, 'auprc': 0.7986135307480531, 'loss_val': 0.5445588897198492, 'psi': 0.705430334701282}-{'f1_val': 0.6969371220982135, 'auprc': 0.879602285010295, 'loss_val': 0.3016970188499555, 'psi': 0.7700031872630462}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.663907 cos_to_last_merge=0.9717 (last merge round=16)
[S8] round=34 local utility u=0.001287 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9989704695719532, 'loss_val': 0.039854133154412635, 'psi': 0.9948927320468484}-{'f1_val': 0.992174240363445, 'auprc': 0.9988658134385717, 'loss_val': 0.04211453697905471, 'psi': 0.9948508695934957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=34 head_norm_before_train=2.000879 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9988403458480564, 'loss_val': 0.022059237454605498, 'psi': 0.9968819736697314}-{'f1_val': 0.9966605118138915, 'auprc': 0.9963086788792082, 'loss_val': 0.020393645798729508, 'psi': 0.9965197786400182}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.832886 cos_to_last_merge=0.9393 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.939
[S10] round=34 local utility u=0.000917 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9957722484876801, 'loss_val': 0.032031101785338356, 'psi': 0.995264222039222}-{'f1_val': 0.9947060979488367, 'auprc': 0.995833925490686, 'loss_val': 0.0327330566755393, 'psi': 0.9951572289655763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=34 head_norm_before_train=1.312081 cos_to_last_merge=0.9430 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.943
[S11] round=34 local utility u=0.059931 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9987961939979871, 'loss_val': 0.2515029715522965, 'psi': 0.8206796675781869}-{'f1_val': 0.6900461046745405, 'auprc': 0.9988017671141594, 'loss_val': 0.3000458933520036, 'psi': 0.813548369650388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=34 head_norm_before_train=1.259259 cos_to_last_merge=0.8412 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.841
[S13] round=34 local utility u=0.124796 metrics={'f1_val': 0.6505735711016244, 'auprc': 0.6291244350056293, 'loss_val': 0.6131157522221085, 'psi': 0.6419939166632264}-{'f1_val': 0.6057008217658439, 'auprc': 0.6804597743598685, 'loss_val': 0.7474778429126359, 'psi': 0.6356044028034538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=34 head_norm_before_train=1.925429 cos_to_last_merge=0.9767 (last merge round=14)
[S14] round=34 local utility u=0.203278 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9990984853799518, 'loss_val': 0.023855308677110207, 'psi': 0.9985792006283036}-{'f1_val': 0.9388554119502449, 'auprc': 0.9991576562328998, 'loss_val': 0.07432341327142353, 'psi': 0.9629763096633068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=34 head_norm_before_train=1.569219 cos_to_last_merge=0.9425 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=34 local utility u=0.077963 metrics={'f1_val': 0.8984742731758643, 'auprc': 0.9886667563002292, 'loss_val': 0.15853462302382815, 'psi': 0.9345512664256101}-{'f1_val': 0.881935726908154, 'auprc': 0.9904975491409088, 'loss_val': 0.22072183147434493, 'psi': 0.925360455801256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=34 head_norm_before_train=1.628747 cos_to_last_merge=0.9036 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.904
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9893976792039341, 'auprc': 0.995033567637389, 'loss_val': 0.056518200058769744, 'psi': 0.9916520345773161}-{'f1_val': 0.9909027107140825, 'auprc': 0.9945775872031574, 'loss_val': 0.05458494545566176, 'psi': 0.9923726613097126}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.391967 cos_to_last_merge=0.9679 (last merge round=15)
[S17] round=34 local utility u=0.108840 metrics={'f1_val': 0.4373356727856996, 'auprc': 0.7488403702970593, 'loss_val': 0.7938697117364708, 'psi': 0.5619375517902435}-{'f1_val': 0.44035584690098195, 'auprc': 0.7231093399629618, 'loss_val': 0.9524770728776747, 'psi': 0.5534572441257739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=35 head_norm_before_train=1.571032 cos_to_last_merge=0.7286 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.729
[S2] round=35 local utility u=0.052679 metrics={'f1_val': 0.8255827546493536, 'auprc': 0.8744450477646835, 'loss_val': 0.3557873837472021, 'psi': 0.8451276718954855}-{'f1_val': 0.8275459367983915, 'auprc': 0.8224722331465959, 'loss_val': 0.31700554395974384, 'psi': 0.8255164553376733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=35 head_norm_before_train=1.722979 cos_to_last_merge=0.7733 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.773
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9512953854334633, 'auprc': 0.9988676988690816, 'loss_val': 0.15872839188587579, 'psi': 0.9703243108077106}-{'f1_val': 0.9697067462627137, 'auprc': 0.9985128996935233, 'loss_val': 0.08305175843511002, 'psi': 0.9812292076350375}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.689515 cos_to_last_merge=0.8355 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.836
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9549115272058278, 'auprc': 0.9501849036173968, 'loss_val': 0.3539824451626412, 'psi': 0.9530208777704554}-{'f1_val': 0.9568787452215058, 'auprc': 0.9510522090460047, 'loss_val': 0.3640489005113924, 'psi': 0.9545481307513055}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.323943 cos_to_last_merge=0.9404 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=35 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9909605648761856, 'loss_val': 0.23565439757983492, 'psi': 0.8165765850452896}-{'f1_val': 0.5111331464794396, 'auprc': 0.7695623618252682, 'loss_val': 0.7999150932188315, 'psi': 0.6145048326177711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=35 head_norm_before_train=1.541056 cos_to_last_merge=0.9743 (last merge round=14)
[S6] round=35 local utility u=0.866344 metrics={'f1_val': 0.9202856275919287, 'auprc': 0.9717232154031071, 'loss_val': 0.2393751014976493, 'psi': 0.9408606627164}-{'f1_val': 0.7411739211268165, 'auprc': 0.82278422097869, 'loss_val': 0.45057657368678933, 'psi': 0.7738180410675659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=35 head_norm_before_train=1.480293 cos_to_last_merge=0.9568 (last merge round=12)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5746177689976558, 'auprc': 0.7860579176470348, 'loss_val': 0.7816125753649426, 'psi': 0.6591938284574075}-{'f1_val': 0.6433082040034346, 'auprc': 0.7986135307480531, 'loss_val': 0.5445588897198492, 'psi': 0.705430334701282}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.676937 cos_to_last_merge=0.9706 (last merge round=16)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.713800092648937, 'auprc': 0.9856813431179905, 'loss_val': 0.36402498769041647, 'psi': 0.8225525928365585}-{'f1_val': 0.992174240363445, 'auprc': 0.9989704695719532, 'loss_val': 0.039854133154412635, 'psi': 0.9948927320468484}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=2.007975 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9909631199453779, 'auprc': 0.9992101386732556, 'loss_val': 0.029907787115073334, 'psi': 0.994261927436529}-{'f1_val': 0.9955763922175147, 'auprc': 0.9988403458480564, 'loss_val': 0.022059237454605498, 'psi': 0.9968819736697314}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.845356 cos_to_last_merge=0.9382 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9947060979488367, 'auprc': 0.9958385578836783, 'loss_val': 0.031436320733206236, 'psi': 0.9951590819227734}-{'f1_val': 0.9949255377402499, 'auprc': 0.9957722484876801, 'loss_val': 0.032031101785338356, 'psi': 0.995264222039222}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.325449 cos_to_last_merge=0.9418 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=35 local utility u=0.001369 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.998787388895144, 'loss_val': 0.24873872801455468, 'psi': 0.8206761455370497}-{'f1_val': 0.7019353166316534, 'auprc': 0.9987961939979871, 'loss_val': 0.2515029715522965, 'psi': 0.8206796675781869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=35 head_norm_before_train=1.266535 cos_to_last_merge=0.8398 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.840
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5791704709106205, 'auprc': 0.686573137939886, 'loss_val': 0.8341595585433517, 'psi': 0.6221315377223267}-{'f1_val': 0.6505735711016244, 'auprc': 0.6291244350056293, 'loss_val': 0.6131157522221085, 'psi': 0.6419939166632264}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.937916 cos_to_last_merge=0.9759 (last merge round=14)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9022759558514376, 'auprc': 0.997961149528196, 'loss_val': 0.2228171776093071, 'psi': 0.940550033322141}-{'f1_val': 0.9982330107938716, 'auprc': 0.9990984853799518, 'loss_val': 0.023855308677110207, 'psi': 0.9985792006283036}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.585325 cos_to_last_merge=0.9406 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.941
[S15] round=35 local utility u=0.289847 metrics={'f1_val': 0.9772855545955936, 'auprc': 0.9960538088416326, 'loss_val': 0.07387028131404313, 'psi': 0.9847928562940093}-{'f1_val': 0.8984742731758643, 'auprc': 0.9886667563002292, 'loss_val': 0.15853462302382815, 'psi': 0.9345512664256101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=35 head_norm_before_train=1.643870 cos_to_last_merge=0.9017 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.902
[S16] round=35 local utility u=0.001411 metrics={'f1_val': 0.9893976792039341, 'auprc': 0.9951960911755293, 'loss_val': 0.054184076526473765, 'psi': 0.9917170439925722}-{'f1_val': 0.9893976792039341, 'auprc': 0.995033567637389, 'loss_val': 0.056518200058769744, 'psi': 0.9916520345773161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=35 head_norm_before_train=1.401643 cos_to_last_merge=0.9669 (last merge round=15)
[S17] round=35 local utility u=0.412061 metrics={'f1_val': 0.6395355837450819, 'auprc': 0.6888728371214358, 'loss_val': 1.0030440376222918, 'psi': 0.6592704850956235}-{'f1_val': 0.4373356727856996, 'auprc': 0.7488403702970593, 'loss_val': 0.7938697117364708, 'psi': 0.5619375517902435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=36 head_norm_before_train=1.584645 cos_to_last_merge=0.7272 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.727
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.8015010611381905, 'auprc': 0.7661192639108851, 'loss_val': 0.4203537642428336, 'psi': 0.7873483422472684}-{'f1_val': 0.8255827546493536, 'auprc': 0.8744450477646835, 'loss_val': 0.3557873837472021, 'psi': 0.8451276718954855}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.733788 cos_to_last_merge=0.7718 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.772
[S3] round=36 local utility u=0.054310 metrics={'f1_val': 0.9620397593605206, 'auprc': 0.9987739798300967, 'loss_val': 0.11429308577373855, 'psi': 0.976733447548351}-{'f1_val': 0.9512953854334633, 'auprc': 0.9988676988690816, 'loss_val': 0.15872839188587579, 'psi': 0.9703243108077106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=36 head_norm_before_train=1.708444 cos_to_last_merge=0.8342 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.834
[S4] round=36 local utility u=0.024435 metrics={'f1_val': 0.9575978540394907, 'auprc': 0.9547375340489606, 'loss_val': 0.334888251012542, 'psi': 0.9564537260432786}-{'f1_val': 0.9549115272058278, 'auprc': 0.9501849036173968, 'loss_val': 0.3539824451626412, 'psi': 0.9530208777704554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=36 head_norm_before_train=1.332665 cos_to_last_merge=0.9397 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.5803346641923356, 'auprc': 0.8362850553391233, 'loss_val': 0.5445763826648204, 'psi': 0.6827148206510507}-{'f1_val': 0.700320598491359, 'auprc': 0.9909605648761856, 'loss_val': 0.23565439757983492, 'psi': 0.8165765850452896}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.549848 cos_to_last_merge=0.9729 (last merge round=14)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.7864819639603329, 'auprc': 0.8153112530145263, 'loss_val': 0.5505170845090963, 'psi': 0.7980136795820103}-{'f1_val': 0.9202856275919287, 'auprc': 0.9717232154031071, 'loss_val': 0.2393751014976493, 'psi': 0.9408606627164}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.491658 cos_to_last_merge=0.9554 (last merge round=12)
[S7] round=36 local utility u=0.432765 metrics={'f1_val': 0.6486027528825529, 'auprc': 0.8201182925220771, 'loss_val': 0.46217378895170774, 'psi': 0.7172089687383626}-{'f1_val': 0.5746177689976558, 'auprc': 0.7860579176470348, 'loss_val': 0.7816125753649426, 'psi': 0.6591938284574075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=36 head_norm_before_train=1.689196 cos_to_last_merge=0.9696 (last merge round=16)
[S8] round=36 local utility u=1.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9989944461559863, 'loss_val': 0.03931001941452643, 'psi': 0.9949023226804615}-{'f1_val': 0.713800092648937, 'auprc': 0.9856813431179905, 'loss_val': 0.36402498769041647, 'psi': 0.8225525928365585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=36 head_norm_before_train=2.014189 (no previous merge yet)
[S9] round=36 local utility u=0.024298 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995952082441797, 'loss_val': 0.01930550053682104, 'psi': 0.9980998308049576}-{'f1_val': 0.9909631199453779, 'auprc': 0.9992101386732556, 'loss_val': 0.029907787115073334, 'psi': 0.994261927436529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=36 head_norm_before_train=1.858412 cos_to_last_merge=0.9370 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=36 local utility u=0.000998 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9958941508643546, 'loss_val': 0.03092385443482493, 'psi': 0.9953129829898919}-{'f1_val': 0.9947060979488367, 'auprc': 0.9958385578836783, 'loss_val': 0.031436320733206236, 'psi': 0.9951590819227734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=36 head_norm_before_train=1.338650 cos_to_last_merge=0.9408 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.941
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.7004917438537676, 'auprc': 0.9988223756704482, 'loss_val': 0.24979419902348488, 'psi': 0.8198239965804398}-{'f1_val': 0.7019353166316534, 'auprc': 0.998787388895144, 'loss_val': 0.24873872801455468, 'psi': 0.8206761455370497}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.271387 cos_to_last_merge=0.8389 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.839
[S13] round=36 local utility u=0.276867 metrics={'f1_val': 0.6326656491186381, 'auprc': 0.6715763625860536, 'loss_val': 0.5564053929968137, 'psi': 0.6482299345056043}-{'f1_val': 0.5791704709106205, 'auprc': 0.686573137939886, 'loss_val': 0.8341595585433517, 'psi': 0.6221315377223267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=36 head_norm_before_train=1.948254 cos_to_last_merge=0.9753 (last merge round=14)
[S14] round=36 local utility u=0.361811 metrics={'f1_val': 0.9926598792292538, 'auprc': 0.9967840246543218, 'loss_val': 0.037966965081509624, 'psi': 0.9943095373992811}-{'f1_val': 0.9022759558514376, 'auprc': 0.997961149528196, 'loss_val': 0.2228171776093071, 'psi': 0.940550033322141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=36 head_norm_before_train=1.601202 cos_to_last_merge=0.9387 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.939
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.8660421824254774, 'auprc': 0.9901391881815707, 'loss_val': 0.19179708523156433, 'psi': 0.9156809847279147}-{'f1_val': 0.9772855545955936, 'auprc': 0.9960538088416326, 'loss_val': 0.07387028131404313, 'psi': 0.9847928562940093}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.657586 cos_to_last_merge=0.9000 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.900
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9895894648799033, 'auprc': 0.995190942424481, 'loss_val': 0.05577983125972845, 'psi': 0.9918300558977344}-{'f1_val': 0.9893976792039341, 'auprc': 0.9951960911755293, 'loss_val': 0.054184076526473765, 'psi': 0.9917170439925722}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.411318 cos_to_last_merge=0.9657 (last merge round=15)
[S17] round=36 local utility u=0.809112 metrics={'f1_val': 0.7580057114432008, 'auprc': 0.8379746752077437, 'loss_val': 0.5429473104500755, 'psi': 0.789993296949018}-{'f1_val': 0.6395355837450819, 'auprc': 0.6888728371214358, 'loss_val': 1.0030440376222918, 'psi': 0.6592704850956235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=37 head_norm_before_train=1.600076 cos_to_last_merge=0.7256 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.726
[S2] round=37 local utility u=0.053291 metrics={'f1_val': 0.773319870557243, 'auprc': 0.8618700603352334, 'loss_val': 0.43193771959260036, 'psi': 0.8087399464684393}-{'f1_val': 0.8015010611381905, 'auprc': 0.7661192639108851, 'loss_val': 0.4203537642428336, 'psi': 0.7873483422472684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=37 head_norm_before_train=1.744943 cos_to_last_merge=0.7703 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.770
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.8367465161335085, 'auprc': 0.9988696155062935, 'loss_val': 0.28247446370027346, 'psi': 0.9015957558826224}-{'f1_val': 0.9620397593605206, 'auprc': 0.9987739798300967, 'loss_val': 0.11429308577373855, 'psi': 0.976733447548351}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.724139 cos_to_last_merge=0.8332 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.833
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9546273245556951, 'auprc': 0.9366831789573035, 'loss_val': 0.33736622492310214, 'psi': 0.9474496663163384}-{'f1_val': 0.9575978540394907, 'auprc': 0.9547375340489606, 'loss_val': 0.334888251012542, 'psi': 0.9564537260432786}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.341209 cos_to_last_merge=0.9389 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=37 local utility u=0.726603 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.989425848962781, 'loss_val': 0.27071228628916966, 'psi': 0.8159631300454606}-{'f1_val': 0.5803346641923356, 'auprc': 0.8362850553391233, 'loss_val': 0.5445763826648204, 'psi': 0.6827148206510507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=37 head_norm_before_train=1.559288 cos_to_last_merge=0.9711 (last merge round=14)
[S6] round=37 local utility u=0.967674 metrics={'f1_val': 0.9611466764309634, 'auprc': 0.9735367215889104, 'loss_val': 0.1378337212709393, 'psi': 0.9661026944941422}-{'f1_val': 0.7864819639603329, 'auprc': 0.8153112530145263, 'loss_val': 0.5505170845090963, 'psi': 0.7980136795820103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=37 head_norm_before_train=1.501929 cos_to_last_merge=0.9540 (last merge round=12)
[S7] round=37 local utility u=0.067536 metrics={'f1_val': 0.6615358219143546, 'auprc': 0.8240658828803085, 'loss_val': 0.41654290677745803, 'psi': 0.7265478463007362}-{'f1_val': 0.6486027528825529, 'auprc': 0.8201182925220771, 'loss_val': 0.46217378895170774, 'psi': 0.7172089687383626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=37 head_norm_before_train=1.700830 cos_to_last_merge=0.9687 (last merge round=16)
[S8] round=37 local utility u=0.000457 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9989183279855929, 'loss_val': 0.03816727646587441, 'psi': 0.9948718754123042}-{'f1_val': 0.992174240363445, 'auprc': 0.9989944461559863, 'loss_val': 0.03931001941452643, 'psi': 0.9949023226804615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=37 head_norm_before_train=2.020583 (no previous merge yet)
[S9] round=37 local utility u=0.000158 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9996350605173079, 'loss_val': 0.01910885983906742, 'psi': 0.9981157717142088}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995952082441797, 'loss_val': 0.01930550053682104, 'psi': 0.9980998308049576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=37 head_norm_before_train=1.867506 cos_to_last_merge=0.9360 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.936
[S10] round=37 local utility u=0.000686 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.995787020976029, 'loss_val': 0.03054809638416231, 'psi': 0.9954018398708298}-{'f1_val': 0.9949255377402499, 'auprc': 0.9958941508643546, 'loss_val': 0.03092385443482493, 'psi': 0.9953129829898919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=37 head_norm_before_train=1.350577 cos_to_last_merge=0.9392 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.939
[S11] round=37 local utility u=0.007077 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9988223169402197, 'loss_val': 0.24430089991860826, 'psi': 0.82069011675508}-{'f1_val': 0.7004917438537676, 'auprc': 0.9988223756704482, 'loss_val': 0.24979419902348488, 'psi': 0.8198239965804398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=37 head_norm_before_train=1.275795 cos_to_last_merge=0.8384 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.838
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5724953124240051, 'auprc': 0.6869623666876715, 'loss_val': 0.8339725932699942, 'psi': 0.6182821341294717}-{'f1_val': 0.6326656491186381, 'auprc': 0.6715763625860536, 'loss_val': 0.5564053929968137, 'psi': 0.6482299345056043}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.958424 cos_to_last_merge=0.9748 (last merge round=14)
[S14] round=37 local utility u=0.019011 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9967475631143439, 'loss_val': 0.02588081246695077, 'psi': 0.9968994531742843}-{'f1_val': 0.9926598792292538, 'auprc': 0.9967840246543218, 'loss_val': 0.037966965081509624, 'psi': 0.9943095373992811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=37 head_norm_before_train=1.617204 cos_to_last_merge=0.9368 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.937
[S15] round=37 local utility u=0.163186 metrics={'f1_val': 0.9075570818621999, 'auprc': 0.9912604473337097, 'loss_val': 0.11787829235641016, 'psi': 0.9410384280508037}-{'f1_val': 0.8660421824254774, 'auprc': 0.9901391881815707, 'loss_val': 0.19179708523156433, 'psi': 0.9156809847279147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=37 head_norm_before_train=1.670552 cos_to_last_merge=0.8983 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.898
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.852384647172574, 'auprc': 0.9659767772120887, 'loss_val': 0.8720058204670413, 'psi': 0.89782149918838}-{'f1_val': 0.9895894648799033, 'auprc': 0.995190942424481, 'loss_val': 0.05577983125972845, 'psi': 0.9918300558977344}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.422658 cos_to_last_merge=0.9642 (last merge round=15)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6510426717035733, 'auprc': 0.6668689236304916, 'loss_val': 1.0654696854390164, 'psi': 0.6573731724743406}-{'f1_val': 0.7580057114432008, 'auprc': 0.8379746752077437, 'loss_val': 0.5429473104500755, 'psi': 0.789993296949018}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.612953 cos_to_last_merge=0.7243 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.724
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7963091892471672, 'auprc': 0.8308970154935658, 'loss_val': 0.4773811423923211, 'psi': 0.8101443197457265}-{'f1_val': 0.773319870557243, 'auprc': 0.8618700603352334, 'loss_val': 0.43193771959260036, 'psi': 0.8087399464684393}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.756302 cos_to_last_merge=0.7690 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.769
[S3] round=38 local utility u=0.106733 metrics={'f1_val': 0.8630037152475415, 'auprc': 0.9988691943969229, 'loss_val': 0.22655044396291005, 'psi': 0.9173499069072941}-{'f1_val': 0.8367465161335085, 'auprc': 0.9988696155062935, 'loss_val': 0.28247446370027346, 'psi': 0.9015957558826224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=38 head_norm_before_train=1.735972 cos_to_last_merge=0.8323 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.832
[S4] round=38 local utility u=0.058827 metrics={'f1_val': 0.9598765216990315, 'auprc': 0.9579194353427987, 'loss_val': 0.31491693993721154, 'psi': 0.9590936871565383}-{'f1_val': 0.9546273245556951, 'auprc': 0.9366831789573035, 'loss_val': 0.33736622492310214, 'psi': 0.9474496663163384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=38 head_norm_before_train=1.347661 cos_to_last_merge=0.9382 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.938
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.42443632210381727, 'auprc': 0.8168090998571224, 'loss_val': 1.0412064798225182, 'psi': 0.5813854332051394}-{'f1_val': 0.7003213174339138, 'auprc': 0.989425848962781, 'loss_val': 0.27071228628916966, 'psi': 0.8159631300454606}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.565412 cos_to_last_merge=0.9703 (last merge round=14)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.6429970356288788, 'auprc': 0.8143233029791707, 'loss_val': 0.6611097933362748, 'psi': 0.7115275425689955}-{'f1_val': 0.9611466764309634, 'auprc': 0.9735367215889104, 'loss_val': 0.1378337212709393, 'psi': 0.9661026944941422}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.511824 cos_to_last_merge=0.9526 (last merge round=12)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.47135107803344756, 'auprc': 0.782301719509361, 'loss_val': 1.0204905132734083, 'psi': 0.5957313346238129}-{'f1_val': 0.6615358219143546, 'auprc': 0.8240658828803085, 'loss_val': 0.41654290677745803, 'psi': 0.7265478463007362}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.711653 cos_to_last_merge=0.9682 (last merge round=16)
[S8] round=38 local utility u=0.007019 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9990473948124383, 'loss_val': 0.036071057230308165, 'psi': 0.9960789661390543}-{'f1_val': 0.992174240363445, 'auprc': 0.9989183279855929, 'loss_val': 0.03816727646587441, 'psi': 0.9948718754123042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=38 head_norm_before_train=2.025934 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9966857875385419, 'auprc': 0.9997055055925888, 'loss_val': 0.019192034552425272, 'psi': 0.9978936747601607}-{'f1_val': 0.9971029125121428, 'auprc': 0.9996350605173079, 'loss_val': 0.01910885983906742, 'psi': 0.9981157717142088}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.876541 cos_to_last_merge=0.9352 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=38 local utility u=0.000054 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9956706664224784, 'loss_val': 0.03009120524103785, 'psi': 0.9953552980494095}-{'f1_val': 0.9951450524673635, 'auprc': 0.995787020976029, 'loss_val': 0.03054809638416231, 'psi': 0.9954018398708298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=38 head_norm_before_train=1.359273 cos_to_last_merge=0.9374 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.937
[S11] round=38 local utility u=0.001822 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9970709066217764, 'loss_val': 0.233952167851271, 'psi': 0.8198444504008655}-{'f1_val': 0.7019353166316534, 'auprc': 0.9988223169402197, 'loss_val': 0.24430089991860826, 'psi': 0.82069011675508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=38 head_norm_before_train=1.279925 cos_to_last_merge=0.8378 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.838
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5659435207262247, 'auprc': 0.6871163982629322, 'loss_val': 0.8234378038224819, 'psi': 0.6144126717409077}-{'f1_val': 0.5724953124240051, 'auprc': 0.6869623666876715, 'loss_val': 0.8339725932699942, 'psi': 0.6182821341294717}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.969023 cos_to_last_merge=0.9741 (last merge round=14)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9279324332561523, 'auprc': 0.9981014213893094, 'loss_val': 0.1556718916140481, 'psi': 0.9560000285094151}-{'f1_val': 0.9970007132142444, 'auprc': 0.9967475631143439, 'loss_val': 0.02588081246695077, 'psi': 0.9968994531742843}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.633625 cos_to_last_merge=0.9346 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.935
[S15] round=38 local utility u=0.281415 metrics={'f1_val': 0.9900903226505261, 'auprc': 0.9949779671178371, 'loss_val': 0.06140009377720295, 'psi': 0.9920453804374505}-{'f1_val': 0.9075570818621999, 'auprc': 0.9912604473337097, 'loss_val': 0.11787829235641016, 'psi': 0.9410384280508037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=38 head_norm_before_train=1.682543 cos_to_last_merge=0.8968 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.897
[S16] round=38 local utility u=0.456283 metrics={'f1_val': 0.9187698591288505, 'auprc': 0.9939977851672566, 'loss_val': 0.44181396726615824, 'psi': 0.9488610295442129}-{'f1_val': 0.852384647172574, 'auprc': 0.9659767772120887, 'loss_val': 0.8720058204670413, 'psi': 0.89782149918838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=38 head_norm_before_train=1.435082 cos_to_last_merge=0.9625 (last merge round=15)
[S17] round=38 local utility u=1.000000 metrics={'f1_val': 0.8192335420778619, 'auprc': 0.9057807980911055, 'loss_val': 0.46544869563456226, 'psi': 0.8538524444831593}-{'f1_val': 0.6510426717035733, 'auprc': 0.6668689236304916, 'loss_val': 1.0654696854390164, 'psi': 0.6573731724743406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=39 head_norm_before_train=1.622730 cos_to_last_merge=0.7232 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.723
[S2] round=39 local utility u=0.174772 metrics={'f1_val': 0.8224048064348058, 'auprc': 0.8683281560430525, 'loss_val': 0.39670368081343993, 'psi': 0.8407741462781044}-{'f1_val': 0.7963091892471672, 'auprc': 0.8308970154935658, 'loss_val': 0.4773811423923211, 'psi': 0.8101443197457265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S2] r=40 psi=0.841 u=0.1748 p_local=0.0794 f1=0.822 auprc=0.868 bytes=44970
[S3] START round=39 head_norm_before_train=1.770597 cos_to_last_merge=0.7672 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.767
[S3] round=39 local utility u=0.143383 metrics={'f1_val': 0.9013038834618898, 'auprc': 0.9988685057314122, 'loss_val': 0.1695837382263333, 'psi': 0.9403297323696987}-{'f1_val': 0.8630037152475415, 'auprc': 0.9988691943969229, 'loss_val': 0.22655044396291005, 'psi': 0.9173499069072941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S3] r=40 psi=0.940 u=0.1434 p_local=0.1021 f1=0.901 auprc=0.999 bytes=35916
[S4] START round=39 head_norm_before_train=1.748570 cos_to_last_merge=0.8311 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.831
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9549805319500756, 'auprc': 0.9513384166388497, 'loss_val': 0.32583983416284434, 'psi': 0.9535236858255852}-{'f1_val': 0.9598765216990315, 'auprc': 0.9579194353427987, 'loss_val': 0.31491693993721154, 'psi': 0.9590936871565383}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.954 u=0.0000 p_local=0.0393 f1=0.955 auprc=0.951 bytes=48511
[S5] START round=39 head_norm_before_train=1.351620 cos_to_last_merge=0.9375 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.938
[S5] round=39 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9971286286742832, 'loss_val': 0.1955893367559926, 'psi': 0.8190442419300615}-{'f1_val': 0.42443632210381727, 'auprc': 0.8168090998571224, 'loss_val': 1.0412064798225182, 'psi': 0.5813854332051394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S5] r=40 psi=0.819 u=1.0000 p_local=0.4051 f1=0.700 auprc=0.997 bytes=43207
[S6] START round=39 head_norm_before_train=1.571411 cos_to_last_merge=0.9693 (last merge round=14)
[S6] round=39 local utility u=1.000000 metrics={'f1_val': 0.9663270930989607, 'auprc': 0.9608793180643085, 'loss_val': 0.11448149698224665, 'psi': 0.9641479830850999}-{'f1_val': 0.6429970356288788, 'auprc': 0.8143233029791707, 'loss_val': 0.6611097933362748, 'psi': 0.7115275425689955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S6] r=40 psi=0.964 u=1.0000 p_local=0.4433 f1=0.966 auprc=0.961 bytes=37784
[S7] START round=39 head_norm_before_train=1.519903 cos_to_last_merge=0.9516 (last merge round=12)
[S7] round=39 local utility u=1.000000 metrics={'f1_val': 0.6989620645223089, 'auprc': 0.9719757222009678, 'loss_val': 0.2368353070188454, 'psi': 0.8081675275937725}-{'f1_val': 0.47135107803344756, 'auprc': 0.782301719509361, 'loss_val': 1.0204905132734083, 'psi': 0.5957313346238129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S7] r=40 psi=0.808 u=1.0000 p_local=0.3420 f1=0.699 auprc=0.972 bytes=43119
[S8] START round=39 head_norm_before_train=1.720580 cos_to_last_merge=0.9675 (last merge round=16)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9937260093124592, 'auprc': 0.9990817780911829, 'loss_val': 0.03590133448725306, 'psi': 0.9958683168239488}-{'f1_val': 0.9941000136901317, 'auprc': 0.9990473948124383, 'loss_val': 0.036071057230308165, 'psi': 0.9960789661390543}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.996 u=0.0000 p_local=0.1129 f1=0.994 auprc=0.999 bytes=52103
[S9] START round=39 head_norm_before_train=2.033430 (no previous merge yet)
[S9] round=39 local utility u=0.001521 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9996615903066283, 'loss_val': 0.018520339319747427, 'psi': 0.998126383629937}-{'f1_val': 0.9966857875385419, 'auprc': 0.9997055055925888, 'loss_val': 0.019192034552425272, 'psi': 0.9978936747601607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S9] r=40 psi=0.998 u=0.0015 p_local=0.0072 f1=0.997 auprc=1.000 bytes=48573
[S10] START round=39 head_norm_before_train=1.886989 cos_to_last_merge=0.9343 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.934
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9957133288865243, 'loss_val': 0.029796333791586634, 'psi': 0.9952406541987597}-{'f1_val': 0.9951450524673635, 'auprc': 0.9956706664224784, 'loss_val': 0.03009120524103785, 'psi': 0.9953552980494095}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0029 f1=0.995 auprc=0.996 bytes=61165
[S11] START round=39 head_norm_before_train=1.367695 cos_to_last_merge=0.9361 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=39 local utility u=0.006383 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9987019884916597, 'loss_val': 0.22752971213161827, 'psi': 0.8206419853756559}-{'f1_val': 0.7016934795869249, 'auprc': 0.9970709066217764, 'loss_val': 0.233952167851271, 'psi': 0.8198444504008655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=40 psi=0.821 u=0.0064 p_local=0.0123 f1=0.702 auprc=0.999 bytes=55697
[S13] START round=39 head_norm_before_train=1.285500 cos_to_last_merge=0.8364 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.836
[S13] round=39 local utility u=0.283808 metrics={'f1_val': 0.6212073054404186, 'auprc': 0.6738911345521398, 'loss_val': 0.5477280495219238, 'psi': 0.642280837085107}-{'f1_val': 0.5659435207262247, 'auprc': 0.6871163982629322, 'loss_val': 0.8234378038224819, 'psi': 0.6144126717409077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S13] r=40 psi=0.642 u=0.2838 p_local=0.1123 f1=0.621 auprc=0.674 bytes=37751
[S14] START round=39 head_norm_before_train=1.976008 cos_to_last_merge=0.9737 (last merge round=14)
[S14] round=39 local utility u=0.242005 metrics={'f1_val': 0.9894824896527796, 'auprc': 0.999018590684928, 'loss_val': 0.04371322907136233, 'psi': 0.993296930065639}-{'f1_val': 0.9279324332561523, 'auprc': 0.9981014213893094, 'loss_val': 0.1556718916140481, 'psi': 0.9560000285094151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S14] r=40 psi=0.993 u=0.2420 p_local=0.1145 f1=0.989 auprc=0.999 bytes=55720
[S15] START round=39 head_norm_before_train=1.648598 cos_to_last_merge=0.9328 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6998192707810504, 'auprc': 0.8683233370559569, 'loss_val': 0.5121605414759866, 'psi': 0.7672208972910131}-{'f1_val': 0.9900903226505261, 'auprc': 0.9949779671178371, 'loss_val': 0.06140009377720295, 'psi': 0.9920453804374505}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.767 u=0.0000 p_local=0.1674 f1=0.700 auprc=0.868 bytes=46795
[S16] START round=39 head_norm_before_train=1.694476 cos_to_last_merge=0.8954 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.895
[S16] round=39 local utility u=0.350772 metrics={'f1_val': 0.9767994853533186, 'auprc': 0.9944113878889141, 'loss_val': 0.08968944321442217, 'psi': 0.9838442463675567}-{'f1_val': 0.9187698591288505, 'auprc': 0.9939977851672566, 'loss_val': 0.44181396726615824, 'psi': 0.9488610295442129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S16] r=40 psi=0.984 u=0.3508 p_local=0.2020 f1=0.977 auprc=0.994 bytes=44906
[S17] START round=39 head_norm_before_train=1.443730 cos_to_last_merge=0.9613 (last merge round=15)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6444785950428283, 'auprc': 0.6309681475348319, 'loss_val': 1.3747985572731216, 'psi': 0.6390744160396298}-{'f1_val': 0.8192335420778619, 'auprc': 0.9057807980911055, 'loss_val': 0.46544869563456226, 'psi': 0.8538524444831593}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.639 u=0.0000 p_local=0.3319 f1=0.644 auprc=0.631 bytes=48525
[S2] START round=40 head_norm_before_train=1.631678 cos_to_last_merge=0.7220 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.722
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.8064241589072327, 'auprc': 0.8456079627938675, 'loss_val': 0.443508938561475, 'psi': 0.8220976804618867}-{'f1_val': 0.8224048064348058, 'auprc': 0.8683281560430525, 'loss_val': 0.39670368081343993, 'psi': 0.8407741462781044}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.784355 cos_to_last_merge=0.7656 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.766
[S3] round=40 local utility u=0.350547 metrics={'f1_val': 0.9972450390152456, 'auprc': 0.99870159990347, 'loss_val': 0.043635291326408365, 'psi': 0.9978276633705354}-{'f1_val': 0.9013038834618898, 'auprc': 0.9988685057314122, 'loss_val': 0.1695837382263333, 'psi': 0.9403297323696987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=40 head_norm_before_train=1.759567 cos_to_last_merge=0.8298 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.830
[S4] round=40 local utility u=0.002481 metrics={'f1_val': 0.9545505234510225, 'auprc': 0.9528296211976164, 'loss_val': 0.32277231875389095, 'psi': 0.95386216254966}-{'f1_val': 0.9549805319500756, 'auprc': 0.9513384166388497, 'loss_val': 0.32583983416284434, 'psi': 0.9535236858255852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=40 head_norm_before_train=1.355435 cos_to_last_merge=0.9370 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.5758964874537015, 'auprc': 0.7953920089156105, 'loss_val': 0.6395548460944228, 'psi': 0.6636946960384651}-{'f1_val': 0.7003213174339138, 'auprc': 0.9971286286742832, 'loss_val': 0.1955893367559926, 'psi': 0.8190442419300615}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.577317 cos_to_last_merge=0.9684 (last merge round=14)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6458746074732519, 'auprc': 0.8138298800537377, 'loss_val': 0.764295812340043, 'psi': 0.7130567165054462}-{'f1_val': 0.9663270930989607, 'auprc': 0.9608793180643085, 'loss_val': 0.11448149698224665, 'psi': 0.9641479830850999}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.526416 cos_to_last_merge=0.9506 (last merge round=12)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6965968630367012, 'auprc': 0.8839103339146966, 'loss_val': 0.3106549313422477, 'psi': 0.7715222513878994}-{'f1_val': 0.6989620645223089, 'auprc': 0.9719757222009678, 'loss_val': 0.2368353070188454, 'psi': 0.8081675275937725}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.727156 cos_to_last_merge=0.9668 (last merge round=16)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9989951572755235, 'loss_val': 0.03585276442670809, 'psi': 0.9951208976595105}-{'f1_val': 0.9937260093124592, 'auprc': 0.9990817780911829, 'loss_val': 0.03590133448725306, 'psi': 0.9958683168239488}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=2.041202 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9967080885050547, 'loss_val': 0.019319174351887503, 'psi': 0.9964332922695884}-{'f1_val': 0.9971029125121428, 'auprc': 0.9996615903066283, 'loss_val': 0.018520339319747427, 'psi': 0.998126383629937}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.898117 cos_to_last_merge=0.9333 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=40 local utility u=0.001172 metrics={'f1_val': 0.9951450524673635, 'auprc': 0.9959853958087923, 'loss_val': 0.029585954401539848, 'psi': 0.9954811898039351}-{'f1_val': 0.9949255377402499, 'auprc': 0.9957133288865243, 'loss_val': 0.029796333791586634, 'psi': 0.9952406541987597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=40 head_norm_before_train=1.377042 cos_to_last_merge=0.9342 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.934
[S11] round=40 local utility u=0.002980 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9960277220213868, 'loss_val': 0.21354623378159282, 'psi': 0.8195722787875468}-{'f1_val': 0.7019353166316534, 'auprc': 0.9987019884916597, 'loss_val': 0.22752971213161827, 'psi': 0.8206419853756559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=40 head_norm_before_train=1.290535 cos_to_last_merge=0.8352 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.835
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.5259054876760926, 'auprc': 0.6936413557954801, 'loss_val': 0.9477956607879008, 'psi': 0.5929998349238477}-{'f1_val': 0.6212073054404186, 'auprc': 0.6738911345521398, 'loss_val': 0.5477280495219238, 'psi': 0.642280837085107}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.982036 cos_to_last_merge=0.9735 (last merge round=14)
[S14] round=40 local utility u=0.028547 metrics={'f1_val': 0.9957181379851651, 'auprc': 0.9990227327910279, 'loss_val': 0.024045946284788712, 'psi': 0.9970399759075101}-{'f1_val': 0.9894824896527796, 'auprc': 0.999018590684928, 'loss_val': 0.04371322907136233, 'psi': 0.993296930065639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=40 head_norm_before_train=1.661182 cos_to_last_merge=0.9313 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=40 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.991510768127675, 'loss_val': 0.032020308232442375, 'psi': 0.9946523082835823}-{'f1_val': 0.6998192707810504, 'auprc': 0.8683233370559569, 'loss_val': 0.5121605414759866, 'psi': 0.7672208972910131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=40 head_norm_before_train=1.705739 cos_to_last_merge=0.8941 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.894
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.917900904964136, 'auprc': 0.9925166154241719, 'loss_val': 0.4633992377759785, 'psi': 0.9477471891481504}-{'f1_val': 0.9767994853533186, 'auprc': 0.9944113878889141, 'loss_val': 0.08968944321442217, 'psi': 0.9838442463675567}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.452435 cos_to_last_merge=0.9598 (last merge round=15)
[S17] round=40 local utility u=0.504192 metrics={'f1_val': 0.6360741478509929, 'auprc': 0.8356256649339434, 'loss_val': 0.9299610922349384, 'psi': 0.7158947546841732}-{'f1_val': 0.6444785950428283, 'auprc': 0.6309681475348319, 'loss_val': 1.3747985572731216, 'psi': 0.6390744160396298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=41 head_norm_before_train=1.641900 cos_to_last_merge=0.7208 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.721
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7505390265134074, 'auprc': 0.8671767772671399, 'loss_val': 0.42971435991560314, 'psi': 0.7971941268149004}-{'f1_val': 0.8064241589072327, 'auprc': 0.8456079627938675, 'loss_val': 0.443508938561475, 'psi': 0.8220976804618867}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.797763 cos_to_last_merge=0.7641 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.764
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9983193109677447, 'loss_val': 0.10055611401326583, 'psi': 0.9758199162485786}-{'f1_val': 0.9972450390152456, 'auprc': 0.99870159990347, 'loss_val': 0.043635291326408365, 'psi': 0.9978276633705354}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.766868 cos_to_last_merge=0.8290 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.829
[S4] round=41 local utility u=0.011699 metrics={'f1_val': 0.9576180514304193, 'auprc': 0.9520955561602487, 'loss_val': 0.31557680529305243, 'psi': 0.955409053322351}-{'f1_val': 0.9545505234510225, 'auprc': 0.9528296211976164, 'loss_val': 0.32277231875389095, 'psi': 0.95386216254966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=41 head_norm_before_train=1.357816 cos_to_last_merge=0.9368 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=41 local utility u=0.857883 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9921033057834839, 'loss_val': 0.260467623345127, 'psi': 0.817033681408209}-{'f1_val': 0.5758964874537015, 'auprc': 0.7953920089156105, 'loss_val': 0.6395548460944228, 'psi': 0.6636946960384651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=41 head_norm_before_train=1.587617 cos_to_last_merge=0.9669 (last merge round=14)
[S6] round=41 local utility u=0.894249 metrics={'f1_val': 0.8236595348286897, 'auprc': 0.9616954447689721, 'loss_val': 0.4861033875275235, 'psi': 0.8788738988048026}-{'f1_val': 0.6458746074732519, 'auprc': 0.8138298800537377, 'loss_val': 0.764295812340043, 'psi': 0.7130567165054462}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=41 head_norm_before_train=1.529006 cos_to_last_merge=0.9504 (last merge round=12)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.45698094973023684, 'auprc': 0.7816737515828281, 'loss_val': 1.2190397925612073, 'psi': 0.5868580704712734}-{'f1_val': 0.6965968630367012, 'auprc': 0.8839103339146966, 'loss_val': 0.3106549313422477, 'psi': 0.7715222513878994}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.736961 cos_to_last_merge=0.9661 (last merge round=16)
[S8] round=41 local utility u=0.004150 metrics={'f1_val': 0.9935462653440466, 'auprc': 0.999116100136913, 'loss_val': 0.03396471346689551, 'psi': 0.9957741992611931}-{'f1_val': 0.9925380579155019, 'auprc': 0.9989951572755235, 'loss_val': 0.03585276442670809, 'psi': 0.9951208976595105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=41 head_norm_before_train=2.048596 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9909938198082651, 'auprc': 0.9998568408181375, 'loss_val': 0.03171548839794072, 'psi': 0.994539028212214}-{'f1_val': 0.9962500947792776, 'auprc': 0.9967080885050547, 'loss_val': 0.019319174351887503, 'psi': 0.9964332922695884}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.909418 cos_to_last_merge=0.9323 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9959182839109816, 'loss_val': 0.029457534594594832, 'psi': 0.9953226362085426}-{'f1_val': 0.9951450524673635, 'auprc': 0.9959853958087923, 'loss_val': 0.029585954401539848, 'psi': 0.9954811898039351}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.388970 cos_to_last_merge=0.9323 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=41 local utility u=0.004848 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9955816651932102, 'loss_val': 0.20251190611757816, 'psi': 0.8193938560562761}-{'f1_val': 0.7019353166316534, 'auprc': 0.9960277220213868, 'loss_val': 0.21354623378159282, 'psi': 0.8195722787875468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=41 head_norm_before_train=1.297035 cos_to_last_merge=0.8339 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.834
[S13] round=41 local utility u=0.204219 metrics={'f1_val': 0.5710098722858296, 'auprc': 0.6856262760670072, 'loss_val': 0.785938334334152, 'psi': 0.6168564337983006}-{'f1_val': 0.5259054876760926, 'auprc': 0.6936413557954801, 'loss_val': 0.9477956607879008, 'psi': 0.5929998349238477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=41 head_norm_before_train=1.991630 cos_to_last_merge=0.9730 (last merge round=14)
[S14] round=41 local utility u=0.007037 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9990169673586903, 'loss_val': 0.02011086777920145, 'psi': 0.9980533835041729}-{'f1_val': 0.9957181379851651, 'auprc': 0.9990227327910279, 'loss_val': 0.024045946284788712, 'psi': 0.9970399759075101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=41 head_norm_before_train=1.671681 cos_to_last_merge=0.9300 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.930
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.8888253991344557, 'auprc': 0.9389890465501756, 'loss_val': 0.27984046731934875, 'psi': 0.9088908581007435}-{'f1_val': 0.9967466683875206, 'auprc': 0.991510768127675, 'loss_val': 0.032020308232442375, 'psi': 0.9946523082835823}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.715395 cos_to_last_merge=0.8931 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.893
[S16] round=41 local utility u=0.365647 metrics={'f1_val': 0.9763169778994079, 'auprc': 0.9945467270313183, 'loss_val': 0.08869190371541084, 'psi': 0.9836088775521721}-{'f1_val': 0.917900904964136, 'auprc': 0.9925166154241719, 'loss_val': 0.4633992377759785, 'psi': 0.9477471891481504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=41 head_norm_before_train=1.464938 cos_to_last_merge=0.9583 (last merge round=15)
[S17] round=41 local utility u=0.029845 metrics={'f1_val': 0.6701824197196291, 'auprc': 0.7839879730344791, 'loss_val': 0.9200077278492421, 'psi': 0.7157046410455691}-{'f1_val': 0.6360741478509929, 'auprc': 0.8356256649339434, 'loss_val': 0.9299610922349384, 'psi': 0.7158947546841732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=42 head_norm_before_train=1.649525 cos_to_last_merge=0.7197 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.720
[S2] round=42 local utility u=0.223597 metrics={'f1_val': 0.8259872624526351, 'auprc': 0.8560557063264449, 'loss_val': 0.4018469341295904, 'psi': 0.8380146400021591}-{'f1_val': 0.7505390265134074, 'auprc': 0.8671767772671399, 'loss_val': 0.42971435991560314, 'psi': 0.7971941268149004}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=42 head_norm_before_train=1.811448 cos_to_last_merge=0.7624 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.762
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9984952601595697, 'loss_val': 0.49597632916326506, 'psi': 0.8198998415099015}-{'f1_val': 0.9608203197691346, 'auprc': 0.9983193109677447, 'loss_val': 0.10055611401326583, 'psi': 0.9758199162485786}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.776667 cos_to_last_merge=0.8281 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.828
[S4] round=42 local utility u=0.001546 metrics={'f1_val': 0.9571633195860544, 'auprc': 0.9532588569780392, 'loss_val': 0.3132471283351485, 'psi': 0.9556015345428484}-{'f1_val': 0.9576180514304193, 'auprc': 0.9520955561602487, 'loss_val': 0.31557680529305243, 'psi': 0.955409053322351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=42 head_norm_before_train=1.361132 cos_to_last_merge=0.9365 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9569697958203691, 'loss_val': 0.2952428718478091, 'psi': 0.8029802774229631}-{'f1_val': 0.700320598491359, 'auprc': 0.9921033057834839, 'loss_val': 0.260467623345127, 'psi': 0.817033681408209}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.595795 cos_to_last_merge=0.9662 (last merge round=14)
[S6] round=42 local utility u=0.161620 metrics={'f1_val': 0.83966244570175, 'auprc': 0.9641832446943506, 'loss_val': 0.2663441189566215, 'psi': 0.8894707652987901}-{'f1_val': 0.8236595348286897, 'auprc': 0.9616954447689721, 'loss_val': 0.4861033875275235, 'psi': 0.8788738988048026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=42 head_norm_before_train=1.529203 cos_to_last_merge=0.9505 (last merge round=12)
[S7] round=42 local utility u=1.000000 metrics={'f1_val': 0.7469716175746408, 'auprc': 0.9923823816222886, 'loss_val': 0.18249726932946897, 'psi': 0.8451359231936999}-{'f1_val': 0.45698094973023684, 'auprc': 0.7816737515828281, 'loss_val': 1.2190397925612073, 'psi': 0.5868580704712734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=42 head_norm_before_train=1.747395 cos_to_last_merge=0.9656 (last merge round=16)
[S8] round=42 local utility u=0.000270 metrics={'f1_val': 0.9935462653440466, 'auprc': 0.9991458744648698, 'loss_val': 0.03351495204021913, 'psi': 0.9957861089923759}-{'f1_val': 0.9935462653440466, 'auprc': 0.999116100136913, 'loss_val': 0.03396471346689551, 'psi': 0.9957741992611931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=42 head_norm_before_train=2.054953 (no previous merge yet)
[S9] round=42 local utility u=0.007776 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9998525836018601, 'loss_val': 0.026294301025164373, 'psi': 0.9955517185296628}-{'f1_val': 0.9909938198082651, 'auprc': 0.9998568408181375, 'loss_val': 0.03171548839794072, 'psi': 0.994539028212214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=42 head_norm_before_train=1.917089 cos_to_last_merge=0.9315 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.931
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9947060979488367, 'auprc': 0.9961128959938685, 'loss_val': 0.029324895993497222, 'psi': 0.9952688171668495}-{'f1_val': 0.9949255377402499, 'auprc': 0.9959182839109816, 'loss_val': 0.029457534594594832, 'psi': 0.9953226362085426}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.401109 cos_to_last_merge=0.9298 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=42 local utility u=0.006795 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9932523365175803, 'loss_val': 0.18154229205742467, 'psi': 0.8184230057605808}-{'f1_val': 0.7019353166316534, 'auprc': 0.9955816651932102, 'loss_val': 0.20251190611757816, 'psi': 0.8193938560562761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=42 head_norm_before_train=1.305431 cos_to_last_merge=0.8326 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.833
[S13] round=42 local utility u=0.058043 metrics={'f1_val': 0.5822450919801188, 'auprc': 0.6813945571944365, 'loss_val': 0.7245686243215071, 'psi': 0.6219048780658458}-{'f1_val': 0.5710098722858296, 'auprc': 0.6856262760670072, 'loss_val': 0.785938334334152, 'psi': 0.6168564337983006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=42 head_norm_before_train=2.002558 cos_to_last_merge=0.9724 (last merge round=14)
[S14] round=42 local utility u=0.002594 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9990268669453077, 'loss_val': 0.017416206980807276, 'psi': 0.9983038023907785}-{'f1_val': 0.9974109942678281, 'auprc': 0.9990169673586903, 'loss_val': 0.02011086777920145, 'psi': 0.9980533835041729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=42 head_norm_before_train=1.683129 cos_to_last_merge=0.9287 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=42 local utility u=0.137927 metrics={'f1_val': 0.896648540278068, 'auprc': 0.9930927381157133, 'loss_val': 0.21323701824150654, 'psi': 0.9352262194131261}-{'f1_val': 0.8888253991344557, 'auprc': 0.9389890465501756, 'loss_val': 0.27984046731934875, 'psi': 0.9088908581007435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=42 head_norm_before_train=1.724013 cos_to_last_merge=0.8921 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.892
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9391777568749047, 'auprc': 0.9933657199877088, 'loss_val': 0.2725955487819205, 'psi': 0.9608529421200264}-{'f1_val': 0.9763169778994079, 'auprc': 0.9945467270313183, 'loss_val': 0.08869190371541084, 'psi': 0.9836088775521721}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.477205 cos_to_last_merge=0.9567 (last merge round=15)
[S17] round=42 local utility u=0.030255 metrics={'f1_val': 0.689653877273456, 'auprc': 0.7731823841704764, 'loss_val': 0.9439092913147924, 'psi': 0.7230652800322641}-{'f1_val': 0.6701824197196291, 'auprc': 0.7839879730344791, 'loss_val': 0.9200077278492421, 'psi': 0.7157046410455691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=43 head_norm_before_train=1.658307 cos_to_last_merge=0.7187 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.719
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.8213860713360337, 'auprc': 0.8303487677909256, 'loss_val': 0.40544621683066123, 'psi': 0.8249711499179904}-{'f1_val': 0.8259872624526351, 'auprc': 0.8560557063264449, 'loss_val': 0.4018469341295904, 'psi': 0.8380146400021591}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.821912 cos_to_last_merge=0.7608 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.761
[S3] round=43 local utility u=1.000000 metrics={'f1_val': 0.971874502309285, 'auprc': 0.9987955757230291, 'loss_val': 0.08712128148343821, 'psi': 0.9826429316747827}-{'f1_val': 0.7008362290767893, 'auprc': 0.9984952601595697, 'loss_val': 0.49597632916326506, 'psi': 0.8198998415099015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=43 head_norm_before_train=1.788339 cos_to_last_merge=0.8268 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.827
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9572455031632202, 'auprc': 0.9519409575351621, 'loss_val': 0.3099972146804072, 'psi': 0.9551236849119971}-{'f1_val': 0.9571633195860544, 'auprc': 0.9532588569780392, 'loss_val': 0.3132471283351485, 'psi': 0.9556015345428484}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.368022 cos_to_last_merge=0.9360 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.936
[S5] round=43 local utility u=0.067823 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9848441258408271, 'loss_val': 0.24322064863531404, 'psi': 0.8141300094311463}-{'f1_val': 0.700320598491359, 'auprc': 0.9569697958203691, 'loss_val': 0.2952428718478091, 'psi': 0.8029802774229631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=43 head_norm_before_train=1.604590 cos_to_last_merge=0.9653 (last merge round=14)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.8245447508845893, 'auprc': 0.9547579662282192, 'loss_val': 0.4235448079825143, 'psi': 0.8766300370220412}-{'f1_val': 0.83966244570175, 'auprc': 0.9641832446943506, 'loss_val': 0.2663441189566215, 'psi': 0.8894707652987901}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.529225 cos_to_last_merge=0.9505 (last merge round=12)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5843807706013108, 'auprc': 0.7874921754070772, 'loss_val': 0.6969127182315583, 'psi': 0.6656253325236173}-{'f1_val': 0.7469716175746408, 'auprc': 0.9923823816222886, 'loss_val': 0.18249726932946897, 'psi': 0.8451359231936999}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.758166 cos_to_last_merge=0.9648 (last merge round=16)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9935462653440466, 'auprc': 0.999167911845867, 'loss_val': 0.0337525309151788, 'psi': 0.9957949239447748}-{'f1_val': 0.9935462653440466, 'auprc': 0.9991458744648698, 'loss_val': 0.03351495204021913, 'psi': 0.9957861089923759}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=2.060982 (no previous merge yet)
[S9] round=43 local utility u=0.015595 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9997143839319106, 'loss_val': 0.01854582139209741, 'psi': 0.9978820606610991}-{'f1_val': 0.992684475148198, 'auprc': 0.9998525836018601, 'loss_val': 0.026294301025164373, 'psi': 0.9955517185296628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=43 head_norm_before_train=1.923834 cos_to_last_merge=0.9305 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.931
[S10] round=43 local utility u=0.001076 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9962577772785337, 'loss_val': 0.028924756538374157, 'psi': 0.9954584335555634}-{'f1_val': 0.9947060979488367, 'auprc': 0.9961128959938685, 'loss_val': 0.029324895993497222, 'psi': 0.9952688171668495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=43 head_norm_before_train=1.414839 cos_to_last_merge=0.9272 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.927
[S11] round=43 local utility u=0.780031 metrics={'f1_val': 0.9592161590226278, 'auprc': 0.9932262763694161, 'loss_val': 0.16547786645859197, 'psi': 0.9728202059613431}-{'f1_val': 0.7018701185892477, 'auprc': 0.9932523365175803, 'loss_val': 0.18154229205742467, 'psi': 0.8184230057605808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=43 head_norm_before_train=1.314502 cos_to_last_merge=0.8314 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.831
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5461345996366453, 'auprc': 0.6867379993604958, 'loss_val': 0.8222693069331802, 'psi': 0.6023759595261855}-{'f1_val': 0.5822450919801188, 'auprc': 0.6813945571944365, 'loss_val': 0.7245686243215071, 'psi': 0.6219048780658458}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.012518 cos_to_last_merge=0.9718 (last merge round=14)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.939858001046695, 'auprc': 0.9996995231532756, 'loss_val': 0.07726426906177584, 'psi': 0.9637946098893273}-{'f1_val': 0.9978217593544257, 'auprc': 0.9990268669453077, 'loss_val': 0.017416206980807276, 'psi': 0.9983038023907785}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.694681 cos_to_last_merge=0.9276 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.928
[S15] round=43 local utility u=0.391678 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9931055580894093, 'loss_val': 0.030508437921967137, 'psi': 0.9952902242682761}-{'f1_val': 0.896648540278068, 'auprc': 0.9930927381157133, 'loss_val': 0.21323701824150654, 'psi': 0.9352262194131261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=43 head_norm_before_train=1.733266 cos_to_last_merge=0.8910 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.891
[S16] round=43 local utility u=0.010735 metrics={'f1_val': 0.9391777568749047, 'auprc': 0.9933742703799306, 'loss_val': 0.25115154980496157, 'psi': 0.9608563622769151}-{'f1_val': 0.9391777568749047, 'auprc': 0.9933657199877088, 'loss_val': 0.2725955487819205, 'psi': 0.9608529421200264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=43 head_norm_before_train=1.490221 cos_to_last_merge=0.9547 (last merge round=15)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.650380684662202, 'auprc': 0.7997823901544961, 'loss_val': 0.9619504519376627, 'psi': 0.7101413668591197}-{'f1_val': 0.689653877273456, 'auprc': 0.7731823841704764, 'loss_val': 0.9439092913147924, 'psi': 0.7230652800322641}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.671216 cos_to_last_merge=0.7174 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.717
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.7566519045789413, 'auprc': 0.8408316842676202, 'loss_val': 0.6866976506359674, 'psi': 0.7903238164544129}-{'f1_val': 0.8213860713360337, 'auprc': 0.8303487677909256, 'loss_val': 0.40544621683066123, 'psi': 0.8249711499179904}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.828253 cos_to_last_merge=0.7597 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.760
[S3] round=44 local utility u=0.086861 metrics={'f1_val': 0.9943374116395723, 'auprc': 0.9986773452682436, 'loss_val': 0.047821718553664426, 'psi': 0.9960733850910408}-{'f1_val': 0.971874502309285, 'auprc': 0.9987955757230291, 'loss_val': 0.08712128148343821, 'psi': 0.9826429316747827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=44 head_norm_before_train=1.794371 cos_to_last_merge=0.8262 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.826
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9561426977817193, 'auprc': 0.9502812313903235, 'loss_val': 0.3068161013406121, 'psi': 0.953798111225161}-{'f1_val': 0.9572455031632202, 'auprc': 0.9519409575351621, 'loss_val': 0.3099972146804072, 'psi': 0.9551236849119971}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.378295 cos_to_last_merge=0.9352 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.6656993843252828, 'auprc': 0.8582441745448812, 'loss_val': 0.389405311620474, 'psi': 0.7427173004131222}-{'f1_val': 0.700320598491359, 'auprc': 0.9848441258408271, 'loss_val': 0.24322064863531404, 'psi': 0.8141300094311463}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.610471 cos_to_last_merge=0.9647 (last merge round=14)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.824258282215892, 'auprc': 0.9518668447367462, 'loss_val': 0.4351291154515344, 'psi': 0.8753017072242337}-{'f1_val': 0.8245447508845893, 'auprc': 0.9547579662282192, 'loss_val': 0.4235448079825143, 'psi': 0.8766300370220412}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.529038 cos_to_last_merge=0.9506 (last merge round=12)
[S7] round=44 local utility u=0.447652 metrics={'f1_val': 0.6675547999769497, 'auprc': 0.8229703502915009, 'loss_val': 0.4070882660606173, 'psi': 0.7297210201027702}-{'f1_val': 0.5843807706013108, 'auprc': 0.7874921754070772, 'loss_val': 0.6969127182315583, 'psi': 0.6656253325236173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=44 head_norm_before_train=1.763429 cos_to_last_merge=0.9642 (last merge round=16)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.9983381763670146, 'loss_val': 0.03760442026382057, 'psi': 0.9939869001922467}-{'f1_val': 0.9935462653440466, 'auprc': 0.999167911845867, 'loss_val': 0.0337525309151788, 'psi': 0.9957949239447748}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=2.065943 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9999298193604439, 'loss_val': 0.02435197799473684, 'psi': 0.9960670370500001}-{'f1_val': 0.9966605118138915, 'auprc': 0.9997143839319106, 'loss_val': 0.01854582139209741, 'psi': 0.9978820606610991}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.932160 cos_to_last_merge=0.9297 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=44 local utility u=0.000450 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9964125989582109, 'loss_val': 0.02848833801338395, 'psi': 0.9955203622274343}-{'f1_val': 0.9949255377402499, 'auprc': 0.9962577772785337, 'loss_val': 0.028924756538374157, 'psi': 0.9954584335555634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=44 head_norm_before_train=1.430936 cos_to_last_merge=0.9242 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.924
[S11] round=44 local utility u=0.126200 metrics={'f1_val': 0.9969406902828911, 'auprc': 0.9931059600854353, 'loss_val': 0.13906386396442022, 'psi': 0.9954067982039088}-{'f1_val': 0.9592161590226278, 'auprc': 0.9932262763694161, 'loss_val': 0.16547786645859197, 'psi': 0.9728202059613431}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=44 head_norm_before_train=1.321828 cos_to_last_merge=0.8306 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.831
[S13] round=44 local utility u=0.181553 metrics={'f1_val': 0.5962276464805352, 'auprc': 0.6833388751921146, 'loss_val': 0.749524881071963, 'psi': 0.6310721379651669}-{'f1_val': 0.5461345996366453, 'auprc': 0.6867379993604958, 'loss_val': 0.8222693069331802, 'psi': 0.6023759595261855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=44 head_norm_before_train=2.019465 cos_to_last_merge=0.9714 (last merge round=14)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.8772348968105376, 'auprc': 0.999781063815225, 'loss_val': 0.31645690995261166, 'psi': 0.9262533636124126}-{'f1_val': 0.939858001046695, 'auprc': 0.9996995231532756, 'loss_val': 0.07726426906177584, 'psi': 0.9637946098893273}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.706238 cos_to_last_merge=0.9263 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.926
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.9003683915509155, 'auprc': 0.9922854885255998, 'loss_val': 0.20292969457139579, 'psi': 0.9371352303407893}-{'f1_val': 0.9967466683875206, 'auprc': 0.9931055580894093, 'loss_val': 0.030508437921967137, 'psi': 0.9952902242682761}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.743678 cos_to_last_merge=0.8899 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.890
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9339558938797354, 'auprc': 0.9933178037245989, 'loss_val': 0.35170483937437785, 'psi': 0.9577006578176808}-{'f1_val': 0.9391777568749047, 'auprc': 0.9933742703799306, 'loss_val': 0.25115154980496157, 'psi': 0.9608563622769151}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.501809 cos_to_last_merge=0.9529 (last merge round=15)
[S17] round=44 local utility u=0.414877 metrics={'f1_val': 0.6764928018028475, 'auprc': 0.8791078610994653, 'loss_val': 0.526844842612073, 'psi': 0.7575388255214947}-{'f1_val': 0.650380684662202, 'auprc': 0.7997823901544961, 'loss_val': 0.9619504519376627, 'psi': 0.7101413668591197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=45 head_norm_before_train=1.686155 cos_to_last_merge=0.7160 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.716
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6863765332438769, 'auprc': 0.7596023330990378, 'loss_val': 0.9877386521840428, 'psi': 0.7156668531859414}-{'f1_val': 0.7566519045789413, 'auprc': 0.8408316842676202, 'loss_val': 0.6866976506359674, 'psi': 0.7903238164544129}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.834250 cos_to_last_merge=0.7590 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.759
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9323461787551682, 'auprc': 0.9984974377827722, 'loss_val': 0.15434227790773614, 'psi': 0.9588066823662098}-{'f1_val': 0.9943374116395723, 'auprc': 0.9986773452682436, 'loss_val': 0.047821718553664426, 'psi': 0.9960733850910408}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.797064 cos_to_last_merge=0.8254 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.825
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9557858648280619, 'auprc': 0.9493686435703161, 'loss_val': 0.3041418488567825, 'psi': 0.9532189763249637}-{'f1_val': 0.9561426977817193, 'auprc': 0.9502812313903235, 'loss_val': 0.3068161013406121, 'psi': 0.953798111225161}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.388764 cos_to_last_merge=0.9342 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.6313977112106822, 'auprc': 0.795934803200151, 'loss_val': 0.48466645702068156, 'psi': 0.6972125480064697}-{'f1_val': 0.6656993843252828, 'auprc': 0.8582441745448812, 'loss_val': 0.389405311620474, 'psi': 0.7427173004131222}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.619722 cos_to_last_merge=0.9639 (last merge round=14)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.7433316196898725, 'auprc': 0.9412785827721811, 'loss_val': 0.6238233870647139, 'psi': 0.822510404922796}-{'f1_val': 0.824258282215892, 'auprc': 0.9518668447367462, 'loss_val': 0.4351291154515344, 'psi': 0.8753017072242337}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.532305 cos_to_last_merge=0.9501 (last merge round=12)
[S7] round=45 local utility u=0.024815 metrics={'f1_val': 0.673298662731205, 'auprc': 0.8252427219312769, 'loss_val': 0.3987389223771645, 'psi': 0.7340762864112338}-{'f1_val': 0.6675547999769497, 'auprc': 0.8229703502915009, 'loss_val': 0.4070882660606173, 'psi': 0.7297210201027702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=45 head_norm_before_train=1.771407 cos_to_last_merge=0.9637 (last merge round=16)
[S8] round=45 local utility u=0.005813 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9990141397543457, 'loss_val': 0.034534551918120715, 'psi': 0.9949102001198054}-{'f1_val': 0.9910860494090681, 'auprc': 0.9983381763670146, 'loss_val': 0.03760442026382057, 'psi': 0.9939869001922467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=45 head_norm_before_train=2.071481 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9884223813560973, 'auprc': 0.9997686211598663, 'loss_val': 0.04053472271228875, 'psi': 0.9929608772776048}-{'f1_val': 0.9934918488430377, 'auprc': 0.9999298193604439, 'loss_val': 0.02435197799473684, 'psi': 0.9960670370500001}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.941254 cos_to_last_merge=0.9289 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9961658245799607, 'loss_val': 0.02848186330117371, 'psi': 0.9954216524761343}-{'f1_val': 0.9949255377402499, 'auprc': 0.9964125989582109, 'loss_val': 0.02848833801338395, 'psi': 0.9955203622274343}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.449227 cos_to_last_merge=0.9207 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.921
[S11] round=45 local utility u=0.011878 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9929347871402613, 'loss_val': 0.11231166994740273, 'psi': 0.9950900337534837}-{'f1_val': 0.9969406902828911, 'auprc': 0.9931059600854353, 'loss_val': 0.13906386396442022, 'psi': 0.9954067982039088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=45 head_norm_before_train=1.329966 cos_to_last_merge=0.8301 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.830
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.5281973405610646, 'auprc': 0.6938150999890362, 'loss_val': 0.9807522189068002, 'psi': 0.5944444443322532}-{'f1_val': 0.5962276464805352, 'auprc': 0.6833388751921146, 'loss_val': 0.749524881071963, 'psi': 0.6310721379651669}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.026386 cos_to_last_merge=0.9709 (last merge round=14)
[S14] round=45 local utility u=0.269934 metrics={'f1_val': 0.9348333309509266, 'auprc': 0.9998003149308035, 'loss_val': 0.1222367341301265, 'psi': 0.9608201245428774}-{'f1_val': 0.8772348968105376, 'auprc': 0.999781063815225, 'loss_val': 0.31645690995261166, 'psi': 0.9262533636124126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=45 head_norm_before_train=1.717598 cos_to_last_merge=0.9250 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.925
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.8956332365569201, 'auprc': 0.9432244269798612, 'loss_val': 0.2946283274793321, 'psi': 0.9146697127260965}-{'f1_val': 0.9003683915509155, 'auprc': 0.9922854885255998, 'loss_val': 0.20292969457139579, 'psi': 0.9371352303407893}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.753270 cos_to_last_merge=0.8888 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.889
[S16] round=45 local utility u=0.064830 metrics={'f1_val': 0.9389642467473863, 'auprc': 0.9943362069441273, 'loss_val': 0.2551508932243295, 'psi': 0.9611130308260827}-{'f1_val': 0.9339558938797354, 'auprc': 0.9933178037245989, 'loss_val': 0.35170483937437785, 'psi': 0.9577006578176808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=45 head_norm_before_train=1.515066 cos_to_last_merge=0.9508 (last merge round=15)
[S17] round=45 local utility u=0.404989 metrics={'f1_val': 0.755004221474744, 'auprc': 0.9399690214189922, 'loss_val': 0.3705190834687196, 'psi': 0.8289901414524432}-{'f1_val': 0.6764928018028475, 'auprc': 0.8791078610994653, 'loss_val': 0.526844842612073, 'psi': 0.7575388255214947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=46 head_norm_before_train=1.700517 cos_to_last_merge=0.7146 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.715
[S2] round=46 local utility u=0.644767 metrics={'f1_val': 0.7573570784292094, 'auprc': 0.8680191604399744, 'loss_val': 0.44933887086154695, 'psi': 0.8016219112335154}-{'f1_val': 0.6863765332438769, 'auprc': 0.7596023330990378, 'loss_val': 0.9877386521840428, 'psi': 0.7156668531859414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=46 head_norm_before_train=1.843333 cos_to_last_merge=0.7580 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.758
[S3] round=46 local utility u=0.169454 metrics={'f1_val': 0.9739501928779803, 'auprc': 0.998521047070721, 'loss_val': 0.06512893150456549, 'psi': 0.9837785345550767}-{'f1_val': 0.9323461787551682, 'auprc': 0.9984974377827722, 'loss_val': 0.15434227790773614, 'psi': 0.9588066823662098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=46 head_norm_before_train=1.806250 cos_to_last_merge=0.8243 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.824
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9547690611963517, 'auprc': 0.9384498774242049, 'loss_val': 0.3061739382861326, 'psi': 0.948241387687493}-{'f1_val': 0.9557858648280619, 'auprc': 0.9493686435703161, 'loss_val': 0.3041418488567825, 'psi': 0.9532189763249637}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.396315 cos_to_last_merge=0.9334 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=46 local utility u=0.625663 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.990879591684612, 'loss_val': 0.23171725086331177, 'psi': 0.8165446271341931}-{'f1_val': 0.6313977112106822, 'auprc': 0.795934803200151, 'loss_val': 0.48466645702068156, 'psi': 0.6972125480064697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=46 head_norm_before_train=1.632291 cos_to_last_merge=0.9627 (last merge round=14)
[S6] round=46 local utility u=0.091940 metrics={'f1_val': 0.7655636127775458, 'auprc': 0.9476925756455264, 'loss_val': 0.5925782052461406, 'psi': 0.8384151979247381}-{'f1_val': 0.7433316196898725, 'auprc': 0.9412785827721811, 'loss_val': 0.6238233870647139, 'psi': 0.822510404922796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=46 head_norm_before_train=1.537078 cos_to_last_merge=0.9495 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.6606155067881221, 'auprc': 0.8059673180763262, 'loss_val': 0.4783065416487783, 'psi': 0.7187562313034037}-{'f1_val': 0.673298662731205, 'auprc': 0.8252427219312769, 'loss_val': 0.3987389223771645, 'psi': 0.7340762864112338}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.784207 cos_to_last_merge=0.9628 (last merge round=16)
[S8] round=46 local utility u=0.004369 metrics={'f1_val': 0.9931808101287989, 'auprc': 0.9991536486132484, 'loss_val': 0.032253543149088924, 'psi': 0.9955699455225787}-{'f1_val': 0.992174240363445, 'auprc': 0.9990141397543457, 'loss_val': 0.034534551918120715, 'psi': 0.9949102001198054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=46 head_norm_before_train=2.078477 (no previous merge yet)
[S9] round=46 local utility u=0.029899 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9958898304505905, 'loss_val': 0.018720573885102, 'psi': 0.9963714269390935}-{'f1_val': 0.9884223813560973, 'auprc': 0.9997686211598663, 'loss_val': 0.04053472271228875, 'psi': 0.9929608772776048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=46 head_norm_before_train=1.946474 cos_to_last_merge=0.9281 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.928
[S10] round=46 local utility u=0.000181 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9962102866827549, 'loss_val': 0.02825292731562369, 'psi': 0.9954394373172519}-{'f1_val': 0.9949255377402499, 'auprc': 0.9961658245799607, 'loss_val': 0.02848186330117371, 'psi': 0.9954216524761343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S11] START round=46 head_norm_before_train=1.469303 cos_to_last_merge=0.9164 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.916
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.8934249594214867, 'auprc': 0.9946181277485807, 'loss_val': 0.6299386693842767, 'psi': 0.9339022267523243}-{'f1_val': 0.9965268648289654, 'auprc': 0.9929347871402613, 'loss_val': 0.11231166994740273, 'psi': 0.9950900337534837}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.338186 cos_to_last_merge=0.8289 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.829
[S13] round=46 local utility u=0.242683 metrics={'f1_val': 0.563922818160797, 'auprc': 0.677130648104442, 'loss_val': 0.6596854199722101, 'psi': 0.609205950138255}-{'f1_val': 0.5281973405610646, 'auprc': 0.6938150999890362, 'loss_val': 0.9807522189068002, 'psi': 0.5944444443322532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=46 head_norm_before_train=2.033057 cos_to_last_merge=0.9705 (last merge round=14)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.8813366024016369, 'auprc': 0.9990550812730725, 'loss_val': 0.5671405498104614, 'psi': 0.9284239939502111}-{'f1_val': 0.9348333309509266, 'auprc': 0.9998003149308035, 'loss_val': 0.1222367341301265, 'psi': 0.9608201245428774}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.728799 cos_to_last_merge=0.9236 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.924
[S15] round=46 local utility u=0.484234 metrics={'f1_val': 0.9909647443628967, 'auprc': 0.9941305639206461, 'loss_val': 0.05086774496790948, 'psi': 0.9922310721859964}-{'f1_val': 0.8956332365569201, 'auprc': 0.9432244269798612, 'loss_val': 0.2946283274793321, 'psi': 0.9146697127260965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=46 head_norm_before_train=1.763155 cos_to_last_merge=0.8876 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.888
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9389642467473863, 'auprc': 0.9943706939337267, 'loss_val': 0.2586345502965964, 'psi': 0.9611268256219225}-{'f1_val': 0.9389642467473863, 'auprc': 0.9943362069441273, 'loss_val': 0.2551508932243295, 'psi': 0.9611130308260827}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.531495 cos_to_last_merge=0.9481 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.948
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6564203158124904, 'auprc': 0.6782970087785535, 'loss_val': 1.12100102413988, 'psi': 0.6651709929989156}-{'f1_val': 0.755004221474744, 'auprc': 0.9399690214189922, 'loss_val': 0.3705190834687196, 'psi': 0.8289901414524432}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.712407 cos_to_last_merge=0.7135 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.713
[S2] round=47 local utility u=0.110259 metrics={'f1_val': 0.8026064115862914, 'auprc': 0.8611079606968641, 'loss_val': 0.4795823532501716, 'psi': 0.8260070312305205}-{'f1_val': 0.7573570784292094, 'auprc': 0.8680191604399744, 'loss_val': 0.44933887086154695, 'psi': 0.8016219112335154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=47 head_norm_before_train=1.854281 cos_to_last_merge=0.7568 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.757
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.8109849045795909, 'auprc': 0.9987689573859596, 'loss_val': 0.37436795508212134, 'psi': 0.8860985257021384}-{'f1_val': 0.9739501928779803, 'auprc': 0.998521047070721, 'loss_val': 0.06512893150456549, 'psi': 0.9837785345550767}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.812644 cos_to_last_merge=0.8237 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.824
[S4] round=47 local utility u=0.042252 metrics={'f1_val': 0.9578043098658231, 'auprc': 0.9583898882516773, 'loss_val': 0.299702420083306, 'psi': 0.9580385412201647}-{'f1_val': 0.9547690611963517, 'auprc': 0.9384498774242049, 'loss_val': 0.3061739382861326, 'psi': 0.948241387687493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=47 head_norm_before_train=1.401463 cos_to_last_merge=0.9328 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8555680475192341, 'loss_val': 0.36064452527151747, 'psi': 0.762419578102509}-{'f1_val': 0.7003213174339138, 'auprc': 0.990879591684612, 'loss_val': 0.23171725086331177, 'psi': 0.8165446271341931}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.644773 cos_to_last_merge=0.9612 (last merge round=14)
[S6] round=47 local utility u=0.828659 metrics={'f1_val': 0.9599345285320102, 'auprc': 0.9661569024213901, 'loss_val': 0.15687862562109814, 'psi': 0.9624234780877622}-{'f1_val': 0.7655636127775458, 'auprc': 0.9476925756455264, 'loss_val': 0.5925782052461406, 'psi': 0.8384151979247381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=47 head_norm_before_train=1.544858 cos_to_last_merge=0.9484 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.948
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6542982130063765, 'auprc': 0.8034881806694163, 'loss_val': 0.5085132445206282, 'psi': 0.7139742000715924}-{'f1_val': 0.6606155067881221, 'auprc': 0.8059673180763262, 'loss_val': 0.4783065416487783, 'psi': 0.7187562313034037}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.796846 cos_to_last_merge=0.9621 (last merge round=16)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9933434229799246, 'auprc': 0.9928737203729533, 'loss_val': 0.035234532728344786, 'psi': 0.9931555419371361}-{'f1_val': 0.9931808101287989, 'auprc': 0.9991536486132484, 'loss_val': 0.032253543149088924, 'psi': 0.9955699455225787}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=2.086006 (no previous merge yet)
[S9] round=47 local utility u=0.007606 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9996332692747486, 'loss_val': 0.017200907089608, 'psi': 0.9981150552171851}-{'f1_val': 0.9966924912647621, 'auprc': 0.9958898304505905, 'loss_val': 0.018720573885102, 'psi': 0.9963714269390935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=47 head_norm_before_train=1.952178 cos_to_last_merge=0.9273 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=47 local utility u=0.000010 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9961185709075946, 'loss_val': 0.0279572208242242, 'psi': 0.9954027510071879}-{'f1_val': 0.9949255377402499, 'auprc': 0.9962102866827549, 'loss_val': 0.02825292731562369, 'psi': 0.9954394373172519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=47 head_norm_before_train=1.488941 cos_to_last_merge=0.9124 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.912
[S11] round=47 local utility u=0.584067 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9948467395621037, 'loss_val': 0.07977113347717527, 'psi': 0.995721796306158}-{'f1_val': 0.8934249594214867, 'auprc': 0.9946181277485807, 'loss_val': 0.6299386693842767, 'psi': 0.9339022267523243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=47 head_norm_before_train=1.343466 cos_to_last_merge=0.8278 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.828
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.5453999630112336, 'auprc': 0.6895821929244007, 'loss_val': 0.8644010883752747, 'psi': 0.6030728549765004}-{'f1_val': 0.563922818160797, 'auprc': 0.677130648104442, 'loss_val': 0.6596854199722101, 'psi': 0.609205950138255}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.039095 cos_to_last_merge=0.9702 (last merge round=14)
[S14] round=47 local utility u=0.485764 metrics={'f1_val': 0.9661248203126626, 'auprc': 0.9989727179378988, 'loss_val': 0.10409443746719654, 'psi': 0.979263979362757}-{'f1_val': 0.8813366024016369, 'auprc': 0.9990550812730725, 'loss_val': 0.5671405498104614, 'psi': 0.9284239939502111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=47 head_norm_before_train=1.736424 cos_to_last_merge=0.9225 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.923
[S15] round=47 local utility u=0.022279 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9914451472917714, 'loss_val': 0.030364373748708713, 'psi': 0.9943679216892611}-{'f1_val': 0.9909647443628967, 'auprc': 0.9941305639206461, 'loss_val': 0.05086774496790948, 'psi': 0.9922310721859964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=47 head_norm_before_train=1.772118 cos_to_last_merge=0.8866 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.887
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9145565275354209, 'auprc': 0.99305130317706, 'loss_val': 0.5049718588945684, 'psi': 0.9459544377920766}-{'f1_val': 0.9389642467473863, 'auprc': 0.9943706939337267, 'loss_val': 0.2586345502965964, 'psi': 0.9611268256219225}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.546515 cos_to_last_merge=0.9455 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=47 local utility u=0.532408 metrics={'f1_val': 0.6888020356273719, 'auprc': 0.8591457134687681, 'loss_val': 0.7930206714413343, 'psi': 0.7569395067639304}-{'f1_val': 0.6564203158124904, 'auprc': 0.6782970087785535, 'loss_val': 1.12100102413988, 'psi': 0.6651709929989156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=48 head_norm_before_train=1.725819 cos_to_last_merge=0.7123 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.712
[S2] round=48 local utility u=0.056368 metrics={'f1_val': 0.8148132433373052, 'auprc': 0.8666837547873505, 'loss_val': 0.4568139637497598, 'psi': 0.8355614479173233}-{'f1_val': 0.8026064115862914, 'auprc': 0.8611079606968641, 'loss_val': 0.4795823532501716, 'psi': 0.8260070312305205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=48 head_norm_before_train=1.868570 cos_to_last_merge=0.7553 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.755
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.7180772992375613, 'auprc': 0.9988679114116379, 'loss_val': 0.5334120183721331, 'psi': 0.8303935441071919}-{'f1_val': 0.8109849045795909, 'auprc': 0.9987689573859596, 'loss_val': 0.37436795508212134, 'psi': 0.8860985257021384}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.822079 cos_to_last_merge=0.8230 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.823
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9537816427163957, 'auprc': 0.9325268167800516, 'loss_val': 0.3111452818282516, 'psi': 0.945279712341858}-{'f1_val': 0.9578043098658231, 'auprc': 0.9583898882516773, 'loss_val': 0.299702420083306, 'psi': 0.9580385412201647}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.406770 cos_to_last_merge=0.9322 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.932
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.5885189353606763, 'auprc': 0.7751324829692386, 'loss_val': 0.5821251685808503, 'psi': 0.6631643544041013}-{'f1_val': 0.700320598491359, 'auprc': 0.8555680475192341, 'loss_val': 0.36064452527151747, 'psi': 0.762419578102509}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.656128 cos_to_last_merge=0.9604 (last merge round=14)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.7626451142383381, 'auprc': 0.8148044923251632, 'loss_val': 0.6622687216113142, 'psi': 0.7835088654730682}-{'f1_val': 0.9599345285320102, 'auprc': 0.9661569024213901, 'loss_val': 0.15687862562109814, 'psi': 0.9624234780877622}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.553857 cos_to_last_merge=0.9473 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.947
[S7] round=48 local utility u=0.143826 metrics={'f1_val': 0.6782448801930916, 'auprc': 0.819675650756605, 'loss_val': 0.41310333689458856, 'psi': 0.7348171884184969}-{'f1_val': 0.6542982130063765, 'auprc': 0.8034881806694163, 'loss_val': 0.5085132445206282, 'psi': 0.7139742000715924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=48 head_norm_before_train=1.808121 cos_to_last_merge=0.9615 (last merge round=16)
[S8] round=48 local utility u=0.001885 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9981343414870817, 'loss_val': 0.0358754882670307, 'psi': 0.9941226795206688}-{'f1_val': 0.9933434229799246, 'auprc': 0.9928737203729533, 'loss_val': 0.035234532728344786, 'psi': 0.9931555419371361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=48 head_norm_before_train=2.091359 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9999147402635968, 'loss_val': 0.021265439604465485, 'psi': 0.9967300858750602}-{'f1_val': 0.9971029125121428, 'auprc': 0.9996332692747486, 'loss_val': 0.017200907089608, 'psi': 0.9981150552171851}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.959526 cos_to_last_merge=0.9266 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9960481250808197, 'loss_val': 0.027790352278234873, 'psi': 0.9953745726764779}-{'f1_val': 0.9949255377402499, 'auprc': 0.9961185709075946, 'loss_val': 0.0279572208242242, 'psi': 0.9954027510071879}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.502541 cos_to_last_merge=0.9095 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.910
[S11] round=48 local utility u=0.008309 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9950056784969457, 'loss_val': 0.067564771477278, 'psi': 0.996178769245555}-{'f1_val': 0.996305167468861, 'auprc': 0.9948467395621037, 'loss_val': 0.07977113347717527, 'psi': 0.995721796306158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=48 head_norm_before_train=1.348272 cos_to_last_merge=0.8269 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.827
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.5234304015648217, 'auprc': 0.6989671751840304, 'loss_val': 1.0816368612263094, 'psi': 0.5936451110125052}-{'f1_val': 0.5453999630112336, 'auprc': 0.6895821929244007, 'loss_val': 0.8644010883752747, 'psi': 0.6030728549765004}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.044084 cos_to_last_merge=0.9698 (last merge round=14)
[S14] round=48 local utility u=0.139850 metrics={'f1_val': 0.997823988882846, 'auprc': 0.9992764452573639, 'loss_val': 0.015499915454200246, 'psi': 0.998404971432653}-{'f1_val': 0.9661248203126626, 'auprc': 0.9989727179378988, 'loss_val': 0.10409443746719654, 'psi': 0.979263979362757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] sending update (kind=head size=1791 to 1 peers)
[S15] START round=48 head_norm_before_train=1.742555 cos_to_last_merge=0.9216 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.922
[S15] round=48 local utility u=0.014106 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9975157379842057, 'loss_val': 0.022945960537488975, 'psi': 0.9970542962261946}-{'f1_val': 0.9963164379542544, 'auprc': 0.9914451472917714, 'loss_val': 0.030364373748708713, 'psi': 0.9943679216892611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=48 head_norm_before_train=1.780347 cos_to_last_merge=0.8857 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.886
[S16] round=48 local utility u=0.274660 metrics={'f1_val': 0.949647217634574, 'auprc': 0.9945188440683795, 'loss_val': 0.17059862051099878, 'psi': 0.9675958682080963}-{'f1_val': 0.9145565275354209, 'auprc': 0.99305130317706, 'loss_val': 0.5049718588945684, 'psi': 0.9459544377920766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=48 head_norm_before_train=1.559421 cos_to_last_merge=0.9434 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.943
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6387336813442803, 'auprc': 0.6902600082468052, 'loss_val': 1.4611989151240354, 'psi': 0.6593442121052903}-{'f1_val': 0.6888020356273719, 'auprc': 0.8591457134687681, 'loss_val': 0.7930206714413343, 'psi': 0.7569395067639304}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.740636 cos_to_last_merge=0.7111 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.711
[S2] round=49 local utility u=0.058415 metrics={'f1_val': 0.8254015833425983, 'auprc': 0.8791198495108918, 'loss_val': 0.44082136471839856, 'psi': 0.8468888898099157}-{'f1_val': 0.8148132433373052, 'auprc': 0.8666837547873505, 'loss_val': 0.4568139637497598, 'psi': 0.8355614479173233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=49 head_norm_before_train=1.881606 cos_to_last_merge=0.7540 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.754
[S3] round=49 local utility u=0.586909 metrics={'f1_val': 0.8687345455386264, 'auprc': 0.9984969943595481, 'loss_val': 0.262425158831762, 'psi': 0.9206395250669951}-{'f1_val': 0.7180772992375613, 'auprc': 0.9988679114116379, 'loss_val': 0.5334120183721331, 'psi': 0.8303935441071919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=49 head_norm_before_train=1.829237 cos_to_last_merge=0.8223 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.822
[S4] round=49 local utility u=0.060584 metrics={'f1_val': 0.9595959884219172, 'auprc': 0.9583005829896355, 'loss_val': 0.30218494875946345, 'psi': 0.9590778262490045}-{'f1_val': 0.9537816427163957, 'auprc': 0.9325268167800516, 'loss_val': 0.3111452818282516, 'psi': 0.945279712341858}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=49 head_norm_before_train=1.408818 cos_to_last_merge=0.9319 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.932
[S5] round=49 local utility u=0.808258 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.9897079248421184, 'loss_val': 0.28015582550743373, 'psi': 0.8160764723262466}-{'f1_val': 0.5885189353606763, 'auprc': 0.7751324829692386, 'loss_val': 0.5821251685808503, 'psi': 0.6631643544041013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] sending update (kind=head size=1808 to 1 peers)
[S6] START round=49 head_norm_before_train=1.666801 cos_to_last_merge=0.9591 (last merge round=14)
[S6] round=49 local utility u=0.736406 metrics={'f1_val': 0.8655598029684619, 'auprc': 0.9570466618438465, 'loss_val': 0.2336712745149336, 'psi': 0.9021545465186158}-{'f1_val': 0.7626451142383381, 'auprc': 0.8148044923251632, 'loss_val': 0.6622687216113142, 'psi': 0.7835088654730682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=49 head_norm_before_train=1.562848 cos_to_last_merge=0.9461 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.946
[S7] round=49 local utility u=0.001319 metrics={'f1_val': 0.674819157026984, 'auprc': 0.8222379911973396, 'loss_val': 0.39759744591807883, 'psi': 0.7337866906951263}-{'f1_val': 0.6782448801930916, 'auprc': 0.819675650756605, 'loss_val': 0.41310333689458856, 'psi': 0.7348171884184969}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=49 head_norm_before_train=1.810881 cos_to_last_merge=0.9611 (last merge round=16)
[S8] round=49 local utility u=0.005616 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9989219837307585, 'loss_val': 0.033745398010120546, 'psi': 0.9951115611655885}-{'f1_val': 0.9914482382097267, 'auprc': 0.9981343414870817, 'loss_val': 0.0358754882670307, 'psi': 0.9941226795206688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=49 head_norm_before_train=2.093789 (no previous merge yet)
[S9] round=49 local utility u=0.009229 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999112933931541, 'loss_val': 0.017773669351763, 'psi': 0.9982262648645474}-{'f1_val': 0.9946069829493691, 'auprc': 0.9999147402635968, 'loss_val': 0.021265439604465485, 'psi': 0.9967300858750602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=49 head_norm_before_train=1.967647 cos_to_last_merge=0.9259 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9959747267777945, 'loss_val': 0.027807668686409, 'psi': 0.9953452133552678}-{'f1_val': 0.9949255377402499, 'auprc': 0.9960481250808197, 'loss_val': 0.027790352278234873, 'psi': 0.9953745726764779}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.516179 cos_to_last_merge=0.9068 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.907
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9883729745980763, 'auprc': 0.9951755989748753, 'loss_val': 0.0881234832170556, 'psi': 0.9910940243487959}-{'f1_val': 0.996960829744628, 'auprc': 0.9950056784969457, 'loss_val': 0.067564771477278, 'psi': 0.996178769245555}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.354896 cos_to_last_merge=0.8264 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.826
[S13] round=49 local utility u=0.238044 metrics={'f1_val': 0.559419849081128, 'auprc': 0.6925034475869747, 'loss_val': 0.8020951638219411, 'psi': 0.6126532884834667}-{'f1_val': 0.5234304015648217, 'auprc': 0.6989671751840304, 'loss_val': 1.0816368612263094, 'psi': 0.5936451110125052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=49 head_norm_before_train=2.048785 cos_to_last_merge=0.9696 (last merge round=14)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9975787828504585, 'auprc': 0.9992645310705657, 'loss_val': 0.021504852388868567, 'psi': 0.9982530821385014}-{'f1_val': 0.997823988882846, 'auprc': 0.9992764452573639, 'loss_val': 0.015499915454200246, 'psi': 0.998404971432653}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.750520 cos_to_last_merge=0.9208 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.921
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7010233509369124, 'auprc': 0.813574934146648, 'loss_val': 0.583580716492629, 'psi': 0.7460439842208066}-{'f1_val': 0.9967466683875206, 'auprc': 0.9975157379842057, 'loss_val': 0.022945960537488975, 'psi': 0.9970542962261946}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.787763 cos_to_last_merge=0.8848 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.885
[S16] round=49 local utility u=0.133716 metrics={'f1_val': 0.979163395570701, 'auprc': 0.9943395860410147, 'loss_val': 0.07972560398359543, 'psi': 0.9852338717588265}-{'f1_val': 0.949647217634574, 'auprc': 0.9945188440683795, 'loss_val': 0.17059862051099878, 'psi': 0.9675958682080963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=49 head_norm_before_train=1.573651 cos_to_last_merge=0.9413 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=49 local utility u=0.251796 metrics={'f1_val': 0.6676845562652683, 'auprc': 0.7384283410500576, 'loss_val': 1.27581789308472, 'psi': 0.6959820701791841}-{'f1_val': 0.6387336813442803, 'auprc': 0.6902600082468052, 'loss_val': 1.4611989151240354, 'psi': 0.6593442121052903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
