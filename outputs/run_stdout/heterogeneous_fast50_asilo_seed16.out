[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:40403
[S3] → join 127.0.0.1:40402
[S4] → join 127.0.0.1:40402
[S5] → join 127.0.0.1:40402
[S6] → join 127.0.0.1:40402
[S7] → join 127.0.0.1:40402
[S8] → join 127.0.0.1:40402
[S9] → join 127.0.0.1:40402
[S10] → join 127.0.0.1:40402
[S11] → join 127.0.0.1:40402
[S13] → join 127.0.0.1:40402
[S14] → join 127.0.0.1:40402
[S15] → join 127.0.0.1:40402
[S16] → join 127.0.0.1:40402
[S17] → join 127.0.0.1:40402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.192521 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.135839 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.142141 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.140652 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.145724 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.132798 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.188829 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.151627 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.121341 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.170477 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.191950 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.157118 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.162209 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.188215 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.152996 (no previous merge yet)
[S6]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S3] + discovered S8
[S3] + discovered S7
[S3] + discovered S10
[S3] + discovered S16
[S3] + discovered S14
[S3] + discovered S9
[S3] + discovered S5
[S3] + discovered S11
[S3] + discovered S4
[S3] + discovered S17
[S3] + discovered S6
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S15
[S3] + discovered S13
[S4] + discovered S15
[S4] + discovered S13
[S4] + discovered S7
[S4] + discovered S8
[S4] + discovered S10
[S4] + discovered S16
[S4] + discovered S14
[S4] + discovered S9
[S4] + discovered S5
[S4] + discovered S11
[S4] + discovered S17
[S4] + discovered S6
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S5] + discovered S17
[S5] + discovered S6
[S5] + discovered S13
[S5] + discovered S7
[S5] + discovered S16
[S5] + discovered S14
[S5] + discovered S11
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S5
[S6] + discovered S4
[S5] + discovered S15
[S5] + discovered S8
[S5] + discovered S10
[S5] + discovered S9
[S6] + discovered S10
[S6] + discovered S8
[S6] + discovered S15
[S6] + discovered S11
[S6] + discovered S14
[S6] + discovered S16
[S6] + discovered S7
[S6] + discovered S13
[S6] + discovered S17
[S6] + discovered S9
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S6
[S7] + discovered S3
[S7] + discovered S2
[S8] + discovered S4
[S8] + discovered S5
[S8] + discovered S2
[S8] + discovered S3
[S8] + discovered S6
[S8] + discovered S7
[S7] + discovered S9
[S7] + discovered S17
[S7] + discovered S13
[S7] + discovered S16
[S7] + discovered S15
[S7] + discovered S10
[S7] + discovered S14
[S7] + discovered S11
[S7] + discovered S8
[S8] + discovered S9
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S5
[S9] + discovered S8
[S8] + discovered S11
[S9] + discovered S6
[S8] + discovered S14
[S9] + discovered S4
[S9] + discovered S2
[S8] + discovered S10
[S8] + discovered S16
[S8] + discovered S15
[S8] + discovered S17
[S8] + discovered S13
[S9] + discovered S13
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S17
[S9] + discovered S10
[S9] + discovered S16
[S9] + discovered S15
[S10] + discovered S5
[S10] + discovered S2
[S10] + discovered S9
[S10] + discovered S8
[S10] + discovered S6
[S10] + discovered S3
[S10] + discovered S7
[S10] + discovered S4
[S10] + discovered S14
[S11] + discovered S7
[S11] + discovered S4
[S11] + discovered S8
[S10] + discovered S13
[S10] + discovered S11
[S11] + discovered S6
[S11] + discovered S10
[S11] + discovered S3
[S11] + discovered S9
[S11] + discovered S2
[S10] + discovered S15
[S11] + discovered S5
[S10] + discovered S17
[S10] + discovered S16
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S15
[S13] + discovered S7
[S13] + discovered S6
[S13] + discovered S10
[S13] + discovered S4
[S13] + discovered S3
[S13] + discovered S11
[S13] + discovered S8
[S13] + discovered S9
[S13] + discovered S2
[S13] + discovered S5
[S11] + discovered S16
[S11] + discovered S14
[S14] + discovered S13
[S14] + discovered S6
[S14] + discovered S9
[S14] + discovered S7
[S14] + discovered S5
[S14] + discovered S4
[S14] + discovered S2
[S14] + discovered S3
[S14] + discovered S10
[S14] + discovered S8
[S14] + discovered S11
[S13] + discovered S14
[S13] + discovered S16
[S13] + discovered S15
[S13] + discovered S17
[S15] + discovered S7
[S15] + discovered S4
[S15] + discovered S2
[S15] + discovered S5
[S14] + discovered S15
[S15] + discovered S9
[S15] + discovered S13
[S14] + discovered S16
[S15] + discovered S3
[S15] + discovered S6
[S15] + discovered S8
[S14] + discovered S17
[S15] + discovered S14
[S15] + discovered S10
[S15] + discovered S11
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S4
[S16] + discovered S7
[S15] + discovered S17
[S16] + discovered S15
[S15] + discovered S16
[S16] + discovered S9
[S16] + discovered S8
[S16] + discovered S6
[S16] + discovered S11
[S16] + discovered S5
[S16] + discovered S2
[S16] + discovered S10
[S16] + discovered S14
[S17] + discovered S11
[S17] + discovered S3
[S17] + discovered S10
[S17] + discovered S5
[S17] + discovered S7
[S17] + discovered S8
[S17] + discovered S6
[S17] + discovered S16
[S17] + discovered S9
[S17] + discovered S15
[S16] + discovered S17
[S17] + discovered S2
[S17] + discovered S13
[S17] + discovered S14
[S17] + discovered S4
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:40414
[S9] ⇄ pheromone p=1.000 → S13@127.0.0.1:40413
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:40410
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:40412
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:40416
[S2] ⇄ pheromone p=1.000 → S16@127.0.0.1:40416
[S15] ⇄ pheromone p=1.000 → S16@127.0.0.1:40416
[S7] ⇄ pheromone p=1.000 → S10@127.0.0.1:40411
[S4] ⇄ pheromone p=1.000 → S9@127.0.0.1:40410
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:40414
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:40417
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:40404
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:40402
[S14] ⇄ pheromone p=1.000 → S4@127.0.0.1:40404
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:40410
[S2] START round=1 head_norm_before_train=1.213028 (no previous merge yet)
[S2] round=1 local utility u=0.043952 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7713276502781149, 'loss_val': 1.2558287485468465, 'psi': 0.393597340144386}-{'f1_val': 0.1417771333885667, 'auprc': 0.7685716990372747, 'loss_val': 1.3354648537045946, 'psi': 0.39249495964805}
[S3] START round=1 head_norm_before_train=1.135471 (no previous merge yet)
[S3] round=1 local utility u=0.325226 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6570221152807219, 'loss_val': 1.343169012923714, 'psi': 0.34671288548075296}-{'f1_val': 0.13984006561410703, 'auprc': 0.4503541925469817, 'loss_val': 1.3736171997736502, 'psi': 0.26404571638725693}
[S4] START round=1 head_norm_before_train=1.160449 (no previous merge yet)
[S4] round=1 local utility u=0.076397 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7770754425541265, 'loss_val': 1.2452086590492195, 'psi': 0.3949661543587611}-{'f1_val': 0.14022662889518414, 'auprc': 0.7519849224008142, 'loss_val': 1.3227301598973868, 'psi': 0.38492994629743615}
[S5] START round=1 head_norm_before_train=1.145686 (no previous merge yet)
[S5] round=1 local utility u=0.606980 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5085406724776047, 'loss_val': 1.3131658869125504, 'psi': 0.2887734118481847}-{'f1_val': 0.0008368200836820083, 'auprc': 0.3987324724438767, 'loss_val': 1.3491509555759003, 'psi': 0.15999508102775992}
[S6] START round=1 head_norm_before_train=1.165503 (no previous merge yet)
[S6] round=1 local utility u=0.062688 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.809412100009061, 'loss_val': 1.2752533373981656, 'psi': 0.40862060923439364}-{'f1_val': 0.14142628205128205, 'auprc': 0.788050334549217, 'loss_val': 1.3365439747807, 'psi': 0.40007590305045604}
[S7] START round=1 head_norm_before_train=1.137872 (no previous merge yet)
[S7] round=1 local utility u=0.476902 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5505934574917698, 'loss_val': 1.3413123631305461, 'psi': 0.3054714766341629}-{'f1_val': 0.10429108604291086, 'auprc': 0.3177785348375369, 'loss_val': 1.3700768280547824, 'psi': 0.18968606556076129}
[S8] START round=1 head_norm_before_train=1.204649 (no previous merge yet)
[S8] round=1 local utility u=0.161163 metrics={'f1_val': 0.15200520975977894, 'auprc': 0.6822591857186522, 'loss_val': 1.282220269039383, 'psi': 0.36410680014332825}-{'f1_val': 0.13995598239295717, 'auprc': 0.6192812907739165, 'loss_val': 1.34331682522504, 'psi': 0.3316861057453409}
[S9] START round=1 head_norm_before_train=1.157357 (no previous merge yet)
[S9] round=1 local utility u=0.266612 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8655502794811119, 'loss_val': 1.2790420788707093, 'psi': 0.4310588860764424}-{'f1_val': 0.141397957139996, 'auprc': 0.7006015916891675, 'loss_val': 1.3174204225093737, 'psi': 0.3650794109596646}
[S10] START round=1 head_norm_before_train=1.144068 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6164664836150958, 'loss_val': 1.2558928578703654, 'psi': 0.3297595759710727}-{'f1_val': 0.38652733948569507, 'auprc': 0.6101603095181205, 'loss_val': 1.3334465734568204, 'psi': 0.47598052749866526}
[S11] START round=1 head_norm_before_train=1.174813 (no previous merge yet)
[S11] round=1 local utility u=0.383863 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6622068547644966, 'loss_val': 1.3353682850801771, 'psi': 0.349130951929665}-{'f1_val': 0.029289247591772975, 'auprc': 0.6406636889511814, 'loss_val': 1.3717184690452142, 'psi': 0.27383902413553635}
[S13] START round=1 head_norm_before_train=1.202937 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7480807495538742, 'loss_val': 1.2882484269494299, 'psi': 0.38346375736778154}-{'f1_val': 0.15133160417070776, 'auprc': 0.7534849583054112, 'loss_val': 1.3532210051884763, 'psi': 0.39219294582458913}
[S14] START round=1 head_norm_before_train=1.161953 (no previous merge yet)
[S14] round=1 local utility u=0.256038 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5823432489971787, 'loss_val': 1.3246148846957573, 'psi': 0.31715201132849374}-{'f1_val': 0.14035785288270378, 'auprc': 0.418594986042046, 'loss_val': 1.3454468983506944, 'psi': 0.25165270614644064}
[S15] START round=1 head_norm_before_train=1.176708 (no previous merge yet)
[S15] round=1 local utility u=0.032367 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7715455311103459, 'loss_val': 1.2708458294685723, 'psi': 0.39245840326107334}-{'f1_val': 0.13973365136155833, 'auprc': 0.7700670854922151, 'loss_val': 1.3311449345536486, 'psi': 0.3918670250138211}
[S16] START round=1 head_norm_before_train=1.188547 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8087232164035332, 'loss_val': 1.3221676753674216, 'psi': 0.4078717566809352}-{'f1_val': 0.41602153415591797, 'auprc': 0.6021706459997307, 'loss_val': 1.3529109370252466, 'psi': 0.49048117889344306}
[S17] START round=1 head_norm_before_train=1.162474 (no previous merge yet)
[S17] round=1 local utility u=0.232113 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6703152742075642, 'loss_val': 1.2938031915336432, 'psi': 0.3526954876734563}-{'f1_val': 0.14094896331738438, 'auprc': 0.5310480357953626, 'loss_val': 1.3402267511683825, 'psi': 0.29698859230857566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:40414
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:40415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:40405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:40407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:40412
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:40417
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S5] → sending delta(kind=head bytes=1787) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:40412
[S3] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1787 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1792) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.151380)
[S10] loaded HEAD from S7 (vec_in norm=1.151380)
[S10] cosine check vs S7: cos=-0.0176
[S10] DROPPED delta from S7 (cos=-0.0176 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1789) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.144463)
[S11] loaded HEAD from S3 (vec_in norm=1.144463)
[S11] cosine check vs S3: cos=0.0410
[S11] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1793) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.173182)
[S5] loaded HEAD from S9 (vec_in norm=1.173182)
[S5] cosine check vs S9: cos=0.1022
[S5] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1791) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.207065)
[S14] loaded HEAD from S4 (vec_in norm=1.207065)
[S14] cosine check vs S4: cos=-0.0348
[S14] DROPPED delta from S4 (cos=-0.0348 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1790) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.219170)
[S14] loaded HEAD from S15 (vec_in norm=1.219170)
[S14] cosine check vs S15: cos=-0.1510
[S14] DROPPED delta from S15 (cos=-0.1510 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1787) from S5
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.160612)
[S14] loaded HEAD from S5 (vec_in norm=1.160612)
[S14] cosine check vs S5: cos=-0.0387
[S14] DROPPED delta from S5 (cos=-0.0387 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.240487)
[S17] loaded HEAD from S8 (vec_in norm=1.240487)
[S17] cosine check vs S8: cos=-0.0011
[S17] DROPPED delta from S8 (cos=-0.0011 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.256484)
[S6] loaded HEAD from S2 (vec_in norm=1.256484)
[S6] cosine check vs S2: cos=0.0490
[S6] BUFFERED delta from S2 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.206263)
[S11] loaded HEAD from S6 (vec_in norm=1.206263)
[S11] cosine check vs S6: cos=0.0240
[S11] BUFFERED delta from S6 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1792) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.188142)
[S16] loaded HEAD from S11 (vec_in norm=1.188142)
[S16] cosine check vs S11: cos=0.0397
[S16] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.176467)
[S15] loaded HEAD from S14 (vec_in norm=1.176467)
[S15] cosine check vs S14: cos=-0.1510
[S15] DROPPED delta from S14 (cos=-0.1510 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:40411
[S17] sending update (kind=head size=1793 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1793) from S17
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.201680)
[S10] loaded HEAD from S17 (vec_in norm=1.201680)
[S10] cosine check vs S17: cos=-0.1054
[S10] DROPPED delta from S17 (cos=-0.1054 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.160612
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.818379e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.866267 delta_norm=0.781838
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.206263
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.493145e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.891951 delta_norm=0.849314
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.188142
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.140074e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.744862 delta_norm=0.714007
[S11] aggregate: ACCEPT kept=['S3', 'S6'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.198948
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.270517e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.3835 head_norm=0.860560 delta_norm=0.827052
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.256484 (no previous merge yet)
[S2] round=2 local utility u=0.046482 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7752266508008951, 'loss_val': 1.174561482253862, 'psi': 0.39515694035349813}-{'f1_val': 0.1417771333885667, 'auprc': 0.7713276502781149, 'loss_val': 1.2558287485468465, 'psi': 0.393597340144386}
[S3] START round=2 head_norm_before_train=1.144463 (no previous merge yet)
[S3] round=2 local utility u=0.022059 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6596645288895868, 'loss_val': 1.3069790140674502, 'psi': 0.3477698509242989}-{'f1_val': 0.13984006561410703, 'auprc': 0.6570221152807219, 'loss_val': 1.343169012923714, 'psi': 0.34671288548075296}
[S4] START round=2 head_norm_before_train=1.207065 (no previous merge yet)
[S4] round=2 local utility u=0.093973 metrics={'f1_val': 0.14564206014856548, 'auprc': 0.7825418488772129, 'loss_val': 1.106153956547227, 'psi': 0.40040197564002444}-{'f1_val': 0.14022662889518414, 'auprc': 0.7770754425541265, 'loss_val': 1.2452086590492195, 'psi': 0.3949661543587611}
[S5] START round=2 head_norm_before_train=0.866267 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.008614 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5143600042922535, 'loss_val': 1.3133949193938768, 'psi': 0.29110114457404423}-{'f1_val': 0.14226190476190476, 'auprc': 0.5085406724776047, 'loss_val': 1.3131658869125504, 'psi': 0.2887734118481847}
[S6] START round=2 head_norm_before_train=0.891951 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.080955 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8518851919635821, 'loss_val': 1.240762651794438, 'psi': 0.4256098460162021}-{'f1_val': 0.14142628205128205, 'auprc': 0.809412100009061, 'loss_val': 1.2752533373981656, 'psi': 0.40862060923439364}
[S7] START round=2 head_norm_before_train=1.151380 (no previous merge yet)
[S7] round=2 local utility u=0.318735 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7520751665591336, 'loss_val': 1.3082874131987106, 'psi': 0.38606416026110846}-{'f1_val': 0.14205682272909165, 'auprc': 0.5505934574917698, 'loss_val': 1.3413123631305461, 'psi': 0.3054714766341629}
[S8] START round=2 head_norm_before_train=1.240487 (no previous merge yet)
[S8] round=2 local utility u=0.442833 metrics={'f1_val': 0.24562169462501288, 'auprc': 0.7548057182551986, 'loss_val': 1.1758930763234259, 'psi': 0.4492953040770872}-{'f1_val': 0.15200520975977894, 'auprc': 0.6822591857186522, 'loss_val': 1.282220269039383, 'psi': 0.36410680014332825}
[S9] START round=2 head_norm_before_train=1.173182 (no previous merge yet)
[S9] round=2 local utility u=0.037295 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8759423440188233, 'loss_val': 1.2356274955055817, 'psi': 0.43521571189152697}-{'f1_val': 0.141397957139996, 'auprc': 0.8655502794811119, 'loss_val': 1.2790420788707093, 'psi': 0.4310588860764424}
[S10] START round=2 head_norm_before_train=1.191577 (no previous merge yet)
[S10] round=2 local utility u=0.057179 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6067942539445738, 'loss_val': 1.1125173180705803, 'psi': 0.32589068410286387}-{'f1_val': 0.13862163754172394, 'auprc': 0.6164664836150958, 'loss_val': 1.2558928578703654, 'psi': 0.3297595759710727}
[S11] START round=2 head_norm_before_train=0.744862 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6515799539672271, 'loss_val': 1.3327407272234542, 'psi': 0.3448801916107572}-{'f1_val': 0.14041368337311058, 'auprc': 0.6622068547644966, 'loss_val': 1.3353682850801771, 'psi': 0.349130951929665}
[S13] START round=2 head_norm_before_train=1.242487 (no previous merge yet)
[S13] round=2 local utility u=0.012200 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7260317659104162, 'loss_val': 1.1977022181448727, 'psi': 0.37464416391039834}-{'f1_val': 0.1403857625770531, 'auprc': 0.7480807495538742, 'loss_val': 1.2882484269494299, 'psi': 0.38346375736778154}
[S14] START round=2 head_norm_before_train=1.176467 (no previous merge yet)
[S14] round=2 local utility u=0.115098 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6510034750035042, 'loss_val': 1.300399826838786, 'psi': 0.3446161017310239}-{'f1_val': 0.14035785288270378, 'auprc': 0.5823432489971787, 'loss_val': 1.3246148846957573, 'psi': 0.31715201132849374}
[S15] START round=2 head_norm_before_train=1.219170 (no previous merge yet)
[S15] round=2 local utility u=0.036166 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7726210918425133, 'loss_val': 1.2017396672076186, 'psi': 0.39288862755394033}-{'f1_val': 0.13973365136155833, 'auprc': 0.7715455311103459, 'loss_val': 1.2708458294685723, 'psi': 0.39245840326107334}
[S16] START round=2 head_norm_before_train=0.860560 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.030398 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8318890003319027, 'loss_val': 1.3308698898211235, 'psi': 0.417138070252283}-{'f1_val': 0.14063745019920318, 'auprc': 0.8087232164035332, 'loss_val': 1.3221676753674216, 'psi': 0.4078717566809352}
[S17] START round=2 head_norm_before_train=1.201680 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.617813838651873, 'loss_val': 1.2182717354523394, 'psi': 0.33169491345117985}-{'f1_val': 0.14094896331738438, 'auprc': 0.6703152742075642, 'loss_val': 1.2938031915336432, 'psi': 0.3526954876734563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:40413
[S15] not sending this round → trigger blocked (psi=0.393)
[S6] not sending this round → trigger blocked (psi=0.426)
[S9] not sending this round → trigger blocked (psi=0.435)
[S3] not sending this round → trigger blocked (psi=0.348)
[S7] not sending this round → trigger blocked (psi=0.386)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:40405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:40412
[S5] not sending this round → trigger blocked (psi=0.291)
[S4] not sending this round → trigger blocked (psi=0.400)
[S8] not sending this round → trigger blocked (psi=0.449)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.395)
[S14] not sending this round → trigger blocked (psi=0.345)
[S16] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S16
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.873401)
[S11] loaded HEAD from S16 (vec_in norm=0.873401)
[S11] cosine check vs S16: cos=0.5440
[S11] BUFFERED delta from S16 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S13
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.303597)
[S5] loaded HEAD from S13 (vec_in norm=1.303597)
[S5] cosine check vs S13: cos=-0.0257
[S5] DROPPED delta from S13 (cos=-0.0257 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.252232)
[S13] loaded HEAD from S10 (vec_in norm=1.252232)
[S13] cosine check vs S10: cos=-0.0043
[S13] DROPPED delta from S10 (cos=-0.0043 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=0.767059
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.944400e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.721125 delta_norm=0.394440
[S11] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.303387 (no previous merge yet)
[S2] round=3 local utility u=0.797390 metrics={'f1_val': 0.3841475146790489, 'auprc': 0.7807016677526633, 'loss_val': 1.0504294284567892, 'psi': 0.5427691759084947}-{'f1_val': 0.1417771333885667, 'auprc': 0.7752266508008951, 'loss_val': 1.174561482253862, 'psi': 0.39515694035349813}
[S3] START round=3 head_norm_before_train=1.162880 (no previous merge yet)
[S3] round=3 local utility u=0.058600 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6843328680260705, 'loss_val': 1.2637848528204274, 'psi': 0.35763718657889243}-{'f1_val': 0.13984006561410703, 'auprc': 0.6596645288895868, 'loss_val': 1.3069790140674502, 'psi': 0.3477698509242989}
[S4] START round=3 head_norm_before_train=1.276847 (no previous merge yet)
[S4] round=3 local utility u=1.000000 metrics={'f1_val': 0.6831590531607707, 'auprc': 0.7674770250176546, 'loss_val': 0.8471877928296695, 'psi': 0.7168862419035242}-{'f1_val': 0.14564206014856548, 'auprc': 0.7825418488772129, 'loss_val': 1.106153956547227, 'psi': 0.40040197564002444}
[S5] START round=3 head_norm_before_train=0.880005 cos_to_last_merge=0.9974 (last merge round=1)
[S5] round=3 local utility u=0.068392 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5491262387578978, 'loss_val': 1.2809089768313848, 'psi': 0.305007638360302}-{'f1_val': 0.14226190476190476, 'auprc': 0.5143600042922535, 'loss_val': 1.3133949193938768, 'psi': 0.29110114457404423}
[S6] START round=3 head_norm_before_train=0.937622 cos_to_last_merge=0.9945 (last merge round=1)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.64129377018616, 'loss_val': 1.1474595681345698, 'psi': 0.3413732773052332}-{'f1_val': 0.14142628205128205, 'auprc': 0.8518851919635821, 'loss_val': 1.240762651794438, 'psi': 0.4256098460162021}
[S7] START round=3 head_norm_before_train=1.175543 (no previous merge yet)
[S7] round=3 local utility u=0.048849 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7734672988189064, 'loss_val': 1.2747653834938089, 'psi': 0.3946210131650176}-{'f1_val': 0.14205682272909165, 'auprc': 0.7520751665591336, 'loss_val': 1.3082874131987106, 'psi': 0.38606416026110846}
[S8] START round=3 head_norm_before_train=1.298088 (no previous merge yet)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.7153201919565738, 'auprc': 0.7711460695631664, 'loss_val': 0.9677509232436363, 'psi': 0.7376505429992108}-{'f1_val': 0.24562169462501288, 'auprc': 0.7548057182551986, 'loss_val': 1.1758930763234259, 'psi': 0.4492953040770872}
[S9] START round=3 head_norm_before_train=1.195663 (no previous merge yet)
[S9] round=3 local utility u=0.016876 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8669912434713789, 'loss_val': 1.1750220252929549, 'psi': 0.43163527167254917}-{'f1_val': 0.141397957139996, 'auprc': 0.8759423440188233, 'loss_val': 1.2356274955055817, 'psi': 0.43521571189152697}
[S10] START round=3 head_norm_before_train=1.252232 (no previous merge yet)
[S10] round=3 local utility u=0.878321 metrics={'f1_val': 0.38867670237126606, 'auprc': 0.6142537746729845, 'loss_val': 0.8785838184901059, 'psi': 0.4789075312919534}-{'f1_val': 0.13862163754172394, 'auprc': 0.6067942539445738, 'loss_val': 1.1125173180705803, 'psi': 0.32589068410286387}
[S11] START round=3 head_norm_before_train=0.721125 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.059976 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6770788705217673, 'loss_val': 1.2892856638144456, 'psi': 0.35507975823257326}-{'f1_val': 0.14041368337311058, 'auprc': 0.6515799539672271, 'loss_val': 1.3327407272234542, 'psi': 0.3448801916107572}
[S13] START round=3 head_norm_before_train=1.303597 (no previous merge yet)
[S13] round=3 local utility u=0.925929 metrics={'f1_val': 0.41655034241240063, 'auprc': 0.7443264068550735, 'loss_val': 1.0577163946229617, 'psi': 0.5476607681894698}-{'f1_val': 0.1403857625770531, 'auprc': 0.7260317659104162, 'loss_val': 1.1977022181448727, 'psi': 0.37464416391039834}
[S14] START round=3 head_norm_before_train=1.200149 (no previous merge yet)
[S14] round=3 local utility u=0.236284 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7986461466445262, 'loss_val': 1.270758849122741, 'psi': 0.4036731703874327}-{'f1_val': 0.14035785288270378, 'auprc': 0.6510034750035042, 'loss_val': 1.300399826838786, 'psi': 0.3446161017310239}
[S15] START round=3 head_norm_before_train=1.273484 (no previous merge yet)
[S15] round=3 local utility u=0.914239 metrics={'f1_val': 0.4167593395843331, 'auprc': 0.7772006316037476, 'loss_val': 1.0491542863758396, 'psi': 0.560935856392099}-{'f1_val': 0.13973365136155833, 'auprc': 0.7726210918425133, 'loss_val': 1.2017396672076186, 'psi': 0.39288862755394033}
[S16] START round=3 head_norm_before_train=0.873401 cos_to_last_merge=0.9967 (last merge round=1)
[S16] round=3 local utility u=0.044508 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8480668170534237, 'loss_val': 1.2903874623825575, 'psi': 0.4236091969408914}-{'f1_val': 0.14063745019920318, 'auprc': 0.8318890003319027, 'loss_val': 1.3308698898211235, 'psi': 0.417138070252283}
[S17] START round=3 head_norm_before_train=1.261503 (no previous merge yet)
[S17] round=3 local utility u=1.000000 metrics={'f1_val': 0.5275909098320668, 'auprc': 0.6684375871719475, 'loss_val': 1.070023712653008, 'psi': 0.5839295807680192}-{'f1_val': 0.14094896331738438, 'auprc': 0.617813838651873, 'loss_val': 1.2182717354523394, 'psi': 0.33169491345117985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:40413
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:40404
[S16] not sending this round → trigger blocked (psi=0.424)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[S10] not sending this round → trigger blocked (psi=0.479)
[S13] not sending this round → trigger blocked (psi=0.548)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:40404
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.362873)
[S17] loaded HEAD from S8 (vec_in norm=1.362873)
[S17] cosine check vs S8: cos=-0.0137
[S17] DROPPED delta from S8 (cos=-0.0137 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.330943)
[S16] loaded HEAD from S15 (vec_in norm=1.330943)
[S16] cosine check vs S15: cos=-0.0039
[S16] DROPPED delta from S15 (cos=-0.0039 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.897868)
[S9] loaded HEAD from S5 (vec_in norm=0.897868)
[S9] cosine check vs S5: cos=0.7045
[S9] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.345632)
[S9] loaded HEAD from S4 (vec_in norm=1.345632)
[S9] cosine check vs S4: cos=0.0681
[S9] BUFFERED delta from S4 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.749586)
[S14] loaded HEAD from S11 (vec_in norm=0.749586)
[S14] cosine check vs S11: cos=0.0422
[S14] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.228743)
[S13] loaded HEAD from S9 (vec_in norm=1.228743)
[S13] cosine check vs S9: cos=-0.1051
[S13] DROPPED delta from S9 (cos=-0.1051 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.201453)
[S10] loaded HEAD from S7 (vec_in norm=1.201453)
[S10] cosine check vs S7: cos=-0.0405
[S10] DROPPED delta from S7 (cos=-0.0405 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.228728)
[S4] loaded HEAD from S14 (vec_in norm=1.228728)
[S4] cosine check vs S14: cos=-0.0242
[S4] DROPPED delta from S14 (cos=-0.0242 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.190621)
[S4] loaded HEAD from S3 (vec_in norm=1.190621)
[S4] cosine check vs S3: cos=-0.0502
[S4] DROPPED delta from S3 (cos=-0.0502 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.345035)
[S8] loaded HEAD from S2 (vec_in norm=1.345035)
[S8] cosine check vs S2: cos=-0.0350
[S8] DROPPED delta from S2 (cos=-0.0350 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.315840)
[S9] loaded HEAD from S17 (vec_in norm=1.315840)
[S9] cosine check vs S17: cos=-0.0195
[S9] DROPPED delta from S17 (cos=-0.0195 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.228728
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.060396e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.733030 delta_norm=0.706040
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=1.228743
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.699908e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.877381 delta_norm=0.569991
[S9] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.345035 (no previous merge yet)
[S2] round=4 local utility u=1.000000 metrics={'f1_val': 0.7142259035432276, 'auprc': 0.7794879637331356, 'loss_val': 0.8499948851273537, 'psi': 0.7403307276191908}-{'f1_val': 0.3841475146790489, 'auprc': 0.7807016677526633, 'loss_val': 1.0504294284567892, 'psi': 0.5427691759084947}
[S3] START round=4 head_norm_before_train=1.190621 (no previous merge yet)
[S3] round=4 local utility u=0.115580 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7509719143784295, 'loss_val': 1.2325419306905074, 'psi': 0.384292805119836}-{'f1_val': 0.13984006561410703, 'auprc': 0.6843328680260705, 'loss_val': 1.2637848528204274, 'psi': 0.35763718657889243}
[S4] START round=4 head_norm_before_train=1.345632 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.655437255016838, 'auprc': 0.6586434268693075, 'loss_val': 0.6245483287825802, 'psi': 0.6567197237578258}-{'f1_val': 0.6831590531607707, 'auprc': 0.7674770250176546, 'loss_val': 0.8471877928296695, 'psi': 0.7168862419035242}
[S5] START round=4 head_norm_before_train=0.897868 cos_to_last_merge=0.9915 (last merge round=1)
[S5] round=4 local utility u=0.285621 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.725996718146872, 'loss_val': 1.2402791056706755, 'psi': 0.3757558301158917}-{'f1_val': 0.14226190476190476, 'auprc': 0.5491262387578978, 'loss_val': 1.2809089768313848, 'psi': 0.305007638360302}
[S6] START round=4 head_norm_before_train=1.000274 cos_to_last_merge=0.9830 (last merge round=1)
[S6] round=4 local utility u=1.000000 metrics={'f1_val': 0.41709547116373813, 'auprc': 0.7876592985760761, 'loss_val': 0.8777222447403554, 'psi': 0.5653210021286733}-{'f1_val': 0.14142628205128205, 'auprc': 0.64129377018616, 'loss_val': 1.1474595681345698, 'psi': 0.3413732773052332}
[S7] START round=4 head_norm_before_train=1.201453 (no previous merge yet)
[S7] round=4 local utility u=0.013549 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7755078083122516, 'loss_val': 1.2537896560595956, 'psi': 0.3954372169623557}-{'f1_val': 0.14205682272909165, 'auprc': 0.7734672988189064, 'loss_val': 1.2747653834938089, 'psi': 0.3946210131650176}
[S8] START round=4 head_norm_before_train=1.362873 (no previous merge yet)
[S8] round=4 local utility u=0.474109 metrics={'f1_val': 0.7144610111876308, 'auprc': 0.9816332406514169, 'loss_val': 0.6458389300145575, 'psi': 0.8213299029731453}-{'f1_val': 0.7153201919565738, 'auprc': 0.7711460695631664, 'loss_val': 0.9677509232436363, 'psi': 0.7376505429992108}
[S9] START round=4 head_norm_before_train=0.877381 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.190701 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9856848601676819, 'loss_val': 1.149700104310227, 'psi': 0.4791127183510704}-{'f1_val': 0.141397957139996, 'auprc': 0.8669912434713789, 'loss_val': 1.1750220252929549, 'psi': 0.43163527167254917}
[S10] START round=4 head_norm_before_train=1.313257 (no previous merge yet)
[S10] round=4 local utility u=0.447842 metrics={'f1_val': 0.38867670237126606, 'auprc': 0.8599318919764227, 'loss_val': 0.7199339604583642, 'psi': 0.5771787782133287}-{'f1_val': 0.38867670237126606, 'auprc': 0.6142537746729845, 'loss_val': 0.8785838184901059, 'psi': 0.4789075312919534}
[S11] START round=4 head_norm_before_train=0.749586 cos_to_last_merge=0.9957 (last merge round=2)
[S11] round=4 local utility u=0.097921 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7232923504745418, 'loss_val': 1.2320850170124205, 'psi': 0.3735651502136831}-{'f1_val': 0.14041368337311058, 'auprc': 0.6770788705217673, 'loss_val': 1.2892856638144456, 'psi': 0.35507975823257326}
[S13] START round=4 head_norm_before_train=1.362659 (no previous merge yet)
[S13] round=4 local utility u=0.194642 metrics={'f1_val': 0.4573376954514607, 'auprc': 0.7161941882309272, 'loss_val': 0.8287590529059273, 'psi': 0.5608802925632472}-{'f1_val': 0.41655034241240063, 'auprc': 0.7443264068550735, 'loss_val': 1.0577163946229617, 'psi': 0.5476607681894698}
[S14] START round=4 head_norm_before_train=0.733030 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.110656 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8774776856563828, 'loss_val': 1.2859412034772368, 'psi': 0.4352057859921754}-{'f1_val': 0.14035785288270378, 'auprc': 0.7986461466445262, 'loss_val': 1.270758849122741, 'psi': 0.4036731703874327}
[S15] START round=4 head_norm_before_train=1.330943 (no previous merge yet)
[S15] round=4 local utility u=0.135120 metrics={'f1_val': 0.41797129490103596, 'auprc': 0.7771424982217238, 'loss_val': 0.786012326150898, 'psi': 0.561639776229311}-{'f1_val': 0.4167593395843331, 'auprc': 0.7772006316037476, 'loss_val': 1.0491542863758396, 'psi': 0.560935856392099}
[S16] START round=4 head_norm_before_train=0.894354 cos_to_last_merge=0.9874 (last merge round=1)
[S16] round=4 local utility u=0.232551 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9853574789905594, 'loss_val': 1.2371571332591755, 'psi': 0.4785254617157457}-{'f1_val': 0.14063745019920318, 'auprc': 0.8480668170534237, 'loss_val': 1.2903874623825575, 'psi': 0.4236091969408914}
[S17] START round=4 head_norm_before_train=1.315840 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.3781834487316842, 'auprc': 0.5938861906051665, 'loss_val': 0.8564364829969651, 'psi': 0.4644645454810771}-{'f1_val': 0.5275909098320668, 'auprc': 0.6684375871719475, 'loss_val': 1.070023712653008, 'psi': 0.5839295807680192}
[S2] not sending this round → trigger blocked (psi=0.740)
[S7] not sending this round → trigger blocked (psi=0.395)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:40409
[S5] not sending this round → trigger blocked (psi=0.376)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:40412
[S11] not sending this round → trigger blocked (psi=0.374)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:40414
[S8] not sending this round → trigger blocked (psi=0.821)
[S3] not sending this round → trigger blocked (psi=0.384)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.479)
[S14] not sending this round → trigger blocked (psi=0.435)
[S15] not sending this round → trigger blocked (psi=0.562)
[S10] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.922749)
[S8] loaded HEAD from S16 (vec_in norm=0.922749)
[S8] cosine check vs S16: cos=-0.1021
[S8] DROPPED delta from S16 (cos=-0.1021 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.425817)
[S16] loaded HEAD from S13 (vec_in norm=1.425817)
[S16] cosine check vs S13: cos=0.0950
[S16] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.376830)
[S14] loaded HEAD from S10 (vec_in norm=1.376830)
[S14] cosine check vs S10: cos=-0.0676
[S14] DROPPED delta from S10 (cos=-0.0676 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.053898)
[S11] loaded HEAD from S6 (vec_in norm=1.053898)
[S11] cosine check vs S6: cos=0.1012
[S11] BUFFERED delta from S6 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=0.786389
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.247714e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.688633 delta_norm=0.624771
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.922749
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.115631e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1039 head_norm=0.885197 delta_norm=0.811563
[S16] aggregate: ROLLBACK (f1_val pre=0.141 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S2] START round=5 head_norm_before_train=1.406781 (no previous merge yet)
[S2] round=5 local utility u=0.042972 metrics={'f1_val': 0.7008717589696155, 'auprc': 0.7521155402377687, 'loss_val': 0.6018089983875413, 'psi': 0.7213692714768769}-{'f1_val': 0.7142259035432276, 'auprc': 0.7794879637331356, 'loss_val': 0.8499948851273537, 'psi': 0.7403307276191908}
[S3] START round=5 head_norm_before_train=1.221303 (no previous merge yet)
[S3] round=5 local utility u=0.051784 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7622646902622259, 'loss_val': 1.1628530359335791, 'psi': 0.38880991547335464}-{'f1_val': 0.13984006561410703, 'auprc': 0.7509719143784295, 'loss_val': 1.2325419306905074, 'psi': 0.384292805119836}
[S4] START round=5 head_norm_before_train=1.427558 (no previous merge yet)
[S4] round=5 local utility u=0.111348 metrics={'f1_val': 0.6647420447131955, 'auprc': 0.6597898719837718, 'loss_val': 0.46112103034296337, 'psi': 0.662761175621426}-{'f1_val': 0.655437255016838, 'auprc': 0.6586434268693075, 'loss_val': 0.6245483287825802, 'psi': 0.6567197237578258}
[S5] START round=5 head_norm_before_train=0.922505 cos_to_last_merge=0.9832 (last merge round=1)
[S5] round=5 local utility u=0.035554 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7321280808859547, 'loss_val': 1.1875647499060407, 'psi': 0.3782083752115247}-{'f1_val': 0.14226190476190476, 'auprc': 0.725996718146872, 'loss_val': 1.2402791056706755, 'psi': 0.3757558301158917}
[S6] START round=5 head_norm_before_train=1.053898 cos_to_last_merge=0.9733 (last merge round=1)
[S6] round=5 local utility u=0.796353 metrics={'f1_val': 0.6203143743671203, 'auprc': 0.8357132946546476, 'loss_val': 0.6484923514909844, 'psi': 0.7064739424821312}-{'f1_val': 0.41709547116373813, 'auprc': 0.7876592985760761, 'loss_val': 0.8777222447403554, 'psi': 0.5653210021286733}
[S7] START round=5 head_norm_before_train=1.213196 (no previous merge yet)
[S7] round=5 local utility u=0.015871 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7770155641983326, 'loss_val': 1.2265703274395403, 'psi': 0.39604031931678807}-{'f1_val': 0.14205682272909165, 'auprc': 0.7755078083122516, 'loss_val': 1.2537896560595956, 'psi': 0.3954372169623557}
[S8] START round=5 head_norm_before_train=1.438763 (no previous merge yet)
[S8] round=5 local utility u=0.130523 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.985333181232791, 'loss_val': 0.39456200982141526, 'psi': 0.8226767357318139}-{'f1_val': 0.7144610111876308, 'auprc': 0.9816332406514169, 'loss_val': 0.6458389300145575, 'psi': 0.8213299029731453}
[S9] START round=5 head_norm_before_train=0.915171 cos_to_last_merge=0.9971 (last merge round=3)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8695004683402777, 'loss_val': 1.0246675192309964, 'psi': 0.43263896162010873}-{'f1_val': 0.141397957139996, 'auprc': 0.9856848601676819, 'loss_val': 1.149700104310227, 'psi': 0.4791127183510704}
[S10] START round=5 head_norm_before_train=1.376830 (no previous merge yet)
[S10] round=5 local utility u=1.000000 metrics={'f1_val': 0.6677262729567449, 'auprc': 0.994010980186316, 'loss_val': 0.6306186049045907, 'psi': 0.7982401558485733}-{'f1_val': 0.38867670237126606, 'auprc': 0.8599318919764227, 'loss_val': 0.7199339604583642, 'psi': 0.5771787782133287}
[S11] START round=5 head_norm_before_train=0.688633 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7147737705717984, 'loss_val': 1.236722015745932, 'psi': 0.3701577182525857}-{'f1_val': 0.14041368337311058, 'auprc': 0.7232923504745418, 'loss_val': 1.2320850170124205, 'psi': 0.3735651502136831}
[S13] START round=5 head_norm_before_train=1.425817 (no previous merge yet)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.3887226490787847, 'auprc': 0.7271220957870905, 'loss_val': 0.688442414523078, 'psi': 0.524082427762107}-{'f1_val': 0.4573376954514607, 'auprc': 0.7161941882309272, 'loss_val': 0.8287590529059273, 'psi': 0.5608802925632472}
[S14] START round=5 head_norm_before_train=0.765175 cos_to_last_merge=0.9967 (last merge round=3)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8278837293619421, 'loss_val': 1.2107151589382046, 'psi': 0.4153682034743991}-{'f1_val': 0.14035785288270378, 'auprc': 0.8774776856563828, 'loss_val': 1.2859412034772368, 'psi': 0.4352057859921754}
[S15] START round=5 head_norm_before_train=1.401054 (no previous merge yet)
[S15] round=5 local utility u=1.000000 metrics={'f1_val': 0.7013554721141939, 'auprc': 0.9224765763102026, 'loss_val': 0.6450447368488891, 'psi': 0.7898039137925974}-{'f1_val': 0.41797129490103596, 'auprc': 0.7771424982217238, 'loss_val': 0.786012326150898, 'psi': 0.561639776229311}
[S16] START round=5 head_norm_before_train=0.885197 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8246051151465357, 'loss_val': 1.2371312907076775, 'psi': 0.41422451617813616}-{'f1_val': 0.14063745019920318, 'auprc': 0.9853574789905594, 'loss_val': 1.2371571332591755, 'psi': 0.4785254617157457}
[S17] START round=5 head_norm_before_train=1.394571 (no previous merge yet)
[S17] round=5 local utility u=0.306637 metrics={'f1_val': 0.4600860804210883, 'auprc': 0.7095758862108738, 'loss_val': 1.0816476515499232, 'psi': 0.5598820027370024}-{'f1_val': 0.3781834487316842, 'auprc': 0.5938861906051665, 'loss_val': 0.8564364829969651, 'psi': 0.4644645454810771}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.798)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:40417
[S6] not sending this round → trigger blocked (psi=0.706)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:40411
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.477115)
[S8] loaded HEAD from S2 (vec_in norm=1.477115)
[S8] cosine check vs S2: cos=-0.0543
[S8] DROPPED delta from S2 (cos=-0.0543 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.244029)
[S4] loaded HEAD from S3 (vec_in norm=1.244029)
[S4] cosine check vs S3: cos=-0.0504
[S4] DROPPED delta from S3 (cos=-0.0504 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.950884)
[S9] loaded HEAD from S5 (vec_in norm=0.950884)
[S9] cosine check vs S5: cos=0.7248
[S9] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.451110)
[S16] loaded HEAD from S15 (vec_in norm=1.451110)
[S16] cosine check vs S15: cos=-0.0713
[S16] DROPPED delta from S15 (cos=-0.0713 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.226561)
[S10] loaded HEAD from S7 (vec_in norm=1.226561)
[S10] cosine check vs S7: cos=-0.0566
[S10] DROPPED delta from S7 (cos=-0.0566 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.507969)
[S9] loaded HEAD from S4 (vec_in norm=1.507969)
[S9] cosine check vs S4: cos=0.4187
[S9] BUFFERED delta from S4 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.514047)
[S17] loaded HEAD from S8 (vec_in norm=1.514047)
[S17] cosine check vs S8: cos=-0.0121
[S17] DROPPED delta from S8 (cos=-0.0121 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.460591)
[S9] loaded HEAD from S17 (vec_in norm=1.460591)
[S9] cosine check vs S17: cos=-0.0480
[S9] DROPPED delta from S17 (cos=-0.0480 < 0.0)
[S10] ⇄ pheromone p=0.718 → S14@127.0.0.1:40414
[S14] ⇄ pheromone p=0.408 → S4@127.0.0.1:40404
[S11] ⇄ pheromone p=0.382 → S14@127.0.0.1:40414
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.961637
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.461578e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.868778 delta_norm=0.346158
[S9] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.386 → S13@127.0.0.1:40413
[S6] ⇄ pheromone p=0.660 → S11@127.0.0.1:40412
[S13] ⇄ pheromone p=0.479 → S16@127.0.0.1:40416
[S15] ⇄ pheromone p=0.673 → S16@127.0.0.1:40416
[S4] ⇄ pheromone p=0.494 → S9@127.0.0.1:40410
[S2] ⇄ pheromone p=0.607 → S8@127.0.0.1:40409
[S8] ⇄ pheromone p=0.616 → S17@127.0.0.1:40417
[S7] ⇄ pheromone p=0.411 → S10@127.0.0.1:40411
[S5] ⇄ pheromone p=0.440 → S9@127.0.0.1:40410
[S3] ⇄ pheromone p=0.393 → S4@127.0.0.1:40404
[S17] ⇄ pheromone p=0.536 → S9@127.0.0.1:40410
[S16] ⇄ pheromone p=0.374 → S8@127.0.0.1:40409
[S2] START round=6 head_norm_before_train=1.477115 (no previous merge yet)
[S2] round=6 local utility u=0.016464 metrics={'f1_val': 0.7015719066528542, 'auprc': 0.6901641293355179, 'loss_val': 0.38722750191824834, 'psi': 0.6970087957259197}-{'f1_val': 0.7008717589696155, 'auprc': 0.7521155402377687, 'loss_val': 0.6018089983875413, 'psi': 0.7213692714768769}
[S3] START round=6 head_norm_before_train=1.244029 (no previous merge yet)
[S3] round=6 local utility u=0.769629 metrics={'f1_val': 0.39651525753011657, 'auprc': 0.7184290450985233, 'loss_val': 1.032139725623852, 'psi': 0.5252807725574793}-{'f1_val': 0.13984006561410703, 'auprc': 0.7622646902622259, 'loss_val': 1.1628530359335791, 'psi': 0.38880991547335464}
[S4] START round=6 head_norm_before_train=1.507969 (no previous merge yet)
[S4] round=6 local utility u=0.005999 metrics={'f1_val': 0.6651329170242223, 'auprc': 0.6692833160384954, 'loss_val': 0.4799487407262082, 'psi': 0.6667930766299315}-{'f1_val': 0.6647420447131955, 'auprc': 0.6597898719837718, 'loss_val': 0.46112103034296337, 'psi': 0.662761175621426}
[S5] START round=6 head_norm_before_train=0.950884 cos_to_last_merge=0.9733 (last merge round=1)
[S5] round=6 local utility u=0.921884 metrics={'f1_val': 0.41734838192522206, 'auprc': 0.7720024677716509, 'loss_val': 1.1139397598647611, 'psi': 0.5592100162637936}-{'f1_val': 0.14226190476190476, 'auprc': 0.7321280808859547, 'loss_val': 1.1875647499060407, 'psi': 0.3782083752115247}
[S6] START round=6 head_norm_before_train=1.124717 cos_to_last_merge=0.9546 (last merge round=1)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.5830488658556796, 'auprc': 0.8112768058219746, 'loss_val': 0.5967864076080593, 'psi': 0.6743400418421976}-{'f1_val': 0.6203143743671203, 'auprc': 0.8357132946546476, 'loss_val': 0.6484923514909844, 'psi': 0.7064739424821312}
[S7] START round=6 head_norm_before_train=1.226561 (no previous merge yet)
[S7] round=6 local utility u=0.024197 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7767456572293271, 'loss_val': 1.1773674288053155, 'psi': 0.39593235652918585}-{'f1_val': 0.14205682272909165, 'auprc': 0.7770155641983326, 'loss_val': 1.2265703274395403, 'psi': 0.39604031931678807}
[S8] START round=6 head_norm_before_train=1.514047 (no previous merge yet)
[S8] round=6 local utility u=0.047311 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9861293309030066, 'loss_val': 0.3023293263727749, 'psi': 0.8229951955999002}-{'f1_val': 0.7142391053978291, 'auprc': 0.985333181232791, 'loss_val': 0.39456200982141526, 'psi': 0.8226767357318139}
[S9] START round=6 head_norm_before_train=0.868778 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.41697558078303143, 'auprc': 0.9999029665357927, 'loss_val': 0.9135408032720845, 'psi': 0.650146535084136}-{'f1_val': 0.141397957139996, 'auprc': 0.8695004683402777, 'loss_val': 1.0246675192309964, 'psi': 0.43263896162010873}
[S10] START round=6 head_norm_before_train=1.427529 (no previous merge yet)
[S10] round=6 local utility u=0.169119 metrics={'f1_val': 0.6955083081194023, 'auprc': 0.9974108276442073, 'loss_val': 0.4692727718444652, 'psi': 0.8162693159293244}-{'f1_val': 0.6677262729567449, 'auprc': 0.994010980186316, 'loss_val': 0.6306186049045907, 'psi': 0.7982401558485733}
[S11] START round=6 head_norm_before_train=0.713665 cos_to_last_merge=0.9936 (last merge round=4)
[S11] round=6 local utility u=0.079573 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7399124663142759, 'loss_val': 1.1529920467825925, 'psi': 0.3802131965495767}-{'f1_val': 0.14041368337311058, 'auprc': 0.7147737705717984, 'loss_val': 1.236722015745932, 'psi': 0.3701577182525857}
[S13] START round=6 head_norm_before_train=1.489059 (no previous merge yet)
[S13] round=6 local utility u=1.000000 metrics={'f1_val': 0.681055985999509, 'auprc': 0.7493871492983466, 'loss_val': 0.47400537895057987, 'psi': 0.708388451319044}-{'f1_val': 0.3887226490787847, 'auprc': 0.7271220957870905, 'loss_val': 0.688442414523078, 'psi': 0.524082427762107}
[S14] START round=6 head_norm_before_train=0.815451 cos_to_last_merge=0.9866 (last merge round=3)
[S14] round=6 local utility u=0.084615 metrics={'f1_val': 0.1543393083191311, 'auprc': 0.8112752653943007, 'loss_val': 1.0755479940407358, 'psi': 0.41711369114919894}-{'f1_val': 0.14035785288270378, 'auprc': 0.8278837293619421, 'loss_val': 1.2107151589382046, 'psi': 0.4153682034743991}
[S15] START round=6 head_norm_before_train=1.451110 (no previous merge yet)
[S15] round=6 local utility u=0.205098 metrics={'f1_val': 0.701593608908214, 'auprc': 0.9876860859022343, 'loss_val': 0.4319062455896622, 'psi': 0.8160305997058221}-{'f1_val': 0.7013554721141939, 'auprc': 0.9224765763102026, 'loss_val': 0.6450447368488891, 'psi': 0.7898039137925974}
[S16] START round=6 head_norm_before_train=0.909371 cos_to_last_merge=0.9963 (last merge round=4)
[S16] round=6 local utility u=0.827293 metrics={'f1_val': 0.4156626648174509, 'auprc': 0.7829050220975774, 'loss_val': 1.1075972894173156, 'psi': 0.5625596077295015}-{'f1_val': 0.14063745019920318, 'auprc': 0.8246051151465357, 'loss_val': 1.2371312907076775, 'psi': 0.41422451617813616}
[S17] START round=6 head_norm_before_train=1.460591 (no previous merge yet)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.3396907700154473, 'auprc': 0.739523852382167, 'loss_val': 0.9988069006580216, 'psi': 0.49962400296213516}-{'f1_val': 0.4600860804210883, 'auprc': 0.7095758862108738, 'loss_val': 1.0816476515499232, 'psi': 0.5598820027370024}
[S3] not sending this round → trigger blocked (psi=0.525)
[S2] not sending this round → trigger blocked (psi=0.697)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:40414
[S15] not sending this round → trigger blocked (psi=0.816)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:40416
[S5] not sending this round → trigger blocked (psi=0.559)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:40409
[S8] not sending this round → trigger blocked (psi=0.823)
[S7] not sending this round → trigger blocked (psi=0.396)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S14] → sending delta(kind=head bytes=1788) to S4@127.0.0.1:40404
[S4] not sending this round → trigger blocked (psi=0.667)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:40413
[S9] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1788 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.944109)
[S8] loaded HEAD from S16 (vec_in norm=0.944109)
[S8] cosine check vs S16: cos=-0.0169
[S8] DROPPED delta from S16 (cos=-0.0169 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.540191)
[S16] loaded HEAD from S13 (vec_in norm=1.540191)
[S16] cosine check vs S13: cos=0.7998
[S16] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1788) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.873823)
[S4] loaded HEAD from S14 (vec_in norm=0.873823)
[S4] cosine check vs S14: cos=0.0028
[S4] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.488019)
[S14] loaded HEAD from S10 (vec_in norm=1.488019)
[S14] cosine check vs S10: cos=-0.0676
[S14] DROPPED delta from S10 (cos=-0.0676 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.744058)
[S14] loaded HEAD from S11 (vec_in norm=0.744058)
[S14] cosine check vs S11: cos=0.2734
[S14] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1792) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.908410)
[S13] loaded HEAD from S9 (vec_in norm=0.908410)
[S13] cosine check vs S9: cos=-0.0361
[S13] DROPPED delta from S9 (cos=-0.0361 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.6651 head_norm=1.580018
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.017008e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.6651 head_norm=0.903851 delta_norm=0.901701
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1543 head_norm=0.873823
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.903245e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1766 head_norm=0.646665 delta_norm=0.490324
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4157 head_norm=0.944109
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.841184e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.3742 head_norm=1.182114 delta_norm=0.484118
[S16] aggregate: ROLLBACK (f1_val pre=0.416 post=0.374 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.559372 (no previous merge yet)
[S2] round=7 local utility u=0.261696 metrics={'f1_val': 0.7013121503667978, 'auprc': 0.8353090825987195, 'loss_val': 0.29771125213242305, 'psi': 0.7549109232595665}-{'f1_val': 0.7015719066528542, 'auprc': 0.6901641293355179, 'loss_val': 0.38722750191824834, 'psi': 0.6970087957259197}
[S3] START round=7 head_norm_before_train=1.277691 (no previous merge yet)
[S3] round=7 local utility u=0.004860 metrics={'f1_val': 0.3961740746599177, 'auprc': 0.6604699478038235, 'loss_val': 0.8464948237799522, 'psi': 0.50189242391748}-{'f1_val': 0.39651525753011657, 'auprc': 0.7184290450985233, 'loss_val': 1.032139725623852, 'psi': 0.5252807725574793}
[S4] START round=7 head_norm_before_train=0.903851 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.399060 metrics={'f1_val': 0.6673150197167445, 'auprc': 0.9474213916340581, 'loss_val': 0.529334586186263, 'psi': 0.77935756848367}-{'f1_val': 0.6651329170242223, 'auprc': 0.6692833160384954, 'loss_val': 0.4799487407262082, 'psi': 0.6667930766299315}
[S5] START round=7 head_norm_before_train=0.973743 cos_to_last_merge=0.9638 (last merge round=1)
[S5] round=7 local utility u=0.055709 metrics={'f1_val': 0.4179091272005397, 'auprc': 0.7773785148251314, 'loss_val': 1.022015122504284, 'psi': 0.5616968822503764}-{'f1_val': 0.41734838192522206, 'auprc': 0.7720024677716509, 'loss_val': 1.1139397598647611, 'psi': 0.5592100162637936}
[S6] START round=7 head_norm_before_train=1.204315 cos_to_last_merge=0.9319 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.932
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.41697448575925256, 'auprc': 0.7719467621727119, 'loss_val': 1.006508953542745, 'psi': 0.5589633963246363}-{'f1_val': 0.5830488658556796, 'auprc': 0.8112768058219746, 'loss_val': 0.5967864076080593, 'psi': 0.6743400418421976}
[S7] START round=7 head_norm_before_train=1.245512 (no previous merge yet)
[S7] round=7 local utility u=0.873451 metrics={'f1_val': 0.416467909967687, 'auprc': 0.7767248224663621, 'loss_val': 1.0768696467173349, 'psi': 0.5605706749671571}-{'f1_val': 0.14205682272909165, 'auprc': 0.7767456572293271, 'loss_val': 1.1773674288053155, 'psi': 0.39593235652918585}
[S8] START round=7 head_norm_before_train=1.574670 (no previous merge yet)
[S8] round=7 local utility u=0.058594 metrics={'f1_val': 0.7139293602936292, 'auprc': 0.9903843244027988, 'loss_val': 0.19604716177577955, 'psi': 0.824511345937297}-{'f1_val': 0.7142391053978291, 'auprc': 0.9861293309030066, 'loss_val': 0.3023293263727749, 'psi': 0.8229951955999002}
[S9] START round=7 head_norm_before_train=0.908410 cos_to_last_merge=0.9966 (last merge round=5)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.41661166379000475, 'auprc': 0.9347117298588087, 'loss_val': 0.7380946445849149, 'psi': 0.6238516902175263}-{'f1_val': 0.41697558078303143, 'auprc': 0.9999029665357927, 'loss_val': 0.9135408032720845, 'psi': 0.650146535084136}
[S10] START round=7 head_norm_before_train=1.488019 (no previous merge yet)
[S10] round=7 local utility u=0.060989 metrics={'f1_val': 0.6989359721470711, 'auprc': 0.9928512847155161, 'loss_val': 0.35418125268482364, 'psi': 0.8165020971744492}-{'f1_val': 0.6955083081194023, 'auprc': 0.9974108276442073, 'loss_val': 0.4692727718444652, 'psi': 0.8162693159293244}
[S11] START round=7 head_norm_before_train=0.744058 cos_to_last_merge=0.9798 (last merge round=4)
[S11] round=7 local utility u=0.867736 metrics={'f1_val': 0.39658602128368947, 'auprc': 0.7650539268817623, 'loss_val': 1.0299787107642844, 'psi': 0.5439731835229187}-{'f1_val': 0.14041368337311058, 'auprc': 0.7399124663142759, 'loss_val': 1.1529920467825925, 'psi': 0.3802131965495767}
[S13] START round=7 head_norm_before_train=1.540191 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.6297720056959909, 'auprc': 0.593695176790834, 'loss_val': 0.5920806380265539, 'psi': 0.6153412741339281}-{'f1_val': 0.681055985999509, 'auprc': 0.7493871492983466, 'loss_val': 0.47400537895057987, 'psi': 0.708388451319044}
[S14] START round=7 head_norm_before_train=0.646665 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.520066899761713, 'auprc': 0.8300272130921288, 'loss_val': 1.004349248493539, 'psi': 0.6440510250938793}-{'f1_val': 0.1543393083191311, 'auprc': 0.8112752653943007, 'loss_val': 1.0755479940407358, 'psi': 0.41711369114919894}
[S15] START round=7 head_norm_before_train=1.507895 (no previous merge yet)
[S15] round=7 local utility u=0.051431 metrics={'f1_val': 0.7013530085171876, 'auprc': 0.9838544412899584, 'loss_val': 0.3161051893291779, 'psi': 0.8143535816262959}-{'f1_val': 0.701593608908214, 'auprc': 0.9876860859022343, 'loss_val': 0.4319062455896622, 'psi': 0.8160305997058221}
[S16] START round=7 head_norm_before_train=1.182114 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.222617 metrics={'f1_val': 0.41699752240181287, 'auprc': 0.8991235024789059, 'loss_val': 1.0190282611243957, 'psi': 0.6098479144326501}-{'f1_val': 0.4156626648174509, 'auprc': 0.7829050220975774, 'loss_val': 1.1075972894173156, 'psi': 0.5625596077295015}
[S17] START round=7 head_norm_before_train=1.500702 (no previous merge yet)
[S17] round=7 local utility u=0.143085 metrics={'f1_val': 0.4332390322139451, 'auprc': 0.7285095039781784, 'loss_val': 1.2408836094783136, 'psi': 0.5513472209196384}-{'f1_val': 0.3396907700154473, 'auprc': 0.739523852382167, 'loss_val': 0.9988069006580216, 'psi': 0.49962400296213516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S8] → sending delta(kind=head bytes=1809) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:40409
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:40416
[S4] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1809 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.577497)
[S16] loaded HEAD from S15 (vec_in norm=1.577497)
[S16] cosine check vs S15: cos=-0.0719
[S16] DROPPED delta from S15 (cos=-0.0719 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1809) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.617918)
[S17] loaded HEAD from S8 (vec_in norm=1.617918)
[S17] cosine check vs S8: cos=-0.0075
[S17] DROPPED delta from S8 (cos=-0.0075 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.624591)
[S8] loaded HEAD from S2 (vec_in norm=1.624591)
[S8] cosine check vs S2: cos=-0.0655
[S8] DROPPED delta from S2 (cos=-0.0655 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.205881)
[S8] loaded HEAD from S16 (vec_in norm=1.205881)
[S8] cosine check vs S16: cos=0.0177
[S8] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.697839)
[S4] loaded HEAD from S14 (vec_in norm=0.697839)
[S4] cosine check vs S14: cos=0.4237
[S4] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.319569)
[S4] loaded HEAD from S3 (vec_in norm=1.319569)
[S4] cosine check vs S3: cos=-0.0495
[S4] DROPPED delta from S3 (cos=-0.0495 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1790) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.995780)
[S9] loaded HEAD from S4 (vec_in norm=0.995780)
[S9] cosine check vs S4: cos=0.5515
[S9] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.003682)
[S9] loaded HEAD from S5 (vec_in norm=1.003682)
[S9] cosine check vs S5: cos=0.6805
[S9] BUFFERED delta from S5 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.784850)
[S14] loaded HEAD from S11 (vec_in norm=0.784850)
[S14] cosine check vs S11: cos=0.6968
[S14] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.547964)
[S14] loaded HEAD from S10 (vec_in norm=1.547964)
[S14] cosine check vs S10: cos=-0.0405
[S14] DROPPED delta from S10 (cos=-0.0405 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.270362)
[S10] loaded HEAD from S7 (vec_in norm=1.270362)
[S10] cosine check vs S7: cos=-0.0646
[S10] DROPPED delta from S7 (cos=-0.0646 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.525971)
[S9] loaded HEAD from S17 (vec_in norm=1.525971)
[S9] cosine check vs S17: cos=-0.0609
[S9] DROPPED delta from S17 (cos=-0.0609 < 0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.4166 head_norm=0.963345
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.512741e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.4166 head_norm=0.810350 delta_norm=0.251274
[S9] aggregate: ACCEPT kept=['S4', 'S5'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.5201 head_norm=0.697839
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.914335e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.5214 head_norm=0.683045 delta_norm=0.291434
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.6673 head_norm=0.995780
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.716232e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6670 head_norm=0.718923 delta_norm=0.471623
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.7139 head_norm=1.617918
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.000346e+00
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.7139 head_norm=1.017454 delta_norm=1.000346
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.624591 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.6991628404946595, 'auprc': 0.7751186808516286, 'loss_val': 0.28649846186860106, 'psi': 0.7295451766374471}-{'f1_val': 0.7013121503667978, 'auprc': 0.8353090825987195, 'loss_val': 0.29771125213242305, 'psi': 0.7549109232595665}
[S3] START round=8 head_norm_before_train=1.319569 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.4008827131202587, 'auprc': 0.5713912739208793, 'loss_val': 0.7837073241912076, 'psi': 0.4690861374405069}-{'f1_val': 0.3961740746599177, 'auprc': 0.6604699478038235, 'loss_val': 0.8464948237799522, 'psi': 0.50189242391748}
[S4] START round=8 head_norm_before_train=0.718923 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.828465 metrics={'f1_val': 0.9520414919182769, 'auprc': 0.9456198372744056, 'loss_val': 0.5753580580702706, 'psi': 0.9494728300607284}-{'f1_val': 0.6673150197167445, 'auprc': 0.9474213916340581, 'loss_val': 0.529334586186263, 'psi': 0.77935756848367}
[S5] START round=8 head_norm_before_train=1.003682 cos_to_last_merge=0.9521 (last merge round=1)
[S5] round=8 local utility u=0.069771 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.777560835569504, 'loss_val': 0.8815683657097931, 'psi': 0.5616246456076488}-{'f1_val': 0.4179091272005397, 'auprc': 0.7773785148251314, 'loss_val': 1.022015122504284, 'psi': 0.5616968822503764}
[S6] START round=8 head_norm_before_train=1.278441 cos_to_last_merge=0.9104 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.910
[S6] round=8 local utility u=1.000000 metrics={'f1_val': 0.7093573492191457, 'auprc': 0.9884250473358671, 'loss_val': 0.31846149394620155, 'psi': 0.8209844284658343}-{'f1_val': 0.41697448575925256, 'auprc': 0.7719467621727119, 'loss_val': 1.006508953542745, 'psi': 0.5589633963246363}
[S7] START round=8 head_norm_before_train=1.270362 (no previous merge yet)
[S7] round=8 local utility u=0.090957 metrics={'f1_val': 0.4172807768329403, 'auprc': 0.7888247994835275, 'loss_val': 0.936131967181437, 'psi': 0.5658983858931752}-{'f1_val': 0.416467909967687, 'auprc': 0.7767248224663621, 'loss_val': 1.0768696467173349, 'psi': 0.5605706749671571}
[S8] START round=8 head_norm_before_train=1.017454 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.310309 metrics={'f1_val': 0.8402927932020479, 'auprc': 0.9875005516729987, 'loss_val': 0.32495839534567394, 'psi': 0.8991758965904282}-{'f1_val': 0.7139293602936292, 'auprc': 0.9903843244027988, 'loss_val': 0.19604716177577955, 'psi': 0.824511345937297}
[S9] START round=8 head_norm_before_train=0.810350 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.208318 metrics={'f1_val': 0.437785816257105, 'auprc': 0.9993943971371316, 'loss_val': 0.6425520031266753, 'psi': 0.6624292486091157}-{'f1_val': 0.41661166379000475, 'auprc': 0.9347117298588087, 'loss_val': 0.7380946445849149, 'psi': 0.6238516902175263}
[S10] START round=8 head_norm_before_train=1.547964 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.6990791231489479, 'auprc': 0.9386789379712301, 'loss_val': 0.3441256229042587, 'psi': 0.7949190490778608}-{'f1_val': 0.6989359721470711, 'auprc': 0.9928512847155161, 'loss_val': 0.35418125268482364, 'psi': 0.8165020971744492}
[S11] START round=8 head_norm_before_train=0.784850 cos_to_last_merge=0.9584 (last merge round=4)
[S11] round=8 local utility u=0.351337 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.942456717414368, 'loss_val': 0.8591090019480896, 'psi': 0.6148938196112468}-{'f1_val': 0.39658602128368947, 'auprc': 0.7650539268817623, 'loss_val': 1.0299787107642844, 'psi': 0.5439731835229187}
[S13] START round=8 head_norm_before_train=1.584105 (no previous merge yet)
[S13] round=8 local utility u=0.417640 metrics={'f1_val': 0.693027634759639, 'auprc': 0.6867522761579512, 'loss_val': 0.41550637315185945, 'psi': 0.6905174913189639}-{'f1_val': 0.6297720056959909, 'auprc': 0.593695176790834, 'loss_val': 0.5920806380265539, 'psi': 0.6153412741339281}
[S14] START round=8 head_norm_before_train=0.683045 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.235189 metrics={'f1_val': 0.5164124948061133, 'auprc': 0.9759377636110056, 'loss_val': 0.9497764518800389, 'psi': 0.7002226023280702}-{'f1_val': 0.520066899761713, 'auprc': 0.8300272130921288, 'loss_val': 1.004349248493539, 'psi': 0.6440510250938793}
[S15] START round=8 head_norm_before_train=1.577497 (no previous merge yet)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.6891373858173344, 'auprc': 0.9816733337164588, 'loss_val': 0.32884034780883115, 'psi': 0.8061517649769843}-{'f1_val': 0.7013530085171876, 'auprc': 0.9838544412899584, 'loss_val': 0.3161051893291779, 'psi': 0.8143535816262959}
[S16] START round=8 head_norm_before_train=1.205881 cos_to_last_merge=0.9972 (last merge round=6)
[S16] round=8 local utility u=0.017790 metrics={'f1_val': 0.4168831021970758, 'auprc': 0.8640239441578493, 'loss_val': 0.8774629925915625, 'psi': 0.5957394389813853}-{'f1_val': 0.41699752240181287, 'auprc': 0.8991235024789059, 'loss_val': 1.0190282611243957, 'psi': 0.6098479144326501}
[S17] START round=8 head_norm_before_train=1.525971 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3443325337366767, 'auprc': 0.6664677563023228, 'loss_val': 0.963821111222998, 'psi': 0.4731866227629352}-{'f1_val': 0.4332390322139451, 'auprc': 0.7285095039781784, 'loss_val': 1.2408836094783136, 'psi': 0.5513472209196384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:40412
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:40417
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:40410
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:40411
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.836104)
[S14] loaded HEAD from S11 (vec_in norm=0.836104)
[S14] cosine check vs S11: cos=0.8652
[S14] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1794) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.722259)
[S4] loaded HEAD from S14 (vec_in norm=0.722259)
[S4] cosine check vs S14: cos=0.6339
[S4] BUFFERED delta from S14 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1797) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.834804)
[S9] loaded HEAD from S4 (vec_in norm=0.834804)
[S9] cosine check vs S4: cos=0.5303
[S9] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.870104)
[S13] loaded HEAD from S9 (vec_in norm=0.870104)
[S13] cosine check vs S9: cos=-0.0284
[S13] DROPPED delta from S9 (cos=-0.0284 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.046114)
[S9] loaded HEAD from S5 (vec_in norm=1.046114)
[S9] cosine check vs S5: cos=0.7113
[S9] BUFFERED delta from S5 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.324734)
[S11] loaded HEAD from S6 (vec_in norm=1.324734)
[S11] cosine check vs S6: cos=0.6432
[S11] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1796) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.241270)
[S8] loaded HEAD from S16 (vec_in norm=1.241270)
[S8] cosine check vs S16: cos=0.5706
[S8] BUFFERED delta from S16 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.615668)
[S16] loaded HEAD from S13 (vec_in norm=1.615668)
[S16] cosine check vs S13: cos=0.9365
[S16] BUFFERED delta from S13 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.302081)
[S10] loaded HEAD from S7 (vec_in norm=1.302081)
[S10] cosine check vs S7: cos=-0.0704
[S10] DROPPED delta from S7 (cos=-0.0704 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.079985)
[S17] loaded HEAD from S8 (vec_in norm=1.079985)
[S17] cosine check vs S8: cos=-0.0592
[S17] DROPPED delta from S8 (cos=-0.0592 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.4378 head_norm=0.870104
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.098293e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.4370 head_norm=0.748561 delta_norm=0.209829
[S9] aggregate: ACCEPT kept=['S4', 'S5'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.9520 head_norm=0.834804
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.369311e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.9476 head_norm=0.704099 delta_norm=0.336931
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4169 head_norm=1.241270
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.142445e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4170 head_norm=1.405993 delta_norm=0.314244
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.5164 head_norm=0.722259
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.095950e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.5159 head_norm=0.752618 delta_norm=0.209595
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3965 head_norm=0.836104
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.072294e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3907 head_norm=0.984740 delta_norm=0.507229
[S11] aggregate: ROLLBACK (f1_val pre=0.397 post=0.391 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.8403 head_norm=1.079985
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.425152e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.7381 head_norm=1.029193 delta_norm=0.542515
[S8] aggregate: ROLLBACK (f1_val pre=0.840 post=0.738 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=1.677673 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7017525803949645, 'auprc': 0.6746792910012869, 'loss_val': 0.2783962981597171, 'psi': 0.6909232646374934}-{'f1_val': 0.6991628404946595, 'auprc': 0.7751186808516286, 'loss_val': 0.28649846186860106, 'psi': 0.7295451766374471}
[S3] START round=9 head_norm_before_train=1.368059 (no previous merge yet)
[S3] round=9 local utility u=0.139315 metrics={'f1_val': 0.45571023074537453, 'auprc': 0.5452146619757682, 'loss_val': 0.755512236768747, 'psi': 0.49151200323753197}-{'f1_val': 0.4008827131202587, 'auprc': 0.5713912739208793, 'loss_val': 0.7837073241912076, 'psi': 0.4690861374405069}
[S4] START round=9 head_norm_before_train=0.704099 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.66606788104105, 'auprc': 0.9418392195366505, 'loss_val': 0.581340460318044, 'psi': 0.7763764164392901}-{'f1_val': 0.9520414919182769, 'auprc': 0.9456198372744056, 'loss_val': 0.5753580580702706, 'psi': 0.9494728300607284}
[S5] START round=9 head_norm_before_train=1.046114 cos_to_last_merge=0.9365 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=9 local utility u=0.650938 metrics={'f1_val': 0.6317894486004318, 'auprc': 0.7470594761765568, 'loss_val': 0.7729221912039863, 'psi': 0.6778974596308818}-{'f1_val': 0.4176671856330787, 'auprc': 0.777560835569504, 'loss_val': 0.8815683657097931, 'psi': 0.5616246456076488}
[S6] START round=9 head_norm_before_train=1.324734 cos_to_last_merge=0.8979 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.898
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.6259990859946869, 'auprc': 0.8055570671034137, 'loss_val': 0.5224315607225838, 'psi': 0.6978222784381776}-{'f1_val': 0.7093573492191457, 'auprc': 0.9884250473358671, 'loss_val': 0.31846149394620155, 'psi': 0.8209844284658343}
[S7] START round=9 head_norm_before_train=1.302081 (no previous merge yet)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.41711588266717814, 'auprc': 0.704817027801348, 'loss_val': 0.8536457463393318, 'psi': 0.5321963407208461}-{'f1_val': 0.4172807768329403, 'auprc': 0.7888247994835275, 'loss_val': 0.936131967181437, 'psi': 0.5658983858931752}
[S8] START round=9 head_norm_before_train=1.029193 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.426201 metrics={'f1_val': 0.9836460002119137, 'auprc': 0.9972773773999567, 'loss_val': 0.3620054304268164, 'psi': 0.9890985510871309}-{'f1_val': 0.8402927932020479, 'auprc': 0.9875005516729987, 'loss_val': 0.32495839534567394, 'psi': 0.8991758965904282}
[S9] START round=9 head_norm_before_train=0.748561 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.826503 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9984843294187701, 'loss_val': 0.5678436321724045, 'psi': 0.8201680218920461}-{'f1_val': 0.437785816257105, 'auprc': 0.9993943971371316, 'loss_val': 0.6425520031266753, 'psi': 0.6624292486091157}
[S10] START round=9 head_norm_before_train=1.600198 (no previous merge yet)
[S10] round=9 local utility u=0.620018 metrics={'f1_val': 0.8537843125323236, 'auprc': 0.996600389080633, 'loss_val': 0.20608460683432112, 'psi': 0.9109107431516473}-{'f1_val': 0.6990791231489479, 'auprc': 0.9386789379712301, 'loss_val': 0.3441256229042587, 'psi': 0.7949190490778608}
[S11] START round=9 head_norm_before_train=0.984740 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.759940 metrics={'f1_val': 0.6268815422732855, 'auprc': 0.9661249224070863, 'loss_val': 0.7924114231794607, 'psi': 0.7625788943268058}-{'f1_val': 0.39651855440916606, 'auprc': 0.942456717414368, 'loss_val': 0.8591090019480896, 'psi': 0.6148938196112468}
[S13] START round=9 head_norm_before_train=1.615668 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.600992114628043, 'auprc': 0.6880623341246761, 'loss_val': 0.6329030828564365, 'psi': 0.6358202024266962}-{'f1_val': 0.693027634759639, 'auprc': 0.6867522761579512, 'loss_val': 0.41550637315185945, 'psi': 0.6905174913189639}
[S14] START round=9 head_norm_before_train=0.752618 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.40158185258957224, 'auprc': 0.992889327688995, 'loss_val': 0.8997779117199806, 'psi': 0.6381048426293413}-{'f1_val': 0.5164124948061133, 'auprc': 0.9759377636110056, 'loss_val': 0.9497764518800389, 'psi': 0.7002226023280702}
[S15] START round=9 head_norm_before_train=1.643848 (no previous merge yet)
[S15] round=9 local utility u=0.032588 metrics={'f1_val': 0.701073687542608, 'auprc': 0.9829534144515792, 'loss_val': 0.33912230260662746, 'psi': 0.8138255783061965}-{'f1_val': 0.6891373858173344, 'auprc': 0.9816733337164588, 'loss_val': 0.32884034780883115, 'psi': 0.8061517649769843}
[S16] START round=9 head_norm_before_train=1.405993 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.096920 metrics={'f1_val': 0.41696372269722326, 'auprc': 0.9052872464117416, 'loss_val': 0.8078957224149208, 'psi': 0.6122931321830307}-{'f1_val': 0.4168831021970758, 'auprc': 0.8640239441578493, 'loss_val': 0.8774629925915625, 'psi': 0.5957394389813853}
[S17] START round=9 head_norm_before_train=1.556667 (no previous merge yet)
[S17] round=9 local utility u=0.265940 metrics={'f1_val': 0.4685120244514057, 'auprc': 0.614580424088313, 'loss_val': 1.021356457482766, 'psi': 0.5269393843061687}-{'f1_val': 0.3443325337366767, 'auprc': 0.6664677563023228, 'loss_val': 0.963821111222998, 'psi': 0.4731866227629352}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:40416
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:40414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:40413
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.110647)
[S17] loaded HEAD from S8 (vec_in norm=1.110647)
[S17] cosine check vs S8: cos=-0.0786
[S17] DROPPED delta from S8 (cos=-0.0786 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.814252)
[S13] loaded HEAD from S9 (vec_in norm=0.814252)
[S13] cosine check vs S9: cos=-0.0226
[S13] DROPPED delta from S9 (cos=-0.0226 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.436238)
[S8] loaded HEAD from S16 (vec_in norm=1.436238)
[S8] cosine check vs S16: cos=0.8445
[S8] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1804) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.413680)
[S4] loaded HEAD from S3 (vec_in norm=1.413680)
[S4] cosine check vs S3: cos=0.0356
[S4] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.699252)
[S16] loaded HEAD from S15 (vec_in norm=1.699252)
[S16] cosine check vs S15: cos=-0.0680
[S16] DROPPED delta from S15 (cos=-0.0680 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.087301)
[S9] loaded HEAD from S5 (vec_in norm=1.087301)
[S9] cosine check vs S5: cos=0.7515
[S9] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.637482)
[S14] loaded HEAD from S10 (vec_in norm=1.637482)
[S14] cosine check vs S10: cos=0.0061
[S14] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.016618)
[S14] loaded HEAD from S11 (vec_in norm=1.016618)
[S14] cosine check vs S11: cos=0.8174
[S14] BUFFERED delta from S11 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.583403)
[S9] loaded HEAD from S17 (vec_in norm=1.583403)
[S9] cosine check vs S17: cos=-0.0504
[S9] DROPPED delta from S17 (cos=-0.0504 < 0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.4016 head_norm=0.784386
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.704347e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.5143 head_norm=0.742401 delta_norm=0.470435
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6661 head_norm=0.814282
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.030397e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6367 head_norm=0.828191 delta_norm=0.803040
[S4] aggregate: ROLLBACK (f1_val pre=0.666 post=0.637 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7013 head_norm=0.814252
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.586932e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7013 head_norm=0.891041 delta_norm=0.358693
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.9836 head_norm=1.110647
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.879737e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.9730 head_norm=1.223779 delta_norm=0.387974
[S8] aggregate: ROLLBACK (f1_val pre=0.984 post=0.973 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.720986 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6624909881187685, 'loss_val': 0.27604722102571566, 'psi': 0.6859390306706564}-{'f1_val': 0.7017525803949645, 'auprc': 0.6746792910012869, 'loss_val': 0.2783962981597171, 'psi': 0.6909232646374934}
[S3] START round=10 head_norm_before_train=1.413680 (no previous merge yet)
[S3] round=10 local utility u=0.111959 metrics={'f1_val': 0.45574968867519494, 'auprc': 0.6092543536488959, 'loss_val': 0.7239503159609627, 'psi': 0.5171515546646753}-{'f1_val': 0.45571023074537453, 'auprc': 0.5452146619757682, 'loss_val': 0.755512236768747, 'psi': 0.49151200323753197}
[S4] START round=10 head_norm_before_train=0.828191 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.804747 metrics={'f1_val': 0.9477959541002255, 'auprc': 0.935105653923308, 'loss_val': 0.6420137555110998, 'psi': 0.9427198340294585}-{'f1_val': 0.66606788104105, 'auprc': 0.9418392195366505, 'loss_val': 0.581340460318044, 'psi': 0.7763764164392901}
[S5] START round=10 head_norm_before_train=1.087301 cos_to_last_merge=0.9207 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.921
[S5] round=10 local utility u=0.239462 metrics={'f1_val': 0.6734133465014461, 'auprc': 0.7945898885649804, 'loss_val': 0.6863325804805348, 'psi': 0.7218839633268599}-{'f1_val': 0.6317894486004318, 'auprc': 0.7470594761765568, 'loss_val': 0.7729221912039863, 'psi': 0.6778974596308818}
[S6] START round=10 head_norm_before_train=1.362129 cos_to_last_merge=0.8912 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.891
[S6] round=10 local utility u=0.098472 metrics={'f1_val': 0.6409874638457987, 'auprc': 0.8129069603645049, 'loss_val': 0.43746816414791484, 'psi': 0.7097552624532812}-{'f1_val': 0.6259990859946869, 'auprc': 0.8055570671034137, 'loss_val': 0.5224315607225838, 'psi': 0.6978222784381776}
[S7] START round=10 head_norm_before_train=1.334209 (no previous merge yet)
[S7] round=10 local utility u=0.135159 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7837140067619423, 'loss_val': 0.8183180597717999, 'psi': 0.563585082363841}-{'f1_val': 0.41711588266717814, 'auprc': 0.704817027801348, 'loss_val': 0.8536457463393318, 'psi': 0.5321963407208461}
[S8] START round=10 head_norm_before_train=1.223779 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.7138416185186716, 'auprc': 0.9871444427405733, 'loss_val': 0.3372272558130663, 'psi': 0.8231627482074323}-{'f1_val': 0.9836460002119137, 'auprc': 0.9972773773999567, 'loss_val': 0.3620054304268164, 'psi': 0.9890985510871309}
[S9] START round=10 head_norm_before_train=0.891041 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.050943 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9959811800426208, 'loss_val': 0.4584474516666631, 'psi': 0.8191667621415863}-{'f1_val': 0.7012904835408967, 'auprc': 0.9984843294187701, 'loss_val': 0.5678436321724045, 'psi': 0.8201680218920461}
[S10] START round=10 head_norm_before_train=1.637482 (no previous merge yet)
[S10] round=10 local utility u=0.445711 metrics={'f1_val': 0.9953253286375586, 'auprc': 0.9964617335539754, 'loss_val': 0.1634921152590801, 'psi': 0.9957798906041253}-{'f1_val': 0.8537843125323236, 'auprc': 0.996600389080633, 'loss_val': 0.20608460683432112, 'psi': 0.9109107431516473}
[S11] START round=10 head_norm_before_train=1.016618 cos_to_last_merge=0.9954 (last merge round=8)
[S11] round=10 local utility u=0.288684 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.941348230357092, 'loss_val': 0.5918224061717845, 'psi': 0.7977791902098008}-{'f1_val': 0.6268815422732855, 'auprc': 0.9661249224070863, 'loss_val': 0.7924114231794607, 'psi': 0.7625788943268058}
[S13] START round=10 head_norm_before_train=1.635093 (no previous merge yet)
[S13] round=10 local utility u=0.203760 metrics={'f1_val': 0.6551444040997721, 'auprc': 0.6637106691568556, 'loss_val': 0.47724272814789054, 'psi': 0.6585709101226056}-{'f1_val': 0.600992114628043, 'auprc': 0.6880623341246761, 'loss_val': 0.6329030828564365, 'psi': 0.6358202024266962}
[S14] START round=10 head_norm_before_train=0.742401 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.3963441772668592, 'auprc': 0.9426323550780784, 'loss_val': 0.880462214733558, 'psi': 0.614859448391347}-{'f1_val': 0.40158185258957224, 'auprc': 0.992889327688995, 'loss_val': 0.8997779117199806, 'psi': 0.6381048426293413}
[S15] START round=10 head_norm_before_train=1.699252 (no previous merge yet)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.7008085024694171, 'auprc': 0.9762596662619953, 'loss_val': 0.3260591885554538, 'psi': 0.8109889679864484}-{'f1_val': 0.701073687542608, 'auprc': 0.9829534144515792, 'loss_val': 0.33912230260662746, 'psi': 0.8138255783061965}
[S16] START round=10 head_norm_before_train=1.436238 cos_to_last_merge=0.9977 (last merge round=8)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.41676889153789465, 'auprc': 0.8508361244084964, 'loss_val': 0.753566634369658, 'psi': 0.5903957846861354}-{'f1_val': 0.41696372269722326, 'auprc': 0.9052872464117416, 'loss_val': 0.8078957224149208, 'psi': 0.6122931321830307}
[S17] START round=10 head_norm_before_train=1.583403 (no previous merge yet)
[S17] round=10 local utility u=0.211565 metrics={'f1_val': 0.47493394567636577, 'auprc': 0.7185066788541788, 'loss_val': 0.9485361265921692, 'psi': 0.572363038947491}-{'f1_val': 0.4685120244514057, 'auprc': 0.614580424088313, 'loss_val': 1.021356457482766, 'psi': 0.5269393843061687}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:40412
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.396209)
[S11] loaded HEAD from S6 (vec_in norm=1.396209)
[S11] cosine check vs S6: cos=0.8823
[S11] BUFFERED delta from S6 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1801) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.365782)
[S10] loaded HEAD from S7 (vec_in norm=1.365782)
[S10] cosine check vs S7: cos=-0.0821
[S10] DROPPED delta from S7 (cos=-0.0821 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.901330)
[S9] loaded HEAD from S4 (vec_in norm=0.901330)
[S9] cosine check vs S4: cos=0.1511
[S9] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1796) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.454056)
[S4] loaded HEAD from S3 (vec_in norm=1.454056)
[S4] cosine check vs S3: cos=0.7755
[S4] BUFFERED delta from S3 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.129947)
[S9] loaded HEAD from S5 (vec_in norm=1.129947)
[S9] cosine check vs S5: cos=0.9307
[S9] BUFFERED delta from S5 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.662528)
[S16] loaded HEAD from S13 (vec_in norm=1.662528)
[S16] cosine check vs S13: cos=0.9653
[S16] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.064230)
[S14] loaded HEAD from S11 (vec_in norm=1.064230)
[S14] cosine check vs S11: cos=0.7573
[S14] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.682005)
[S14] loaded HEAD from S10 (vec_in norm=1.682005)
[S14] cosine check vs S10: cos=0.5317
[S14] BUFFERED delta from S10 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1802) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.954623)
[S13] loaded HEAD from S9 (vec_in norm=0.954623)
[S13] cosine check vs S9: cos=-0.0213
[S13] DROPPED delta from S9 (cos=-0.0213 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.618488)
[S9] loaded HEAD from S17 (vec_in norm=1.618488)
[S9] cosine check vs S17: cos=-0.0476
[S9] DROPPED delta from S17 (cos=-0.0476 < 0.0)
[S8] ⇄ pheromone p=0.320 → S17@127.0.0.1:40417
[S15] ⇄ pheromone p=0.248 → S16@127.0.0.1:40416
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.3963 head_norm=0.771578
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.669132e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.4005 head_norm=0.852755 delta_norm=0.266913
[S14] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.273 → S4@127.0.0.1:40404
[S2] ⇄ pheromone p=0.227 → S8@127.0.0.1:40409
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7013 head_norm=0.954623
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.700725e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7013 head_norm=0.799945 delta_norm=0.270073
[S9] aggregate: ACCEPT kept=['S4', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.378 → S13@127.0.0.1:40413
[S7] ⇄ pheromone p=0.265 → S10@127.0.0.1:40411
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.7021 head_norm=1.064230
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.391178e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.7021 head_norm=1.194149 delta_norm=0.339118
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.445 → S14@127.0.0.1:40414
[S3] ⇄ pheromone p=0.237 → S4@127.0.0.1:40404
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.9478 head_norm=0.901330
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.727147e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6261 head_norm=1.113499 delta_norm=0.472715
[S4] aggregate: ROLLBACK (f1_val pre=0.948 post=0.626 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.470 → S9@127.0.0.1:40410
[S5] ⇄ pheromone p=0.386 → S9@127.0.0.1:40410
[S6] ⇄ pheromone p=0.364 → S11@127.0.0.1:40412
[S13] ⇄ pheromone p=0.333 → S16@127.0.0.1:40416
[S10] ⇄ pheromone p=0.444 → S14@127.0.0.1:40414
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4168 head_norm=1.466418
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.277509e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.4168 head_norm=1.550910 delta_norm=0.227751
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.231 → S8@127.0.0.1:40409
[S17] ⇄ pheromone p=0.275 → S9@127.0.0.1:40410
[S2] START round=11 head_norm_before_train=1.752382 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.7017525803949645, 'auprc': 0.6602401840027301, 'loss_val': 0.28885732195995045, 'psi': 0.6851476218380708}-{'f1_val': 0.7015710590385817, 'auprc': 0.6624909881187685, 'loss_val': 0.27604722102571566, 'psi': 0.6859390306706564}
[S3] START round=11 head_norm_before_train=1.454056 (no previous merge yet)
[S3] round=11 local utility u=0.716674 metrics={'f1_val': 0.601716204537875, 'auprc': 0.7202766016199234, 'loss_val': 0.49946857885739865, 'psi': 0.6491403633706944}-{'f1_val': 0.45574968867519494, 'auprc': 0.6092543536488959, 'loss_val': 0.7239503159609627, 'psi': 0.5171515546646753}
[S4] START round=11 head_norm_before_train=1.113499 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.9456850451598875, 'auprc': 0.9398567669423822, 'loss_val': 0.6571594325282977, 'psi': 0.9433537338728855}-{'f1_val': 0.9477959541002255, 'auprc': 0.935105653923308, 'loss_val': 0.6420137555110998, 'psi': 0.9427198340294585}
[S5] START round=11 head_norm_before_train=1.129947 cos_to_last_merge=0.9056 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.906
[S5] round=11 local utility u=0.043070 metrics={'f1_val': 0.6766203771792285, 'auprc': 0.7934239695042064, 'loss_val': 0.6159379006583409, 'psi': 0.7233418141092196}-{'f1_val': 0.6734133465014461, 'auprc': 0.7945898885649804, 'loss_val': 0.6863325804805348, 'psi': 0.7218839633268599}
[S6] START round=11 head_norm_before_train=1.396209 cos_to_last_merge=0.8869 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.887
[S6] round=11 local utility u=0.791664 metrics={'f1_val': 0.8222870354446487, 'auprc': 0.9556024609755002, 'loss_val': 0.37002408712124485, 'psi': 0.8756132056569892}-{'f1_val': 0.6409874638457987, 'auprc': 0.8129069603645049, 'loss_val': 0.43746816414791484, 'psi': 0.7097552624532812}
[S7] START round=11 head_norm_before_train=1.365782 (no previous merge yet)
[S7] round=11 local utility u=0.017290 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.778014123767296, 'loss_val': 0.7659034387544497, 'psi': 0.5612317203735324}-{'f1_val': 0.41683246609844005, 'auprc': 0.7837140067619423, 'loss_val': 0.8183180597717999, 'psi': 0.563585082363841}
[S8] START round=11 head_norm_before_train=1.295585 cos_to_last_merge=0.9907 (last merge round=9)
[S8] round=11 local utility u=0.188578 metrics={'f1_val': 0.7594380456483251, 'auprc': 0.9864613286296837, 'loss_val': 0.2316010915756892, 'psi': 0.8502473588408686}-{'f1_val': 0.7138416185186716, 'auprc': 0.9871444427405733, 'loss_val': 0.3372272558130663, 'psi': 0.8231627482074323}
[S9] START round=11 head_norm_before_train=0.799945 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.007000 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.9963142626117464, 'loss_val': 0.44394483272925306, 'psi': 0.8191497989173053}-{'f1_val': 0.7012904835408967, 'auprc': 0.9959811800426208, 'loss_val': 0.4584474516666631, 'psi': 0.8191667621415863}
[S10] START round=11 head_norm_before_train=1.682005 (no previous merge yet)
[S10] round=11 local utility u=0.021129 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9926934182125595, 'loss_val': 0.1041155358331178, 'psi': 0.9936912063120766}-{'f1_val': 0.9953253286375586, 'auprc': 0.9964617335539754, 'loss_val': 0.1634921152590801, 'psi': 0.9957798906041253}
[S11] START round=11 head_norm_before_train=1.194149 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.023938 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9379392849092625, 'loss_val': 0.5329322042271668, 'psi': 0.7963369039426971}-{'f1_val': 0.7020664967782734, 'auprc': 0.941348230357092, 'loss_val': 0.5918224061717845, 'psi': 0.7977791902098008}
[S13] START round=11 head_norm_before_train=1.662528 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6279691012552819, 'auprc': 0.6839443581787154, 'loss_val': 0.5526180775699623, 'psi': 0.6503592040246553}-{'f1_val': 0.6551444040997721, 'auprc': 0.6637106691568556, 'loss_val': 0.47724272814789054, 'psi': 0.6585709101226056}
[S14] START round=11 head_norm_before_train=0.852755 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.39155223937832634, 'auprc': 0.9393079550844551, 'loss_val': 0.8532323603036858, 'psi': 0.6106545256607778}-{'f1_val': 0.3963441772668592, 'auprc': 0.9426323550780784, 'loss_val': 0.880462214733558, 'psi': 0.614859448391347}
[S15] START round=11 head_norm_before_train=1.739818 (no previous merge yet)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.7010727670384516, 'auprc': 0.921289340890105, 'loss_val': 0.4487595938248791, 'psi': 0.7891593965791129}-{'f1_val': 0.7008085024694171, 'auprc': 0.9762596662619953, 'loss_val': 0.3260591885554538, 'psi': 0.8109889679864484}
[S16] START round=11 head_norm_before_train=1.550910 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.42258858640006, 'auprc': 0.7447253227061573, 'loss_val': 0.7119157251379253, 'psi': 0.551443280922499}-{'f1_val': 0.41676889153789465, 'auprc': 0.8508361244084964, 'loss_val': 0.753566634369658, 'psi': 0.5903957846861354}
[S17] START round=11 head_norm_before_train=1.618488 (no previous merge yet)
[S17] round=11 local utility u=0.377588 metrics={'f1_val': 0.5366073611406077, 'auprc': 0.8635762390492909, 'loss_val': 0.9986087539498533, 'psi': 0.667394912304081}-{'f1_val': 0.47493394567636577, 'auprc': 0.7185066788541788, 'loss_val': 0.9485361265921692, 'psi': 0.572363038947491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:40417
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:40404
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:40411
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.489682)
[S4] loaded HEAD from S3 (vec_in norm=1.489682)
[S4] cosine check vs S3: cos=0.9094
[S4] BUFFERED delta from S3 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.172146)
[S9] loaded HEAD from S5 (vec_in norm=1.172146)
[S9] cosine check vs S5: cos=0.8801
[S9] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.737085)
[S14] loaded HEAD from S10 (vec_in norm=1.737085)
[S14] cosine check vs S10: cos=0.7140
[S14] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.374699)
[S17] loaded HEAD from S8 (vec_in norm=1.374699)
[S17] cosine check vs S8: cos=-0.1028
[S17] DROPPED delta from S8 (cos=-0.1028 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.869033)
[S13] loaded HEAD from S9 (vec_in norm=0.869033)
[S13] cosine check vs S9: cos=-0.0110
[S13] DROPPED delta from S9 (cos=-0.0110 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.230096)
[S14] loaded HEAD from S11 (vec_in norm=1.230096)
[S14] cosine check vs S11: cos=0.6055
[S14] BUFFERED delta from S11 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1804) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.389949)
[S10] loaded HEAD from S7 (vec_in norm=1.389949)
[S10] cosine check vs S7: cos=-0.0869
[S10] DROPPED delta from S7 (cos=-0.0869 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.423856)
[S11] loaded HEAD from S6 (vec_in norm=1.423856)
[S11] cosine check vs S6: cos=0.9584
[S11] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1806 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1806) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.663729)
[S9] loaded HEAD from S17 (vec_in norm=1.663729)
[S9] cosine check vs S17: cos=-0.0344
[S9] DROPPED delta from S17 (cos=-0.0344 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.9457 head_norm=1.160332
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.246739e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.7864 head_norm=1.295125 delta_norm=0.324674
[S4] aggregate: ROLLBACK (f1_val pre=0.946 post=0.786 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.3916 head_norm=0.878187
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.995309e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.3947 head_norm=0.954708 delta_norm=0.199531
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7019 head_norm=1.230096
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.139782e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7019 head_norm=1.313189 delta_norm=0.213978
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7010 head_norm=0.869033
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.898532e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7010 head_norm=0.990231 delta_norm=0.289853
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.776020 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.6600368885782112, 'loss_val': 0.29909009806876685, 'psi': 0.6849098451695921}-{'f1_val': 0.7017525803949645, 'auprc': 0.6602401840027301, 'loss_val': 0.28885732195995045, 'psi': 0.6851476218380708}
[S3] START round=12 head_norm_before_train=1.489682 (no previous merge yet)
[S3] round=12 local utility u=0.517885 metrics={'f1_val': 0.7000850230591003, 'auprc': 0.8264316800681015, 'loss_val': 0.37237648953679003, 'psi': 0.7506236858627007}-{'f1_val': 0.601716204537875, 'auprc': 0.7202766016199234, 'loss_val': 0.49946857885739865, 'psi': 0.6491403633706944}
[S4] START round=12 head_norm_before_train=1.295125 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.033383 metrics={'f1_val': 0.9442106686431982, 'auprc': 0.9510217132503848, 'loss_val': 0.6150411611946078, 'psi': 0.9469350864860728}-{'f1_val': 0.9456850451598875, 'auprc': 0.9398567669423822, 'loss_val': 0.6571594325282977, 'psi': 0.9433537338728855}
[S5] START round=12 head_norm_before_train=1.172146 cos_to_last_merge=0.8919 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.892
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.5064801832573633, 'auprc': 0.78546432899778, 'loss_val': 0.6310743206422608, 'psi': 0.6180738415535301}-{'f1_val': 0.6766203771792285, 'auprc': 0.7934239695042064, 'loss_val': 0.6159379006583409, 'psi': 0.7233418141092196}
[S6] START round=12 head_norm_before_train=1.423856 cos_to_last_merge=0.8826 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.883
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.633715479414251, 'auprc': 0.8118608143115175, 'loss_val': 0.5323640729530746, 'psi': 0.7049736133731576}-{'f1_val': 0.8222870354446487, 'auprc': 0.9556024609755002, 'loss_val': 0.37002408712124485, 'psi': 0.8756132056569892}
[S7] START round=12 head_norm_before_train=1.389949 (no previous merge yet)
[S7] round=12 local utility u=0.729191 metrics={'f1_val': 0.6606253063642221, 'auprc': 0.7758831429588546, 'loss_val': 0.7646198164028105, 'psi': 0.7067284410020751}-{'f1_val': 0.41671011811102343, 'auprc': 0.778014123767296, 'loss_val': 0.7659034387544497, 'psi': 0.5612317203735324}
[S8] START round=12 head_norm_before_train=1.374699 cos_to_last_merge=0.9740 (last merge round=9)
[S8] round=12 local utility u=0.764854 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.9978575480301597, 'loss_val': 0.13926317731210622, 'psi': 0.9951240015274994}-{'f1_val': 0.7594380456483251, 'auprc': 0.9864613286296837, 'loss_val': 0.2316010915756892, 'psi': 0.8502473588408686}
[S9] START round=12 head_norm_before_train=0.990231 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.046847 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9981812875414442, 'loss_val': 0.35735458790346725, 'psi': 0.8200468051411157}-{'f1_val': 0.7010401564543445, 'auprc': 0.9963142626117464, 'loss_val': 0.44394483272925306, 'psi': 0.8191497989173053}
[S10] START round=12 head_norm_before_train=1.737085 (no previous merge yet)
[S10] round=12 local utility u=0.019694 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9941639566518441, 'loss_val': 0.07412799237891732, 'psi': 0.9947782860723624}-{'f1_val': 0.9943563983784213, 'auprc': 0.9926934182125595, 'loss_val': 0.1041155358331178, 'psi': 0.9936912063120766}
[S11] START round=12 head_norm_before_train=1.313189 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.123347 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9957903759725009, 'loss_val': 0.46018492459173865, 'psi': 0.8195166159565396}-{'f1_val': 0.7019353166316534, 'auprc': 0.9379392849092625, 'loss_val': 0.5329322042271668, 'psi': 0.7963369039426971}
[S13] START round=12 head_norm_before_train=1.682310 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.5799314004874714, 'auprc': 0.6880722915108335, 'loss_val': 0.8678787840850883, 'psi': 0.6231877568968163}-{'f1_val': 0.6279691012552819, 'auprc': 0.6839443581787154, 'loss_val': 0.5526180775699623, 'psi': 0.6503592040246553}
[S14] START round=12 head_norm_before_train=0.954708 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.140000 metrics={'f1_val': 0.39629970208074317, 'auprc': 0.9938204720959383, 'loss_val': 0.765254781097747, 'psi': 0.6353080100868211}-{'f1_val': 0.39155223937832634, 'auprc': 0.9393079550844551, 'loss_val': 0.8532323603036858, 'psi': 0.6106545256607778}
[S15] START round=12 head_norm_before_train=1.774852 (no previous merge yet)
[S15] round=12 local utility u=0.256803 metrics={'f1_val': 0.7418352600504143, 'auprc': 0.9886999815882875, 'loss_val': 0.38196057355538027, 'psi': 0.8405811486655637}-{'f1_val': 0.7010727670384516, 'auprc': 0.921289340890105, 'loss_val': 0.4487595938248791, 'psi': 0.7891593965791129}
[S16] START round=12 head_norm_before_train=1.575039 cos_to_last_merge=0.9989 (last merge round=10)
[S16] round=12 local utility u=0.754697 metrics={'f1_val': 0.6828992122235726, 'auprc': 0.705858797568351, 'loss_val': 0.6477864930042962, 'psi': 0.692083046361484}-{'f1_val': 0.42258858640006, 'auprc': 0.7447253227061573, 'loss_val': 0.7119157251379253, 'psi': 0.551443280922499}
[S17] START round=12 head_norm_before_train=1.663729 (no previous merge yet)
[S17] round=12 local utility u=0.124497 metrics={'f1_val': 0.6367166519382553, 'auprc': 0.7485188179884046, 'loss_val': 1.005097734468081, 'psi': 0.681437518358315}-{'f1_val': 0.5366073611406077, 'auprc': 0.8635762390492909, 'loss_val': 0.9986087539498533, 'psi': 0.667394912304081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:40417
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:40404
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:40413
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:40414
[S10] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.445296)
[S17] loaded HEAD from S8 (vec_in norm=1.445296)
[S17] cosine check vs S8: cos=-0.1044
[S17] DROPPED delta from S8 (cos=-0.1044 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.341089)
[S14] loaded HEAD from S11 (vec_in norm=1.341089)
[S14] cosine check vs S11: cos=0.5787
[S14] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1793) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.047272)
[S13] loaded HEAD from S9 (vec_in norm=1.047272)
[S13] cosine check vs S9: cos=-0.0164
[S13] DROPPED delta from S9 (cos=-0.0164 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1805) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.416601)
[S10] loaded HEAD from S7 (vec_in norm=1.416601)
[S10] cosine check vs S7: cos=-0.0918
[S10] DROPPED delta from S7 (cos=-0.0918 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.602049)
[S8] loaded HEAD from S16 (vec_in norm=1.602049)
[S8] cosine check vs S16: cos=0.8693
[S8] BUFFERED delta from S16 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.807709)
[S16] loaded HEAD from S15 (vec_in norm=1.807709)
[S16] cosine check vs S15: cos=-0.0681
[S16] DROPPED delta from S15 (cos=-0.0681 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.521933)
[S4] loaded HEAD from S3 (vec_in norm=1.521933)
[S4] cosine check vs S3: cos=0.9425
[S4] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1792) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.977599)
[S4] loaded HEAD from S14 (vec_in norm=0.977599)
[S4] cosine check vs S14: cos=0.1947
[S4] BUFFERED delta from S14 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1800) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.336532)
[S9] loaded HEAD from S4 (vec_in norm=1.336532)
[S9] cosine check vs S4: cos=0.1236
[S9] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.785898)
[S14] loaded HEAD from S10 (vec_in norm=1.785898)
[S14] cosine check vs S10: cos=0.7643
[S14] BUFFERED delta from S10 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.712697)
[S9] loaded HEAD from S17 (vec_in norm=1.712697)
[S9] cosine check vs S17: cos=-0.0447
[S9] DROPPED delta from S17 (cos=-0.0447 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.9933 head_norm=1.445296
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.968161e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.9933 head_norm=1.473179 delta_norm=0.396816
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.3963 head_norm=0.977599
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.630992e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.4578 head_norm=1.035960 delta_norm=0.163099
[S14] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.9442 head_norm=1.336532
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.645620e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.9448 head_norm=1.103965 delta_norm=0.364562
[S4] aggregate: ACCEPT kept=['S3', 'S14'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7013 head_norm=1.047272
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.964127e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7012 head_norm=0.898485 delta_norm=0.796413
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.798033 (no previous merge yet)
[S2] round=13 local utility u=0.025839 metrics={'f1_val': 0.7014928908785604, 'auprc': 0.6721709072044834, 'loss_val': 0.28382051269785336, 'psi': 0.6897640974089295}-{'f1_val': 0.7014918162305126, 'auprc': 0.6600368885782112, 'loss_val': 0.29909009806876685, 'psi': 0.6849098451695921}
[S3] START round=13 head_norm_before_train=1.521933 (no previous merge yet)
[S3] round=13 local utility u=0.107721 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.8807062998960691, 'loss_val': 0.32423817986877335, 'psi': 0.7727815609737141}-{'f1_val': 0.7000850230591003, 'auprc': 0.8264316800681015, 'loss_val': 0.37237648953679003, 'psi': 0.7506236858627007}
[S4] START round=13 head_norm_before_train=1.103965 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.041211 metrics={'f1_val': 0.9460967425313906, 'auprc': 0.9481033885698656, 'loss_val': 0.5351807984470344, 'psi': 0.9468994009467806}-{'f1_val': 0.9442106686431982, 'auprc': 0.9510217132503848, 'loss_val': 0.6150411611946078, 'psi': 0.9469350864860728}
[S5] START round=13 head_norm_before_train=1.207257 cos_to_last_merge=0.8814 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.881
[S5] round=13 local utility u=0.700092 metrics={'f1_val': 0.7010650608352189, 'auprc': 0.836818881978693, 'loss_val': 0.5524637499800521, 'psi': 0.7553665892926086}-{'f1_val': 0.5064801832573633, 'auprc': 0.78546432899778, 'loss_val': 0.6310743206422608, 'psi': 0.6180738415535301}
[S6] START round=13 head_norm_before_train=1.457622 cos_to_last_merge=0.8783 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.878
[S6] round=13 local utility u=1.000000 metrics={'f1_val': 0.914359484623533, 'auprc': 0.965679634565644, 'loss_val': 0.2732515257945557, 'psi': 0.9348875446003774}-{'f1_val': 0.633715479414251, 'auprc': 0.8118608143115175, 'loss_val': 0.5323640729530746, 'psi': 0.7049736133731576}
[S7] START round=13 head_norm_before_train=1.416601 (no previous merge yet)
[S7] round=13 local utility u=0.204571 metrics={'f1_val': 0.6938906206367756, 'auprc': 0.7773421278495798, 'loss_val': 0.5594463293135497, 'psi': 0.7272712235218973}-{'f1_val': 0.6606253063642221, 'auprc': 0.7758831429588546, 'loss_val': 0.7646198164028105, 'psi': 0.7067284410020751}
[S8] START round=13 head_norm_before_train=1.473179 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.9932810269810869, 'auprc': 0.9941698173083895, 'loss_val': 0.16187099704569952, 'psi': 0.993636543112008}-{'f1_val': 0.9933016371923923, 'auprc': 0.9978575480301597, 'loss_val': 0.13926317731210622, 'psi': 0.9951240015274994}
[S9] START round=13 head_norm_before_train=0.898485 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9981859057069684, 'loss_val': 0.39282548233688397, 'psi': 0.8200486524073254}-{'f1_val': 0.7012904835408967, 'auprc': 0.9981812875414442, 'loss_val': 0.35735458790346725, 'psi': 0.8200468051411157}
[S10] START round=13 head_norm_before_train=1.785898 (no previous merge yet)
[S10] round=13 local utility u=0.004942 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9927518065918374, 'loss_val': 0.060008121625952246, 'psi': 0.9942134260483597}-{'f1_val': 0.9951878390193748, 'auprc': 0.9941639566518441, 'loss_val': 0.07412799237891732, 'psi': 0.9947782860723624}
[S11] START round=13 head_norm_before_train=1.341089 cos_to_last_merge=0.9972 (last merge round=11)
[S11] round=13 local utility u=0.052841 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9939845433196453, 'loss_val': 0.3472423962297654, 'psi': 0.8186099050800131}-{'f1_val': 0.7020007759458987, 'auprc': 0.9957903759725009, 'loss_val': 0.46018492459173865, 'psi': 0.8195166159565396}
[S13] START round=13 head_norm_before_train=1.715916 (no previous merge yet)
[S13] round=13 local utility u=0.177866 metrics={'f1_val': 0.6129080331043901, 'auprc': 0.6846017618607111, 'loss_val': 0.6995948538922765, 'psi': 0.6415855246069185}-{'f1_val': 0.5799314004874714, 'auprc': 0.6880722915108335, 'loss_val': 0.8678787840850883, 'psi': 0.6231877568968163}
[S14] START round=13 head_norm_before_train=1.035960 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.028873 metrics={'f1_val': 0.3992788933656715, 'auprc': 0.9941575401871501, 'loss_val': 0.7263947238901777, 'psi': 0.6372303520942629}-{'f1_val': 0.39629970208074317, 'auprc': 0.9938204720959383, 'loss_val': 0.765254781097747, 'psi': 0.6353080100868211}
[S15] START round=13 head_norm_before_train=1.807709 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6994062378771214, 'auprc': 0.9841146095940576, 'loss_val': 0.39592445642597485, 'psi': 0.8132895865638959}-{'f1_val': 0.7418352600504143, 'auprc': 0.9886999815882875, 'loss_val': 0.38196057355538027, 'psi': 0.8405811486655637}
[S16] START round=13 head_norm_before_train=1.602049 cos_to_last_merge=0.9961 (last merge round=10)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.6800279107206566, 'auprc': 0.695477888510854, 'loss_val': 0.6286993834996852, 'psi': 0.6862079018367355}-{'f1_val': 0.6828992122235726, 'auprc': 0.705858797568351, 'loss_val': 0.6477864930042962, 'psi': 0.692083046361484}
[S17] START round=13 head_norm_before_train=1.712697 (no previous merge yet)
[S17] round=13 local utility u=0.292913 metrics={'f1_val': 0.6378595558113586, 'auprc': 0.8743407288879608, 'loss_val': 0.8035953188626178, 'psi': 0.7324520250419995}-{'f1_val': 0.6367166519382553, 'auprc': 0.7485188179884046, 'loss_val': 1.005097734468081, 'psi': 0.681437518358315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:40412
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:40411
[S7] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.813383)
[S8] loaded HEAD from S2 (vec_in norm=1.813383)
[S8] cosine check vs S2: cos=-0.0462
[S8] DROPPED delta from S2 (cos=-0.0462 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.547705)
[S4] loaded HEAD from S3 (vec_in norm=1.547705)
[S4] cosine check vs S3: cos=0.9009
[S4] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.058734)
[S4] loaded HEAD from S14 (vec_in norm=1.058734)
[S4] cosine check vs S14: cos=0.3760
[S4] BUFFERED delta from S14 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.823899)
[S14] loaded HEAD from S10 (vec_in norm=1.823899)
[S14] cosine check vs S10: cos=0.7758
[S14] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.238785)
[S9] loaded HEAD from S5 (vec_in norm=1.238785)
[S9] cosine check vs S5: cos=0.5524
[S9] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.157136)
[S9] loaded HEAD from S4 (vec_in norm=1.157136)
[S9] cosine check vs S4: cos=0.7738
[S9] BUFFERED delta from S4 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1804) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.735340)
[S16] loaded HEAD from S13 (vec_in norm=1.735340)
[S16] cosine check vs S13: cos=0.9699
[S16] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.381928)
[S14] loaded HEAD from S11 (vec_in norm=1.381928)
[S14] cosine check vs S11: cos=0.6039
[S14] BUFFERED delta from S11 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1803) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.442771)
[S10] loaded HEAD from S7 (vec_in norm=1.442771)
[S10] cosine check vs S7: cos=-0.0968
[S10] DROPPED delta from S7 (cos=-0.0968 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.483072)
[S11] loaded HEAD from S6 (vec_in norm=1.483072)
[S11] cosine check vs S6: cos=0.9604
[S11] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.757934)
[S9] loaded HEAD from S17 (vec_in norm=1.757934)
[S9] cosine check vs S17: cos=-0.0062
[S9] DROPPED delta from S17 (cos=-0.0062 < 0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7013 head_norm=0.949979
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.596063e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7013 head_norm=0.880801 delta_norm=0.159606
[S9] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7017 head_norm=1.381928
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.077976e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7017 head_norm=1.418250 delta_norm=0.207798
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.3993 head_norm=1.058734
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.252655e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.4012 head_norm=1.098392 delta_norm=0.125266
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.9461 head_norm=1.157136
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.472533e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.9458 head_norm=1.047961 delta_norm=0.247253
[S4] aggregate: ACCEPT kept=['S3', 'S14'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.6800 head_norm=1.626568
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.131066e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.6110 head_norm=1.668278 delta_norm=0.213107
[S16] aggregate: ROLLBACK (f1_val pre=0.680 post=0.611 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.813383 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.6996795263057813, 'auprc': 0.6626912024757758, 'loss_val': 0.3346807000069211, 'psi': 0.6848841967737791}-{'f1_val': 0.7014928908785604, 'auprc': 0.6721709072044834, 'loss_val': 0.28382051269785336, 'psi': 0.6897640974089295}
[S3] START round=14 head_norm_before_train=1.547705 (no previous merge yet)
[S3] round=14 local utility u=0.111370 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9589402535288617, 'loss_val': 0.33319527543350197, 'psi': 0.8037746528234619}-{'f1_val': 0.7008317350254774, 'auprc': 0.8807062998960691, 'loss_val': 0.32423817986877335, 'psi': 0.7727815609737141}
[S4] START round=14 head_norm_before_train=1.047961 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.003326 metrics={'f1_val': 0.9436343743017878, 'auprc': 0.9529902732441767, 'loss_val': 0.5284150411749456, 'psi': 0.9473767338787433}-{'f1_val': 0.9460967425313906, 'auprc': 0.9481033885698656, 'loss_val': 0.5351807984470344, 'psi': 0.9468994009467806}
[S5] START round=14 head_norm_before_train=1.238785 cos_to_last_merge=0.8711 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.871
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.809117090980773, 'loss_val': 0.4775821262521133, 'psi': 0.7441369516988234}-{'f1_val': 0.7010650608352189, 'auprc': 0.836818881978693, 'loss_val': 0.5524637499800521, 'psi': 0.7553665892926086}
[S6] START round=14 head_norm_before_train=1.483072 cos_to_last_merge=0.8754 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.875
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.8428263078076326, 'auprc': 0.9574646218064771, 'loss_val': 0.36006637308337464, 'psi': 0.8886816334071703}-{'f1_val': 0.914359484623533, 'auprc': 0.965679634565644, 'loss_val': 0.2732515257945557, 'psi': 0.9348875446003774}
[S7] START round=14 head_norm_before_train=1.442771 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.48322606942671026, 'auprc': 0.7772521048845076, 'loss_val': 0.7941787498499951, 'psi': 0.6008364836098292}-{'f1_val': 0.6938906206367756, 'auprc': 0.7773421278495798, 'loss_val': 0.5594463293135497, 'psi': 0.7272712235218973}
[S8] START round=14 head_norm_before_train=1.543132 cos_to_last_merge=0.9972 (last merge round=12)
[S8] round=14 local utility u=0.034677 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.9977351808480656, 'loss_val': 0.1033369288778698, 'psi': 0.9950750546546616}-{'f1_val': 0.9932810269810869, 'auprc': 0.9941698173083895, 'loss_val': 0.16187099704569952, 'psi': 0.993636543112008}
[S9] START round=14 head_norm_before_train=0.880801 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.008124 metrics={'f1_val': 0.7010401564543445, 'auprc': 0.997535572574568, 'loss_val': 0.3731251086122134, 'psi': 0.819638322902434}-{'f1_val': 0.7012904835408967, 'auprc': 0.9981859057069684, 'loss_val': 0.39282548233688397, 'psi': 0.8200486524073254}
[S10] START round=14 head_norm_before_train=1.823899 (no previous merge yet)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9918025138024946, 'loss_val': 0.05348198094885293, 'psi': 0.9933348445480507}-{'f1_val': 0.9951878390193748, 'auprc': 0.9927518065918374, 'loss_val': 0.060008121625952246, 'psi': 0.9942134260483597}
[S11] START round=14 head_norm_before_train=1.418250 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.6200328272646971, 'auprc': 0.9856463890633298, 'loss_val': 0.5626320416707016, 'psi': 0.7662782519841502}-{'f1_val': 0.7016934795869249, 'auprc': 0.9939845433196453, 'loss_val': 0.3472423962297654, 'psi': 0.8186099050800131}
[S13] START round=14 head_norm_before_train=1.735340 (no previous merge yet)
[S13] round=14 local utility u=0.010590 metrics={'f1_val': 0.6194066891044956, 'auprc': 0.6791210083202437, 'loss_val': 0.7009639523570073, 'psi': 0.6432924167907947}-{'f1_val': 0.6129080331043901, 'auprc': 0.6846017618607111, 'loss_val': 0.6995948538922765, 'psi': 0.6415855246069185}
[S14] START round=14 head_norm_before_train=1.098392 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.038882 metrics={'f1_val': 0.41034757189752014, 'auprc': 0.9938599336341222, 'loss_val': 0.7141497654360071, 'psi': 0.6437525165921609}-{'f1_val': 0.3992788933656715, 'auprc': 0.9941575401871501, 'loss_val': 0.7263947238901777, 'psi': 0.6372303520942629}
[S15] START round=14 head_norm_before_train=1.841476 (no previous merge yet)
[S15] round=14 local utility u=1.000000 metrics={'f1_val': 0.9950417128855746, 'auprc': 0.9854334680003116, 'loss_val': 0.06052351187375231, 'psi': 0.9911984149314694}-{'f1_val': 0.6994062378771214, 'auprc': 0.9841146095940576, 'loss_val': 0.39592445642597485, 'psi': 0.8132895865638959}
[S16] START round=14 head_norm_before_train=1.668278 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.6206638178641676, 'auprc': 0.7206116705485308, 'loss_val': 0.649411017850268, 'psi': 0.6606429589379129}-{'f1_val': 0.6800279107206566, 'auprc': 0.695477888510854, 'loss_val': 0.6286993834996852, 'psi': 0.6862079018367355}
[S17] START round=14 head_norm_before_train=1.757934 (no previous merge yet)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.5921179778153419, 'auprc': 0.7730166434631515, 'loss_val': 0.8647205827946722, 'psi': 0.6644774440744657}-{'f1_val': 0.6378595558113586, 'auprc': 0.8743407288879608, 'loss_val': 0.8035953188626178, 'psi': 0.7324520250419995}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:40404
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:40416
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1792) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.939248)
[S13] loaded HEAD from S9 (vec_in norm=0.939248)
[S13] cosine check vs S9: cos=0.0087
[S13] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.866710)
[S16] loaded HEAD from S15 (vec_in norm=1.866710)
[S16] cosine check vs S15: cos=-0.0715
[S16] DROPPED delta from S15 (cos=-0.0715 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.105066)
[S9] loaded HEAD from S4 (vec_in norm=1.105066)
[S9] cosine check vs S4: cos=0.6928
[S9] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.754714)
[S16] loaded HEAD from S13 (vec_in norm=1.754714)
[S16] cosine check vs S13: cos=0.9893
[S16] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.570888)
[S4] loaded HEAD from S3 (vec_in norm=1.570888)
[S4] cosine check vs S3: cos=0.8625
[S4] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1796) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.118467)
[S4] loaded HEAD from S14 (vec_in norm=1.118467)
[S4] cosine check vs S14: cos=0.4993
[S4] BUFFERED delta from S14 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.616653)
[S17] loaded HEAD from S8 (vec_in norm=1.616653)
[S17] cosine check vs S8: cos=-0.1219
[S17] DROPPED delta from S8 (cos=-0.1219 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9436 head_norm=1.105066
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.897807e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9438 head_norm=1.045562 delta_norm=0.189781
[S4] aggregate: ACCEPT kept=['S3', 'S14'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7010 head_norm=0.939248
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.078198e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7010 head_norm=0.940937 delta_norm=0.407820
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.6194 head_norm=1.754714
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.915329e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.6182 head_norm=0.998732 delta_norm=0.991533
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.6207 head_norm=1.688235
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.300139e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.6700 head_norm=1.716880 delta_norm=0.130014
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.831495 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6654013983627293, 'loss_val': 0.35821439487817075, 'psi': 0.6871031947682407}-{'f1_val': 0.6996795263057813, 'auprc': 0.6626912024757758, 'loss_val': 0.3346807000069211, 'psi': 0.6848841967737791}
[S3] START round=15 head_norm_before_train=1.570888 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.6680247698705452, 'auprc': 0.9848333890137344, 'loss_val': 0.38082263156843205, 'psi': 0.7947482175278209}-{'f1_val': 0.700330919019862, 'auprc': 0.9589402535288617, 'loss_val': 0.33319527543350197, 'psi': 0.8037746528234619}
[S4] START round=15 head_norm_before_train=1.045562 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.047127 metrics={'f1_val': 0.946990871522314, 'auprc': 0.954723478345194, 'loss_val': 0.45949959979704885, 'psi': 0.950083914251466}-{'f1_val': 0.9436343743017878, 'auprc': 0.9529902732441767, 'loss_val': 0.5284150411749456, 'psi': 0.9473767338787433}
[S5] START round=15 head_norm_before_train=1.271365 cos_to_last_merge=0.8610 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.861
[S5] round=15 local utility u=0.091829 metrics={'f1_val': 0.7008162875368863, 'auprc': 0.8505694147624135, 'loss_val': 0.41827781152077687, 'psi': 0.7607175384270972}-{'f1_val': 0.7008168588441903, 'auprc': 0.809117090980773, 'loss_val': 0.4775821262521133, 'psi': 0.7441369516988234}
[S6] START round=15 head_norm_before_train=1.498793 cos_to_last_merge=0.8738 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.874
[S6] round=15 local utility u=0.458130 metrics={'f1_val': 0.9550237743146972, 'auprc': 0.9857417957344405, 'loss_val': 0.2018221760425128, 'psi': 0.9673109828825945}-{'f1_val': 0.8428263078076326, 'auprc': 0.9574646218064771, 'loss_val': 0.36006637308337464, 'psi': 0.8886816334071703}
[S7] START round=15 head_norm_before_train=1.461899 (no previous merge yet)
[S7] round=15 local utility u=0.149248 metrics={'f1_val': 0.53125926933004, 'auprc': 0.7750376160592866, 'loss_val': 0.7772392177130009, 'psi': 0.6287706080217386}-{'f1_val': 0.48322606942671026, 'auprc': 0.7772521048845076, 'loss_val': 0.7941787498499951, 'psi': 0.6008364836098292}
[S8] START round=15 head_norm_before_train=1.616653 cos_to_last_merge=0.9909 (last merge round=12)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.9925279616884268, 'auprc': 0.9849788275469906, 'loss_val': 0.10135426835342598, 'psi': 0.9895083080318523}-{'f1_val': 0.9933016371923923, 'auprc': 0.9977351808480656, 'loss_val': 0.1033369288778698, 'psi': 0.9950750546546616}
[S9] START round=15 head_norm_before_train=0.940937 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9955441003760581, 'loss_val': 0.3883466303014204, 'psi': 0.8189475886144344}-{'f1_val': 0.7010401564543445, 'auprc': 0.997535572574568, 'loss_val': 0.3731251086122134, 'psi': 0.819638322902434}
[S10] START round=15 head_norm_before_train=1.857264 (no previous merge yet)
[S10] round=15 local utility u=0.003910 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9936832051784201, 'loss_val': 0.04707722564643584, 'psi': 0.9936643862895678}-{'f1_val': 0.9943563983784213, 'auprc': 0.9918025138024946, 'loss_val': 0.05348198094885293, 'psi': 0.9933348445480507}
[S11] START round=15 head_norm_before_train=1.447236 cos_to_last_merge=0.9987 (last merge round=13)
[S11] round=15 local utility u=0.394875 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9940412085522532, 'loss_val': 0.2880299293013921, 'psi': 0.8186325711730562}-{'f1_val': 0.6200328272646971, 'auprc': 0.9856463890633298, 'loss_val': 0.5626320416707016, 'psi': 0.7662782519841502}
[S13] START round=15 head_norm_before_train=0.998732 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6057116997159753, 'auprc': 0.6875626309308287, 'loss_val': 0.7046282066447931, 'psi': 0.6384520722019167}-{'f1_val': 0.6194066891044956, 'auprc': 0.6791210083202437, 'loss_val': 0.7009639523570073, 'psi': 0.6432924167907947}
[S14] START round=15 head_norm_before_train=1.118467 cos_to_last_merge=0.9970 (last merge round=13)
[S14] round=15 local utility u=0.011999 metrics={'f1_val': 0.3978974105838153, 'auprc': 0.9943904420089826, 'loss_val': 0.6170428353851052, 'psi': 0.6364946231538823}-{'f1_val': 0.41034757189752014, 'auprc': 0.9938599336341222, 'loss_val': 0.7141497654360071, 'psi': 0.6437525165921609}
[S15] START round=15 head_norm_before_train=1.866710 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.9696848784012545, 'auprc': 0.9913495042487322, 'loss_val': 0.14382932648899152, 'psi': 0.9783507287402455}-{'f1_val': 0.9950417128855746, 'auprc': 0.9854334680003116, 'loss_val': 0.06052351187375231, 'psi': 0.9911984149314694}
[S16] START round=15 head_norm_before_train=1.716880 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.210192 metrics={'f1_val': 0.6625609267049573, 'auprc': 0.7652536098606082, 'loss_val': 0.614335884033183, 'psi': 0.7036379999672177}-{'f1_val': 0.6206638178641676, 'auprc': 0.7206116705485308, 'loss_val': 0.649411017850268, 'psi': 0.6606429589379129}
[S17] START round=15 head_norm_before_train=1.801726 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.5716636267769192, 'auprc': 0.8146616592731499, 'loss_val': 1.0247471018551968, 'psi': 0.6688628397754115}-{'f1_val': 0.5921179778153419, 'auprc': 0.7730166434631515, 'loss_val': 0.8647205827946722, 'psi': 0.6644774440744657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:40409
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S7] → sending delta(kind=head bytes=1809) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:40404
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:40414
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1809 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.303196)
[S9] loaded HEAD from S5 (vec_in norm=1.303196)
[S9] cosine check vs S5: cos=0.3430
[S9] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.741182)
[S8] loaded HEAD from S16 (vec_in norm=1.741182)
[S8] cosine check vs S16: cos=0.9108
[S8] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.518417)
[S11] loaded HEAD from S6 (vec_in norm=1.518417)
[S11] cosine check vs S6: cos=0.9744
[S11] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.893754)
[S14] loaded HEAD from S10 (vec_in norm=1.893754)
[S14] cosine check vs S10: cos=0.7686
[S14] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1790) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.145819)
[S4] loaded HEAD from S14 (vec_in norm=1.145819)
[S4] cosine check vs S14: cos=0.5685
[S4] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.471822)
[S14] loaded HEAD from S11 (vec_in norm=1.471822)
[S14] cosine check vs S11: cos=0.6013
[S14] BUFFERED delta from S11 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1809) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.481360)
[S10] loaded HEAD from S7 (vec_in norm=1.481360)
[S10] cosine check vs S7: cos=-0.1028
[S10] DROPPED delta from S7 (cos=-0.1028 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.112818)
[S9] loaded HEAD from S4 (vec_in norm=1.112818)
[S9] cosine check vs S4: cos=0.8955
[S9] BUFFERED delta from S4 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.221 → S4@127.0.0.1:40404
[S2] ⇄ pheromone p=0.078 → S8@127.0.0.1:40409
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9925 head_norm=1.672108
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.620883e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9925 head_norm=1.668150 delta_norm=0.362088
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.204 → S17@127.0.0.1:40417
[S13] ⇄ pheromone p=0.134 → S16@127.0.0.1:40416
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7012 head_norm=0.991651
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.610248e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7012 head_norm=0.885390 delta_norm=0.261025
[S9] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.130 → S13@127.0.0.1:40413
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.3979 head_norm=1.145819
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.457531e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.3999 head_norm=1.167146 delta_norm=0.145753
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.116 → S4@127.0.0.1:40404
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7017 head_norm=1.471822
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.707495e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7017 head_norm=1.485520 delta_norm=0.170750
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.246 → S14@127.0.0.1:40414
[S16] ⇄ pheromone p=0.195 → S8@127.0.0.1:40409
[S5] ⇄ pheromone p=0.238 → S9@127.0.0.1:40410
[S7] ⇄ pheromone p=0.219 → S10@127.0.0.1:40411
[S6] ⇄ pheromone p=0.404 → S11@127.0.0.1:40412
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9470 head_norm=1.112818
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.247561e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9513 head_norm=1.000132 delta_norm=0.524756
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.173 → S9@127.0.0.1:40410
[S10] ⇄ pheromone p=0.151 → S14@127.0.0.1:40414
[S15] ⇄ pheromone p=0.267 → S16@127.0.0.1:40416
[S17] ⇄ pheromone p=0.171 → S9@127.0.0.1:40410
[S2] START round=16 head_norm_before_train=1.848995 (no previous merge yet)
[S2] round=16 local utility u=0.019903 metrics={'f1_val': 0.7066665106893392, 'auprc': 0.6680274389266643, 'loss_val': 0.356858874192817, 'psi': 0.6912108819842692}-{'f1_val': 0.7015710590385817, 'auprc': 0.6654013983627293, 'loss_val': 0.35821439487817075, 'psi': 0.6871031947682407}
[S3] START round=16 head_norm_before_train=1.595775 (no previous merge yet)
[S3] round=16 local utility u=0.048468 metrics={'f1_val': 0.6774207718027943, 'auprc': 0.9913420695268879, 'loss_val': 0.35978909319165886, 'psi': 0.8029892908924317}-{'f1_val': 0.6680247698705452, 'auprc': 0.9848333890137344, 'loss_val': 0.38082263156843205, 'psi': 0.7947482175278209}
[S4] START round=16 head_norm_before_train=1.000132 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.013361 metrics={'f1_val': 0.9427661345416951, 'auprc': 0.9615267862651611, 'loss_val': 0.427838228082542, 'psi': 0.9502703952310815}-{'f1_val': 0.946990871522314, 'auprc': 0.954723478345194, 'loss_val': 0.45949959979704885, 'psi': 0.950083914251466}
[S5] START round=16 head_norm_before_train=1.303196 cos_to_last_merge=0.8508 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.851
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7005676228872385, 'auprc': 0.8230991741503821, 'loss_val': 0.3981039967439569, 'psi': 0.749580243392496}-{'f1_val': 0.7008162875368863, 'auprc': 0.8505694147624135, 'loss_val': 0.41827781152077687, 'psi': 0.7607175384270972}
[S6] START round=16 head_norm_before_train=1.518417 cos_to_last_merge=0.8724 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.872
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.8401332124901711, 'auprc': 0.9571480668514014, 'loss_val': 0.39017481813911364, 'psi': 0.8869391542346633}-{'f1_val': 0.9550237743146972, 'auprc': 0.9857417957344405, 'loss_val': 0.2018221760425128, 'psi': 0.9673109828825945}
[S7] START round=16 head_norm_before_train=1.481360 (no previous merge yet)
[S7] round=16 local utility u=0.424601 metrics={'f1_val': 0.6341172144798268, 'auprc': 0.7964652430904192, 'loss_val': 0.6094683421946488, 'psi': 0.6990564259240638}-{'f1_val': 0.53125926933004, 'auprc': 0.7750376160592866, 'loss_val': 0.7772392177130009, 'psi': 0.6287706080217386}
[S8] START round=16 head_norm_before_train=1.668150 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.8452117549384941, 'auprc': 0.9842278199928728, 'loss_val': 0.17895716083528979, 'psi': 0.9008181809602456}-{'f1_val': 0.9925279616884268, 'auprc': 0.9849788275469906, 'loss_val': 0.10135426835342598, 'psi': 0.9895083080318523}
[S9] START round=16 head_norm_before_train=0.885390 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.036722 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9959575158553068, 'loss_val': 0.31614299082906755, 'psi': 0.8191129548061339}-{'f1_val': 0.7012165807733519, 'auprc': 0.9955441003760581, 'loss_val': 0.3883466303014204, 'psi': 0.8189475886144344}
[S10] START round=16 head_norm_before_train=1.893754 (no previous merge yet)
[S10] round=16 local utility u=0.002839 metrics={'f1_val': 0.9945528553774142, 'auprc': 0.9921729536059457, 'loss_val': 0.04227513970683675, 'psi': 0.9936008946688268}-{'f1_val': 0.9936518403636662, 'auprc': 0.9936832051784201, 'loss_val': 0.04707722564643584, 'psi': 0.9936643862895678}
[S11] START round=16 head_norm_before_train=1.485520 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.354975 metrics={'f1_val': 0.8541188533206793, 'auprc': 0.9914790505409632, 'loss_val': 0.48494612222683686, 'psi': 0.9090629322087929}-{'f1_val': 0.7016934795869249, 'auprc': 0.9940412085522532, 'loss_val': 0.2880299293013921, 'psi': 0.8186325711730562}
[S13] START round=16 head_norm_before_train=1.064198 cos_to_last_merge=0.9979 (last merge round=14)
[S13] round=16 local utility u=0.081490 metrics={'f1_val': 0.6277133210673088, 'auprc': 0.6788944848947905, 'loss_val': 0.6476533017546168, 'psi': 0.6481857865983015}-{'f1_val': 0.6057116997159753, 'auprc': 0.6875626309308287, 'loss_val': 0.7046282066447931, 'psi': 0.6384520722019167}
[S14] START round=16 head_norm_before_train=1.167146 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.773708 metrics={'f1_val': 0.6547108716319352, 'auprc': 0.9942103738850372, 'loss_val': 0.6099665075782286, 'psi': 0.790510672533176}-{'f1_val': 0.3978974105838153, 'auprc': 0.9943904420089826, 'loss_val': 0.6170428353851052, 'psi': 0.6364946231538823}
[S15] START round=16 head_norm_before_train=1.883724 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.8271650980962051, 'auprc': 0.9904853556684987, 'loss_val': 0.2172803248381444, 'psi': 0.8924932011251225}-{'f1_val': 0.9696848784012545, 'auprc': 0.9913495042487322, 'loss_val': 0.14382932648899152, 'psi': 0.9783507287402455}
[S16] START round=16 head_norm_before_train=1.741182 cos_to_last_merge=0.9990 (last merge round=14)
[S16] round=16 local utility u=0.165672 metrics={'f1_val': 0.6917280290844787, 'auprc': 0.7953680066321739, 'loss_val': 0.5483374241583496, 'psi': 0.7331840201035568}-{'f1_val': 0.6625609267049573, 'auprc': 0.7652536098606082, 'loss_val': 0.614335884033183, 'psi': 0.7036379999672177}
[S17] START round=16 head_norm_before_train=1.844808 (no previous merge yet)
[S17] round=16 local utility u=0.026537 metrics={'f1_val': 0.5730156059528277, 'auprc': 0.8135977252275562, 'loss_val': 0.9765922569452253, 'psi': 0.6692484536627191}-{'f1_val': 0.5716636267769192, 'auprc': 0.8146616592731499, 'loss_val': 1.0247471018551968, 'psi': 0.6688628397754115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:40414
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:40413
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:40414
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.192489)
[S4] loaded HEAD from S14 (vec_in norm=1.192489)
[S4] cosine check vs S14: cos=0.8523
[S4] BUFFERED delta from S14 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.771666)
[S8] loaded HEAD from S16 (vec_in norm=1.771666)
[S8] cosine check vs S16: cos=0.9703
[S8] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.082774)
[S9] loaded HEAD from S4 (vec_in norm=1.082774)
[S9] cosine check vs S4: cos=0.6670
[S9] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1803) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.871021)
[S8] loaded HEAD from S2 (vec_in norm=1.871021)
[S8] cosine check vs S2: cos=-0.0268
[S8] DROPPED delta from S2 (cos=-0.0268 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.509718)
[S14] loaded HEAD from S11 (vec_in norm=1.509718)
[S14] cosine check vs S11: cos=0.6030
[S14] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.164720)
[S16] loaded HEAD from S13 (vec_in norm=1.164720)
[S16] cosine check vs S13: cos=0.8932
[S16] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.929979)
[S14] loaded HEAD from S10 (vec_in norm=1.929979)
[S14] cosine check vs S10: cos=0.7774
[S14] BUFFERED delta from S10 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1803) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.499236)
[S10] loaded HEAD from S7 (vec_in norm=1.499236)
[S10] cosine check vs S7: cos=-0.1044
[S10] DROPPED delta from S7 (cos=-0.1044 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.947232)
[S13] loaded HEAD from S9 (vec_in norm=0.947232)
[S13] cosine check vs S9: cos=0.4061
[S13] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.621886)
[S4] loaded HEAD from S3 (vec_in norm=1.621886)
[S4] cosine check vs S3: cos=0.5292
[S4] BUFFERED delta from S3 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.874820)
[S9] loaded HEAD from S17 (vec_in norm=1.874820)
[S9] cosine check vs S17: cos=-0.0477
[S9] DROPPED delta from S17 (cos=-0.0477 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.8452 head_norm=1.711452
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.142254e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.8689 head_norm=1.728595 delta_norm=0.214225
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6277 head_norm=1.164720
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.825990e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6275 head_norm=0.887406 delta_norm=0.582599
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.6547 head_norm=1.192489
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.162081e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.6369 head_norm=1.204536 delta_norm=0.116208
[S14] aggregate: ROLLBACK (f1_val pre=0.655 post=0.637 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7012 head_norm=0.947232
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.187680e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.7012 head_norm=0.927069 delta_norm=0.418768
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.6917 head_norm=1.771666
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.497762e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.7008 head_norm=1.430171 delta_norm=0.449776
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9428 head_norm=1.082774
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.620381e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9425 head_norm=1.040953 delta_norm=0.262038
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.871021 (no previous merge yet)
[S2] round=17 local utility u=0.036042 metrics={'f1_val': 0.7050998331760456, 'auprc': 0.725236312061973, 'loss_val': 0.4470021257189121, 'psi': 0.7131544247304166}-{'f1_val': 0.7066665106893392, 'auprc': 0.6680274389266643, 'loss_val': 0.356858874192817, 'psi': 0.6912108819842692}
[S3] START round=17 head_norm_before_train=1.621886 (no previous merge yet)
[S3] round=17 local utility u=0.112287 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9950949034985515, 'loss_val': 0.286939165373972, 'psi': 0.818537002414707}-{'f1_val': 0.6774207718027943, 'auprc': 0.9913420695268879, 'loss_val': 0.35978909319165886, 'psi': 0.8029892908924317}
[S4] START round=17 head_norm_before_train=1.040953 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.017654 metrics={'f1_val': 0.9430197342149427, 'auprc': 0.9623394083026946, 'loss_val': 0.39648937141032453, 'psi': 0.9507476038500435}-{'f1_val': 0.9427661345416951, 'auprc': 0.9615267862651611, 'loss_val': 0.427838228082542, 'psi': 0.9502703952310815}
[S5] START round=17 head_norm_before_train=1.335364 cos_to_last_merge=0.8419 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.842
[S5] round=17 local utility u=0.257870 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.970330986287142, 'loss_val': 0.324068616598515, 'psi': 0.8084738876210151}-{'f1_val': 0.7005676228872385, 'auprc': 0.8230991741503821, 'loss_val': 0.3981039967439569, 'psi': 0.749580243392496}
[S6] START round=17 head_norm_before_train=1.538896 cos_to_last_merge=0.8707 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.871
[S6] round=17 local utility u=0.032947 metrics={'f1_val': 0.8426688105618589, 'auprc': 0.9569268738853248, 'loss_val': 0.33883178212355763, 'psi': 0.8883720358912452}-{'f1_val': 0.8401332124901711, 'auprc': 0.9571480668514014, 'loss_val': 0.39017481813911364, 'psi': 0.8869391542346633}
[S7] START round=17 head_norm_before_train=1.499236 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.4317759025015989, 'auprc': 0.7653663767058725, 'loss_val': 1.0245471806515916, 'psi': 0.5652120921833084}-{'f1_val': 0.6341172144798268, 'auprc': 0.7964652430904192, 'loss_val': 0.6094683421946488, 'psi': 0.6990564259240638}
[S8] START round=17 head_norm_before_train=1.728595 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.491830 metrics={'f1_val': 0.9934464462379313, 'auprc': 0.9968548057353661, 'loss_val': 0.1225860055761786, 'psi': 0.9948097900369053}-{'f1_val': 0.8452117549384941, 'auprc': 0.9842278199928728, 'loss_val': 0.17895716083528979, 'psi': 0.9008181809602456}
[S9] START round=17 head_norm_before_train=0.927069 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.7009662546266813, 'auprc': 0.9956119859316219, 'loss_val': 0.3732898102955887, 'psi': 0.8188245471486575}-{'f1_val': 0.7012165807733519, 'auprc': 0.9959575158553068, 'loss_val': 0.31614299082906755, 'psi': 0.8191129548061339}
[S10] START round=17 head_norm_before_train=1.929979 (no previous merge yet)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.9941370213715576, 'auprc': 0.9917768066670412, 'loss_val': 0.040731795152768605, 'psi': 0.9931929354897511}-{'f1_val': 0.9945528553774142, 'auprc': 0.9921729536059457, 'loss_val': 0.04227513970683675, 'psi': 0.9936008946688268}
[S11] START round=17 head_norm_before_train=1.509718 cos_to_last_merge=0.9993 (last merge round=15)
[S11] round=17 local utility u=0.437606 metrics={'f1_val': 0.9582699758185035, 'auprc': 0.9944405877095502, 'loss_val': 0.243524746952705, 'psi': 0.9727382205749222}-{'f1_val': 0.8541188533206793, 'auprc': 0.9914790505409632, 'loss_val': 0.48494612222683686, 'psi': 0.9090629322087929}
[S13] START round=17 head_norm_before_train=0.887406 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6134836978276846, 'auprc': 0.6859607955299658, 'loss_val': 0.7129111970797388, 'psi': 0.6424745369085971}-{'f1_val': 0.6277133210673088, 'auprc': 0.6788944848947905, 'loss_val': 0.6476533017546168, 'psi': 0.6481857865983015}
[S14] START round=17 head_norm_before_train=1.204536 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.133582 metrics={'f1_val': 0.6957822115945645, 'auprc': 0.9927843833936718, 'loss_val': 0.5849533235020807, 'psi': 0.8145830803142075}-{'f1_val': 0.6547108716319352, 'auprc': 0.9942103738850372, 'loss_val': 0.6099665075782286, 'psi': 0.790510672533176}
[S15] START round=17 head_norm_before_train=1.905165 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.7010713433702593, 'auprc': 0.8618505947109448, 'loss_val': 0.5588901176702827, 'psi': 0.7653830439065336}-{'f1_val': 0.8271650980962051, 'auprc': 0.9904853556684987, 'loss_val': 0.2172803248381444, 'psi': 0.8924932011251225}
[S16] START round=17 head_norm_before_train=1.430171 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.555403 metrics={'f1_val': 0.8483203488939765, 'auprc': 0.8478362440773755, 'loss_val': 0.5344902430122243, 'psi': 0.8481267069673362}-{'f1_val': 0.6917280290844787, 'auprc': 0.7953680066321739, 'loss_val': 0.5483374241583496, 'psi': 0.7331840201035568}
[S17] START round=17 head_norm_before_train=1.874820 (no previous merge yet)
[S17] round=17 local utility u=0.110095 metrics={'f1_val': 0.5986011853665395, 'auprc': 0.8311534464418017, 'loss_val': 0.9625824075806009, 'psi': 0.6916220897966444}-{'f1_val': 0.5730156059528277, 'auprc': 0.8135977252275562, 'loss_val': 0.9765922569452253, 'psi': 0.6692484536627191}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:40417
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:40404
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:40404
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:40409
[S16] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.464294)
[S8] loaded HEAD from S16 (vec_in norm=1.464294)
[S8] cosine check vs S16: cos=0.9758
[S8] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1793) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.645388)
[S4] loaded HEAD from S3 (vec_in norm=1.645388)
[S4] cosine check vs S3: cos=0.6859
[S4] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.229932)
[S4] loaded HEAD from S14 (vec_in norm=1.229932)
[S4] cosine check vs S14: cos=0.7520
[S4] BUFFERED delta from S14 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.562495)
[S11] loaded HEAD from S6 (vec_in norm=1.562495)
[S11] cosine check vs S6: cos=0.9832
[S11] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.892153)
[S8] loaded HEAD from S2 (vec_in norm=1.892153)
[S8] cosine check vs S2: cos=-0.0220
[S8] DROPPED delta from S2 (cos=-0.0220 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.760437)
[S17] loaded HEAD from S8 (vec_in norm=1.760437)
[S17] cosine check vs S8: cos=-0.1327
[S17] DROPPED delta from S8 (cos=-0.1327 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.112712)
[S9] loaded HEAD from S4 (vec_in norm=1.112712)
[S9] cosine check vs S4: cos=0.9215
[S9] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.360211)
[S9] loaded HEAD from S5 (vec_in norm=1.360211)
[S9] cosine check vs S5: cos=0.3155
[S9] BUFFERED delta from S5 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.531092)
[S14] loaded HEAD from S11 (vec_in norm=1.531092)
[S14] cosine check vs S11: cos=0.6185
[S14] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1806 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1806) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.894270)
[S9] loaded HEAD from S17 (vec_in norm=1.894270)
[S9] cosine check vs S17: cos=-0.0566
[S9] DROPPED delta from S17 (cos=-0.0566 < 0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.7010 head_norm=0.977919
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.717639e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.7012 head_norm=0.886050 delta_norm=0.271764
[S9] aggregate: ACCEPT kept=['S4', 'S5'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.9583 head_norm=1.531092
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.427402e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.9578 head_norm=1.540273 delta_norm=0.142740
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9430 head_norm=1.112712
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.802578e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9428 head_norm=1.083965 delta_norm=0.180258
[S4] aggregate: ACCEPT kept=['S3', 'S14'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9934 head_norm=1.760437
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.304362e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9934 head_norm=1.602669 delta_norm=0.230436
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.6958 head_norm=1.229932
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.179748e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.6960 head_norm=1.243621 delta_norm=0.617975
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.892153 (no previous merge yet)
[S2] round=18 local utility u=0.115714 metrics={'f1_val': 0.7097794593435307, 'auprc': 0.7816139377697118, 'loss_val': 0.41278416031375936, 'psi': 0.7385132507140031}-{'f1_val': 0.7050998331760456, 'auprc': 0.725236312061973, 'loss_val': 0.4470021257189121, 'psi': 0.7131544247304166}
[S3] START round=18 head_norm_before_train=1.645388 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.5249627501306886, 'auprc': 0.9839574470182395, 'loss_val': 0.5006623662344767, 'psi': 0.7085606288857089}-{'f1_val': 0.7008317350254774, 'auprc': 0.9950949034985515, 'loss_val': 0.286939165373972, 'psi': 0.818537002414707}
[S4] START round=18 head_norm_before_train=1.083965 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.011647 metrics={'f1_val': 0.94077077683687, 'auprc': 0.9663836256494023, 'loss_val': 0.3718340345630914, 'psi': 0.951015916361883}-{'f1_val': 0.9430197342149427, 'auprc': 0.9623394083026946, 'loss_val': 0.39648937141032453, 'psi': 0.9507476038500435}
[S5] START round=18 head_norm_before_train=1.360211 cos_to_last_merge=0.8353 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.835
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9651864945046962, 'loss_val': 0.31826104474114286, 'psi': 0.806439633399483}-{'f1_val': 0.7005691551769304, 'auprc': 0.970330986287142, 'loss_val': 0.324068616598515, 'psi': 0.8084738876210151}
[S6] START round=18 head_norm_before_train=1.562495 cos_to_last_merge=0.8692 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=18 local utility u=0.000197 metrics={'f1_val': 0.8366219504238372, 'auprc': 0.9646661853323839, 'loss_val': 0.325375125565211, 'psi': 0.8878396443872559}-{'f1_val': 0.8426688105618589, 'auprc': 0.9569268738853248, 'loss_val': 0.33883178212355763, 'psi': 0.8883720358912452}
[S7] START round=18 head_norm_before_train=1.514667 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.41788145269937615, 'auprc': 0.7722555324655167, 'loss_val': 1.0859178231779465, 'psi': 0.5596310846058323}-{'f1_val': 0.4317759025015989, 'auprc': 0.7653663767058725, 'loss_val': 1.0245471806515916, 'psi': 0.5652120921833084}
[S8] START round=18 head_norm_before_train=1.602669 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.997879761775414, 'loss_val': 0.13407718999005147, 'psi': 0.9940208476360017}-{'f1_val': 0.9934464462379313, 'auprc': 0.9968548057353661, 'loss_val': 0.1225860055761786, 'psi': 0.9948097900369053}
[S9] START round=18 head_norm_before_train=0.886050 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.906705 metrics={'f1_val': 0.9856836147752347, 'auprc': 0.9976032649604121, 'loss_val': 0.27415842361254367, 'psi': 0.9904514748493056}-{'f1_val': 0.7009662546266813, 'auprc': 0.9956119859316219, 'loss_val': 0.3732898102955887, 'psi': 0.8188245471486575}
[S10] START round=18 head_norm_before_train=1.955491 (no previous merge yet)
[S10] round=18 local utility u=0.006660 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9926980632934423, 'loss_val': 0.03850931882412158, 'psi': 0.994394770271844}-{'f1_val': 0.9941370213715576, 'auprc': 0.9917768066670412, 'loss_val': 0.040731795152768605, 'psi': 0.9931929354897511}
[S11] START round=18 head_norm_before_train=1.540273 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.111306 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9958607708796952, 'loss_val': 0.2573190040445263, 'psi': 0.9965208061986548}-{'f1_val': 0.9582699758185035, 'auprc': 0.9944405877095502, 'loss_val': 0.243524746952705, 'psi': 0.9727382205749222}
[S13] START round=18 head_norm_before_train=0.992611 cos_to_last_merge=0.9875 (last merge round=16)
[S13] round=18 local utility u=0.020126 metrics={'f1_val': 0.6151027662022255, 'auprc': 0.685239334630855, 'loss_val': 0.6802097220335275, 'psi': 0.6431573935736772}-{'f1_val': 0.6134836978276846, 'auprc': 0.6859607955299658, 'loss_val': 0.7129111970797388, 'psi': 0.6424745369085971}
[S14] START round=18 head_norm_before_train=1.243621 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.041294 metrics={'f1_val': 0.7003643806352908, 'auprc': 0.9933307294493382, 'loss_val': 0.5314979365720094, 'psi': 0.8175509201609097}-{'f1_val': 0.6957822115945645, 'auprc': 0.9927843833936718, 'loss_val': 0.5849533235020807, 'psi': 0.8145830803142075}
[S15] START round=18 head_norm_before_train=1.925882 (no previous merge yet)
[S15] round=18 local utility u=0.489854 metrics={'f1_val': 0.7726169185571029, 'auprc': 0.9886425329243522, 'loss_val': 0.38883124755306614, 'psi': 0.8590271643040026}-{'f1_val': 0.7010713433702593, 'auprc': 0.8618505947109448, 'loss_val': 0.5588901176702827, 'psi': 0.7653830439065336}
[S16] START round=18 head_norm_before_train=1.464294 cos_to_last_merge=0.9988 (last merge round=16)
[S16] round=18 local utility u=0.124365 metrics={'f1_val': 0.8377941742069346, 'auprc': 0.9337482287814557, 'loss_val': 0.48033940385728546, 'psi': 0.876175796036743}-{'f1_val': 0.8483203488939765, 'auprc': 0.8478362440773755, 'loss_val': 0.5344902430122243, 'psi': 0.8481267069673362}
[S17] START round=18 head_norm_before_train=1.894270 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.5769822999952989, 'auprc': 0.7804197194480856, 'loss_val': 1.125018248716497, 'psi': 0.6583572677764136}-{'f1_val': 0.5986011853665395, 'auprc': 0.8311534464418017, 'loss_val': 0.9625824075806009, 'psi': 0.6916220897966444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:40409
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:40412
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1806 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.949407)
[S13] loaded HEAD from S9 (vec_in norm=0.949407)
[S13] cosine check vs S9: cos=0.6084
[S13] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1803) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.580853)
[S11] loaded HEAD from S6 (vec_in norm=1.580853)
[S11] cosine check vs S6: cos=0.9921
[S11] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1795) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.951379)
[S16] loaded HEAD from S15 (vec_in norm=1.951379)
[S16] cosine check vs S15: cos=-0.0887
[S16] DROPPED delta from S15 (cos=-0.0887 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.977423)
[S14] loaded HEAD from S10 (vec_in norm=1.977423)
[S14] cosine check vs S10: cos=0.3946
[S14] BUFFERED delta from S10 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.120806)
[S16] loaded HEAD from S13 (vec_in norm=1.120806)
[S16] cosine check vs S13: cos=0.8139
[S16] BUFFERED delta from S13 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1803) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.506465)
[S8] loaded HEAD from S16 (vec_in norm=1.506465)
[S8] cosine check vs S16: cos=0.9873
[S8] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1806) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.918580)
[S8] loaded HEAD from S2 (vec_in norm=1.918580)
[S8] cosine check vs S2: cos=-0.0131
[S8] DROPPED delta from S2 (cos=-0.0131 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.165528)
[S9] loaded HEAD from S4 (vec_in norm=1.165528)
[S9] cosine check vs S4: cos=0.7924
[S9] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.563008)
[S14] loaded HEAD from S11 (vec_in norm=1.563008)
[S14] cosine check vs S11: cos=0.9079
[S14] BUFFERED delta from S11 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1797) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.273572)
[S4] loaded HEAD from S14 (vec_in norm=1.273572)
[S4] cosine check vs S14: cos=0.6170
[S4] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9914 head_norm=1.644533
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.432354e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9914 head_norm=1.570493 delta_norm=0.143235
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.8378 head_norm=1.506465
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.408312e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8304 head_norm=1.252394 delta_norm=0.440831
[S16] aggregate: ROLLBACK (f1_val pre=0.838 post=0.830 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.7004 head_norm=1.273572
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.221289e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.7036 head_norm=1.226498 delta_norm=0.322129
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.6151 head_norm=1.120806
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.644575e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6143 head_norm=0.929015 delta_norm=0.464458
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9857 head_norm=0.949407
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.557317e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.7012 head_norm=1.001684 delta_norm=0.355732
[S9] aggregate: ROLLBACK (f1_val pre=0.986 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9408 head_norm=1.165528
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.358729e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9413 head_norm=1.096841 delta_norm=0.535873
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.9970 head_norm=1.563008
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.940367e-02
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.9970 head_norm=1.568810 delta_norm=0.099404
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.918580 (no previous merge yet)
[S2] round=19 local utility u=0.027090 metrics={'f1_val': 0.7053653237020304, 'auprc': 0.849204994441401, 'loss_val': 0.5348924429405251, 'psi': 0.7629011919977786}-{'f1_val': 0.7097794593435307, 'auprc': 0.7816139377697118, 'loss_val': 0.41278416031375936, 'psi': 0.7385132507140031}
[S3] START round=19 head_norm_before_train=1.661813 (no previous merge yet)
[S3] round=19 local utility u=0.651817 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9948412595339162, 'loss_val': 0.28038564588437576, 'psi': 0.8179846859697174}-{'f1_val': 0.5249627501306886, 'auprc': 0.9839574470182395, 'loss_val': 0.5006623662344767, 'psi': 0.7085606288857089}
[S4] START round=19 head_norm_before_train=1.096841 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.010136 metrics={'f1_val': 0.942640956598919, 'auprc': 0.9612327860261392, 'loss_val': 0.3473309379247307, 'psi': 0.950077688369807}-{'f1_val': 0.94077077683687, 'auprc': 0.9663836256494023, 'loss_val': 0.3718340345630914, 'psi': 0.951015916361883}
[S5] START round=19 head_norm_before_train=1.383275 cos_to_last_merge=0.8298 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.830
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.6997459506228108, 'auprc': 0.8407722641816322, 'loss_val': 0.37434590292885334, 'psi': 0.7561564760463393}-{'f1_val': 0.7006083926626743, 'auprc': 0.9651864945046962, 'loss_val': 0.31826104474114286, 'psi': 0.806439633399483}
[S6] START round=19 head_norm_before_train=1.580853 cos_to_last_merge=0.8675 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.867
[S6] round=19 local utility u=0.087392 metrics={'f1_val': 0.8476033418193586, 'auprc': 0.9816181445985732, 'loss_val': 0.26733578346498993, 'psi': 0.9012092629310444}-{'f1_val': 0.8366219504238372, 'auprc': 0.9646661853323839, 'loss_val': 0.325375125565211, 'psi': 0.8878396443872559}
[S7] START round=19 head_norm_before_train=1.532850 (no previous merge yet)
[S7] round=19 local utility u=0.540394 metrics={'f1_val': 0.549066978700977, 'auprc': 0.776971898081829, 'loss_val': 0.8063920158946125, 'psi': 0.6402289464533177}-{'f1_val': 0.41788145269937615, 'auprc': 0.7722555324655167, 'loss_val': 1.0859178231779465, 'psi': 0.5596310846058323}
[S8] START round=19 head_norm_before_train=1.570493 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000017 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.9879521153295416, 'loss_val': 0.11538136011490947, 'psi': 0.9911618284472521}-{'f1_val': 0.9914482382097267, 'auprc': 0.997879761775414, 'loss_val': 0.13407718999005147, 'psi': 0.9940208476360017}
[S9] START round=19 head_norm_before_train=1.001684 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9867176631020987, 'auprc': 0.9969447483596341, 'loss_val': 0.281505040984004, 'psi': 0.9908084972051129}-{'f1_val': 0.9856836147752347, 'auprc': 0.9976032649604121, 'loss_val': 0.27415842361254367, 'psi': 0.9904514748493056}
[S10] START round=19 head_norm_before_train=1.977423 (no previous merge yet)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9953148394811306, 'loss_val': 0.03659160101194742, 'psi': 0.9943170400106519}-{'f1_val': 0.9955259082574451, 'auprc': 0.9926980632934423, 'loss_val': 0.03850931882412158, 'psi': 0.994394770271844}
[S11] START round=19 head_norm_before_train=1.568810 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9928730019850893, 'loss_val': 0.2657328579461268, 'psi': 0.9949323012753524}-{'f1_val': 0.996960829744628, 'auprc': 0.9958607708796952, 'loss_val': 0.2573190040445263, 'psi': 0.9965208061986548}
[S13] START round=19 head_norm_before_train=0.929015 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.021002 metrics={'f1_val': 0.6233901234098078, 'auprc': 0.684297321539592, 'loss_val': 0.6851032913553085, 'psi': 0.6477530026617215}-{'f1_val': 0.6151027662022255, 'auprc': 0.685239334630855, 'loss_val': 0.6802097220335275, 'psi': 0.6431573935736772}
[S14] START round=19 head_norm_before_train=1.226498 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.132994 metrics={'f1_val': 0.7495875792961165, 'auprc': 0.9928264302550684, 'loss_val': 0.5593356711550928, 'psi': 0.8468831196796973}-{'f1_val': 0.7003643806352908, 'auprc': 0.9933307294493382, 'loss_val': 0.5314979365720094, 'psi': 0.8175509201609097}
[S15] START round=19 head_norm_before_train=1.951379 (no previous merge yet)
[S15] round=19 local utility u=0.854876 metrics={'f1_val': 0.9958486957917267, 'auprc': 0.9949726191826364, 'loss_val': 0.03745965072396773, 'psi': 0.9954982651480906}-{'f1_val': 0.7726169185571029, 'auprc': 0.9886425329243522, 'loss_val': 0.38883124755306614, 'psi': 0.8590271643040026}
[S16] START round=19 head_norm_before_train=1.252394 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.190638 metrics={'f1_val': 0.864847792258096, 'auprc': 0.9839832960589288, 'loss_val': 0.41208941661297477, 'psi': 0.9125019937784291}-{'f1_val': 0.8377941742069346, 'auprc': 0.9337482287814557, 'loss_val': 0.48033940385728546, 'psi': 0.876175796036743}
[S17] START round=19 head_norm_before_train=1.916885 (no previous merge yet)
[S17] round=19 local utility u=0.067695 metrics={'f1_val': 0.5749997378267911, 'auprc': 0.820753952782818, 'loss_val': 1.0987358019161673, 'psi': 0.6733014238092019}-{'f1_val': 0.5769822999952989, 'auprc': 0.7804197194480856, 'loss_val': 1.125018248716497, 'psi': 0.6583572677764136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:40416
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:40411
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.020235)
[S16] loaded HEAD from S13 (vec_in norm=1.020235)
[S16] cosine check vs S13: cos=0.8002
[S16] BUFFERED delta from S13 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.943104)
[S8] loaded HEAD from S2 (vec_in norm=1.943104)
[S8] cosine check vs S2: cos=-0.0079
[S8] DROPPED delta from S2 (cos=-0.0079 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.608167)
[S11] loaded HEAD from S6 (vec_in norm=1.608167)
[S11] cosine check vs S6: cos=0.9947
[S11] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1792) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.973717)
[S16] loaded HEAD from S15 (vec_in norm=1.973717)
[S16] cosine check vs S15: cos=-0.1045
[S16] DROPPED delta from S15 (cos=-0.1045 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.296500)
[S8] loaded HEAD from S16 (vec_in norm=1.296500)
[S8] cosine check vs S16: cos=0.9533
[S8] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.258669)
[S4] loaded HEAD from S14 (vec_in norm=1.258669)
[S4] cosine check vs S14: cos=0.8958
[S4] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.634799)
[S17] loaded HEAD from S8 (vec_in norm=1.634799)
[S17] cosine check vs S8: cos=-0.1282
[S17] DROPPED delta from S8 (cos=-0.1282 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.674372)
[S4] loaded HEAD from S3 (vec_in norm=1.674372)
[S4] cosine check vs S3: cos=0.4511
[S4] BUFFERED delta from S3 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.184788)
[S9] loaded HEAD from S4 (vec_in norm=1.184788)
[S9] cosine check vs S4: cos=0.8569
[S9] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1805) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.545855)
[S10] loaded HEAD from S7 (vec_in norm=1.545855)
[S10] cosine check vs S7: cos=-0.1073
[S10] DROPPED delta from S7 (cos=-0.1073 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.942601)
[S9] loaded HEAD from S17 (vec_in norm=1.942601)
[S9] cosine check vs S17: cos=-0.0518
[S9] DROPPED delta from S17 (cos=-0.0518 < 0.0)
[S10] r=20 psi=0.994 u=0.0000 p_local=0.0630 f1=0.994 auprc=0.995 bytes=21604
[S5] r=20 psi=0.756 u=0.0000 p_local=0.1305 f1=0.700 auprc=0.841 bytes=19797
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9867 head_norm=1.055275
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.060018e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9846 head_norm=1.079364 delta_norm=0.306002
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.991 u=0.0000 p_local=0.2022 f1=0.987 auprc=0.997 bytes=19755
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.9963 head_norm=1.595691
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.270125e-02
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9963 head_norm=1.599805 delta_norm=0.082701
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.995 u=0.0000 p_local=0.2110 f1=0.996 auprc=0.993 bytes=25167
[S2] r=20 psi=0.763 u=0.0271 p_local=0.0624 f1=0.705 auprc=0.849 bytes=16217
[S3] r=20 psi=0.818 u=0.6518 p_local=0.2402 f1=0.700 auprc=0.995 bytes=23366
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9426 head_norm=1.184788
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.099436e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9422 head_norm=1.100666 delta_norm=0.309944
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S4] r=20 psi=0.950 u=0.0101 p_local=0.0783 f1=0.943 auprc=0.961 bytes=25169
[S15] r=20 psi=0.995 u=0.8549 p_local=0.3589 f1=0.996 auprc=0.995 bytes=16169
[S13] r=20 psi=0.648 u=0.0210 p_local=0.0705 f1=0.623 auprc=0.684 bytes=17986
[S6] r=20 psi=0.901 u=0.0874 p_local=0.1871 f1=0.848 auprc=0.982 bytes=17988
[S14] r=20 psi=0.847 u=0.1330 p_local=0.1771 f1=0.750 auprc=0.993 bytes=23340
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.8648 head_norm=1.296500
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.888330e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.9268 head_norm=1.099866 delta_norm=0.388833
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.913 u=0.1906 p_local=0.2259 f1=0.865 auprc=0.984 bytes=21578
[S7] r=20 psi=0.640 u=0.5404 p_local=0.2412 f1=0.549 auprc=0.777 bytes=21609
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9933 head_norm=1.634799
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.793998e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9933 head_norm=1.448681 delta_norm=0.279400
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.991 u=0.0000 p_local=0.1465 f1=0.993 auprc=0.988 bytes=19803
[S17] r=20 psi=0.673 u=0.0677 p_local=0.1005 f1=0.575 auprc=0.821 bytes=21602
[S2] START round=20 head_norm_before_train=1.943104 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7100081671085082, 'auprc': 0.7897108224998295, 'loss_val': 0.47073316331020004, 'psi': 0.7418892292650368}-{'f1_val': 0.7053653237020304, 'auprc': 0.849204994441401, 'loss_val': 0.5348924429405251, 'psi': 0.7629011919977786}
[S3] START round=20 head_norm_before_train=1.674372 (no previous merge yet)
[S3] round=20 local utility u=0.005438 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9963885904203157, 'loss_val': 0.27715880168809276, 'psi': 0.8189042737633793}-{'f1_val': 0.7000803035935849, 'auprc': 0.9948412595339162, 'loss_val': 0.28038564588437576, 'psi': 0.8179846859697174}
[S4] START round=20 head_norm_before_train=1.100666 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.006299 metrics={'f1_val': 0.9444805742869298, 'auprc': 0.9560522694960749, 'loss_val': 0.3302290168482415, 'psi': 0.9491092523705879}-{'f1_val': 0.942640956598919, 'auprc': 0.9612327860261392, 'loss_val': 0.3473309379247307, 'psi': 0.950077688369807}
[S5] START round=20 head_norm_before_train=1.406201 cos_to_last_merge=0.8245 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.825
[S5] round=20 local utility u=0.272135 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9915088582475495, 'loss_val': 0.2874644006191918, 'psi': 0.8169689997024883}-{'f1_val': 0.6997459506228108, 'auprc': 0.8407722641816322, 'loss_val': 0.37434590292885334, 'psi': 0.7561564760463393}
[S6] START round=20 head_norm_before_train=1.608167 cos_to_last_merge=0.8647 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.865
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8320016972345351, 'auprc': 0.9536465191317718, 'loss_val': 0.3645221121414988, 'psi': 0.8806596259934298}-{'f1_val': 0.8476033418193586, 'auprc': 0.9816181445985732, 'loss_val': 0.26733578346498993, 'psi': 0.9012092629310444}
[S7] START round=20 head_norm_before_train=1.545855 (no previous merge yet)
[S7] round=20 local utility u=0.059933 metrics={'f1_val': 0.5602690750502518, 'auprc': 0.7810159225527532, 'loss_val': 0.7658703414733733, 'psi': 0.6485678140512523}-{'f1_val': 0.549066978700977, 'auprc': 0.776971898081829, 'loss_val': 0.8063920158946125, 'psi': 0.6402289464533177}
[S8] START round=20 head_norm_before_train=1.448681 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9850649919551823, 'loss_val': 0.11405235155317779, 'psi': 0.989787706147167}-{'f1_val': 0.9933016371923923, 'auprc': 0.9879521153295416, 'loss_val': 0.11538136011490947, 'psi': 0.9911618284472521}
[S9] START round=20 head_norm_before_train=1.079364 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.016176 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9893412836435743, 'loss_val': 0.2860003787761122, 'psi': 0.9937328205457646}-{'f1_val': 0.9867176631020987, 'auprc': 0.9969447483596341, 'loss_val': 0.281505040984004, 'psi': 0.9908084972051129}
[S10] START round=20 head_norm_before_train=2.002887 (no previous merge yet)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9934082608615626, 'auprc': 0.996145953135077, 'loss_val': 0.03860428713258204, 'psi': 0.9945033377709684}-{'f1_val': 0.9936518403636662, 'auprc': 0.9953148394811306, 'loss_val': 0.03659160101194742, 'psi': 0.9943170400106519}
[S11] START round=20 head_norm_before_train=1.599805 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.039814 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9949181824901195, 'loss_val': 0.19369187156245582, 'psi': 0.9958954757042016}-{'f1_val': 0.996305167468861, 'auprc': 0.9928730019850893, 'loss_val': 0.2657328579461268, 'psi': 0.9949323012753524}
[S13] START round=20 head_norm_before_train=1.020235 cos_to_last_merge=0.9904 (last merge round=18)
[S13] round=20 local utility u=0.050918 metrics={'f1_val': 0.6319547635918359, 'auprc': 0.6791344015834518, 'loss_val': 0.6191655722635777, 'psi': 0.6508266187884824}-{'f1_val': 0.6233901234098078, 'auprc': 0.684297321539592, 'loss_val': 0.6851032913553085, 'psi': 0.6477530026617215}
[S14] START round=20 head_norm_before_train=1.258669 cos_to_last_merge=0.9980 (last merge round=18)
[S14] round=20 local utility u=0.478918 metrics={'f1_val': 0.9110593124959091, 'auprc': 0.9631857361744826, 'loss_val': 0.48140727910612197, 'psi': 0.9319098819673386}-{'f1_val': 0.7495875792961165, 'auprc': 0.9928264302550684, 'loss_val': 0.5593356711550928, 'psi': 0.8468831196796973}
[S15] START round=20 head_norm_before_train=1.973717 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6970719493487432, 'auprc': 0.8483966146277431, 'loss_val': 0.6167061090977805, 'psi': 0.7576018154603432}-{'f1_val': 0.9958486957917267, 'auprc': 0.9949726191826364, 'loss_val': 0.03745965072396773, 'psi': 0.9954982651480906}
[S16] START round=20 head_norm_before_train=1.099866 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.293936 metrics={'f1_val': 0.9624572784305235, 'auprc': 0.989609101732174, 'loss_val': 0.4267513249309876, 'psi': 0.9733180077511837}-{'f1_val': 0.864847792258096, 'auprc': 0.9839832960589288, 'loss_val': 0.41208941661297477, 'psi': 0.9125019937784291}
[S17] START round=20 head_norm_before_train=1.942601 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.3707315022489499, 'auprc': 0.6331217762959405, 'loss_val': 1.7375924509434735, 'psi': 0.47568761186774616}-{'f1_val': 0.5749997378267911, 'auprc': 0.820753952782818, 'loss_val': 1.0987358019161673, 'psi': 0.6733014238092019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:40404
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:40413
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:40411
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.125084)
[S13] loaded HEAD from S9 (vec_in norm=1.125084)
[S13] cosine check vs S9: cos=0.6586
[S13] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.179036)
[S9] loaded HEAD from S4 (vec_in norm=1.179036)
[S9] cosine check vs S4: cos=0.9683
[S9] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.286077)
[S4] loaded HEAD from S14 (vec_in norm=1.286077)
[S4] cosine check vs S14: cos=0.7930
[S4] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1804) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.688332)
[S4] loaded HEAD from S3 (vec_in norm=1.688332)
[S4] cosine check vs S3: cos=0.6428
[S4] BUFFERED delta from S3 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.116941)
[S16] loaded HEAD from S13 (vec_in norm=1.116941)
[S16] cosine check vs S13: cos=0.9368
[S16] BUFFERED delta from S13 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.560616)
[S10] loaded HEAD from S7 (vec_in norm=1.560616)
[S10] cosine check vs S7: cos=-0.1079
[S10] DROPPED delta from S7 (cos=-0.1079 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.150895)
[S8] loaded HEAD from S16 (vec_in norm=1.150895)
[S8] cosine check vs S16: cos=0.9116
[S8] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.425707)
[S9] loaded HEAD from S5 (vec_in norm=1.425707)
[S9] cosine check vs S5: cos=0.1683
[S9] BUFFERED delta from S5 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.628865)
[S14] loaded HEAD from S11 (vec_in norm=1.628865)
[S14] cosine check vs S11: cos=0.7742
[S14] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.050 → S8@127.0.0.1:40409
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9929 head_norm=1.527784
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.365504e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9922 head_norm=1.309991 delta_norm=0.336550
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.117 → S17@127.0.0.1:40417
[S6] ⇄ pheromone p=0.150 → S11@127.0.0.1:40412
[S10] ⇄ pheromone p=0.050 → S14@127.0.0.1:40414
[S3] ⇄ pheromone p=0.193 → S4@127.0.0.1:40404
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9111 head_norm=1.286077
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.156155e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.7999 head_norm=1.373950 delta_norm=0.515615
[S14] aggregate: ROLLBACK (f1_val pre=0.911 post=0.800 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.237 → S4@127.0.0.1:40404
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9967 head_norm=1.125084
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.731429e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9967 head_norm=0.957310 delta_norm=0.373143
[S9] aggregate: ACCEPT kept=['S4', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.165 → S13@127.0.0.1:40413
[S11] ⇄ pheromone p=0.177 → S14@127.0.0.1:40414
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9445 head_norm=1.179036
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.939756e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9445 head_norm=1.130780 delta_norm=0.193976
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.064 → S9@127.0.0.1:40410
[S5] ⇄ pheromone p=0.159 → S9@127.0.0.1:40410
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9625 head_norm=1.150895
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.023324e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9301 head_norm=1.115849 delta_norm=0.202332
[S16] aggregate: ROLLBACK (f1_val pre=0.962 post=0.930 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.240 → S8@127.0.0.1:40409
[S7] ⇄ pheromone p=0.205 → S10@127.0.0.1:40411
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.6320 head_norm=1.116941
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.631769e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.6303 head_norm=1.020859 delta_norm=0.463177
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.067 → S16@127.0.0.1:40416
[S17] ⇄ pheromone p=0.080 → S9@127.0.0.1:40410
[S15] ⇄ pheromone p=0.287 → S16@127.0.0.1:40416
[S2] START round=21 head_norm_before_train=1.963024 (no previous merge yet)
[S2] round=21 local utility u=0.037368 metrics={'f1_val': 0.7102681510465351, 'auprc': 0.8103218754354893, 'loss_val': 0.4593894502662897, 'psi': 0.7502896408021167}-{'f1_val': 0.7100081671085082, 'auprc': 0.7897108224998295, 'loss_val': 0.47073316331020004, 'psi': 0.7418892292650368}
[S3] START round=21 head_norm_before_train=1.688332 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.996592075949865, 'loss_val': 0.28208958612962054, 'psi': 0.8191358713952324}-{'f1_val': 0.7005813959920884, 'auprc': 0.9963885904203157, 'loss_val': 0.27715880168809276, 'psi': 0.8189042737633793}
[S4] START round=21 head_norm_before_train=1.130780 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.009645 metrics={'f1_val': 0.9432630723202462, 'auprc': 0.9618101874298342, 'loss_val': 0.32090691664763954, 'psi': 0.9506819183640813}-{'f1_val': 0.9444805742869298, 'auprc': 0.9560522694960749, 'loss_val': 0.3302290168482415, 'psi': 0.9491092523705879}
[S5] START round=21 head_norm_before_train=1.425707 cos_to_last_merge=0.8193 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.819
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.41794652915287456, 'auprc': 0.765254605265939, 'loss_val': 0.9792251003595461, 'psi': 0.5568697595981004}-{'f1_val': 0.7006090940057808, 'auprc': 0.9915088582475495, 'loss_val': 0.2874644006191918, 'psi': 0.8169689997024883}
[S6] START round=21 head_norm_before_train=1.627258 cos_to_last_merge=0.8628 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.863
[S6] round=21 local utility u=0.038018 metrics={'f1_val': 0.8430829397782268, 'auprc': 0.9570298850728668, 'loss_val': 0.36512338634121133, 'psi': 0.8886617178960827}-{'f1_val': 0.8320016972345351, 'auprc': 0.9536465191317718, 'loss_val': 0.3645221121414988, 'psi': 0.8806596259934298}
[S7] START round=21 head_norm_before_train=1.560616 (no previous merge yet)
[S7] round=21 local utility u=0.498901 metrics={'f1_val': 0.6705685285684841, 'auprc': 0.8018196367964691, 'loss_val': 0.49227571114892743, 'psi': 0.7230689718596781}-{'f1_val': 0.5602690750502518, 'auprc': 0.7810159225527532, 'loss_val': 0.7658703414733733, 'psi': 0.6485678140512523}
[S8] START round=21 head_norm_before_train=1.309991 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9866431669038228, 'loss_val': 0.1240078436074567, 'psi': 0.9899814227202138}-{'f1_val': 0.9929361822751569, 'auprc': 0.9850649919551823, 'loss_val': 0.11405235155317779, 'psi': 0.989787706147167}
[S9] START round=21 head_norm_before_train=0.957310 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9867176631020987, 'auprc': 0.9885814516319433, 'loss_val': 0.2371384400438394, 'psi': 0.9874631785140366}-{'f1_val': 0.9966605118138915, 'auprc': 0.9893412836435743, 'loss_val': 0.2860003787761122, 'psi': 0.9937328205457646}
[S10] START round=21 head_norm_before_train=2.019092 (no previous merge yet)
[S10] round=21 local utility u=0.000883 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.995056832713584, 'loss_val': 0.03503192013157961, 'psi': 0.9942138373036333}-{'f1_val': 0.9934082608615626, 'auprc': 0.996145953135077, 'loss_val': 0.03860428713258204, 'psi': 0.9945033377709684}
[S11] START round=21 head_norm_before_train=1.628865 cos_to_last_merge=0.9993 (last merge round=19)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9583643774808218, 'auprc': 0.9962568546798407, 'loss_val': 0.16457534760556428, 'psi': 0.9735213683604294}-{'f1_val': 0.9965470045135896, 'auprc': 0.9949181824901195, 'loss_val': 0.19369187156245582, 'psi': 0.9958954757042016}
[S13] START round=21 head_norm_before_train=1.020859 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6084702932344186, 'auprc': 0.6242167577107072, 'loss_val': 0.7735637563897629, 'psi': 0.6147688790249339}-{'f1_val': 0.6319547635918359, 'auprc': 0.6791344015834518, 'loss_val': 0.6191655722635777, 'psi': 0.6508266187884824}
[S14] START round=21 head_norm_before_train=1.373950 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.761975885767197, 'auprc': 0.9905908149728441, 'loss_val': 0.49100984805275005, 'psi': 0.8534218574494559}-{'f1_val': 0.9110593124959091, 'auprc': 0.9631857361744826, 'loss_val': 0.48140727910612197, 'psi': 0.9319098819673386}
[S15] START round=21 head_norm_before_train=1.993168 (no previous merge yet)
[S15] round=21 local utility u=0.290520 metrics={'f1_val': 0.7035482902726865, 'auprc': 0.9881391542613849, 'loss_val': 0.49375128081010866, 'psi': 0.8173846358681658}-{'f1_val': 0.6970719493487432, 'auprc': 0.8483966146277431, 'loss_val': 0.6167061090977805, 'psi': 0.7576018154603432}
[S16] START round=21 head_norm_before_train=1.115849 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.9016566195294478, 'auprc': 0.9915633401202792, 'loss_val': 0.4910763317434734, 'psi': 0.9376193077657804}-{'f1_val': 0.9624572784305235, 'auprc': 0.989609101732174, 'loss_val': 0.4267513249309876, 'psi': 0.9733180077511837}
[S17] START round=21 head_norm_before_train=1.971910 (no previous merge yet)
[S17] round=21 local utility u=1.000000 metrics={'f1_val': 0.5902527026120391, 'auprc': 0.782609241519219, 'loss_val': 1.2800633212187167, 'psi': 0.6671953181749111}-{'f1_val': 0.3707315022489499, 'auprc': 0.6331217762959405, 'loss_val': 1.7375924509434735, 'psi': 0.47568761186774616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:40411
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:40412
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:40416
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.982834)
[S8] loaded HEAD from S2 (vec_in norm=1.982834)
[S8] cosine check vs S2: cos=0.0451
[S8] BUFFERED delta from S2 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.210981)
[S9] loaded HEAD from S4 (vec_in norm=1.210981)
[S9] cosine check vs S4: cos=0.8473
[S9] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.025917)
[S14] loaded HEAD from S10 (vec_in norm=2.025917)
[S14] cosine check vs S10: cos=0.2870
[S14] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1804) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.576335)
[S10] loaded HEAD from S7 (vec_in norm=1.576335)
[S10] cosine check vs S7: cos=-0.1088
[S10] DROPPED delta from S7 (cos=-0.1088 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.644205)
[S11] loaded HEAD from S6 (vec_in norm=1.644205)
[S11] cosine check vs S6: cos=0.9924
[S11] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.004142)
[S16] loaded HEAD from S15 (vec_in norm=2.004142)
[S16] cosine check vs S15: cos=-0.1080
[S16] DROPPED delta from S15 (cos=-0.1080 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.996362)
[S9] loaded HEAD from S17 (vec_in norm=1.996362)
[S9] cosine check vs S17: cos=-0.0688
[S9] DROPPED delta from S17 (cos=-0.0688 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9922 head_norm=1.396522
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.186579e+00
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9922 head_norm=1.238136 delta_norm=1.186579
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9584 head_norm=1.655799
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.017843e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9584 head_norm=1.646870 delta_norm=0.101784
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.7620 head_norm=1.393369
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.051828e+00
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9346 head_norm=1.384401 delta_norm=1.051828
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9867 head_norm=1.012822
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.216509e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9867 head_norm=1.068963 delta_norm=0.321651
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.982834 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.646316583990907, 'auprc': 0.6672298562641776, 'loss_val': 1.1005957002596973, 'psi': 0.6546818929002152}-{'f1_val': 0.7102681510465351, 'auprc': 0.8103218754354893, 'loss_val': 0.4593894502662897, 'psi': 0.7502896408021167}
[S3] START round=22 head_norm_before_train=1.703455 (no previous merge yet)
[S3] round=22 local utility u=0.028254 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9953255072807412, 'loss_val': 0.2187772476517844, 'psi': 0.8183287543242137}-{'f1_val': 0.7008317350254774, 'auprc': 0.996592075949865, 'loss_val': 0.28208958612962054, 'psi': 0.8191358713952324}
[S4] START round=22 head_norm_before_train=1.210981 cos_to_last_merge=0.9947 (last merge round=20)
[S4] round=22 local utility u=0.024976 metrics={'f1_val': 0.9418124243058796, 'auprc': 0.9727053930682028, 'loss_val': 0.2949369310644396, 'psi': 0.9541696118108088}-{'f1_val': 0.9432630723202462, 'auprc': 0.9618101874298342, 'loss_val': 0.32090691664763954, 'psi': 0.9506819183640813}
[S5] START round=22 head_norm_before_train=1.442166 cos_to_last_merge=0.8140 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.814
[S5] round=22 local utility u=1.000000 metrics={'f1_val': 0.7006947214685414, 'auprc': 0.9914781020215965, 'loss_val': 0.28550980664942055, 'psi': 0.8170080736897634}-{'f1_val': 0.41794652915287456, 'auprc': 0.765254605265939, 'loss_val': 0.9792251003595461, 'psi': 0.5568697595981004}
[S6] START round=22 head_norm_before_train=1.644205 cos_to_last_merge=0.8611 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.861
[S6] round=22 local utility u=0.566205 metrics={'f1_val': 0.9854850209731051, 'auprc': 0.957797131131243, 'loss_val': 0.08942801122689838, 'psi': 0.9744098650363603}-{'f1_val': 0.8430829397782268, 'auprc': 0.9570298850728668, 'loss_val': 0.36512338634121133, 'psi': 0.8886617178960827}
[S7] START round=22 head_norm_before_train=1.576335 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.6465652874799932, 'auprc': 0.8004255739417572, 'loss_val': 0.5224651659855507, 'psi': 0.7081094020646987}-{'f1_val': 0.6705685285684841, 'auprc': 0.8018196367964691, 'loss_val': 0.49227571114892743, 'psi': 0.7230689718596781}
[S8] START round=22 head_norm_before_train=1.238136 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9932810269810869, 'auprc': 0.982287173098582, 'loss_val': 0.24045796513635592, 'psi': 0.988883485428085}-{'f1_val': 0.9922069265978078, 'auprc': 0.9866431669038228, 'loss_val': 0.1240078436074567, 'psi': 0.9899814227202138}
[S9] START round=22 head_norm_before_train=1.068963 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.043135 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9926036668864828, 'loss_val': 0.22259151710846015, 'psi': 0.995037773842928}-{'f1_val': 0.9867176631020987, 'auprc': 0.9885814516319433, 'loss_val': 0.2371384400438394, 'psi': 0.9874631785140366}
[S10] START round=22 head_norm_before_train=2.025917 (no previous merge yet)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.992994663041229, 'auprc': 0.9953390948325715, 'loss_val': 0.03657556103814237, 'psi': 0.993932435757766}-{'f1_val': 0.9936518403636662, 'auprc': 0.995056832713584, 'loss_val': 0.03503192013157961, 'psi': 0.9942138373036333}
[S11] START round=22 head_norm_before_train=1.646870 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.129376 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9950140236230591, 'loss_val': 0.13119150369308596, 'psi': 0.9959338121573774}-{'f1_val': 0.9583643774808218, 'auprc': 0.9962568546798407, 'loss_val': 0.16457534760556428, 'psi': 0.9735213683604294}
[S13] START round=22 head_norm_before_train=1.096793 cos_to_last_merge=0.9935 (last merge round=20)
[S13] round=22 local utility u=0.299510 metrics={'f1_val': 0.6471161058288208, 'auprc': 0.6816259416934974, 'loss_val': 0.5786467542228075, 'psi': 0.6609200401746915}-{'f1_val': 0.6084702932344186, 'auprc': 0.6242167577107072, 'loss_val': 0.7735637563897629, 'psi': 0.6147688790249339}
[S14] START round=22 head_norm_before_train=1.384401 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.711282 metrics={'f1_val': 0.9955461130961042, 'auprc': 0.9947753228307087, 'loss_val': 0.4824199249324401, 'psi': 0.995237796989946}-{'f1_val': 0.761975885767197, 'auprc': 0.9905908149728441, 'loss_val': 0.49100984805275005, 'psi': 0.8534218574494559}
[S15] START round=22 head_norm_before_train=2.004142 (no previous merge yet)
[S15] round=22 local utility u=1.000000 metrics={'f1_val': 0.9809581441534636, 'auprc': 0.9977027910814597, 'loss_val': 0.08288300679345464, 'psi': 0.9876560029246619}-{'f1_val': 0.7035482902726865, 'auprc': 0.9881391542613849, 'loss_val': 0.49375128081010866, 'psi': 0.8173846358681658}
[S16] START round=22 head_norm_before_train=1.169153 cos_to_last_merge=0.9963 (last merge round=20)
[S16] round=22 local utility u=0.354267 metrics={'f1_val': 0.9863647293553732, 'auprc': 0.9896605930975716, 'loss_val': 0.2850834663931946, 'psi': 0.9876830748522526}-{'f1_val': 0.9016566195294478, 'auprc': 0.9915633401202792, 'loss_val': 0.4910763317434734, 'psi': 0.9376193077657804}
[S17] START round=22 head_norm_before_train=1.996362 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.5371077466997223, 'auprc': 0.7009300422942478, 'loss_val': 1.5793659543312522, 'psi': 0.6026366649375325}-{'f1_val': 0.5902527026120391, 'auprc': 0.782609241519219, 'loss_val': 1.2800633212187167, 'psi': 0.6671953181749111}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:40404
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:40416
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:40414
[S9] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.233378)
[S8] loaded HEAD from S16 (vec_in norm=1.233378)
[S8] cosine check vs S16: cos=0.6312
[S8] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1796) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.395799)
[S4] loaded HEAD from S14 (vec_in norm=1.395799)
[S4] cosine check vs S14: cos=0.6655
[S4] BUFFERED delta from S14 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1796) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.273456)
[S9] loaded HEAD from S4 (vec_in norm=1.273456)
[S9] cosine check vs S4: cos=0.9570
[S9] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.453863)
[S9] loaded HEAD from S5 (vec_in norm=1.453863)
[S9] cosine check vs S5: cos=0.2426
[S9] BUFFERED delta from S5 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1795) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.672960)
[S14] loaded HEAD from S11 (vec_in norm=1.672960)
[S14] cosine check vs S11: cos=0.4814
[S14] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1806) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.720135)
[S4] loaded HEAD from S3 (vec_in norm=1.720135)
[S4] cosine check vs S3: cos=0.7053
[S4] BUFFERED delta from S3 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.113595)
[S13] loaded HEAD from S9 (vec_in norm=1.113595)
[S13] cosine check vs S9: cos=0.8314
[S13] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.659965)
[S11] loaded HEAD from S6 (vec_in norm=1.659965)
[S11] cosine check vs S6: cos=0.9956
[S11] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.182884)
[S16] loaded HEAD from S13 (vec_in norm=1.182884)
[S16] cosine check vs S13: cos=0.8771
[S16] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1793) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.016047)
[S16] loaded HEAD from S15 (vec_in norm=2.016047)
[S16] cosine check vs S15: cos=-0.1020
[S16] DROPPED delta from S15 (cos=-0.1020 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9933 head_norm=1.320384
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.497442e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9933 head_norm=1.153299 delta_norm=0.549744
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9967 head_norm=1.113595
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.223870e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9967 head_norm=0.989400 delta_norm=0.322387
[S9] aggregate: ACCEPT kept=['S4', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.9864 head_norm=1.233378
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.004605e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.9698 head_norm=1.170445 delta_norm=0.300461
[S16] aggregate: ROLLBACK (f1_val pre=0.986 post=0.970 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9955 head_norm=1.395799
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.903631e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.8574 head_norm=1.322441 delta_norm=0.790363
[S14] aggregate: ROLLBACK (f1_val pre=0.996 post=0.857 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.9965 head_norm=1.672960
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.802539e-02
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.9965 head_norm=1.664648 delta_norm=0.078025
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9418 head_norm=1.273456
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.598419e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9420 head_norm=1.196467 delta_norm=0.259842
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.6471 head_norm=1.182884
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.350083e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.5892 head_norm=1.098829 delta_norm=0.335008
[S13] aggregate: ROLLBACK (f1_val pre=0.647 post=0.589 tol_abs=0.005 tol_rel=0.0)
[S2] START round=23 head_norm_before_train=1.999501 (no previous merge yet)
[S2] round=23 local utility u=0.465618 metrics={'f1_val': 0.7128247714112594, 'auprc': 0.6948849326699957, 'loss_val': 0.6513748966966375, 'psi': 0.7056488359147539}-{'f1_val': 0.646316583990907, 'auprc': 0.6672298562641776, 'loss_val': 1.1005957002596973, 'psi': 0.6546818929002152}
[S3] START round=23 head_norm_before_train=1.720135 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9878347938086655, 'loss_val': 0.3038026446097583, 'psi': 0.815587639764646}-{'f1_val': 0.700330919019862, 'auprc': 0.9953255072807412, 'loss_val': 0.2187772476517844, 'psi': 0.8183287543242137}
[S4] START round=23 head_norm_before_train=1.196467 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9453000040037774, 'auprc': 0.9638393493781268, 'loss_val': 0.30373540099975566, 'psi': 0.9527157421535171}-{'f1_val': 0.9418124243058796, 'auprc': 0.9727053930682028, 'loss_val': 0.2949369310644396, 'psi': 0.9541696118108088}
[S5] START round=23 head_norm_before_train=1.453863 cos_to_last_merge=0.8104 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.810
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.6941579017915613, 'auprc': 0.9032695644943911, 'loss_val': 0.32608929063289777, 'psi': 0.7778025668726932}-{'f1_val': 0.7006947214685414, 'auprc': 0.9914781020215965, 'loss_val': 0.28550980664942055, 'psi': 0.8170080736897634}
[S6] START round=23 head_norm_before_train=1.659965 cos_to_last_merge=0.8602 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.860
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6940028253201586, 'auprc': 0.9331997069628406, 'loss_val': 0.7311375864940739, 'psi': 0.7896815779772314}-{'f1_val': 0.9854850209731051, 'auprc': 0.957797131131243, 'loss_val': 0.08942801122689838, 'psi': 0.9744098650363603}
[S7] START round=23 head_norm_before_train=1.589639 (no previous merge yet)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.5890398650830477, 'auprc': 0.792898990931572, 'loss_val': 0.6444921555510591, 'psi': 0.6705835154224574}-{'f1_val': 0.6465652874799932, 'auprc': 0.8004255739417572, 'loss_val': 0.5224651659855507, 'psi': 0.7081094020646987}
[S8] START round=23 head_norm_before_train=1.153299 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.073362 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9977014459410082, 'loss_val': 0.13353289350324463, 'psi': 0.994404734335088}-{'f1_val': 0.9932810269810869, 'auprc': 0.982287173098582, 'loss_val': 0.24045796513635592, 'psi': 0.988883485428085}
[S9] START round=23 head_norm_before_train=0.989400 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.002065 metrics={'f1_val': 0.9897071435092063, 'auprc': 0.9983264935755654, 'loss_val': 0.1939102963566983, 'psi': 0.9931548835357499}-{'f1_val': 0.9966605118138915, 'auprc': 0.9926036668864828, 'loss_val': 0.22259151710846015, 'psi': 0.995037773842928}
[S10] START round=23 head_norm_before_train=2.036172 (no previous merge yet)
[S10] round=23 local utility u=0.000095 metrics={'f1_val': 0.9932136491405474, 'auprc': 0.9943284619778747, 'loss_val': 0.034666695170456195, 'psi': 0.9936595742754784}-{'f1_val': 0.992994663041229, 'auprc': 0.9953390948325715, 'loss_val': 0.03657556103814237, 'psi': 0.993932435757766}
[S11] START round=23 head_norm_before_train=1.664648 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.8128321725333789, 'auprc': 0.9922879991584209, 'loss_val': 0.337874804999414, 'psi': 0.8846145031833957}-{'f1_val': 0.9965470045135896, 'auprc': 0.9950140236230591, 'loss_val': 0.13119150369308596, 'psi': 0.9959338121573774}
[S13] START round=23 head_norm_before_train=1.098829 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5724069398129258, 'auprc': 0.6565326125313833, 'loss_val': 0.7570752745845193, 'psi': 0.6060572089003088}-{'f1_val': 0.6471161058288208, 'auprc': 0.6816259416934974, 'loss_val': 0.5786467542228075, 'psi': 0.6609200401746915}
[S14] START round=23 head_norm_before_train=1.322441 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.008113 metrics={'f1_val': 0.993997682923919, 'auprc': 0.9900627194009025, 'loss_val': 0.442764681852441, 'psi': 0.9924236975147124}-{'f1_val': 0.9955461130961042, 'auprc': 0.9947753228307087, 'loss_val': 0.4824199249324401, 'psi': 0.995237796989946}
[S15] START round=23 head_norm_before_train=2.016047 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.8412060140766939, 'auprc': 0.9870619009572671, 'loss_val': 0.1829285913661077, 'psi': 0.8995483688289232}-{'f1_val': 0.9809581441534636, 'auprc': 0.9977027910814597, 'loss_val': 0.08288300679345464, 'psi': 0.9876560029246619}
[S16] START round=23 head_norm_before_train=1.170445 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8429773617848247, 'auprc': 0.9642050009723204, 'loss_val': 0.5794577803472698, 'psi': 0.891468417459823}-{'f1_val': 0.9863647293553732, 'auprc': 0.9896605930975716, 'loss_val': 0.2850834663931946, 'psi': 0.9876830748522526}
[S17] START round=23 head_norm_before_train=2.016807 (no previous merge yet)
[S17] round=23 local utility u=0.857368 metrics={'f1_val': 0.6319896235089002, 'auprc': 0.8788385292069223, 'loss_val': 0.9676457886234368, 'psi': 0.7307291857881091}-{'f1_val': 0.5371077466997223, 'auprc': 0.7009300422942478, 'loss_val': 1.5793659543312522, 'psi': 0.6026366649375325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:40417
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:40409
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:40413
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:40414
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:40410
[S9] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1806) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.272032)
[S17] loaded HEAD from S8 (vec_in norm=1.272032)
[S17] cosine check vs S8: cos=-0.1248
[S17] DROPPED delta from S8 (cos=-0.1248 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.014966)
[S8] loaded HEAD from S2 (vec_in norm=2.014966)
[S8] cosine check vs S2: cos=0.4593
[S8] BUFFERED delta from S2 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.051718)
[S14] loaded HEAD from S10 (vec_in norm=2.051718)
[S14] cosine check vs S10: cos=0.4641
[S14] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1796) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.042757)
[S13] loaded HEAD from S9 (vec_in norm=1.042757)
[S13] cosine check vs S9: cos=0.8919
[S13] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.335418)
[S4] loaded HEAD from S14 (vec_in norm=1.335418)
[S4] cosine check vs S14: cos=0.6426
[S4] BUFFERED delta from S14 (total buffered=1)
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.027943)
[S9] loaded HEAD from S17 (vec_in norm=2.027943)
[S9] cosine check vs S17: cos=-0.0603
[S9] DROPPED delta from S17 (cos=-0.0603 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.5724 head_norm=1.185529
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.682228e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.5869 head_norm=1.083728 delta_norm=0.268223
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9453 head_norm=1.261441
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.498925e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9453 head_norm=1.176820 delta_norm=0.549892
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9940 head_norm=1.335418
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.286997e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9865 head_norm=1.460808 delta_norm=0.928700
[S14] aggregate: ROLLBACK (f1_val pre=0.994 post=0.986 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9922 head_norm=1.272032
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.115669e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9922 head_norm=1.417083 delta_norm=0.911567
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=2.014966 (no previous merge yet)
[S2] round=24 local utility u=0.319840 metrics={'f1_val': 0.7103773667660109, 'auprc': 0.8601209104544983, 'loss_val': 0.4927180990083784, 'psi': 0.7702747842414059}-{'f1_val': 0.7128247714112594, 'auprc': 0.6948849326699957, 'loss_val': 0.6513748966966375, 'psi': 0.7056488359147539}
[S3] START round=24 head_norm_before_train=1.739085 (no previous merge yet)
[S3] round=24 local utility u=0.538978 metrics={'f1_val': 0.8691165958439059, 'auprc': 0.9954677589204508, 'loss_val': 0.25890877771292503, 'psi': 0.9196570610745238}-{'f1_val': 0.7007562037352997, 'auprc': 0.9878347938086655, 'loss_val': 0.3038026446097583, 'psi': 0.815587639764646}
[S4] START round=24 head_norm_before_train=1.176820 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9404493830294913, 'auprc': 0.956501848223851, 'loss_val': 0.31900711797562886, 'psi': 0.9468703691072352}-{'f1_val': 0.9453000040037774, 'auprc': 0.9638393493781268, 'loss_val': 0.30373540099975566, 'psi': 0.9527157421535171}
[S5] START round=24 head_norm_before_train=1.467166 cos_to_last_merge=0.8093 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.6211600246243699, 'auprc': 0.8347347957770846, 'loss_val': 0.46830161804530124, 'psi': 0.7065899330854558}-{'f1_val': 0.6941579017915613, 'auprc': 0.9032695644943911, 'loss_val': 0.32608929063289777, 'psi': 0.7778025668726932}
[S6] START round=24 head_norm_before_train=1.673423 cos_to_last_merge=0.8591 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.859
[S6] round=24 local utility u=0.010956 metrics={'f1_val': 0.6950829938802379, 'auprc': 0.9449335663524988, 'loss_val': 0.7509089807161773, 'psi': 0.7950232228691423}-{'f1_val': 0.6940028253201586, 'auprc': 0.9331997069628406, 'loss_val': 0.7311375864940739, 'psi': 0.7896815779772314}
[S7] START round=24 head_norm_before_train=1.602369 (no previous merge yet)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5266569485976431, 'auprc': 0.7831388200654326, 'loss_val': 0.8196378675632539, 'psi': 0.629249697184759}-{'f1_val': 0.5890398650830477, 'auprc': 0.792898990931572, 'loss_val': 0.6444921555510591, 'psi': 0.6705835154224574}
[S8] START round=24 head_norm_before_train=1.417083 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.9846116827651852, 'loss_val': 0.21069968015505497, 'psi': 0.9898256554215095}-{'f1_val': 0.9922069265978078, 'auprc': 0.9977014459410082, 'loss_val': 0.13353289350324463, 'psi': 0.994404734335088}
[S9] START round=24 head_norm_before_train=1.042757 cos_to_last_merge=0.9976 (last merge round=22)
[S9] round=24 local utility u=0.034968 metrics={'f1_val': 0.9947496160742828, 'auprc': 0.9953189917380811, 'loss_val': 0.1452064733557237, 'psi': 0.9949773663398022}-{'f1_val': 0.9897071435092063, 'auprc': 0.9983264935755654, 'loss_val': 0.1939102963566983, 'psi': 0.9931548835357499}
[S10] START round=24 head_norm_before_train=2.051718 (no previous merge yet)
[S10] round=24 local utility u=0.004818 metrics={'f1_val': 0.9953300781987324, 'auprc': 0.9927048087540533, 'loss_val': 0.03285836296997836, 'psi': 0.9942799704208607}-{'f1_val': 0.9932136491405474, 'auprc': 0.9943284619778747, 'loss_val': 0.034666695170456195, 'psi': 0.9936595742754784}
[S11] START round=24 head_norm_before_train=1.689041 cos_to_last_merge=0.9996 (last merge round=22)
[S11] round=24 local utility u=0.677953 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9969688094241949, 'loss_val': 0.09684899364779867, 'psi': 0.9965706242509945}-{'f1_val': 0.8128321725333789, 'auprc': 0.9922879991584209, 'loss_val': 0.337874804999414, 'psi': 0.8846145031833957}
[S13] START round=24 head_norm_before_train=1.083728 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.556153538224423, 'auprc': 0.6148440014106554, 'loss_val': 0.8567880314780004, 'psi': 0.5796297234989161}-{'f1_val': 0.5724069398129258, 'auprc': 0.6565326125313833, 'loss_val': 0.7570752745845193, 'psi': 0.6060572089003088}
[S14] START round=24 head_norm_before_train=1.460808 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.970561804110174, 'auprc': 0.9983685996019448, 'loss_val': 0.4690447657703133, 'psi': 0.9816845223068823}-{'f1_val': 0.993997682923919, 'auprc': 0.9900627194009025, 'loss_val': 0.442764681852441, 'psi': 0.9924236975147124}
[S15] START round=24 head_norm_before_train=2.027834 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.8364792265595015, 'auprc': 0.9903616190413755, 'loss_val': 0.21747999517497768, 'psi': 0.8980321835522511}-{'f1_val': 0.8412060140766939, 'auprc': 0.9870619009572671, 'loss_val': 0.1829285913661077, 'psi': 0.8995483688289232}
[S16] START round=24 head_norm_before_train=1.224354 cos_to_last_merge=0.9970 (last merge round=22)
[S16] round=24 local utility u=0.648423 metrics={'f1_val': 0.9918237085799078, 'auprc': 0.9881827927590681, 'loss_val': 0.2476223011751432, 'psi': 0.9903673422515719}-{'f1_val': 0.8429773617848247, 'auprc': 0.9642050009723204, 'loss_val': 0.5794577803472698, 'psi': 0.891468417459823}
[S17] START round=24 head_norm_before_train=2.027943 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.5836380734280333, 'auprc': 0.7742245666746913, 'loss_val': 1.4153772067105577, 'psi': 0.6598726707266965}-{'f1_val': 0.6319896235089002, 'auprc': 0.8788385292069223, 'loss_val': 0.9676457886234368, 'psi': 0.7307291857881091}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] → sending delta(kind=head bytes=1807) to S11@127.0.0.1:40412
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:40409
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1807 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.281907)
[S8] loaded HEAD from S16 (vec_in norm=1.281907)
[S8] cosine check vs S16: cos=0.5364
[S8] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=2.030162)
[S8] loaded HEAD from S2 (vec_in norm=2.030162)
[S8] cosine check vs S2: cos=0.8841
[S8] BUFFERED delta from S2 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.755370)
[S4] loaded HEAD from S3 (vec_in norm=1.755370)
[S4] cosine check vs S3: cos=0.4539
[S4] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.716154)
[S14] loaded HEAD from S11 (vec_in norm=1.716154)
[S14] cosine check vs S11: cos=0.4120
[S14] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.069288)
[S14] loaded HEAD from S10 (vec_in norm=2.069288)
[S14] cosine check vs S10: cos=0.9116
[S14] BUFFERED delta from S10 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1804) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.097455)
[S13] loaded HEAD from S9 (vec_in norm=1.097455)
[S13] cosine check vs S9: cos=0.9338
[S13] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1807) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.687596)
[S11] loaded HEAD from S6 (vec_in norm=1.687596)
[S11] cosine check vs S6: cos=0.9947
[S11] BUFFERED delta from S6 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9404 head_norm=1.245204
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.135524e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9401 head_norm=1.286103 delta_norm=0.813552
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.5562 head_norm=1.163805
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.082253e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.5652 head_norm=1.111785 delta_norm=0.208225
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9933 head_norm=1.481583
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.013256e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9933 head_norm=1.370950 delta_norm=0.201326
[S8] aggregate: ACCEPT kept=['S16', 'S2'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9706 head_norm=1.471535
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.024354e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9755 head_norm=1.396107 delta_norm=0.202435
[S14] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9963 head_norm=1.716154
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.879564e-02
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9963 head_norm=1.699617 delta_norm=0.088796
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=2.030162 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6302076747269332, 'auprc': 0.7804858159922861, 'loss_val': 1.0265793077892114, 'psi': 0.6903189312330744}-{'f1_val': 0.7103773667660109, 'auprc': 0.8601209104544983, 'loss_val': 0.4927180990083784, 'psi': 0.7702747842414059}
[S3] START round=25 head_norm_before_train=1.755370 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9959041565261636, 'loss_val': 0.2405789225050016, 'psi': 0.8188607036257518}-{'f1_val': 0.8691165958439059, 'auprc': 0.9954677589204508, 'loss_val': 0.25890877771292503, 'psi': 0.9196570610745238}
[S4] START round=25 head_norm_before_train=1.286103 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.022835 metrics={'f1_val': 0.9423046868669839, 'auprc': 0.9652761282730099, 'loss_val': 0.3107924382760674, 'psi': 0.9514932634293942}-{'f1_val': 0.9404493830294913, 'auprc': 0.956501848223851, 'loss_val': 0.31900711797562886, 'psi': 0.9468703691072352}
[S5] START round=25 head_norm_before_train=1.484118 cos_to_last_merge=0.8085 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.808
[S5] round=25 local utility u=0.535869 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9721784594851656, 'loss_val': 0.28558385351944665, 'psi': 0.8092364193916708}-{'f1_val': 0.6211600246243699, 'auprc': 0.8347347957770846, 'loss_val': 0.46830161804530124, 'psi': 0.7065899330854558}
[S6] START round=25 head_norm_before_train=1.687596 cos_to_last_merge=0.8577 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.858
[S6] round=25 local utility u=1.000000 metrics={'f1_val': 0.9744676228775406, 'auprc': 0.9651371191981568, 'loss_val': 0.1757495855081854, 'psi': 0.9707354214057871}-{'f1_val': 0.6950829938802379, 'auprc': 0.9449335663524988, 'loss_val': 0.7509089807161773, 'psi': 0.7950232228691423}
[S7] START round=25 head_norm_before_train=1.615333 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.48340224579611546, 'auprc': 0.7813497072015037, 'loss_val': 0.9646684656372131, 'psi': 0.6025812303582707}-{'f1_val': 0.5266569485976431, 'auprc': 0.7831388200654326, 'loss_val': 0.8196378675632539, 'psi': 0.629249697184759}
[S8] START round=25 head_norm_before_train=1.370950 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.037629 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9941467230941187, 'loss_val': 0.15946538676755084, 'psi': 0.9931815239869486}-{'f1_val': 0.9933016371923923, 'auprc': 0.9846116827651852, 'loss_val': 0.21069968015505497, 'psi': 0.9898256554215095}
[S9] START round=25 head_norm_before_train=1.097455 cos_to_last_merge=0.9923 (last merge round=22)
[S9] round=25 local utility u=0.018880 metrics={'f1_val': 0.9958312226609984, 'auprc': 0.9949430106438466, 'loss_val': 0.11280886500469763, 'psi': 0.9954759378541377}-{'f1_val': 0.9947496160742828, 'auprc': 0.9953189917380811, 'loss_val': 0.1452064733557237, 'psi': 0.9949773663398022}
[S10] START round=25 head_norm_before_train=2.069288 (no previous merge yet)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9944916649516913, 'auprc': 0.9911086304954333, 'loss_val': 0.0345788914455287, 'psi': 0.9931384511691881}-{'f1_val': 0.9953300781987324, 'auprc': 0.9927048087540533, 'loss_val': 0.03285836296997836, 'psi': 0.9942799704208607}
[S11] START round=25 head_norm_before_train=1.699617 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9543534678276615, 'auprc': 0.9975904340061852, 'loss_val': 0.1519192059701331, 'psi': 0.971648254299071}-{'f1_val': 0.996305167468861, 'auprc': 0.9969688094241949, 'loss_val': 0.09684899364779867, 'psi': 0.9965706242509945}
[S13] START round=25 head_norm_before_train=1.111785 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.320503 metrics={'f1_val': 0.5962921808290751, 'auprc': 0.7088774320179319, 'loss_val': 0.7387135805759997, 'psi': 0.6413262813046178}-{'f1_val': 0.556153538224423, 'auprc': 0.6148440014106554, 'loss_val': 0.8567880314780004, 'psi': 0.5796297234989161}
[S14] START round=25 head_norm_before_train=1.396107 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9499011634628579, 'auprc': 0.955702120659031, 'loss_val': 0.5157266176319224, 'psi': 0.9522215463413272}-{'f1_val': 0.970561804110174, 'auprc': 0.9983685996019448, 'loss_val': 0.4690447657703133, 'psi': 0.9816845223068823}
[S15] START round=25 head_norm_before_train=2.044123 (no previous merge yet)
[S15] round=25 local utility u=0.181129 metrics={'f1_val': 0.8873532274310558, 'auprc': 0.9951115284033267, 'loss_val': 0.17471563825859285, 'psi': 0.9304565478199642}-{'f1_val': 0.8364792265595015, 'auprc': 0.9903616190413755, 'loss_val': 0.21747999517497768, 'psi': 0.8980321835522511}
[S16] START round=25 head_norm_before_train=1.281907 cos_to_last_merge=0.9899 (last merge round=22)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9129438410249795, 'auprc': 0.9897363374085255, 'loss_val': 0.3460818719375527, 'psi': 0.9436608395783979}-{'f1_val': 0.9918237085799078, 'auprc': 0.9881827927590681, 'loss_val': 0.2476223011751432, 'psi': 0.9903673422515719}
[S17] START round=25 head_norm_before_train=2.035036 (no previous merge yet)
[S17] round=25 local utility u=0.060251 metrics={'f1_val': 0.5897371997355616, 'auprc': 0.7761508923897112, 'loss_val': 1.3372491196231393, 'psi': 0.6643026767972215}-{'f1_val': 0.5836380734280333, 'auprc': 0.7742245666746913, 'loss_val': 1.4153772067105577, 'psi': 0.6598726707266965}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:40416
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:40413
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=2.062180)
[S16] loaded HEAD from S15 (vec_in norm=2.062180)
[S16] cosine check vs S15: cos=-0.0957
[S16] DROPPED delta from S15 (cos=-0.0957 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.194203)
[S16] loaded HEAD from S13 (vec_in norm=1.194203)
[S16] cosine check vs S13: cos=0.8028
[S16] BUFFERED delta from S13 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.699493)
[S11] loaded HEAD from S6 (vec_in norm=1.699493)
[S11] cosine check vs S6: cos=0.9970
[S11] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.502563)
[S9] loaded HEAD from S5 (vec_in norm=1.502563)
[S9] cosine check vs S5: cos=0.5108
[S9] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.347640)
[S9] loaded HEAD from S4 (vec_in norm=1.347640)
[S9] cosine check vs S4: cos=0.7715
[S9] BUFFERED delta from S4 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1803) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.145831)
[S13] loaded HEAD from S9 (vec_in norm=1.145831)
[S13] cosine check vs S9: cos=0.9506
[S13] BUFFERED delta from S9 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1806) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.460594)
[S17] loaded HEAD from S8 (vec_in norm=1.460594)
[S17] cosine check vs S8: cos=-0.1076
[S17] DROPPED delta from S8 (cos=-0.1076 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.042026)
[S9] loaded HEAD from S17 (vec_in norm=2.042026)
[S9] cosine check vs S17: cos=-0.0558
[S9] DROPPED delta from S17 (cos=-0.0558 < 0.0)
[S14] ⇄ pheromone p=0.152 → S4@127.0.0.1:40404
[S7] ⇄ pheromone p=0.108 → S10@127.0.0.1:40411
[S3] ⇄ pheromone p=0.152 → S4@127.0.0.1:40404
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9544 head_norm=1.725120
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.765670e-02
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9541 head_norm=1.711017 delta_norm=0.067657
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.180 → S14@127.0.0.1:40414
[S2] ⇄ pheromone p=0.130 → S8@127.0.0.1:40409
[S10] ⇄ pheromone p=0.017 → S14@127.0.0.1:40414
[S15] ⇄ pheromone p=0.257 → S16@127.0.0.1:40416
[S5] ⇄ pheromone p=0.262 → S9@127.0.0.1:40410
[S4] ⇄ pheromone p=0.029 → S9@127.0.0.1:40410
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9958 head_norm=1.145831
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.511918e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9958 head_norm=1.048077 delta_norm=0.251192
[S9] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.068 → S13@127.0.0.1:40413
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.5963 head_norm=1.194203
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.853600e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.5856 head_norm=1.155494 delta_norm=0.185360
[S13] aggregate: ROLLBACK (f1_val pre=0.596 post=0.586 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.117 → S16@127.0.0.1:40416
[S6] ⇄ pheromone p=0.312 → S11@127.0.0.1:40412
[S8] ⇄ pheromone p=0.055 → S17@127.0.0.1:40417
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9129 head_norm=1.336621
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.030912e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.8915 head_norm=1.201606 delta_norm=0.403091
[S16] aggregate: ROLLBACK (f1_val pre=0.913 post=0.891 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.219 → S8@127.0.0.1:40409
[S17] ⇄ pheromone p=0.230 → S9@127.0.0.1:40410
[S2] START round=26 head_norm_before_train=2.046859 (no previous merge yet)
[S2] round=26 local utility u=0.602572 metrics={'f1_val': 0.7103773667660109, 'auprc': 0.863088592288136, 'loss_val': 0.5502613852301451, 'psi': 0.7714618569748609}-{'f1_val': 0.6302076747269332, 'auprc': 0.7804858159922861, 'loss_val': 1.0265793077892114, 'psi': 0.6903189312330744}
[S3] START round=26 head_norm_before_train=1.774343 (no previous merge yet)
[S3] round=26 local utility u=0.572307 metrics={'f1_val': 0.8859063822061917, 'auprc': 0.9984691715145158, 'loss_val': 0.21410723835201012, 'psi': 0.9309314979295213}-{'f1_val': 0.7008317350254774, 'auprc': 0.9959041565261636, 'loss_val': 0.2405789225050016, 'psi': 0.8188607036257518}
[S4] START round=26 head_norm_before_train=1.347640 cos_to_last_merge=0.9974 (last merge round=24)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9411992638371691, 'auprc': 0.9430804450352248, 'loss_val': 0.292741565433179, 'psi': 0.9419517363163914}-{'f1_val': 0.9423046868669839, 'auprc': 0.9652761282730099, 'loss_val': 0.3107924382760674, 'psi': 0.9514932634293942}
[S5] START round=26 head_norm_before_train=1.502563 cos_to_last_merge=0.8062 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.806
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9504543873061111, 'loss_val': 0.2968246764474192, 'psi': 0.800546790520049}-{'f1_val': 0.7006083926626743, 'auprc': 0.9721784594851656, 'loss_val': 0.28558385351944665, 'psi': 0.8092364193916708}
[S6] START round=26 head_norm_before_train=1.699493 cos_to_last_merge=0.8571 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.857
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.8382859983244964, 'auprc': 0.9474362006268215, 'loss_val': 0.4387712707011527, 'psi': 0.8819460792454265}-{'f1_val': 0.9744676228775406, 'auprc': 0.9651371191981568, 'loss_val': 0.1757495855081854, 'psi': 0.9707354214057871}
[S7] START round=26 head_norm_before_train=1.631485 (no previous merge yet)
[S7] round=26 local utility u=1.000000 metrics={'f1_val': 0.6855782707980083, 'auprc': 0.8456727969774122, 'loss_val': 0.3623472203727774, 'psi': 0.7496160812697699}-{'f1_val': 0.48340224579611546, 'auprc': 0.7813497072015037, 'loss_val': 0.9646684656372131, 'psi': 0.6025812303582707}
[S8] START round=26 head_norm_before_train=1.460594 cos_to_last_merge=0.9928 (last merge round=24)
[S8] round=26 local utility u=0.025573 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.988075645834907, 'loss_val': 0.09347229989528211, 'psi': 0.9910896874561828}-{'f1_val': 0.9925380579155019, 'auprc': 0.9941467230941187, 'loss_val': 0.15946538676755084, 'psi': 0.9931815239869486}
[S9] START round=26 head_norm_before_train=1.048077 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9947879706195867, 'loss_val': 0.13509770644339417, 'psi': 0.9956628572273661}-{'f1_val': 0.9958312226609984, 'auprc': 0.9949430106438466, 'loss_val': 0.11280886500469763, 'psi': 0.9954759378541377}
[S10] START round=26 head_norm_before_train=2.077149 (no previous merge yet)
[S10] round=26 local utility u=0.001510 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9917242534310496, 'loss_val': 0.03259453053646975, 'psi': 0.9933035403994727}-{'f1_val': 0.9944916649516913, 'auprc': 0.9911086304954333, 'loss_val': 0.0345788914455287, 'psi': 0.9931384511691881}
[S11] START round=26 head_norm_before_train=1.711017 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.150680 metrics={'f1_val': 0.9952922001172275, 'auprc': 0.9973140923814341, 'loss_val': 0.095361960549696, 'psi': 0.9961009570229101}-{'f1_val': 0.9543534678276615, 'auprc': 0.9975904340061852, 'loss_val': 0.1519192059701331, 'psi': 0.971648254299071}
[S13] START round=26 head_norm_before_train=1.155494 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5866040813102358, 'auprc': 0.6324611322973279, 'loss_val': 0.7944831278582303, 'psi': 0.6049469017050726}-{'f1_val': 0.5962921808290751, 'auprc': 0.7088774320179319, 'loss_val': 0.7387135805759997, 'psi': 0.6413262813046178}
[S14] START round=26 head_norm_before_train=1.408094 cos_to_last_merge=0.9997 (last merge round=24)
[S14] round=26 local utility u=0.262983 metrics={'f1_val': 0.9945940655489556, 'auprc': 0.9968905640211876, 'loss_val': 0.38148242530756526, 'psi': 0.9955126649378483}-{'f1_val': 0.9499011634628579, 'auprc': 0.955702120659031, 'loss_val': 0.5157266176319224, 'psi': 0.9522215463413272}
[S15] START round=26 head_norm_before_train=2.062180 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.8009684240295691, 'auprc': 0.9882057285203018, 'loss_val': 0.3729672812918349, 'psi': 0.8758633458258622}-{'f1_val': 0.8873532274310558, 'auprc': 0.9951115284033267, 'loss_val': 0.17471563825859285, 'psi': 0.9304565478199642}
[S16] START round=26 head_norm_before_train=1.201606 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.069764 metrics={'f1_val': 0.9389265071117165, 'auprc': 0.989143784021392, 'loss_val': 0.3606713738733024, 'psi': 0.9590134178755867}-{'f1_val': 0.9129438410249795, 'auprc': 0.9897363374085255, 'loss_val': 0.3460818719375527, 'psi': 0.9436608395783979}
[S17] START round=26 head_norm_before_train=2.042026 (no previous merge yet)
[S17] round=26 local utility u=0.165265 metrics={'f1_val': 0.5759569416177831, 'auprc': 0.9237911464725461, 'loss_val': 1.36695882410971, 'psi': 0.7150906235596883}-{'f1_val': 0.5897371997355616, 'auprc': 0.7761508923897112, 'loss_val': 1.3372491196231393, 'psi': 0.6643026767972215}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:40412
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:40407
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.735126)
[S6] loaded HEAD from S11 (vec_in norm=1.735126)
[S6] cosine check vs S11: cos=0.9980
[S6] BUFFERED delta from S11 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.089892)
[S7] loaded HEAD from S10 (vec_in norm=2.089892)
[S7] cosine check vs S10: cos=-0.1114
[S7] DROPPED delta from S10 (cos=-0.1114 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1804) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.426247)
[S11] loaded HEAD from S14 (vec_in norm=1.426247)
[S11] cosine check vs S14: cos=0.5298
[S11] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1805) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.554750)
[S16] loaded HEAD from S8 (vec_in norm=1.554750)
[S16] cosine check vs S8: cos=0.6320
[S16] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:40415
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.245471)
[S15] loaded HEAD from S16 (vec_in norm=1.245471)
[S15] cosine check vs S16: cos=-0.1004
[S15] DROPPED delta from S16 (cos=-0.1004 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.049324)
[S8] loaded HEAD from S17 (vec_in norm=2.049324)
[S8] cosine check vs S17: cos=-0.1107
[S8] DROPPED delta from S17 (cos=-0.1107 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.8383 head_norm=1.706468
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.649723e-02
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.8377 head_norm=1.719929 delta_norm=0.056497
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9953 head_norm=1.735126
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.782361e-01
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9945 head_norm=1.384475 delta_norm=0.778236
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.9389 head_norm=1.245471
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.166295e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.9888 head_norm=1.266488 delta_norm=0.616629
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=2.062162 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.7092857552742803, 'auprc': 0.7742470064823048, 'loss_val': 0.5114168355978391, 'psi': 0.7352702557574902}-{'f1_val': 0.7103773667660109, 'auprc': 0.863088592288136, 'loss_val': 0.5502613852301451, 'psi': 0.7714618569748609}
[S3] START round=27 head_norm_before_train=1.795120 (no previous merge yet)
[S3] round=27 local utility u=0.301350 metrics={'f1_val': 0.9726791673753279, 'auprc': 0.998470000321627, 'loss_val': 0.13204624546808807, 'psi': 0.9829955005538475}-{'f1_val': 0.8859063822061917, 'auprc': 0.9984691715145158, 'loss_val': 0.21410723835201012, 'psi': 0.9309314979295213}
[S4] START round=27 head_norm_before_train=1.414716 cos_to_last_merge=0.9906 (last merge round=24)
[S4] round=27 local utility u=0.074426 metrics={'f1_val': 0.9473271933052624, 'auprc': 0.9748296817565827, 'loss_val': 0.275905247044748, 'psi': 0.9583281886857905}-{'f1_val': 0.9411992638371691, 'auprc': 0.9430804450352248, 'loss_val': 0.292741565433179, 'psi': 0.9419517363163914}
[S5] START round=27 head_norm_before_train=1.516617 cos_to_last_merge=0.8038 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.804
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.6205852352129706, 'auprc': 0.8511167599836468, 'loss_val': 0.4777680073719599, 'psi': 0.7127978451212411}-{'f1_val': 0.7006083926626743, 'auprc': 0.9504543873061111, 'loss_val': 0.2968246764474192, 'psi': 0.800546790520049}
[S6] START round=27 head_norm_before_train=1.719929 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.681549075764579, 'auprc': 0.9353314699629035, 'loss_val': 0.8733825565508201, 'psi': 0.7830620334439088}-{'f1_val': 0.8382859983244964, 'auprc': 0.9474362006268215, 'loss_val': 0.4387712707011527, 'psi': 0.8819460792454265}
[S7] START round=27 head_norm_before_train=1.647796 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5692078982709383, 'auprc': 0.7903270399452065, 'loss_val': 0.8241674227271266, 'psi': 0.6576555549406455}-{'f1_val': 0.6855782707980083, 'auprc': 0.8456727969774122, 'loss_val': 0.3623472203727774, 'psi': 0.7496160812697699}
[S8] START round=27 head_norm_before_train=1.554750 cos_to_last_merge=0.9786 (last merge round=24)
[S8] round=27 local utility u=0.025400 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9980459848998787, 'loss_val': 0.06722961446883063, 'psi': 0.9945425499186362}-{'f1_val': 0.9930990485370332, 'auprc': 0.988075645834907, 'loss_val': 0.09347229989528211, 'psi': 0.9910896874561828}
[S9] START round=27 head_norm_before_train=1.088672 cos_to_last_merge=0.9991 (last merge round=25)
[S9] round=27 local utility u=0.000865 metrics={'f1_val': 0.9929129041106395, 'auprc': 0.995606581819785, 'loss_val': 0.11582434257977017, 'psi': 0.9939903751942977}-{'f1_val': 0.9962461149658858, 'auprc': 0.9947879706195867, 'loss_val': 0.13509770644339417, 'psi': 0.9956628572273661}
[S10] START round=27 head_norm_before_train=2.089892 (no previous merge yet)
[S10] round=27 local utility u=0.001420 metrics={'f1_val': 0.9945528553774142, 'auprc': 0.9917921335924711, 'loss_val': 0.031136471954130364, 'psi': 0.993448566663437}-{'f1_val': 0.9943563983784213, 'auprc': 0.9917242534310496, 'loss_val': 0.03259453053646975, 'psi': 0.9933035403994727}
[S11] START round=27 head_norm_before_train=1.384475 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9942939692136104, 'loss_val': 0.13473005924634837, 'psi': 0.9956457903935979}-{'f1_val': 0.9952922001172275, 'auprc': 0.9973140923814341, 'loss_val': 0.095361960549696, 'psi': 0.9961009570229101}
[S13] START round=27 head_norm_before_train=1.210781 cos_to_last_merge=0.9960 (last merge round=25)
[S13] round=27 local utility u=0.220925 metrics={'f1_val': 0.6117485086647882, 'auprc': 0.720575875864112, 'loss_val': 0.7678443766364231, 'psi': 0.6552794555445178}-{'f1_val': 0.5866040813102358, 'auprc': 0.6324611322973279, 'loss_val': 0.7944831278582303, 'psi': 0.6049469017050726}
[S14] START round=27 head_norm_before_train=1.426247 cos_to_last_merge=0.9986 (last merge round=24)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9914875158007045, 'auprc': 0.996508892583802, 'loss_val': 0.37712124948478054, 'psi': 0.9934960665139436}-{'f1_val': 0.9945940655489556, 'auprc': 0.9968905640211876, 'loss_val': 0.38148242530756526, 'psi': 0.9955126649378483}
[S15] START round=27 head_norm_before_train=2.077566 (no previous merge yet)
[S15] round=27 local utility u=0.627793 metrics={'f1_val': 0.9571127540460899, 'auprc': 0.9940123097758986, 'loss_val': 0.0716680047486937, 'psi': 0.9718725763380134}-{'f1_val': 0.8009684240295691, 'auprc': 0.9882057285203018, 'loss_val': 0.3729672812918349, 'psi': 0.8758633458258622}
[S16] START round=27 head_norm_before_train=1.266488 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.214862 metrics={'f1_val': 0.9899231233174718, 'auprc': 0.9909758380045248, 'loss_val': 0.24242296999093096, 'psi': 0.9903442091922929}-{'f1_val': 0.9389265071117165, 'auprc': 0.989143784021392, 'loss_val': 0.3606713738733024, 'psi': 0.9590134178755867}
[S17] START round=27 head_norm_before_train=2.049324 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.2643100225625527, 'auprc': 0.5974839161421005, 'loss_val': 2.411099389519435, 'psi': 0.3975795799943719}-{'f1_val': 0.5759569416177831, 'auprc': 0.9237911464725461, 'loss_val': 1.36695882410971, 'psi': 0.7150906235596883}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:40415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:40408
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:40405
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:40403
[S13] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.627063)
[S16] loaded HEAD from S8 (vec_in norm=1.627063)
[S16] cosine check vs S8: cos=0.9187
[S16] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.103063)
[S7] loaded HEAD from S10 (vec_in norm=2.103063)
[S7] cosine check vs S10: cos=-0.1118
[S7] DROPPED delta from S10 (cos=-0.1118 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.315220)
[S15] loaded HEAD from S16 (vec_in norm=1.315220)
[S15] cosine check vs S16: cos=-0.0814
[S15] DROPPED delta from S16 (cos=-0.0814 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.128467)
[S5] loaded HEAD from S9 (vec_in norm=1.128467)
[S5] cosine check vs S9: cos=0.6256
[S5] BUFFERED delta from S9 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S4
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.467314)
[S3] loaded HEAD from S4 (vec_in norm=1.467314)
[S3] cosine check vs S4: cos=0.8504
[S3] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1791) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.284606)
[S9] loaded HEAD from S13 (vec_in norm=1.284606)
[S9] cosine check vs S13: cos=0.9290
[S9] BUFFERED delta from S13 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.9727 head_norm=1.816332
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.793982e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.9523 head_norm=1.579941 delta_norm=0.479398
[S3] aggregate: ROLLBACK (f1_val pre=0.973 post=0.952 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.6206 head_norm=1.531320
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.033515e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.6223 head_norm=1.202147 delta_norm=0.603351
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9929 head_norm=1.128467
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.399112e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9929 head_norm=1.185018 delta_norm=0.239911
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9899 head_norm=1.315220
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.335483e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9888 head_norm=1.441289 delta_norm=0.333548
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=2.076936 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7074668983219099, 'auprc': 0.7972811942470879, 'loss_val': 0.5892595986921925, 'psi': 0.7433926166919811}-{'f1_val': 0.7092857552742803, 'auprc': 0.7742470064823048, 'loss_val': 0.5114168355978391, 'psi': 0.7352702557574902}
[S3] START round=28 head_norm_before_train=1.579941 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.046752 metrics={'f1_val': 0.9834700229051168, 'auprc': 0.9976909496210886, 'loss_val': 0.10094988740382632, 'psi': 0.9891583935915055}-{'f1_val': 0.9726791673753279, 'auprc': 0.998470000321627, 'loss_val': 0.13204624546808807, 'psi': 0.9829955005538475}
[S4] START round=28 head_norm_before_train=1.467314 cos_to_last_merge=0.9841 (last merge round=24)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9411926078240542, 'auprc': 0.9645652454383894, 'loss_val': 0.28813644611577316, 'psi': 0.9505416628697883}-{'f1_val': 0.9473271933052624, 'auprc': 0.9748296817565827, 'loss_val': 0.275905247044748, 'psi': 0.9583281886857905}
[S5] START round=28 head_norm_before_train=1.202147 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.339227 metrics={'f1_val': 0.6718185236806624, 'auprc': 0.9312542358327768, 'loss_val': 0.34712675367810714, 'psi': 0.7755928085415082}-{'f1_val': 0.6205852352129706, 'auprc': 0.8511167599836468, 'loss_val': 0.4777680073719599, 'psi': 0.7127978451212411}
[S6] START round=28 head_norm_before_train=1.728991 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=28 local utility u=0.335074 metrics={'f1_val': 0.7581623426098811, 'auprc': 0.9440072431823986, 'loss_val': 0.6889413611223489, 'psi': 0.8325003028388882}-{'f1_val': 0.681549075764579, 'auprc': 0.9353314699629035, 'loss_val': 0.8733825565508201, 'psi': 0.7830620334439088}
[S7] START round=28 head_norm_before_train=1.657012 (no previous merge yet)
[S7] round=28 local utility u=0.225341 metrics={'f1_val': 0.6120886783438055, 'auprc': 0.7995247776870686, 'loss_val': 0.6583625057719318, 'psi': 0.6870631180811109}-{'f1_val': 0.5692078982709383, 'auprc': 0.7903270399452065, 'loss_val': 0.8241674227271266, 'psi': 0.6576555549406455}
[S8] START round=28 head_norm_before_train=1.627063 cos_to_last_merge=0.9668 (last merge round=24)
[S8] round=28 local utility u=0.005923 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9980548534125162, 'loss_val': 0.05541063161254272, 'psi': 0.9945460973236913}-{'f1_val': 0.9922069265978078, 'auprc': 0.9980459848998787, 'loss_val': 0.06722961446883063, 'psi': 0.9945425499186362}
[S9] START round=28 head_norm_before_train=1.185018 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.021110 metrics={'f1_val': 0.9958312226609984, 'auprc': 0.993698118603563, 'loss_val': 0.08538901622342791, 'psi': 0.9949779810380243}-{'f1_val': 0.9929129041106395, 'auprc': 0.995606581819785, 'loss_val': 0.11582434257977017, 'psi': 0.9939903751942977}
[S10] START round=28 head_norm_before_train=2.103063 (no previous merge yet)
[S10] round=28 local utility u=0.002355 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9931061512075362, 'loss_val': 0.030226541329613336, 'psi': 0.9939599245620511}-{'f1_val': 0.9945528553774142, 'auprc': 0.9917921335924711, 'loss_val': 0.031136471954130364, 'psi': 0.993448566663437}
[S11] START round=28 head_norm_before_train=1.416606 cos_to_last_merge=0.9995 (last merge round=26)
[S11] round=28 local utility u=0.001645 metrics={'f1_val': 0.9954312449678927, 'auprc': 0.9939411521925631, 'loss_val': 0.12368615258558234, 'psi': 0.9948352078577608}-{'f1_val': 0.9965470045135896, 'auprc': 0.9942939692136104, 'loss_val': 0.13473005924634837, 'psi': 0.9956457903935979}
[S13] START round=28 head_norm_before_train=1.284606 cos_to_last_merge=0.9855 (last merge round=25)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6100864507301499, 'auprc': 0.6105334038249035, 'loss_val': 0.9050915105163228, 'psi': 0.6102652319680513}-{'f1_val': 0.6117485086647882, 'auprc': 0.720575875864112, 'loss_val': 0.7678443766364231, 'psi': 0.6552794555445178}
[S14] START round=28 head_norm_before_train=1.452382 cos_to_last_merge=0.9964 (last merge round=24)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9475153123710529, 'auprc': 0.9988487713319014, 'loss_val': 0.32757074791464874, 'psi': 0.9680486959553922}-{'f1_val': 0.9914875158007045, 'auprc': 0.996508892583802, 'loss_val': 0.37712124948478054, 'psi': 0.9934960665139436}
[S15] START round=28 head_norm_before_train=2.093996 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7010713433702593, 'auprc': 0.8885790773198878, 'loss_val': 0.6408064124455626, 'psi': 0.7760744369501107}-{'f1_val': 0.9571127540460899, 'auprc': 0.9940123097758986, 'loss_val': 0.0716680047486937, 'psi': 0.9718725763380134}
[S16] START round=28 head_norm_before_train=1.441289 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9709069143454078, 'auprc': 0.9872102788538508, 'loss_val': 0.22831129677622555, 'psi': 0.977428260148785}-{'f1_val': 0.9899231233174718, 'auprc': 0.9909758380045248, 'loss_val': 0.24242296999093096, 'psi': 0.9903442091922929}
[S17] START round=28 head_norm_before_train=2.056915 (no previous merge yet)
[S17] round=28 local utility u=1.000000 metrics={'f1_val': 0.5953695883607107, 'auprc': 0.9676888041771132, 'loss_val': 1.0937813257929414, 'psi': 0.7442972746872718}-{'f1_val': 0.2643100225625527, 'auprc': 0.5974839161421005, 'loss_val': 2.411099389519435, 'psi': 0.3975795799943719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:40405
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:40407
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:40409
[S11] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.457778)
[S6] loaded HEAD from S11 (vec_in norm=1.457778)
[S6] cosine check vs S11: cos=0.8989
[S6] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.677583)
[S16] loaded HEAD from S8 (vec_in norm=1.677583)
[S16] cosine check vs S8: cos=0.9770
[S16] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.112273)
[S7] loaded HEAD from S10 (vec_in norm=2.112273)
[S7] cosine check vs S10: cos=-0.1124
[S7] DROPPED delta from S10 (cos=-0.1124 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.223617)
[S5] loaded HEAD from S9 (vec_in norm=1.223617)
[S5] cosine check vs S9: cos=0.8033
[S5] BUFFERED delta from S9 (total buffered=1)
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.064806)
[S8] loaded HEAD from S17 (vec_in norm=2.064806)
[S8] cosine check vs S17: cos=-0.1158
[S8] DROPPED delta from S17 (cos=-0.1158 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.7582 head_norm=1.738481
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.844960e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.7749 head_norm=1.557523 delta_norm=0.384496
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.6718 head_norm=1.220678
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.833242e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.6793 head_norm=1.160478 delta_norm=0.383324
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.9709 head_norm=1.487310
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.941585e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.9622 head_norm=1.573369 delta_norm=0.194158
[S16] aggregate: ROLLBACK (f1_val pre=0.971 post=0.962 tol_abs=0.005 tol_rel=0.0)
[S2] START round=29 head_norm_before_train=2.095556 (no previous merge yet)
[S2] round=29 local utility u=0.158017 metrics={'f1_val': 0.7100081671085082, 'auprc': 0.9099051504496511, 'loss_val': 0.6263449425846126, 'psi': 0.7899669604449654}-{'f1_val': 0.7074668983219099, 'auprc': 0.7972811942470879, 'loss_val': 0.5892595986921925, 'psi': 0.7433926166919811}
[S3] START round=29 head_norm_before_train=1.603468 cos_to_last_merge=0.9996 (last merge round=27)
[S3] round=29 local utility u=0.054549 metrics={'f1_val': 0.9965655661594752, 'auprc': 0.9991417470016869, 'loss_val': 0.0747775804915304, 'psi': 0.9975960384963599}-{'f1_val': 0.9834700229051168, 'auprc': 0.9976909496210886, 'loss_val': 0.10094988740382632, 'psi': 0.9891583935915055}
[S4] START round=29 head_norm_before_train=1.501369 cos_to_last_merge=0.9796 (last merge round=24)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9389398154385801, 'auprc': 0.9331307249886882, 'loss_val': 0.31404852203884953, 'psi': 0.9366161792586234}-{'f1_val': 0.9411926078240542, 'auprc': 0.9645652454383894, 'loss_val': 0.28813644611577316, 'psi': 0.9505416628697883}
[S5] START round=29 head_norm_before_train=1.160478 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.179441 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9874756750181637, 'loss_val': 0.32792662807109535, 'psi': 0.8151830604676138}-{'f1_val': 0.6718185236806624, 'auprc': 0.9312542358327768, 'loss_val': 0.34712675367810714, 'psi': 0.7755928085415082}
[S6] START round=29 head_norm_before_train=1.557523 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.513351 metrics={'f1_val': 0.8488965233006438, 'auprc': 0.9658308390444087, 'loss_val': 0.27211544053156983, 'psi': 0.8956702495981498}-{'f1_val': 0.7581623426098811, 'auprc': 0.9440072431823986, 'loss_val': 0.6889413611223489, 'psi': 0.8325003028388882}
[S7] START round=29 head_norm_before_train=1.662477 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5283727091724513, 'auprc': 0.7804767799094949, 'loss_val': 1.025799314148211, 'psi': 0.6292143374672687}-{'f1_val': 0.6120886783438055, 'auprc': 0.7995247776870686, 'loss_val': 0.6583625057719318, 'psi': 0.6870631180811109}
[S8] START round=29 head_norm_before_train=1.677583 cos_to_last_merge=0.9585 (last merge round=24)
[S8] round=29 local utility u=0.005447 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9981233865073943, 'loss_val': 0.04909746275193291, 'psi': 0.9950110639680518}-{'f1_val': 0.9922069265978078, 'auprc': 0.9980548534125162, 'loss_val': 0.05541063161254272, 'psi': 0.9945460973236913}
[S9] START round=29 head_norm_before_train=1.223617 cos_to_last_merge=0.9995 (last merge round=27)
[S9] round=29 local utility u=0.010118 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9974593833828398, 'loss_val': 0.0739451728027172, 'psi': 0.9962332528751074}-{'f1_val': 0.9958312226609984, 'auprc': 0.993698118603563, 'loss_val': 0.08538901622342791, 'psi': 0.9949779810380243}
[S10] START round=29 head_norm_before_train=2.112273 (no previous merge yet)
[S10] round=29 local utility u=0.001051 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9927785147000617, 'loss_val': 0.029270554172869185, 'psi': 0.9940417403382614}-{'f1_val': 0.9945291067983943, 'auprc': 0.9931061512075362, 'loss_val': 0.030226541329613336, 'psi': 0.9939599245620511}
[S11] START round=29 head_norm_before_train=1.457778 cos_to_last_merge=0.9980 (last merge round=26)
[S11] round=29 local utility u=0.023961 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9945949674414846, 'loss_val': 0.08442102566276487, 'psi': 0.9957661896847476}-{'f1_val': 0.9954312449678927, 'auprc': 0.9939411521925631, 'loss_val': 0.12368615258558234, 'psi': 0.9948352078577608}
[S13] START round=29 head_norm_before_train=1.344611 cos_to_last_merge=0.9754 (last merge round=25)
[S13] round=29 local utility u=0.182718 metrics={'f1_val': 0.613195331000147, 'auprc': 0.7239341686201579, 'loss_val': 0.8985116259642072, 'psi': 0.6574908660481513}-{'f1_val': 0.6100864507301499, 'auprc': 0.6105334038249035, 'loss_val': 0.9050915105163228, 'psi': 0.6102652319680513}
[S14] START round=29 head_norm_before_train=1.476618 cos_to_last_merge=0.9936 (last merge round=24)
[S14] round=29 local utility u=0.084075 metrics={'f1_val': 0.9654103897999862, 'auprc': 0.9991576457380285, 'loss_val': 0.26771735022104415, 'psi': 0.9789092921752031}-{'f1_val': 0.9475153123710529, 'auprc': 0.9988487713319014, 'loss_val': 0.32757074791464874, 'psi': 0.9680486959553922}
[S15] START round=29 head_norm_before_train=2.111080 (no previous merge yet)
[S15] round=29 local utility u=0.860937 metrics={'f1_val': 0.8696213067104525, 'auprc': 0.9930091265856859, 'loss_val': 0.24352142759210854, 'psi': 0.9189764346605458}-{'f1_val': 0.7010713433702593, 'auprc': 0.8885790773198878, 'loss_val': 0.6408064124455626, 'psi': 0.7760744369501107}
[S16] START round=29 head_norm_before_train=1.573369 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.086373 metrics={'f1_val': 0.991584132165747, 'auprc': 0.9831901274769407, 'loss_val': 0.16756776771744977, 'psi': 0.9882265302902244}-{'f1_val': 0.9709069143454078, 'auprc': 0.9872102788538508, 'loss_val': 0.22831129677622555, 'psi': 0.977428260148785}
[S17] START round=29 head_norm_before_train=2.064806 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5981431002600467, 'auprc': 0.9254452840846927, 'loss_val': 1.203808116640771, 'psi': 0.7290639737899052}-{'f1_val': 0.5953695883607107, 'auprc': 0.9676888041771132, 'loss_val': 1.0937813257929414, 'psi': 0.7442972746872718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:40405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] sending update (kind=head size=1789 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1794) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.496640)
[S11] loaded HEAD from S14 (vec_in norm=1.496640)
[S11] cosine check vs S14: cos=0.8386
[S11] BUFFERED delta from S14 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.710454)
[S16] loaded HEAD from S8 (vec_in norm=1.710454)
[S16] cosine check vs S8: cos=0.9899
[S16] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.382233)
[S9] loaded HEAD from S13 (vec_in norm=1.382233)
[S9] cosine check vs S13: cos=0.9665
[S9] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.123034)
[S7] loaded HEAD from S10 (vec_in norm=2.123034)
[S7] cosine check vs S10: cos=-0.1128
[S7] DROPPED delta from S10 (cos=-0.1128 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.257374)
[S5] loaded HEAD from S9 (vec_in norm=1.257374)
[S5] cosine check vs S9: cos=0.9419
[S5] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:40415
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.614601)
[S15] loaded HEAD from S16 (vec_in norm=1.614601)
[S15] cosine check vs S16: cos=-0.0647
[S15] DROPPED delta from S16 (cos=-0.0647 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:40407
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9916 head_norm=1.614601
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.272272e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9914 head_norm=1.658345 delta_norm=0.127227
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.501511)
[S6] loaded HEAD from S11 (vec_in norm=1.501511)
[S6] cosine check vs S11: cos=0.9689
[S6] BUFFERED delta from S11 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9965 head_norm=1.501511
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.259017e-01
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9965 head_norm=1.437304 delta_norm=0.425902
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.9954 head_norm=1.257374
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.817113e-01
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.9950 head_norm=1.308724 delta_norm=0.181711
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.7003 head_norm=1.185779
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.112517e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.7003 head_norm=1.203704 delta_norm=0.211252
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.8489 head_norm=1.575001
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.951465e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.8489 head_norm=1.526270 delta_norm=0.195147
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=2.113433 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6995687308559873, 'auprc': 0.7894439670492721, 'loss_val': 0.686631132253331, 'psi': 0.7355188253333012}-{'f1_val': 0.7100081671085082, 'auprc': 0.9099051504496511, 'loss_val': 0.6263449425846126, 'psi': 0.7899669604449654}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.632979 cos_to_last_merge=0.9984 (last merge round=27)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9606109340814555, 'auprc': 0.9976060625470645, 'loss_val': 0.11832432834251852, 'psi': 0.975408985467699}-{'f1_val': 0.9965655661594752, 'auprc': 0.9991417470016869, 'loss_val': 0.0747775804915304, 'psi': 0.9975960384963599}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.525020 cos_to_last_merge=0.9764 (last merge round=24)
[S4] round=30 local utility u=0.085950 metrics={'f1_val': 0.9422951436898773, 'auprc': 0.9740962396352096, 'loss_val': 0.2851768878558312, 'psi': 0.9550155820680102}-{'f1_val': 0.9389398154385801, 'auprc': 0.9331307249886882, 'loss_val': 0.31404852203884953, 'psi': 0.9366161792586234}
[S5] START round=30 head_norm_before_train=1.203704 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.5630507473159039, 'auprc': 0.8528483703985004, 'loss_val': 0.6086924595108687, 'psi': 0.6789697965489425}-{'f1_val': 0.7003213174339138, 'auprc': 0.9874756750181637, 'loss_val': 0.32792662807109535, 'psi': 0.8151830604676138}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.526270 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.817829587737682, 'auprc': 0.9468957752447837, 'loss_val': 0.49622861842859955, 'psi': 0.8694560627405227}-{'f1_val': 0.8488965233006438, 'auprc': 0.9658308390444087, 'loss_val': 0.27211544053156983, 'psi': 0.8956702495981498}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.666380 (no previous merge yet)
[S7] round=30 local utility u=0.550570 metrics={'f1_val': 0.6293931558804562, 'auprc': 0.8019768586045755, 'loss_val': 0.5952829331184859, 'psi': 0.698426636970104}-{'f1_val': 0.5283727091724513, 'auprc': 0.7804767799094949, 'loss_val': 1.025799314148211, 'psi': 0.6292143374672687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=30 head_norm_before_train=1.710454 cos_to_last_merge=0.9533 (last merge round=24)
[S8] round=30 local utility u=0.001386 metrics={'f1_val': 0.9934815081849845, 'auprc': 0.9965899546688299, 'loss_val': 0.04499656206897019, 'psi': 0.9947248867785227}-{'f1_val': 0.9929361822751569, 'auprc': 0.9981233865073943, 'loss_val': 0.04909746275193291, 'psi': 0.9950110639680518}
[S9] START round=30 head_norm_before_train=1.308724 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9913635547683235, 'loss_val': 0.06576093904282153, 'psi': 0.994295478774896}-{'f1_val': 0.9954158325366191, 'auprc': 0.9974593833828398, 'loss_val': 0.0739451728027172, 'psi': 0.9962332528751074}
[S10] START round=30 head_norm_before_train=2.123034 (no previous merge yet)
[S10] round=30 local utility u=0.000579 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9934164339869351, 'loss_val': 0.028709306422270753, 'psi': 0.9941652066004238}-{'f1_val': 0.9948838907637279, 'auprc': 0.9927785147000617, 'loss_val': 0.029270554172869185, 'psi': 0.9940417403382614}
[S11] START round=30 head_norm_before_train=1.437304 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9848867469960338, 'auprc': 0.9951474713166187, 'loss_val': 0.14706805612728213, 'psi': 0.9889910367242678}-{'f1_val': 0.9965470045135896, 'auprc': 0.9945949674414846, 'loss_val': 0.08442102566276487, 'psi': 0.9957661896847476}
[S13] START round=30 head_norm_before_train=1.382233 cos_to_last_merge=0.9688 (last merge round=25)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6402561031330121, 'auprc': 0.5899289406131454, 'loss_val': 0.9478291948865937, 'psi': 0.6201252381250654}-{'f1_val': 0.613195331000147, 'auprc': 0.7239341686201579, 'loss_val': 0.8985116259642072, 'psi': 0.6574908660481513}
[S14] START round=30 head_norm_before_train=1.496640 cos_to_last_merge=0.9911 (last merge round=24)
[S14] round=30 local utility u=0.128865 metrics={'f1_val': 0.9969466221603862, 'auprc': 0.9999752680952676, 'loss_val': 0.20165677595303602, 'psi': 0.9981580805343389}-{'f1_val': 0.9654103897999862, 'auprc': 0.9991576457380285, 'loss_val': 0.26771735022104415, 'psi': 0.9789092921752031}
[S15] START round=30 head_norm_before_train=2.128444 (no previous merge yet)
[S15] round=30 local utility u=0.007966 metrics={'f1_val': 0.8718642846249531, 'auprc': 0.9923459776883191, 'loss_val': 0.2390577760373896, 'psi': 0.9200569618502995}-{'f1_val': 0.8696213067104525, 'auprc': 0.9930091265856859, 'loss_val': 0.24352142759210854, 'psi': 0.9189764346605458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=30 head_norm_before_train=1.658345 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9298671673377275, 'auprc': 0.9842751051726347, 'loss_val': 0.3027554744961274, 'psi': 0.9516303424716903}-{'f1_val': 0.991584132165747, 'auprc': 0.9831901274769407, 'loss_val': 0.16756776771744977, 'psi': 0.9882265302902244}
[S17] START round=30 head_norm_before_train=2.068791 (no previous merge yet)
[S17] round=30 local utility u=0.199736 metrics={'f1_val': 0.6525823921289218, 'auprc': 0.8499435923865571, 'loss_val': 0.9044673120128596, 'psi': 0.7315268722319759}-{'f1_val': 0.5981431002600467, 'auprc': 0.9254452840846927, 'loss_val': 1.203808116640771, 'psi': 0.7290639737899052}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:40409
[S10] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:40403
[S13] ⇄ pheromone p=0.090 → S9@127.0.0.1:40410
[S11] ⇄ pheromone p=0.075 → S6@127.0.0.1:40407
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.132282)
[S7] loaded HEAD from S10 (vec_in norm=2.132282)
[S7] cosine check vs S10: cos=-0.1132
[S7] DROPPED delta from S10 (cos=-0.1132 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=2.078305)
[S8] loaded HEAD from S17 (vec_in norm=2.078305)
[S8] cosine check vs S17: cos=-0.1187
[S8] DROPPED delta from S17 (cos=-0.1187 < 0.0)
[S4] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S17] ⇄ pheromone p=0.257 → S8@127.0.0.1:40409
[S10] ⇄ pheromone p=0.007 → S7@127.0.0.1:40408
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.734571)
[S16] loaded HEAD from S8 (vec_in norm=1.734571)
[S16] cosine check vs S8: cos=0.9942
[S16] BUFFERED delta from S8 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1803) from S4
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.545702)
[S3] loaded HEAD from S4 (vec_in norm=1.545702)
[S3] cosine check vs S4: cos=0.9312
[S3] BUFFERED delta from S4 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:40412
[S14] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1804) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.519562)
[S11] loaded HEAD from S14 (vec_in norm=1.519562)
[S11] cosine check vs S14: cos=0.9534
[S11] BUFFERED delta from S14 (total buffered=1)
[S14] ⇄ pheromone p=0.110 → S11@127.0.0.1:40412
[S8] ⇄ pheromone p=0.025 → S16@127.0.0.1:40416
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.9299 head_norm=1.694100
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.455385e-02
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.9247 head_norm=1.711846 delta_norm=0.094554
[S16] aggregate: ROLLBACK (f1_val pre=0.930 post=0.925 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.113 → S15@127.0.0.1:40415
[S9] RoundReady barrier timeout: have=1 need=2 — continuing
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] CommDone barrier timeout: have=0 need=1 — continuing
[S4] ⇄ pheromone p=0.034 → S3@127.0.0.1:40403
[S4]  timeout peer S3
[S4]  timeout peer S14
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S17
[S16]  timeout peer S13
[S16]  timeout peer S15
[S10]  timeout peer S7
[S8]  timeout peer S2
[S8]  timeout peer S16
[S11]  timeout peer S6
[S13]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S17]  timeout peer S8
[S2] START round=31 head_norm_before_train=2.122708 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.6577019983256758, 'auprc': 0.6895589852383112, 'loss_val': 1.0012864796909375, 'psi': 0.6704447930907299}-{'f1_val': 0.6995687308559873, 'auprc': 0.7894439670492721, 'loss_val': 0.686631132253331, 'psi': 0.7355188253333012}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=1.664477 cos_to_last_merge=0.9965 (last merge round=27)
[S3] round=31 local utility u=0.148852 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9993912660866455, 'loss_val': 0.046872533167794474, 'psi': 0.9982127840065927}-{'f1_val': 0.9606109340814555, 'auprc': 0.9976060625470645, 'loss_val': 0.11832432834251852, 'psi': 0.975408985467699}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.9974 head_norm=1.694653
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.171796e-01
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.9974 head_norm=1.590572 delta_norm=0.317180
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] START round=31 head_norm_before_train=1.545702 cos_to_last_merge=0.9738 (last merge round=24)
[S4] round=31 local utility u=0.003023 metrics={'f1_val': 0.9427907421210333, 'auprc': 0.9749247370126637, 'loss_val': 0.2845899756785769, 'psi': 0.9556443400776855}-{'f1_val': 0.9422951436898773, 'auprc': 0.9740962396352096, 'loss_val': 0.2851768878558312, 'psi': 0.9550155820680102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=31 head_norm_before_train=1.229864 cos_to_last_merge=0.9990 (last merge round=29)
[S5] round=31 local utility u=0.569652 metrics={'f1_val': 0.672426477076327, 'auprc': 0.9341318298735904, 'loss_val': 0.36949332200674273, 'psi': 0.7771086181952324}-{'f1_val': 0.5630507473159039, 'auprc': 0.8528483703985004, 'loss_val': 0.6086924595108687, 'psi': 0.6789697965489425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=31 head_norm_before_train=1.545272 cos_to_last_merge=0.9999 (last merge round=29)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.6699991273468413, 'auprc': 0.8196775739599131, 'loss_val': 0.8272499671080789, 'psi': 0.72987050599207}-{'f1_val': 0.817829587737682, 'auprc': 0.9468957752447837, 'loss_val': 0.49622861842859955, 'psi': 0.8694560627405227}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.668991 (no previous merge yet)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.4264615842755002, 'auprc': 0.778434756999659, 'loss_val': 1.2006265788656163, 'psi': 0.5672508533651637}-{'f1_val': 0.6293931558804562, 'auprc': 0.8019768586045755, 'loss_val': 0.5952829331184859, 'psi': 0.698426636970104}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.734571 cos_to_last_merge=0.9495 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=31 local utility u=0.000055 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9981930725747898, 'loss_val': 0.044234341947189684, 'psi': 0.9948199967032012}-{'f1_val': 0.9934815081849845, 'auprc': 0.9965899546688299, 'loss_val': 0.04499656206897019, 'psi': 0.9947248867785227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=31 head_norm_before_train=1.335167 cos_to_last_merge=0.9998 (last merge round=29)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9922349858325491, 'auprc': 0.9965127899122666, 'loss_val': 0.0666287228512787, 'psi': 0.9939461074644361}-{'f1_val': 0.9962500947792776, 'auprc': 0.9913635547683235, 'loss_val': 0.06576093904282153, 'psi': 0.994295478774896}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=2.132282 (no previous merge yet)
[S10] round=31 local utility u=0.000311 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9935270061003334, 'loss_val': 0.028418529362044812, 'psi': 0.9942094354457832}-{'f1_val': 0.9946643883427498, 'auprc': 0.9934164339869351, 'loss_val': 0.028709306422270753, 'psi': 0.9941652066004238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=31 head_norm_before_train=1.475283 cos_to_last_merge=0.9995 (last merge round=29)
[S11] round=31 local utility u=0.068172 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974809873269879, 'loss_val': 0.0876862845006511, 'psi': 0.9969205976389489}-{'f1_val': 0.9848867469960338, 'auprc': 0.9951474713166187, 'loss_val': 0.14706805612728213, 'psi': 0.9889910367242678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.9965 head_norm=1.512691
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.453573e-01
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.9965 head_norm=1.496146 delta_norm=0.245357
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] START round=31 head_norm_before_train=1.414603 cos_to_last_merge=0.9636 (last merge round=25)
[S13] round=31 local utility u=0.490415 metrics={'f1_val': 0.6811917335461939, 'auprc': 0.7730408012180868, 'loss_val': 0.7619485238432783, 'psi': 0.7179313606149511}-{'f1_val': 0.6402561031330121, 'auprc': 0.5899289406131454, 'loss_val': 0.9478291948865937, 'psi': 0.6201252381250654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=31 head_norm_before_train=1.519562 cos_to_last_merge=0.9879 (last merge round=24)
[S14] round=31 local utility u=0.017431 metrics={'f1_val': 0.9965140916538803, 'auprc': 0.9994515954870733, 'loss_val': 0.16262831516260037, 'psi': 0.9976890931871575}-{'f1_val': 0.9969466221603862, 'auprc': 0.9999752680952676, 'loss_val': 0.20165677595303602, 'psi': 0.9981580805343389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=31 head_norm_before_train=2.145374 (no previous merge yet)
[S15] round=31 local utility u=0.485590 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9953982575149251, 'loss_val': 0.023843260396788076, 'psi': 0.9959587495152545}-{'f1_val': 0.8718642846249531, 'auprc': 0.9923459776883191, 'loss_val': 0.2390577760373896, 'psi': 0.9200569618502995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=31 head_norm_before_train=1.711846 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.078749 metrics={'f1_val': 0.9411165559662797, 'auprc': 0.9848688086479457, 'loss_val': 0.214534486943549, 'psi': 0.9586174570389461}-{'f1_val': 0.9298671673377275, 'auprc': 0.9842751051726347, 'loss_val': 0.3027554744961274, 'psi': 0.9516303424716903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=31 head_norm_before_train=2.078305 (no previous merge yet)
[S17] round=31 local utility u=0.199436 metrics={'f1_val': 0.6532195810058006, 'auprc': 0.978894184571405, 'loss_val': 0.8962701798250344, 'psi': 0.7834894224320423}-{'f1_val': 0.6525823921289218, 'auprc': 0.8499435923865571, 'loss_val': 0.9044673120128596, 'psi': 0.7315268722319759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=32 head_norm_before_train=2.131179 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.5587483807579969, 'auprc': 0.740635089996166, 'loss_val': 1.5555443206087312, 'psi': 0.6315030644532645}-{'f1_val': 0.6577019983256758, 'auprc': 0.6895589852383112, 'loss_val': 1.0012864796909375, 'psi': 0.6704447930907299}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=1.590572 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9936445785345308, 'auprc': 0.999193126058944, 'loss_val': 0.0653104047557731, 'psi': 0.9958639975442961}-{'f1_val': 0.9974271292865575, 'auprc': 0.9993912660866455, 'loss_val': 0.046872533167794474, 'psi': 0.9982127840065927}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.565794 cos_to_last_merge=0.9713 (last merge round=24)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9521377133813671, 'auprc': 0.9547487208661877, 'loss_val': 0.288406496598335, 'psi': 0.9531821163752954}-{'f1_val': 0.9427907421210333, 'auprc': 0.9749247370126637, 'loss_val': 0.2845899756785769, 'psi': 0.9556443400776855}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.254073 cos_to_last_merge=0.9965 (last merge round=29)
[S5] round=32 local utility u=0.201960 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.9873588157796346, 'loss_val': 0.2946176128590424, 'psi': 0.8153357170393094}-{'f1_val': 0.672426477076327, 'auprc': 0.9341318298735904, 'loss_val': 0.36949332200674273, 'psi': 0.7771086181952324}
[S5] not sending this round → trigger blocked (psi=0.815)
[S6] START round=32 head_norm_before_train=1.576712 cos_to_last_merge=0.9997 (last merge round=29)
[S6] round=32 local utility u=0.973823 metrics={'f1_val': 0.8463095130202178, 'auprc': 0.9663363485820714, 'loss_val': 0.37744210995299576, 'psi': 0.8943202472449593}-{'f1_val': 0.6699991273468413, 'auprc': 0.8196775739599131, 'loss_val': 0.8272499671080789, 'psi': 0.72987050599207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=32 head_norm_before_train=1.670378 (no previous merge yet)
[S7] round=32 local utility u=1.000000 metrics={'f1_val': 0.9020975323085755, 'auprc': 0.9822592829649499, 'loss_val': 0.19611520224816845, 'psi': 0.9341622325711252}-{'f1_val': 0.4264615842755002, 'auprc': 0.778434756999659, 'loss_val': 1.2006265788656163, 'psi': 0.5672508533651637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=32 head_norm_before_train=1.754558 cos_to_last_merge=0.9464 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9898645730971362, 'auprc': 0.9987883101788342, 'loss_val': 0.04816071318688034, 'psi': 0.9934340679298154}-{'f1_val': 0.9925712794554754, 'auprc': 0.9981930725747898, 'loss_val': 0.044234341947189684, 'psi': 0.9948199967032012}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.358325 cos_to_last_merge=0.9994 (last merge round=29)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9897381162675762, 'auprc': 0.9960555123963932, 'loss_val': 0.06887333468247643, 'psi': 0.992265074719103}-{'f1_val': 0.9922349858325491, 'auprc': 0.9965127899122666, 'loss_val': 0.0666287228512787, 'psi': 0.9939461074644361}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=2.145570 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9934483598217871, 'loss_val': 0.028913503603262638, 'psi': 0.9937831404856551}-{'f1_val': 0.9946643883427498, 'auprc': 0.9935270061003334, 'loss_val': 0.028418529362044812, 'psi': 0.9942094354457832}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.496146 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9946715121795274, 'loss_val': 0.10243523382805035, 'psi': 0.9957968075799647}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974809873269879, 'loss_val': 0.0876862845006511, 'psi': 0.9969205976389489}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.431684 cos_to_last_merge=0.9608 (last merge round=25)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6809188625288509, 'auprc': 0.7162207940920612, 'loss_val': 0.7026681994726058, 'psi': 0.695039635154135}-{'f1_val': 0.6811917335461939, 'auprc': 0.7730408012180868, 'loss_val': 0.7619485238432783, 'psi': 0.7179313606149511}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.547927 cos_to_last_merge=0.9845 (last merge round=24)
[S14] round=32 local utility u=0.016821 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9991803977212479, 'loss_val': 0.1284512246021462, 'psi': 0.9976083858587579}-{'f1_val': 0.9965140916538803, 'auprc': 0.9994515954870733, 'loss_val': 0.16262831516260037, 'psi': 0.9976890931871575}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=32 head_norm_before_train=2.158655 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.869799208178443, 'auprc': 0.9912853119678275, 'loss_val': 0.2508306490329595, 'psi': 0.9183936496941969}-{'f1_val': 0.9963324108488076, 'auprc': 0.9953982575149251, 'loss_val': 0.023843260396788076, 'psi': 0.9959587495152545}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.743057 cos_to_last_merge=0.9993 (last merge round=30)
[S16] round=32 local utility u=0.143467 metrics={'f1_val': 0.9751531860161644, 'auprc': 0.9856062784891975, 'loss_val': 0.13403219833191599, 'psi': 0.9793344230053777}-{'f1_val': 0.9411165559662797, 'auprc': 0.9848688086479457, 'loss_val': 0.214534486943549, 'psi': 0.9586174570389461}
[S16] not sending this round → trigger blocked (psi=0.979)
[S17] START round=32 head_norm_before_train=2.088830 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6508128063970218, 'auprc': 0.9450567454453166, 'loss_val': 1.0282646608382744, 'psi': 0.7685103820163397}-{'f1_val': 0.6532195810058006, 'auprc': 0.978894184571405, 'loss_val': 0.8962701798250344, 'psi': 0.7834894224320423}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=2.138822 (no previous merge yet)
[S2] round=33 local utility u=0.344315 metrics={'f1_val': 0.6620835211431969, 'auprc': 0.6662645268904583, 'loss_val': 1.263813031091243, 'psi': 0.6637559234421015}-{'f1_val': 0.5587483807579969, 'auprc': 0.740635089996166, 'loss_val': 1.5555443206087312, 'psi': 0.6315030644532645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=33 head_norm_before_train=1.619729 cos_to_last_merge=0.9997 (last merge round=31)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9992050108644375, 'loss_val': 0.09376930043617146, 'psi': 0.9763270555854473}-{'f1_val': 0.9936445785345308, 'auprc': 0.999193126058944, 'loss_val': 0.0653104047557731, 'psi': 0.9958639975442961}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.582510 cos_to_last_merge=0.9690 (last merge round=24)
[S4] round=33 local utility u=0.026914 metrics={'f1_val': 0.9499536171928975, 'auprc': 0.9754008819439561, 'loss_val': 0.2834306882561472, 'psi': 0.9601325230933209}-{'f1_val': 0.9521377133813671, 'auprc': 0.9547487208661877, 'loss_val': 0.288406496598335, 'psi': 0.9531821163752954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=33 head_norm_before_train=1.276904 cos_to_last_merge=0.9937 (last merge round=29)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.42554753765094644, 'auprc': 0.8108635129543071, 'loss_val': 0.8777814181010893, 'psi': 0.5796739277722908}-{'f1_val': 0.7006536512124258, 'auprc': 0.9873588157796346, 'loss_val': 0.2946176128590424, 'psi': 0.8153357170393094}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.597160 cos_to_last_merge=0.9994 (last merge round=29)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7304992990677261, 'auprc': 0.9418350743596899, 'loss_val': 0.7178569721782754, 'psi': 0.8150336091845116}-{'f1_val': 0.8463095130202178, 'auprc': 0.9663363485820714, 'loss_val': 0.37744210995299576, 'psi': 0.8943202472449593}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.672688 (no previous merge yet)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.4328007845239471, 'auprc': 0.7790762557542295, 'loss_val': 1.115308623602779, 'psi': 0.57131097301606}-{'f1_val': 0.9020975323085755, 'auprc': 0.9822592829649499, 'loss_val': 0.19611520224816845, 'psi': 0.9341622325711252}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.769900 cos_to_last_merge=0.9441 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.944
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9702015670146625, 'auprc': 0.9989468454119526, 'loss_val': 0.08533687239363431, 'psi': 0.9816996783735785}-{'f1_val': 0.9898645730971362, 'auprc': 0.9987883101788342, 'loss_val': 0.04816071318688034, 'psi': 0.9934340679298154}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.379591 cos_to_last_merge=0.9988 (last merge round=29)
[S9] round=33 local utility u=0.021961 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9905263558311153, 'loss_val': 0.05009001942046327, 'psi': 0.9942260370913034}-{'f1_val': 0.9897381162675762, 'auprc': 0.9960555123963932, 'loss_val': 0.06887333468247643, 'psi': 0.992265074719103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=33 head_norm_before_train=2.159440 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9945528553774142, 'auprc': 0.9918405316550475, 'loss_val': 0.02809290266178328, 'psi': 0.9934679258884676}-{'f1_val': 0.9940063275949004, 'auprc': 0.9934483598217871, 'loss_val': 0.028913503603262638, 'psi': 0.9937831404856551}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.529812 cos_to_last_merge=0.9996 (last merge round=31)
[S11] round=33 local utility u=0.001739 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9952399948809199, 'loss_val': 0.09818352611646701, 'psi': 0.9957762029003535}-{'f1_val': 0.9965470045135896, 'auprc': 0.9946715121795274, 'loss_val': 0.10243523382805035, 'psi': 0.9957968075799647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=33 head_norm_before_train=1.441407 cos_to_last_merge=0.9591 (last merge round=25)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.6573502811915393, 'auprc': 0.7566744608354559, 'loss_val': 0.8881483671252661, 'psi': 0.6970799530491059}-{'f1_val': 0.6809188625288509, 'auprc': 0.7162207940920612, 'loss_val': 0.7026681994726058, 'psi': 0.695039635154135}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.577926 cos_to_last_merge=0.9810 (last merge round=24)
[S14] round=33 local utility u=0.005301 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9969727687987837, 'loss_val': 0.11633071693429345, 'psi': 0.9972357040802104}-{'f1_val': 0.9965603779504312, 'auprc': 0.9991803977212479, 'loss_val': 0.1284512246021462, 'psi': 0.9976083858587579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=33 head_norm_before_train=2.171602 (no previous merge yet)
[S15] round=33 local utility u=0.503544 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9974125002181999, 'loss_val': 0.021322750485362998, 'psi': 0.9967644465965645}-{'f1_val': 0.869799208178443, 'auprc': 0.9912853119678275, 'loss_val': 0.2508306490329595, 'psi': 0.9183936496941969}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=33 head_norm_before_train=1.771447 cos_to_last_merge=0.9979 (last merge round=30)
[S16] round=33 local utility u=0.059516 metrics={'f1_val': 0.991971798497276, 'auprc': 0.9831772405465148, 'loss_val': 0.10862475799675173, 'psi': 0.9884539753169714}-{'f1_val': 0.9751531860161644, 'auprc': 0.9856062784891975, 'loss_val': 0.13403219833191599, 'psi': 0.9793344230053777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=33 head_norm_before_train=2.106224 (no previous merge yet)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.3627114007433555, 'auprc': 0.7536943905109663, 'loss_val': 2.3101522492660758, 'psi': 0.5191045966503999}-{'f1_val': 0.6508128063970218, 'auprc': 0.9450567454453166, 'loss_val': 1.0282646608382744, 'psi': 0.7685103820163397}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=2.148668 (no previous merge yet)
[S2] round=34 local utility u=0.740714 metrics={'f1_val': 0.7100869354661008, 'auprc': 0.8370017844847002, 'loss_val': 0.5826179124987488, 'psi': 0.7608528750735406}-{'f1_val': 0.6620835211431969, 'auprc': 0.6662645268904583, 'loss_val': 1.263813031091243, 'psi': 0.6637559234421015}
[S2] not sending this round → trigger blocked (psi=0.761)
[S3] START round=34 head_norm_before_train=1.650869 cos_to_last_merge=0.9987 (last merge round=31)
[S3] round=34 local utility u=0.126326 metrics={'f1_val': 0.9972450390152456, 'auprc': 0.9997553428076533, 'loss_val': 0.059788525567865416, 'psi': 0.9982491605322087}-{'f1_val': 0.9610750853994537, 'auprc': 0.9992050108644375, 'loss_val': 0.09376930043617146, 'psi': 0.9763270555854473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=34 head_norm_before_train=1.600142 cos_to_last_merge=0.9668 (last merge round=24)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9487548456238285, 'auprc': 0.9663462168268607, 'loss_val': 0.2890583112437386, 'psi': 0.9557913941050414}-{'f1_val': 0.9499536171928975, 'auprc': 0.9754008819439561, 'loss_val': 0.2834306882561472, 'psi': 0.9601325230933209}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.297120 cos_to_last_merge=0.9911 (last merge round=29)
[S5] round=34 local utility u=1.000000 metrics={'f1_val': 0.7005679112968205, 'auprc': 0.9872022017729457, 'loss_val': 0.27110742612335637, 'psi': 0.8152216274872706}-{'f1_val': 0.42554753765094644, 'auprc': 0.8108635129543071, 'loss_val': 0.8777814181010893, 'psi': 0.5796739277722908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S5] sending update (kind=head size=1788 to 1 peers)
[S6] START round=34 head_norm_before_train=1.614903 cos_to_last_merge=0.9991 (last merge round=29)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.5790536185309758, 'auprc': 0.7889786205272729, 'loss_val': 0.8018661813754474, 'psi': 0.6630236193294947}-{'f1_val': 0.7304992990677261, 'auprc': 0.9418350743596899, 'loss_val': 0.7178569721782754, 'psi': 0.8150336091845116}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.673953 (no previous merge yet)
[S7] round=34 local utility u=1.000000 metrics={'f1_val': 0.6728028351637227, 'auprc': 0.8282889761647658, 'loss_val': 0.3562180326123504, 'psi': 0.7349972915641401}-{'f1_val': 0.4328007845239471, 'auprc': 0.7790762557542295, 'loss_val': 1.115308623602779, 'psi': 0.57131097301606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=34 head_norm_before_train=1.780057 cos_to_last_merge=0.9424 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.942
[S8] round=34 local utility u=0.075914 metrics={'f1_val': 0.9932883265732785, 'auprc': 0.9906559019606207, 'loss_val': 0.04715748289037982, 'psi': 0.9922353567282154}-{'f1_val': 0.9702015670146625, 'auprc': 0.9989468454119526, 'loss_val': 0.08533687239363431, 'psi': 0.9816996783735785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=34 head_norm_before_train=1.399601 cos_to_last_merge=0.9981 (last merge round=29)
[S9] round=34 local utility u=0.001053 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9904248031191221, 'loss_val': 0.04598551261422662, 'psi': 0.9940160326479813}-{'f1_val': 0.9966924912647621, 'auprc': 0.9905263558311153, 'loss_val': 0.05009001942046327, 'psi': 0.9942260370913034}
[S9] not sending this round → trigger blocked (psi=0.994)
[S10] START round=34 head_norm_before_train=2.168766 (no previous merge yet)
[S10] round=34 local utility u=0.001117 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9946443031286587, 'loss_val': 0.02967579323434866, 'psi': 0.9941299943962765}-{'f1_val': 0.9945528553774142, 'auprc': 0.9918405316550475, 'loss_val': 0.02809290266178328, 'psi': 0.9934679258884676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=34 head_norm_before_train=1.568037 cos_to_last_merge=0.9984 (last merge round=31)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9913417689472677, 'auprc': 0.9961838072601192, 'loss_val': 0.08516998049914537, 'psi': 0.9932785842724082}-{'f1_val': 0.9961336749133093, 'auprc': 0.9952399948809199, 'loss_val': 0.09818352611646701, 'psi': 0.9957762029003535}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.448991 cos_to_last_merge=0.9579 (last merge round=25)
[S13] round=34 local utility u=0.000239 metrics={'f1_val': 0.658936941260255, 'auprc': 0.7555004713791599, 'loss_val': 0.8936687310781986, 'psi': 0.697562353307817}-{'f1_val': 0.6573502811915393, 'auprc': 0.7566744608354559, 'loss_val': 0.8881483671252661, 'psi': 0.6970799530491059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=34 head_norm_before_train=1.605693 cos_to_last_merge=0.9777 (last merge round=24)
[S14] round=34 local utility u=0.015682 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9990459285781779, 'loss_val': 0.09018150925227929, 'psi': 0.9979645084886946}-{'f1_val': 0.9974109942678281, 'auprc': 0.9969727687987837, 'loss_val': 0.11633071693429345, 'psi': 0.9972357040802104}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=34 head_norm_before_train=2.185664 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.8344254212993365, 'auprc': 0.991172315836675, 'loss_val': 0.30483547134789185, 'psi': 0.8971241791142719}-{'f1_val': 0.9963324108488076, 'auprc': 0.9974125002181999, 'loss_val': 0.021322750485362998, 'psi': 0.9967644465965645}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.797192 cos_to_last_merge=0.9963 (last merge round=30)
[S16] round=34 local utility u=0.007840 metrics={'f1_val': 0.9900583960723177, 'auprc': 0.982593360344927, 'loss_val': 0.07971258933444603, 'psi': 0.9870723817813614}-{'f1_val': 0.991971798497276, 'auprc': 0.9831772405465148, 'loss_val': 0.10862475799675173, 'psi': 0.9884539753169714}
[S16] not sending this round → trigger blocked (psi=0.987)
[S17] START round=34 head_norm_before_train=2.121794 (no previous merge yet)
[S17] round=34 local utility u=1.000000 metrics={'f1_val': 0.5681926420836219, 'auprc': 0.8127243766836036, 'loss_val': 1.4101892331299097, 'psi': 0.6660053359236147}-{'f1_val': 0.3627114007433555, 'auprc': 0.7536943905109663, 'loss_val': 2.3101522492660758, 'psi': 0.5191045966503999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=35 head_norm_before_train=2.158017 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6990950877744293, 'auprc': 0.7880675158830912, 'loss_val': 0.6908413640751927, 'psi': 0.734684059017894}-{'f1_val': 0.7100869354661008, 'auprc': 0.8370017844847002, 'loss_val': 0.5826179124987488, 'psi': 0.7608528750735406}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.678053 cos_to_last_merge=0.9974 (last merge round=31)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9597210218495094, 'auprc': 0.9997670696788393, 'loss_val': 0.14730157588851486, 'psi': 0.9757394409812413}-{'f1_val': 0.9972450390152456, 'auprc': 0.9997553428076533, 'loss_val': 0.059788525567865416, 'psi': 0.9982491605322087}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.613600 cos_to_last_merge=0.9652 (last merge round=24)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9406231797672178, 'auprc': 0.949230770900307, 'loss_val': 0.30499327221587696, 'psi': 0.9440662162204534}-{'f1_val': 0.9487548456238285, 'auprc': 0.9663462168268607, 'loss_val': 0.2890583112437386, 'psi': 0.9557913941050414}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.313594 cos_to_last_merge=0.9892 (last merge round=29)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.4282387038549641, 'auprc': 0.8347344628256913, 'loss_val': 0.8885149558028944, 'psi': 0.590837007443255}-{'f1_val': 0.7005679112968205, 'auprc': 0.9872022017729457, 'loss_val': 0.27110742612335637, 'psi': 0.8152216274872706}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.640308 cos_to_last_merge=0.9986 (last merge round=29)
[S6] round=35 local utility u=1.000000 metrics={'f1_val': 0.9778670039321331, 'auprc': 0.9700995798770139, 'loss_val': 0.1019713584478376, 'psi': 0.9747600343100854}-{'f1_val': 0.5790536185309758, 'auprc': 0.7889786205272729, 'loss_val': 0.8018661813754474, 'psi': 0.6630236193294947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=35 head_norm_before_train=1.676067 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.6100372616471643, 'auprc': 0.7922028655526361, 'loss_val': 0.6200397687854582, 'psi': 0.6829035032093531}-{'f1_val': 0.6728028351637227, 'auprc': 0.8282889761647658, 'loss_val': 0.3562180326123504, 'psi': 0.7349972915641401}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.789618 cos_to_last_merge=0.9406 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.941
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9929126860801906, 'auprc': 0.9851756573023235, 'loss_val': 0.05336826264476099, 'psi': 0.9898178745690437}-{'f1_val': 0.9932883265732785, 'auprc': 0.9906559019606207, 'loss_val': 0.04715748289037982, 'psi': 0.9922353567282154}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.416791 cos_to_last_merge=0.9975 (last merge round=29)
[S9] round=35 local utility u=0.004687 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9955994649611781, 'loss_val': 0.04466743334663369, 'psi': 0.9953390898184403}-{'f1_val': 0.9964101856672208, 'auprc': 0.9904248031191221, 'loss_val': 0.04598551261422662, 'psi': 0.9940160326479813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=35 head_norm_before_train=2.176766 (no previous merge yet)
[S10] round=35 local utility u=0.000892 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9926184614059744, 'loss_val': 0.02758397753896935, 'psi': 0.9938965500940133}-{'f1_val': 0.9937871219080217, 'auprc': 0.9946443031286587, 'loss_val': 0.02967579323434866, 'psi': 0.9941299943962765}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=35 head_norm_before_train=1.605256 cos_to_last_merge=0.9966 (last merge round=31)
[S11] round=35 local utility u=0.022430 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9961245165578075, 'loss_val': 0.06888423435035468, 'psi': 0.9961300115711086}-{'f1_val': 0.9913417689472677, 'auprc': 0.9961838072601192, 'loss_val': 0.08516998049914537, 'psi': 0.9932785842724082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=35 head_norm_before_train=1.455939 cos_to_last_merge=0.9566 (last merge round=25)
[S13] round=35 local utility u=0.012064 metrics={'f1_val': 0.6439929171991168, 'auprc': 0.7666494289358596, 'loss_val': 0.8133237120090444, 'psi': 0.6930555218938139}-{'f1_val': 0.658936941260255, 'auprc': 0.7555004713791599, 'loss_val': 0.8936687310781986, 'psi': 0.697562353307817}
[S13] not sending this round → trigger blocked (psi=0.693)
[S14] START round=35 head_norm_before_train=1.629496 cos_to_last_merge=0.9750 (last merge round=24)
[S14] round=35 local utility u=0.004871 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9986862751987948, 'loss_val': 0.08034879992365253, 'psi': 0.9979194717805533}-{'f1_val': 0.9972435617623723, 'auprc': 0.9990459285781779, 'loss_val': 0.09018150925227929, 'psi': 0.9979645084886946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=35 head_norm_before_train=2.197685 (no previous merge yet)
[S15] round=35 local utility u=0.361859 metrics={'f1_val': 0.9238701072580675, 'auprc': 0.9928425027745269, 'loss_val': 0.12279672324991263, 'psi': 0.9514590654646512}-{'f1_val': 0.8344254212993365, 'auprc': 0.991172315836675, 'loss_val': 0.30483547134789185, 'psi': 0.8971241791142719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=35 head_norm_before_train=1.820141 cos_to_last_merge=0.9949 (last merge round=30)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.94112898885815, 'auprc': 0.985525960445565, 'loss_val': 0.183139379956751, 'psi': 0.9588877774931159}-{'f1_val': 0.9900583960723177, 'auprc': 0.982593360344927, 'loss_val': 0.07971258933444603, 'psi': 0.9870723817813614}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=2.132929 (no previous merge yet)
[S17] round=35 local utility u=0.051802 metrics={'f1_val': 0.5918971088105657, 'auprc': 0.8377829583168621, 'loss_val': 1.523987911666427, 'psi': 0.6902514486130843}-{'f1_val': 0.5681926420836219, 'auprc': 0.8127243766836036, 'loss_val': 1.4101892331299097, 'psi': 0.6660053359236147}
[S17] not sending this round → trigger blocked (psi=0.690)
[S2] START round=36 head_norm_before_train=2.167903 (no previous merge yet)
[S2] round=36 local utility u=0.258646 metrics={'f1_val': 0.7103773667660109, 'auprc': 0.9099533956466788, 'loss_val': 0.6068999110438601, 'psi': 0.790207778318278}-{'f1_val': 0.6990950877744293, 'auprc': 0.7880675158830912, 'loss_val': 0.6908413640751927, 'psi': 0.734684059017894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=36 head_norm_before_train=1.703594 cos_to_last_merge=0.9960 (last merge round=31)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9242252681210226, 'auprc': 0.9994787333174002, 'loss_val': 0.17647682163654682, 'psi': 0.9543266541995736}-{'f1_val': 0.9597210218495094, 'auprc': 0.9997670696788393, 'loss_val': 0.14730157588851486, 'psi': 0.9757394409812413}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.629800 cos_to_last_merge=0.9633 (last merge round=24)
[S4] round=36 local utility u=0.053182 metrics={'f1_val': 0.9457002243326572, 'auprc': 0.9703553873428372, 'loss_val': 0.2924650221891609, 'psi': 0.9555622895367292}-{'f1_val': 0.9406231797672178, 'auprc': 0.949230770900307, 'loss_val': 0.30499327221587696, 'psi': 0.9440662162204534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=36 head_norm_before_train=1.331596 cos_to_last_merge=0.9869 (last merge round=29)
[S5] round=36 local utility u=1.000000 metrics={'f1_val': 0.7006542225197299, 'auprc': 0.9830318114205877, 'loss_val': 0.26587690983762846, 'psi': 0.813605258080073}-{'f1_val': 0.4282387038549641, 'auprc': 0.8347344628256913, 'loss_val': 0.8885149558028944, 'psi': 0.590837007443255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=36 head_norm_before_train=1.658578 cos_to_last_merge=0.9981 (last merge round=29)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.8000251426199512, 'auprc': 0.9508656485651401, 'loss_val': 0.6039777354680897, 'psi': 0.8603613449980267}-{'f1_val': 0.9778670039321331, 'auprc': 0.9700995798770139, 'loss_val': 0.1019713584478376, 'psi': 0.9747600343100854}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.681133 (no previous merge yet)
[S7] round=36 local utility u=0.250814 metrics={'f1_val': 0.6602429623731718, 'auprc': 0.8073468852682819, 'loss_val': 0.46507711999920315, 'psi': 0.7190845315312158}-{'f1_val': 0.6100372616471643, 'auprc': 0.7922028655526361, 'loss_val': 0.6200397687854582, 'psi': 0.6829035032093531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=36 head_norm_before_train=1.799470 cos_to_last_merge=0.9389 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.939
[S8] round=36 local utility u=0.000079 metrics={'f1_val': 0.9859393502901527, 'auprc': 0.9990774432377368, 'loss_val': 0.053076014481079584, 'psi': 0.9911945874691863}-{'f1_val': 0.9929126860801906, 'auprc': 0.9851756573023235, 'loss_val': 0.05336826264476099, 'psi': 0.9898178745690437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=36 head_norm_before_train=1.433073 cos_to_last_merge=0.9968 (last merge round=29)
[S9] round=36 local utility u=0.003556 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9939299280413991, 'loss_val': 0.04001566813298781, 'psi': 0.9954180826168921}-{'f1_val': 0.9951655063899485, 'auprc': 0.9955994649611781, 'loss_val': 0.04466743334663369, 'psi': 0.9953390898184403}
[S9] not sending this round → trigger blocked (psi=0.995)
[S10] START round=36 head_norm_before_train=2.188038 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9930896453135952, 'loss_val': 0.02793723810842165, 'psi': 0.9939028344432321}-{'f1_val': 0.9947486092193725, 'auprc': 0.9926184614059744, 'loss_val': 0.02758397753896935, 'psi': 0.9938965500940133}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.637050 cos_to_last_merge=0.9948 (last merge round=31)
[S11] round=36 local utility u=0.002841 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9968337181232687, 'loss_val': 0.06532914348448307, 'psi': 0.996413692197293}-{'f1_val': 0.9961336749133093, 'auprc': 0.9961245165578075, 'loss_val': 0.06888423435035468, 'psi': 0.9961300115711086}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=36 head_norm_before_train=1.466183 cos_to_last_merge=0.9551 (last merge round=25)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6335750240525607, 'auprc': 0.7459841343159448, 'loss_val': 0.9819732444034295, 'psi': 0.6785386681579144}-{'f1_val': 0.6439929171991168, 'auprc': 0.7666494289358596, 'loss_val': 0.8133237120090444, 'psi': 0.6930555218938139}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.653589 cos_to_last_merge=0.9722 (last merge round=24)
[S14] round=36 local utility u=0.003746 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9989820946253731, 'loss_val': 0.07141583999933356, 'psi': 0.9978050115238746}-{'f1_val': 0.9974082695017256, 'auprc': 0.9986862751987948, 'loss_val': 0.08034879992365253, 'psi': 0.9979194717805533}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=36 head_norm_before_train=2.207973 (no previous merge yet)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.815998515879497, 'auprc': 0.9877362419379893, 'loss_val': 0.42253544297328754, 'psi': 0.8846936063028938}-{'f1_val': 0.9238701072580675, 'auprc': 0.9928425027745269, 'loss_val': 0.12279672324991263, 'psi': 0.9514590654646512}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.840143 cos_to_last_merge=0.9936 (last merge round=30)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8576675617940678, 'auprc': 0.9869531595113551, 'loss_val': 0.5522294243409346, 'psi': 0.9093818008809826}-{'f1_val': 0.94112898885815, 'auprc': 0.985525960445565, 'loss_val': 0.183139379956751, 'psi': 0.9588877774931159}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=2.144437 (no previous merge yet)
[S17] round=36 local utility u=1.000000 metrics={'f1_val': 0.8095535568869043, 'auprc': 0.8562965002824325, 'loss_val': 0.662351575036602, 'psi': 0.8282507342451155}-{'f1_val': 0.5918971088105657, 'auprc': 0.8377829583168621, 'loss_val': 1.523987911666427, 'psi': 0.6902514486130843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=37 head_norm_before_train=2.176398 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.7101166019833638, 'auprc': 0.8692262731456973, 'loss_val': 0.5566070787712556, 'psi': 0.7737604704482972}-{'f1_val': 0.7103773667660109, 'auprc': 0.9099533956466788, 'loss_val': 0.6068999110438601, 'psi': 0.790207778318278}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.724097 cos_to_last_merge=0.9947 (last merge round=31)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.8980824345434761, 'auprc': 0.9984080575490681, 'loss_val': 0.17635662041495503, 'psi': 0.938212683745713}-{'f1_val': 0.9242252681210226, 'auprc': 0.9994787333174002, 'loss_val': 0.17647682163654682, 'psi': 0.9543266541995736}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.640848 cos_to_last_merge=0.9618 (last merge round=24)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9485545774213634, 'auprc': 0.9642412378019787, 'loss_val': 0.2939635649794939, 'psi': 0.9548292415736095}-{'f1_val': 0.9457002243326572, 'auprc': 0.9703553873428372, 'loss_val': 0.2924650221891609, 'psi': 0.9555622895367292}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.346027 cos_to_last_merge=0.9849 (last merge round=29)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.6380664740202628, 'auprc': 0.8527853616788479, 'loss_val': 0.4765801699638512, 'psi': 0.7239540290836969}-{'f1_val': 0.7006542225197299, 'auprc': 0.9830318114205877, 'loss_val': 0.26587690983762846, 'psi': 0.813605258080073}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.673133 cos_to_last_merge=0.9971 (last merge round=29)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6187188152801874, 'auprc': 0.9207880960089866, 'loss_val': 0.8830002663615651, 'psi': 0.739546527571707}-{'f1_val': 0.8000251426199512, 'auprc': 0.9508656485651401, 'loss_val': 0.6039777354680897, 'psi': 0.8603613449980267}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.689070 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5414865836385705, 'auprc': 0.7843838137575215, 'loss_val': 0.8846990827418809, 'psi': 0.6386454756861508}-{'f1_val': 0.6602429623731718, 'auprc': 0.8073468852682819, 'loss_val': 0.46507711999920315, 'psi': 0.7190845315312158}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.803348 cos_to_last_merge=0.9380 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.938
[S8] round=37 local utility u=0.023988 metrics={'f1_val': 0.9922164873423569, 'auprc': 0.9989642610916838, 'loss_val': 0.04242315022890791, 'psi': 0.9949155968420876}-{'f1_val': 0.9859393502901527, 'auprc': 0.9990774432377368, 'loss_val': 0.053076014481079584, 'psi': 0.9911945874691863}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=37 head_norm_before_train=1.448308 cos_to_last_merge=0.9962 (last merge round=29)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9926625779639688, 'auprc': 0.9957389819892806, 'loss_val': 0.043453282389663686, 'psi': 0.9938931395740935}-{'f1_val': 0.9964101856672208, 'auprc': 0.9939299280413991, 'loss_val': 0.04001566813298781, 'psi': 0.9954180826168921}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.196870 (no previous merge yet)
[S10] round=37 local utility u=0.001586 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9927762744696116, 'loss_val': 0.026963654077478274, 'psi': 0.9940914217068904}-{'f1_val': 0.9944449605296568, 'auprc': 0.9930896453135952, 'loss_val': 0.02793723810842165, 'psi': 0.9939028344432321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=37 head_norm_before_train=1.665264 cos_to_last_merge=0.9930 (last merge round=31)
[S11] round=37 local utility u=0.006004 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9972943022180114, 'loss_val': 0.0547021668256344, 'psi': 0.9965979258351901}-{'f1_val': 0.9961336749133093, 'auprc': 0.9968337181232687, 'loss_val': 0.06532914348448307, 'psi': 0.996413692197293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=37 head_norm_before_train=1.479699 cos_to_last_merge=0.9533 (last merge round=25)
[S13] round=37 local utility u=0.099594 metrics={'f1_val': 0.63735661138139, 'auprc': 0.774777982537716, 'loss_val': 0.8918572397352834, 'psi': 0.6923251598439204}-{'f1_val': 0.6335750240525607, 'auprc': 0.7459841343159448, 'loss_val': 0.9819732444034295, 'psi': 0.6785386681579144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=37 head_norm_before_train=1.676912 cos_to_last_merge=0.9694 (last merge round=24)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9592331134893162, 'auprc': 0.9990088526739453, 'loss_val': 0.09009645517690637, 'psi': 0.9751434091631679}-{'f1_val': 0.9970202894562089, 'auprc': 0.9989820946253731, 'loss_val': 0.07141583999933356, 'psi': 0.9978050115238746}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=2.218344 (no previous merge yet)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8046261238829964, 'auprc': 0.9774211743404191, 'loss_val': 0.478748960456954, 'psi': 0.8737441440659655}-{'f1_val': 0.815998515879497, 'auprc': 0.9877362419379893, 'loss_val': 0.42253544297328754, 'psi': 0.8846936063028938}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.857555 cos_to_last_merge=0.9925 (last merge round=30)
[S16] round=37 local utility u=0.013505 metrics={'f1_val': 0.860672309718725, 'auprc': 0.9866905057689487, 'loss_val': 0.5424589679721202, 'psi': 0.9110795881388145}-{'f1_val': 0.8576675617940678, 'auprc': 0.9869531595113551, 'loss_val': 0.5522294243409346, 'psi': 0.9093818008809826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=37 head_norm_before_train=2.155297 (no previous merge yet)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6088406096255343, 'auprc': 0.9192901490702956, 'loss_val': 1.5424528310494348, 'psi': 0.7330204254034389}-{'f1_val': 0.8095535568869043, 'auprc': 0.8562965002824325, 'loss_val': 0.662351575036602, 'psi': 0.8282507342451155}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=2.188630 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6431749917234688, 'auprc': 0.739185876796698, 'loss_val': 0.9658443015978199, 'psi': 0.6815793457527605}-{'f1_val': 0.7101166019833638, 'auprc': 0.8692262731456973, 'loss_val': 0.5566070787712556, 'psi': 0.7737604704482972}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.742297 cos_to_last_merge=0.9936 (last merge round=31)
[S3] round=38 local utility u=0.163640 metrics={'f1_val': 0.9522165639571257, 'auprc': 0.9996870690498085, 'loss_val': 0.1777192244578446, 'psi': 0.9712047659941988}-{'f1_val': 0.8980824345434761, 'auprc': 0.9984080575490681, 'loss_val': 0.17635662041495503, 'psi': 0.938212683745713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=38 head_norm_before_train=1.650095 cos_to_last_merge=0.9606 (last merge round=24)
[S4] round=38 local utility u=0.007970 metrics={'f1_val': 0.9451116716245231, 'auprc': 0.9734756667218661, 'loss_val': 0.2850691724569638, 'psi': 0.9564572696634603}-{'f1_val': 0.9485545774213634, 'auprc': 0.9642412378019787, 'loss_val': 0.2939635649794939, 'psi': 0.9548292415736095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=38 head_norm_before_train=1.359298 cos_to_last_merge=0.9835 (last merge round=29)
[S5] round=38 local utility u=0.349694 metrics={'f1_val': 0.7005672661245418, 'auprc': 0.9094753457652028, 'loss_val': 0.3222660945505255, 'psi': 0.7841304979808061}-{'f1_val': 0.6380664740202628, 'auprc': 0.8527853616788479, 'loss_val': 0.4765801699638512, 'psi': 0.7239540290836969}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=38 head_norm_before_train=1.686036 cos_to_last_merge=0.9961 (last merge round=29)
[S6] round=38 local utility u=1.000000 metrics={'f1_val': 0.9332989088254635, 'auprc': 0.9466179247239592, 'loss_val': 0.20366699548790695, 'psi': 0.9386265151848617}-{'f1_val': 0.6187188152801874, 'auprc': 0.9207880960089866, 'loss_val': 0.8830002663615651, 'psi': 0.739546527571707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=38 head_norm_before_train=1.694861 (no previous merge yet)
[S7] round=38 local utility u=0.312152 metrics={'f1_val': 0.6015630135805117, 'auprc': 0.7948976999416751, 'loss_val': 0.6523953629174792, 'psi': 0.6788968881249771}-{'f1_val': 0.5414865836385705, 'auprc': 0.7843838137575215, 'loss_val': 0.8846990827418809, 'psi': 0.6386454756861508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=38 head_norm_before_train=1.814166 cos_to_last_merge=0.9366 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.937
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9918532151771823, 'auprc': 0.998928085239495, 'loss_val': 0.041377166015677036, 'psi': 0.9946831632021074}-{'f1_val': 0.9922164873423569, 'auprc': 0.9989642610916838, 'loss_val': 0.04242315022890791, 'psi': 0.9949155968420876}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.462666 cos_to_last_merge=0.9956 (last merge round=29)
[S9] round=38 local utility u=0.007258 metrics={'f1_val': 0.9947496160742828, 'auprc': 0.9955230059912807, 'loss_val': 0.040810839032302426, 'psi': 0.9950589720410821}-{'f1_val': 0.9926625779639688, 'auprc': 0.9957389819892806, 'loss_val': 0.043453282389663686, 'psi': 0.9938931395740935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=38 head_norm_before_train=2.200646 (no previous merge yet)
[S10] round=38 local utility u=0.001265 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9935511273215616, 'loss_val': 0.02675820507684864, 'psi': 0.9944013628476703}-{'f1_val': 0.9949681865317428, 'auprc': 0.9927762744696116, 'loss_val': 0.026963654077478274, 'psi': 0.9940914217068904}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=38 head_norm_before_train=1.690710 cos_to_last_merge=0.9913 (last merge round=31)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.992057659284118, 'auprc': 0.9975899660615367, 'loss_val': 0.05431446370976948, 'psi': 0.9942705819950854}-{'f1_val': 0.9961336749133093, 'auprc': 0.9972943022180114, 'loss_val': 0.0547021668256344, 'psi': 0.9965979258351901}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.493632 cos_to_last_merge=0.9513 (last merge round=25)
[S13] round=38 local utility u=0.370973 metrics={'f1_val': 0.7217808611619199, 'auprc': 0.7904619157715208, 'loss_val': 0.7035089409673388, 'psi': 0.7492532830057603}-{'f1_val': 0.63735661138139, 'auprc': 0.774777982537716, 'loss_val': 0.8918572397352834, 'psi': 0.6923251598439204}
[S13] not sending this round → trigger blocked (psi=0.749)
[S14] START round=38 head_norm_before_train=1.699666 cos_to_last_merge=0.9667 (last merge round=24)
[S14] round=38 local utility u=0.130985 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9990431649935366, 'loss_val': 0.05596038239196681, 'psi': 0.9979301871995286}-{'f1_val': 0.9592331134893162, 'auprc': 0.9990088526739453, 'loss_val': 0.09009645517690637, 'psi': 0.9751434091631679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=38 head_norm_before_train=2.229244 (no previous merge yet)
[S15] round=38 local utility u=0.303771 metrics={'f1_val': 0.8691041995304873, 'auprc': 0.9946882795000467, 'loss_val': 0.30987765090501995, 'psi': 0.919337831518311}-{'f1_val': 0.8046261238829964, 'auprc': 0.9774211743404191, 'loss_val': 0.478748960456954, 'psi': 0.8737441440659655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=38 head_norm_before_train=1.872343 cos_to_last_merge=0.9915 (last merge round=30)
[S16] round=38 local utility u=0.345375 metrics={'f1_val': 0.932788972645024, 'auprc': 0.9865410217696755, 'loss_val': 0.28396096089219774, 'psi': 0.9542897922948845}-{'f1_val': 0.860672309718725, 'auprc': 0.9866905057689487, 'loss_val': 0.5424589679721202, 'psi': 0.9110795881388145}
[S16] not sending this round → trigger blocked (psi=0.954)
[S17] START round=38 head_norm_before_train=2.168092 (no previous merge yet)
[S17] round=38 local utility u=0.407100 metrics={'f1_val': 0.6444798248233721, 'auprc': 0.9480969043785978, 'loss_val': 1.0285088948781593, 'psi': 0.7659266566454623}-{'f1_val': 0.6088406096255343, 'auprc': 0.9192901490702956, 'loss_val': 1.5424528310494348, 'psi': 0.7330204254034389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=39 head_norm_before_train=2.195933 (no previous merge yet)
[S2] round=39 local utility u=0.478045 metrics={'f1_val': 0.7093856577516336, 'auprc': 0.8194894748382535, 'loss_val': 0.6479282729885973, 'psi': 0.7534271845862817}-{'f1_val': 0.6431749917234688, 'auprc': 0.739185876796698, 'loss_val': 0.9658443015978199, 'psi': 0.6815793457527605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S2] r=40 psi=0.753 u=0.4780 p_local=0.2044 f1=0.709 auprc=0.819 bytes=30603
[S3] START round=39 head_norm_before_train=1.759618 cos_to_last_merge=0.9926 (last merge round=31)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.8592202162436545, 'auprc': 0.9986583582239015, 'loss_val': 0.21841891828499937, 'psi': 0.9149954730357532}-{'f1_val': 0.9522165639571257, 'auprc': 0.9996870690498085, 'loss_val': 0.1777192244578446, 'psi': 0.9712047659941988}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.915 u=0.0000 p_local=0.0586 f1=0.859 auprc=0.999 bytes=41371
[S4] START round=39 head_norm_before_train=1.661003 cos_to_last_merge=0.9593 (last merge round=24)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9157040961966505, 'auprc': 0.9161303888982213, 'loss_val': 0.4144061285709045, 'psi': 0.9158746132772788}-{'f1_val': 0.9451116716245231, 'auprc': 0.9734756667218661, 'loss_val': 0.2850691724569638, 'psi': 0.9564572696634603}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.916 u=0.0000 p_local=0.0128 f1=0.916 auprc=0.916 bytes=43171
[S5] START round=39 head_norm_before_train=1.370555 cos_to_last_merge=0.9822 (last merge round=29)
[S5] round=39 local utility u=0.142647 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9853883710029141, 'loss_val': 0.26427174178004087, 'psi': 0.8144516680668394}-{'f1_val': 0.7005672661245418, 'auprc': 0.9094753457652028, 'loss_val': 0.3222660945505255, 'psi': 0.7841304979808061}
[S5] not sending this round → trigger blocked (psi=0.814)
[S5] r=40 psi=0.814 u=0.1426 p_local=0.3012 f1=0.700 auprc=0.985 bytes=35965
[S6] START round=39 head_norm_before_train=1.709964 cos_to_last_merge=0.9957 (last merge round=29)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.5990360584439033, 'auprc': 0.9309429585431127, 'loss_val': 1.1089748867842817, 'psi': 0.7317988184835871}-{'f1_val': 0.9332989088254635, 'auprc': 0.9466179247239592, 'loss_val': 0.20366699548790695, 'psi': 0.9386265151848617}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.732 u=0.0000 p_local=0.3133 f1=0.599 auprc=0.931 bytes=34188
[S7] START round=39 head_norm_before_train=1.700667 (no previous merge yet)
[S7] round=39 local utility u=0.279409 metrics={'f1_val': 0.6469473355766042, 'auprc': 0.8101107986762247, 'loss_val': 0.41152187728779205, 'psi': 0.7122127208164524}-{'f1_val': 0.6015630135805117, 'auprc': 0.7948976999416751, 'loss_val': 0.6523953629174792, 'psi': 0.6788968881249771}
[S7] not sending this round → trigger blocked (psi=0.712)
[S7] r=40 psi=0.712 u=0.2794 p_local=0.2734 f1=0.647 auprc=0.810 bytes=37817
[S8] START round=39 head_norm_before_train=1.826174 cos_to_last_merge=0.9350 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.935
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9927318893430277, 'auprc': 0.9916355830324683, 'loss_val': 0.04067210715948067, 'psi': 0.9922933668188039}-{'f1_val': 0.9918532151771823, 'auprc': 0.998928085239495, 'loss_val': 0.041377166015677036, 'psi': 0.9946831632021074}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.992 u=0.0000 p_local=0.0114 f1=0.993 auprc=0.992 bytes=37814
[S9] START round=39 head_norm_before_train=1.475161 cos_to_last_merge=0.9951 (last merge round=29)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9893333942897439, 'loss_val': 0.036103132510763525, 'psi': 0.9937488524747549}-{'f1_val': 0.9947496160742828, 'auprc': 0.9955230059912807, 'loss_val': 0.040810839032302426, 'psi': 0.9950589720410821}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.994 u=0.0000 p_local=0.0067 f1=0.997 auprc=0.989 bytes=39531
[S10] START round=39 head_norm_before_train=2.204355 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9939756169156696, 'loss_val': 0.02707155198120369, 'psi': 0.9943888797719177}-{'f1_val': 0.9949681865317428, 'auprc': 0.9935511273215616, 'loss_val': 0.02675820507684864, 'psi': 0.9944013628476703}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.994 u=0.0000 p_local=0.0014 f1=0.995 auprc=0.994 bytes=41384
[S11] START round=39 head_norm_before_train=1.714230 cos_to_last_merge=0.9897 (last merge round=31)
[S11] round=39 local utility u=0.016753 metrics={'f1_val': 0.9954113368503568, 'auprc': 0.9976210883021928, 'loss_val': 0.04102380501795058, 'psi': 0.9962952374310912}-{'f1_val': 0.992057659284118, 'auprc': 0.9975899660615367, 'loss_val': 0.05431446370976948, 'psi': 0.9942705819950854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S11] r=40 psi=0.996 u=0.0168 p_local=0.0187 f1=0.995 auprc=0.998 bytes=44962
[S13] START round=39 head_norm_before_train=1.507903 cos_to_last_merge=0.9489 (last merge round=25)
[S13] ⚠️ Model drifted since last merge! cos=0.949
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.7239815867320613, 'auprc': 0.7604456212551987, 'loss_val': 0.8484697123708612, 'psi': 0.7385672005413162}-{'f1_val': 0.7217808611619199, 'auprc': 0.7904619157715208, 'loss_val': 0.7035089409673388, 'psi': 0.7492532830057603}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.739 u=0.0000 p_local=0.1017 f1=0.724 auprc=0.760 bytes=32386
[S14] START round=39 head_norm_before_train=1.718981 cos_to_last_merge=0.9643 (last merge round=24)
[S14] round=39 local utility u=0.000963 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9989783477175102, 'loss_val': 0.051393295903186045, 'psi': 0.9976596435912873}-{'f1_val': 0.9971882020035234, 'auprc': 0.9990431649935366, 'loss_val': 0.05596038239196681, 'psi': 0.9979301871995286}
[S14] not sending this round → trigger blocked (psi=0.998)
[S14] r=40 psi=0.998 u=0.0010 p_local=0.0394 f1=0.997 auprc=0.999 bytes=41337
[S15] START round=39 head_norm_before_train=2.240890 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.8557789603652719, 'auprc': 0.9928843454512382, 'loss_val': 0.3218858863365161, 'psi': 0.9106211143996584}-{'f1_val': 0.8691041995304873, 'auprc': 0.9946882795000467, 'loss_val': 0.30987765090501995, 'psi': 0.919337831518311}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.911 u=0.0000 p_local=0.1596 f1=0.856 auprc=0.993 bytes=34125
[S16] START round=39 head_norm_before_train=1.886471 cos_to_last_merge=0.9906 (last merge round=30)
[S16] round=39 local utility u=0.120017 metrics={'f1_val': 0.948882153596978, 'auprc': 0.9869936567644345, 'loss_val': 0.14184455938457172, 'psi': 0.9641267548639607}-{'f1_val': 0.932788972645024, 'auprc': 0.9865410217696755, 'loss_val': 0.28396096089219774, 'psi': 0.9542897922948845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S16] r=40 psi=0.964 u=0.1200 p_local=0.1085 f1=0.949 auprc=0.987 bytes=39576
[S17] START round=39 head_norm_before_train=2.177143 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6607875791911861, 'auprc': 0.9033559117973042, 'loss_val': 1.1728776590695416, 'psi': 0.7578149122336334}-{'f1_val': 0.6444798248233721, 'auprc': 0.9480969043785978, 'loss_val': 1.0285088948781593, 'psi': 0.7659266566454623}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.758 u=0.0000 p_local=0.2785 f1=0.661 auprc=0.903 bytes=39595
[S2] START round=40 head_norm_before_train=2.200716 (no previous merge yet)
[S2] round=40 local utility u=0.152184 metrics={'f1_val': 0.7941013018737353, 'auprc': 0.7212641935940485, 'loss_val': 0.5571781077256269, 'psi': 0.7649664585618605}-{'f1_val': 0.7093856577516336, 'auprc': 0.8194894748382535, 'loss_val': 0.6479282729885973, 'psi': 0.7534271845862817}
[S2] not sending this round → trigger blocked (psi=0.765)
[S3] START round=40 head_norm_before_train=1.777044 cos_to_last_merge=0.9916 (last merge round=31)
[S3] round=40 local utility u=0.379107 metrics={'f1_val': 0.964511941634489, 'auprc': 0.9990109410677606, 'loss_val': 0.0930128249822718, 'psi': 0.9783115414077975}-{'f1_val': 0.8592202162436545, 'auprc': 0.9986583582239015, 'loss_val': 0.21841891828499937, 'psi': 0.9149954730357532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=40 head_norm_before_train=1.670734 cos_to_last_merge=0.9581 (last merge round=24)
[S4] round=40 local utility u=0.189707 metrics={'f1_val': 0.9407378166935755, 'auprc': 0.9562957637842449, 'loss_val': 0.3056902460076597, 'psi': 0.9469609955298433}-{'f1_val': 0.9157040961966505, 'auprc': 0.9161303888982213, 'loss_val': 0.4144061285709045, 'psi': 0.9158746132772788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=40 head_norm_before_train=1.386258 cos_to_last_merge=0.9802 (last merge round=29)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.6371957407712897, 'auprc': 0.8614589261594944, 'loss_val': 0.41553325657902074, 'psi': 0.7269010149265716}-{'f1_val': 0.7004938661094564, 'auprc': 0.9853883710029141, 'loss_val': 0.26427174178004087, 'psi': 0.8144516680668394}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.731688 cos_to_last_merge=0.9949 (last merge round=29)
[S6] round=40 local utility u=0.619161 metrics={'f1_val': 0.716826640723387, 'auprc': 0.9541544582299115, 'loss_val': 0.647031045305772, 'psi': 0.8117577677259968}-{'f1_val': 0.5990360584439033, 'auprc': 0.9309429585431127, 'loss_val': 1.1089748867842817, 'psi': 0.7317988184835871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=40 head_norm_before_train=1.708073 (no previous merge yet)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6308979434336198, 'auprc': 0.8047321309638249, 'loss_val': 0.4773658101971339, 'psi': 0.7004316184457019}-{'f1_val': 0.6469473355766042, 'auprc': 0.8101107986762247, 'loss_val': 0.41152187728779205, 'psi': 0.7122127208164524}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.836667 cos_to_last_merge=0.9338 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.934
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.7135780681239317, 'auprc': 0.9862347895929839, 'loss_val': 0.4905525436859732, 'psi': 0.8226407567115526}-{'f1_val': 0.9927318893430277, 'auprc': 0.9916355830324683, 'loss_val': 0.04067210715948067, 'psi': 0.9922933668188039}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.486543 cos_to_last_merge=0.9945 (last merge round=29)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9935285262166678, 'auprc': 0.9963647847309085, 'loss_val': 0.03864880414825039, 'psi': 0.994663029622364}-{'f1_val': 0.9966924912647621, 'auprc': 0.9893333942897439, 'loss_val': 0.036103132510763525, 'psi': 0.9937488524747549}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.213812 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9934000393253861, 'loss_val': 0.026816079027380674, 'psi': 0.9941586487358043}-{'f1_val': 0.9946643883427498, 'auprc': 0.9939756169156696, 'loss_val': 0.02707155198120369, 'psi': 0.9943888797719177}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.735105 cos_to_last_merge=0.9881 (last merge round=31)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9524591903180911, 'auprc': 0.9962710854664596, 'loss_val': 0.09812412297762865, 'psi': 0.9699839483774385}-{'f1_val': 0.9954113368503568, 'auprc': 0.9976210883021928, 'loss_val': 0.04102380501795058, 'psi': 0.9962952374310912}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.523469 cos_to_last_merge=0.9470 (last merge round=25)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6291014909584475, 'auprc': 0.7026800367909523, 'loss_val': 1.0780227385445378, 'psi': 0.6585329092914494}-{'f1_val': 0.7239815867320613, 'auprc': 0.7604456212551987, 'loss_val': 0.8484697123708612, 'psi': 0.7385672005413162}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.737724 cos_to_last_merge=0.9621 (last merge round=24)
[S14] round=40 local utility u=0.002643 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9990410478833608, 'loss_val': 0.04759739020684382, 'psi': 0.9978149240479434}-{'f1_val': 0.9967805075071389, 'auprc': 0.9989783477175102, 'loss_val': 0.051393295903186045, 'psi': 0.9976596435912873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=40 head_norm_before_train=2.251352 (no previous merge yet)
[S15] round=40 local utility u=0.581971 metrics={'f1_val': 0.9967036286230888, 'auprc': 0.998162028379881, 'loss_val': 0.019325568227383495, 'psi': 0.9972869885258058}-{'f1_val': 0.8557789603652719, 'auprc': 0.9928843454512382, 'loss_val': 0.3218858863365161, 'psi': 0.9106211143996584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=40 head_norm_before_train=1.899793 cos_to_last_merge=0.9898 (last merge round=30)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8575284589459273, 'auprc': 0.9848034154886451, 'loss_val': 0.6353050786325661, 'psi': 0.9084384415630145}-{'f1_val': 0.948882153596978, 'auprc': 0.9869936567644345, 'loss_val': 0.14184455938457172, 'psi': 0.9641267548639607}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=2.187182 (no previous merge yet)
[S17] round=40 local utility u=0.080470 metrics={'f1_val': 0.6428701047972772, 'auprc': 0.9709454633630108, 'loss_val': 1.1072008044328427, 'psi': 0.7741002482235707}-{'f1_val': 0.6607875791911861, 'auprc': 0.9033559117973042, 'loss_val': 1.1728776590695416, 'psi': 0.7578149122336334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=41 head_norm_before_train=2.206108 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7103773667660109, 'auprc': 0.8748567449079744, 'loss_val': 0.6375559011634608, 'psi': 0.7761691180227963}-{'f1_val': 0.7941013018737353, 'auprc': 0.7212641935940485, 'loss_val': 0.5571781077256269, 'psi': 0.7649664585618605}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.794066 cos_to_last_merge=0.9906 (last merge round=31)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9437996897595455, 'auprc': 0.9993765787038354, 'loss_val': 0.18143337495606268, 'psi': 0.9660304453372616}-{'f1_val': 0.964511941634489, 'auprc': 0.9990109410677606, 'loss_val': 0.0930128249822718, 'psi': 0.9783115414077975}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.680581 cos_to_last_merge=0.9567 (last merge round=24)
[S4] round=41 local utility u=0.025439 metrics={'f1_val': 0.9456847954781629, 'auprc': 0.9605420561046365, 'loss_val': 0.2972333218571415, 'psi': 0.9516276997287523}-{'f1_val': 0.9407378166935755, 'auprc': 0.9562957637842449, 'loss_val': 0.3056902460076597, 'psi': 0.9469609955298433}
[S4] not sending this round → trigger blocked (psi=0.952)
[S5] START round=41 head_norm_before_train=1.399109 cos_to_last_merge=0.9788 (last merge round=29)
[S5] round=41 local utility u=0.253061 metrics={'f1_val': 0.7004809549016324, 'auprc': 0.8823647258507856, 'loss_val': 0.35184059241660093, 'psi': 0.7732344632812937}-{'f1_val': 0.6371957407712897, 'auprc': 0.8614589261594944, 'loss_val': 0.41553325657902074, 'psi': 0.7269010149265716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] START round=41 head_norm_before_train=1.745478 cos_to_last_merge=0.9941 (last merge round=29)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.6002348242992654, 'auprc': 0.8802330972968989, 'loss_val': 1.0644431342645935, 'psi': 0.7122341334983189}-{'f1_val': 0.716826640723387, 'auprc': 0.9541544582299115, 'loss_val': 0.647031045305772, 'psi': 0.8117577677259968}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.717905 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5591055104808166, 'auprc': 0.7854878212431659, 'loss_val': 0.8609712836742621, 'psi': 0.6496584347857564}-{'f1_val': 0.6308979434336198, 'auprc': 0.8047321309638249, 'loss_val': 0.4773658101971339, 'psi': 0.7004316184457019}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.846253 cos_to_last_merge=0.9325 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.933
[S8] round=41 local utility u=1.000000 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9986308574219561, 'loss_val': 0.03898084999826619, 'psi': 0.9947764989274672}-{'f1_val': 0.7135780681239317, 'auprc': 0.9862347895929839, 'loss_val': 0.4905525436859732, 'psi': 0.8226407567115526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=41 head_norm_before_train=1.498375 cos_to_last_merge=0.9940 (last merge round=29)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9871765865591023, 'auprc': 0.9958932062469119, 'loss_val': 0.05969851073270809, 'psi': 0.9906632344342262}-{'f1_val': 0.9935285262166678, 'auprc': 0.9963647847309085, 'loss_val': 0.03864880414825039, 'psi': 0.994663029622364}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=2.225259 (no previous merge yet)
[S10] round=41 local utility u=0.001184 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9931898115940714, 'loss_val': 0.026451678274100967, 'psi': 0.9943380054832875}-{'f1_val': 0.9946643883427498, 'auprc': 0.9934000393253861, 'loss_val': 0.026816079027380674, 'psi': 0.9941586487358043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=41 head_norm_before_train=1.752816 cos_to_last_merge=0.9868 (last merge round=31)
[S11] round=41 local utility u=0.093753 metrics={'f1_val': 0.9803759370138978, 'auprc': 0.9961046937936779, 'loss_val': 0.0776187581040656, 'psi': 0.9866674397258098}-{'f1_val': 0.9524591903180911, 'auprc': 0.9962710854664596, 'loss_val': 0.09812412297762865, 'psi': 0.9699839483774385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=41 head_norm_before_train=1.542187 cos_to_last_merge=0.9451 (last merge round=25)
[S13] ⚠️ Model drifted since last merge! cos=0.945
[S13] round=41 local utility u=0.309611 metrics={'f1_val': 0.6618612248449017, 'auprc': 0.7785728814189105, 'loss_val': 0.8830381632116598, 'psi': 0.7085458874745052}-{'f1_val': 0.6291014909584475, 'auprc': 0.7026800367909523, 'loss_val': 1.0780227385445378, 'psi': 0.6585329092914494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=41 head_norm_before_train=1.752698 cos_to_last_merge=0.9603 (last merge round=24)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9968861674421835, 'loss_val': 0.04820039348883638, 'psi': 0.9970673881789874}-{'f1_val': 0.9969975081576651, 'auprc': 0.9990410478833608, 'loss_val': 0.04759739020684382, 'psi': 0.9978149240479434}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=2.261750 (no previous merge yet)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.8095596244949437, 'auprc': 0.9915087400144412, 'loss_val': 0.45845371127692747, 'psi': 0.8823392707027427}-{'f1_val': 0.9967036286230888, 'auprc': 0.998162028379881, 'loss_val': 0.019325568227383495, 'psi': 0.9972869885258058}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.911447 cos_to_last_merge=0.9891 (last merge round=30)
[S16] round=41 local utility u=0.689931 metrics={'f1_val': 0.991971798497276, 'auprc': 0.9836278242047942, 'loss_val': 0.058575974980714214, 'psi': 0.9886342087802833}-{'f1_val': 0.8575284589459273, 'auprc': 0.9848034154886451, 'loss_val': 0.6353050786325661, 'psi': 0.9084384415630145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=41 head_norm_before_train=2.199317 (no previous merge yet)
[S17] round=41 local utility u=0.108116 metrics={'f1_val': 0.68339539347171, 'auprc': 0.957539779412876, 'loss_val': 1.0939040307953454, 'psi': 0.7930531478481764}-{'f1_val': 0.6428701047972772, 'auprc': 0.9709454633630108, 'loss_val': 1.1072008044328427, 'psi': 0.7741002482235707}
[S17] not sending this round → trigger blocked (psi=0.793)
[S2] START round=42 head_norm_before_train=2.213461 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.641938562112308, 'auprc': 0.7790682055880074, 'loss_val': 1.1405622092464456, 'psi': 0.6967904195025878}-{'f1_val': 0.7103773667660109, 'auprc': 0.8748567449079744, 'loss_val': 0.6375559011634608, 'psi': 0.7761691180227963}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.809925 cos_to_last_merge=0.9897 (last merge round=31)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9283553926868979, 'auprc': 0.9990209396453907, 'loss_val': 0.13608727736651421, 'psi': 0.9566216114702951}-{'f1_val': 0.9437996897595455, 'auprc': 0.9993765787038354, 'loss_val': 0.18143337495606268, 'psi': 0.9660304453372616}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.686157 cos_to_last_merge=0.9559 (last merge round=24)
[S4] round=42 local utility u=0.018218 metrics={'f1_val': 0.9490687491559342, 'auprc': 0.9647804814853176, 'loss_val': 0.29381612903277426, 'psi': 0.9553534420876875}-{'f1_val': 0.9456847954781629, 'auprc': 0.9605420561046365, 'loss_val': 0.2972333218571415, 'psi': 0.9516276997287523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=42 head_norm_before_train=1.417609 cos_to_last_merge=0.9771 (last merge round=29)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.4399983233072962, 'auprc': 0.8471716265903938, 'loss_val': 0.9152216532550049, 'psi': 0.6028676446205352}-{'f1_val': 0.7004809549016324, 'auprc': 0.8823647258507856, 'loss_val': 0.35184059241660093, 'psi': 0.7732344632812937}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.761645 cos_to_last_merge=0.9938 (last merge round=29)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.8203832378451849, 'auprc': 0.9586071562664785, 'loss_val': 0.5072995226269429, 'psi': 0.8756728052137024}-{'f1_val': 0.6002348242992654, 'auprc': 0.8802330972968989, 'loss_val': 1.0644431342645935, 'psi': 0.7122341334983189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=42 head_norm_before_train=1.727472 (no previous merge yet)
[S7] round=42 local utility u=0.417075 metrics={'f1_val': 0.640231480472063, 'auprc': 0.803781880576141, 'loss_val': 0.5684591702530114, 'psi': 0.7056516405136941}-{'f1_val': 0.5591055104808166, 'auprc': 0.7854878212431659, 'loss_val': 0.8609712836742621, 'psi': 0.6496584347857564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=42 head_norm_before_train=1.851214 cos_to_last_merge=0.9318 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.932
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9850292659535449, 'auprc': 0.9989895497306666, 'loss_val': 0.05477462066396267, 'psi': 0.9906133794643935}-{'f1_val': 0.9922069265978078, 'auprc': 0.9986308574219561, 'loss_val': 0.03898084999826619, 'psi': 0.9947764989274672}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.509197 cos_to_last_merge=0.9935 (last merge round=29)
[S9] round=42 local utility u=0.029747 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9886815796631414, 'loss_val': 0.03301031905776282, 'psi': 0.9932226887328232}-{'f1_val': 0.9871765865591023, 'auprc': 0.9958932062469119, 'loss_val': 0.05969851073270809, 'psi': 0.9906632344342262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=42 head_norm_before_train=2.232778 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9944407274415453, 'loss_val': 0.027156961795439388, 'psi': 0.9944432672944122}-{'f1_val': 0.9951034680760983, 'auprc': 0.9931898115940714, 'loss_val': 0.026451678274100967, 'psi': 0.9943380054832875}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.769783 cos_to_last_merge=0.9855 (last merge round=31)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9353029304502611, 'auprc': 0.9961120328052828, 'loss_val': 0.10554674485800804, 'psi': 0.9596265713922698}-{'f1_val': 0.9803759370138978, 'auprc': 0.9961046937936779, 'loss_val': 0.0776187581040656, 'psi': 0.9866674397258098}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.552195 cos_to_last_merge=0.9439 (last merge round=25)
[S13] ⚠️ Model drifted since last merge! cos=0.944
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6442901192683474, 'auprc': 0.7275612696459647, 'loss_val': 1.0660693359054012, 'psi': 0.6775985794193944}-{'f1_val': 0.6618612248449017, 'auprc': 0.7785728814189105, 'loss_val': 0.8830381632116598, 'psi': 0.7085458874745052}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.768054 cos_to_last_merge=0.9585 (last merge round=24)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9957842923784934, 'loss_val': 0.04489591123395344, 'psi': 0.9962499437216561}-{'f1_val': 0.9971882020035234, 'auprc': 0.9968861674421835, 'loss_val': 0.04820039348883638, 'psi': 0.9970673881789874}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=2.272132 (no previous merge yet)
[S15] round=42 local utility u=0.789301 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9972894953974076, 'loss_val': 0.02031711268220613, 'psi': 0.9969637991914754}-{'f1_val': 0.8095596244949437, 'auprc': 0.9915087400144412, 'loss_val': 0.45845371127692747, 'psi': 0.8823392707027427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=42 head_norm_before_train=1.921361 cos_to_last_merge=0.9885 (last merge round=30)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9910643600248928, 'auprc': 0.9830263826634644, 'loss_val': 0.052500247125971844, 'psi': 0.9878491690803215}-{'f1_val': 0.991971798497276, 'auprc': 0.9836278242047942, 'loss_val': 0.058575974980714214, 'psi': 0.9886342087802833}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=2.208363 (no previous merge yet)
[S17] round=42 local utility u=0.892978 metrics={'f1_val': 0.8787722643570673, 'auprc': 0.9817708474644666, 'loss_val': 0.5529022217013643, 'psi': 0.919971697600027}-{'f1_val': 0.68339539347171, 'auprc': 0.957539779412876, 'loss_val': 1.0939040307953454, 'psi': 0.7930531478481764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=43 head_norm_before_train=2.220863 (no previous merge yet)
[S2] round=43 local utility u=0.048257 metrics={'f1_val': 0.6477696458355956, 'auprc': 0.7638912249509064, 'loss_val': 1.0335039147124434, 'psi': 0.6942182774817199}-{'f1_val': 0.641938562112308, 'auprc': 0.7790682055880074, 'loss_val': 1.1405622092464456, 'psi': 0.6967904195025878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=43 head_norm_before_train=1.824552 cos_to_last_merge=0.9888 (last merge round=31)
[S3] round=43 local utility u=0.008860 metrics={'f1_val': 0.9298657204595457, 'auprc': 0.9985843141673091, 'loss_val': 0.1261196386650421, 'psi': 0.9573531579426511}-{'f1_val': 0.9283553926868979, 'auprc': 0.9990209396453907, 'loss_val': 0.13608727736651421, 'psi': 0.9566216114702951}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=43 head_norm_before_train=1.692293 cos_to_last_merge=0.9550 (last merge round=24)
[S4] round=43 local utility u=0.027456 metrics={'f1_val': 0.9547830083049464, 'auprc': 0.9697442099367268, 'loss_val': 0.2880806716680987, 'psi': 0.9607674889576585}-{'f1_val': 0.9490687491559342, 'auprc': 0.9647804814853176, 'loss_val': 0.29381612903277426, 'psi': 0.9553534420876875}
[S4] not sending this round → trigger blocked (psi=0.961)
[S5] START round=43 head_norm_before_train=1.434945 cos_to_last_merge=0.9754 (last merge round=29)
[S5] round=43 local utility u=1.000000 metrics={'f1_val': 0.6684732488735179, 'auprc': 0.9643478372062484, 'loss_val': 0.27005355077502546, 'psi': 0.7868230842066102}-{'f1_val': 0.4399983233072962, 'auprc': 0.8471716265903938, 'loss_val': 0.9152216532550049, 'psi': 0.6028676446205352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=43 head_norm_before_train=1.776192 cos_to_last_merge=0.9936 (last merge round=29)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.7272482704646044, 'auprc': 0.9492316126707582, 'loss_val': 0.766246196899379, 'psi': 0.816041607347066}-{'f1_val': 0.8203832378451849, 'auprc': 0.9586071562664785, 'loss_val': 0.5072995226269429, 'psi': 0.8756728052137024}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.734478 (no previous merge yet)
[S7] round=43 local utility u=0.308876 metrics={'f1_val': 0.678799456532891, 'auprc': 0.8442610004395978, 'loss_val': 0.30355180728555525, 'psi': 0.7449840740955738}-{'f1_val': 0.640231480472063, 'auprc': 0.803781880576141, 'loss_val': 0.5684591702530114, 'psi': 0.7056516405136941}
[S7] not sending this round → trigger blocked (psi=0.745)
[S8] START round=43 head_norm_before_train=1.858336 cos_to_last_merge=0.9307 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.931
[S8] round=43 local utility u=0.031067 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.998536452875879, 'loss_val': 0.03764840183627697, 'psi': 0.9950689175734271}-{'f1_val': 0.9850292659535449, 'auprc': 0.9989895497306666, 'loss_val': 0.05477462066396267, 'psi': 0.9906133794643935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=43 head_norm_before_train=1.518652 cos_to_last_merge=0.9931 (last merge round=29)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9922436361715682, 'auprc': 0.9962111073753714, 'loss_val': 0.037181300470720956, 'psi': 0.9938306246530895}-{'f1_val': 0.9962500947792776, 'auprc': 0.9886815796631414, 'loss_val': 0.03301031905776282, 'psi': 0.9932226887328232}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.239199 (no previous merge yet)
[S10] round=43 local utility u=0.001819 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9944958066937939, 'loss_val': 0.026318755362276507, 'psi': 0.9947286571357543}-{'f1_val': 0.9944449605296568, 'auprc': 0.9944407274415453, 'loss_val': 0.027156961795439388, 'psi': 0.9944432672944122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=43 head_norm_before_train=1.785267 cos_to_last_merge=0.9843 (last merge round=31)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.8277074606726154, 'auprc': 0.9960937674329526, 'loss_val': 0.2710469373154083, 'psi': 0.8950619833767504}-{'f1_val': 0.9353029304502611, 'auprc': 0.9961120328052828, 'loss_val': 0.10554674485800804, 'psi': 0.9596265713922698}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.562481 cos_to_last_merge=0.9427 (last merge round=25)
[S13] ⚠️ Model drifted since last merge! cos=0.943
[S13] round=43 local utility u=0.562720 metrics={'f1_val': 0.7679256352916999, 'auprc': 0.745157236300968, 'loss_val': 0.7352311614134918, 'psi': 0.7588182756954072}-{'f1_val': 0.6442901192683474, 'auprc': 0.7275612696459647, 'loss_val': 1.0660693359054012, 'psi': 0.6775985794193944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=43 head_norm_before_train=1.783344 cos_to_last_merge=0.9567 (last merge round=24)
[S14] round=43 local utility u=0.007676 metrics={'f1_val': 0.9967552940827689, 'auprc': 0.9990317012947967, 'loss_val': 0.0404558078992809, 'psi': 0.99766585696758}-{'f1_val': 0.9965603779504312, 'auprc': 0.9957842923784934, 'loss_val': 0.04489591123395344, 'psi': 0.9962499437216561}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=43 head_norm_before_train=2.281588 (no previous merge yet)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.8095596244949437, 'auprc': 0.9820758790000881, 'loss_val': 0.47760291994124193, 'psi': 0.8785661262970015}-{'f1_val': 0.9967466683875206, 'auprc': 0.9972894953974076, 'loss_val': 0.02031711268220613, 'psi': 0.9969637991914754}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.930947 cos_to_last_merge=0.9879 (last merge round=30)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9415134747021864, 'auprc': 0.9845515153604489, 'loss_val': 0.196099866272876, 'psi': 0.9587286909654914}-{'f1_val': 0.9910643600248928, 'auprc': 0.9830263826634644, 'loss_val': 0.052500247125971844, 'psi': 0.9878491690803215}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=2.218680 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6690658455693975, 'auprc': 0.9750818463505797, 'loss_val': 1.3190507035194583, 'psi': 0.7914722458818704}-{'f1_val': 0.8787722643570673, 'auprc': 0.9817708474644666, 'loss_val': 0.5529022217013643, 'psi': 0.919971697600027}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=2.226945 (no previous merge yet)
[S2] round=44 local utility u=0.528419 metrics={'f1_val': 0.7123997040564136, 'auprc': 0.8315145050775329, 'loss_val': 0.5673154109631382, 'psi': 0.7600456244648613}-{'f1_val': 0.6477696458355956, 'auprc': 0.7638912249509064, 'loss_val': 1.0335039147124434, 'psi': 0.6942182774817199}
[S2] not sending this round → trigger blocked (psi=0.760)
[S3] START round=44 head_norm_before_train=1.837693 cos_to_last_merge=0.9881 (last merge round=31)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.8096453259112085, 'auprc': 0.9980268011233856, 'loss_val': 0.33321863489633763, 'psi': 0.8849979159960794}-{'f1_val': 0.9298657204595457, 'auprc': 0.9985843141673091, 'loss_val': 0.1261196386650421, 'psi': 0.9573531579426511}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.700223 cos_to_last_merge=0.9539 (last merge round=24)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9493034641062855, 'auprc': 0.9608789657098906, 'loss_val': 0.29775450669874864, 'psi': 0.9539336647477276}-{'f1_val': 0.9547830083049464, 'auprc': 0.9697442099367268, 'loss_val': 0.2880806716680987, 'psi': 0.9607674889576585}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.449563 cos_to_last_merge=0.9735 (last merge round=29)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.6260031012865868, 'auprc': 0.8802060585255307, 'loss_val': 0.43126758155038264, 'psi': 0.7276842841821644}-{'f1_val': 0.6684732488735179, 'auprc': 0.9643478372062484, 'loss_val': 0.27005355077502546, 'psi': 0.7868230842066102}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.781215 cos_to_last_merge=0.9927 (last merge round=29)
[S6] round=44 local utility u=0.111128 metrics={'f1_val': 0.7549136978730707, 'auprc': 0.9489340596221836, 'loss_val': 0.7090905210158107, 'psi': 0.8325218425727159}-{'f1_val': 0.7272482704646044, 'auprc': 0.9492316126707582, 'loss_val': 0.766246196899379, 'psi': 0.816041607347066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=44 head_norm_before_train=1.742181 (no previous merge yet)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5510509967029318, 'auprc': 0.7840359463978266, 'loss_val': 0.8958143117700067, 'psi': 0.6442449765808897}-{'f1_val': 0.678799456532891, 'auprc': 0.8442610004395978, 'loss_val': 0.30355180728555525, 'psi': 0.7449840740955738}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.869218 cos_to_last_merge=0.9294 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.929
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9932810269810869, 'auprc': 0.9864643084239672, 'loss_val': 0.04804482141403575, 'psi': 0.990554339558239}-{'f1_val': 0.9927572273717925, 'auprc': 0.998536452875879, 'loss_val': 0.03764840183627697, 'psi': 0.9950689175734271}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.526118 cos_to_last_merge=0.9927 (last merge round=29)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9867176631020987, 'auprc': 0.9915351949823812, 'loss_val': 0.0595037851407192, 'psi': 0.9886446758542118}-{'f1_val': 0.9922436361715682, 'auprc': 0.9962111073753714, 'loss_val': 0.037181300470720956, 'psi': 0.9938306246530895}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.243550 (no previous merge yet)
[S10] round=44 local utility u=0.000437 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9942914908145675, 'loss_val': 0.02614867266916848, 'psi': 0.9947786771714859}-{'f1_val': 0.9948838907637279, 'auprc': 0.9944958066937939, 'loss_val': 0.026318755362276507, 'psi': 0.9947286571357543}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=44 head_norm_before_train=1.798884 cos_to_last_merge=0.9832 (last merge round=31)
[S11] round=44 local utility u=0.615505 metrics={'f1_val': 0.9942098865562964, 'auprc': 0.9967384106082116, 'loss_val': 0.04098503750376715, 'psi': 0.9952212961770625}-{'f1_val': 0.8277074606726154, 'auprc': 0.9960937674329526, 'loss_val': 0.2710469373154083, 'psi': 0.8950619833767504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=44 head_norm_before_train=1.576947 cos_to_last_merge=0.9409 (last merge round=25)
[S13] ⚠️ Model drifted since last merge! cos=0.941
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6895522810662591, 'auprc': 0.6500161284332127, 'loss_val': 1.1393328709629198, 'psi': 0.6737378200130406}-{'f1_val': 0.7679256352916999, 'auprc': 0.745157236300968, 'loss_val': 0.7352311614134918, 'psi': 0.7588182756954072}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.797693 cos_to_last_merge=0.9550 (last merge round=24)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.998992820218661, 'loss_val': 0.04108523563058944, 'psi': 0.9976635926589261}-{'f1_val': 0.9967552940827689, 'auprc': 0.9990317012947967, 'loss_val': 0.0404558078992809, 'psi': 0.99766585696758}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.290362 (no previous merge yet)
[S15] round=44 local utility u=0.360191 metrics={'f1_val': 0.8856822953033997, 'auprc': 0.9940984298090637, 'loss_val': 0.2500246664739826, 'psi': 0.9290487491056654}-{'f1_val': 0.8095596244949437, 'auprc': 0.9820758790000881, 'loss_val': 0.47760291994124193, 'psi': 0.8785661262970015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=44 head_norm_before_train=1.940085 cos_to_last_merge=0.9873 (last merge round=30)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8626921312691989, 'auprc': 0.9872881413723607, 'loss_val': 0.6055182801545607, 'psi': 0.9125305353104636}-{'f1_val': 0.9415134747021864, 'auprc': 0.9845515153604489, 'loss_val': 0.196099866272876, 'psi': 0.9587286909654914}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=2.230123 (no previous merge yet)
[S17] round=44 local utility u=0.386402 metrics={'f1_val': 0.7442229590511933, 'auprc': 0.9281406794938065, 'loss_val': 0.856365810991209, 'psi': 0.8177900472282387}-{'f1_val': 0.6690658455693975, 'auprc': 0.9750818463505797, 'loss_val': 1.3190507035194583, 'psi': 0.7914722458818704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=45 head_norm_before_train=2.236156 (no previous merge yet)
[S2] round=45 local utility u=0.163056 metrics={'f1_val': 0.7094167480342057, 'auprc': 0.977845572103207, 'loss_val': 0.6622981731177874, 'psi': 0.8167882776618063}-{'f1_val': 0.7123997040564136, 'auprc': 0.8315145050775329, 'loss_val': 0.5673154109631382, 'psi': 0.7600456244648613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=45 head_norm_before_train=1.850101 cos_to_last_merge=0.9874 (last merge round=31)
[S3] round=45 local utility u=0.655996 metrics={'f1_val': 0.9824538342257978, 'auprc': 0.9994797783701843, 'loss_val': 0.06243758489666174, 'psi': 0.9892642118835524}-{'f1_val': 0.8096453259112085, 'auprc': 0.9980268011233856, 'loss_val': 0.33321863489633763, 'psi': 0.8849979159960794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=45 head_norm_before_train=1.708173 cos_to_last_merge=0.9531 (last merge round=24)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9467128563289547, 'auprc': 0.9543126160591826, 'loss_val': 0.306455007190035, 'psi': 0.9497527602210458}-{'f1_val': 0.9493034641062855, 'auprc': 0.9608789657098906, 'loss_val': 0.29775450669874864, 'psi': 0.9539336647477276}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.463458 cos_to_last_merge=0.9714 (last merge round=29)
[S5] round=45 local utility u=0.363388 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9399374007493029, 'loss_val': 0.33062731658870054, 'psi': 0.7962709371810126}-{'f1_val': 0.6260031012865868, 'auprc': 0.8802060585255307, 'loss_val': 0.43126758155038264, 'psi': 0.7276842841821644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=45 head_norm_before_train=1.786615 cos_to_last_merge=0.9920 (last merge round=29)
[S6] round=45 local utility u=0.316363 metrics={'f1_val': 0.8270268516822373, 'auprc': 0.9465320127947662, 'loss_val': 0.5018366630322891, 'psi': 0.8748289161272489}-{'f1_val': 0.7549136978730707, 'auprc': 0.9489340596221836, 'loss_val': 0.7090905210158107, 'psi': 0.8325218425727159}
[S6] not sending this round → trigger blocked (psi=0.875)
[S7] START round=45 head_norm_before_train=1.748278 (no previous merge yet)
[S7] round=45 local utility u=0.373827 metrics={'f1_val': 0.6187524168114777, 'auprc': 0.7983224755858298, 'loss_val': 0.5972274786184514, 'psi': 0.6905804403212186}-{'f1_val': 0.5510509967029318, 'auprc': 0.7840359463978266, 'loss_val': 0.8958143117700067, 'psi': 0.6442449765808897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=45 head_norm_before_train=1.879937 cos_to_last_merge=0.9280 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.928
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9853629043478473, 'auprc': 0.9991233129489775, 'loss_val': 0.05182226861242241, 'psi': 0.9908670677882994}-{'f1_val': 0.9932810269810869, 'auprc': 0.9864643084239672, 'loss_val': 0.04804482141403575, 'psi': 0.990554339558239}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.533498 cos_to_last_merge=0.9924 (last merge round=29)
[S9] round=45 local utility u=0.046557 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9928029612749592, 'loss_val': 0.029850607281080074, 'psi': 0.9951174915983185}-{'f1_val': 0.9867176631020987, 'auprc': 0.9915351949823812, 'loss_val': 0.0595037851407192, 'psi': 0.9886446758542118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=45 head_norm_before_train=2.250630 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9942064097891026, 'loss_val': 0.026200506806546276, 'psi': 0.9946128983738778}-{'f1_val': 0.9951034680760983, 'auprc': 0.9942914908145675, 'loss_val': 0.02614867266916848, 'psi': 0.9947786771714859}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.812035 cos_to_last_merge=0.9822 (last merge round=31)
[S11] round=45 local utility u=0.013456 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.997647088826795, 'loss_val': 0.028341614604191812, 'psi': 0.9967390404787035}-{'f1_val': 0.9942098865562964, 'auprc': 0.9967384106082116, 'loss_val': 0.04098503750376715, 'psi': 0.9952212961770625}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=45 head_norm_before_train=1.587343 cos_to_last_merge=0.9395 (last merge round=25)
[S13] ⚠️ Model drifted since last merge! cos=0.940
[S13] round=45 local utility u=0.438304 metrics={'f1_val': 0.7127225402623081, 'auprc': 0.8037647568752149, 'loss_val': 0.8629928038238422, 'psi': 0.7491394269074707}-{'f1_val': 0.6895522810662591, 'auprc': 0.6500161284332127, 'loss_val': 1.1393328709629198, 'psi': 0.6737378200130406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=45 head_norm_before_train=1.808937 cos_to_last_merge=0.9537 (last merge round=24)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9968120613557051, 'loss_val': 0.04439239383198988, 'psi': 0.9970377457443961}-{'f1_val': 0.9967774409524363, 'auprc': 0.998992820218661, 'loss_val': 0.04108523563058944, 'psi': 0.9976635926589261}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.298916 (no previous merge yet)
[S15] round=45 local utility u=0.453591 metrics={'f1_val': 0.9967036286230888, 'auprc': 0.9975957889682641, 'loss_val': 0.019463381542998957, 'psi': 0.9970604927611589}-{'f1_val': 0.8856822953033997, 'auprc': 0.9940984298090637, 'loss_val': 0.2500246664739826, 'psi': 0.9290487491056654}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=45 head_norm_before_train=1.948617 cos_to_last_merge=0.9868 (last merge round=30)
[S16] round=45 local utility u=0.657406 metrics={'f1_val': 0.9901044103086237, 'auprc': 0.9866257168853688, 'loss_val': 0.05319367377922755, 'psi': 0.9887129329393218}-{'f1_val': 0.8626921312691989, 'auprc': 0.9872881413723607, 'loss_val': 0.6055182801545607, 'psi': 0.9125305353104636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=45 head_norm_before_train=2.240753 (no previous merge yet)
[S17] round=45 local utility u=0.664973 metrics={'f1_val': 0.9041804869787479, 'auprc': 0.9418711893006659, 'loss_val': 0.5273570557666667, 'psi': 0.9192567679075151}-{'f1_val': 0.7442229590511933, 'auprc': 0.9281406794938065, 'loss_val': 0.856365810991209, 'psi': 0.8177900472282387}
[S17] not sending this round → trigger blocked (psi=0.919)
[S2] START round=46 head_norm_before_train=2.244690 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.5730275925357102, 'auprc': 0.6663564540249995, 'loss_val': 1.795444147241579, 'psi': 0.610359137131426}-{'f1_val': 0.7094167480342057, 'auprc': 0.977845572103207, 'loss_val': 0.6622981731177874, 'psi': 0.8167882776618063}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.863641 cos_to_last_merge=0.9866 (last merge round=31)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9995675773105868, 'loss_val': 0.13120095758678502, 'psi': 0.976472082163907}-{'f1_val': 0.9824538342257978, 'auprc': 0.9994797783701843, 'loss_val': 0.06243758489666174, 'psi': 0.9892642118835524}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.719240 cos_to_last_merge=0.9519 (last merge round=24)
[S4] round=46 local utility u=0.058912 metrics={'f1_val': 0.9531882079902605, 'auprc': 0.9773373269745053, 'loss_val': 0.29655645250596396, 'psi': 0.9628478555839584}-{'f1_val': 0.9467128563289547, 'auprc': 0.9543126160591826, 'loss_val': 0.306455007190035, 'psi': 0.9497527602210458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=46 head_norm_before_train=1.473965 cos_to_last_merge=0.9700 (last merge round=29)
[S5] round=46 local utility u=0.241700 metrics={'f1_val': 0.7354548699511905, 'auprc': 0.9871111991862165, 'loss_val': 0.19851880091479907, 'psi': 0.8361174016452009}-{'f1_val': 0.7004932948021524, 'auprc': 0.9399374007493029, 'loss_val': 0.33062731658870054, 'psi': 0.7962709371810126}
[S5] not sending this round → trigger blocked (psi=0.836)
[S6] START round=46 head_norm_before_train=1.804830 cos_to_last_merge=0.9919 (last merge round=29)
[S6] round=46 local utility u=0.205761 metrics={'f1_val': 0.8668878177010443, 'auprc': 0.9574091988096535, 'loss_val': 0.3621126959247954, 'psi': 0.9030963701444878}-{'f1_val': 0.8270268516822373, 'auprc': 0.9465320127947662, 'loss_val': 0.5018366630322891, 'psi': 0.8748289161272489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=46 head_norm_before_train=1.752384 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.5955883370530062, 'auprc': 0.7946884402466022, 'loss_val': 0.7128578904094216, 'psi': 0.6752283783304447}-{'f1_val': 0.6187524168114777, 'auprc': 0.7983224755858298, 'loss_val': 0.5972274786184514, 'psi': 0.6905804403212186}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.888094 cos_to_last_merge=0.9270 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.927
[S8] round=46 local utility u=0.032800 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9983412731553358, 'loss_val': 0.03483042693434383, 'psi': 0.9956497786305211}-{'f1_val': 0.9853629043478473, 'auprc': 0.9991233129489775, 'loss_val': 0.05182226861242241, 'psi': 0.9908670677882994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=46 head_norm_before_train=1.541519 cos_to_last_merge=0.9920 (last merge round=29)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9922071168255049, 'loss_val': 0.030537719742909815, 'psi': 0.9946329035977686}-{'f1_val': 0.9966605118138915, 'auprc': 0.9928029612749592, 'loss_val': 0.029850607281080074, 'psi': 0.9951174915983185}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.260568 (no previous merge yet)
[S10] round=46 local utility u=0.000653 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9940732887582481, 'loss_val': 0.02581266198915684, 'psi': 0.9946913963489582}-{'f1_val': 0.9948838907637279, 'auprc': 0.9942064097891026, 'loss_val': 0.026200506806546276, 'psi': 0.9946128983738778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=46 head_norm_before_train=1.824046 cos_to_last_merge=0.9813 (last merge round=31)
[S11] round=46 local utility u=0.001768 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976074246850493, 'loss_val': 0.027166872743685764, 'psi': 0.9969711725821735}-{'f1_val': 0.9961336749133093, 'auprc': 0.997647088826795, 'loss_val': 0.028341614604191812, 'psi': 0.9967390404787035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=46 head_norm_before_train=1.597003 cos_to_last_merge=0.9387 (last merge round=25)
[S13] ⚠️ Model drifted since last merge! cos=0.939
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6921094009690776, 'auprc': 0.803130229220795, 'loss_val': 0.864115634787349, 'psi': 0.7365177322697646}-{'f1_val': 0.7127225402623081, 'auprc': 0.8037647568752149, 'loss_val': 0.8629928038238422, 'psi': 0.7491394269074707}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.820367 cos_to_last_merge=0.9524 (last merge round=24)
[S14] round=46 local utility u=0.006813 metrics={'f1_val': 0.9969981421187261, 'auprc': 0.9989560380580934, 'loss_val': 0.036058638256948626, 'psi': 0.9977813004944731}-{'f1_val': 0.9971882020035234, 'auprc': 0.9968120613557051, 'loss_val': 0.04439239383198988, 'psi': 0.9970377457443961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=46 head_norm_before_train=2.307576 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9024517853918563, 'auprc': 0.9960201420722379, 'loss_val': 0.21239646616126392, 'psi': 0.9398791280640089}-{'f1_val': 0.9967036286230888, 'auprc': 0.9975957889682641, 'loss_val': 0.019463381542998957, 'psi': 0.9970604927611589}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.956031 cos_to_last_merge=0.9863 (last merge round=30)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9091710084187519, 'auprc': 0.984303785452033, 'loss_val': 0.19711888104882613, 'psi': 0.9392241192320644}-{'f1_val': 0.9901044103086237, 'auprc': 0.9866257168853688, 'loss_val': 0.05319367377922755, 'psi': 0.9887129329393218}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=2.248789 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.695224120855291, 'auprc': 0.9333206273360435, 'loss_val': 1.0590814330223686, 'psi': 0.7904627234475919}-{'f1_val': 0.9041804869787479, 'auprc': 0.9418711893006659, 'loss_val': 0.5273570557666667, 'psi': 0.9192567679075151}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=2.252726 (no previous merge yet)
[S2] round=47 local utility u=1.000000 metrics={'f1_val': 0.7095980973737689, 'auprc': 0.9957431840199018, 'loss_val': 0.6531359333794762, 'psi': 0.824056132032222}-{'f1_val': 0.5730275925357102, 'auprc': 0.6663564540249995, 'loss_val': 1.795444147241579, 'psi': 0.610359137131426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=47 head_norm_before_train=1.876711 cos_to_last_merge=0.9859 (last merge round=31)
[S3] round=47 local utility u=0.008559 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9997646924945685, 'loss_val': 0.11491583557381067, 'psi': 0.9765750313385189}-{'f1_val': 0.9610750853994537, 'auprc': 0.9995675773105868, 'loss_val': 0.13120095758678502, 'psi': 0.976472082163907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=47 head_norm_before_train=1.726978 cos_to_last_merge=0.9509 (last merge round=24)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9409462106244064, 'auprc': 0.9557798635640171, 'loss_val': 0.31213430173256496, 'psi': 0.9468796718002507}-{'f1_val': 0.9531882079902605, 'auprc': 0.9773373269745053, 'loss_val': 0.29655645250596396, 'psi': 0.9628478555839584}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.483751 cos_to_last_merge=0.9687 (last merge round=29)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.44474389126280867, 'auprc': 0.8544639217659884, 'loss_val': 0.925285321790045, 'psi': 0.6086319034640806}-{'f1_val': 0.7354548699511905, 'auprc': 0.9871111991862165, 'loss_val': 0.19851880091479907, 'psi': 0.8361174016452009}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.818037 cos_to_last_merge=0.9915 (last merge round=29)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.648174016898638, 'auprc': 0.9384312805670787, 'loss_val': 0.93448066721635, 'psi': 0.7642769223660142}-{'f1_val': 0.8668878177010443, 'auprc': 0.9574091988096535, 'loss_val': 0.3621126959247954, 'psi': 0.9030963701444878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.760061 (no previous merge yet)
[S7] round=47 local utility u=0.364003 metrics={'f1_val': 0.6613768873537984, 'auprc': 0.8122243597824541, 'loss_val': 0.4321911120188998, 'psi': 0.7217158763252607}-{'f1_val': 0.5955883370530062, 'auprc': 0.7946884402466022, 'loss_val': 0.7128578904094216, 'psi': 0.6752283783304447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=47 head_norm_before_train=1.898805 cos_to_last_merge=0.9257 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.926
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9873594458568917, 'auprc': 0.9987959506430448, 'loss_val': 0.04632354170486336, 'psi': 0.991934047771353}-{'f1_val': 0.9938554489473111, 'auprc': 0.9983412731553358, 'loss_val': 0.03483042693434383, 'psi': 0.9956497786305211}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.549938 cos_to_last_merge=0.9917 (last merge round=29)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9909734396342953, 'auprc': 0.9908896684051479, 'loss_val': 0.04462131413079155, 'psi': 0.9909399311426363}-{'f1_val': 0.9962500947792776, 'auprc': 0.9922071168255049, 'loss_val': 0.030537719742909815, 'psi': 0.9946329035977686}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.266585 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9949444776248357, 'loss_val': 0.026451133904583847, 'psi': 0.9947764240555841}-{'f1_val': 0.9951034680760983, 'auprc': 0.9940732887582481, 'loss_val': 0.02581266198915684, 'psi': 0.9946913963489582}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.835311 cos_to_last_merge=0.9804 (last merge round=31)
[S11] round=47 local utility u=0.000565 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977636749364445, 'loss_val': 0.02650654423596303, 'psi': 0.9970336726827316}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976074246850493, 'loss_val': 0.027166872743685764, 'psi': 0.9969711725821735}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=47 head_norm_before_train=1.602172 cos_to_last_merge=0.9382 (last merge round=25)
[S13] ⚠️ Model drifted since last merge! cos=0.938
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.7094235503272831, 'auprc': 0.6551901291900867, 'loss_val': 0.9820476231942595, 'psi': 0.6877301818724045}-{'f1_val': 0.6921094009690776, 'auprc': 0.803130229220795, 'loss_val': 0.864115634787349, 'psi': 0.7365177322697646}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.831323 cos_to_last_merge=0.9509 (last merge round=24)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9971660554268293, 'auprc': 0.9989781609511071, 'loss_val': 0.04197444944348602, 'psi': 0.9978908976365405}-{'f1_val': 0.9969981421187261, 'auprc': 0.9989560380580934, 'loss_val': 0.036058638256948626, 'psi': 0.9977813004944731}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.316725 (no previous merge yet)
[S15] round=47 local utility u=0.330435 metrics={'f1_val': 0.9831938172532364, 'auprc': 0.996899696670444, 'loss_val': 0.03861672758616291, 'psi': 0.9886761690201195}-{'f1_val': 0.9024517853918563, 'auprc': 0.9960201420722379, 'loss_val': 0.21239646616126392, 'psi': 0.9398791280640089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=47 head_norm_before_train=1.964154 cos_to_last_merge=0.9859 (last merge round=30)
[S16] round=47 local utility u=0.332837 metrics={'f1_val': 0.9922716513218768, 'auprc': 0.9881462199501246, 'loss_val': 0.041576377481738105, 'psi': 0.990621478773176}-{'f1_val': 0.9091710084187519, 'auprc': 0.984303785452033, 'loss_val': 0.19711888104882613, 'psi': 0.9392241192320644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=47 head_norm_before_train=2.258111 (no previous merge yet)
[S17] round=47 local utility u=0.072865 metrics={'f1_val': 0.7166463114170369, 'auprc': 0.9116384103566043, 'loss_val': 0.9768385094661156, 'psi': 0.794643150992864}-{'f1_val': 0.695224120855291, 'auprc': 0.9333206273360435, 'loss_val': 1.0590814330223686, 'psi': 0.7904627234475919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=48 head_norm_before_train=2.258439 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.7081927523616968, 'auprc': 0.8410549195689248, 'loss_val': 0.6075398413207123, 'psi': 0.761337619244588}-{'f1_val': 0.7095980973737689, 'auprc': 0.9957431840199018, 'loss_val': 0.6531359333794762, 'psi': 0.824056132032222}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.888806 cos_to_last_merge=0.9852 (last merge round=31)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9229277912188334, 'auprc': 0.9988078277978581, 'loss_val': 0.14385920474925912, 'psi': 0.9532798058504433}-{'f1_val': 0.9611152572344858, 'auprc': 0.9997646924945685, 'loss_val': 0.11491583557381067, 'psi': 0.9765750313385189}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.734768 cos_to_last_merge=0.9499 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.950
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.939727182523987, 'auprc': 0.9453932461647712, 'loss_val': 0.31477181790610376, 'psi': 0.9419936079803007}-{'f1_val': 0.9409462106244064, 'auprc': 0.9557798635640171, 'loss_val': 0.31213430173256496, 'psi': 0.9468796718002507}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.493757 cos_to_last_merge=0.9675 (last merge round=29)
[S5] round=48 local utility u=0.765781 metrics={'f1_val': 0.6247539357179942, 'auprc': 0.8666077379227337, 'loss_val': 0.5102154956503447, 'psi': 0.7214954565998901}-{'f1_val': 0.44474389126280867, 'auprc': 0.8544639217659884, 'loss_val': 0.925285321790045, 'psi': 0.6086319034640806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=48 head_norm_before_train=1.835646 cos_to_last_merge=0.9911 (last merge round=29)
[S6] round=48 local utility u=0.843537 metrics={'f1_val': 0.8527579454009987, 'auprc': 0.9180462423543041, 'loss_val': 0.4137546908021601, 'psi': 0.8788732641823209}-{'f1_val': 0.648174016898638, 'auprc': 0.9384312805670787, 'loss_val': 0.93448066721635, 'psi': 0.7642769223660142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=48 head_norm_before_train=1.766739 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6545932311215386, 'auprc': 0.8101392195313671, 'loss_val': 0.41752337594817474, 'psi': 0.71681162648547}-{'f1_val': 0.6613768873537984, 'auprc': 0.8122243597824541, 'loss_val': 0.4321911120188998, 'psi': 0.7217158763252607}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.903534 cos_to_last_merge=0.9249 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.925
[S8] round=48 local utility u=0.017859 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.9963672944550166, 'loss_val': 0.03775733256825929, 'psi': 0.9944063469042266}-{'f1_val': 0.9873594458568917, 'auprc': 0.9987959506430448, 'loss_val': 0.04632354170486336, 'psi': 0.991934047771353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=48 head_norm_before_train=1.557955 cos_to_last_merge=0.9913 (last merge round=29)
[S9] round=48 local utility u=0.014520 metrics={'f1_val': 0.9922436361715682, 'auprc': 0.9955354492425681, 'loss_val': 0.03713948077517149, 'psi': 0.9935603613999682}-{'f1_val': 0.9909734396342953, 'auprc': 0.9908896684051479, 'loss_val': 0.04462131413079155, 'psi': 0.9909399311426363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=48 head_norm_before_train=2.273142 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9942870380086841, 'loss_val': 0.026482828114482864, 'psi': 0.9945134482091236}-{'f1_val': 0.9946643883427498, 'auprc': 0.9949444776248357, 'loss_val': 0.026451133904583847, 'psi': 0.9947764240555841}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.845761 cos_to_last_merge=0.9797 (last merge round=31)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9975892683317011, 'loss_val': 0.027049625445677763, 'psi': 0.996715912280666}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977636749364445, 'loss_val': 0.02650654423596303, 'psi': 0.9970336726827316}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.607489 cos_to_last_merge=0.9377 (last merge round=25)
[S13] ⚠️ Model drifted since last merge! cos=0.938
[S13] round=48 local utility u=0.115440 metrics={'f1_val': 0.6733531093401663, 'auprc': 0.7994926857708292, 'loss_val': 0.967652670079996, 'psi': 0.7238089399124314}-{'f1_val': 0.7094235503272831, 'auprc': 0.6551901291900867, 'loss_val': 0.9820476231942595, 'psi': 0.6877301818724045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=48 head_norm_before_train=1.840358 cos_to_last_merge=0.9499 (last merge round=24)
[S14] ⚠️ Model drifted since last merge! cos=0.950
[S14] round=48 local utility u=0.000055 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9988802036400178, 'loss_val': 0.041703665529189464, 'psi': 0.9978650026581212}-{'f1_val': 0.9971660554268293, 'auprc': 0.9989781609511071, 'loss_val': 0.04197444944348602, 'psi': 0.9978908976365405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=48 head_norm_before_train=2.325684 (no previous merge yet)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7586097008836172, 'auprc': 0.9636797849437873, 'loss_val': 0.6217382337179581, 'psi': 0.8406377345076852}-{'f1_val': 0.9831938172532364, 'auprc': 0.996899696670444, 'loss_val': 0.03861672758616291, 'psi': 0.9886761690201195}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.972679 cos_to_last_merge=0.9854 (last merge round=30)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9918323492486659, 'auprc': 0.9881872213324637, 'loss_val': 0.04258075139227078, 'psi': 0.990374298082185}-{'f1_val': 0.9922716513218768, 'auprc': 0.9881462199501246, 'loss_val': 0.041576377481738105, 'psi': 0.990621478773176}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=2.266693 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6247751899728751, 'auprc': 0.9370393993553827, 'loss_val': 1.5115208891604626, 'psi': 0.7496808737258781}-{'f1_val': 0.7166463114170369, 'auprc': 0.9116384103566043, 'loss_val': 0.9768385094661156, 'psi': 0.794643150992864}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=2.263765 (no previous merge yet)
[S2] round=49 local utility u=0.010699 metrics={'f1_val': 0.7079340400025474, 'auprc': 0.8617946945902342, 'loss_val': 0.6468088064667217, 'psi': 0.7694783018376221}-{'f1_val': 0.7081927523616968, 'auprc': 0.8410549195689248, 'loss_val': 0.6075398413207123, 'psi': 0.761337619244588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=49 head_norm_before_train=1.897152 cos_to_last_merge=0.9844 (last merge round=31)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9187660756606726, 'auprc': 0.9938542391666565, 'loss_val': 0.22133571574014335, 'psi': 0.9488013410630661}-{'f1_val': 0.9229277912188334, 'auprc': 0.9988078277978581, 'loss_val': 0.14385920474925912, 'psi': 0.9532798058504433}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.740184 cos_to_last_merge=0.9490 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=49 local utility u=0.009665 metrics={'f1_val': 0.9401953035027137, 'auprc': 0.9500315498822458, 'loss_val': 0.3121654083367716, 'psi': 0.9441298020545266}-{'f1_val': 0.939727182523987, 'auprc': 0.9453932461647712, 'loss_val': 0.31477181790610376, 'psi': 0.9419936079803007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=49 head_norm_before_train=1.504783 cos_to_last_merge=0.9660 (last merge round=29)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.4230626313682314, 'auprc': 0.7964394415742049, 'loss_val': 1.3651793349489811, 'psi': 0.5724133554506208}-{'f1_val': 0.6247539357179942, 'auprc': 0.8666077379227337, 'loss_val': 0.5102154956503447, 'psi': 0.7214954565998901}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.846367 cos_to_last_merge=0.9904 (last merge round=29)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.7221331853771362, 'auprc': 0.9181089267647851, 'loss_val': 0.8011881866492137, 'psi': 0.8005234819321958}-{'f1_val': 0.8527579454009987, 'auprc': 0.9180462423543041, 'loss_val': 0.4137546908021601, 'psi': 0.8788732641823209}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.771640 (no previous merge yet)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6035307032028852, 'auprc': 0.7947916208365621, 'loss_val': 0.7081201171975254, 'psi': 0.680035070256356}-{'f1_val': 0.6545932311215386, 'auprc': 0.8101392195313671, 'loss_val': 0.41752337594817474, 'psi': 0.71681162648547}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.904745 cos_to_last_merge=0.9245 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.925
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9867812170912436, 'auprc': 0.9932439355893437, 'loss_val': 0.04740175514061883, 'psi': 0.9893663044904837}-{'f1_val': 0.9930990485370332, 'auprc': 0.9963672944550166, 'loss_val': 0.03775733256825929, 'psi': 0.9944063469042266}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.565591 cos_to_last_merge=0.9909 (last merge round=29)
[S9] round=49 local utility u=0.010674 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9906035966757434, 'loss_val': 0.02749656608398168, 'psi': 0.9942377457586322}-{'f1_val': 0.9922436361715682, 'auprc': 0.9955354492425681, 'loss_val': 0.03713948077517149, 'psi': 0.9935603613999682}
[S9] not sending this round → trigger blocked (psi=0.994)
[S10] START round=49 head_norm_before_train=2.282819 (no previous merge yet)
[S10] round=49 local utility u=0.000542 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9940911159161763, 'loss_val': 0.026128152442944533, 'psi': 0.9945667808247073}-{'f1_val': 0.9946643883427498, 'auprc': 0.9942870380086841, 'loss_val': 0.026482828114482864, 'psi': 0.9945134482091236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=49 head_norm_before_train=1.855537 cos_to_last_merge=0.9789 (last merge round=31)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.995892772286759, 'auprc': 0.9961155869334902, 'loss_val': 0.031568653519110194, 'psi': 0.9959818981454515}-{'f1_val': 0.9961336749133093, 'auprc': 0.9975892683317011, 'loss_val': 0.027049625445677763, 'psi': 0.996715912280666}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.616834 cos_to_last_merge=0.9365 (last merge round=25)
[S13] ⚠️ Model drifted since last merge! cos=0.937
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6665251144154912, 'auprc': 0.6454490055194878, 'loss_val': 1.0143996159665587, 'psi': 0.6580946708570898}-{'f1_val': 0.6733531093401663, 'auprc': 0.7994926857708292, 'loss_val': 0.967652670079996, 'psi': 0.7238089399124314}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.850372 cos_to_last_merge=0.9487 (last merge round=24)
[S14] ⚠️ Model drifted since last merge! cos=0.949
[S14] round=49 local utility u=0.003168 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.998914448116672, 'loss_val': 0.03547041432828935, 'psi': 0.9978787004487828}-{'f1_val': 0.9971882020035234, 'auprc': 0.9988802036400178, 'loss_val': 0.041703665529189464, 'psi': 0.9978650026581212}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=49 head_norm_before_train=2.333273 (no previous merge yet)
[S15] round=49 local utility u=0.069192 metrics={'f1_val': 0.7772971059929645, 'auprc': 0.9584049343827256, 'loss_val': 0.5796544145622732, 'psi': 0.8497402373488689}-{'f1_val': 0.7586097008836172, 'auprc': 0.9636797849437873, 'loss_val': 0.6217382337179581, 'psi': 0.8406377345076852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=49 head_norm_before_train=1.980669 cos_to_last_merge=0.9848 (last merge round=30)
[S16] round=49 local utility u=0.001227 metrics={'f1_val': 0.9918545329008631, 'auprc': 0.9885436066666536, 'loss_val': 0.041328675605138164, 'psi': 0.9905301624071793}-{'f1_val': 0.9918323492486659, 'auprc': 0.9881872213324637, 'loss_val': 0.04258075139227078, 'psi': 0.990374298082185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=49 head_norm_before_train=2.272366 (no previous merge yet)
[S17] round=49 local utility u=1.000000 metrics={'f1_val': 0.8894944727361314, 'auprc': 0.9092776477816078, 'loss_val': 0.520994890678751, 'psi': 0.8974077427543219}-{'f1_val': 0.6247751899728751, 'auprc': 0.9370393993553827, 'loss_val': 1.5115208891604626, 'psi': 0.7496808737258781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
