[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:40403
[S3] → join 127.0.0.1:40402
[S4] → join 127.0.0.1:40402
[S5] → join 127.0.0.1:40402
[S6] → join 127.0.0.1:40402
[S7] → join 127.0.0.1:40402
[S8] → join 127.0.0.1:40402
[S9] → join 127.0.0.1:40402
[S10] → join 127.0.0.1:40402
[S11] → join 127.0.0.1:40402
[S13] → join 127.0.0.1:40402
[S14] → join 127.0.0.1:40402
[S15] → join 127.0.0.1:40402
[S16] → join 127.0.0.1:40402
[S17] → join 127.0.0.1:40402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.103492 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.174959 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.167169 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.191723 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.184026 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.166970 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.191819 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.186235 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.124412 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.119619 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.142538 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.172543 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.145007 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.076722 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.164381 (no previous merge yet)
[S3]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S3] + discovered S5
[S3] + discovered S10
[S3] + discovered S15
[S4] + discovered S2
[S3] + discovered S4
[S3] + discovered S16
[S3] + discovered S7
[S3] + discovered S8
[S3] + discovered S9
[S3] + discovered S14
[S3] + discovered S13
[S3] + discovered S11
[S3] + discovered S6
[S4] + discovered S3
[S3] + discovered S17
[S4] + discovered S5
[S4] + discovered S7
[S4] + discovered S11
[S4] + discovered S13
[S4] + discovered S15
[S4] + discovered S16
[S4] + discovered S10
[S4] + discovered S14
[S4] + discovered S17
[S4] + discovered S6
[S4] + discovered S8
[S4] + discovered S9
[S5] + discovered S4
[S5] + discovered S3
[S5] + discovered S2
[S6] + discovered S4
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S5
[S5] + discovered S9
[S5] + discovered S8
[S5] + discovered S17
[S5] + discovered S14
[S5] + discovered S15
[S5] + discovered S7
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S10
[S5] + discovered S16
[S5] + discovered S13
[S7] + discovered S3
[S7] + discovered S6
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S4
[S6] + discovered S9
[S6] + discovered S15
[S6] + discovered S14
[S6] + discovered S17
[S6] + discovered S16
[S6] + discovered S13
[S6] + discovered S10
[S6] + discovered S11
[S6] + discovered S7
[S6] + discovered S8
[S8] + discovered S4
[S8] + discovered S7
[S8] + discovered S2
[S8] + discovered S5
[S8] + discovered S3
[S7] + discovered S8
[S7] + discovered S11
[S7] + discovered S16
[S7] + discovered S10
[S7] + discovered S17
[S7] + discovered S15
[S7] + discovered S14
[S7] + discovered S9
[S7] + discovered S13
[S8] + discovered S6
[S8] + discovered S15
[S8] + discovered S9
[S8] + discovered S11
[S8] + discovered S14
[S8] + discovered S17
[S8] + discovered S10
[S8] + discovered S16
[S9] + discovered S4
[S9] + discovered S2
[S9] + discovered S6
[S9] + discovered S5
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S8
[S8] + discovered S13
[S10] + discovered S7
[S10] + discovered S5
[S10] + discovered S6
[S10] + discovered S2
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S4
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S15
[S9] + discovered S10
[S9] + discovered S16
[S9] + discovered S17
[S9] + discovered S13
[S10] + discovered S9
[S11] + discovered S4
[S11] + discovered S10
[S11] + discovered S6
[S11] + discovered S7
[S11] + discovered S5
[S11] + discovered S3
[S11] + discovered S8
[S11] + discovered S2
[S11] + discovered S9
[S10] + discovered S13
[S10] + discovered S17
[S10] + discovered S11
[S10] + discovered S16
[S10] + discovered S15
[S10] + discovered S14
[S13] + discovered S3
[S13] + discovered S6
[S13] + discovered S10
[S13] + discovered S4
[S13] + discovered S9
[S13] + discovered S2
[S13] + discovered S8
[S13] + discovered S5
[S13] + discovered S7
[S13] + discovered S11
[S11] + discovered S14
[S11] + discovered S17
[S11] + discovered S15
[S11] + discovered S16
[S11] + discovered S13
[S13] + discovered S17
[S13] + discovered S15
[S13] + discovered S16
[S14] + discovered S9
[S14] + discovered S10
[S14] + discovered S3
[S14] + discovered S6
[S14] + discovered S4
[S14] + discovered S2
[S14] + discovered S8
[S14] + discovered S5
[S14] + discovered S7
[S14] + discovered S11
[S14] + discovered S13
[S13] + discovered S14
[S15] + discovered S13
[S15] + discovered S7
[S15] + discovered S5
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S15] + discovered S11
[S15] + discovered S8
[S15] + discovered S2
[S15] + discovered S4
[S15] + discovered S3
[S15] + discovered S10
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S9
[S16] + discovered S13
[S16] + discovered S11
[S16] + discovered S5
[S16] + discovered S7
[S16] + discovered S8
[S16] + discovered S2
[S16] + discovered S4
[S16] + discovered S14
[S16] + discovered S6
[S16] + discovered S15
[S16] + discovered S9
[S16] + discovered S3
[S16] + discovered S10
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S17
[S17] + discovered S10
[S17] + discovered S16
[S17] + discovered S9
[S17] + discovered S15
[S17] + discovered S14
[S17] + discovered S6
[S17] + discovered S2
[S17] + discovered S7
[S17] + discovered S8
[S17] + discovered S5
[S17] + discovered S13
[S17] + discovered S3
[S17] + discovered S4
[S17] + discovered S11
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:40414
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:40417
[S14] ⇄ pheromone p=1.000 → S4@127.0.0.1:40404
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:40412
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:40402
[S2] ⇄ pheromone p=1.000 → S16@127.0.0.1:40416
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:40404
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:40414
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:40410
[S9] ⇄ pheromone p=1.000 → S13@127.0.0.1:40413
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:40416
[S7] ⇄ pheromone p=1.000 → S10@127.0.0.1:40411
[S15] ⇄ pheromone p=1.000 → S16@127.0.0.1:40416
[S4] ⇄ pheromone p=1.000 → S9@127.0.0.1:40410
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:40410
[S2] START round=1 head_norm_before_train=1.115912 (no previous merge yet)
[S2] round=1 local utility u=0.023242 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7418690270064516, 'loss_val': 1.2584932731345917, 'psi': 0.3818138908357207}-{'f1_val': 0.1417771333885667, 'auprc': 0.7507828380276498, 'loss_val': 1.331718834145142, 'psi': 0.3853794152442}
[S3] START round=1 head_norm_before_train=1.180661 (no previous merge yet)
[S3] round=1 local utility u=0.178382 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7295617608492183, 'loss_val': 1.3249038201544052, 'psi': 0.37572874370815157}-{'f1_val': 0.13984006561410703, 'auprc': 0.6183801117831015, 'loss_val': 1.3481236831536083, 'psi': 0.3312560840817048}
[S4] START round=1 head_norm_before_train=1.178815 (no previous merge yet)
[S4] round=1 local utility u=0.054146 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.791496203554094, 'loss_val': 1.2544721487496393, 'psi': 0.4007344587587481}-{'f1_val': 0.14022662889518414, 'auprc': 0.775997646107285, 'loss_val': 1.3162690078997303, 'psi': 0.3945350357800245}
[S5] START round=1 head_norm_before_train=1.202119 (no previous merge yet)
[S5] round=1 local utility u=0.010317 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7455348742596309, 'loss_val': 1.2967490587628077, 'psi': 0.38357109256099525}-{'f1_val': 0.14226190476190476, 'auprc': 0.7505849949246433, 'loss_val': 1.3325336334601454, 'psi': 0.3855911408270002}
[S6] START round=1 head_norm_before_train=1.192567 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6242102533116255, 'loss_val': 1.2841016125744464, 'psi': 0.33453987055541945}-{'f1_val': 0.14142628205128205, 'auprc': 0.7056367378811139, 'loss_val': 1.3380986277261049, 'psi': 0.36711046438321476}
[S7] START round=1 head_norm_before_train=1.179634 (no previous merge yet)
[S7] round=1 local utility u=0.102157 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7711653321765433, 'loss_val': 1.316483846178167, 'psi': 0.3937002265080723}-{'f1_val': 0.14205682272909165, 'auprc': 0.7138332160535561, 'loss_val': 1.3488011916000404, 'psi': 0.37076738005887744}
[S8] START round=1 head_norm_before_train=1.212557 (no previous merge yet)
[S8] round=1 local utility u=0.188090 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7666735179428577, 'loss_val': 1.2614367313970551, 'psi': 0.3906429966129174}-{'f1_val': 0.13995598239295717, 'auprc': 0.6628997789238391, 'loss_val': 1.32629477510535, 'psi': 0.34913350100531}
[S9] START round=1 head_norm_before_train=1.194015 (no previous merge yet)
[S9] round=1 local utility u=0.176259 metrics={'f1_val': 0.15532176333565087, 'auprc': 0.9982217891017211, 'loss_val': 1.3027005879628246, 'psi': 0.492481773642079}-{'f1_val': 0.10457155477031801, 'auprc': 0.9948585025227938, 'loss_val': 1.3406265780381392, 'psi': 0.46068633387130836}
[S10] START round=1 head_norm_before_train=1.134964 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6533096052823787, 'loss_val': 1.2799227046487154, 'psi': 0.34449682463798587}-{'f1_val': 0.3884994429453613, 'auprc': 0.7701708368411022, 'loss_val': 1.3442591820531131, 'psi': 0.5411680005036577}
[S11] START round=1 head_norm_before_train=1.126523 (no previous merge yet)
[S11] round=1 local utility u=0.534039 metrics={'f1_val': 0.42273739039721175, 'auprc': 0.7478509150765581, 'loss_val': 1.3271847968396964, 'psi': 0.5527828002689503}-{'f1_val': 0.3854114742813739, 'auprc': 0.4773197527226153, 'loss_val': 1.3597138242938698, 'psi': 0.4221747856578705}
[S13] START round=1 head_norm_before_train=1.150617 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7189808330224784, 'loss_val': 1.2946767846225504, 'psi': 0.3718237907552232}-{'f1_val': 0.3749587552370789, 'auprc': 0.6905991916674369, 'loss_val': 1.357942713610038, 'psi': 0.5012149298092221}
[S14] START round=1 head_norm_before_train=1.168105 (no previous merge yet)
[S14] round=1 local utility u=0.541863 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.4744730373944802, 'loss_val': 1.368959146643681, 'psi': 0.27400392668741436}-{'f1_val': 0.02406779661016949, 'auprc': 0.3529508100192296, 'loss_val': 1.3903776105658974, 'psi': 0.15562100197379353}
[S15] START round=1 head_norm_before_train=1.155455 (no previous merge yet)
[S15] round=1 local utility u=0.035747 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7736116450174153, 'loss_val': 1.2732357920360629, 'psi': 0.39328484882390113}-{'f1_val': 0.13973365136155833, 'auprc': 0.7721097603246997, 'loss_val': 1.3402238836594274, 'psi': 0.3926840949468149}
[S16] START round=1 head_norm_before_train=1.080139 (no previous merge yet)
[S16] round=1 local utility u=0.332611 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6556119492944487, 'loss_val': 1.3306505161561568, 'psi': 0.3466272498373014}-{'f1_val': 0.14063745019920318, 'auprc': 0.4437669125711092, 'loss_val': 1.3603372018975874, 'psi': 0.2618892351479656}
[S17] START round=1 head_norm_before_train=1.170375 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5643510402457271, 'loss_val': 1.3002860078551646, 'psi': 0.3103097940887215}-{'f1_val': 0.14094896331738438, 'auprc': 0.5931090279703113, 'loss_val': 1.3609759420556784, 'psi': 0.32181298917855516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S2] → sending delta(kind=head bytes=1787) to S6@127.0.0.1:40407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:40407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S3] → sending delta(kind=head bytes=1784) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S4] → sending delta(kind=head bytes=1784) to S17@127.0.0.1:40417
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S7] → sending delta(kind=head bytes=1784) to S15@127.0.0.1:40415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:40411
[S9] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1784 to 1 peers)
[S4] sending update (kind=head size=1784 to 1 peers)
[S3] sending update (kind=head size=1784 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1787 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1789) from S14
[S13] cosine check vs S14: cos=-0.0470
[S13] DROPPED delta from S14 (cos=-0.0470 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1784) from S3
[S11] cosine check vs S3: cos=0.0084
[S16] RECEIVED delta(kind=head bytes=1795) from S8
[S16] cosine check vs S8: cos=-0.0940
[S16] DROPPED delta from S8 (cos=-0.0940 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1784) from S4
[S17] cosine check vs S4: cos=-0.0527
[S17] DROPPED delta from S4 (cos=-0.0527 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1790) from S16
[S10] cosine check vs S16: cos=0.0726
[S10] RECEIVED delta(kind=head bytes=1796) from S9
[S10] cosine check vs S9: cos=-0.0779
[S10] DROPPED delta from S9 (cos=-0.0779 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1784) from S7
[S15] cosine check vs S7: cos=-0.0447
[S15] DROPPED delta from S7 (cos=-0.0447 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S11
[S14] cosine check vs S11: cos=0.0634
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.0378
[S6] RECEIVED delta(kind=head bytes=1792) from S5
[S6] cosine check vs S5: cos=-0.0150
[S6] DROPPED delta from S5 (cos=-0.0150 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1787) from S2
[S6] cosine check vs S2: cos=0.0945
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.169699
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.710240e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.829039 delta_norm=0.771024
[S10] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.216522
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.002869e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.879759 delta_norm=0.800287
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1404 head_norm=1.170981
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.996617e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1714 head_norm=0.747189 delta_norm=0.699662
[S14] aggregate: ACCEPT kept=['S11', 'S15'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.4227 head_norm=1.140254
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.211766e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.3965 head_norm=0.828058 delta_norm=0.821177
[S11] aggregate: ROLLBACK (f1_val pre=0.423 post=0.396 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=1.161440 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7056961847340063, 'loss_val': 1.163865387018954, 'psi': 0.3673447539267426}-{'f1_val': 0.1417771333885667, 'auprc': 0.7418690270064516, 'loss_val': 1.2584932731345917, 'psi': 0.3818138908357207}
[S3] START round=2 head_norm_before_train=1.191571 (no previous merge yet)
[S3] round=2 local utility u=0.062280 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7619777686318581, 'loss_val': 1.2975919224562487, 'psi': 0.3886951468212074}-{'f1_val': 0.13984006561410703, 'auprc': 0.7295617608492183, 'loss_val': 1.3249038201544052, 'psi': 0.37572874370815157}
[S4] START round=2 head_norm_before_train=1.214403 (no previous merge yet)
[S4] round=2 local utility u=0.058448 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7908000114147238, 'loss_val': 1.1354872404055196, 'psi': 0.400455981903}-{'f1_val': 0.14022662889518414, 'auprc': 0.791496203554094, 'loss_val': 1.2544721487496393, 'psi': 0.4007344587587481}
[S5] START round=2 head_norm_before_train=1.220707 (no previous merge yet)
[S5] round=2 local utility u=0.029254 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.752931553136505, 'loss_val': 1.2604303557825427, 'psi': 0.38652976411174483}-{'f1_val': 0.14226190476190476, 'auprc': 0.7455348742596309, 'loss_val': 1.2967490587628077, 'psi': 0.38357109256099525}
[S6] START round=2 head_norm_before_train=0.879759 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.057854 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6535608384180082, 'loss_val': 1.2564457483852391, 'psi': 0.3462801045979725}-{'f1_val': 0.14142628205128205, 'auprc': 0.6242102533116255, 'loss_val': 1.2841016125744464, 'psi': 0.33453987055541945}
[S7] START round=2 head_norm_before_train=1.199056 (no previous merge yet)
[S7] round=2 local utility u=0.026072 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776099797667464, 'loss_val': 1.2836728237453985, 'psi': 0.39627808554415356}-{'f1_val': 0.14205682272909165, 'auprc': 0.7711653321765433, 'loss_val': 1.316483846178167, 'psi': 0.3937002265080723}
[S8] START round=2 head_norm_before_train=1.254049 (no previous merge yet)
[S8] round=2 local utility u=0.051140 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7661305942555344, 'loss_val': 1.1575280481262162, 'psi': 0.3904258271379881}-{'f1_val': 0.13995598239295717, 'auprc': 0.7666735179428577, 'loss_val': 1.2614367313970551, 'psi': 0.3906429966129174}
[S9] START round=2 head_norm_before_train=1.208743 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9947580802696022, 'loss_val': 1.2518640404525376, 'psi': 0.4827420063918385}-{'f1_val': 0.15532176333565087, 'auprc': 0.9982217891017211, 'loss_val': 1.3027005879628246, 'psi': 0.492481773642079}
[S10] START round=2 head_norm_before_train=0.829039 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6027117604734774, 'loss_val': 1.2402579678216439, 'psi': 0.32425768671442534}-{'f1_val': 0.13862163754172394, 'auprc': 0.6533096052823787, 'loss_val': 1.2799227046487154, 'psi': 0.34449682463798587}
[S11] START round=2 head_norm_before_train=0.828058 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7800249545760185, 'loss_val': 1.3275475490289508, 'psi': 0.39625819185427374}-{'f1_val': 0.42273739039721175, 'auprc': 0.7478509150765581, 'loss_val': 1.3271847968396964, 'psi': 0.5527828002689503}
[S13] START round=2 head_norm_before_train=1.176059 (no previous merge yet)
[S13] round=2 local utility u=0.029753 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.709262873634167, 'loss_val': 1.2060163334630682, 'psi': 0.36793660699989866}-{'f1_val': 0.1403857625770531, 'auprc': 0.7189808330224784, 'loss_val': 1.2946767846225504, 'psi': 0.3718237907552232}
[S14] START round=2 head_norm_before_train=0.747189 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.300109 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6701833113956678, 'loss_val': 1.3558718264186134, 'psi': 0.35228803628788935}-{'f1_val': 0.14035785288270378, 'auprc': 0.4744730373944802, 'loss_val': 1.368959146643681, 'psi': 0.27400392668741436}
[S15] START round=2 head_norm_before_train=1.196262 (no previous merge yet)
[S15] round=2 local utility u=0.034139 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7769968121727688, 'loss_val': 1.2151140559984286, 'psi': 0.39463891568604254}-{'f1_val': 0.13973365136155833, 'auprc': 0.7736116450174153, 'loss_val': 1.2732357920360629, 'psi': 0.39328484882390113}
[S16] START round=2 head_norm_before_train=1.093331 (no previous merge yet)
[S16] round=2 local utility u=0.154915 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7464807899233221, 'loss_val': 1.2934268279559193, 'psi': 0.3829747860888507}-{'f1_val': 0.14063745019920318, 'auprc': 0.6556119492944487, 'loss_val': 1.3306505161561568, 'psi': 0.3466272498373014}
[S17] START round=2 head_norm_before_train=1.200767 (no previous merge yet)
[S17] round=2 local utility u=0.039437 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.55359972102201, 'loss_val': 1.1891589943562382, 'psi': 0.30600926639923465}-{'f1_val': 0.14094896331738438, 'auprc': 0.5643510402457271, 'loss_val': 1.3002860078551646, 'psi': 0.3103097940887215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:40412
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:40405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:40412
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S3] → sending delta(kind=head bytes=1787) to S6@127.0.0.1:40407
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] → sending delta(kind=head bytes=1789) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:40408
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1787 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1789) from S6
[S13] cosine check vs S6: cos=-0.1154
[S13] DROPPED delta from S6 (cos=-0.1154 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1793) from S8
[S13] cosine check vs S8: cos=0.1030
[S11] RECEIVED delta(kind=head bytes=1792) from S7
[S11] cosine check vs S7: cos=-0.1529
[S11] DROPPED delta from S7 (cos=-0.1529 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] cosine check vs S14: cos=0.3306
[S7] RECEIVED delta(kind=head bytes=1798) from S15
[S7] cosine check vs S15: cos=-0.0487
[S7] DROPPED delta from S15 (cos=-0.0487 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1792) from S5
[S11] cosine check vs S5: cos=-0.0252
[S11] DROPPED delta from S5 (cos=-0.0252 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S4
[S16] cosine check vs S4: cos=-0.0089
[S16] DROPPED delta from S4 (cos=-0.0089 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S16
[S10] cosine check vs S16: cos=0.6770
[S6] RECEIVED delta(kind=head bytes=1787) from S3
[S6] cosine check vs S3: cos=-0.0602
[S6] DROPPED delta from S3 (cos=-0.0602 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S13
[S5] cosine check vs S13: cos=0.1575
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:40408
[S17] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S17
[S7] cosine check vs S17: cos=-0.0466
[S7] DROPPED delta from S17 (cos=-0.0466 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=0.840708
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.649554e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.654380 delta_norm=0.464955
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=0.876710
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.154648e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.914152 delta_norm=0.415465
[S10] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=2 metric=0.1404 head_norm=1.221486
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.494148e-01
[S13] stored merged vector for next round verification (round=2)
[S13] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.941696 delta_norm=0.849415
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=2 metric=0.1423 head_norm=1.243537
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.999836e-01
[S5] stored merged vector for next round verification (round=2)
[S5] DEBUG after merge:  round=2 metric=0.1423 head_norm=0.937674 delta_norm=0.799984
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.223816 (no previous merge yet)
[S2] round=3 local utility u=1.000000 metrics={'f1_val': 0.41612721744372705, 'auprc': 0.776702574543414, 'loss_val': 1.0015339787082678, 'psi': 0.5603573602836018}-{'f1_val': 0.1417771333885667, 'auprc': 0.7056961847340063, 'loss_val': 1.163865387018954, 'psi': 0.3673447539267426}
[S3] START round=3 head_norm_before_train=1.211284 (no previous merge yet)
[S3] round=3 local utility u=0.168500 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8626270269172464, 'loss_val': 1.2625394719022096, 'psi': 0.42895485013536283}-{'f1_val': 0.13984006561410703, 'auprc': 0.7619777686318581, 'loss_val': 1.2975919224562487, 'psi': 0.3886951468212074}
[S4] START round=3 head_norm_before_train=1.267891 (no previous merge yet)
[S4] round=3 local utility u=1.000000 metrics={'f1_val': 0.6715073238747159, 'auprc': 0.7869645599461039, 'loss_val': 0.8593318858124458, 'psi': 0.7176902183032712}-{'f1_val': 0.14022662889518414, 'auprc': 0.7908000114147238, 'loss_val': 1.1354872404055196, 'psi': 0.400455981903}
[S5] START round=3 head_norm_before_train=0.937674 cos_to_last_merge=1.0000 (last merge round=2)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7326899605477097, 'loss_val': 1.2684575653203891, 'psi': 0.3784331270762268}-{'f1_val': 0.14226190476190476, 'auprc': 0.752931553136505, 'loss_val': 1.2604303557825427, 'psi': 0.38652976411174483}
[S6] START round=3 head_norm_before_train=0.915810 cos_to_last_merge=0.9943 (last merge round=1)
[S6] round=3 local utility u=0.009309 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.642836512298544, 'loss_val': 1.2056542310252456, 'psi': 0.3419903741501868}-{'f1_val': 0.14142628205128205, 'auprc': 0.6535608384180082, 'loss_val': 1.2564457483852391, 'psi': 0.3462801045979725}
[S7] START round=3 head_norm_before_train=1.222681 (no previous merge yet)
[S7] round=3 local utility u=0.019027 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776578493264678, 'loss_val': 1.2457624437199188, 'psi': 0.3962972333680421}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776099797667464, 'loss_val': 1.2836728237453985, 'psi': 0.39627808554415356}
[S8] START round=3 head_norm_before_train=1.313228 (no previous merge yet)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.7155418933751417, 'auprc': 0.7807265630784818, 'loss_val': 0.9844324127576725, 'psi': 0.7416157612564778}-{'f1_val': 0.13995598239295717, 'auprc': 0.7661305942555344, 'loss_val': 1.1575280481262162, 'psi': 0.3904258271379881}
[S9] START round=3 head_norm_before_train=1.234246 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.876657567455414, 'loss_val': 1.1890199623504518, 'psi': 0.4355018012661632}-{'f1_val': 0.141397957139996, 'auprc': 0.9947580802696022, 'loss_val': 1.2518640404525376, 'psi': 0.4827420063918385}
[S10] START round=3 head_norm_before_train=0.914152 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.044323 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6031708047573044, 'loss_val': 1.1529899584392767, 'psi': 0.32444130442795616}-{'f1_val': 0.13862163754172394, 'auprc': 0.6027117604734774, 'loss_val': 1.2402579678216439, 'psi': 0.32425768671442534}
[S11] START round=3 head_norm_before_train=0.654380 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6008606408748575, 'loss_val': 1.3187106299059919, 'psi': 0.32459246637380934}-{'f1_val': 0.14041368337311058, 'auprc': 0.7800249545760185, 'loss_val': 1.3275475490289508, 'psi': 0.39625819185427374}
[S13] START round=3 head_norm_before_train=0.941696 cos_to_last_merge=1.0000 (last merge round=2)
[S13] round=3 local utility u=0.704394 metrics={'f1_val': 0.3603526529007249, 'auprc': 0.7189557564988504, 'loss_val': 1.1461079804474517, 'psi': 0.5037938943399751}-{'f1_val': 0.1403857625770531, 'auprc': 0.709262873634167, 'loss_val': 1.2060163334630682, 'psi': 0.36793660699989866}
[S14] START round=3 head_norm_before_train=0.762892 cos_to_last_merge=0.9967 (last merge round=1)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.647523429265077, 'loss_val': 1.334071646847856, 'psi': 0.3432240834356531}-{'f1_val': 0.14035785288270378, 'auprc': 0.6701833113956678, 'loss_val': 1.3558718264186134, 'psi': 0.35228803628788935}
[S15] START round=3 head_norm_before_train=1.236692 (no previous merge yet)
[S15] round=3 local utility u=0.835199 metrics={'f1_val': 0.4037370287044174, 'auprc': 0.7770523705630563, 'loss_val': 1.128902648391527, 'psi': 0.553063165447873}-{'f1_val': 0.13973365136155833, 'auprc': 0.7769968121727688, 'loss_val': 1.2151140559984286, 'psi': 0.39463891568604254}
[S16] START round=3 head_norm_before_train=1.117117 (no previous merge yet)
[S16] round=3 local utility u=0.145397 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8319527980613372, 'loss_val': 1.2590488971371843, 'psi': 0.41716358934405684}-{'f1_val': 0.14063745019920318, 'auprc': 0.7464807899233221, 'loss_val': 1.2934268279559193, 'psi': 0.3829747860888507}
[S17] START round=3 head_norm_before_train=1.252784 (no previous merge yet)
[S17] round=3 local utility u=0.973613 metrics={'f1_val': 0.39183458374649976, 'auprc': 0.639669504641266, 'loss_val': 1.0054562013430401, 'psi': 0.49096855210440626}-{'f1_val': 0.14094896331738438, 'auprc': 0.55359972102201, 'loss_val': 1.1891589943562382, 'psi': 0.30600926639923465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:40416
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S7] → sending delta(kind=head bytes=1787) to S10@127.0.0.1:40411
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:40409
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:40409
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1787 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S13
[S16] cosine check vs S13: cos=-0.1179
[S16] DROPPED delta from S13 (cos=-0.1179 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=-0.0989
[S17] DROPPED delta from S8 (cos=-0.0989 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1790) from S10
[S14] cosine check vs S10: cos=0.0697
[S9] RECEIVED delta(kind=head bytes=1795) from S4
[S9] cosine check vs S4: cos=0.0394
[S8] RECEIVED delta(kind=head bytes=1796) from S16
[S8] cosine check vs S16: cos=-0.0921
[S8] DROPPED delta from S16 (cos=-0.0921 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1792) from S2
[S8] cosine check vs S2: cos=-0.0718
[S8] DROPPED delta from S2 (cos=-0.0718 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1791) from S6
[S11] cosine check vs S6: cos=0.0475
[S16] RECEIVED delta(kind=head bytes=1802) from S15
[S16] cosine check vs S15: cos=-0.0072
[S16] DROPPED delta from S15 (cos=-0.0072 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1787) from S7
[S10] cosine check vs S7: cos=-0.0517
[S10] DROPPED delta from S7 (cos=-0.0517 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] cosine check vs S3: cos=-0.0293
[S4] DROPPED delta from S3 (cos=-0.0293 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1790 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1790) from S17
[S9] cosine check vs S17: cos=0.0450
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=0.787707
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.959256e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.638209 delta_norm=0.595926
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=1.264606
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.589501e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.804354 delta_norm=0.758950
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=0.676814
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.679507e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.594090 delta_norm=0.567951
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.290033 (no previous merge yet)
[S2] round=4 local utility u=1.000000 metrics={'f1_val': 0.7137713493589065, 'auprc': 0.7778234838229748, 'loss_val': 0.7574726017736529, 'psi': 0.7393922031445339}-{'f1_val': 0.41612721744372705, 'auprc': 0.776702574543414, 'loss_val': 1.0015339787082678, 'psi': 0.5603573602836018}
[S3] START round=4 head_norm_before_train=1.239762 (no previous merge yet)
[S3] round=4 local utility u=0.114973 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9246916424504272, 'loss_val': 1.218788219341393, 'psi': 0.45378069634863516}-{'f1_val': 0.13984006561410703, 'auprc': 0.8626270269172464, 'loss_val': 1.2625394719022096, 'psi': 0.42895485013536283}
[S4] START round=4 head_norm_before_train=1.340031 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.6759343826242893, 'auprc': 0.6525803922808527, 'loss_val': 0.5411236754408645, 'psi': 0.6665927864869147}-{'f1_val': 0.6715073238747159, 'auprc': 0.7869645599461039, 'loss_val': 0.8593318858124458, 'psi': 0.7176902183032712}
[S5] START round=4 head_norm_before_train=0.957600 cos_to_last_merge=0.9982 (last merge round=2)
[S5] round=4 local utility u=0.022647 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7343753934617328, 'loss_val': 1.2282191184167313, 'psi': 0.379107300241836}-{'f1_val': 0.14226190476190476, 'auprc': 0.7326899605477097, 'loss_val': 1.2684575653203891, 'psi': 0.3784331270762268}
[S6] START round=4 head_norm_before_train=0.944958 cos_to_last_merge=0.9858 (last merge round=1)
[S6] round=4 local utility u=0.795798 metrics={'f1_val': 0.38626126345163114, 'auprc': 0.6435493318211911, 'loss_val': 1.085205690230373, 'psi': 0.48917649079945513}-{'f1_val': 0.14142628205128205, 'auprc': 0.642836512298544, 'loss_val': 1.2056542310252456, 'psi': 0.3419903741501868}
[S7] START round=4 head_norm_before_train=1.254450 (no previous merge yet)
[S7] round=4 local utility u=0.009906 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776898269876241, 'loss_val': 1.2260461909943583, 'psi': 0.3963100244325047}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776578493264678, 'loss_val': 1.2457624437199188, 'psi': 0.3962972333680421}
[S8] START round=4 head_norm_before_train=1.365008 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.3729322731464855, 'auprc': 0.7939883690376386, 'loss_val': 0.7236141452485034, 'psi': 0.5413547115029468}-{'f1_val': 0.7155418933751417, 'auprc': 0.7807265630784818, 'loss_val': 0.9844324127576725, 'psi': 0.7416157612564778}
[S9] START round=4 head_norm_before_train=0.804354 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8155624621733972, 'loss_val': 1.1868720494175764, 'psi': 0.4110637591533565}-{'f1_val': 0.141397957139996, 'auprc': 0.876657567455414, 'loss_val': 1.1890199623504518, 'psi': 0.4355018012661632}
[S10] START round=4 head_norm_before_train=0.950997 cos_to_last_merge=0.9917 (last merge round=2)
[S10] round=4 local utility u=1.000000 metrics={'f1_val': 0.4317133252059552, 'auprc': 0.6636853593220381, 'loss_val': 0.9119794882597018, 'psi': 0.5245021388523883}-{'f1_val': 0.13862163754172394, 'auprc': 0.6031708047573044, 'loss_val': 1.1529899584392767, 'psi': 0.32444130442795616}
[S11] START round=4 head_norm_before_train=0.594090 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5926406763325403, 'loss_val': 1.2997360476403232, 'psi': 0.32130448055688243}-{'f1_val': 0.14041368337311058, 'auprc': 0.6008606408748575, 'loss_val': 1.3187106299059919, 'psi': 0.32459246637380934}
[S13] START round=4 head_norm_before_train=0.990825 cos_to_last_merge=0.9949 (last merge round=2)
[S13] round=4 local utility u=0.128376 metrics={'f1_val': 0.37169029467602305, 'auprc': 0.7169507791266623, 'loss_val': 0.9513665961536144, 'psi': 0.5097944884562787}-{'f1_val': 0.3603526529007249, 'auprc': 0.7189557564988504, 'loss_val': 1.1461079804474517, 'psi': 0.5037938943399751}
[S14] START round=4 head_norm_before_train=0.638209 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.31454429173642057, 'loss_val': 1.3335670075110448, 'psi': 0.2100324284241905}-{'f1_val': 0.14035785288270378, 'auprc': 0.647523429265077, 'loss_val': 1.334071646847856, 'psi': 0.3432240834356531}
[S15] START round=4 head_norm_before_train=1.272784 (no previous merge yet)
[S15] round=4 local utility u=1.000000 metrics={'f1_val': 0.715238308518366, 'auprc': 0.7915116496131596, 'loss_val': 0.872504409206211, 'psi': 0.7457476449562834}-{'f1_val': 0.4037370287044174, 'auprc': 0.7770523705630563, 'loss_val': 1.128902648391527, 'psi': 0.553063165447873}
[S16] START round=4 head_norm_before_train=1.142561 (no previous merge yet)
[S16] round=4 local utility u=0.014281 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8320401065530417, 'loss_val': 1.230749599086726, 'psi': 0.4171985127407386}-{'f1_val': 0.14063745019920318, 'auprc': 0.8319527980613372, 'loss_val': 1.2590488971371843, 'psi': 0.41716358934405684}
[S17] START round=4 head_norm_before_train=1.323492 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.3519909574605653, 'auprc': 0.48284287927729447, 'loss_val': 0.9497283017952023, 'psi': 0.404331726187257}-{'f1_val': 0.39183458374649976, 'auprc': 0.639669504641266, 'loss_val': 1.0054562013430401, 'psi': 0.49096855210440626}
[S6] not sending this round → trigger blocked (psi=0.489)
[S13] not sending this round → trigger blocked (psi=0.510)
[S10] not sending this round → trigger blocked (psi=0.525)
[S16] not sending this round → trigger blocked (psi=0.417)
[S2] not sending this round → trigger blocked (psi=0.739)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:40410
[S7] not sending this round → trigger blocked (psi=0.396)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.454)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.746)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=0.0019
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.1414 head_norm=0.831832
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.447499e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.645971 delta_norm=0.644750
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.369362 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.7144114304879488, 'auprc': 0.7799766478103339, 'loss_val': 0.8429181000420595, 'psi': 0.7406375174169029}-{'f1_val': 0.7137713493589065, 'auprc': 0.7778234838229748, 'loss_val': 0.7574726017736529, 'psi': 0.7393922031445339}
[S3] START round=5 head_norm_before_train=1.274174 (no previous merge yet)
[S3] round=5 local utility u=0.038984 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9272453031638374, 'loss_val': 1.1484818665416991, 'psi': 0.45480216063399914}-{'f1_val': 0.13984006561410703, 'auprc': 0.9246916424504272, 'loss_val': 1.218788219341393, 'psi': 0.45378069634863516}
[S4] START round=5 head_norm_before_train=1.436506 (no previous merge yet)
[S4] round=5 local utility u=0.063232 metrics={'f1_val': 0.6743233147143423, 'auprc': 0.6595017012943013, 'loss_val': 0.4257571739188792, 'psi': 0.6683946693463259}-{'f1_val': 0.6759343826242893, 'auprc': 0.6525803922808527, 'loss_val': 0.5411236754408645, 'psi': 0.6665927864869147}
[S5] START round=5 head_norm_before_train=0.986924 cos_to_last_merge=0.9927 (last merge round=2)
[S5] round=5 local utility u=0.067405 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7657099461050555, 'loss_val': 1.1874126647276764, 'psi': 0.39164112129916506}-{'f1_val': 0.14226190476190476, 'auprc': 0.7343753934617328, 'loss_val': 1.2282191184167313, 'psi': 0.379107300241836}
[S6] START round=5 head_norm_before_train=0.987183 cos_to_last_merge=0.9725 (last merge round=1)
[S6] round=5 local utility u=0.385420 metrics={'f1_val': 0.4172560359570804, 'auprc': 0.7646034205041177, 'loss_val': 0.8634962306153352, 'psi': 0.5561949897758953}-{'f1_val': 0.38626126345163114, 'auprc': 0.6435493318211911, 'loss_val': 1.085205690230373, 'psi': 0.48917649079945513}
[S7] START round=5 head_norm_before_train=1.280125 (no previous merge yet)
[S7] round=5 local utility u=0.019620 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777788019713332, 'loss_val': 1.1870723506738372, 'psi': 0.3963456144259883}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776898269876241, 'loss_val': 1.2260461909943583, 'psi': 0.3963100244325047}
[S8] START round=5 head_norm_before_train=1.439127 (no previous merge yet)
[S8] round=5 local utility u=1.000000 metrics={'f1_val': 0.7140449400060004, 'auprc': 0.9949568636315073, 'loss_val': 0.5110379452776895, 'psi': 0.8264097094562031}-{'f1_val': 0.3729322731464855, 'auprc': 0.7939883690376386, 'loss_val': 0.7236141452485034, 'psi': 0.5413547115029468}
[S9] START round=5 head_norm_before_train=0.645971 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7733209626949042, 'loss_val': 1.179026886494293, 'psi': 0.39416715936195934}-{'f1_val': 0.141397957139996, 'auprc': 0.8155624621733972, 'loss_val': 1.1868720494175764, 'psi': 0.4110637591533565}
[S10] START round=5 head_norm_before_train=0.999641 cos_to_last_merge=0.9726 (last merge round=2)
[S10] round=5 local utility u=0.927237 metrics={'f1_val': 0.5427752471522085, 'auprc': 0.9839476961537981, 'loss_val': 0.6846635220163924, 'psi': 0.7192442267528443}-{'f1_val': 0.4317133252059552, 'auprc': 0.6636853593220381, 'loss_val': 0.9119794882597018, 'psi': 0.5245021388523883}
[S11] START round=5 head_norm_before_train=0.616887 cos_to_last_merge=0.9914 (last merge round=3)
[S11] round=5 local utility u=0.107288 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6402888886710294, 'loss_val': 1.2281054553588817, 'psi': 0.3403637654922781}-{'f1_val': 0.14041368337311058, 'auprc': 0.5926406763325403, 'loss_val': 1.2997360476403232, 'psi': 0.32130448055688243}
[S13] START round=5 head_norm_before_train=1.056185 cos_to_last_merge=0.9831 (last merge round=2)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.35976402523913004, 'auprc': 0.6129743427671064, 'loss_val': 0.8835335852568774, 'psi': 0.4610481522503206}-{'f1_val': 0.37169029467602305, 'auprc': 0.7169507791266623, 'loss_val': 0.9513665961536144, 'psi': 0.5097944884562787}
[S14] START round=5 head_norm_before_train=0.664126 cos_to_last_merge=0.9946 (last merge round=3)
[S14] round=5 local utility u=0.052362 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.3409652874836715, 'loss_val': 1.3081067783362448, 'psi': 0.2206008267230909}-{'f1_val': 0.14035785288270378, 'auprc': 0.31454429173642057, 'loss_val': 1.3335670075110448, 'psi': 0.2100324284241905}
[S15] START round=5 head_norm_before_train=1.342769 (no previous merge yet)
[S15] round=5 local utility u=0.092192 metrics={'f1_val': 0.6968860718070718, 'auprc': 0.7996572033192455, 'loss_val': 0.6024428915823665, 'psi': 0.7379945244119414}-{'f1_val': 0.715238308518366, 'auprc': 0.7915116496131596, 'loss_val': 0.872504409206211, 'psi': 0.7457476449562834}
[S16] START round=5 head_norm_before_train=1.170915 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.586919968408815, 'loss_val': 1.1820911169666093, 'psi': 0.31915045748304793}-{'f1_val': 0.14063745019920318, 'auprc': 0.8320401065530417, 'loss_val': 1.230749599086726, 'psi': 0.4171985127407386}
[S17] START round=5 head_norm_before_train=1.391694 (no previous merge yet)
[S17] round=5 local utility u=0.308858 metrics={'f1_val': 0.34900811318887903, 'auprc': 0.6997608984075105, 'loss_val': 0.9648687161171903, 'psi': 0.48930922727633164}-{'f1_val': 0.3519909574605653, 'auprc': 0.48284287927729447, 'loss_val': 0.9497283017952023, 'psi': 0.404331726187257}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:40416
[S5] not sending this round → trigger blocked (psi=0.392)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S6] → sending delta(kind=head bytes=1788) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:40417
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:40411
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1788 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1788) from S6
[S11] cosine check vs S6: cos=0.7265
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] cosine check vs S15: cos=-0.0202
[S16] DROPPED delta from S15 (cos=-0.0202 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=-0.1028
[S17] DROPPED delta from S8 (cos=-0.1028 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1790) from S7
[S10] cosine check vs S7: cos=-0.0475
[S10] DROPPED delta from S7 (cos=-0.0475 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] cosine check vs S11: cos=0.3808
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=0.7069
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] cosine check vs S4: cos=0.2277
[S4] RECEIVED delta(kind=head bytes=1800) from S14
[S4] cosine check vs S14: cos=-0.0498
[S4] DROPPED delta from S14 (cos=-0.0498 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] cosine check vs S3: cos=-0.0305
[S4] DROPPED delta from S3 (cos=-0.0305 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] cosine check vs S17: cos=0.2524
[S2] ⇄ pheromone p=0.618 → S8@127.0.0.1:40409
[S5] ⇄ pheromone p=0.349 → S9@127.0.0.1:40410
[S13] ⇄ pheromone p=0.441 → S16@127.0.0.1:40416
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.673452
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.090924e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.706111 delta_norm=0.509092
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.342 → S13@127.0.0.1:40413
[S10] ⇄ pheromone p=0.679 → S14@127.0.0.1:40414
[S4] ⇄ pheromone p=0.479 → S9@127.0.0.1:40410
[S15] ⇄ pheromone p=0.619 → S16@127.0.0.1:40416
[S3] ⇄ pheromone p=0.396 → S4@127.0.0.1:40404
[S6] ⇄ pheromone p=0.539 → S11@127.0.0.1:40412
[S8] ⇄ pheromone p=0.676 → S17@127.0.0.1:40417
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.698524
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.203297e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.633089 delta_norm=0.220330
[S14] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.413 → S4@127.0.0.1:40404
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.651217
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.637413e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.792164 delta_norm=0.363741
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.393 → S14@127.0.0.1:40414
[S7] ⇄ pheromone p=0.347 → S10@127.0.0.1:40411
[S16] ⇄ pheromone p=0.392 → S8@127.0.0.1:40409
[S17] ⇄ pheromone p=0.518 → S9@127.0.0.1:40410
[S2] START round=6 head_norm_before_train=1.458304 (no previous merge yet)
[S2] round=6 local utility u=0.143764 metrics={'f1_val': 0.7023146275646055, 'auprc': 0.777789922640939, 'loss_val': 0.4762489150592616, 'psi': 0.7325047455951389}-{'f1_val': 0.7144114304879488, 'auprc': 0.7799766478103339, 'loss_val': 0.8429181000420595, 'psi': 0.7406375174169029}
[S3] START round=6 head_norm_before_train=1.312613 (no previous merge yet)
[S3] round=6 local utility u=0.774175 metrics={'f1_val': 0.39642092198300777, 'auprc': 0.8862402253610405, 'loss_val': 1.0166021344436427, 'psi': 0.5923486433342209}-{'f1_val': 0.13984006561410703, 'auprc': 0.9272453031638374, 'loss_val': 1.1484818665416991, 'psi': 0.45480216063399914}
[S4] START round=6 head_norm_before_train=1.526712 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.6675769593172892, 'auprc': 0.6595075030144826, 'loss_val': 0.43238592090159045, 'psi': 0.6643491767961666}-{'f1_val': 0.6743233147143423, 'auprc': 0.6595017012943013, 'loss_val': 0.4257571739188792, 'psi': 0.6683946693463259}
[S5] START round=6 head_norm_before_train=1.012041 cos_to_last_merge=0.9869 (last merge round=2)
[S5] round=6 local utility u=0.865834 metrics={'f1_val': 0.41706350156788563, 'auprc': 0.7722674356389072, 'loss_val': 1.124227676258944, 'psi': 0.5591450751962943}-{'f1_val': 0.14226190476190476, 'auprc': 0.7657099461050555, 'loss_val': 1.1874126647276764, 'psi': 0.39164112129916506}
[S6] START round=6 head_norm_before_train=1.046699 cos_to_last_merge=0.9531 (last merge round=1)
[S6] round=6 local utility u=0.131301 metrics={'f1_val': 0.41596878668975623, 'auprc': 0.7950720678283828, 'loss_val': 0.684576957504965, 'psi': 0.5676100991452069}-{'f1_val': 0.4172560359570804, 'auprc': 0.7646034205041177, 'loss_val': 0.8634962306153352, 'psi': 0.5561949897758953}
[S7] START round=6 head_norm_before_train=1.290596 (no previous merge yet)
[S7] round=6 local utility u=0.022509 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775582282314976, 'loss_val': 1.1413917839996324, 'psi': 0.396257384930054}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777788019713332, 'loss_val': 1.1870723506738372, 'psi': 0.3963456144259883}
[S8] START round=6 head_norm_before_train=1.508949 (no previous merge yet)
[S8] round=6 local utility u=0.050312 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.99349665081149, 'loss_val': 0.40508854798339033, 'psi': 0.825731140403065}-{'f1_val': 0.7140449400060004, 'auprc': 0.9949568636315073, 'loss_val': 0.5110379452776895, 'psi': 0.8264097094562031}
[S9] START round=6 head_norm_before_train=0.706111 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.072882 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8022519782127652, 'loss_val': 1.120056010585167, 'psi': 0.4057395655691037}-{'f1_val': 0.141397957139996, 'auprc': 0.7733209626949042, 'loss_val': 1.179026886494293, 'psi': 0.39416715936195934}
[S10] START round=6 head_norm_before_train=1.075933 cos_to_last_merge=0.9412 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.941
[S10] round=6 local utility u=0.567142 metrics={'f1_val': 0.693581367416034, 'auprc': 0.9946407175457657, 'loss_val': 0.48729547736913137, 'psi': 0.8140051074679266}-{'f1_val': 0.5427752471522085, 'auprc': 0.9839476961537981, 'loss_val': 0.6846635220163924, 'psi': 0.7192442267528443}
[S11] START round=6 head_norm_before_train=0.792164 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.019414 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6310770437408393, 'loss_val': 1.161640968670097, 'psi': 0.33667902752020207}-{'f1_val': 0.14041368337311058, 'auprc': 0.6402888886710294, 'loss_val': 1.2281054553588817, 'psi': 0.3403637654922781}
[S13] START round=6 head_norm_before_train=1.119044 cos_to_last_merge=0.9657 (last merge round=2)
[S13] round=6 local utility u=1.000000 metrics={'f1_val': 0.7112783953684321, 'auprc': 0.7394889443866968, 'loss_val': 0.6153666582841985, 'psi': 0.722562614975738}-{'f1_val': 0.35976402523913004, 'auprc': 0.6129743427671064, 'loss_val': 0.8835335852568774, 'psi': 0.4610481522503206}
[S14] START round=6 head_norm_before_train=0.633089 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.162233 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.44461419594285995, 'loss_val': 1.2945884809033905, 'psi': 0.26206039010676624}-{'f1_val': 0.14035785288270378, 'auprc': 0.3409652874836715, 'loss_val': 1.3081067783362448, 'psi': 0.2206008267230909}
[S15] START round=6 head_norm_before_train=1.425440 (no previous merge yet)
[S15] round=6 local utility u=0.024145 metrics={'f1_val': 0.7014307742615252, 'auprc': 0.7905635538117978, 'loss_val': 0.5541393194272887, 'psi': 0.7370838860816342}-{'f1_val': 0.6968860718070718, 'auprc': 0.7996572033192455, 'loss_val': 0.6024428915823665, 'psi': 0.7379945244119414}
[S16] START round=6 head_norm_before_train=1.194458 (no previous merge yet)
[S16] round=6 local utility u=0.421614 metrics={'f1_val': 0.2813183300792908, 'auprc': 0.5602967273047639, 'loss_val': 1.1030795911717313, 'psi': 0.39290968896948003}-{'f1_val': 0.14063745019920318, 'auprc': 0.586919968408815, 'loss_val': 1.1820911169666093, 'psi': 0.31915045748304793}
[S17] START round=6 head_norm_before_train=1.440215 (no previous merge yet)
[S17] round=6 local utility u=0.065842 metrics={'f1_val': 0.3510987970457221, 'auprc': 0.7345148558487422, 'loss_val': 0.9499915450911707, 'psi': 0.5044652205669302}-{'f1_val': 0.34900811318887903, 'auprc': 0.6997608984075105, 'loss_val': 0.9648687161171903, 'psi': 0.48930922727633164}
[S14] not sending this round → trigger blocked (psi=0.262)
[S11] not sending this round → trigger blocked (psi=0.337)
[S8] not sending this round → trigger blocked (psi=0.826)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:40413
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:40409
[S3] not sending this round → trigger blocked (psi=0.592)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:40409
[S6] not sending this round → trigger blocked (psi=0.568)
[S10] not sending this round → trigger blocked (psi=0.814)
[S15] not sending this round → trigger blocked (psi=0.737)
[S7] not sending this round → trigger blocked (psi=0.396)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[S9] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S2
[S8] cosine check vs S2: cos=-0.0681
[S8] DROPPED delta from S2 (cos=-0.0681 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S16
[S8] cosine check vs S16: cos=-0.0639
[S8] DROPPED delta from S16 (cos=-0.0639 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.1627
[S16] RECEIVED delta(kind=head bytes=1793) from S13
[S16] cosine check vs S13: cos=-0.1005
[S16] DROPPED delta from S13 (cos=-0.1005 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.2983
[S17] not sending this round → trigger blocked (psi=0.504)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.7113 head_norm=1.181694
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.422464e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.7119 head_norm=0.743652 delta_norm=0.642246
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.1414 head_norm=0.731161
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.343962e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.713942 delta_norm=0.534396
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.536106 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.7063594870765125, 'auprc': 0.7517345375067122, 'loss_val': 0.5225433465646441, 'psi': 0.7245095072485923}-{'f1_val': 0.7023146275646055, 'auprc': 0.777789922640939, 'loss_val': 0.4762489150592616, 'psi': 0.7325047455951389}
[S3] START round=7 head_norm_before_train=1.345407 (no previous merge yet)
[S3] round=7 local utility u=0.272543 metrics={'f1_val': 0.39635856801559805, 'auprc': 0.9976939794525711, 'loss_val': 0.8055042111931369, 'psi': 0.6368927325903873}-{'f1_val': 0.39642092198300777, 'auprc': 0.8862402253610405, 'loss_val': 1.0166021344436427, 'psi': 0.5923486433342209}
[S4] START round=7 head_norm_before_train=1.584001 (no previous merge yet)
[S4] round=7 local utility u=0.196161 metrics={'f1_val': 0.6635511346044883, 'auprc': 0.805390176235138, 'loss_val': 0.4535568838191309, 'psi': 0.7202867512567481}-{'f1_val': 0.6675769593172892, 'auprc': 0.6595075030144826, 'loss_val': 0.43238592090159045, 'psi': 0.6643491767961666}
[S5] START round=7 head_norm_before_train=1.027613 cos_to_last_merge=0.9834 (last merge round=2)
[S5] round=7 local utility u=0.074870 metrics={'f1_val': 0.4192835091012374, 'auprc': 0.777783453538969, 'loss_val': 1.0043555055745053, 'psi': 0.5626834868763301}-{'f1_val': 0.41706350156788563, 'auprc': 0.7722674356389072, 'loss_val': 1.124227676258944, 'psi': 0.5591450751962943}
[S6] START round=7 head_norm_before_train=1.116313 cos_to_last_merge=0.9287 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.929
[S6] round=7 local utility u=0.948251 metrics={'f1_val': 0.695815835701155, 'auprc': 0.8000416354900122, 'loss_val': 0.4820662948361911, 'psi': 0.737506155616698}-{'f1_val': 0.41596878668975623, 'auprc': 0.7950720678283828, 'loss_val': 0.684576957504965, 'psi': 0.5676100991452069}
[S7] START round=7 head_norm_before_train=1.306513 (no previous merge yet)
[S7] round=7 local utility u=0.868608 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.7771167998574657, 'loss_val': 1.0517599019807213, 'psi': 0.5609715596757618}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775582282314976, 'loss_val': 1.1413917839996324, 'psi': 0.396257384930054}
[S8] START round=7 head_norm_before_train=1.575418 (no previous merge yet)
[S8] round=7 local utility u=0.109292 metrics={'f1_val': 0.7151442486458968, 'auprc': 0.9961316522351734, 'loss_val': 0.2019493456758412, 'psi': 0.8275392100816075}-{'f1_val': 0.7138874667974482, 'auprc': 0.99349665081149, 'loss_val': 0.40508854798339033, 'psi': 0.825731140403065}
[S9] START round=7 head_norm_before_train=0.713942 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.860711 metrics={'f1_val': 0.4161686489244779, 'auprc': 0.8002876886677082, 'loss_val': 1.041366110840664, 'psi': 0.5698162648217701}-{'f1_val': 0.141397957139996, 'auprc': 0.8022519782127652, 'loss_val': 1.120056010585167, 'psi': 0.4057395655691037}
[S10] START round=7 head_norm_before_train=1.159907 cos_to_last_merge=0.9121 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.912
[S10] round=7 local utility u=0.069785 metrics={'f1_val': 0.6928411858421755, 'auprc': 0.9979590340171605, 'loss_val': 0.3532394778234279, 'psi': 0.8148883251121695}-{'f1_val': 0.693581367416034, 'auprc': 0.9946407175457657, 'loss_val': 0.48729547736913137, 'psi': 0.8140051074679266}
[S11] START round=7 head_norm_before_train=0.820174 cos_to_last_merge=0.9944 (last merge round=5)
[S11] round=7 local utility u=1.000000 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.7741942411863036, 'loss_val': 0.9997801830922689, 'psi': 0.547588829120021}-{'f1_val': 0.14041368337311058, 'auprc': 0.6310770437408393, 'loss_val': 1.161640968670097, 'psi': 0.33667902752020207}
[S13] START round=7 head_norm_before_train=0.743652 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.347859812562037, 'auprc': 0.6073584184842055, 'loss_val': 0.8183814604501215, 'psi': 0.4516592549309044}-{'f1_val': 0.7112783953684321, 'auprc': 0.7394889443866968, 'loss_val': 0.6153666582841985, 'psi': 0.722562614975738}
[S14] START round=7 head_norm_before_train=0.662239 cos_to_last_merge=0.9962 (last merge round=5)
[S14] round=7 local utility u=0.550808 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7980847941129054, 'loss_val': 1.2533845363005645, 'psi': 0.40344862937478443}-{'f1_val': 0.14035785288270378, 'auprc': 0.44461419594285995, 'loss_val': 1.2945884809033905, 'psi': 0.26206039010676624}
[S15] START round=7 head_norm_before_train=1.507920 (no previous merge yet)
[S15] round=7 local utility u=0.264736 metrics={'f1_val': 0.6994223183055246, 'auprc': 0.9084984649896288, 'loss_val': 0.3664217593374496, 'psi': 0.7830527769791662}-{'f1_val': 0.7014307742615252, 'auprc': 0.7905635538117978, 'loss_val': 0.5541393194272887, 'psi': 0.7370838860816342}
[S16] START round=7 head_norm_before_train=1.216263 (no previous merge yet)
[S16] round=7 local utility u=0.416479 metrics={'f1_val': 0.41722699281147574, 'auprc': 0.5321264786665755, 'loss_val': 1.0010632153366392, 'psi': 0.46318678715351563}-{'f1_val': 0.2813183300792908, 'auprc': 0.5602967273047639, 'loss_val': 1.1030795911717313, 'psi': 0.39290968896948003}
[S17] START round=7 head_norm_before_train=1.473634 (no previous merge yet)
[S17] round=7 local utility u=0.048262 metrics={'f1_val': 0.3518424223898232, 'auprc': 0.7589134823112659, 'loss_val': 0.9311249883020848, 'psi': 0.5146708463584002}-{'f1_val': 0.3510987970457221, 'auprc': 0.7345148558487422, 'loss_val': 0.9499915450911707, 'psi': 0.5044652205669302}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:40414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:40404
[S5] not sending this round → trigger blocked (psi=0.563)
[S9] not sending this round → trigger blocked (psi=0.570)
[S16] not sending this round → trigger blocked (psi=0.463)
[S3] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1792) from S7
[S10] cosine check vs S7: cos=-0.0526
[S10] DROPPED delta from S7 (cos=-0.0526 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S6
[S11] cosine check vs S6: cos=0.8833
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] cosine check vs S15: cos=-0.0287
[S16] DROPPED delta from S15 (cos=-0.0287 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1793) from S11
[S14] cosine check vs S11: cos=0.3874
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] cosine check vs S4: cos=0.2831
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.7588
[S4] RECEIVED delta(kind=head bytes=1805) from S3
[S4] cosine check vs S3: cos=-0.0296
[S4] DROPPED delta from S3 (cos=-0.0296 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S14
[S4] cosine check vs S14: cos=-0.0330
[S4] DROPPED delta from S14 (cos=-0.0330 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=-0.1046
[S17] DROPPED delta from S8 (cos=-0.1046 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] cosine check vs S17: cos=0.2969
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.4162 head_norm=0.740352
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.134513e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.4167 head_norm=0.773237 delta_norm=0.513451
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3965 head_norm=0.859112
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.954162e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3965 head_norm=0.995589 delta_norm=0.295416
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=0.687438
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.118199e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.692067 delta_norm=0.211820
[S14] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.597978 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.7138240482257876, 'auprc': 0.7791188219311177, 'loss_val': 0.763715479318771, 'psi': 0.7399419577079196}-{'f1_val': 0.7063594870765125, 'auprc': 0.7517345375067122, 'loss_val': 0.5225433465646441, 'psi': 0.7245095072485923}
[S3] START round=8 head_norm_before_train=1.390531 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.3936341158042015, 'auprc': 0.8706628081943363, 'loss_val': 0.7718563504984027, 'psi': 0.5844455927602554}-{'f1_val': 0.39635856801559805, 'auprc': 0.9976939794525711, 'loss_val': 0.8055042111931369, 'psi': 0.6368927325903873}
[S4] START round=8 head_norm_before_train=1.625200 (no previous merge yet)
[S4] round=8 local utility u=0.028066 metrics={'f1_val': 0.6680499001643067, 'auprc': 0.8171118356924425, 'loss_val': 0.4595823285124718, 'psi': 0.727674674375561}-{'f1_val': 0.6635511346044883, 'auprc': 0.805390176235138, 'loss_val': 0.4535568838191309, 'psi': 0.7202867512567481}
[S5] START round=8 head_norm_before_train=1.057107 cos_to_last_merge=0.9764 (last merge round=2)
[S5] round=8 local utility u=0.875290 metrics={'f1_val': 0.6853154685823075, 'auprc': 0.7778213979236616, 'loss_val': 0.8500805640024522, 'psi': 0.7223178403188492}-{'f1_val': 0.4192835091012374, 'auprc': 0.777783453538969, 'loss_val': 1.0043555055745053, 'psi': 0.5626834868763301}
[S6] START round=8 head_norm_before_train=1.191161 cos_to_last_merge=0.9066 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.907
[S6] round=8 local utility u=0.291418 metrics={'f1_val': 0.6960695868414678, 'auprc': 0.9630085195494027, 'loss_val': 0.38965287072134425, 'psi': 0.8028451599246418}-{'f1_val': 0.695815835701155, 'auprc': 0.8000416354900122, 'loss_val': 0.4820662948361911, 'psi': 0.737506155616698}
[S7] START round=8 head_norm_before_train=1.332885 (no previous merge yet)
[S7] round=8 local utility u=0.056872 metrics={'f1_val': 0.4172807768329403, 'auprc': 0.7770792783343158, 'loss_val': 0.9403392104599244, 'psi': 0.5612001774334905}-{'f1_val': 0.4168747328879592, 'auprc': 0.7771167998574657, 'loss_val': 1.0517599019807213, 'psi': 0.5609715596757618}
[S8] START round=8 head_norm_before_train=1.630626 (no previous merge yet)
[S8] round=8 local utility u=0.848118 metrics={'f1_val': 0.9883779675297719, 'auprc': 0.999074680769073, 'loss_val': 0.15394503981981164, 'psi': 0.9926566528254924}-{'f1_val': 0.7151442486458968, 'auprc': 0.9961316522351734, 'loss_val': 0.2019493456758412, 'psi': 0.8275392100816075}
[S9] START round=8 head_norm_before_train=0.773237 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.3828898418181478, 'auprc': 0.8031491165043418, 'loss_val': 0.9018231848245157, 'psi': 0.5509935516926254}-{'f1_val': 0.4161686489244779, 'auprc': 0.8002876886677082, 'loss_val': 1.041366110840664, 'psi': 0.5698162648217701}
[S10] START round=8 head_norm_before_train=1.225701 cos_to_last_merge=0.8914 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.891
[S10] round=8 local utility u=0.835588 metrics={'f1_val': 0.9583427800243607, 'auprc': 0.9974903036303451, 'loss_val': 0.273666499525702, 'psi': 0.9740017894667544}-{'f1_val': 0.6928411858421755, 'auprc': 0.9979590340171605, 'loss_val': 0.3532394778234279, 'psi': 0.8148883251121695}
[S11] START round=8 head_norm_before_train=0.995589 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.011628 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.7371016047875935, 'loss_val': 0.865449325121665, 'psi': 0.5327719834707612}-{'f1_val': 0.39651855440916606, 'auprc': 0.7741942411863036, 'loss_val': 0.9997801830922689, 'psi': 0.547588829120021}
[S13] START round=8 head_norm_before_train=0.822747 cos_to_last_merge=0.9923 (last merge round=6)
[S13] round=8 local utility u=1.000000 metrics={'f1_val': 0.6897237774437767, 'auprc': 0.6935821067531832, 'loss_val': 0.531410517336229, 'psi': 0.6912671091675393}-{'f1_val': 0.347859812562037, 'auprc': 0.6073584184842055, 'loss_val': 0.8183814604501215, 'psi': 0.4516592549309044}
[S14] START round=8 head_norm_before_train=0.692067 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7779522391346685, 'loss_val': 1.2024144314759138, 'psi': 0.39539560738348967}-{'f1_val': 0.14035785288270378, 'auprc': 0.7980847941129054, 'loss_val': 1.2533845363005645, 'psi': 0.40344862937478443}
[S15] START round=8 head_norm_before_train=1.567078 (no previous merge yet)
[S15] round=8 local utility u=0.163095 metrics={'f1_val': 0.6940817123051478, 'auprc': 0.9890493274958141, 'loss_val': 0.24984053047858454, 'psi': 0.8120687583814143}-{'f1_val': 0.6994223183055246, 'auprc': 0.9084984649896288, 'loss_val': 0.3664217593374496, 'psi': 0.7830527769791662}
[S16] START round=8 head_norm_before_train=1.247282 (no previous merge yet)
[S16] round=8 local utility u=0.230075 metrics={'f1_val': 0.3919071831225701, 'auprc': 0.7128412641625802, 'loss_val': 0.9311380940048866, 'psi': 0.5202808155385741}-{'f1_val': 0.41722699281147574, 'auprc': 0.5321264786665755, 'loss_val': 1.0010632153366392, 'psi': 0.46318678715351563}
[S17] START round=8 head_norm_before_train=1.491819 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.35116797507751263, 'auprc': 0.7566506195629612, 'loss_val': 0.9606308736455059, 'psi': 0.5133610328716921}-{'f1_val': 0.3518424223898232, 'auprc': 0.7589134823112659, 'loss_val': 0.9311249883020848, 'psi': 0.5146708463584002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:40416
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[S4] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1790) from S6
[S11] cosine check vs S6: cos=0.9569
[S16] RECEIVED delta(kind=head bytes=1795) from S13
[S16] cosine check vs S13: cos=-0.0768
[S16] DROPPED delta from S13 (cos=-0.0768 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] cosine check vs S15: cos=-0.0273
[S16] DROPPED delta from S15 (cos=-0.0273 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=-0.1048
[S17] DROPPED delta from S8 (cos=-0.1048 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S7
[S10] cosine check vs S7: cos=-0.0563
[S10] DROPPED delta from S7 (cos=-0.0563 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.4710
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.8047
[S9] RECEIVED delta(kind=head bytes=1798) from S4
[S9] cosine check vs S4: cos=0.6295
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.3600
[S8] RECEIVED delta(kind=head bytes=1794) from S16
[S8] cosine check vs S16: cos=-0.0497
[S8] DROPPED delta from S16 (cos=-0.0497 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.1404 head_norm=0.721235
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.743659e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.1404 head_norm=0.762857 delta_norm=0.174366
[S14] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.3829 head_norm=0.810218
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.297612e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.3838 head_norm=0.831896 delta_norm=0.329761
[S9] aggregate: ACCEPT kept=['S4', 'S5'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3966 head_norm=1.033135
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.013748e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.5242 head_norm=1.132982 delta_norm=0.201375
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.642174 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.702717211567939, 'auprc': 0.7144740505875866, 'loss_val': 0.5166924331347347, 'psi': 0.707419947175798}-{'f1_val': 0.7138240482257876, 'auprc': 0.7791188219311177, 'loss_val': 0.763715479318771, 'psi': 0.7399419577079196}
[S3] START round=9 head_norm_before_train=1.434861 (no previous merge yet)
[S3] round=9 local utility u=0.525666 metrics={'f1_val': 0.5476879660736104, 'auprc': 0.894506200228588, 'loss_val': 0.7163770491710018, 'psi': 0.6864152597356015}-{'f1_val': 0.3936341158042015, 'auprc': 0.8706628081943363, 'loss_val': 0.7718563504984027, 'psi': 0.5844455927602554}
[S4] START round=9 head_norm_before_train=1.661559 (no previous merge yet)
[S4] round=9 local utility u=1.000000 metrics={'f1_val': 0.9462627974885284, 'auprc': 0.9520051683708062, 'loss_val': 0.4792116989720015, 'psi': 0.9485597458414394}-{'f1_val': 0.6680499001643067, 'auprc': 0.8171118356924425, 'loss_val': 0.4595823285124718, 'psi': 0.727674674375561}
[S5] START round=9 head_norm_before_train=1.094445 cos_to_last_merge=0.9658 (last merge round=2)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.5184524267090516, 'auprc': 0.7950846878907512, 'loss_val': 0.7143699716014031, 'psi': 0.6291053311817314}-{'f1_val': 0.6853154685823075, 'auprc': 0.7778213979236616, 'loss_val': 0.8500805640024522, 'psi': 0.7223178403188492}
[S6] START round=9 head_norm_before_train=1.257392 cos_to_last_merge=0.8889 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.889
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.6624271234319874, 'auprc': 0.9492466425062954, 'loss_val': 0.43305957557460495, 'psi': 0.7771549310617106}-{'f1_val': 0.6960695868414678, 'auprc': 0.9630085195494027, 'loss_val': 0.38965287072134425, 'psi': 0.8028451599246418}
[S7] START round=9 head_norm_before_train=1.366491 (no previous merge yet)
[S7] round=9 local utility u=0.049572 metrics={'f1_val': 0.41711588266717814, 'auprc': 0.7768450673507975, 'loss_val': 0.8395039266689232, 'psi': 0.5610075565406258}-{'f1_val': 0.4172807768329403, 'auprc': 0.7770792783343158, 'loss_val': 0.9403392104599244, 'psi': 0.5612001774334905}
[S8] START round=9 head_norm_before_train=1.670429 (no previous merge yet)
[S8] round=9 local utility u=0.038720 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9989174961125169, 'loss_val': 0.12560426608378011, 'psi': 0.9975509230336664}-{'f1_val': 0.9883779675297719, 'auprc': 0.999074680769073, 'loss_val': 0.15394503981981164, 'psi': 0.9926566528254924}
[S9] START round=9 head_norm_before_train=0.831896 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.999081 metrics={'f1_val': 0.5993812416038389, 'auprc': 0.9994628288248708, 'loss_val': 0.7915509633858004, 'psi': 0.7594138764922516}-{'f1_val': 0.3828898418181478, 'auprc': 0.8031491165043418, 'loss_val': 0.9018231848245157, 'psi': 0.5509935516926254}
[S10] START round=9 head_norm_before_train=1.295913 cos_to_last_merge=0.8726 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.873
[S10] round=9 local utility u=0.142402 metrics={'f1_val': 0.9956867236463709, 'auprc': 0.9970149489599909, 'loss_val': 0.21149977366539274, 'psi': 0.9962180137718188}-{'f1_val': 0.9583427800243607, 'auprc': 0.9974903036303451, 'loss_val': 0.273666499525702, 'psi': 0.9740017894667544}
[S11] START round=9 head_norm_before_train=1.132982 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.598319 metrics={'f1_val': 0.5727925984016203, 'auprc': 0.736202423013129, 'loss_val': 0.723555439222533, 'psi': 0.6381565282462238}-{'f1_val': 0.39655223592620625, 'auprc': 0.7371016047875935, 'loss_val': 0.865449325121665, 'psi': 0.5327719834707612}
[S13] START round=9 head_norm_before_train=0.911907 cos_to_last_merge=0.9798 (last merge round=6)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.354040050234743, 'auprc': 0.5614612562733059, 'loss_val': 0.8625033892006408, 'psi': 0.43700853265016815}-{'f1_val': 0.6897237774437767, 'auprc': 0.6935821067531832, 'loss_val': 0.531410517336229, 'psi': 0.6912671091675393}
[S14] START round=9 head_norm_before_train=0.762857 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.971702 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.8830791804016036, 'loss_val': 1.1112124705540012, 'psi': 0.5911284979301561}-{'f1_val': 0.14035785288270378, 'auprc': 0.7779522391346685, 'loss_val': 1.2024144314759138, 'psi': 0.39539560738348967}
[S15] START round=9 head_norm_before_train=1.623974 (no previous merge yet)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.6977544351660564, 'auprc': 0.9800843533659789, 'loss_val': 0.29846186503183986, 'psi': 0.8106864024460254}-{'f1_val': 0.6940817123051478, 'auprc': 0.9890493274958141, 'loss_val': 0.24984053047858454, 'psi': 0.8120687583814143}
[S16] START round=9 head_norm_before_train=1.281170 (no previous merge yet)
[S16] round=9 local utility u=0.072804 metrics={'f1_val': 0.3932214626728032, 'auprc': 0.7395916510479988, 'loss_val': 0.873667213831406, 'psi': 0.5317695380228815}-{'f1_val': 0.3919071831225701, 'auprc': 0.7128412641625802, 'loss_val': 0.9311380940048866, 'psi': 0.5202808155385741}
[S17] START round=9 head_norm_before_train=1.516996 (no previous merge yet)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.1734115685531148, 'auprc': 0.6429675868526686, 'loss_val': 1.6828273436984769, 'psi': 0.3612339758729363}-{'f1_val': 0.35116797507751263, 'auprc': 0.7566506195629612, 'loss_val': 0.9606308736455059, 'psi': 0.5133610328716921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:40414
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:40409
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:40417
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S14
[S4] cosine check vs S14: cos=0.0217
[S8] RECEIVED delta(kind=head bytes=1797) from S16
[S8] cosine check vs S16: cos=-0.0457
[S8] DROPPED delta from S16 (cos=-0.0457 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1790) from S9
[S13] cosine check vs S9: cos=0.5697
[S10] RECEIVED delta(kind=head bytes=1795) from S7
[S10] cosine check vs S7: cos=-0.0581
[S10] DROPPED delta from S7 (cos=-0.0581 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=-0.1028
[S17] DROPPED delta from S8 (cos=-0.1028 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.5466
[S4] RECEIVED delta(kind=head bytes=1801) from S3
[S4] cosine check vs S3: cos=-0.0328
[S4] DROPPED delta from S3 (cos=-0.0328 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1806) from S4
[S9] cosine check vs S4: cos=0.7715
[S14] RECEIVED delta(kind=head bytes=1805) from S10
[S14] cosine check vs S10: cos=0.7995
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.3540 head_norm=0.966758
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.282352e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.3623 head_norm=0.814158 delta_norm=0.428235
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.9463 head_norm=1.697348
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.295968e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6130 head_norm=0.945241 delta_norm=0.929597
[S4] aggregate: ROLLBACK (f1_val pre=0.946 post=0.613 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.5994 head_norm=0.870550
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.828694e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7012 head_norm=1.216424 delta_norm=0.582869
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3965 head_norm=0.796411
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.441055e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3965 head_norm=0.841557 delta_norm=0.144105
[S14] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.678339 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.7135523962863866, 'auprc': 0.7749889512704369, 'loss_val': 0.796677037634634, 'psi': 0.7381270182800067}-{'f1_val': 0.702717211567939, 'auprc': 0.7144740505875866, 'loss_val': 0.5166924331347347, 'psi': 0.707419947175798}
[S3] START round=10 head_norm_before_train=1.475774 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.5271632450691548, 'auprc': 0.7996670386507005, 'loss_val': 0.7421677221803784, 'psi': 0.6361647625017731}-{'f1_val': 0.5476879660736104, 'auprc': 0.894506200228588, 'loss_val': 0.7163770491710018, 'psi': 0.6864152597356015}
[S4] START round=10 head_norm_before_train=0.945241 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.6140026781723867, 'auprc': 0.9493924708703817, 'loss_val': 0.5252405870672132, 'psi': 0.7481585952515848}-{'f1_val': 0.9462627974885284, 'auprc': 0.9520051683708062, 'loss_val': 0.4792116989720015, 'psi': 0.9485597458414394}
[S5] START round=10 head_norm_before_train=1.135885 cos_to_last_merge=0.9525 (last merge round=2)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.4621723158644747, 'auprc': 0.8632357425082074, 'loss_val': 0.639253847575593, 'psi': 0.6225976865219678}-{'f1_val': 0.5184524267090516, 'auprc': 0.7950846878907512, 'loss_val': 0.7143699716014031, 'psi': 0.6291053311817314}
[S6] START round=10 head_norm_before_train=1.304413 cos_to_last_merge=0.8783 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.878
[S6] round=10 local utility u=0.145907 metrics={'f1_val': 0.695085529406045, 'auprc': 0.9568030273140042, 'loss_val': 0.35986435415120976, 'psi': 0.7997725285692288}-{'f1_val': 0.6624271234319874, 'auprc': 0.9492466425062954, 'loss_val': 0.43305957557460495, 'psi': 0.7771549310617106}
[S7] START round=10 head_norm_before_train=1.397057 (no previous merge yet)
[S7] round=10 local utility u=0.938509 metrics={'f1_val': 0.7142988289087885, 'auprc': 0.7929030379724149, 'loss_val': 0.7937582511106702, 'psi': 0.7457405125342391}-{'f1_val': 0.41711588266717814, 'auprc': 0.7768450673507975, 'loss_val': 0.8395039266689232, 'psi': 0.5610075565406258}
[S8] START round=10 head_norm_before_train=1.702510 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.9300001486340018, 'auprc': 0.9988612272486166, 'loss_val': 0.1290882736117333, 'psi': 0.9575445800798478}-{'f1_val': 0.9966398743144329, 'auprc': 0.9989174961125169, 'loss_val': 0.12560426608378011, 'psi': 0.9975509230336664}
[S9] START round=10 head_norm_before_train=1.216424 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.398687 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9994325533492077, 'loss_val': 0.6059863480801558, 'psi': 0.8205918219711885}-{'f1_val': 0.5993812416038389, 'auprc': 0.9994628288248708, 'loss_val': 0.7915509633858004, 'psi': 0.7594138764922516}
[S10] START round=10 head_norm_before_train=1.356654 cos_to_last_merge=0.8594 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.859
[S10] round=10 local utility u=0.014481 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9958962309123531, 'loss_val': 0.1768988382746441, 'psi': 0.9955422909319861}-{'f1_val': 0.9956867236463709, 'auprc': 0.9970149489599909, 'loss_val': 0.21149977366539274, 'psi': 0.9962180137718188}
[S11] START round=10 head_norm_before_train=1.173996 cos_to_last_merge=0.9963 (last merge round=8)
[S11] round=10 local utility u=0.717201 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.8991098254081131, 'loss_val': 0.553519677479153, 'psi': 0.7808838282302093}-{'f1_val': 0.5727925984016203, 'auprc': 0.736202423013129, 'loss_val': 0.723555439222533, 'psi': 0.6381565282462238}
[S13] START round=10 head_norm_before_train=0.814158 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=1.000000 metrics={'f1_val': 0.6062615028145437, 'auprc': 0.689829657283952, 'loss_val': 0.6730990077213318, 'psi': 0.6396887646023071}-{'f1_val': 0.354040050234743, 'auprc': 0.5614612562733059, 'loss_val': 0.8625033892006408, 'psi': 0.43700853265016815}
[S14] START round=10 head_norm_before_train=0.841557 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.222496 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.9647388125565474, 'loss_val': 0.9111993313249513, 'psi': 0.6237923507921337}-{'f1_val': 0.39649470961585787, 'auprc': 0.8830791804016036, 'loss_val': 1.1112124705540012, 'psi': 0.5911284979301561}
[S15] START round=10 head_norm_before_train=1.676407 (no previous merge yet)
[S15] round=10 local utility u=0.027007 metrics={'f1_val': 0.7012443706034642, 'auprc': 0.9845570434375707, 'loss_val': 0.27880643986423637, 'psi': 0.8145694397371068}-{'f1_val': 0.6977544351660564, 'auprc': 0.9800843533659789, 'loss_val': 0.29846186503183986, 'psi': 0.8106864024460254}
[S16] START round=10 head_norm_before_train=1.321272 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.368591862323606, 'auprc': 0.759746865231943, 'loss_val': 0.8294282109367604, 'psi': 0.5250538634869408}-{'f1_val': 0.3932214626728032, 'auprc': 0.7395916510479988, 'loss_val': 0.873667213831406, 'psi': 0.5317695380228815}
[S17] START round=10 head_norm_before_train=1.532023 (no previous merge yet)
[S17] round=10 local utility u=1.000000 metrics={'f1_val': 0.3444875948901702, 'auprc': 0.7980020771892553, 'loss_val': 1.0322292686165815, 'psi': 0.5258933878098043}-{'f1_val': 0.1734115685531148, 'auprc': 0.6429675868526686, 'loss_val': 1.6828273436984769, 'psi': 0.3612339758729363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:40412
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:40413
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:40411
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:40416
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:40414
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S15
[S16] cosine check vs S15: cos=-0.0241
[S16] DROPPED delta from S15 (cos=-0.0241 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1792) from S9
[S13] cosine check vs S9: cos=0.6888
[S11] RECEIVED delta(kind=head bytes=1793) from S6
[S11] cosine check vs S6: cos=0.9620
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.7808
[S14] RECEIVED delta(kind=head bytes=1788) from S11
[S14] cosine check vs S11: cos=0.6001
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=-0.0596
[S10] DROPPED delta from S7 (cos=-0.0596 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S14
[S4] cosine check vs S14: cos=0.4183
[S16] RECEIVED delta(kind=head bytes=1791) from S13
[S16] cosine check vs S13: cos=-0.0418
[S16] DROPPED delta from S13 (cos=-0.0418 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S17
[S9] cosine check vs S17: cos=0.0804
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6140 head_norm=1.022974
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.177841e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6128 head_norm=0.804238 delta_norm=0.517784
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.341 → S9@127.0.0.1:40410
[S5] ⇄ pheromone p=0.305 → S9@127.0.0.1:40410
[S8] ⇄ pheromone p=0.352 → S17@127.0.0.1:40417
[S3] ⇄ pheromone p=0.305 → S4@127.0.0.1:40404
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.3965 head_norm=0.885056
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.056077e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.3965 head_norm=0.907654 delta_norm=0.105608
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.405 → S4@127.0.0.1:40404
[S6] ⇄ pheromone p=0.351 → S11@127.0.0.1:40412
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.7021 head_norm=1.224756
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.847532e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.7023 head_norm=1.268002 delta_norm=0.184753
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.473 → S14@127.0.0.1:40414
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7014 head_norm=1.251209
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.526885e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.4377 head_norm=1.030833 delta_norm=0.952689
[S9] aggregate: ROLLBACK (f1_val pre=0.701 post=0.438 tol_abs=0.005 tol_rel=0.0)
[S9] ⇄ pheromone p=0.446 → S13@127.0.0.1:40413
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.6063 head_norm=0.861787
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.535075e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.6117 head_norm=0.973875 delta_norm=0.453507
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.555 → S16@127.0.0.1:40416
[S10] ⇄ pheromone p=0.409 → S14@127.0.0.1:40414
[S7] ⇄ pheromone p=0.407 → S10@127.0.0.1:40411
[S2] ⇄ pheromone p=0.214 → S8@127.0.0.1:40409
[S17] ⇄ pheromone p=0.380 → S9@127.0.0.1:40410
[S15] ⇄ pheromone p=0.258 → S16@127.0.0.1:40416
[S16] ⇄ pheromone p=0.247 → S8@127.0.0.1:40409
[S2] START round=11 head_norm_before_train=1.709007 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.7125939614950004, 'auprc': 0.7655648210345529, 'loss_val': 0.7739248509194465, 'psi': 0.7337823053108214}-{'f1_val': 0.7135523962863866, 'auprc': 0.7749889512704369, 'loss_val': 0.796677037634634, 'psi': 0.7381270182800067}
[S3] START round=11 head_norm_before_train=1.516809 (no previous merge yet)
[S3] round=11 local utility u=0.233697 metrics={'f1_val': 0.5534302139826681, 'auprc': 0.8653462701987025, 'loss_val': 0.6294140674299437, 'psi': 0.6781966364690819}-{'f1_val': 0.5271632450691548, 'auprc': 0.7996670386507005, 'loss_val': 0.7421677221803784, 'psi': 0.6361647625017731}
[S4] START round=11 head_norm_before_train=0.804238 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.6132222905503737, 'auprc': 0.9391117960867998, 'loss_val': 0.575575492195478, 'psi': 0.7435780927649442}-{'f1_val': 0.6140026781723867, 'auprc': 0.9493924708703817, 'loss_val': 0.5252405870672132, 'psi': 0.7481585952515848}
[S5] START round=11 head_norm_before_train=1.171416 cos_to_last_merge=0.9384 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.938
[S5] round=11 local utility u=0.680625 metrics={'f1_val': 0.714986591715879, 'auprc': 0.7956042991093574, 'loss_val': 0.5919953300365709, 'psi': 0.7472336746732704}-{'f1_val': 0.4621723158644747, 'auprc': 0.8632357425082074, 'loss_val': 0.639253847575593, 'psi': 0.6225976865219678}
[S6] START round=11 head_norm_before_train=1.335626 cos_to_last_merge=0.8721 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.872
[S6] round=11 local utility u=0.002266 metrics={'f1_val': 0.6947135014062139, 'auprc': 0.956819339924936, 'loss_val': 0.35314913973122797, 'psi': 0.7995558368137028}-{'f1_val': 0.695085529406045, 'auprc': 0.9568030273140042, 'loss_val': 0.35986435415120976, 'psi': 0.7997725285692288}
[S7] START round=11 head_norm_before_train=1.428150 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.6636873212212093, 'auprc': 0.7910433523425757, 'loss_val': 0.7798988634864511, 'psi': 0.7146297336697559}-{'f1_val': 0.7142988289087885, 'auprc': 0.7929030379724149, 'loss_val': 0.7937582511106702, 'psi': 0.7457405125342391}
[S8] START round=11 head_norm_before_train=1.754815 (no previous merge yet)
[S8] round=11 local utility u=0.227763 metrics={'f1_val': 0.994057704452729, 'auprc': 0.9989098074592005, 'loss_val': 0.05805279491799033, 'psi': 0.9959985456553176}-{'f1_val': 0.9300001486340018, 'auprc': 0.9988612272486166, 'loss_val': 0.1290882736117333, 'psi': 0.9575445800798478}
[S9] START round=11 head_norm_before_train=1.030833 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.027536 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.999366274442157, 'loss_val': 0.5498269700951026, 'psi': 0.8204764582408739}-{'f1_val': 0.7013646677191758, 'auprc': 0.9994325533492077, 'loss_val': 0.6059863480801558, 'psi': 0.8205918219711885}
[S10] START round=11 head_norm_before_train=1.410662 cos_to_last_merge=0.8497 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.850
[S10] round=11 local utility u=0.019971 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9957675492890816, 'loss_val': 0.13657041285424468, 'psi': 0.9954908182826775}-{'f1_val': 0.9953063309450747, 'auprc': 0.9958962309123531, 'loss_val': 0.1768988382746441, 'psi': 0.9955422909319861}
[S11] START round=11 head_norm_before_train=1.268002 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.8526853662855779, 'loss_val': 0.44446635335221285, 'psi': 0.7622353364932233}-{'f1_val': 0.7020664967782734, 'auprc': 0.8991098254081131, 'loss_val': 0.553519677479153, 'psi': 0.7808838282302093}
[S13] START round=11 head_norm_before_train=0.973875 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.019159 metrics={'f1_val': 0.6244370709799216, 'auprc': 0.6719330075959826, 'loss_val': 0.6901454468932042, 'psi': 0.643435445626346}-{'f1_val': 0.6062615028145437, 'auprc': 0.689829657283952, 'loss_val': 0.6730990077213318, 'psi': 0.6396887646023071}
[S14] START round=11 head_norm_before_train=0.907654 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.136340 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.998720335450154, 'loss_val': 0.7408582133927285, 'psi': 0.6374244555662566}-{'f1_val': 0.39649470961585787, 'auprc': 0.9647388125565474, 'loss_val': 0.9111993313249513, 'psi': 0.6237923507921337}
[S15] START round=11 head_norm_before_train=1.727004 (no previous merge yet)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.7004291702091903, 'auprc': 0.8332241455414793, 'loss_val': 0.37023738924955885, 'psi': 0.7535471603421059}-{'f1_val': 0.7012443706034642, 'auprc': 0.9845570434375707, 'loss_val': 0.27880643986423637, 'psi': 0.8145694397371068}
[S16] START round=11 head_norm_before_train=1.364492 (no previous merge yet)
[S16] round=11 local utility u=0.027633 metrics={'f1_val': 0.3813528187951646, 'auprc': 0.7432503861208517, 'loss_val': 0.8012376339088029, 'psi': 0.5261118457254395}-{'f1_val': 0.368591862323606, 'auprc': 0.759746865231943, 'loss_val': 0.8294282109367604, 'psi': 0.5250538634869408}
[S17] START round=11 head_norm_before_train=1.541084 (no previous merge yet)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.35273268957802617, 'auprc': 0.740299630040645, 'loss_val': 0.9305518049530157, 'psi': 0.5077594657630737}-{'f1_val': 0.3444875948901702, 'auprc': 0.7980020771892553, 'loss_val': 1.0322292686165815, 'psi': 0.5258933878098043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:40404
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:40409
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.1122
[S8] RECEIVED delta(kind=head bytes=1795) from S16
[S8] cosine check vs S16: cos=-0.0487
[S8] DROPPED delta from S16 (cos=-0.0487 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.6862
[S11] RECEIVED delta(kind=head bytes=1792) from S6
[S11] cosine check vs S6: cos=0.9832
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=-0.0230
[S16] DROPPED delta from S13 (cos=-0.0230 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S14
[S4] cosine check vs S14: cos=0.7192
[S14] RECEIVED delta(kind=head bytes=1806) from S10
[S14] cosine check vs S10: cos=0.7690
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=-0.0968
[S17] DROPPED delta from S8 (cos=-0.0968 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] cosine check vs S3: cos=-0.0649
[S4] DROPPED delta from S3 (cos=-0.0649 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6132 head_norm=0.916820
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.518076e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6116 head_norm=0.869183 delta_norm=0.351808
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7019 head_norm=1.308347
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.243756e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7019 head_norm=1.325957 delta_norm=0.124376
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7012 head_norm=1.073175
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.594358e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.6923 head_norm=0.849396 delta_norm=0.759436
[S9] aggregate: ROLLBACK (f1_val pre=0.701 post=0.692 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6244 head_norm=1.007477
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.131944e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6113 head_norm=0.955315 delta_norm=0.413194
[S13] aggregate: ROLLBACK (f1_val pre=0.624 post=0.611 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.3966 head_norm=0.958090
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.742615e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.3966 head_norm=1.140802 delta_norm=0.474261
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.727286 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7072214370001407, 'auprc': 0.7374072193247849, 'loss_val': 0.835121610140558, 'psi': 0.7192957499299983}-{'f1_val': 0.7125939614950004, 'auprc': 0.7655648210345529, 'loss_val': 0.7739248509194465, 'psi': 0.7337823053108214}
[S3] START round=12 head_norm_before_train=1.551139 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.5262714854735975, 'auprc': 0.826700710689815, 'loss_val': 0.6567859290527203, 'psi': 0.6464431755600845}-{'f1_val': 0.5534302139826681, 'auprc': 0.8653462701987025, 'loss_val': 0.6294140674299437, 'psi': 0.6781966364690819}
[S4] START round=12 head_norm_before_train=0.869183 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.6137793074841731, 'auprc': 0.8478942897753003, 'loss_val': 0.5641503535285822, 'psi': 0.707425300400624}-{'f1_val': 0.6132222905503737, 'auprc': 0.9391117960867998, 'loss_val': 0.575575492195478, 'psi': 0.7435780927649442}
[S5] START round=12 head_norm_before_train=1.201969 cos_to_last_merge=0.9272 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.927
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.7010639315836553, 'auprc': 0.7755821263884579, 'loss_val': 0.5317045879543781, 'psi': 0.7308712095055764}-{'f1_val': 0.714986591715879, 'auprc': 0.7956042991093574, 'loss_val': 0.5919953300365709, 'psi': 0.7472336746732704}
[S6] START round=12 head_norm_before_train=1.354804 cos_to_last_merge=0.8683 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.868
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.7072428994429236, 'auprc': 0.7814076677075619, 'loss_val': 0.5225863727783479, 'psi': 0.736908806748779}-{'f1_val': 0.6947135014062139, 'auprc': 0.956819339924936, 'loss_val': 0.35314913973122797, 'psi': 0.7995558368137028}
[S7] START round=12 head_norm_before_train=1.456473 (no previous merge yet)
[S7] round=12 local utility u=0.208953 metrics={'f1_val': 0.7142988289087885, 'auprc': 0.7853516656778761, 'loss_val': 0.6485860622463366, 'psi': 0.7427199636164235}-{'f1_val': 0.6636873212212093, 'auprc': 0.7910433523425757, 'loss_val': 0.7798988634864511, 'psi': 0.7146297336697559}
[S8] START round=12 head_norm_before_train=1.799916 (no previous merge yet)
[S8] round=12 local utility u=0.003803 metrics={'f1_val': 0.9942822943870275, 'auprc': 0.9984311965207514, 'loss_val': 0.050359440511238356, 'psi': 0.9959418552405171}-{'f1_val': 0.994057704452729, 'auprc': 0.9989098074592005, 'loss_val': 0.05805279491799033, 'psi': 0.9959985456553176}
[S9] START round=12 head_norm_before_train=0.849396 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.6086831317120466, 'auprc': 0.8653810376645812, 'loss_val': 0.6279822381490382, 'psi': 0.7113622940930604}-{'f1_val': 0.7012165807733519, 'auprc': 0.999366274442157, 'loss_val': 0.5498269700951026, 'psi': 0.8204764582408739}
[S10] START round=12 head_norm_before_train=1.461085 cos_to_last_merge=0.8418 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.842
[S10] round=12 local utility u=0.024742 metrics={'f1_val': 0.994378377236979, 'auprc': 0.9963568041020291, 'loss_val': 0.08328726704410291, 'psi': 0.9951697479829991}-{'f1_val': 0.9953063309450747, 'auprc': 0.9957675492890816, 'loss_val': 0.13657041285424468, 'psi': 0.9954908182826775}
[S11] START round=12 head_norm_before_train=1.325957 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.090399 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.8949554595002168, 'loss_val': 0.38902778280556577, 'psi': 0.7789982715522417}-{'f1_val': 0.7019353166316534, 'auprc': 0.8526853662855779, 'loss_val': 0.44446635335221285, 'psi': 0.7622353364932233}
[S13] START round=12 head_norm_before_train=0.955315 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6151911759308066, 'auprc': 0.6561673242241395, 'loss_val': 0.7288895616791056, 'psi': 0.6315816352481398}-{'f1_val': 0.6244370709799216, 'auprc': 0.6719330075959826, 'loss_val': 0.6901454468932042, 'psi': 0.643435445626346}
[S14] START round=12 head_norm_before_train=1.140802 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.996704 metrics={'f1_val': 0.7018850250037899, 'auprc': 0.9956615121579175, 'loss_val': 0.5702215157247436, 'psi': 0.8193956198654411}-{'f1_val': 0.39656053564365834, 'auprc': 0.998720335450154, 'loss_val': 0.7408582133927285, 'psi': 0.6374244555662566}
[S15] START round=12 head_norm_before_train=1.772648 (no previous merge yet)
[S15] round=12 local utility u=0.431237 metrics={'f1_val': 0.7544259120585594, 'auprc': 0.9846691026665235, 'loss_val': 0.28607783852406343, 'psi': 0.846523188301745}-{'f1_val': 0.7004291702091903, 'auprc': 0.8332241455414793, 'loss_val': 0.37023738924955885, 'psi': 0.7535471603421059}
[S16] START round=12 head_norm_before_train=1.406015 (no previous merge yet)
[S16] round=12 local utility u=0.460738 metrics={'f1_val': 0.5221587593566959, 'auprc': 0.7630585536302107, 'loss_val': 0.7840208828698766, 'psi': 0.6185186770661018}-{'f1_val': 0.3813528187951646, 'auprc': 0.7432503861208517, 'loss_val': 0.8012376339088029, 'psi': 0.5261118457254395}
[S17] START round=12 head_norm_before_train=1.560525 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.35262349161927115, 'auprc': 0.710260014312728, 'loss_val': 0.9114608166302278, 'psi': 0.49567810069665386}-{'f1_val': 0.35273268957802617, 'auprc': 0.740299630040645, 'loss_val': 0.9305518049530157, 'psi': 0.5077594657630737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:40411
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:40409
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:40414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S14
[S4] cosine check vs S14: cos=0.7814
[S8] RECEIVED delta(kind=head bytes=1801) from S16
[S8] cosine check vs S16: cos=-0.0506
[S8] DROPPED delta from S16 (cos=-0.0506 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] cosine check vs S15: cos=-0.0242
[S16] DROPPED delta from S15 (cos=-0.0242 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=-0.0929
[S17] DROPPED delta from S8 (cos=-0.0929 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] cosine check vs S7: cos=-0.0630
[S10] DROPPED delta from S7 (cos=-0.0630 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.9531
[S14] RECEIVED delta(kind=head bytes=1794) from S11
[S14] cosine check vs S11: cos=0.2756
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6138 head_norm=0.982996
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.722744e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6122 head_norm=1.026054 delta_norm=0.372274
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.7019 head_norm=1.190154
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.808510e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.7009 head_norm=1.078492 delta_norm=0.280851
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.746148 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7215267517203214, 'auprc': 0.721142521916547, 'loss_val': 1.0169856964814643, 'psi': 0.7213730597988117}-{'f1_val': 0.7072214370001407, 'auprc': 0.7374072193247849, 'loss_val': 0.835121610140558, 'psi': 0.7192957499299983}
[S3] START round=13 head_norm_before_train=1.581443 (no previous merge yet)
[S3] round=13 local utility u=0.450250 metrics={'f1_val': 0.604406993061628, 'auprc': 0.9146799417450431, 'loss_val': 0.48903631197759334, 'psi': 0.728516172534994}-{'f1_val': 0.5262714854735975, 'auprc': 0.826700710689815, 'loss_val': 0.6567859290527203, 'psi': 0.6464431755600845}
[S4] START round=13 head_norm_before_train=1.026054 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.623891919818379, 'auprc': 0.7988200222811577, 'loss_val': 0.5507165113086884, 'psi': 0.6938631608034904}-{'f1_val': 0.6137793074841731, 'auprc': 0.8478942897753003, 'loss_val': 0.5641503535285822, 'psi': 0.707425300400624}
[S5] START round=13 head_norm_before_train=1.230128 cos_to_last_merge=0.9182 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.918
[S5] round=13 local utility u=0.076869 metrics={'f1_val': 0.7148541531256721, 'auprc': 0.7935191140596742, 'loss_val': 0.5145198566201961, 'psi': 0.746320137499273}-{'f1_val': 0.7010639315836553, 'auprc': 0.7755821263884579, 'loss_val': 0.5317045879543781, 'psi': 0.7308712095055764}
[S6] START round=13 head_norm_before_train=1.376509 cos_to_last_merge=0.8649 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.865
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.6738267571605716, 'auprc': 0.747135903102293, 'loss_val': 0.5232146009990769, 'psi': 0.7031504155372602}-{'f1_val': 0.7072428994429236, 'auprc': 0.7814076677075619, 'loss_val': 0.5225863727783479, 'psi': 0.736908806748779}
[S7] START round=13 head_norm_before_train=1.483341 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.6860781231761527, 'auprc': 0.792531101254967, 'loss_val': 0.6509290562087789, 'psi': 0.7286593144076784}-{'f1_val': 0.7142988289087885, 'auprc': 0.7853516656778761, 'loss_val': 0.6485860622463366, 'psi': 0.7427199636164235}
[S8] START round=13 head_norm_before_train=1.839877 (no previous merge yet)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.9931805621461924, 'auprc': 0.9953763321225108, 'loss_val': 0.0457307623139198, 'psi': 0.9940588701367197}-{'f1_val': 0.9942822943870275, 'auprc': 0.9984311965207514, 'loss_val': 0.050359440511238356, 'psi': 0.9959418552405171}
[S9] START round=13 head_norm_before_train=0.898456 cos_to_last_merge=0.9950 (last merge round=11)
[S9] round=13 local utility u=0.569895 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982291820535188, 'loss_val': 0.4419370139259048, 'psi': 0.8200216212854187}-{'f1_val': 0.6086831317120466, 'auprc': 0.8653810376645812, 'loss_val': 0.6279822381490382, 'psi': 0.7113622940930604}
[S10] START round=13 head_norm_before_train=1.516484 cos_to_last_merge=0.8336 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.834
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.9934244041738736, 'auprc': 0.9944823368224655, 'loss_val': 0.10075676158898815, 'psi': 0.9938475772333104}-{'f1_val': 0.994378377236979, 'auprc': 0.9963568041020291, 'loss_val': 0.08328726704410291, 'psi': 0.9951697479829991}
[S11] START round=13 head_norm_before_train=1.366434 cos_to_last_merge=0.9986 (last merge round=11)
[S11] round=13 local utility u=0.042412 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.905291697897213, 'loss_val': 0.33521244376342824, 'psi': 0.7831327669110402}-{'f1_val': 0.7016934795869249, 'auprc': 0.8949554595002168, 'loss_val': 0.38902778280556577, 'psi': 0.7789982715522417}
[S13] START round=13 head_norm_before_train=1.012679 cos_to_last_merge=0.9898 (last merge round=11)
[S13] round=13 local utility u=0.057505 metrics={'f1_val': 0.6136190548411145, 'auprc': 0.6635816374395381, 'loss_val': 0.6266889684778435, 'psi': 0.6336040878804838}-{'f1_val': 0.6151911759308066, 'auprc': 0.6561673242241395, 'loss_val': 0.7288895616791056, 'psi': 0.6315816352481398}
[S14] START round=13 head_norm_before_train=1.078492 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.048498 metrics={'f1_val': 0.7018153249218998, 'auprc': 0.9971321269481186, 'loss_val': 0.4772189272109556, 'psi': 0.8199420457323874}-{'f1_val': 0.7018850250037899, 'auprc': 0.9956615121579175, 'loss_val': 0.5702215157247436, 'psi': 0.8193956198654411}
[S15] START round=13 head_norm_before_train=1.811728 (no previous merge yet)
[S15] round=13 local utility u=0.824458 metrics={'f1_val': 0.9913296884655663, 'auprc': 0.9905746011363823, 'loss_val': 0.0763007093095613, 'psi': 0.9910276535338927}-{'f1_val': 0.7544259120585594, 'auprc': 0.9846691026665235, 'loss_val': 0.28607783852406343, 'psi': 0.846523188301745}
[S16] START round=13 head_norm_before_train=1.445639 (no previous merge yet)
[S16] round=13 local utility u=0.156813 metrics={'f1_val': 0.5538323461312368, 'auprc': 0.7811517762470602, 'loss_val': 0.7147158339631289, 'psi': 0.6447601181775662}-{'f1_val': 0.5221587593566959, 'auprc': 0.7630585536302107, 'loss_val': 0.7840208828698766, 'psi': 0.6185186770661018}
[S17] START round=13 head_norm_before_train=1.576804 (no previous merge yet)
[S17] round=13 local utility u=0.332053 metrics={'f1_val': 0.3906705831319697, 'auprc': 0.8352003116096225, 'loss_val': 0.8504583400683549, 'psi': 0.5684824745230308}-{'f1_val': 0.35262349161927115, 'auprc': 0.710260014312728, 'loss_val': 0.9114608166302278, 'psi': 0.49567810069665386}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:40416
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:40414
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S16
[S8] cosine check vs S16: cos=-0.0519
[S8] DROPPED delta from S16 (cos=-0.0519 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1796) from S9
[S13] cosine check vs S9: cos=0.7847
[S16] RECEIVED delta(kind=head bytes=1801) from S15
[S16] cosine check vs S15: cos=-0.0254
[S16] DROPPED delta from S15 (cos=-0.0254 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S13
[S16] cosine check vs S13: cos=-0.0268
[S16] DROPPED delta from S13 (cos=-0.0268 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S11
[S14] cosine check vs S11: cos=0.4691
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.7302
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] cosine check vs S3: cos=-0.0924
[S4] DROPPED delta from S3 (cos=-0.0924 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S14
[S4] cosine check vs S14: cos=0.9091
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] cosine check vs S17: cos=0.4875
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6239 head_norm=1.114874
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.389340e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6132 head_norm=1.094881 delta_norm=0.238934
[S4] aggregate: ROLLBACK (f1_val pre=0.624 post=0.613 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.7018 head_norm=1.126394
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.632397e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.5346 head_norm=1.087595 delta_norm=0.663240
[S14] aggregate: ROLLBACK (f1_val pre=0.702 post=0.535 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.6136 head_norm=1.089848
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.413619e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.6180 head_norm=0.965437 delta_norm=0.341362
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7012 head_norm=0.953638
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.987891e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7012 head_norm=0.947948 delta_norm=0.298789
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.767684 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.6677976778459942, 'auprc': 0.6865555513654811, 'loss_val': 1.1170276754381803, 'psi': 0.675300827253789}-{'f1_val': 0.7215267517203214, 'auprc': 0.721142521916547, 'loss_val': 1.0169856964814643, 'psi': 0.7213730597988117}
[S3] START round=14 head_norm_before_train=1.608407 (no previous merge yet)
[S3] round=14 local utility u=0.489439 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9923840378927408, 'loss_val': 0.3188146236500021, 'psi': 0.8171521665690136}-{'f1_val': 0.604406993061628, 'auprc': 0.9146799417450431, 'loss_val': 0.48903631197759334, 'psi': 0.728516172534994}
[S4] START round=14 head_norm_before_train=1.094881 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.109177 metrics={'f1_val': 0.6136962656727263, 'auprc': 0.8862113272571812, 'loss_val': 0.5333623510007236, 'psi': 0.7227022903065083}-{'f1_val': 0.623891919818379, 'auprc': 0.7988200222811577, 'loss_val': 0.5507165113086884, 'psi': 0.6938631608034904}
[S5] START round=14 head_norm_before_train=1.258674 cos_to_last_merge=0.9102 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.910
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7008162875368863, 'auprc': 0.7938333895903927, 'loss_val': 0.44714701340887864, 'psi': 0.7380231283582889}-{'f1_val': 0.7148541531256721, 'auprc': 0.7935191140596742, 'loss_val': 0.5145198566201961, 'psi': 0.746320137499273}
[S6] START round=14 head_norm_before_train=1.397466 cos_to_last_merge=0.8609 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.861
[S6] round=14 local utility u=1.000000 metrics={'f1_val': 0.9604855668924193, 'auprc': 0.9614850140778437, 'loss_val': 0.32136618431690295, 'psi': 0.9608853457665891}-{'f1_val': 0.6738267571605716, 'auprc': 0.747135903102293, 'loss_val': 0.5232146009990769, 'psi': 0.7031504155372602}
[S7] START round=14 head_norm_before_train=1.506543 (no previous merge yet)
[S7] round=14 local utility u=0.006875 metrics={'f1_val': 0.665241325597396, 'auprc': 0.8361235518164645, 'loss_val': 0.6429348153178697, 'psi': 0.7335942160850234}-{'f1_val': 0.6860781231761527, 'auprc': 0.792531101254967, 'loss_val': 0.6509290562087789, 'psi': 0.7286593144076784}
[S8] START round=14 head_norm_before_train=1.875401 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.9893766104424556, 'auprc': 0.9987717234451094, 'loss_val': 0.04678101691046382, 'psi': 0.9931346556435172}-{'f1_val': 0.9931805621461924, 'auprc': 0.9953763321225108, 'loss_val': 0.0457307623139198, 'psi': 0.9940588701367197}
[S9] START round=14 head_norm_before_train=0.947948 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981910614875541, 'loss_val': 0.4422165267544608, 'psi': 0.8200063730590328}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982291820535188, 'loss_val': 0.4419370139259048, 'psi': 0.8200216212854187}
[S10] START round=14 head_norm_before_train=1.570462 cos_to_last_merge=0.8260 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.826
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.9518240061756698, 'auprc': 0.9947555851271053, 'loss_val': 0.13567478518602547, 'psi': 0.968996637756244}-{'f1_val': 0.9934244041738736, 'auprc': 0.9944823368224655, 'loss_val': 0.10075676158898815, 'psi': 0.9938475772333104}
[S11] START round=14 head_norm_before_train=1.405965 cos_to_last_merge=0.9954 (last merge round=11)
[S11] round=14 local utility u=0.035134 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.920787543556504, 'loss_val': 0.31288271164164255, 'psi': 0.7894762074015937}-{'f1_val': 0.7016934795869249, 'auprc': 0.905291697897213, 'loss_val': 0.33521244376342824, 'psi': 0.7831327669110402}
[S13] START round=14 head_norm_before_train=0.965437 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.131042 metrics={'f1_val': 0.6488785131233094, 'auprc': 0.6613207305113642, 'loss_val': 0.5693795329571211, 'psi': 0.6538554000785313}-{'f1_val': 0.6136190548411145, 'auprc': 0.6635816374395381, 'loss_val': 0.6266889684778435, 'psi': 0.6336040878804838}
[S14] START round=14 head_norm_before_train=1.087595 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.7018196764371489, 'auprc': 0.9969931903881741, 'loss_val': 0.5108951427697003, 'psi': 0.8198890820175591}-{'f1_val': 0.7018153249218998, 'auprc': 0.9971321269481186, 'loss_val': 0.4772189272109556, 'psi': 0.8199420457323874}
[S15] START round=14 head_norm_before_train=1.847073 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.9732834102236942, 'auprc': 0.990952902108092, 'loss_val': 0.07706071146562661, 'psi': 0.9803512069774534}-{'f1_val': 0.9913296884655663, 'auprc': 0.9905746011363823, 'loss_val': 0.0763007093095613, 'psi': 0.9910276535338927}
[S16] START round=14 head_norm_before_train=1.486064 (no previous merge yet)
[S16] round=14 local utility u=0.616165 metrics={'f1_val': 0.7261832874047083, 'auprc': 0.8144815622428341, 'loss_val': 0.6164800683063436, 'psi': 0.7615025973399586}-{'f1_val': 0.5538323461312368, 'auprc': 0.7811517762470602, 'loss_val': 0.7147158339631289, 'psi': 0.6447601181775662}
[S17] START round=14 head_norm_before_train=1.596403 (no previous merge yet)
[S17] round=14 local utility u=0.753119 metrics={'f1_val': 0.6190136692322481, 'auprc': 0.8501250552282759, 'loss_val': 0.7590524370043998, 'psi': 0.7114582236306592}-{'f1_val': 0.3906705831319697, 'auprc': 0.8352003116096225, 'loss_val': 0.8504583400683549, 'psi': 0.5684824745230308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:40414
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:40411
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:40412
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:40416
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S16
[S8] cosine check vs S16: cos=-0.0530
[S8] DROPPED delta from S16 (cos=-0.0530 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] cosine check vs S6: cos=0.9753
[S16] RECEIVED delta(kind=head bytes=1805) from S13
[S16] cosine check vs S13: cos=0.0005
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] cosine check vs S7: cos=-0.0652
[S10] DROPPED delta from S7 (cos=-0.0652 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1790) from S11
[S14] cosine check vs S11: cos=0.8700
[S9] RECEIVED delta(kind=head bytes=1803) from S4
[S9] cosine check vs S4: cos=-0.0191
[S9] DROPPED delta from S4 (cos=-0.0191 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] cosine check vs S3: cos=-0.0991
[S4] DROPPED delta from S3 (cos=-0.0991 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S17
[S9] cosine check vs S17: cos=0.6621
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.7018 head_norm=1.127316
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.608292e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.7004 head_norm=1.242301 delta_norm=0.360829
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.7262 head_norm=1.526336
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.211372e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.6954 head_norm=0.921566 delta_norm=0.921137
[S16] aggregate: ROLLBACK (f1_val pre=0.726 post=0.695 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7012 head_norm=0.996563
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.130593e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7012 head_norm=1.205305 delta_norm=0.613059
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7019 head_norm=1.440895
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.591968e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7019 head_norm=1.418849 delta_norm=0.159197
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.783353 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.5840511401080408, 'auprc': 0.6483923553263236, 'loss_val': 1.311552167063616, 'psi': 0.6097876261953539}-{'f1_val': 0.6677976778459942, 'auprc': 0.6865555513654811, 'loss_val': 1.1170276754381803, 'psi': 0.675300827253789}
[S3] START round=15 head_norm_before_train=1.633820 (no previous merge yet)
[S3] round=15 local utility u=0.009128 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9925748981423076, 'loss_val': 0.30263323872878234, 'psi': 0.8173787968521761}-{'f1_val': 0.700330919019862, 'auprc': 0.9923840378927408, 'loss_val': 0.3188146236500021, 'psi': 0.8171521665690136}
[S4] START round=15 head_norm_before_train=1.176140 cos_to_last_merge=0.9902 (last merge round=13)
[S4] round=15 local utility u=0.025277 metrics={'f1_val': 0.6147478762137409, 'auprc': 0.8865590842437912, 'loss_val': 0.4901619096617597, 'psi': 0.723472359425761}-{'f1_val': 0.6136962656727263, 'auprc': 0.8862113272571812, 'loss_val': 0.5333623510007236, 'psi': 0.7227022903065083}
[S5] START round=15 head_norm_before_train=1.291119 cos_to_last_merge=0.9019 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.902
[S5] round=15 local utility u=0.016970 metrics={'f1_val': 0.7019683908621073, 'auprc': 0.793708224736339, 'loss_val': 0.41974317378312476, 'psi': 0.7386643244118}-{'f1_val': 0.7008162875368863, 'auprc': 0.7938333895903927, 'loss_val': 0.44714701340887864, 'psi': 0.7380231283582889}
[S6] START round=15 head_norm_before_train=1.414486 cos_to_last_merge=0.8576 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.858
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.9514603248307979, 'auprc': 0.9529277459362007, 'loss_val': 0.3335557925747753, 'psi': 0.952047293272959}-{'f1_val': 0.9604855668924193, 'auprc': 0.9614850140778437, 'loss_val': 0.32136618431690295, 'psi': 0.9608853457665891}
[S7] START round=15 head_norm_before_train=1.534451 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.5885627104133097, 'auprc': 0.7741133386675036, 'loss_val': 0.6819372759804074, 'psi': 0.6627829617149872}-{'f1_val': 0.665241325597396, 'auprc': 0.8361235518164645, 'loss_val': 0.6429348153178697, 'psi': 0.7335942160850234}
[S8] START round=15 head_norm_before_train=1.898960 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.9861776023323788, 'auprc': 0.9987240566753421, 'loss_val': 0.051528109331366985, 'psi': 0.9911961840695641}-{'f1_val': 0.9893766104424556, 'auprc': 0.9987717234451094, 'loss_val': 0.04678101691046382, 'psi': 0.9931346556435172}
[S9] START round=15 head_norm_before_train=1.205305 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.900041 metrics={'f1_val': 0.9916350289240425, 'auprc': 0.9978151881210465, 'loss_val': 0.3835178178307869, 'psi': 0.9941070926028441}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981910614875541, 'loss_val': 0.4422165267544608, 'psi': 0.8200063730590328}
[S10] START round=15 head_norm_before_train=1.619103 cos_to_last_merge=0.8195 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.820
[S10] round=15 local utility u=0.164000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9949981787390532, 'loss_val': 0.0659508850284498, 'psi': 0.9948484370272448}-{'f1_val': 0.9518240061756698, 'auprc': 0.9947555851271053, 'loss_val': 0.13567478518602547, 'psi': 0.968996637756244}
[S11] START round=15 head_norm_before_train=1.418849 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.112280 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9978702296292499, 'loss_val': 0.31812037300919266, 'psi': 0.8201641796038548}-{'f1_val': 0.7019353166316534, 'auprc': 0.920787543556504, 'loss_val': 0.31288271164164255, 'psi': 0.7894762074015937}
[S13] START round=15 head_norm_before_train=1.032401 cos_to_last_merge=0.9951 (last merge round=13)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6310925568735042, 'auprc': 0.6714677739655865, 'loss_val': 0.6388786677309006, 'psi': 0.6472426437103371}-{'f1_val': 0.6488785131233094, 'auprc': 0.6613207305113642, 'loss_val': 0.5693795329571211, 'psi': 0.6538554000785313}
[S14] START round=15 head_norm_before_train=1.242301 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.724079 metrics={'f1_val': 0.9297716919775871, 'auprc': 0.9985707425974435, 'loss_val': 0.435181234238582, 'psi': 0.9572913122255297}-{'f1_val': 0.7018196764371489, 'auprc': 0.9969931903881741, 'loss_val': 0.5108951427697003, 'psi': 0.8198890820175591}
[S15] START round=15 head_norm_before_train=1.877043 (no previous merge yet)
[S15] round=15 local utility u=0.083271 metrics={'f1_val': 0.9962053994161175, 'auprc': 0.990907816896703, 'loss_val': 0.04791491663234442, 'psi': 0.9940863664083517}-{'f1_val': 0.9732834102236942, 'auprc': 0.990952902108092, 'loss_val': 0.07706071146562661, 'psi': 0.9803512069774534}
[S16] START round=15 head_norm_before_train=0.921566 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.377437 metrics={'f1_val': 0.8157588292570438, 'auprc': 0.8893369736068742, 'loss_val': 0.6236264414803048, 'psi': 0.845190086996976}-{'f1_val': 0.7261832874047083, 'auprc': 0.8144815622428341, 'loss_val': 0.6164800683063436, 'psi': 0.7615025973399586}
[S17] START round=15 head_norm_before_train=1.632197 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.5792773118709162, 'auprc': 0.8939063380465505, 'loss_val': 0.7152060718371985, 'psi': 0.70512892234117}-{'f1_val': 0.6190136692322481, 'auprc': 0.8501250552282759, 'loss_val': 0.7590524370043998, 'psi': 0.7114582236306592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.2660
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:40414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:40409
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:40413
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[S11] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1798) from S14
[S4] cosine check vs S14: cos=0.6159
[S16] RECEIVED delta(kind=head bytes=1801) from S15
[S16] cosine check vs S15: cos=0.0131
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=0.9584
[S16] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S16
[S8] cosine check vs S16: cos=-0.0238
[S8] DROPPED delta from S16 (cos=-0.0238 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S4
[S9] cosine check vs S4: cos=-0.0406
[S9] DROPPED delta from S4 (cos=-0.0406 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.3218
[S4] RECEIVED delta(kind=head bytes=1800) from S3
[S4] cosine check vs S3: cos=-0.0977
[S4] DROPPED delta from S3 (cos=-0.0977 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S9
[S13] cosine check vs S9: cos=0.6690
[S2] ⇄ pheromone p=0.070 → S8@127.0.0.1:40409
[S3] ⇄ pheromone p=0.257 → S4@127.0.0.1:40404
[S7] ⇄ pheromone p=0.156 → S10@127.0.0.1:40411
[S6] ⇄ pheromone p=0.275 → S11@127.0.0.1:40412
[S5] ⇄ pheromone p=0.169 → S9@127.0.0.1:40410
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6147 head_norm=1.250389
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.541247e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6139 head_norm=1.136327 delta_norm=0.554125
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.134 → S9@127.0.0.1:40410
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9916 head_norm=1.244768
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.495145e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7263 head_norm=1.045549 delta_norm=0.749515
[S9] aggregate: ROLLBACK (f1_val pre=0.992 post=0.726 tol_abs=0.005 tol_rel=0.0)
[S9] ⇄ pheromone p=0.401 → S13@127.0.0.1:40413
[S10] ⇄ pheromone p=0.171 → S14@127.0.0.1:40414
[S17] ⇄ pheromone p=0.288 → S9@127.0.0.1:40410
[S8] ⇄ pheromone p=0.134 → S17@127.0.0.1:40417
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9298 head_norm=1.277934
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.681215e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9385 head_norm=1.140849 delta_norm=0.368122
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.397 → S4@127.0.0.1:40404
[S11] ⇄ pheromone p=0.198 → S14@127.0.0.1:40414
[S15] ⇄ pheromone p=0.251 → S16@127.0.0.1:40416
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6311 head_norm=1.086183
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.796479e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6321 head_norm=1.065156 delta_norm=0.479648
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.212 → S16@127.0.0.1:40416
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.8158 head_norm=0.970465
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.063282e+00
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.8697 head_norm=1.074625 delta_norm=1.063282
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.324 → S8@127.0.0.1:40409
[S2] START round=16 head_norm_before_train=1.802417 (no previous merge yet)
[S2] round=16 local utility u=0.311071 metrics={'f1_val': 0.6433114569295539, 'auprc': 0.7085607726341171, 'loss_val': 1.2254764328934833, 'psi': 0.6694111832113792}-{'f1_val': 0.5840511401080408, 'auprc': 0.6483923553263236, 'loss_val': 1.311552167063616, 'psi': 0.6097876261953539}
[S3] START round=16 head_norm_before_train=1.655473 (no previous merge yet)
[S3] round=16 local utility u=0.011775 metrics={'f1_val': 0.7005014381049806, 'auprc': 0.9939413637661723, 'loss_val': 0.28270304258608026, 'psi': 0.8178774083694573}-{'f1_val': 0.7005813959920884, 'auprc': 0.9925748981423076, 'loss_val': 0.30263323872878234, 'psi': 0.8173787968521761}
[S4] START round=16 head_norm_before_train=1.136327 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.6137747432920255, 'auprc': 0.8831114858034124, 'loss_val': 0.5148454545084183, 'psi': 0.7215094402965803}-{'f1_val': 0.6147478762137409, 'auprc': 0.8865590842437912, 'loss_val': 0.4901619096617597, 'psi': 0.723472359425761}
[S5] START round=16 head_norm_before_train=1.326816 cos_to_last_merge=0.8928 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.893
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.7203458199199786, 'loss_val': 0.3682336782060667, 'psi': 0.7086524980575106}-{'f1_val': 0.7019683908621073, 'auprc': 0.793708224736339, 'loss_val': 0.41974317378312476, 'psi': 0.7386643244118}
[S6] START round=16 head_norm_before_train=1.436729 cos_to_last_merge=0.8536 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.854
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6911671089119003, 'auprc': 0.7952454213296604, 'loss_val': 0.4700671416744547, 'psi': 0.7327984338790043}-{'f1_val': 0.9514603248307979, 'auprc': 0.9529277459362007, 'loss_val': 0.3335557925747753, 'psi': 0.952047293272959}
[S7] START round=16 head_norm_before_train=1.562671 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.5724135476279821, 'auprc': 0.6469219447888763, 'loss_val': 0.7146962076412584, 'psi': 0.6022169064923397}-{'f1_val': 0.5885627104133097, 'auprc': 0.7741133386675036, 'loss_val': 0.6819372759804074, 'psi': 0.6627829617149872}
[S8] START round=16 head_norm_before_train=1.922138 (no previous merge yet)
[S8] round=16 local utility u=0.020661 metrics={'f1_val': 0.9913659372482032, 'auprc': 0.9985841248439786, 'loss_val': 0.040915458636270434, 'psi': 0.9942532122865133}-{'f1_val': 0.9861776023323788, 'auprc': 0.9987240566753421, 'loss_val': 0.051528109331366985, 'psi': 0.9911961840695641}
[S9] START round=16 head_norm_before_train=1.045549 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9964330161560574, 'loss_val': 0.39176528164971136, 'psi': 0.8193031549264341}-{'f1_val': 0.9916350289240425, 'auprc': 0.9978151881210465, 'loss_val': 0.3835178178307869, 'psi': 0.9941070926028441}
[S10] START round=16 head_norm_before_train=1.660956 cos_to_last_merge=0.8142 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.814
[S10] round=16 local utility u=0.010482 metrics={'f1_val': 0.994243089309356, 'auprc': 0.9953747217786362, 'loss_val': 0.04308242129324344, 'psi': 0.9946957422970681}-{'f1_val': 0.9947486092193725, 'auprc': 0.9949981787390532, 'loss_val': 0.0659508850284498, 'psi': 0.9948484370272448}
[S11] START round=16 head_norm_before_train=1.442994 cos_to_last_merge=0.9996 (last merge round=14)
[S11] round=16 local utility u=0.007947 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9984770819968889, 'loss_val': 0.30589091565999577, 'psi': 0.8205912983662949}-{'f1_val': 0.7016934795869249, 'auprc': 0.9978702296292499, 'loss_val': 0.31812037300919266, 'psi': 0.8201641796038548}
[S13] START round=16 head_norm_before_train=1.065156 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6174096230188747, 'auprc': 0.6723220551983384, 'loss_val': 0.698338304751146, 'psi': 0.6393745958906603}-{'f1_val': 0.6310925568735042, 'auprc': 0.6714677739655865, 'loss_val': 0.6388786677309006, 'psi': 0.6472426437103371}
[S14] START round=16 head_norm_before_train=1.140849 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.265097 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.996968945761455, 'loss_val': 0.30745757135635327, 'psi': 0.9973782491344941}-{'f1_val': 0.9297716919775871, 'auprc': 0.9985707425974435, 'loss_val': 0.435181234238582, 'psi': 0.9572913122255297}
[S15] START round=16 head_norm_before_train=1.904986 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.7757480494964752, 'auprc': 0.9880325106890937, 'loss_val': 0.2887665701873943, 'psi': 0.8606618339735226}-{'f1_val': 0.9962053994161175, 'auprc': 0.990907816896703, 'loss_val': 0.04791491663234442, 'psi': 0.9940863664083517}
[S16] START round=16 head_norm_before_train=1.074625 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.48394808080343366, 'auprc': 0.8511376548200538, 'loss_val': 0.7768315094515501, 'psi': 0.6308239104100817}-{'f1_val': 0.8157588292570438, 'auprc': 0.8893369736068742, 'loss_val': 0.6236264414803048, 'psi': 0.845190086996976}
[S17] START round=16 head_norm_before_train=1.675502 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.5929380368410626, 'auprc': 0.7549635784460873, 'loss_val': 0.9743469060722105, 'psi': 0.6577482534830725}-{'f1_val': 0.5792773118709162, 'auprc': 0.8939063380465505, 'loss_val': 0.7152060718371985, 'psi': 0.70512892234117}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:40404
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:40404
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=-0.0851
[S8] DROPPED delta from S2 (cos=-0.0851 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=-0.0669
[S17] DROPPED delta from S8 (cos=-0.0669 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1793) from S11
[S14] cosine check vs S11: cos=0.8430
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=0.5393
[S4] RECEIVED delta(kind=head bytes=1801) from S14
[S4] cosine check vs S14: cos=0.9449
[S4] RECEIVED delta(kind=head bytes=1803) from S3
[S4] cosine check vs S3: cos=-0.0643
[S4] DROPPED delta from S3 (cos=-0.0643 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.6138 head_norm=1.208082
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.994408e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.6134 head_norm=1.184701 delta_norm=0.199441
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9977 head_norm=1.194622
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.902968e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9981 head_norm=1.149183 delta_norm=0.190297
[S14] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.819571 (no previous merge yet)
[S2] round=17 local utility u=0.169689 metrics={'f1_val': 0.6887174587016927, 'auprc': 0.7068099489404982, 'loss_val': 1.1532825842174883, 'psi': 0.6959544547972148}-{'f1_val': 0.6433114569295539, 'auprc': 0.7085607726341171, 'loss_val': 1.2254764328934833, 'psi': 0.6694111832113792}
[S3] START round=17 head_norm_before_train=1.672874 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9927646399581109, 'loss_val': 0.28613246451549695, 'psi': 0.8174546935784974}-{'f1_val': 0.7005014381049806, 'auprc': 0.9939413637661723, 'loss_val': 0.28270304258608026, 'psi': 0.8178774083694573}
[S4] START round=17 head_norm_before_train=1.184701 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=1.000000 metrics={'f1_val': 0.953975148128112, 'auprc': 0.8881323912774176, 'loss_val': 0.4852411032927665, 'psi': 0.9276380453878343}-{'f1_val': 0.6137747432920255, 'auprc': 0.8831114858034124, 'loss_val': 0.5148454545084183, 'psi': 0.7215094402965803}
[S5] START round=17 head_norm_before_train=1.356511 cos_to_last_merge=0.8836 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.884
[S5] round=17 local utility u=0.134052 metrics={'f1_val': 0.714400588689728, 'auprc': 0.7948123629669153, 'loss_val': 0.4047908103691171, 'psi': 0.7465652984006029}-{'f1_val': 0.7008569501491988, 'auprc': 0.7203458199199786, 'loss_val': 0.3682336782060667, 'psi': 0.7086524980575106}
[S6] START round=17 head_norm_before_train=1.460520 cos_to_last_merge=0.8495 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.849
[S6] round=17 local utility u=0.448270 metrics={'f1_val': 0.7874877522270721, 'auprc': 0.8955775761026936, 'loss_val': 0.45244828746066473, 'psi': 0.8307236817773207}-{'f1_val': 0.6911671089119003, 'auprc': 0.7952454213296604, 'loss_val': 0.4700671416744547, 'psi': 0.7327984338790043}
[S7] START round=17 head_norm_before_train=1.582646 (no previous merge yet)
[S7] round=17 local utility u=0.504698 metrics={'f1_val': 0.6667325370213896, 'auprc': 0.7413065956259497, 'loss_val': 0.5543678784244579, 'psi': 0.6965621604632136}-{'f1_val': 0.5724135476279821, 'auprc': 0.6469219447888763, 'loss_val': 0.7146962076412584, 'psi': 0.6022169064923397}
[S8] START round=17 head_norm_before_train=1.947134 (no previous merge yet)
[S8] round=17 local utility u=0.003638 metrics={'f1_val': 0.9924399374978184, 'auprc': 0.9981632856002253, 'loss_val': 0.03882095033144224, 'psi': 0.9947292767387812}-{'f1_val': 0.9913659372482032, 'auprc': 0.9985841248439786, 'loss_val': 0.040915458636270434, 'psi': 0.9942532122865133}
[S9] START round=17 head_norm_before_train=1.086002 cos_to_last_merge=0.9972 (last merge round=15)
[S9] round=17 local utility u=0.934844 metrics={'f1_val': 0.9928966156188738, 'auprc': 0.9976055591284373, 'loss_val': 0.2756758350241288, 'psi': 0.9947801930226992}-{'f1_val': 0.7012165807733519, 'auprc': 0.9964330161560574, 'loss_val': 0.39176528164971136, 'psi': 0.8193031549264341}
[S10] START round=17 head_norm_before_train=1.694527 cos_to_last_merge=0.8103 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.810
[S10] round=17 local utility u=0.002829 metrics={'f1_val': 0.9946565967294403, 'auprc': 0.9954522832658271, 'loss_val': 0.04013784770049633, 'psi': 0.994974871343995}-{'f1_val': 0.994243089309356, 'auprc': 0.9953747217786362, 'loss_val': 0.04308242129324344, 'psi': 0.9946957422970681}
[S11] START round=17 head_norm_before_train=1.466652 cos_to_last_merge=0.9987 (last merge round=14)
[S11] round=17 local utility u=0.008490 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9983449212125348, 'loss_val': 0.2866714343637863, 'psi': 0.8203540562371688}-{'f1_val': 0.7020007759458987, 'auprc': 0.9984770819968889, 'loss_val': 0.30589091565999577, 'psi': 0.8205912983662949}
[S13] START round=17 head_norm_before_train=1.129821 cos_to_last_merge=0.9948 (last merge round=15)
[S13] round=17 local utility u=0.007698 metrics={'f1_val': 0.621747826781302, 'auprc': 0.6701802786045742, 'loss_val': 0.7025464917505735, 'psi': 0.641120807510611}-{'f1_val': 0.6174096230188747, 'auprc': 0.6723220551983384, 'loss_val': 0.698338304751146, 'psi': 0.6393745958906603}
[S14] START round=17 head_norm_before_train=1.149183 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.037387 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.9989079503740519, 'loss_val': 0.23848495426809302, 'psi': 0.998152207110088}-{'f1_val': 0.9976511180498535, 'auprc': 0.996968945761455, 'loss_val': 0.30745757135635327, 'psi': 0.9973782491344941}
[S15] START round=17 head_norm_before_train=1.928204 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.7010035278053174, 'auprc': 0.9269126158409249, 'loss_val': 0.4804995670141283, 'psi': 0.7913671630195604}-{'f1_val': 0.7757480494964752, 'auprc': 0.9880325106890937, 'loss_val': 0.2887665701873943, 'psi': 0.8606618339735226}
[S16] START round=17 head_norm_before_train=1.108407 cos_to_last_merge=0.9964 (last merge round=15)
[S16] round=17 local utility u=1.000000 metrics={'f1_val': 0.8859210481987603, 'auprc': 0.9028549407216584, 'loss_val': 0.6189676601268249, 'psi': 0.8926946052079195}-{'f1_val': 0.48394808080343366, 'auprc': 0.8511376548200538, 'loss_val': 0.7768315094515501, 'psi': 0.6308239104100817}
[S17] START round=17 head_norm_before_train=1.721038 (no previous merge yet)
[S17] round=17 local utility u=0.358781 metrics={'f1_val': 0.6052424595217459, 'auprc': 0.8620323558765126, 'loss_val': 0.6518186166822584, 'psi': 0.7079584180636527}-{'f1_val': 0.5929380368410626, 'auprc': 0.7549635784460873, 'loss_val': 0.9743469060722105, 'psi': 0.6577482534830725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:40404
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:40417
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:40412
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S16
[S8] cosine check vs S16: cos=-0.0757
[S8] DROPPED delta from S16 (cos=-0.0757 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S2
[S8] cosine check vs S2: cos=-0.0856
[S8] DROPPED delta from S2 (cos=-0.0856 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1806) from S9
[S13] cosine check vs S9: cos=0.8431
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] cosine check vs S6: cos=0.9774
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] cosine check vs S13: cos=0.2715
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=-0.0638
[S17] DROPPED delta from S8 (cos=-0.0638 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S7
[S10] cosine check vs S7: cos=-0.0658
[S10] DROPPED delta from S7 (cos=-0.0658 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.6645
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=0.7509
[S9] RECEIVED delta(kind=head bytes=1799) from S4
[S9] cosine check vs S4: cos=-0.0864
[S9] DROPPED delta from S4 (cos=-0.0864 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.8008
[S4] RECEIVED delta(kind=head bytes=1794) from S14
[S4] cosine check vs S14: cos=0.9633
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] cosine check vs S17: cos=0.5688
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9929 head_norm=1.126679
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.243130e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9962 head_norm=1.111399 delta_norm=0.224313
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7017 head_norm=1.490289
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.576665e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7017 head_norm=1.474964 delta_norm=0.157667
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9540 head_norm=1.252197
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.681217e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.7220 head_norm=1.218064 delta_norm=0.168122
[S4] aggregate: ROLLBACK (f1_val pre=0.954 post=0.722 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6217 head_norm=1.189028
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.256958e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6224 head_norm=1.111539 delta_norm=0.325696
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.8859 head_norm=1.163157
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.098856e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.8939 head_norm=0.937776 delta_norm=0.709886
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9976 head_norm=1.206604
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.151041e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9968 head_norm=1.174465 delta_norm=0.115104
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.841992 (no previous merge yet)
[S2] round=18 local utility u=0.116383 metrics={'f1_val': 0.7189735309036235, 'auprc': 0.7129753799492609, 'loss_val': 1.1205498781467325, 'psi': 0.7165742705218785}-{'f1_val': 0.6887174587016927, 'auprc': 0.7068099489404982, 'loss_val': 1.1532825842174883, 'psi': 0.6959544547972148}
[S3] START round=18 head_norm_before_train=1.687618 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.6818995468279534, 'auprc': 0.9878169396246934, 'loss_val': 0.32697103291488633, 'psi': 0.8042665039466494}-{'f1_val': 0.7005813959920884, 'auprc': 0.9927646399581109, 'loss_val': 0.28613246451549695, 'psi': 0.8174546935784974}
[S4] START round=18 head_norm_before_train=1.218064 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.109421 metrics={'f1_val': 0.9533570386486316, 'auprc': 0.9491315657088497, 'loss_val': 0.44568730956206803, 'psi': 0.9516668494727188}-{'f1_val': 0.953975148128112, 'auprc': 0.8881323912774176, 'loss_val': 0.4852411032927665, 'psi': 0.9276380453878343}
[S5] START round=18 head_norm_before_train=1.376382 cos_to_last_merge=0.8749 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.875
[S5] round=18 local utility u=0.308959 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.9979899124495102, 'loss_val': 0.3151390285297392, 'psi': 0.8197097585157307}-{'f1_val': 0.714400588689728, 'auprc': 0.7948123629669153, 'loss_val': 0.4047908103691171, 'psi': 0.7465652984006029}
[S6] START round=18 head_norm_before_train=1.476413 cos_to_last_merge=0.8464 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.846
[S6] round=18 local utility u=0.158670 metrics={'f1_val': 0.8014092891513536, 'auprc': 0.9425030781554171, 'loss_val': 0.3594133747098369, 'psi': 0.857846804752979}-{'f1_val': 0.7874877522270721, 'auprc': 0.8955775761026936, 'loss_val': 0.45244828746066473, 'psi': 0.8307236817773207}
[S7] START round=18 head_norm_before_train=1.594227 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5693039153955775, 'auprc': 0.643311339614626, 'loss_val': 0.7326714777056166, 'psi': 0.5989068850831969}-{'f1_val': 0.6667325370213896, 'auprc': 0.7413065956259497, 'loss_val': 0.5543678784244579, 'psi': 0.6965621604632136}
[S8] START round=18 head_norm_before_train=1.971808 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9897367044659179, 'auprc': 0.9983985402174496, 'loss_val': 0.03980664969929747, 'psi': 0.9932014387665304}-{'f1_val': 0.9924399374978184, 'auprc': 0.9981632856002253, 'loss_val': 0.03882095033144224, 'psi': 0.9947292767387812}
[S9] START round=18 head_norm_before_train=1.111399 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.007410 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.998147414047753, 'loss_val': 0.280062208711275, 'psi': 0.9967549966376125}-{'f1_val': 0.9928966156188738, 'auprc': 0.9976055591284373, 'loss_val': 0.2756758350241288, 'psi': 0.9947801930226992}
[S10] START round=18 head_norm_before_train=1.723630 cos_to_last_merge=0.8069 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.807
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9936959108080994, 'auprc': 0.9951973752384325, 'loss_val': 0.04574289391968495, 'psi': 0.9942964965802326}-{'f1_val': 0.9946565967294403, 'auprc': 0.9954522832658271, 'loss_val': 0.04013784770049633, 'psi': 0.994974871343995}
[S11] START round=18 head_norm_before_train=1.474964 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9983806737628151, 'loss_val': 0.2923667489723145, 'psi': 0.8205134594841181}-{'f1_val': 0.7016934795869249, 'auprc': 0.9983449212125348, 'loss_val': 0.2866714343637863, 'psi': 0.8203540562371688}
[S13] START round=18 head_norm_before_train=1.111539 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.038556 metrics={'f1_val': 0.6266433541500507, 'auprc': 0.6768761958177453, 'loss_val': 0.6748946692225342, 'psi': 0.6467364908171285}-{'f1_val': 0.621747826781302, 'auprc': 0.6701802786045742, 'loss_val': 0.7025464917505735, 'psi': 0.641120807510611}
[S14] START round=18 head_norm_before_train=1.174465 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.020230 metrics={'f1_val': 0.9976737714957896, 'auprc': 0.9969876383062616, 'loss_val': 0.19241702810719571, 'psi': 0.9973993182199783}-{'f1_val': 0.9976483782674455, 'auprc': 0.9989079503740519, 'loss_val': 0.23848495426809302, 'psi': 0.998152207110088}
[S15] START round=18 head_norm_before_train=1.951996 (no previous merge yet)
[S15] round=18 local utility u=0.581021 metrics={'f1_val': 0.8198164488633823, 'auprc': 0.9885007097307862, 'loss_val': 0.2160986876049839, 'psi': 0.8872901532103439}-{'f1_val': 0.7010035278053174, 'auprc': 0.9269126158409249, 'loss_val': 0.4804995670141283, 'psi': 0.7913671630195604}
[S16] START round=18 head_norm_before_train=0.937776 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8589484874804592, 'auprc': 0.9313638048906712, 'loss_val': 0.6440771041466985, 'psi': 0.887914614444544}-{'f1_val': 0.8859210481987603, 'auprc': 0.9028549407216584, 'loss_val': 0.6189676601268249, 'psi': 0.8926946052079195}
[S17] START round=18 head_norm_before_train=1.760108 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.6231491722001764, 'auprc': 0.8373432246887242, 'loss_val': 0.8763132338329219, 'psi': 0.7088267931955956}-{'f1_val': 0.6052424595217459, 'auprc': 0.8620323558765126, 'loss_val': 0.6518186166822584, 'psi': 0.7079584180636527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:40413
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:40416
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1807 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1807) from S2
[S8] cosine check vs S2: cos=-0.0861
[S8] DROPPED delta from S2 (cos=-0.0861 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1803) from S9
[S13] cosine check vs S9: cos=0.9403
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=0.7486
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] cosine check vs S15: cos=0.5371
[S4] RECEIVED delta(kind=head bytes=1799) from S14
[S4] cosine check vs S14: cos=0.9681
[S11] RECEIVED delta(kind=head bytes=1793) from S6
[S11] cosine check vs S6: cos=0.9907
[S9] RECEIVED delta(kind=head bytes=1798) from S4
[S9] cosine check vs S4: cos=-0.0924
[S9] DROPPED delta from S4 (cos=-0.0924 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=0.7257
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.7019 head_norm=1.495097
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.022376e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.7019 head_norm=1.492047 delta_norm=0.102238
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9534 head_norm=1.296267
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.628615e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9505 head_norm=1.254120 delta_norm=0.162861
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.6266 head_norm=1.161170
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.997452e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6277 head_norm=1.138123 delta_norm=0.199745
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9958 head_norm=1.149837
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.837371e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9967 head_norm=1.181183 delta_norm=0.483737
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.8589 head_norm=0.990668
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.352934e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.9104 head_norm=1.033383 delta_norm=0.335293
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.864150 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.6542005938369688, 'auprc': 0.7169692389858736, 'loss_val': 1.2502501822539789, 'psi': 0.6793080518965308}-{'f1_val': 0.7189735309036235, 'auprc': 0.7129753799492609, 'loss_val': 1.1205498781467325, 'psi': 0.7165742705218785}
[S3] START round=19 head_norm_before_train=1.702908 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.570245241527106, 'auprc': 0.8939834438641352, 'loss_val': 0.5361224862189937, 'psi': 0.6997405224619178}-{'f1_val': 0.6818995468279534, 'auprc': 0.9878169396246934, 'loss_val': 0.32697103291488633, 'psi': 0.8042665039466494}
[S4] START round=19 head_norm_before_train=1.254120 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.013699 metrics={'f1_val': 0.9535209792613468, 'auprc': 0.9488725579704245, 'loss_val': 0.41849590618667065, 'psi': 0.9516616107449778}-{'f1_val': 0.9533570386486316, 'auprc': 0.9491315657088497, 'loss_val': 0.44568730956206803, 'psi': 0.9516668494727188}
[S5] START round=19 head_norm_before_train=1.391497 cos_to_last_merge=0.8670 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.867
[S5] round=19 local utility u=0.008567 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.998022111607914, 'loss_val': 0.29661501364914655, 'psi': 0.8195738802407702}-{'f1_val': 0.7008563225598777, 'auprc': 0.9979899124495102, 'loss_val': 0.3151390285297392, 'psi': 0.8197097585157307}
[S6] START round=19 head_norm_before_train=1.495994 cos_to_last_merge=0.8429 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.843
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.651548635949152, 'auprc': 0.8042382396632289, 'loss_val': 0.5211256921903243, 'psi': 0.7126244774347827}-{'f1_val': 0.8014092891513536, 'auprc': 0.9425030781554171, 'loss_val': 0.3594133747098369, 'psi': 0.857846804752979}
[S7] START round=19 head_norm_before_train=1.603057 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.5358282726313575, 'auprc': 0.7252182644994607, 'loss_val': 0.8581544243618204, 'psi': 0.6115842693785988}-{'f1_val': 0.5693039153955775, 'auprc': 0.643311339614626, 'loss_val': 0.7326714777056166, 'psi': 0.5989068850831969}
[S8] START round=19 head_norm_before_train=1.990085 (no previous merge yet)
[S8] round=19 local utility u=0.000697 metrics={'f1_val': 0.9897367044659179, 'auprc': 0.9982283805857869, 'loss_val': 0.037903109311891676, 'psi': 0.9931333749138654}-{'f1_val': 0.9897367044659179, 'auprc': 0.9983985402174496, 'loss_val': 0.03980664969929747, 'psi': 0.9932014387665304}
[S9] START round=19 head_norm_before_train=1.181183 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9901183584159563, 'auprc': 0.9960755770844665, 'loss_val': 0.27965304032738025, 'psi': 0.9925012458833603}-{'f1_val': 0.9958267183641853, 'auprc': 0.998147414047753, 'loss_val': 0.280062208711275, 'psi': 0.9967549966376125}
[S10] START round=19 head_norm_before_train=1.742014 cos_to_last_merge=0.8048 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.805
[S10] round=19 local utility u=0.005852 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9951184647573408, 'loss_val': 0.040119096975045655, 'psi': 0.9948965514345598}-{'f1_val': 0.9936959108080994, 'auprc': 0.9951973752384325, 'loss_val': 0.04574289391968495, 'psi': 0.9942964965802326}
[S11] START round=19 head_norm_before_train=1.492047 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.001341 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9984793619139577, 'loss_val': 0.2899808670420475, 'psi': 0.8205529347445751}-{'f1_val': 0.7019353166316534, 'auprc': 0.9983806737628151, 'loss_val': 0.2923667489723145, 'psi': 0.8205134594841181}
[S13] START round=19 head_norm_before_train=1.138123 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6336411179910744, 'auprc': 0.6217933291515811, 'loss_val': 0.6472069887840416, 'psi': 0.6289020024552772}-{'f1_val': 0.6266433541500507, 'auprc': 0.6768761958177453, 'loss_val': 0.6748946692225342, 'psi': 0.6467364908171285}
[S14] START round=19 head_norm_before_train=1.232224 cos_to_last_merge=0.9981 (last merge round=17)
[S14] round=19 local utility u=0.024432 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9986906396253006, 'loss_val': 0.14606250379657595, 'psi': 0.9978204698735961}-{'f1_val': 0.9976737714957896, 'auprc': 0.9969876383062616, 'loss_val': 0.19241702810719571, 'psi': 0.9973993182199783}
[S15] START round=19 head_norm_before_train=1.972794 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.7010035278053174, 'auprc': 0.875199431368002, 'loss_val': 0.5398860942758912, 'psi': 0.7706818892303913}-{'f1_val': 0.8198164488633823, 'auprc': 0.9885007097307862, 'loss_val': 0.2160986876049839, 'psi': 0.8872901532103439}
[S16] START round=19 head_norm_before_train=1.033383 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8287090019065817, 'auprc': 0.8506333915248632, 'loss_val': 0.848474118810174, 'psi': 0.8374787577538942}-{'f1_val': 0.8589484874804592, 'auprc': 0.9313638048906712, 'loss_val': 0.6440771041466985, 'psi': 0.887914614444544}
[S17] START round=19 head_norm_before_train=1.792154 (no previous merge yet)
[S17] round=19 local utility u=0.008169 metrics={'f1_val': 0.632362064239216, 'auprc': 0.85383294019493, 'loss_val': 0.9647226403103826, 'psi': 0.7209504146215016}-{'f1_val': 0.6231491722001764, 'auprc': 0.8373432246887242, 'loss_val': 0.8763132338329219, 'psi': 0.7088267931955956}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] cosine check vs S4: cos=-0.0756
[S9] DROPPED delta from S4 (cos=-0.0756 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=-0.0634
[S17] DROPPED delta from S8 (cos=-0.0634 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.7197
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.6861
[S4] RECEIVED delta(kind=head bytes=1800) from S14
[S4] cosine check vs S14: cos=0.9772
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.9308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.3693
[S3] r=20 psi=0.700 u=0.0000 p_local=0.1065 f1=0.570 auprc=0.894 bytes=19784
[S7] r=20 psi=0.612 u=0.0000 p_local=0.1285 f1=0.536 auprc=0.725 bytes=19727
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9901 head_norm=1.217373
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.383790e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9910 head_norm=1.151769 delta_norm=0.338379
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] r=20 psi=0.993 u=0.0000 p_local=0.2852 f1=0.990 auprc=0.996 bytes=16178
[S6] r=20 psi=0.713 u=0.0000 p_local=0.1955 f1=0.652 auprc=0.804 bytes=17927
[S2] r=20 psi=0.679 u=0.0000 p_local=0.1009 f1=0.654 auprc=0.717 bytes=10794
[S13] r=20 psi=0.629 u=0.0000 p_local=0.0938 f1=0.634 auprc=0.622 bytes=17976
[S15] r=20 psi=0.771 u=0.0000 p_local=0.1958 f1=0.701 auprc=0.875 bytes=19790
[S5] r=20 psi=0.820 u=0.0086 p_local=0.1375 f1=0.701 auprc=0.998 bytes=19781
[S10] r=20 psi=0.995 u=0.0059 p_local=0.0726 f1=0.995 auprc=0.995 bytes=21587
[S11] r=20 psi=0.821 u=0.0013 p_local=0.0832 f1=0.702 auprc=0.998 bytes=23326
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9972 head_norm=1.285690
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.363063e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9972 head_norm=1.223796 delta_norm=0.136306
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S14] r=20 psi=0.998 u=0.0244 p_local=0.2027 f1=0.997 auprc=0.999 bytes=25157
[S8] r=20 psi=0.993 u=0.0007 p_local=0.0577 f1=0.990 auprc=0.998 bytes=21575
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9535 head_norm=1.326357
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.408594e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9528 head_norm=1.298565 delta_norm=0.140859
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.952 u=0.0137 p_local=0.2032 f1=0.954 auprc=0.949 bytes=21579
[S16] r=20 psi=0.837 u=0.0000 p_local=0.2609 f1=0.829 auprc=0.851 bytes=21558
[S17] r=20 psi=0.721 u=0.0082 p_local=0.1653 f1=0.632 auprc=0.854 bytes=16168
[S2] START round=20 head_norm_before_train=1.883457 (no previous merge yet)
[S2] round=20 local utility u=0.225547 metrics={'f1_val': 0.7120609630907394, 'auprc': 0.7162292906333907, 'loss_val': 1.1440985212262662, 'psi': 0.7137282941077999}-{'f1_val': 0.6542005938369688, 'auprc': 0.7169692389858736, 'loss_val': 1.2502501822539789, 'psi': 0.6793080518965308}
[S3] START round=20 head_norm_before_train=1.718931 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.48638787416035373, 'auprc': 0.8581941995702315, 'loss_val': 0.6965847866589442, 'psi': 0.6351104043243048}-{'f1_val': 0.570245241527106, 'auprc': 0.8939834438641352, 'loss_val': 0.5361224862189937, 'psi': 0.6997405224619178}
[S4] START round=20 head_norm_before_train=1.298565 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.027714 metrics={'f1_val': 0.9530687283528041, 'auprc': 0.9528610512092952, 'loss_val': 0.37232000757316935, 'psi': 0.9529856574954005}-{'f1_val': 0.9535209792613468, 'auprc': 0.9488725579704245, 'loss_val': 0.41849590618667065, 'psi': 0.9516616107449778}
[S5] START round=20 head_norm_before_train=1.412504 cos_to_last_merge=0.8576 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.858
[S5] round=20 local utility u=0.005162 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9978985847723978, 'loss_val': 0.2859209114333547, 'psi': 0.8195244695065638}-{'f1_val': 0.7006083926626743, 'auprc': 0.998022111607914, 'loss_val': 0.29661501364914655, 'psi': 0.8195738802407702}
[S6] START round=20 head_norm_before_train=1.520428 cos_to_last_merge=0.8389 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.839
[S6] round=20 local utility u=0.539578 metrics={'f1_val': 0.7643407215857548, 'auprc': 0.9044825256298235, 'loss_val': 0.4194544336654356, 'psi': 0.8203974432033823}-{'f1_val': 0.651548635949152, 'auprc': 0.8042382396632289, 'loss_val': 0.5211256921903243, 'psi': 0.7126244774347827}
[S7] START round=20 head_norm_before_train=1.610765 (no previous merge yet)
[S7] round=20 local utility u=0.739340 metrics={'f1_val': 0.6799282074233075, 'auprc': 0.8044573352571607, 'loss_val': 0.4817914590595849, 'psi': 0.7297398585568489}-{'f1_val': 0.5358282726313575, 'auprc': 0.7252182644994607, 'loss_val': 0.8581544243618204, 'psi': 0.6115842693785988}
[S8] START round=20 head_norm_before_train=2.006218 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9886580135784452, 'auprc': 0.998258537250104, 'loss_val': 0.03911612102669313, 'psi': 0.9924982230471087}-{'f1_val': 0.9897367044659179, 'auprc': 0.9982283805857869, 'loss_val': 0.037903109311891676, 'psi': 0.9931333749138654}
[S9] START round=20 head_norm_before_train=1.151769 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.047233 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9981370283608244, 'loss_val': 0.2330890618826378, 'psi': 0.9974976592659499}-{'f1_val': 0.9901183584159563, 'auprc': 0.9960755770844665, 'loss_val': 0.27965304032738025, 'psi': 0.9925012458833603}
[S10] START round=20 head_norm_before_train=1.755632 cos_to_last_merge=0.8033 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.803
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9320614662750695, 'auprc': 0.9922029132722674, 'loss_val': 0.16357847889941304, 'psi': 0.9561180450739486}-{'f1_val': 0.9947486092193725, 'auprc': 0.9951184647573408, 'loss_val': 0.040119096975045655, 'psi': 0.9948965514345598}
[S11] START round=20 head_norm_before_train=1.511810 cos_to_last_merge=0.9998 (last merge round=18)
[S11] round=20 local utility u=0.011481 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9984925103271982, 'loss_val': 0.2670582260383987, 'psi': 0.8205581941098714}-{'f1_val': 0.7019353166316534, 'auprc': 0.9984793619139577, 'loss_val': 0.2899808670420475, 'psi': 0.8205529347445751}
[S13] START round=20 head_norm_before_train=1.184273 cos_to_last_merge=0.9968 (last merge round=18)
[S13] round=20 local utility u=0.068523 metrics={'f1_val': 0.6312828866611404, 'auprc': 0.6787413622338806, 'loss_val': 0.6668564462620319, 'psi': 0.6502662768902365}-{'f1_val': 0.6336411179910744, 'auprc': 0.6217933291515811, 'loss_val': 0.6472069887840416, 'psi': 0.6289020024552772}
[S14] START round=20 head_norm_before_train=1.223796 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9969510747303717, 'loss_val': 0.14205578638421104, 'psi': 0.9972390601965263}-{'f1_val': 0.997240356705793, 'auprc': 0.9986906396253006, 'loss_val': 0.14606250379657595, 'psi': 0.9978204698735961}
[S15] START round=20 head_norm_before_train=1.998401 (no previous merge yet)
[S15] round=20 local utility u=0.060047 metrics={'f1_val': 0.7010035278053174, 'auprc': 0.9108500721337535, 'loss_val': 0.5267440999399766, 'psi': 0.7849421455366918}-{'f1_val': 0.7010035278053174, 'auprc': 0.875199431368002, 'loss_val': 0.5398860942758912, 'psi': 0.7706818892303913}
[S16] START round=20 head_norm_before_train=1.080072 cos_to_last_merge=0.9930 (last merge round=18)
[S16] round=20 local utility u=0.595433 metrics={'f1_val': 0.9062524034084614, 'auprc': 0.9815300037065927, 'loss_val': 0.5155579992373328, 'psi': 0.9363634435277138}-{'f1_val': 0.8287090019065817, 'auprc': 0.8506333915248632, 'loss_val': 0.848474118810174, 'psi': 0.8374787577538942}
[S17] START round=20 head_norm_before_train=1.831744 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.6335407291976263, 'auprc': 0.8487318229526808, 'loss_val': 1.0464319757587213, 'psi': 0.719617166699648}-{'f1_val': 0.632362064239216, 'auprc': 0.85383294019493, 'loss_val': 0.9647226403103826, 'psi': 0.7209504146215016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:40409
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:40414
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:40409
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1807 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=-0.0669
[S10] DROPPED delta from S7 (cos=-0.0669 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=0.9916
[S16] RECEIVED delta(kind=head bytes=1800) from S15
[S16] cosine check vs S15: cos=0.7047
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=0.6726
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.8082
[S9] RECEIVED delta(kind=head bytes=1803) from S4
[S9] cosine check vs S4: cos=-0.0839
[S9] DROPPED delta from S4 (cos=-0.0839 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1807) from S2
[S8] cosine check vs S2: cos=-0.0867
[S8] DROPPED delta from S2 (cos=-0.0867 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S16
[S8] cosine check vs S16: cos=-0.0527
[S8] DROPPED delta from S16 (cos=-0.0527 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] cosine check vs S13: cos=0.6128
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.9404
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.085 → S4@127.0.0.1:40404
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9974 head_norm=1.270938
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.793699e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9974 head_norm=1.282659 delta_norm=0.579370
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.162 → S4@127.0.0.1:40404
[S8] ⇄ pheromone p=0.046 → S17@127.0.0.1:40417
[S10] ⇄ pheromone p=0.058 → S14@127.0.0.1:40414
[S2] ⇄ pheromone p=0.126 → S8@127.0.0.1:40409
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9971 head_norm=1.195882
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.223695e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9967 head_norm=1.250340 delta_norm=0.422369
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.238 → S13@127.0.0.1:40413
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9063 head_norm=1.144465
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.654780e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9024 head_norm=1.147613 delta_norm=0.265478
[S16] aggregate: ACCEPT kept=['S15', 'S13'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.328 → S8@127.0.0.1:40409
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.7019 head_norm=1.531824
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.947307e-02
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.7019 head_norm=1.532212 delta_norm=0.099473
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.069 → S14@127.0.0.1:40414
[S5] ⇄ pheromone p=0.111 → S9@127.0.0.1:40410
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.6313 head_norm=1.235394
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.107869e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.6317 head_norm=1.197387 delta_norm=0.210787
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.089 → S16@127.0.0.1:40416
[S6] ⇄ pheromone p=0.264 → S11@127.0.0.1:40412
[S7] ⇄ pheromone p=0.251 → S10@127.0.0.1:40411
[S15] ⇄ pheromone p=0.169 → S16@127.0.0.1:40416
[S4] ⇄ pheromone p=0.168 → S9@127.0.0.1:40410
[S17] ⇄ pheromone p=0.132 → S9@127.0.0.1:40410
[S2] START round=21 head_norm_before_train=1.902454 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6533620112701838, 'auprc': 0.7161318131898115, 'loss_val': 1.2868874460242732, 'psi': 0.6784699320380349}-{'f1_val': 0.7120609630907394, 'auprc': 0.7162292906333907, 'loss_val': 1.1440985212262662, 'psi': 0.7137282941077999}
[S3] START round=21 head_norm_before_train=1.733800 (no previous merge yet)
[S3] round=21 local utility u=1.000000 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9943529470234813, 'loss_val': 0.2754073447422669, 'psi': 0.8179397302213097}-{'f1_val': 0.48638787416035373, 'auprc': 0.8581941995702315, 'loss_val': 0.6965847866589442, 'psi': 0.6351104043243048}
[S4] START round=21 head_norm_before_train=1.374004 cos_to_last_merge=0.9962 (last merge round=19)
[S4] round=21 local utility u=0.043864 metrics={'f1_val': 0.9558521352949725, 'auprc': 0.9597835037237898, 'loss_val': 0.32205982608621614, 'psi': 0.9574246826664994}-{'f1_val': 0.9530687283528041, 'auprc': 0.9528610512092952, 'loss_val': 0.37232000757316935, 'psi': 0.9529856574954005}
[S5] START round=21 head_norm_before_train=1.432954 cos_to_last_merge=0.8491 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.849
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.714400588689728, 'auprc': 0.7948038159074037, 'loss_val': 0.37727478102523926, 'psi': 0.7465618795767983}-{'f1_val': 0.7006083926626743, 'auprc': 0.9978985847723978, 'loss_val': 0.2859209114333547, 'psi': 0.8195244695065638}
[S6] START round=21 head_norm_before_train=1.539043 cos_to_last_merge=0.8355 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.836
[S6] round=21 local utility u=0.792733 metrics={'f1_val': 0.9619332505158622, 'auprc': 0.9636065174604511, 'loss_val': 0.19691504388199402, 'psi': 0.9626025572936978}-{'f1_val': 0.7643407215857548, 'auprc': 0.9044825256298235, 'loss_val': 0.4194544336654356, 'psi': 0.8203974432033823}
[S7] START round=21 head_norm_before_train=1.617035 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.6330551353174125, 'auprc': 0.7875733630985824, 'loss_val': 0.6010320150024342, 'psi': 0.6948624264298805}-{'f1_val': 0.6799282074233075, 'auprc': 0.8044573352571607, 'loss_val': 0.4817914590595849, 'psi': 0.7297398585568489}
[S8] START round=21 head_norm_before_train=2.020999 (no previous merge yet)
[S8] round=21 local utility u=0.015684 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9979254769221929, 'loss_val': 0.03281182562475147, 'psi': 0.9949712654605496}-{'f1_val': 0.9886580135784452, 'auprc': 0.998258537250104, 'loss_val': 0.03911612102669313, 'psi': 0.9924982230471087}
[S9] START round=21 head_norm_before_train=1.250340 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9867176631020987, 'auprc': 0.9970610632322155, 'loss_val': 0.2378061238819003, 'psi': 0.9908550231541455}-{'f1_val': 0.9970714132027002, 'auprc': 0.9981370283608244, 'loss_val': 0.2330890618826378, 'psi': 0.9974976592659499}
[S10] START round=21 head_norm_before_train=1.774355 cos_to_last_merge=0.8012 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.801
[S10] round=21 local utility u=0.256301 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9950559457338461, 'loss_val': 0.037787006691052165, 'psi': 0.9950844591391974}-{'f1_val': 0.9320614662750695, 'auprc': 0.9922029132722674, 'loss_val': 0.16357847889941304, 'psi': 0.9561180450739486}
[S11] START round=21 head_norm_before_train=1.532212 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.006704 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9984398589985144, 'loss_val': 0.2534916972268851, 'psi': 0.8205371335783977}-{'f1_val': 0.7019353166316534, 'auprc': 0.9984925103271982, 'loss_val': 0.2670582260383987, 'psi': 0.8205581941098714}
[S13] START round=21 head_norm_before_train=1.197387 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6311501392871979, 'auprc': 0.6235412613131253, 'loss_val': 0.7091988396041616, 'psi': 0.6281065880975688}-{'f1_val': 0.6312828866611404, 'auprc': 0.6787413622338806, 'loss_val': 0.6668564462620319, 'psi': 0.6502662768902365}
[S14] START round=21 head_norm_before_train=1.282659 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9947368952937303, 'auprc': 0.9959295747371155, 'loss_val': 0.19286810367285182, 'psi': 0.9952139670710843}-{'f1_val': 0.9974310505072961, 'auprc': 0.9969510747303717, 'loss_val': 0.14205578638421104, 'psi': 0.9972390601965263}
[S15] START round=21 head_norm_before_train=2.016809 (no previous merge yet)
[S15] round=21 local utility u=0.947234 metrics={'f1_val': 0.936777692952783, 'auprc': 0.9738997057838373, 'loss_val': 0.2360704344452135, 'psi': 0.9516264980852047}-{'f1_val': 0.7010035278053174, 'auprc': 0.9108500721337535, 'loss_val': 0.5267440999399766, 'psi': 0.7849421455366918}
[S16] START round=21 head_norm_before_train=1.147613 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.7804076776592067, 'auprc': 0.9106141686108631, 'loss_val': 0.6639466123505398, 'psi': 0.8324902740398693}-{'f1_val': 0.9062524034084614, 'auprc': 0.9815300037065927, 'loss_val': 0.5155579992373328, 'psi': 0.9363634435277138}
[S17] START round=21 head_norm_before_train=1.863906 (no previous merge yet)
[S17] round=21 local utility u=0.047060 metrics={'f1_val': 0.6406262098138383, 'auprc': 0.8599345875510988, 'loss_val': 1.028432732017224, 'psi': 0.7283495609087425}-{'f1_val': 0.6335407291976263, 'auprc': 0.8487318229526808, 'loss_val': 1.0464319757587213, 'psi': 0.719617166699648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:40417
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:40412
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S4
[S9] cosine check vs S4: cos=-0.0634
[S9] DROPPED delta from S4 (cos=-0.0634 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S3
[S4] cosine check vs S3: cos=-0.0767
[S4] DROPPED delta from S3 (cos=-0.0767 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] cosine check vs S15: cos=0.7868
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=-0.0652
[S17] DROPPED delta from S8 (cos=-0.0652 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] cosine check vs S6: cos=0.9955
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.4039
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=0.9179
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.3275
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9947 head_norm=1.325001
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.969952e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9947 head_norm=1.229737 delta_norm=0.296995
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9867 head_norm=1.288936
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.517707e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9871 head_norm=1.304405 delta_norm=0.951771
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.7804 head_norm=1.203340
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.575003e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8194 head_norm=1.535040 delta_norm=0.657500
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.7019 head_norm=1.554772
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.387655e-02
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.7019 head_norm=1.554828 delta_norm=0.073877
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.919238 (no previous merge yet)
[S2] round=22 local utility u=0.202231 metrics={'f1_val': 0.706194194052427, 'auprc': 0.7139373512173155, 'loss_val': 1.1928352112090168, 'psi': 0.7092914569183824}-{'f1_val': 0.6533620112701838, 'auprc': 0.7161318131898115, 'loss_val': 1.2868874460242732, 'psi': 0.6784699320380349}
[S3] START round=22 head_norm_before_train=1.751435 (no previous merge yet)
[S3] round=22 local utility u=0.028022 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9956916404196876, 'loss_val': 0.22638464957875762, 'psi': 0.8187756971831615}-{'f1_val': 0.700330919019862, 'auprc': 0.9943529470234813, 'loss_val': 0.2754073447422669, 'psi': 0.8179397302213097}
[S4] START round=22 head_norm_before_train=1.444039 cos_to_last_merge=0.9889 (last merge round=19)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9539983624764657, 'auprc': 0.9491318485688132, 'loss_val': 0.3038667698628852, 'psi': 0.9520517569134047}-{'f1_val': 0.9558521352949725, 'auprc': 0.9597835037237898, 'loss_val': 0.32205982608621614, 'psi': 0.9574246826664994}
[S5] START round=22 head_norm_before_train=1.454028 cos_to_last_merge=0.8458 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.846
[S5] round=22 local utility u=0.320517 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9962578568910323, 'loss_val': 0.25784920105954184, 'psi': 0.8188681783540175}-{'f1_val': 0.714400588689728, 'auprc': 0.7948038159074037, 'loss_val': 0.37727478102523926, 'psi': 0.7465618795767983}
[S6] START round=22 head_norm_before_train=1.558390 cos_to_last_merge=0.8325 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.832
[S6] round=22 local utility u=0.004243 metrics={'f1_val': 0.9618014487838888, 'auprc': 0.9668868074559943, 'loss_val': 0.19747988429653496, 'psi': 0.9638355922527311}-{'f1_val': 0.9619332505158622, 'auprc': 0.9636065174604511, 'loss_val': 0.19691504388199402, 'psi': 0.9626025572936978}
[S7] START round=22 head_norm_before_train=1.627799 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.6037055848695977, 'auprc': 0.7907520935019556, 'loss_val': 0.6466719966896974, 'psi': 0.6785241883225409}-{'f1_val': 0.6330551353174125, 'auprc': 0.7875733630985824, 'loss_val': 0.6010320150024342, 'psi': 0.6948624264298805}
[S8] START round=22 head_norm_before_train=2.029850 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9886580135784452, 'auprc': 0.9983722157123931, 'loss_val': 0.03954064691289242, 'psi': 0.9925436944320243}-{'f1_val': 0.9930017911527874, 'auprc': 0.9979254769221929, 'loss_val': 0.03281182562475147, 'psi': 0.9949712654605496}
[S9] START round=22 head_norm_before_train=1.304405 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.054577 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9978242549652854, 'loss_val': 0.190599662245316, 'psi': 0.997126009074449}-{'f1_val': 0.9867176631020987, 'auprc': 0.9970610632322155, 'loss_val': 0.2378061238819003, 'psi': 0.9908550231541455}
[S10] START round=22 head_norm_before_train=1.788739 cos_to_last_merge=0.7996 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.800
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9859720977086246, 'auprc': 0.9950481680318162, 'loss_val': 0.0681488435824372, 'psi': 0.9896025258379012}-{'f1_val': 0.9951034680760983, 'auprc': 0.9950559457338461, 'loss_val': 0.037787006691052165, 'psi': 0.9950844591391974}
[S11] START round=22 head_norm_before_train=1.554828 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.7009724449445034, 'auprc': 0.9984936094588539, 'loss_val': 0.2573516486908576, 'psi': 0.8199809107502436}-{'f1_val': 0.7019353166316534, 'auprc': 0.9984398589985144, 'loss_val': 0.2534916972268851, 'psi': 0.8205371335783977}
[S13] START round=22 head_norm_before_train=1.242286 cos_to_last_merge=0.9976 (last merge round=20)
[S13] round=22 local utility u=0.072098 metrics={'f1_val': 0.6270620942629093, 'auprc': 0.6894414488057133, 'loss_val': 0.7381755026713495, 'psi': 0.6520138360800309}-{'f1_val': 0.6311501392871979, 'auprc': 0.6235412613131253, 'loss_val': 0.7091988396041616, 'psi': 0.6281065880975688}
[S14] START round=22 head_norm_before_train=1.229737 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.021800 metrics={'f1_val': 0.9963900223018398, 'auprc': 0.9953806575613171, 'loss_val': 0.1575392311454349, 'psi': 0.9959862764056308}-{'f1_val': 0.9947368952937303, 'auprc': 0.9959295747371155, 'loss_val': 0.19286810367285182, 'psi': 0.9952139670710843}
[S15] START round=22 head_norm_before_train=2.032064 (no previous merge yet)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.8184314212141409, 'loss_val': 0.6167243885846784, 'psi': 0.7479227547874305}-{'f1_val': 0.936777692952783, 'auprc': 0.9738997057838373, 'loss_val': 0.2360704344452135, 'psi': 0.9516264980852047}
[S16] START round=22 head_norm_before_train=1.535040 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.855783 metrics={'f1_val': 0.9687710963414109, 'auprc': 0.9925188987846736, 'loss_val': 0.3282746742424949, 'psi': 0.978270217318716}-{'f1_val': 0.7804076776592067, 'auprc': 0.9106141686108631, 'loss_val': 0.6639466123505398, 'psi': 0.8324902740398693}
[S17] START round=22 head_norm_before_train=1.885026 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.6328664829187028, 'auprc': 0.8531241567721219, 'loss_val': 1.1605159273773236, 'psi': 0.7209695524600706}-{'f1_val': 0.6406262098138383, 'auprc': 0.8599345875510988, 'loss_val': 1.028432732017224, 'psi': 0.7283495609087425}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:40409
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] → sending delta(kind=head bytes=1808) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:40416
[S6] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1808 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=-0.0873
[S8] DROPPED delta from S2 (cos=-0.0873 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S16
[S8] cosine check vs S16: cos=-0.0663
[S8] DROPPED delta from S16 (cos=-0.0663 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S6
[S11] cosine check vs S6: cos=0.9972
[S13] RECEIVED delta(kind=head bytes=1806) from S9
[S13] cosine check vs S9: cos=0.8885
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] cosine check vs S13: cos=0.2610
[S4] RECEIVED delta(kind=head bytes=1804) from S3
[S4] cosine check vs S3: cos=-0.0783
[S4] DROPPED delta from S3 (cos=-0.0783 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S14
[S4] cosine check vs S14: cos=0.9425
[S9] RECEIVED delta(kind=head bytes=1808) from S5
[S9] cosine check vs S5: cos=0.5104
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.7010 head_norm=1.578400
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.913097e-02
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.7000 head_norm=1.574255 delta_norm=0.059131
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9540 head_norm=1.493921
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.589997e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9539 head_norm=1.362378 delta_norm=0.259000
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.6271 head_norm=1.282806
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.111100e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.6187 head_norm=1.274992 delta_norm=0.311110
[S13] aggregate: ROLLBACK (f1_val pre=0.627 post=0.619 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9967 head_norm=1.341341
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.982511e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9967 head_norm=1.222769 delta_norm=0.698251
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.9688 head_norm=1.577899
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.772909e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.9739 head_norm=1.139315 delta_norm=0.877291
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.941573 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.6782034198606475, 'auprc': 0.7045070201772625, 'loss_val': 1.2878636457433579, 'psi': 0.6887248599872935}-{'f1_val': 0.706194194052427, 'auprc': 0.7139373512173155, 'loss_val': 1.1928352112090168, 'psi': 0.7092914569183824}
[S3] START round=23 head_norm_before_train=1.768348 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.6965568592080547, 'auprc': 0.9943601924846207, 'loss_val': 0.2157117826510454, 'psi': 0.8156781925186811}-{'f1_val': 0.7008317350254774, 'auprc': 0.9956916404196876, 'loss_val': 0.22638464957875762, 'psi': 0.8187756971831615}
[S4] START round=23 head_norm_before_train=1.362378 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.951410145345347, 'auprc': 0.9369404176176067, 'loss_val': 0.3173760371086996, 'psi': 0.945622254254251}-{'f1_val': 0.9539983624764657, 'auprc': 0.9491318485688132, 'loss_val': 0.3038667698628852, 'psi': 0.9520517569134047}
[S5] START round=23 head_norm_before_train=1.471816 cos_to_last_merge=0.8444 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.844
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7030098921427921, 'auprc': 0.9862174654768397, 'loss_val': 0.25719657186766987, 'psi': 0.8162929214764112}-{'f1_val': 0.7006083926626743, 'auprc': 0.9962578568910323, 'loss_val': 0.25784920105954184, 'psi': 0.8188681783540175}
[S6] START round=23 head_norm_before_train=1.572323 cos_to_last_merge=0.8305 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.830
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.8315835526239184, 'auprc': 0.9518596136168986, 'loss_val': 0.3224661779040933, 'psi': 0.8796939770211105}-{'f1_val': 0.9618014487838888, 'auprc': 0.9668868074559943, 'loss_val': 0.19747988429653496, 'psi': 0.9638355922527311}
[S7] START round=23 head_norm_before_train=1.641410 (no previous merge yet)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.5609066630639025, 'auprc': 0.7828699876310155, 'loss_val': 0.8014440942765614, 'psi': 0.6496919928907476}-{'f1_val': 0.6037055848695977, 'auprc': 0.7907520935019556, 'loss_val': 0.6466719966896974, 'psi': 0.6785241883225409}
[S8] START round=23 head_norm_before_train=2.041522 (no previous merge yet)
[S8] round=23 local utility u=0.007397 metrics={'f1_val': 0.9904161809363135, 'auprc': 0.9982680584573067, 'loss_val': 0.034982493333865945, 'psi': 0.9935569319447107}-{'f1_val': 0.9886580135784452, 'auprc': 0.9983722157123931, 'loss_val': 0.03954064691289242, 'psi': 0.9925436944320243}
[S9] START round=23 head_norm_before_train=1.222769 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9909631199453779, 'auprc': 0.9978692940316854, 'loss_val': 0.1938056237478564, 'psi': 0.9937255895799009}-{'f1_val': 0.9966605118138915, 'auprc': 0.9978242549652854, 'loss_val': 0.190599662245316, 'psi': 0.997126009074449}
[S10] START round=23 head_norm_before_train=1.803676 cos_to_last_merge=0.7980 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.798
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9176273685498817, 'auprc': 0.9929352351803568, 'loss_val': 0.21122691935684948, 'psi': 0.9477505152020718}-{'f1_val': 0.9859720977086246, 'auprc': 0.9950481680318162, 'loss_val': 0.0681488435824372, 'psi': 0.9896025258379012}
[S11] START round=23 head_norm_before_train=1.574255 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.013890 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.998394991996966, 'loss_val': 0.23505378099287053, 'psi': 0.8205191867777785}-{'f1_val': 0.7009724449445034, 'auprc': 0.9984936094588539, 'loss_val': 0.2573516486908576, 'psi': 0.8199809107502436}
[S13] START round=23 head_norm_before_train=1.274992 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6331666884544602, 'auprc': 0.611243813496152, 'loss_val': 0.6898311467957186, 'psi': 0.6243975384711369}-{'f1_val': 0.6270620942629093, 'auprc': 0.6894414488057133, 'loss_val': 0.7381755026713495, 'psi': 0.6520138360800309}
[S14] START round=23 head_norm_before_train=1.270634 cos_to_last_merge=0.9991 (last merge round=21)
[S14] round=23 local utility u=0.025719 metrics={'f1_val': 0.9972183481640888, 'auprc': 0.998437947038766, 'loss_val': 0.12024257357092534, 'psi': 0.9977061877139597}-{'f1_val': 0.9963900223018398, 'auprc': 0.9953806575613171, 'loss_val': 0.1575392311454349, 'psi': 0.9959862764056308}
[S15] START round=23 head_norm_before_train=2.041531 (no previous merge yet)
[S15] round=23 local utility u=1.000000 metrics={'f1_val': 0.9961900430063055, 'auprc': 0.9907217558984086, 'loss_val': 0.027421189434111825, 'psi': 0.9940027281631467}-{'f1_val': 0.7009169771696235, 'auprc': 0.8184314212141409, 'loss_val': 0.6167243885846784, 'psi': 0.7479227547874305}
[S16] START round=23 head_norm_before_train=1.139315 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8392664091080897, 'auprc': 0.9932146722262047, 'loss_val': 0.6538164832033261, 'psi': 0.9008457143553357}-{'f1_val': 0.9687710963414109, 'auprc': 0.9925188987846736, 'loss_val': 0.3282746742424949, 'psi': 0.978270217318716}
[S17] START round=23 head_norm_before_train=1.907775 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.6280663989969114, 'auprc': 0.851576151482418, 'loss_val': 1.1538336428076, 'psi': 0.7174702999911141}-{'f1_val': 0.6328664829187028, 'auprc': 0.8531241567721219, 'loss_val': 1.1605159273773236, 'psi': 0.7209695524600706}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:40414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:40416
[S15] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S15
[S16] cosine check vs S15: cos=0.6839
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=-0.0678
[S17] DROPPED delta from S8 (cos=-0.0678 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S14
[S4] cosine check vs S14: cos=0.9761
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=0.8004
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9514 head_norm=1.415061
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.573652e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9502 head_norm=1.356425 delta_norm=0.157365
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9972 head_norm=1.314117
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.796796e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9972 head_norm=1.382854 delta_norm=0.479680
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.8393 head_norm=1.186380
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.572623e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.8325 head_norm=1.496703 delta_norm=0.757262
[S16] aggregate: ROLLBACK (f1_val pre=0.839 post=0.833 tol_abs=0.005 tol_rel=0.0)
[S2] START round=24 head_norm_before_train=1.961162 (no previous merge yet)
[S2] round=24 local utility u=0.116842 metrics={'f1_val': 0.7048767162784988, 'auprc': 0.707688720399269, 'loss_val': 1.223765011491834, 'psi': 0.7060015179268069}-{'f1_val': 0.6782034198606475, 'auprc': 0.7045070201772625, 'loss_val': 1.2878636457433579, 'psi': 0.6887248599872935}
[S3] START round=24 head_norm_before_train=1.785805 (no previous merge yet)
[S3] round=24 local utility u=0.008135 metrics={'f1_val': 0.6937683940671988, 'auprc': 0.9953376880424697, 'loss_val': 0.18564278125003553, 'psi': 0.8143961116573071}-{'f1_val': 0.6965568592080547, 'auprc': 0.9943601924846207, 'loss_val': 0.2157117826510454, 'psi': 0.8156781925186811}
[S4] START round=24 head_norm_before_train=1.356425 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.008280 metrics={'f1_val': 0.9538529175451589, 'auprc': 0.9342826066278095, 'loss_val': 0.30750018925833594, 'psi': 0.9460247931782191}-{'f1_val': 0.951410145345347, 'auprc': 0.9369404176176067, 'loss_val': 0.3173760371086996, 'psi': 0.945622254254251}
[S5] START round=24 head_norm_before_train=1.485758 cos_to_last_merge=0.8428 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.843
[S5] round=24 local utility u=0.370667 metrics={'f1_val': 0.8459043406252879, 'auprc': 0.9496103233418917, 'loss_val': 0.2634078544468919, 'psi': 0.8873867337119294}-{'f1_val': 0.7030098921427921, 'auprc': 0.9862174654768397, 'loss_val': 0.25719657186766987, 'psi': 0.8162929214764112}
[S6] START round=24 head_norm_before_train=1.586303 cos_to_last_merge=0.8285 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.828
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.8247581850483889, 'auprc': 0.9529482077607113, 'loss_val': 0.33763343687062536, 'psi': 0.8760341941333178}-{'f1_val': 0.8315835526239184, 'auprc': 0.9518596136168986, 'loss_val': 0.3224661779040933, 'psi': 0.8796939770211105}
[S7] START round=24 head_norm_before_train=1.652979 (no previous merge yet)
[S7] round=24 local utility u=0.033505 metrics={'f1_val': 0.5651007345867463, 'auprc': 0.7874721117387772, 'loss_val': 0.7734056008295441, 'psi': 0.6540492854475586}-{'f1_val': 0.5609066630639025, 'auprc': 0.7828699876310155, 'loss_val': 0.8014440942765614, 'psi': 0.6496919928907476}
[S8] START round=24 head_norm_before_train=2.055482 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9854693365965349, 'auprc': 0.998490475204395, 'loss_val': 0.046882275259404416, 'psi': 0.990677792039679}-{'f1_val': 0.9904161809363135, 'auprc': 0.9982680584573067, 'loss_val': 0.034982493333865945, 'psi': 0.9935569319447107}
[S9] START round=24 head_norm_before_train=1.263231 cos_to_last_merge=0.9984 (last merge round=22)
[S9] round=24 local utility u=0.040696 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9978789302688585, 'loss_val': 0.1401227355384764, 'psi': 0.9964974074380522}-{'f1_val': 0.9909631199453779, 'auprc': 0.9978692940316854, 'loss_val': 0.1938056237478564, 'psi': 0.9937255895799009}
[S10] START round=24 head_norm_before_train=1.821305 cos_to_last_merge=0.7961 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.796
[S10] round=24 local utility u=0.316184 metrics={'f1_val': 0.9950782813056309, 'auprc': 0.9948623806073987, 'loss_val': 0.04934678954051091, 'psi': 0.994991921026338}-{'f1_val': 0.9176273685498817, 'auprc': 0.9929352351803568, 'loss_val': 0.21122691935684948, 'psi': 0.9477505152020718}
[S11] START round=24 head_norm_before_train=1.599329 cos_to_last_merge=0.9997 (last merge round=22)
[S11] round=24 local utility u=0.018262 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9982877233740948, 'loss_val': 0.19820699913147555, 'psi': 0.82047627932863}-{'f1_val': 0.7019353166316534, 'auprc': 0.998394991996966, 'loss_val': 0.23505378099287053, 'psi': 0.8205191867777785}
[S13] START round=24 head_norm_before_train=1.305554 cos_to_last_merge=0.9991 (last merge round=22)
[S13] round=24 local utility u=0.060658 metrics={'f1_val': 0.6223407303293372, 'auprc': 0.6581532543814066, 'loss_val': 0.6442880531572512, 'psi': 0.636665739950165}-{'f1_val': 0.6331666884544602, 'auprc': 0.611243813496152, 'loss_val': 0.6898311467957186, 'psi': 0.6243975384711369}
[S14] START round=24 head_norm_before_train=1.382854 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9969682102907778, 'auprc': 0.9966846857473939, 'loss_val': 0.167716997908157, 'psi': 0.9968548004734241}-{'f1_val': 0.9972183481640888, 'auprc': 0.998437947038766, 'loss_val': 0.12024257357092534, 'psi': 0.9977061877139597}
[S15] START round=24 head_norm_before_train=2.054175 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.8244743915306217, 'auprc': 0.9888800695667643, 'loss_val': 0.2593252166077742, 'psi': 0.8902366627450787}-{'f1_val': 0.9961900430063055, 'auprc': 0.9907217558984086, 'loss_val': 0.027421189434111825, 'psi': 0.9940027281631467}
[S16] START round=24 head_norm_before_train=1.496703 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.202005 metrics={'f1_val': 0.8843117759589356, 'auprc': 0.990183899300499, 'loss_val': 0.5109856599466615, 'psi': 0.926660625295561}-{'f1_val': 0.8392664091080897, 'auprc': 0.9932146722262047, 'loss_val': 0.6538164832033261, 'psi': 0.9008457143553357}
[S17] START round=24 head_norm_before_train=1.929091 (no previous merge yet)
[S17] round=24 local utility u=0.033004 metrics={'f1_val': 0.6342291686173824, 'auprc': 0.8605076652152274, 'loss_val': 1.1515975535748124, 'psi': 0.7247405672565204}-{'f1_val': 0.6280663989969114, 'auprc': 0.851576151482418, 'loss_val': 1.1538336428076, 'psi': 0.7174702999911141}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:40414
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:40409
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S16
[S8] cosine check vs S16: cos=-0.0621
[S8] DROPPED delta from S16 (cos=-0.0621 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S2
[S8] cosine check vs S2: cos=-0.0874
[S8] DROPPED delta from S2 (cos=-0.0874 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.9261
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=0.3333
[S10] RECEIVED delta(kind=head bytes=1793) from S7
[S10] cosine check vs S7: cos=-0.0656
[S10] DROPPED delta from S7 (cos=-0.0656 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=0.9523
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.3183
[S9] RECEIVED delta(kind=head bytes=1799) from S4
[S9] cosine check vs S4: cos=-0.0816
[S9] DROPPED delta from S4 (cos=-0.0816 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.8647
[S4] RECEIVED delta(kind=head bytes=1806) from S3
[S4] cosine check vs S3: cos=-0.0792
[S4] DROPPED delta from S3 (cos=-0.0792 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S17
[S9] cosine check vs S17: cos=0.5158
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9970 head_norm=1.412696
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.637878e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9970 head_norm=1.280325 delta_norm=0.363788
[S14] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.6223 head_norm=1.332674
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.539039e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.6339 head_norm=1.294627 delta_norm=0.253904
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.8843 head_norm=1.536962
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.325939e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.8816 head_norm=1.172998 delta_norm=0.832594
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9956 head_norm=1.305769
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.675716e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9962 head_norm=1.254823 delta_norm=0.267572
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.973495 (no previous merge yet)
[S2] round=25 local utility u=0.050886 metrics={'f1_val': 0.7181923610584895, 'auprc': 0.7050259379871052, 'loss_val': 1.1938983007277317, 'psi': 0.7129257918299359}-{'f1_val': 0.7048767162784988, 'auprc': 0.707688720399269, 'loss_val': 1.223765011491834, 'psi': 0.7060015179268069}
[S3] START round=25 head_norm_before_train=1.803681 (no previous merge yet)
[S3] round=25 local utility u=0.820799 metrics={'f1_val': 0.9583645500492921, 'auprc': 0.9985137109764709, 'loss_val': 0.14114984005135622, 'psi': 0.9744242144201636}-{'f1_val': 0.6937683940671988, 'auprc': 0.9953376880424697, 'loss_val': 0.18564278125003553, 'psi': 0.8143961116573071}
[S4] START round=25 head_norm_before_train=1.419592 cos_to_last_merge=0.9981 (last merge round=23)
[S4] round=25 local utility u=0.063371 metrics={'f1_val': 0.9588941189678216, 'auprc': 0.9560909621436704, 'loss_val': 0.27642990596366385, 'psi': 0.9577728562381611}-{'f1_val': 0.9538529175451589, 'auprc': 0.9342826066278095, 'loss_val': 0.30750018925833594, 'psi': 0.9460247931782191}
[S5] START round=25 head_norm_before_train=1.501268 cos_to_last_merge=0.8412 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.841
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9976794817848764, 'loss_val': 0.2112773264896753, 'psi': 0.8194368283115552}-{'f1_val': 0.8459043406252879, 'auprc': 0.9496103233418917, 'loss_val': 0.2634078544468919, 'psi': 0.8873867337119294}
[S6] START round=25 head_norm_before_train=1.608367 cos_to_last_merge=0.8250 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.825
[S6] round=25 local utility u=0.557169 metrics={'f1_val': 0.9609768503616756, 'auprc': 0.9857069897025053, 'loss_val': 0.1388845735979353, 'psi': 0.9708689060980075}-{'f1_val': 0.8247581850483889, 'auprc': 0.9529482077607113, 'loss_val': 0.33763343687062536, 'psi': 0.8760341941333178}
[S7] START round=25 head_norm_before_train=1.665531 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.5603576509362869, 'auprc': 0.7863165906576943, 'loss_val': 0.8102910096967842, 'psi': 0.6507412268248498}-{'f1_val': 0.5651007345867463, 'auprc': 0.7874721117387772, 'loss_val': 0.7734056008295441, 'psi': 0.6540492854475586}
[S8] START round=25 head_norm_before_train=2.070492 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.7138880036303916, 'auprc': 0.9810608778828864, 'loss_val': 0.6140050025545785, 'psi': 0.8207571533313895}-{'f1_val': 0.9854693365965349, 'auprc': 0.998490475204395, 'loss_val': 0.046882275259404416, 'psi': 0.990677792039679}
[S9] START round=25 head_norm_before_train=1.254823 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.003811 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9979029328325156, 'loss_val': 0.13907656171374447, 'psi': 0.9971574802213411}-{'f1_val': 0.9955763922175147, 'auprc': 0.9978789302688585, 'loss_val': 0.1401227355384764, 'psi': 0.9964974074380522}
[S10] START round=25 head_norm_before_train=1.833134 cos_to_last_merge=0.7949 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.795
[S10] round=25 local utility u=0.007121 metrics={'f1_val': 0.9946398940070843, 'auprc': 0.9951511865401805, 'loss_val': 0.033340067417780825, 'psi': 0.9948444110203227}-{'f1_val': 0.9950782813056309, 'auprc': 0.9948623806073987, 'loss_val': 0.04934678954051091, 'psi': 0.994991921026338}
[S11] START round=25 head_norm_before_train=1.627455 cos_to_last_merge=0.9986 (last merge round=22)
[S11] round=25 local utility u=0.850416 metrics={'f1_val': 0.9798002321184324, 'auprc': 0.9988170207409736, 'loss_val': 0.1661531824515564, 'psi': 0.9874069475674488}-{'f1_val': 0.7019353166316534, 'auprc': 0.9982877233740948, 'loss_val': 0.19820699913147555, 'psi': 0.82047627932863}
[S13] START round=25 head_norm_before_train=1.294627 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.038257 metrics={'f1_val': 0.6224052364123247, 'auprc': 0.6920960471846159, 'loss_val': 0.6699901246754796, 'psi': 0.6502815607212411}-{'f1_val': 0.6223407303293372, 'auprc': 0.6581532543814066, 'loss_val': 0.6442880531572512, 'psi': 0.636665739950165}
[S14] START round=25 head_norm_before_train=1.280325 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.018807 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9984183031544809, 'loss_val': 0.13662430678469825, 'psi': 0.9976802424639064}-{'f1_val': 0.9969682102907778, 'auprc': 0.9966846857473939, 'loss_val': 0.167716997908157, 'psi': 0.9968548004734241}
[S15] START round=25 head_norm_before_train=2.068062 (no previous merge yet)
[S15] round=25 local utility u=0.646847 metrics={'f1_val': 0.9963052986881302, 'auprc': 0.9979089505357677, 'loss_val': 0.02370253311972555, 'psi': 0.9969467594271852}-{'f1_val': 0.8244743915306217, 'auprc': 0.9888800695667643, 'loss_val': 0.2593252166077742, 'psi': 0.8902366627450787}
[S16] START round=25 head_norm_before_train=1.172998 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.243104 metrics={'f1_val': 0.9422913685803614, 'auprc': 0.9937500981440546, 'loss_val': 0.3833532484989441, 'psi': 0.9628748604058386}-{'f1_val': 0.8843117759589356, 'auprc': 0.990183899300499, 'loss_val': 0.5109856599466615, 'psi': 0.926660625295561}
[S17] START round=25 head_norm_before_train=1.946303 (no previous merge yet)
[S17] round=25 local utility u=0.050541 metrics={'f1_val': 0.6324508370744422, 'auprc': 0.8763564185413061, 'loss_val': 1.0873927866403816, 'psi': 0.7300130696611877}-{'f1_val': 0.6342291686173824, 'auprc': 0.8605076652152274, 'loss_val': 1.1515975535748124, 'psi': 0.7247405672565204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:40415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:40412
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:40407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S13
[S9] cosine check vs S13: cos=0.9880
[S4] RECEIVED delta(kind=head bytes=1799) from S9
[S4] cosine check vs S9: cos=-0.0884
[S4] DROPPED delta from S9 (cos=-0.0884 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1804) from S11
[S6] cosine check vs S11: cos=0.9917
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] cosine check vs S10: cos=-0.0651
[S7] DROPPED delta from S10 (cos=-0.0651 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] cosine check vs S16: cos=0.6545
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] cosine check vs S14: cos=0.8461
[S14] RECEIVED delta(kind=head bytes=1804) from S4
[S14] cosine check vs S4: cos=0.9670
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:40409
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] cosine check vs S17: cos=-0.0701
[S8] DROPPED delta from S17 (cos=-0.0701 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.9610 head_norm=1.629796
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.068081e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.9607 head_norm=1.639092 delta_norm=0.106808
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.017 → S16@127.0.0.1:40416
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9798 head_norm=1.655242
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.431174e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9583 head_norm=1.428704 delta_norm=0.443117
[S11] aggregate: ROLLBACK (f1_val pre=0.980 post=0.958 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.198 → S6@127.0.0.1:40407
[S16] ⇄ pheromone p=0.276 → S15@127.0.0.1:40415
[S4] ⇄ pheromone p=0.073 → S14@127.0.0.1:40414
[S13] ⇄ pheromone p=0.054 → S9@127.0.0.1:40410
[S10] ⇄ pheromone p=0.092 → S7@127.0.0.1:40408
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9967 head_norm=1.297043
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.025978e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9967 head_norm=1.306624 delta_norm=0.102598
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.091 → S4@127.0.0.1:40404
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9972 head_norm=1.317298
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.952039e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9964 head_norm=1.383943 delta_norm=0.195204
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.062 → S11@127.0.0.1:40412
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9963 head_norm=2.083576
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.909937e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9965 head_norm=1.512155 delta_norm=0.790994
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.063 → S8@127.0.0.1:40409
[S2] START round=26 head_norm_before_train=1.986671 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.7179683170376031, 'auprc': 0.7078347344562721, 'loss_val': 1.2052383115950784, 'psi': 0.7139148840050706}-{'f1_val': 0.7181923610584895, 'auprc': 0.7050259379871052, 'loss_val': 1.1938983007277317, 'psi': 0.7129257918299359}
[S3] START round=26 head_norm_before_train=1.825975 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.8391619823242128, 'auprc': 0.998840593366801, 'loss_val': 0.3185346477204477, 'psi': 0.9030334267412481}-{'f1_val': 0.9583645500492921, 'auprc': 0.9985137109764709, 'loss_val': 0.14114984005135622, 'psi': 0.9744242144201636}
[S4] START round=26 head_norm_before_train=1.473613 cos_to_last_merge=0.9937 (last merge round=23)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9537045593456038, 'auprc': 0.9584369803071542, 'loss_val': 0.27952649257173473, 'psi': 0.955597527730224}-{'f1_val': 0.9588941189678216, 'auprc': 0.9560909621436704, 'loss_val': 0.27642990596366385, 'psi': 0.9577728562381611}
[S5] START round=26 head_norm_before_train=1.516992 cos_to_last_merge=0.8408 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.841
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7143712450552575, 'auprc': 0.7926214136881861, 'loss_val': 0.5803677172487967, 'psi': 0.7456713125084289}-{'f1_val': 0.7006083926626743, 'auprc': 0.9976794817848764, 'loss_val': 0.2112773264896753, 'psi': 0.8194368283115552}
[S6] START round=26 head_norm_before_train=1.639092 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.8726640307890446, 'auprc': 0.953912996436645, 'loss_val': 0.32328429320323115, 'psi': 0.9051636170480848}-{'f1_val': 0.9609768503616756, 'auprc': 0.9857069897025053, 'loss_val': 0.1388845735979353, 'psi': 0.9708689060980075}
[S7] START round=26 head_norm_before_train=1.674884 (no previous merge yet)
[S7] round=26 local utility u=0.322766 metrics={'f1_val': 0.6228161374171659, 'auprc': 0.8022247046569683, 'loss_val': 0.5872342850782153, 'psi': 0.6945795643130869}-{'f1_val': 0.5603576509362869, 'auprc': 0.7863165906576943, 'loss_val': 0.8102910096967842, 'psi': 0.6507412268248498}
[S8] START round=26 head_norm_before_train=2.083390 (no previous merge yet)
[S8] round=26 local utility u=1.000000 metrics={'f1_val': 0.9904161809363135, 'auprc': 0.9985248771483746, 'loss_val': 0.034655811541033775, 'psi': 0.9936596594211379}-{'f1_val': 0.7138880036303916, 'auprc': 0.9810608778828864, 'loss_val': 0.6140050025545785, 'psi': 0.8207571533313895}
[S9] START round=26 head_norm_before_train=1.306624 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.022277 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981579944897703, 'loss_val': 0.09528867252655797, 'psi': 0.997259504884243}-{'f1_val': 0.9966605118138915, 'auprc': 0.9979029328325156, 'loss_val': 0.13907656171374447, 'psi': 0.9971574802213411}
[S10] START round=26 head_norm_before_train=1.843920 cos_to_last_merge=0.7939 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.794
[S10] round=26 local utility u=0.002615 metrics={'f1_val': 0.9948341276356989, 'auprc': 0.9959747255132383, 'loss_val': 0.03174666528611366, 'psi': 0.9952903667867147}-{'f1_val': 0.9946398940070843, 'auprc': 0.9951511865401805, 'loss_val': 0.033340067417780825, 'psi': 0.9948444110203227}
[S11] START round=26 head_norm_before_train=1.428704 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.048246 metrics={'f1_val': 0.9975505764362702, 'auprc': 0.9981542035074346, 'loss_val': 0.17417382590268166, 'psi': 0.997792027264736}-{'f1_val': 0.9798002321184324, 'auprc': 0.9988170207409736, 'loss_val': 0.1661531824515564, 'psi': 0.9874069475674488}
[S13] START round=26 head_norm_before_train=1.324109 cos_to_last_merge=0.9993 (last merge round=24)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6080346191716257, 'auprc': 0.6387605030083859, 'loss_val': 0.773042800966961, 'psi': 0.6203249727063298}-{'f1_val': 0.6224052364123247, 'auprc': 0.6920960471846159, 'loss_val': 0.6699901246754796, 'psi': 0.6502815607212411}
[S14] START round=26 head_norm_before_train=1.383943 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.026937 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9988301302901504, 'loss_val': 0.08297753758489333, 'psi': 0.9977442257897855}-{'f1_val': 0.9971882020035234, 'auprc': 0.9984183031544809, 'loss_val': 0.13662430678469825, 'psi': 0.9976802424639064}
[S15] START round=26 head_norm_before_train=1.512155 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7011955970681706, 'auprc': 0.7241144108470201, 'loss_val': 0.5160502910451068, 'psi': 0.7103631225797105}-{'f1_val': 0.9963052986881302, 'auprc': 0.9979089505357677, 'loss_val': 0.02370253311972555, 'psi': 0.9969467594271852}
[S16] START round=26 head_norm_before_train=1.217900 cos_to_last_merge=0.9966 (last merge round=24)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.9030338533369399, 'auprc': 0.9950154934819199, 'loss_val': 0.403094411007475, 'psi': 0.9398265093949318}-{'f1_val': 0.9422913685803614, 'auprc': 0.9937500981440546, 'loss_val': 0.3833532484989441, 'psi': 0.9628748604058386}
[S17] START round=26 head_norm_before_train=1.962899 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.6325279755580069, 'auprc': 0.8563579051713442, 'loss_val': 1.2478549562410899, 'psi': 0.7220599474033418}-{'f1_val': 0.6324508370744422, 'auprc': 0.8763564185413061, 'loss_val': 1.0873927866403816, 'psi': 0.7300130696611877}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:40407
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:40416
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:40411
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:40404
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:40404
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S8
[S16] cosine check vs S8: cos=-0.0433
[S16] DROPPED delta from S8 (cos=-0.0433 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S14
[S4] cosine check vs S14: cos=0.9899
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=-0.0653
[S7] DROPPED delta from S10 (cos=-0.0653 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=-0.0653
[S10] DROPPED delta from S7 (cos=-0.0653 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1804) from S9
[S4] cosine check vs S9: cos=-0.0836
[S4] DROPPED delta from S9 (cos=-0.0836 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S11
[S6] cosine check vs S11: cos=0.9657
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9537 head_norm=1.505602
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.119366e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9536 head_norm=1.460695 delta_norm=0.111937
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.8727 head_norm=1.658311
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.263106e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.8736 head_norm=1.546390 delta_norm=0.226311
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=2.000995 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.624941199063127, 'auprc': 0.7151923590065957, 'loss_val': 1.6382992247625237, 'psi': 0.6610416630405145}-{'f1_val': 0.7179683170376031, 'auprc': 0.7078347344562721, 'loss_val': 1.2052383115950784, 'psi': 0.7139148840050706}
[S3] START round=27 head_norm_before_train=1.849770 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.8184688726861213, 'auprc': 0.998619553327082, 'loss_val': 0.33855972184914973, 'psi': 0.8905291449425056}-{'f1_val': 0.8391619823242128, 'auprc': 0.998840593366801, 'loss_val': 0.3185346477204477, 'psi': 0.9030334267412481}
[S4] START round=27 head_norm_before_train=1.460695 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9537121153223854, 'auprc': 0.9547300407223017, 'loss_val': 0.27606033106679, 'psi': 0.9541192854823519}-{'f1_val': 0.9537045593456038, 'auprc': 0.9584369803071542, 'loss_val': 0.27952649257173473, 'psi': 0.955597527730224}
[S5] START round=27 head_norm_before_train=1.531782 cos_to_last_merge=0.8410 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.841
[S5] round=27 local utility u=0.316767 metrics={'f1_val': 0.7178193035047614, 'auprc': 0.9008398923887263, 'loss_val': 0.2921776107088475, 'psi': 0.7910275390583474}-{'f1_val': 0.7143712450552575, 'auprc': 0.7926214136881861, 'loss_val': 0.5803677172487967, 'psi': 0.7456713125084289}
[S6] START round=27 head_norm_before_train=1.546390 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.8179244229446355, 'auprc': 0.91020635057715, 'loss_val': 0.4096998668140756, 'psi': 0.8548371939976414}-{'f1_val': 0.8726640307890446, 'auprc': 0.953912996436645, 'loss_val': 0.32328429320323115, 'psi': 0.9051636170480848}
[S7] START round=27 head_norm_before_train=1.684245 (no previous merge yet)
[S7] round=27 local utility u=0.322701 metrics={'f1_val': 0.6811218507998757, 'auprc': 0.835274159333204, 'loss_val': 0.39081535595947825, 'psi': 0.7427827742132072}-{'f1_val': 0.6228161374171659, 'auprc': 0.8022247046569683, 'loss_val': 0.5872342850782153, 'psi': 0.6945795643130869}
[S8] START round=27 head_norm_before_train=2.086641 (no previous merge yet)
[S8] round=27 local utility u=0.000345 metrics={'f1_val': 0.9904584939724955, 'auprc': 0.998522765234945, 'loss_val': 0.034213534907884396, 'psi': 0.9936842024774752}-{'f1_val': 0.9904161809363135, 'auprc': 0.9985248771483746, 'loss_val': 0.034655811541033775, 'psi': 0.9936596594211379}
[S9] START round=27 head_norm_before_train=1.350836 cos_to_last_merge=0.9991 (last merge round=25)
[S9] round=27 local utility u=0.004468 metrics={'f1_val': 0.9951604951085576, 'auprc': 0.9981586041300099, 'loss_val': 0.0773552231667404, 'psi': 0.9963597387171386}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981579944897703, 'loss_val': 0.09528867252655797, 'psi': 0.997259504884243}
[S10] START round=27 head_norm_before_train=1.859514 cos_to_last_merge=0.7922 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.792
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9947918903119958, 'auprc': 0.9956883895583918, 'loss_val': 0.03193131167177944, 'psi': 0.9951504900105541}-{'f1_val': 0.9948341276356989, 'auprc': 0.9959747255132383, 'loss_val': 0.03174666528611366, 'psi': 0.9952903667867147}
[S11] START round=27 head_norm_before_train=1.461191 cos_to_last_merge=0.9991 (last merge round=25)
[S11] round=27 local utility u=0.015057 metrics={'f1_val': 0.9977924134809988, 'auprc': 0.9988443497963869, 'loss_val': 0.14758055583932253, 'psi': 0.9982131880071541}-{'f1_val': 0.9975505764362702, 'auprc': 0.9981542035074346, 'loss_val': 0.17417382590268166, 'psi': 0.997792027264736}
[S13] START round=27 head_norm_before_train=1.357929 cos_to_last_merge=0.9970 (last merge round=24)
[S13] round=27 local utility u=0.006871 metrics={'f1_val': 0.6094241203936467, 'auprc': 0.6539931614530059, 'loss_val': 0.8133348303947665, 'psi': 0.6272517368173904}-{'f1_val': 0.6080346191716257, 'auprc': 0.6387605030083859, 'loss_val': 0.773042800966961, 'psi': 0.6203249727063298}
[S14] START round=27 head_norm_before_train=1.423194 cos_to_last_merge=0.9995 (last merge round=25)
[S14] round=27 local utility u=0.007426 metrics={'f1_val': 0.9972630104447024, 'auprc': 0.998750855404565, 'loss_val': 0.06934467142223331, 'psi': 0.9978581484286475}-{'f1_val': 0.9970202894562089, 'auprc': 0.9988301302901504, 'loss_val': 0.08297753758489333, 'psi': 0.9977442257897855}
[S15] START round=27 head_norm_before_train=1.548209 cos_to_last_merge=0.9998 (last merge round=25)
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.9961900430063055, 'auprc': 0.9934710540765244, 'loss_val': 0.04424728513793749, 'psi': 0.995102447434393}-{'f1_val': 0.7011955970681706, 'auprc': 0.7241144108470201, 'loss_val': 0.5160502910451068, 'psi': 0.7103631225797105}
[S16] START round=27 head_norm_before_train=1.275212 cos_to_last_merge=0.9874 (last merge round=24)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.8530013122017777, 'auprc': 0.9943323960298541, 'loss_val': 0.49686662028260836, 'psi': 0.9095337457330083}-{'f1_val': 0.9030338533369399, 'auprc': 0.9950154934819199, 'loss_val': 0.403094411007475, 'psi': 0.9398265093949318}
[S17] START round=27 head_norm_before_train=1.973455 (no previous merge yet)
[S17] round=27 local utility u=0.046697 metrics={'f1_val': 0.63507584174522, 'auprc': 0.8625458194080571, 'loss_val': 1.1883118910857715, 'psi': 0.7260638328103548}-{'f1_val': 0.6325279755580069, 'auprc': 0.8563579051713442, 'loss_val': 1.2478549562410899, 'psi': 0.7220599474033418}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:40407
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:40416
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S15
[S16] cosine check vs S15: cos=0.8341
[S16] RECEIVED delta(kind=head bytes=1798) from S8
[S16] cosine check vs S8: cos=-0.0395
[S16] DROPPED delta from S8 (cos=-0.0395 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S7
[S10] cosine check vs S7: cos=-0.0652
[S10] DROPPED delta from S7 (cos=-0.0652 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S9
[S4] cosine check vs S9: cos=-0.0882
[S4] DROPPED delta from S9 (cos=-0.0882 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S14
[S4] cosine check vs S14: cos=0.9945
[S6] RECEIVED delta(kind=head bytes=1802) from S11
[S6] cosine check vs S11: cos=0.9884
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:40409
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=-0.0719
[S8] DROPPED delta from S17 (cos=-0.0719 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S13
[S9] cosine check vs S13: cos=0.9894
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.8179 head_norm=1.569436
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.221691e-01
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.8344 head_norm=1.528288 delta_norm=0.122169
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9537 head_norm=1.499069
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.058266e-02
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9537 head_norm=1.476153 delta_norm=0.080583
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9952 head_norm=1.389544
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.011501e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9952 head_norm=1.381088 delta_norm=0.101150
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.8530 head_norm=1.334645
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.408112e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.8481 head_norm=1.404725 delta_norm=0.440811
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=2.017156 (no previous merge yet)
[S2] round=28 local utility u=0.466649 metrics={'f1_val': 0.716861219435703, 'auprc': 0.7072336965616504, 'loss_val': 1.232646191590974, 'psi': 0.7130102102860819}-{'f1_val': 0.624941199063127, 'auprc': 0.7151923590065957, 'loss_val': 1.6382992247625237, 'psi': 0.6610416630405145}
[S3] START round=28 head_norm_before_train=1.873073 (no previous merge yet)
[S3] round=28 local utility u=0.408922 metrics={'f1_val': 0.9246499305021403, 'auprc': 0.9988622712787731, 'loss_val': 0.15853053708231316, 'psi': 0.9543348668127934}-{'f1_val': 0.8184688726861213, 'auprc': 0.998619553327082, 'loss_val': 0.33855972184914973, 'psi': 0.8905291449425056}
[S4] START round=28 head_norm_before_train=1.476153 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.011134 metrics={'f1_val': 0.9526750320107794, 'auprc': 0.9632931970536323, 'loss_val': 0.2732592817610885, 'psi': 0.9569222980279206}-{'f1_val': 0.9537121153223854, 'auprc': 0.9547300407223017, 'loss_val': 0.27606033106679, 'psi': 0.9541192854823519}
[S5] START round=28 head_norm_before_train=1.542035 cos_to_last_merge=0.8402 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=28 local utility u=1.000000 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9958206580665003, 'loss_val': 0.15426472480479883, 'psi': 0.9961278178198945}-{'f1_val': 0.7178193035047614, 'auprc': 0.9008398923887263, 'loss_val': 0.2921776107088475, 'psi': 0.7910275390583474}
[S6] START round=28 head_norm_before_train=1.528288 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.185082 metrics={'f1_val': 0.8621762326315221, 'auprc': 0.951198802665382, 'loss_val': 0.42802492408827747, 'psi': 0.897785260645066}-{'f1_val': 0.8179244229446355, 'auprc': 0.91020635057715, 'loss_val': 0.4096998668140756, 'psi': 0.8548371939976414}
[S7] START round=28 head_norm_before_train=1.695073 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.41014882920644435, 'auprc': 0.7769516300700406, 'loss_val': 1.282288046389576, 'psi': 0.556869949551883}-{'f1_val': 0.6811218507998757, 'auprc': 0.835274159333204, 'loss_val': 0.39081535595947825, 'psi': 0.7427827742132072}
[S8] START round=28 head_norm_before_train=2.094334 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9935326376274699, 'auprc': 0.9871777421984569, 'loss_val': 0.035818569482422846, 'psi': 0.9909906794558647}-{'f1_val': 0.9904584939724955, 'auprc': 0.998522765234945, 'loss_val': 0.034213534907884396, 'psi': 0.9936842024774752}
[S9] START round=28 head_norm_before_train=1.381088 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000931 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9984016910588003, 'loss_val': 0.0727238830669622, 'psi': 0.9961071851190869}-{'f1_val': 0.9951604951085576, 'auprc': 0.9981586041300099, 'loss_val': 0.0773552231667404, 'psi': 0.9963597387171386}
[S10] START round=28 head_norm_before_train=1.871585 cos_to_last_merge=0.7910 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.791
[S10] round=28 local utility u=0.001862 metrics={'f1_val': 0.9952985899745774, 'auprc': 0.9952458072420294, 'loss_val': 0.02991925927641851, 'psi': 0.9952774768815582}-{'f1_val': 0.9947918903119958, 'auprc': 0.9956883895583918, 'loss_val': 0.03193131167177944, 'psi': 0.9951504900105541}
[S11] START round=28 head_norm_before_train=1.496012 cos_to_last_merge=0.9974 (last merge round=25)
[S11] round=28 local utility u=0.011030 metrics={'f1_val': 0.9971362493929642, 'auprc': 0.9982388270163488, 'loss_val': 0.11976722937358165, 'psi': 0.9975772804423181}-{'f1_val': 0.9977924134809988, 'auprc': 0.9988443497963869, 'loss_val': 0.14758055583932253, 'psi': 0.9982131880071541}
[S13] START round=28 head_norm_before_train=1.380015 cos_to_last_merge=0.9949 (last merge round=24)
[S13] round=28 local utility u=0.296030 metrics={'f1_val': 0.6412484829965993, 'auprc': 0.7003775665710007, 'loss_val': 0.5513748009703046, 'psi': 0.6649001164263599}-{'f1_val': 0.6094241203936467, 'auprc': 0.6539931614530059, 'loss_val': 0.8133348303947665, 'psi': 0.6272517368173904}
[S14] START round=28 head_norm_before_train=1.457339 cos_to_last_merge=0.9983 (last merge round=25)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9920022112644541, 'auprc': 0.9988087738400695, 'loss_val': 0.07322434191834916, 'psi': 0.9947248362947003}-{'f1_val': 0.9972630104447024, 'auprc': 0.998750855404565, 'loss_val': 0.06934467142223331, 'psi': 0.9978581484286475}
[S15] START round=28 head_norm_before_train=1.598079 cos_to_last_merge=0.9991 (last merge round=25)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.8098337580821064, 'auprc': 0.9883319155644292, 'loss_val': 0.2831895653778753, 'psi': 0.8812330210750356}-{'f1_val': 0.9961900430063055, 'auprc': 0.9934710540765244, 'loss_val': 0.04424728513793749, 'psi': 0.995102447434393}
[S16] START round=28 head_norm_before_train=1.404725 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.322860 metrics={'f1_val': 0.927294095564971, 'auprc': 0.9928564853477441, 'loss_val': 0.29247570957923197, 'psi': 0.9535190514780802}-{'f1_val': 0.8530013122017777, 'auprc': 0.9943323960298541, 'loss_val': 0.49686662028260836, 'psi': 0.9095337457330083}
[S17] START round=28 head_norm_before_train=1.983948 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6299732576137578, 'auprc': 0.8609930830100894, 'loss_val': 1.2152984091157908, 'psi': 0.7223811877722904}-{'f1_val': 0.63507584174522, 'auprc': 0.8625458194080571, 'loss_val': 1.1883118910857715, 'psi': 0.7260638328103548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:40415
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:40407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:40408
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=-0.0654
[S7] DROPPED delta from S10 (cos=-0.0654 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] cosine check vs S6: cos=0.9953
[S15] RECEIVED delta(kind=head bytes=1802) from S16
[S15] cosine check vs S16: cos=0.9560
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=0.9947
[S4] RECEIVED delta(kind=head bytes=1800) from S9
[S4] cosine check vs S9: cos=-0.0902
[S4] DROPPED delta from S9 (cos=-0.0902 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S11
[S6] cosine check vs S11: cos=0.9953
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] cosine check vs S4: cos=0.9958
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9920 head_norm=1.488881
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.983522e-02
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9920 head_norm=1.501139 delta_norm=0.069835
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.9971 head_norm=1.529672
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.569929e-02
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.9971 head_norm=1.539527 delta_norm=0.075699
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.8622 head_norm=1.553014
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.569928e-02
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.8517 head_norm=1.539527 delta_norm=0.075699
[S6] aggregate: ROLLBACK (f1_val pre=0.862 post=0.852 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.9946 head_norm=1.411766
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.266744e-02
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.9942 head_norm=1.404605 delta_norm=0.072667
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.8098 head_norm=1.638160
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.467870e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.8098 head_norm=1.529065 delta_norm=0.246787
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=2.029598 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7125722510164479, 'auprc': 0.7128198853041353, 'loss_val': 1.235390737905547, 'psi': 0.712671304731523}-{'f1_val': 0.716861219435703, 'auprc': 0.7072336965616504, 'loss_val': 1.232646191590974, 'psi': 0.7130102102860819}
[S3] START round=29 head_norm_before_train=1.898542 (no previous merge yet)
[S3] round=29 local utility u=0.196592 metrics={'f1_val': 0.9774809059337733, 'auprc': 0.9987168497000771, 'loss_val': 0.08189622675154742, 'psi': 0.9859752834402948}-{'f1_val': 0.9246499305021403, 'auprc': 0.9988622712787731, 'loss_val': 0.15853053708231316, 'psi': 0.9543348668127934}
[S4] START round=29 head_norm_before_train=1.516517 cos_to_last_merge=0.9995 (last merge round=27)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9506602012279578, 'auprc': 0.9422754995718656, 'loss_val': 0.27659812439890297, 'psi': 0.947306320565521}-{'f1_val': 0.9526750320107794, 'auprc': 0.9632931970536323, 'loss_val': 0.2732592817610885, 'psi': 0.9569222980279206}
[S5] START round=29 head_norm_before_train=1.552060 cos_to_last_merge=0.8396 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7423187742104518, 'auprc': 0.9926486564101039, 'loss_val': 0.21741533064511376, 'psi': 0.8424507270903125}-{'f1_val': 0.9963325909888239, 'auprc': 0.9958206580665003, 'loss_val': 0.15426472480479883, 'psi': 0.9961278178198945}
[S6] START round=29 head_norm_before_train=1.539527 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.6713075817760915, 'auprc': 0.960360379541307, 'loss_val': 0.5318174005280017, 'psi': 0.7869287008821777}-{'f1_val': 0.8621762326315221, 'auprc': 0.951198802665382, 'loss_val': 0.42802492408827747, 'psi': 0.897785260645066}
[S7] START round=29 head_norm_before_train=1.703700 (no previous merge yet)
[S7] round=29 local utility u=1.000000 metrics={'f1_val': 0.6948052862503937, 'auprc': 0.9114737309141298, 'loss_val': 0.285352299415064, 'psi': 0.7814726641158881}-{'f1_val': 0.41014882920644435, 'auprc': 0.7769516300700406, 'loss_val': 1.282288046389576, 'psi': 0.556869949551883}
[S8] START round=29 head_norm_before_train=2.109093 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.8546662955711223, 'auprc': 0.9984383208988543, 'loss_val': 0.3457125891136648, 'psi': 0.9121751057022152}-{'f1_val': 0.9935326376274699, 'auprc': 0.9871777421984569, 'loss_val': 0.035818569482422846, 'psi': 0.9909906794558647}
[S9] START round=29 head_norm_before_train=1.404605 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.009405 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983999994112938, 'loss_val': 0.06640660222139774, 'psi': 0.9973563068528524}-{'f1_val': 0.9945775144926113, 'auprc': 0.9984016910588003, 'loss_val': 0.0727238830669622, 'psi': 0.9961071851190869}
[S10] START round=29 head_norm_before_train=1.884981 cos_to_last_merge=0.7895 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.790
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.7474051966494897, 'auprc': 0.9759605378208089, 'loss_val': 0.7855953767824169, 'psi': 0.8388273331180174}-{'f1_val': 0.9952985899745774, 'auprc': 0.9952458072420294, 'loss_val': 0.02991925927641851, 'psi': 0.9952774768815582}
[S11] START round=29 head_norm_before_train=1.539527 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.008643 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9986659752297279, 'loss_val': 0.10521410761268699, 'psi': 0.9978932419545068}-{'f1_val': 0.9971362493929642, 'auprc': 0.9982388270163488, 'loss_val': 0.11976722937358165, 'psi': 0.9975772804423181}
[S13] START round=29 head_norm_before_train=1.401181 cos_to_last_merge=0.9928 (last merge round=24)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.6095362099783856, 'auprc': 0.7308990761599126, 'loss_val': 0.7269102547703409, 'psi': 0.6580813564509964}-{'f1_val': 0.6412484829965993, 'auprc': 0.7003775665710007, 'loss_val': 0.5513748009703046, 'psi': 0.6649001164263599}
[S14] START round=29 head_norm_before_train=1.501139 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9406527975213596, 'auprc': 0.9972028642870087, 'loss_val': 0.11020192602664766, 'psi': 0.9632728242276192}-{'f1_val': 0.9920022112644541, 'auprc': 0.9988087738400695, 'loss_val': 0.07322434191834916, 'psi': 0.9947248362947003}
[S15] START round=29 head_norm_before_train=1.529065 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.397864 metrics={'f1_val': 0.9157262526155793, 'auprc': 0.9923694513066568, 'loss_val': 0.1349296270213367, 'psi': 0.9463835320920102}-{'f1_val': 0.8098337580821064, 'auprc': 0.9883319155644292, 'loss_val': 0.2831895653778753, 'psi': 0.8812330210750356}
[S16] START round=29 head_norm_before_train=1.454070 cos_to_last_merge=0.9988 (last merge round=27)
[S16] round=29 local utility u=0.264885 metrics={'f1_val': 0.9881038500041652, 'auprc': 0.9948711895549754, 'loss_val': 0.1336093263878964, 'psi': 0.9908107858244893}-{'f1_val': 0.927294095564971, 'auprc': 0.9928564853477441, 'loss_val': 0.29247570957923197, 'psi': 0.9535190514780802}
[S17] START round=29 head_norm_before_train=1.992641 (no previous merge yet)
[S17] round=29 local utility u=0.146771 metrics={'f1_val': 0.6188220732960599, 'auprc': 0.8966930577359257, 'loss_val': 0.9619496968388552, 'psi': 0.7299704670720062}-{'f1_val': 0.6299732576137578, 'auprc': 0.8609930830100894, 'loss_val': 1.2152984091157908, 'psi': 0.7223811877722904}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.986)
[S11] not sending this round → trigger blocked (psi=0.998)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.991)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:40411
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] cosine check vs S15: cos=0.9801
[S10] RECEIVED delta(kind=head bytes=1803) from S7
[S10] cosine check vs S7: cos=-0.0653
[S10] DROPPED delta from S7 (cos=-0.0653 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:40409
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=-0.0733
[S8] DROPPED delta from S17 (cos=-0.0733 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9881 head_norm=1.500132
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.600126e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9877 head_norm=1.536222 delta_norm=0.160013
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=2.035494 (no previous merge yet)
[S2] round=30 local utility u=0.036335 metrics={'f1_val': 0.7194222833509281, 'auprc': 0.7175909938615648, 'loss_val': 1.2181333306764683, 'psi': 0.7186897675551827}-{'f1_val': 0.7125722510164479, 'auprc': 0.7128198853041353, 'loss_val': 1.235390737905547, 'psi': 0.712671304731523}
[S3] START round=30 head_norm_before_train=1.924388 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.8531592592531226, 'auprc': 0.9988355114764451, 'loss_val': 0.2502711456517184, 'psi': 0.9114297601424517}-{'f1_val': 0.9774809059337733, 'auprc': 0.9987168497000771, 'loss_val': 0.08189622675154742, 'psi': 0.9859752834402948}
[S4] START round=30 head_norm_before_train=1.546872 cos_to_last_merge=0.9984 (last merge round=27)
[S4] round=30 local utility u=0.029814 metrics={'f1_val': 0.9535700820466199, 'auprc': 0.9529802359576126, 'loss_val': 0.266543207624354, 'psi': 0.953334143611017}-{'f1_val': 0.9506602012279578, 'auprc': 0.9422754995718656, 'loss_val': 0.27659812439890297, 'psi': 0.947306320565521}
[S5] START round=30 head_norm_before_train=1.561168 cos_to_last_merge=0.8400 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=30 local utility u=0.817884 metrics={'f1_val': 0.9964799208068884, 'auprc': 0.9976319813291825, 'loss_val': 0.12156397908597825, 'psi': 0.9969407450158061}-{'f1_val': 0.7423187742104518, 'auprc': 0.9926486564101039, 'loss_val': 0.21741533064511376, 'psi': 0.8424507270903125}
[S6] START round=30 head_norm_before_train=1.561523 cos_to_last_merge=0.9998 (last merge round=28)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.6014343697471877, 'auprc': 0.9530368083599019, 'loss_val': 0.5956008260157452, 'psi': 0.7420753451922734}-{'f1_val': 0.6713075817760915, 'auprc': 0.960360379541307, 'loss_val': 0.5318174005280017, 'psi': 0.7869287008821777}
[S7] START round=30 head_norm_before_train=1.710750 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.42514186705953, 'auprc': 0.7804736298873913, 'loss_val': 1.1834998389945937, 'psi': 0.5672745721906746}-{'f1_val': 0.6948052862503937, 'auprc': 0.9114737309141298, 'loss_val': 0.285352299415064, 'psi': 0.7814726641158881}
[S8] START round=30 head_norm_before_train=2.115302 (no previous merge yet)
[S8] round=30 local utility u=0.576735 metrics={'f1_val': 0.9945717084929089, 'auprc': 0.997819153541675, 'loss_val': 0.029818399277835726, 'psi': 0.9958706865124154}-{'f1_val': 0.8546662955711223, 'auprc': 0.9984383208988543, 'loss_val': 0.3457125891136648, 'psi': 0.9121751057022152}
[S9] START round=30 head_norm_before_train=1.431889 cos_to_last_merge=0.9997 (last merge round=28)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9890975148541, 'auprc': 0.9984091899338357, 'loss_val': 0.07206447230816578, 'psi': 0.9928221848859943}-{'f1_val': 0.9966605118138915, 'auprc': 0.9983999994112938, 'loss_val': 0.06640660222139774, 'psi': 0.9973563068528524}
[S10] START round=30 head_norm_before_train=1.897220 cos_to_last_merge=0.7883 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.788
[S10] round=30 local utility u=0.436683 metrics={'f1_val': 0.8426955371097755, 'auprc': 0.9933328151684486, 'loss_val': 0.5360882272212991, 'psi': 0.9029504483332448}-{'f1_val': 0.7474051966494897, 'auprc': 0.9759605378208089, 'loss_val': 0.7855953767824169, 'psi': 0.8388273331180174}
[S11] START round=30 head_norm_before_train=1.571959 cos_to_last_merge=0.9997 (last merge round=28)
[S11] round=30 local utility u=0.009162 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9986475604282503, 'loss_val': 0.08683562414594469, 'psi': 0.9978858760339158}-{'f1_val': 0.9973780864376928, 'auprc': 0.9986659752297279, 'loss_val': 0.10521410761268699, 'psi': 0.9978932419545068}
[S13] START round=30 head_norm_before_train=1.416965 cos_to_last_merge=0.9907 (last merge round=24)
[S13] round=30 local utility u=0.061933 metrics={'f1_val': 0.6112081275309116, 'auprc': 0.7520164222398474, 'loss_val': 0.6764284602781891, 'psi': 0.667531445414486}-{'f1_val': 0.6095362099783856, 'auprc': 0.7308990761599126, 'loss_val': 0.7269102547703409, 'psi': 0.6580813564509964}
[S14] START round=30 head_norm_before_train=1.529240 cos_to_last_merge=0.9998 (last merge round=28)
[S14] round=30 local utility u=0.203146 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9981677793696655, 'loss_val': 0.04866263947707668, 'psi': 0.9978445775848025}-{'f1_val': 0.9406527975213596, 'auprc': 0.9972028642870087, 'loss_val': 0.11020192602664766, 'psi': 0.9632728242276192}
[S15] START round=30 head_norm_before_train=1.587692 cos_to_last_merge=0.9995 (last merge round=28)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.9140691843753497, 'auprc': 0.9923209784434576, 'loss_val': 0.13268923582000533, 'psi': 0.9453699020025927}-{'f1_val': 0.9157262526155793, 'auprc': 0.9923694513066568, 'loss_val': 0.1349296270213367, 'psi': 0.9463835320920102}
[S16] START round=30 head_norm_before_train=1.536222 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9023290648484872, 'auprc': 0.9878816187012889, 'loss_val': 0.41019119010050364, 'psi': 0.9365500863896079}-{'f1_val': 0.9881038500041652, 'auprc': 0.9948711895549754, 'loss_val': 0.1336093263878964, 'psi': 0.9908107858244893}
[S17] START round=30 head_norm_before_train=2.003640 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6311755832152555, 'auprc': 0.8830226890217145, 'loss_val': 1.0106995461973902, 'psi': 0.7319144255378391}-{'f1_val': 0.6188220732960599, 'auprc': 0.8966930577359257, 'loss_val': 0.9619496968388552, 'psi': 0.7299704670720062}
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S17
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:40407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:40404
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:40410
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:40416
[S8] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S15] ⇄ pheromone p=0.294 → S16@127.0.0.1:40416
[S9] RECEIVED delta(kind=head bytes=1797) from S13
[S9] cosine check vs S13: cos=0.9944
[S4] RECEIVED delta(kind=head bytes=1801) from S14
[S4] cosine check vs S14: cos=0.9947
[S16] RECEIVED delta(kind=head bytes=1794) from S8
[S16] cosine check vs S8: cos=-0.0525
[S16] DROPPED delta from S8 (cos=-0.0525 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=-0.0656
[S7] DROPPED delta from S10 (cos=-0.0656 < 0.0)
[S13] ⇄ pheromone p=0.069 → S9@127.0.0.1:40410
[S10] ⇄ pheromone p=0.118 → S7@127.0.0.1:40408
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:40414
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] ⇄ pheromone p=0.049 → S8@127.0.0.1:40409
[S4] sending update (kind=head size=1805 to 1 peers)
[S6] ⇄ pheromone p=0.110 → S11@127.0.0.1:40412
[S7] ⇄ pheromone p=0.248 → S10@127.0.0.1:40411
[S14] RECEIVED delta(kind=head bytes=1805) from S4
[S14] cosine check vs S4: cos=0.9947
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9536 head_norm=1.578408
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.145418e-02
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9534 head_norm=1.562668 delta_norm=0.081454
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.031 → S14@127.0.0.1:40414
[S16] ⇄ pheromone p=0.174 → S15@127.0.0.1:40415
[S8] ⇄ pheromone p=0.203 → S16@127.0.0.1:40416
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S11
[S6] cosine check vs S11: cos=0.9979
[S11] ⇄ pheromone p=0.075 → S6@127.0.0.1:40407
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9976 head_norm=1.551053
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.145419e-02
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9976 head_norm=1.562668 delta_norm=0.081454
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.064 → S11@127.0.0.1:40412
[S9] CommDone barrier timeout: have=2 need=3 — continuing
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.9891 head_norm=1.457567
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.740434e-02
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.9887 head_norm=1.443134 delta_norm=0.077404
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.034 → S4@127.0.0.1:40404
[S2] START round=31 head_norm_before_train=2.044517 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.7121933097464448, 'auprc': 0.7169772894669448, 'loss_val': 1.245980163763521, 'psi': 0.7141069016346449}-{'f1_val': 0.7194222833509281, 'auprc': 0.7175909938615648, 'loss_val': 1.2181333306764683, 'psi': 0.7186897675551827}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=1.948174 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.8008046211837457, 'auprc': 0.9988662419735117, 'loss_val': 0.34393424131313166, 'psi': 0.8800292694996521}-{'f1_val': 0.8531592592531226, 'auprc': 0.9988355114764451, 'loss_val': 0.2502711456517184, 'psi': 0.9114297601424517}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.562668 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.012953 metrics={'f1_val': 0.9513314090754136, 'auprc': 0.9653682158830532, 'loss_val': 0.2643685183986603, 'psi': 0.9569461317984695}-{'f1_val': 0.9535700820466199, 'auprc': 0.9529802359576126, 'loss_val': 0.266543207624354, 'psi': 0.953334143611017}
[S5] START round=31 head_norm_before_train=1.571673 cos_to_last_merge=0.8402 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7348473218723385, 'auprc': 0.9913890404205588, 'loss_val': 0.20615577668161686, 'psi': 0.8374640092916266}-{'f1_val': 0.9964799208068884, 'auprc': 0.9976319813291825, 'loss_val': 0.12156397908597825, 'psi': 0.9969407450158061}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.583004 cos_to_last_merge=0.9993 (last merge round=28)
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.8793992076737088, 'auprc': 0.9772747853713233, 'loss_val': 0.21682508711297796, 'psi': 0.9185494387527546}-{'f1_val': 0.6014343697471877, 'auprc': 0.9530368083599019, 'loss_val': 0.5956008260157452, 'psi': 0.7420753451922734}
[S7] START round=31 head_norm_before_train=1.714525 (no previous merge yet)
[S7] round=31 local utility u=1.000000 metrics={'f1_val': 0.6515532179604091, 'auprc': 0.80300771796328, 'loss_val': 0.4981135596701413, 'psi': 0.7121350179615574}-{'f1_val': 0.42514186705953, 'auprc': 0.7804736298873913, 'loss_val': 1.1834998389945937, 'psi': 0.5672745721906746}
[S8] START round=31 head_norm_before_train=2.119166 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.988272459098805, 'auprc': 0.9984434898780408, 'loss_val': 0.037988490364583107, 'psi': 0.9923408714104993}-{'f1_val': 0.9945717084929089, 'auprc': 0.997819153541675, 'loss_val': 0.029818399277835726, 'psi': 0.9958706865124154}
[S9] START round=31 head_norm_before_train=1.443134 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.020035 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9982395906314856, 'loss_val': 0.06186183019403522, 'psi': 0.9957918962762682}-{'f1_val': 0.9890975148541, 'auprc': 0.9984091899338357, 'loss_val': 0.07206447230816578, 'psi': 0.9928221848859943}
[S10] START round=31 head_norm_before_train=1.905883 cos_to_last_merge=0.7874 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.787
[S10] round=31 local utility u=0.545195 metrics={'f1_val': 0.95289728418016, 'auprc': 0.9952931379339636, 'loss_val': 0.11278977347742648, 'psi': 0.9698556256816814}-{'f1_val': 0.8426955371097755, 'auprc': 0.9933328151684486, 'loss_val': 0.5360882272212991, 'psi': 0.9029504483332448}
[S11] START round=31 head_norm_before_train=1.604556 cos_to_last_merge=0.9988 (last merge round=28)
[S11] round=31 local utility u=0.007879 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9985305492399992, 'loss_val': 0.07072707503261066, 'psi': 0.9978390715586154}-{'f1_val': 0.9973780864376928, 'auprc': 0.9986475604282503, 'loss_val': 0.08683562414594469, 'psi': 0.9978858760339158}
[S13] START round=31 head_norm_before_train=1.432744 cos_to_last_merge=0.9887 (last merge round=24)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6266784220855449, 'auprc': 0.7359323800241973, 'loss_val': 0.7993043280713011, 'psi': 0.6703800052610058}-{'f1_val': 0.6112081275309116, 'auprc': 0.7520164222398474, 'loss_val': 0.6764284602781891, 'psi': 0.667531445414486}
[S14] START round=31 head_norm_before_train=1.562668 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9983489434135246, 'loss_val': 0.049016211335505155, 'psi': 0.9974060419368715}-{'f1_val': 0.9976291097282272, 'auprc': 0.9981677793696655, 'loss_val': 0.04866263947707668, 'psi': 0.9978445775848025}
[S15] START round=31 head_norm_before_train=1.647368 cos_to_last_merge=0.9984 (last merge round=28)
[S15] round=31 local utility u=0.293397 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9913840592615311, 'loss_val': 0.036921748262409966, 'psi': 0.9943789318908062}-{'f1_val': 0.9140691843753497, 'auprc': 0.9923209784434576, 'loss_val': 0.13268923582000533, 'psi': 0.9453699020025927}
[S16] START round=31 head_norm_before_train=1.573454 cos_to_last_merge=0.9995 (last merge round=29)
[S16] round=31 local utility u=0.372350 metrics={'f1_val': 0.9785563372623279, 'auprc': 0.9937380761144202, 'loss_val': 0.14042374061454135, 'psi': 0.9846290328031648}-{'f1_val': 0.9023290648484872, 'auprc': 0.9878816187012889, 'loss_val': 0.41019119010050364, 'psi': 0.9365500863896079}
[S17] START round=31 head_norm_before_train=2.010262 (no previous merge yet)
[S17] round=31 local utility u=0.048650 metrics={'f1_val': 0.6456738920527801, 'auprc': 0.8867002796096886, 'loss_val': 1.0114226127756432, 'psi': 0.7420844470755434}-{'f1_val': 0.6311755832152555, 'auprc': 0.8830226890217145, 'loss_val': 1.0106995461973902, 'psi': 0.7319144255378391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:40411
[S10] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:40407
[S16] RECEIVED delta(kind=head bytes=1803) from S15
[S16] cosine check vs S15: cos=0.9860
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=-0.0659
[S7] DROPPED delta from S10 (cos=-0.0659 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] cosine check vs S6: cos=0.9955
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] cosine check vs S7: cos=-0.0659
[S10] DROPPED delta from S7 (cos=-0.0659 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:40415
[S11] sending update (kind=head size=1790 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.8794 head_norm=1.603520
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.090634e-02
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.8822 head_norm=1.602882 delta_norm=0.060906
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[S6] RECEIVED delta(kind=head bytes=1790) from S11
[S6] cosine check vs S11: cos=0.9983
[S16] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] cosine check vs S16: cos=0.9860
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] cosine check vs S4: cos=-0.0840
[S9] DROPPED delta from S4 (cos=-0.0840 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.9974 head_norm=1.636548
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.821246e-02
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.9974 head_norm=1.618229 delta_norm=0.078212
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.9786 head_norm=1.603139
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.459770e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.9740 head_norm=1.644538 delta_norm=0.145977
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8]  timeout peer S2
[S8]  timeout peer S16
[S17]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S16]  timeout peer S13
[S4]  timeout peer S3
[S4]  timeout peer S14
[S13]  timeout peer S9
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:40413
[S9] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S9
[S13] cosine check vs S9: cos=0.9972
[S2] START round=32 head_norm_before_train=2.053703 (no previous merge yet)
[S2] round=32 local utility u=0.010781 metrics={'f1_val': 0.7179883492249817, 'auprc': 0.712896478399621, 'loss_val': 1.2469458140426932, 'psi': 0.7159516008948374}-{'f1_val': 0.7121933097464448, 'auprc': 0.7169772894669448, 'loss_val': 1.245980163763521, 'psi': 0.7141069016346449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=32 head_norm_before_train=1.967787 (no previous merge yet)
[S3] round=32 local utility u=0.153171 metrics={'f1_val': 0.8415386127872215, 'auprc': 0.9988589632743721, 'loss_val': 0.2819747486777164, 'psi': 0.9044667529820818}-{'f1_val': 0.8008046211837457, 'auprc': 0.9988662419735117, 'loss_val': 0.34393424131313166, 'psi': 0.8800292694996521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=32 head_norm_before_train=1.590201 cos_to_last_merge=0.9998 (last merge round=30)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9524204322394113, 'auprc': 0.9561406877849552, 'loss_val': 0.2637675231934002, 'psi': 0.9539085344576288}-{'f1_val': 0.9513314090754136, 'auprc': 0.9653682158830532, 'loss_val': 0.2643685183986603, 'psi': 0.9569461317984695}
[S5] START round=32 head_norm_before_train=1.581033 cos_to_last_merge=0.8402 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=32 local utility u=0.030998 metrics={'f1_val': 0.7423947643009046, 'auprc': 0.9913693085868527, 'loss_val': 0.18938539138518795, 'psi': 0.8419845820152838}-{'f1_val': 0.7348473218723385, 'auprc': 0.9913890404205588, 'loss_val': 0.20615577668161686, 'psi': 0.8374640092916266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=32 head_norm_before_train=1.602882 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.7918415946435207, 'auprc': 0.9490849990036018, 'loss_val': 0.4251802296083784, 'psi': 0.8547389563875532}-{'f1_val': 0.8793992076737088, 'auprc': 0.9772747853713233, 'loss_val': 0.21682508711297796, 'psi': 0.9185494387527546}
[S7] START round=32 head_norm_before_train=1.717194 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.6008185261259193, 'auprc': 0.7918510002869357, 'loss_val': 0.6786858811781546, 'psi': 0.6772315157903259}-{'f1_val': 0.6515532179604091, 'auprc': 0.80300771796328, 'loss_val': 0.4981135596701413, 'psi': 0.7121350179615574}
[S8] START round=32 head_norm_before_train=2.126734 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9839526961539431, 'auprc': 0.9952170121177603, 'loss_val': 0.04644356288379576, 'psi': 0.9884584225394699}-{'f1_val': 0.988272459098805, 'auprc': 0.9984434898780408, 'loss_val': 0.037988490364583107, 'psi': 0.9923408714104993}
[S9] START round=32 head_norm_before_train=1.467204 cos_to_last_merge=0.9998 (last merge round=30)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9899766087340214, 'auprc': 0.998407238546873, 'loss_val': 0.06456409172218115, 'psi': 0.9933488606591621}-{'f1_val': 0.9941601000394567, 'auprc': 0.9982395906314856, 'loss_val': 0.06186183019403522, 'psi': 0.9957918962762682}
[S10] START round=32 head_norm_before_train=1.918689 cos_to_last_merge=0.7860 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.786
[S10] round=32 local utility u=0.050459 metrics={'f1_val': 0.9647136825501712, 'auprc': 0.9951931548243603, 'loss_val': 0.0824706981714915, 'psi': 0.9769054714598469}-{'f1_val': 0.95289728418016, 'auprc': 0.9952931379339636, 'loss_val': 0.11278977347742648, 'psi': 0.9698556256816814}
[S11] START round=32 head_norm_before_train=1.618229 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.002910 metrics={'f1_val': 0.9978150241471516, 'auprc': 0.9987283253720278, 'loss_val': 0.06812214013249639, 'psi': 0.998180344637102}-{'f1_val': 0.9973780864376928, 'auprc': 0.9985305492399992, 'loss_val': 0.07072707503261066, 'psi': 0.9978390715586154}
[S13] START round=32 head_norm_before_train=1.444084 cos_to_last_merge=0.9876 (last merge round=24)
[S13] round=32 local utility u=0.102119 metrics={'f1_val': 0.6698824122875939, 'auprc': 0.7059684954805812, 'loss_val': 0.7643983479633505, 'psi': 0.6843168455647888}-{'f1_val': 0.6266784220855449, 'auprc': 0.7359323800241973, 'loss_val': 0.7993043280713011, 'psi': 0.6703800052610058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.6699 head_norm=1.455393
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.719369e-02
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.6446 head_norm=1.460191 delta_norm=0.057194
[S13] aggregate: ROLLBACK (f1_val pre=0.670 post=0.645 tol_abs=0.005 tol_rel=0.0)
[S14] START round=32 head_norm_before_train=1.580124 cos_to_last_merge=0.9999 (last merge round=30)
[S14] round=32 local utility u=0.004426 metrics={'f1_val': 0.9974089034627865, 'auprc': 0.9982870931066153, 'loss_val': 0.043767658197676716, 'psi': 0.997760179320318}-{'f1_val': 0.9967774409524363, 'auprc': 0.9983489434135246, 'loss_val': 0.049016211335505155, 'psi': 0.9974060419368715}
[S15] START round=32 head_norm_before_train=1.697520 cos_to_last_merge=0.9971 (last merge round=28)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.7448074867995435, 'auprc': 0.8609830917722803, 'loss_val': 0.5008978799202615, 'psi': 0.7912777287886382}-{'f1_val': 0.9963755136436562, 'auprc': 0.9913840592615311, 'loss_val': 0.036921748262409966, 'psi': 0.9943789318908062}
[S16] START round=32 head_norm_before_train=1.644538 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.8804407263245042, 'auprc': 0.9968084945871205, 'loss_val': 0.3853260949518827, 'psi': 0.9269878336295507}-{'f1_val': 0.9785563372623279, 'auprc': 0.9937380761144202, 'loss_val': 0.14042374061454135, 'psi': 0.9846290328031648}
[S17] START round=32 head_norm_before_train=2.013663 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6346833521859656, 'auprc': 0.8790690304335639, 'loss_val': 1.066727937983521, 'psi': 0.732437623485005}-{'f1_val': 0.6456738920527801, 'auprc': 0.8867002796096886, 'loss_val': 1.0114226127756432, 'psi': 0.7420844470755434}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:40408
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:40407
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1796 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.7918 head_norm=1.622462
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.718000e-02
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.7948 head_norm=1.628516 delta_norm=0.057180
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.7448 head_norm=1.749476
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.681570e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.7429 head_norm=1.669456 delta_norm=0.168157
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1800) from S14
[S4] cosine check vs S14: cos=0.9988
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] cosine check vs S10: cos=-0.0663
[S7] DROPPED delta from S10 (cos=-0.0663 < 0.0)
[S11] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S11
[S6] cosine check vs S11: cos=0.9999
[S2] START round=33 head_norm_before_train=2.061585 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.672669225931167, 'auprc': 0.7161995807282988, 'loss_val': 1.3368619447538164, 'psi': 0.6900813678500197}-{'f1_val': 0.7179883492249817, 'auprc': 0.712896478399621, 'loss_val': 1.2469458140426932, 'psi': 0.7159516008948374}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.984582 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.7261656417647036, 'auprc': 0.9988155672755019, 'loss_val': 0.5307730576725792, 'psi': 0.8352256119690229}-{'f1_val': 0.8415386127872215, 'auprc': 0.9988589632743721, 'loss_val': 0.2819747486777164, 'psi': 0.9044667529820818}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.620257 cos_to_last_merge=0.9992 (last merge round=30)
[S4] round=33 local utility u=0.015645 metrics={'f1_val': 0.9523328407131165, 'auprc': 0.9658360919150082, 'loss_val': 0.26103860397509543, 'psi': 0.9577341411938732}-{'f1_val': 0.9524204322394113, 'auprc': 0.9561406877849552, 'loss_val': 0.2637675231934002, 'psi': 0.9539085344576288}
[S5] START round=33 head_norm_before_train=1.589496 cos_to_last_merge=0.8396 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.7000985489210169, 'auprc': 0.9899103019166496, 'loss_val': 0.18138015707645272, 'psi': 0.8160232501192699}-{'f1_val': 0.7423947643009046, 'auprc': 0.9913693085868527, 'loss_val': 0.18938539138518795, 'psi': 0.8419845820152838}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.628516 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.59329154244249, 'auprc': 0.7775630782638936, 'loss_val': 0.8815178130567171, 'psi': 0.6670001567710515}-{'f1_val': 0.7918415946435207, 'auprc': 0.9490849990036018, 'loss_val': 0.4251802296083784, 'psi': 0.8547389563875532}
[S7] START round=33 head_norm_before_train=1.723314 (no previous merge yet)
[S7] round=33 local utility u=0.129193 metrics={'f1_val': 0.621171405155361, 'auprc': 0.8003325510006033, 'loss_val': 0.5678613242906047, 'psi': 0.6928358634934579}-{'f1_val': 0.6008185261259193, 'auprc': 0.7918510002869357, 'loss_val': 0.6786858811781546, 'psi': 0.6772315157903259}
[S8] START round=33 head_norm_before_train=2.132882 (no previous merge yet)
[S8] round=33 local utility u=0.041268 metrics={'f1_val': 0.9939009886418481, 'auprc': 0.9976636436709319, 'loss_val': 0.030936212736603904, 'psi': 0.9954060506534815}-{'f1_val': 0.9839526961539431, 'auprc': 0.9952170121177603, 'loss_val': 0.04644356288379576, 'psi': 0.9884584225394699}
[S9] START round=33 head_norm_before_train=1.489355 cos_to_last_merge=0.9992 (last merge round=30)
[S9] round=33 local utility u=0.030678 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984028541087786, 'loss_val': 0.045953061085661766, 'psi': 0.9976228891507971}-{'f1_val': 0.9899766087340214, 'auprc': 0.998407238546873, 'loss_val': 0.06456409172218115, 'psi': 0.9933488606591621}
[S10] START round=33 head_norm_before_train=1.932333 cos_to_last_merge=0.7845 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.785
[S10] round=33 local utility u=0.116797 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9953806010297978, 'loss_val': 0.034266237519381126, 'psi': 0.9954632234935122}-{'f1_val': 0.9647136825501712, 'auprc': 0.9951931548243603, 'loss_val': 0.0824706981714915, 'psi': 0.9769054714598469}
[S11] START round=33 head_norm_before_train=1.647771 cos_to_last_merge=0.9997 (last merge round=31)
[S11] round=33 local utility u=0.005172 metrics={'f1_val': 0.9978150241471516, 'auprc': 0.9987277379740362, 'loss_val': 0.05777544501984979, 'psi': 0.9981801096779055}-{'f1_val': 0.9978150241471516, 'auprc': 0.9987283253720278, 'loss_val': 0.06812214013249639, 'psi': 0.998180344637102}
[S13] START round=33 head_norm_before_train=1.460191 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.129634 metrics={'f1_val': 0.6814557978848469, 'auprc': 0.7340858749638008, 'loss_val': 0.658923171849855, 'psi': 0.7025078287164285}-{'f1_val': 0.6698824122875939, 'auprc': 0.7059684954805812, 'loss_val': 0.7643983479633505, 'psi': 0.6843168455647888}
[S13] not sending this round → trigger blocked (psi=0.703)
[S14] START round=33 head_norm_before_train=1.596343 cos_to_last_merge=0.9997 (last merge round=30)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9969721384427733, 'auprc': 0.9981515325095919, 'loss_val': 0.04562153265063521, 'psi': 0.9974438960695007}-{'f1_val': 0.9974089034627865, 'auprc': 0.9982870931066153, 'loss_val': 0.043767658197676716, 'psi': 0.997760179320318}
[S15] START round=33 head_norm_before_train=1.669456 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.538382 metrics={'f1_val': 0.8190769889909087, 'auprc': 0.9906437315858634, 'loss_val': 0.25873214989746335, 'psi': 0.8877036860288906}-{'f1_val': 0.7448074867995435, 'auprc': 0.8609830917722803, 'loss_val': 0.5008978799202615, 'psi': 0.7912777287886382}
[S16] START round=33 head_norm_before_train=1.671388 cos_to_last_merge=0.9998 (last merge round=31)
[S16] round=33 local utility u=0.028534 metrics={'f1_val': 0.8906187085193165, 'auprc': 0.9929864929053556, 'loss_val': 0.3778601195455243, 'psi': 0.9315658222737321}-{'f1_val': 0.8804407263245042, 'auprc': 0.9968084945871205, 'loss_val': 0.3853260949518827, 'psi': 0.9269878336295507}
[S17] START round=33 head_norm_before_train=2.020461 (no previous merge yet)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6383427786235628, 'auprc': 0.8626669667128902, 'loss_val': 1.1427876705976203, 'psi': 0.7280724538592938}-{'f1_val': 0.6346833521859656, 'auprc': 0.8790690304335639, 'loss_val': 1.066727937983521, 'psi': 0.732437623485005}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:40417
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:40416
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:40415
[S8] sending update (kind=head size=1792 to 1 peers)
[S11] not sending this round → trigger blocked (psi=0.998)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.5933 head_norm=1.647600
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.023242e-02
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.5932 head_norm=1.647561 delta_norm=0.020232
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1801) from S15
[S16] cosine check vs S15: cos=0.9983
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] cosine check vs S8: cos=-0.0762
[S17] DROPPED delta from S8 (cos=-0.0762 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] cosine check vs S7: cos=-0.0668
[S10] DROPPED delta from S7 (cos=-0.0668 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S4
[S9] cosine check vs S4: cos=-0.0775
[S9] DROPPED delta from S4 (cos=-0.0775 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S9
[S13] cosine check vs S9: cos=0.9972
[S16] sending update (kind=head size=1803 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.9523 head_norm=1.644131
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.536541e-02
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.9523 head_norm=1.619467 delta_norm=0.055365
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1803) from S16
[S15] cosine check vs S16: cos=0.9983
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.8906 head_norm=1.696002
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.131115e-02
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.8859 head_norm=1.705631 delta_norm=0.051311
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=2.073503 (no previous merge yet)
[S2] round=34 local utility u=0.042175 metrics={'f1_val': 0.69152354231628, 'auprc': 0.7167780979650678, 'loss_val': 1.36737305285033, 'psi': 0.701625364575795}-{'f1_val': 0.672669225931167, 'auprc': 0.7161995807282988, 'loss_val': 1.3368619447538164, 'psi': 0.6900813678500197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=34 head_norm_before_train=2.000072 (no previous merge yet)
[S3] round=34 local utility u=0.890297 metrics={'f1_val': 0.9568501791894158, 'auprc': 0.9988675975388472, 'loss_val': 0.13444325573095509, 'psi': 0.9736571465291883}-{'f1_val': 0.7261656417647036, 'auprc': 0.9988155672755019, 'loss_val': 0.5307730576725792, 'psi': 0.8352256119690229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=34 head_norm_before_train=1.619467 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9513314090754136, 'auprc': 0.9574654817461371, 'loss_val': 0.2660803436121706, 'psi': 0.953785038143703}-{'f1_val': 0.9523328407131165, 'auprc': 0.9658360919150082, 'loss_val': 0.26103860397509543, 'psi': 0.9577341411938732}
[S5] START round=34 head_norm_before_train=1.601681 cos_to_last_merge=0.8387 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.839
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.7145028925575769, 'auprc': 0.7923799160060123, 'loss_val': 0.5008682409858697, 'psi': 0.7456537019369511}-{'f1_val': 0.7000985489210169, 'auprc': 0.9899103019166496, 'loss_val': 0.18138015707645272, 'psi': 0.8160232501192699}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.647561 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=1.000000 metrics={'f1_val': 0.8622822552282419, 'auprc': 0.9602097253338207, 'loss_val': 0.33471739318226656, 'psi': 0.9014532432704734}-{'f1_val': 0.59329154244249, 'auprc': 0.7775630782638936, 'loss_val': 0.8815178130567171, 'psi': 0.6670001567710515}
[S7] START round=34 head_norm_before_train=1.730175 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6145839899676244, 'auprc': 0.7968710124339973, 'loss_val': 0.5975763843730287, 'psi': 0.6874987989541735}-{'f1_val': 0.621171405155361, 'auprc': 0.8003325510006033, 'loss_val': 0.5678613242906047, 'psi': 0.6928358634934579}
[S8] START round=34 head_norm_before_train=2.145392 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9882077600002297, 'auprc': 0.9952633578814856, 'loss_val': 0.03760230161836369, 'psi': 0.991029999152732}-{'f1_val': 0.9939009886418481, 'auprc': 0.9976636436709319, 'loss_val': 0.030936212736603904, 'psi': 0.9954060506534815}
[S9] START round=34 head_norm_before_train=1.510536 cos_to_last_merge=0.9985 (last merge round=30)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9937042272020477, 'loss_val': 0.04363800240966888, 'psi': 0.9952317477483856}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984028541087786, 'loss_val': 0.045953061085661766, 'psi': 0.9976228891507971}
[S10] START round=34 head_norm_before_train=1.946031 cos_to_last_merge=0.7830 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.783
[S10] round=34 local utility u=0.002628 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9954272897562322, 'loss_val': 0.029149738128898376, 'psi': 0.995481898984086}-{'f1_val': 0.9955183051359886, 'auprc': 0.9953806010297978, 'loss_val': 0.034266237519381126, 'psi': 0.9954632234935122}
[S11] START round=34 head_norm_before_train=1.675623 cos_to_last_merge=0.9990 (last merge round=31)
[S11] round=34 local utility u=0.002621 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9987216320251519, 'loss_val': 0.050033055437129215, 'psi': 0.9979293672401065}-{'f1_val': 0.9978150241471516, 'auprc': 0.9987277379740362, 'loss_val': 0.05777544501984979, 'psi': 0.9981801096779055}
[S13] START round=34 head_norm_before_train=1.478931 cos_to_last_merge=0.9999 (last merge round=32)
[S13] round=34 local utility u=0.002130 metrics={'f1_val': 0.6995041820189893, 'auprc': 0.7176999976767129, 'loss_val': 0.713795366964404, 'psi': 0.7067825082820787}-{'f1_val': 0.6814557978848469, 'auprc': 0.7340858749638008, 'loss_val': 0.658923171849855, 'psi': 0.7025078287164285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=34 metric=0.6995 head_norm=1.496435
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.212155e-02
[S13] stored merged vector for next round verification (round=34)
[S13] DEBUG after merge:  round=34 metric=0.6829 head_norm=1.502218 delta_norm=0.062122
[S13] aggregate: ROLLBACK (f1_val pre=0.700 post=0.683 tol_abs=0.005 tol_rel=0.0)
[S14] START round=34 head_norm_before_train=1.610270 cos_to_last_merge=0.9995 (last merge round=30)
[S14] round=34 local utility u=0.003272 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9985556474362491, 'loss_val': 0.04158604047190406, 'psi': 0.9977351801766137}-{'f1_val': 0.9969721384427733, 'auprc': 0.9981515325095919, 'loss_val': 0.04562153265063521, 'psi': 0.9974438960695007}
[S15] START round=34 head_norm_before_train=1.716740 cos_to_last_merge=0.9998 (last merge round=32)
[S15] round=34 local utility u=0.504261 metrics={'f1_val': 0.9567050645070998, 'auprc': 0.9916228008580756, 'loss_val': 0.07891655604526072, 'psi': 0.9706721590474902}-{'f1_val': 0.8190769889909087, 'auprc': 0.9906437315858634, 'loss_val': 0.25873214989746335, 'psi': 0.8877036860288906}
[S16] START round=34 head_norm_before_train=1.705631 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.257127 metrics={'f1_val': 0.9416387625474599, 'auprc': 0.9941083661178071, 'loss_val': 0.17309210060052896, 'psi': 0.9626266039755987}-{'f1_val': 0.8906187085193165, 'auprc': 0.9929864929053556, 'loss_val': 0.3778601195455243, 'psi': 0.9315658222737321}
[S17] START round=34 head_norm_before_train=2.030555 (no previous merge yet)
[S17] round=34 local utility u=0.174883 metrics={'f1_val': 0.6464543058752602, 'auprc': 0.8910117321700958, 'loss_val': 0.9267245058867891, 'psi': 0.7442772763931944}-{'f1_val': 0.6383427786235628, 'auprc': 0.8626669667128902, 'loss_val': 1.1427876705976203, 'psi': 0.7280724538592938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:40412
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.971)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:40408
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.9567 head_norm=1.762875
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.215440e-02
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.9567 head_norm=1.728256 delta_norm=0.072154
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1802 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.963)
[S6] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:40407
[S4] RECEIVED delta(kind=head bytes=1802) from S14
[S4] cosine check vs S14: cos=0.9986
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=-0.0672
[S7] DROPPED delta from S10 (cos=-0.0672 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] cosine check vs S6: cos=0.9987
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S11
[S6] cosine check vs S11: cos=0.9987
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=34 metric=0.9974 head_norm=1.701624
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.732079e-02
[S11] stored merged vector for next round verification (round=34)
[S11] DEBUG after merge:  round=34 metric=0.9974 head_norm=1.681396 delta_norm=0.047321
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=2.088106 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6357791228263006, 'auprc': 0.7192664835892913, 'loss_val': 1.7020437010628395, 'psi': 0.6691740671314969}-{'f1_val': 0.69152354231628, 'auprc': 0.7167780979650678, 'loss_val': 1.36737305285033, 'psi': 0.701625364575795}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=2.013693 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9211540506815196, 'auprc': 0.9988437464686399, 'loss_val': 0.22625571681427306, 'psi': 0.9522299289963677}-{'f1_val': 0.9568501791894158, 'auprc': 0.9988675975388472, 'loss_val': 0.13444325573095509, 'psi': 0.9736571465291883}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.640861 cos_to_last_merge=0.9999 (last merge round=33)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9540804547420367, 'auprc': 0.9517365703345098, 'loss_val': 0.26779777219322953, 'psi': 0.953142900979026}-{'f1_val': 0.9513314090754136, 'auprc': 0.9574654817461371, 'loss_val': 0.2660803436121706, 'psi': 0.953785038143703}
[S5] START round=35 head_norm_before_train=1.611718 cos_to_last_merge=0.8384 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.838
[S5] round=35 local utility u=1.000000 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.997540660872124, 'loss_val': 0.08183198488444447, 'psi': 0.9968158189421439}-{'f1_val': 0.7145028925575769, 'auprc': 0.7923799160060123, 'loss_val': 0.5008682409858697, 'psi': 0.7456537019369511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=35 head_norm_before_train=1.662269 cos_to_last_merge=0.9999 (last merge round=33)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.821196812308641, 'auprc': 0.9504591983460142, 'loss_val': 0.4499375918343653, 'psi': 0.8729017667235903}-{'f1_val': 0.8622822552282419, 'auprc': 0.9602097253338207, 'loss_val': 0.33471739318226656, 'psi': 0.9014532432704734}
[S7] START round=35 head_norm_before_train=1.736673 (no previous merge yet)
[S7] round=35 local utility u=0.221446 metrics={'f1_val': 0.6548036978362212, 'auprc': 0.810151449321696, 'loss_val': 0.43584376838085287, 'psi': 0.7169427984304111}-{'f1_val': 0.6145839899676244, 'auprc': 0.7968710124339973, 'loss_val': 0.5975763843730287, 'psi': 0.6874987989541735}
[S8] START round=35 head_norm_before_train=2.150904 (no previous merge yet)
[S8] round=35 local utility u=0.000569 metrics={'f1_val': 0.9874934518419147, 'auprc': 0.9977271677309015, 'loss_val': 0.03957011942338656, 'psi': 0.9915869381975094}-{'f1_val': 0.9882077600002297, 'auprc': 0.9952633578814856, 'loss_val': 0.03760230161836369, 'psi': 0.991029999152732}
[S9] START round=35 head_norm_before_train=1.528874 cos_to_last_merge=0.9977 (last merge round=30)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.985716065895656, 'auprc': 0.9983762007527315, 'loss_val': 0.06892890682714295, 'psi': 0.9907801198384862}-{'f1_val': 0.9962500947792776, 'auprc': 0.9937042272020477, 'loss_val': 0.04363800240966888, 'psi': 0.9952317477483856}
[S10] START round=35 head_norm_before_train=1.955483 cos_to_last_merge=0.7820 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.782
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9944423112815624, 'auprc': 0.9952616704160216, 'loss_val': 0.03872147053390208, 'psi': 0.9947700549353461}-{'f1_val': 0.9955183051359886, 'auprc': 0.9954272897562322, 'loss_val': 0.029149738128898376, 'psi': 0.995481898984086}
[S11] START round=35 head_norm_before_train=1.681396 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9986765923633654, 'loss_val': 0.04998760500196761, 'psi': 0.9979113513753919}-{'f1_val': 0.9974011907167429, 'auprc': 0.9987216320251519, 'loss_val': 0.050033055437129215, 'psi': 0.9979293672401065}
[S13] START round=35 head_norm_before_train=1.502218 cos_to_last_merge=1.0000 (last merge round=34)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6407620959818929, 'auprc': 0.7385076553852747, 'loss_val': 0.7511021403829428, 'psi': 0.6798603197432456}-{'f1_val': 0.6995041820189893, 'auprc': 0.7176999976767129, 'loss_val': 0.713795366964404, 'psi': 0.7067825082820787}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.623369 cos_to_last_merge=0.9993 (last merge round=30)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9981685320752678, 'loss_val': 0.04090018401179677, 'psi': 0.9972036396003658}-{'f1_val': 0.9971882020035234, 'auprc': 0.9985556474362491, 'loss_val': 0.04158604047190406, 'psi': 0.9977351801766137}
[S15] START round=35 head_norm_before_train=1.728256 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.8199526457334657, 'auprc': 0.9908237189601464, 'loss_val': 0.2890975076793124, 'psi': 0.888301075024138}-{'f1_val': 0.9567050645070998, 'auprc': 0.9916228008580756, 'loss_val': 0.07891655604526072, 'psi': 0.9706721590474902}
[S16] START round=35 head_norm_before_train=1.728970 cos_to_last_merge=0.9998 (last merge round=33)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8610048232597823, 'auprc': 0.9928493760525252, 'loss_val': 0.49588605386105483, 'psi': 0.9137426443768795}-{'f1_val': 0.9416387625474599, 'auprc': 0.9941083661178071, 'loss_val': 0.17309210060052896, 'psi': 0.9626266039755987}
[S17] START round=35 head_norm_before_train=2.040655 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6187222374605161, 'auprc': 0.857807239695002, 'loss_val': 1.1324730215886414, 'psi': 0.7143562383543105}-{'f1_val': 0.6464543058752602, 'auprc': 0.8910117321700958, 'loss_val': 0.9267245058867891, 'psi': 0.7442772763931944}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:40411
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:40417
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1795 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=35 metric=0.9541 head_norm=1.660494
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.462544e-02
[S4] stored merged vector for next round verification (round=35)
[S4] DEBUG after merge:  round=35 metric=0.9541 head_norm=1.641128 delta_norm=0.054625
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.013 → S9@127.0.0.1:40410
[S14] ⇄ pheromone p=0.022 → S4@127.0.0.1:40404
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.8212 head_norm=1.671842
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.944304e-02
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.8215 head_norm=1.686074 delta_norm=0.049443
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.278 → S11@127.0.0.1:40412
[S7] sending update (kind=head size=1798 to 1 peers)
[S10] ⇄ pheromone p=0.104 → S7@127.0.0.1:40408
[S9] ⇄ pheromone p=0.017 → S13@127.0.0.1:40413
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.270 → S16@127.0.0.1:40416
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=-0.0784
[S17] DROPPED delta from S8 (cos=-0.0784 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] cosine check vs S7: cos=-0.0671
[S10] DROPPED delta from S7 (cos=-0.0671 < 0.0)
[S7] ⇄ pheromone p=0.224 → S10@127.0.0.1:40411
[S8] ⇄ pheromone p=0.072 → S17@127.0.0.1:40417
[S11] ⇄ pheromone p=0.027 → S6@127.0.0.1:40407
[S16] ⇄ pheromone p=0.132 → S15@127.0.0.1:40415
[S2] START round=36 head_norm_before_train=2.095221 (no previous merge yet)
[S2] round=36 local utility u=0.470989 metrics={'f1_val': 0.7210632648475481, 'auprc': 0.7178409287140606, 'loss_val': 1.2674936281702414, 'psi': 0.7197743303941531}-{'f1_val': 0.6357791228263006, 'auprc': 0.7192664835892913, 'loss_val': 1.7020437010628395, 'psi': 0.6691740671314969}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=36 head_norm_before_train=2.023525 (no previous merge yet)
[S3] round=36 local utility u=0.329484 metrics={'f1_val': 0.9972870390780529, 'auprc': 0.9999364791162663, 'loss_val': 0.027363673430301674, 'psi': 0.9983468150933382}-{'f1_val': 0.9211540506815196, 'auprc': 0.9988437464686399, 'loss_val': 0.22625571681427306, 'psi': 0.9522299289963677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=36 head_norm_before_train=1.641128 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=36 local utility u=0.032581 metrics={'f1_val': 0.9528857445271932, 'auprc': 0.9725404727723284, 'loss_val': 0.25787855137884924, 'psi': 0.9607476358252474}-{'f1_val': 0.9540804547420367, 'auprc': 0.9517365703345098, 'loss_val': 0.26779777219322953, 'psi': 0.953142900979026}
[S5] START round=36 head_norm_before_train=1.617102 cos_to_last_merge=0.8384 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.838
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9941252078300953, 'loss_val': 0.08539389686740717, 'psi': 0.9953616971176247}-{'f1_val': 0.9963325909888239, 'auprc': 0.997540660872124, 'loss_val': 0.08183198488444447, 'psi': 0.9968158189421439}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.686074 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.032087 metrics={'f1_val': 0.8377179817920012, 'auprc': 0.9460707714275511, 'loss_val': 0.471725524584776, 'psi': 0.8810590976462211}-{'f1_val': 0.821196812308641, 'auprc': 0.9504591983460142, 'loss_val': 0.4499375918343653, 'psi': 0.8729017667235903}
[S7] START round=36 head_norm_before_train=1.744188 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6192715331709527, 'auprc': 0.8020266061031129, 'loss_val': 0.5428284063033411, 'psi': 0.6923735623438168}-{'f1_val': 0.6548036978362212, 'auprc': 0.810151449321696, 'loss_val': 0.43584376838085287, 'psi': 0.7169427984304111}
[S8] START round=36 head_norm_before_train=2.161931 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.983027569283401, 'auprc': 0.9986583558506448, 'loss_val': 0.047226618594549366, 'psi': 0.9892798839102985}-{'f1_val': 0.9874934518419147, 'auprc': 0.9977271677309015, 'loss_val': 0.03957011942338656, 'psi': 0.9915869381975094}
[S9] START round=36 head_norm_before_train=1.545153 cos_to_last_merge=0.9969 (last merge round=30)
[S9] round=36 local utility u=0.047404 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9984113284544408, 'loss_val': 0.03740559949715443, 'psi': 0.9971122003613078}-{'f1_val': 0.985716065895656, 'auprc': 0.9983762007527315, 'loss_val': 0.06892890682714295, 'psi': 0.9907801198384862}
[S10] START round=36 head_norm_before_train=1.959278 cos_to_last_merge=0.7816 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.782
[S10] round=36 local utility u=0.009061 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9955354816298084, 'loss_val': 0.027876703243507547, 'psi': 0.9955251757335165}-{'f1_val': 0.9944423112815624, 'auprc': 0.9952616704160216, 'loss_val': 0.03872147053390208, 'psi': 0.9947700549353461}
[S11] START round=36 head_norm_before_train=1.702557 cos_to_last_merge=0.9999 (last merge round=34)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9985208782060103, 'loss_val': 0.04567080673267548, 'psi': 0.9974418030313134}-{'f1_val': 0.9974011907167429, 'auprc': 0.9986765923633654, 'loss_val': 0.04998760500196761, 'psi': 0.9979113513753919}
[S13] START round=36 head_norm_before_train=1.518354 cos_to_last_merge=0.9999 (last merge round=34)
[S13] round=36 local utility u=0.173292 metrics={'f1_val': 0.7193850923710717, 'auprc': 0.7054848484614029, 'loss_val': 0.7771870134986192, 'psi': 0.7138249948072042}-{'f1_val': 0.6407620959818929, 'auprc': 0.7385076553852747, 'loss_val': 0.7511021403829428, 'psi': 0.6798603197432456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=36 head_norm_before_train=1.637019 cos_to_last_merge=0.9990 (last merge round=30)
[S14] round=36 local utility u=0.003321 metrics={'f1_val': 0.9968080713232721, 'auprc': 0.998211735751978, 'loss_val': 0.03587387213142128, 'psi': 0.9973695370947544}-{'f1_val': 0.9965603779504312, 'auprc': 0.9981685320752678, 'loss_val': 0.04090018401179677, 'psi': 0.9972036396003658}
[S15] START round=36 head_norm_before_train=1.772173 cos_to_last_merge=0.9998 (last merge round=34)
[S15] round=36 local utility u=0.645582 metrics={'f1_val': 0.9934185961837458, 'auprc': 0.9914307305898226, 'loss_val': 0.04055024560640992, 'psi': 0.9926234499461766}-{'f1_val': 0.8199526457334657, 'auprc': 0.9908237189601464, 'loss_val': 0.2890975076793124, 'psi': 0.888301075024138}
[S16] START round=36 head_norm_before_train=1.750105 cos_to_last_merge=0.9995 (last merge round=33)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8439477062480344, 'auprc': 0.9979840094731348, 'loss_val': 0.5651532379709281, 'psi': 0.9055622275380746}-{'f1_val': 0.8610048232597823, 'auprc': 0.9928493760525252, 'loss_val': 0.49588605386105483, 'psi': 0.9137426443768795}
[S17] START round=36 head_norm_before_train=2.052326 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6172733282678448, 'auprc': 0.8057843964320515, 'loss_val': 1.358327727744729, 'psi': 0.6926777555335275}-{'f1_val': 0.6187222374605161, 'auprc': 0.857807239695002, 'loss_val': 1.1324730215886414, 'psi': 0.7143562383543105}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:40416
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:40412
[S6] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S4
[S9] cosine check vs S4: cos=-0.0791
[S9] DROPPED delta from S4 (cos=-0.0791 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=0.9994
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.9966
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] cosine check vs S10: cos=-0.0672
[S7] DROPPED delta from S10 (cos=-0.0672 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S14
[S4] cosine check vs S14: cos=0.9987
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] cosine check vs S15: cos=0.9976
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=36 metric=0.9529 head_norm=1.654368
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.197433e-02
[S4] stored merged vector for next round verification (round=36)
[S4] DEBUG after merge:  round=36 metric=0.9528 head_norm=1.652350 delta_norm=0.041974
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.8439 head_norm=1.769038
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.561262e-02
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.8435 head_norm=1.790165 delta_norm=0.065613
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=36 metric=0.9967 head_norm=1.721408
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.074471e-02
[S11] stored merged vector for next round verification (round=36)
[S11] DEBUG after merge:  round=36 metric=0.9967 head_norm=1.712666 delta_norm=0.030745
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=2.103914 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.6514831253732174, 'auprc': 0.7168027702803639, 'loss_val': 1.5385625668566212, 'psi': 0.677610983336076}-{'f1_val': 0.7210632648475481, 'auprc': 0.7178409287140606, 'loss_val': 1.2674936281702414, 'psi': 0.7197743303941531}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=2.033131 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.8873344543007575, 'auprc': 0.9991730618278529, 'loss_val': 0.20911741303208528, 'psi': 0.9320698973115957}-{'f1_val': 0.9972870390780529, 'auprc': 0.9999364791162663, 'loss_val': 0.027363673430301674, 'psi': 0.9983468150933382}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.652350 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.947952486905597, 'auprc': 0.9500738065362521, 'loss_val': 0.2757964673704336, 'psi': 0.948801014757859}-{'f1_val': 0.9528857445271932, 'auprc': 0.9725404727723284, 'loss_val': 0.25787855137884924, 'psi': 0.9607476358252474}
[S5] START round=37 head_norm_before_train=1.620212 cos_to_last_merge=0.8385 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.839
[S5] round=37 local utility u=0.009112 metrics={'f1_val': 0.9959673157242839, 'auprc': 0.997592717648123, 'loss_val': 0.07625998925696961, 'psi': 0.9966174764938195}-{'f1_val': 0.996186023309311, 'auprc': 0.9941252078300953, 'loss_val': 0.08539389686740717, 'psi': 0.9953616971176247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=37 head_norm_before_train=1.704433 cos_to_last_merge=0.9999 (last merge round=35)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7779880269112218, 'auprc': 0.9586670285211867, 'loss_val': 0.42993919444932843, 'psi': 0.8502596275552078}-{'f1_val': 0.8377179817920012, 'auprc': 0.9460707714275511, 'loss_val': 0.471725524584776, 'psi': 0.8810590976462211}
[S7] START round=37 head_norm_before_train=1.749469 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.6123016971606889, 'auprc': 0.7945701764774827, 'loss_val': 0.642690600551434, 'psi': 0.6852090888874065}-{'f1_val': 0.6192715331709527, 'auprc': 0.8020266061031129, 'loss_val': 0.5428284063033411, 'psi': 0.6923735623438168}
[S8] START round=37 head_norm_before_train=2.160747 (no previous merge yet)
[S8] round=37 local utility u=0.037070 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9983156710347261, 'loss_val': 0.03190421434971343, 'psi': 0.995127343105563}-{'f1_val': 0.983027569283401, 'auprc': 0.9986583558506448, 'loss_val': 0.047226618594549366, 'psi': 0.9892798839102985}
[S9] START round=37 head_norm_before_train=1.558367 cos_to_last_merge=0.9962 (last merge round=30)
[S9] round=37 local utility u=0.002283 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984072752697333, 'loss_val': 0.03531380323445343, 'psi': 0.9973592171962282}-{'f1_val': 0.9962461149658858, 'auprc': 0.9984113284544408, 'loss_val': 0.03740559949715443, 'psi': 0.9971122003613078}
[S10] START round=37 head_norm_before_train=1.966246 cos_to_last_merge=0.7808 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.781
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9954977691012126, 'loss_val': 0.029062795351751085, 'psi': 0.9955100907220782}-{'f1_val': 0.9955183051359886, 'auprc': 0.9955354816298084, 'loss_val': 0.027876703243507547, 'psi': 0.9955251757335165}
[S11] START round=37 head_norm_before_train=1.712666 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9925390267138149, 'auprc': 0.999098145980494, 'loss_val': 0.05506110191693709, 'psi': 0.9951626744204866}-{'f1_val': 0.9967224195815153, 'auprc': 0.9985208782060103, 'loss_val': 0.04567080673267548, 'psi': 0.9974418030313134}
[S13] START round=37 head_norm_before_train=1.530681 cos_to_last_merge=0.9997 (last merge round=34)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6617856954266008, 'auprc': 0.6735462157084371, 'loss_val': 0.8133058808160415, 'psi': 0.6664899035393352}-{'f1_val': 0.7193850923710717, 'auprc': 0.7054848484614029, 'loss_val': 0.7771870134986192, 'psi': 0.7138249948072042}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.6618 head_norm=1.546070
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.992135e-02
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.6548 head_norm=1.550655 delta_norm=0.069921
[S13] aggregate: ROLLBACK (f1_val pre=0.662 post=0.655 tol_abs=0.005 tol_rel=0.0)
[S14] START round=37 head_norm_before_train=1.651396 cos_to_last_merge=0.9986 (last merge round=30)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9963875947232834, 'auprc': 0.9986482149495912, 'loss_val': 0.03629030691675731, 'psi': 0.9972918428138066}-{'f1_val': 0.9968080713232721, 'auprc': 0.998211735751978, 'loss_val': 0.03587387213142128, 'psi': 0.9973695370947544}
[S15] START round=37 head_norm_before_train=1.813420 cos_to_last_merge=0.9995 (last merge round=34)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7583831091770943, 'auprc': 0.9234763413445866, 'loss_val': 0.48978467708027035, 'psi': 0.8244204020440913}-{'f1_val': 0.9934185961837458, 'auprc': 0.9914307305898226, 'loss_val': 0.04055024560640992, 'psi': 0.9926234499461766}
[S16] START round=37 head_norm_before_train=1.790165 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.839864337329214, 'auprc': 0.9973560926886893, 'loss_val': 0.6254836153370661, 'psi': 0.9028610394730041}-{'f1_val': 0.8439477062480344, 'auprc': 0.9979840094731348, 'loss_val': 0.5651532379709281, 'psi': 0.9055622275380746}
[S17] START round=37 head_norm_before_train=2.060606 (no previous merge yet)
[S17] round=37 local utility u=0.154717 metrics={'f1_val': 0.6265679453118023, 'auprc': 0.8597381512726485, 'loss_val': 1.2665230898976783, 'psi': 0.7198360276961409}-{'f1_val': 0.6172733282678448, 'auprc': 0.8057843964320515, 'loss_val': 1.358327727744729, 'psi': 0.6926777555335275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:40417
[S9] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=-0.0804
[S17] DROPPED delta from S8 (cos=-0.0804 < 0.0)
[S2] START round=38 head_norm_before_train=2.114536 (no previous merge yet)
[S2] round=38 local utility u=0.355341 metrics={'f1_val': 0.7109862161560072, 'auprc': 0.738195904353244, 'loss_val': 1.2490788812627918, 'psi': 0.7218700914349019}-{'f1_val': 0.6514831253732174, 'auprc': 0.7168027702803639, 'loss_val': 1.5385625668566212, 'psi': 0.677610983336076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=38 head_norm_before_train=2.043301 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.8085218810802376, 'auprc': 0.9987066344513067, 'loss_val': 0.4068008818103284, 'psi': 0.8845957824286652}-{'f1_val': 0.8873344543007575, 'auprc': 0.9991730618278529, 'loss_val': 0.20911741303208528, 'psi': 0.9320698973115957}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.667078 cos_to_last_merge=0.9999 (last merge round=36)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.947700458563944, 'auprc': 0.9482973716103296, 'loss_val': 0.27565998284711435, 'psi': 0.9479392237824983}-{'f1_val': 0.947952486905597, 'auprc': 0.9500738065362521, 'loss_val': 0.2757964673704336, 'psi': 0.948801014757859}
[S5] START round=38 head_norm_before_train=1.625136 cos_to_last_merge=0.8380 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.838
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9915192533018055, 'loss_val': 0.08623642667411961, 'psi': 0.9943193153063088}-{'f1_val': 0.9959673157242839, 'auprc': 0.997592717648123, 'loss_val': 0.07625998925696961, 'psi': 0.9966174764938195}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.720887 cos_to_last_merge=0.9996 (last merge round=35)
[S6] round=38 local utility u=0.070596 metrics={'f1_val': 0.812822941981624, 'auprc': 0.9440763653176141, 'loss_val': 0.4539837899621961, 'psi': 0.8653243113160201}-{'f1_val': 0.7779880269112218, 'auprc': 0.9586670285211867, 'loss_val': 0.42993919444932843, 'psi': 0.8502596275552078}
[S7] START round=38 head_norm_before_train=1.753479 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6114997795964611, 'auprc': 0.7949872081612926, 'loss_val': 0.6490439811467998, 'psi': 0.6848947510223937}-{'f1_val': 0.6123016971606889, 'auprc': 0.7945701764774827, 'loss_val': 0.642690600551434, 'psi': 0.6852090888874065}
[S8] START round=38 head_norm_before_train=2.165987 (no previous merge yet)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9886156977583775, 'auprc': 0.9986844611196657, 'loss_val': 0.034305646029933384, 'psi': 0.9926432031028928}-{'f1_val': 0.9930017911527874, 'auprc': 0.9983156710347261, 'loss_val': 0.03190421434971343, 'psi': 0.995127343105563}
[S9] START round=38 head_norm_before_train=1.572193 cos_to_last_merge=0.9954 (last merge round=30)
[S9] round=38 local utility u=0.002832 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987798774812628, 'loss_val': 0.033422456761738994, 'psi': 0.9977736984997908}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984072752697333, 'loss_val': 0.03531380323445343, 'psi': 0.9973592171962282}
[S10] START round=38 head_norm_before_train=1.976555 cos_to_last_merge=0.7797 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.780
[S10] round=38 local utility u=0.000260 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9956368211828288, 'loss_val': 0.02895971052133166, 'psi': 0.9955657115547247}-{'f1_val': 0.9955183051359886, 'auprc': 0.9954977691012126, 'loss_val': 0.029062795351751085, 'psi': 0.9955100907220782}
[S11] START round=38 head_norm_before_train=1.730672 cos_to_last_merge=0.9999 (last merge round=36)
[S11] round=38 local utility u=0.020340 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9985315979593958, 'loss_val': 0.04040430489579683, 'psi': 0.9977082510431438}-{'f1_val': 0.9925390267138149, 'auprc': 0.999098145980494, 'loss_val': 0.05506110191693709, 'psi': 0.9951626744204866}
[S13] START round=38 head_norm_before_train=1.550655 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6188084198940766, 'auprc': 0.6504548690064469, 'loss_val': 1.0391221750567257, 'psi': 0.6314669995390247}-{'f1_val': 0.6617856954266008, 'auprc': 0.6735462157084371, 'loss_val': 0.8133058808160415, 'psi': 0.6664899035393352}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.663961 cos_to_last_merge=0.9983 (last merge round=30)
[S14] round=38 local utility u=0.002247 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.998463908562381, 'loss_val': 0.03358279754649391, 'psi': 0.9974520279964141}-{'f1_val': 0.9963875947232834, 'auprc': 0.9986482149495912, 'loss_val': 0.03629030691675731, 'psi': 0.9972918428138066}
[S15] START round=38 head_norm_before_train=1.848513 cos_to_last_merge=0.9990 (last merge round=34)
[S15] round=38 local utility u=1.000000 metrics={'f1_val': 0.9959176576326709, 'auprc': 0.9933687276394004, 'loss_val': 0.033730191504837075, 'psi': 0.9948980856353627}-{'f1_val': 0.7583831091770943, 'auprc': 0.9234763413445866, 'loss_val': 0.48978467708027035, 'psi': 0.8244204020440913}
[S16] START round=38 head_norm_before_train=1.807840 cos_to_last_merge=0.9999 (last merge round=36)
[S16] round=38 local utility u=0.052763 metrics={'f1_val': 0.848897739842417, 'auprc': 0.9959177308114096, 'loss_val': 0.5698438250042648, 'psi': 0.907705736230014}-{'f1_val': 0.839864337329214, 'auprc': 0.9973560926886893, 'loss_val': 0.6254836153370661, 'psi': 0.9028610394730041}
[S17] START round=38 head_norm_before_train=2.070577 (no previous merge yet)
[S17] round=38 local utility u=0.277062 metrics={'f1_val': 0.6237441744874249, 'auprc': 0.902031262287, 'loss_val': 0.8223356072712648, 'psi': 0.735059009607255}-{'f1_val': 0.6265679453118023, 'auprc': 0.8597381512726485, 'loss_val': 1.2665230898976783, 'psi': 0.7198360276961409}
[S17] not sending this round → trigger blocked (psi=0.735)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:40416
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:40412
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:40407
[S15] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:40415
[S10] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] cosine check vs S10: cos=-0.0673
[S7] DROPPED delta from S10 (cos=-0.0673 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S6
[S11] cosine check vs S6: cos=0.9984
[S16] RECEIVED delta(kind=head bytes=1803) from S15
[S16] cosine check vs S15: cos=0.9976
[S11] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S11
[S6] cosine check vs S11: cos=0.9984
[S15] RECEIVED delta(kind=head bytes=1806) from S16
[S15] cosine check vs S16: cos=0.9976
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.8489 head_norm=1.824723
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.951549e-02
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.8478 head_norm=1.850237 delta_norm=0.069515
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=38 metric=0.9972 head_norm=1.747385
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.024522e-02
[S11] stored merged vector for next round verification (round=38)
[S11] DEBUG after merge:  round=38 metric=0.9972 head_norm=1.740870 delta_norm=0.050245
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=2.122612 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6389905465143574, 'auprc': 0.7188666818592723, 'loss_val': 1.4949354852132068, 'psi': 0.6709410006523233}-{'f1_val': 0.7109862161560072, 'auprc': 0.738195904353244, 'loss_val': 1.2490788812627918, 'psi': 0.7218700914349019}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.671 u=0.0000 p_local=0.1213 f1=0.639 auprc=0.719 bytes=28803
[S3] START round=39 head_norm_before_train=2.052988 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.6840900406219734, 'auprc': 0.9984985639516218, 'loss_val': 0.7600867854011547, 'psi': 0.8098534499538328}-{'f1_val': 0.8085218810802376, 'auprc': 0.9987066344513067, 'loss_val': 0.4068008818103284, 'psi': 0.8845957824286652}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.810 u=0.0000 p_local=0.1220 f1=0.684 auprc=0.998 bytes=34197
[S4] START round=39 head_norm_before_train=1.681681 cos_to_last_merge=0.9998 (last merge round=36)
[S4] round=39 local utility u=0.041801 metrics={'f1_val': 0.9504082655988435, 'auprc': 0.96859812112069, 'loss_val': 0.26920653628460295, 'psi': 0.9576842078075821}-{'f1_val': 0.947700458563944, 'auprc': 0.9482973716103296, 'loss_val': 0.27565998284711435, 'psi': 0.9479392237824983}
[S5] START round=39 head_norm_before_train=1.634241 cos_to_last_merge=0.8376 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.838
[S5] round=39 local utility u=0.017754 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9973864998370298, 'loss_val': 0.06832963644296372, 'psi': 0.9966662139203986}-{'f1_val': 0.996186023309311, 'auprc': 0.9915192533018055, 'loss_val': 0.08623642667411961, 'psi': 0.9943193153063088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S5] r=40 psi=0.997 u=0.0178 p_local=0.1371 f1=0.996 auprc=0.997 bytes=37797
[S6] START round=39 head_norm_before_train=1.735786 cos_to_last_merge=0.9990 (last merge round=35)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.5965306220172064, 'auprc': 0.9135751148273619, 'loss_val': 0.8527376085611627, 'psi': 0.7233484191412686}-{'f1_val': 0.812822941981624, 'auprc': 0.9440763653176141, 'loss_val': 0.4539837899621961, 'psi': 0.8653243113160201}
[S7] START round=39 head_norm_before_train=1.759383 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5735399390135127, 'auprc': 0.7856720601790225, 'loss_val': 0.8099498825313973, 'psi': 0.6583927874797166}-{'f1_val': 0.6114997795964611, 'auprc': 0.7949872081612926, 'loss_val': 0.6490439811467998, 'psi': 0.6848947510223937}
[S8] START round=39 head_norm_before_train=2.171764 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9761739976752165, 'auprc': 0.9988917720820376, 'loss_val': 0.05412799968391036, 'psi': 0.9852611074379449}-{'f1_val': 0.9886156977583775, 'auprc': 0.9986844611196657, 'loss_val': 0.034305646029933384, 'psi': 0.9926432031028928}
[S9] START round=39 head_norm_before_train=1.586036 cos_to_last_merge=0.9947 (last merge round=30)
[S9] round=39 local utility u=0.000254 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984149334522818, 'loss_val': 0.031818635709216246, 'psi': 0.9976277208881984}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987798774812628, 'loss_val': 0.033422456761738994, 'psi': 0.9977736984997908}
[S10] START round=39 head_norm_before_train=1.981536 cos_to_last_merge=0.7791 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.779
[S10] round=39 local utility u=0.000258 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9956476132022866, 'loss_val': 0.028476210997477394, 'psi': 0.9955700283625077}-{'f1_val': 0.9955183051359886, 'auprc': 0.9956368211828288, 'loss_val': 0.02895971052133166, 'psi': 0.9955657115547247}
[S11] START round=39 head_norm_before_train=1.740870 cos_to_last_merge=1.0000 (last merge round=38)
[S11] round=39 local utility u=0.001265 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.998645360393788, 'loss_val': 0.03966634823028099, 'psi': 0.997898858587561}-{'f1_val': 0.9971593530989756, 'auprc': 0.9985315979593958, 'loss_val': 0.04040430489579683, 'psi': 0.9977082510431438}
[S13] START round=39 head_norm_before_train=1.557835 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=39 local utility u=0.393833 metrics={'f1_val': 0.6617721442621184, 'auprc': 0.7395058505347263, 'loss_val': 0.7763912526810555, 'psi': 0.6928656267711615}-{'f1_val': 0.6188084198940766, 'auprc': 0.6504548690064469, 'loss_val': 1.0391221750567257, 'psi': 0.6314669995390247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S13] r=40 psi=0.693 u=0.3938 p_local=0.1169 f1=0.662 auprc=0.740 bytes=37784
[S14] START round=39 head_norm_before_train=1.677332 cos_to_last_merge=0.9978 (last merge round=30)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9516551696461595, 'auprc': 0.9971718641711248, 'loss_val': 0.07160578533975061, 'psi': 0.9698618474561456}-{'f1_val': 0.9967774409524363, 'auprc': 0.998463908562381, 'loss_val': 0.03358279754649391, 'psi': 0.9974520279964141}
[S15] START round=39 head_norm_before_train=1.877979 cos_to_last_merge=0.9985 (last merge round=34)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.7775870137937975, 'auprc': 0.9904043816438131, 'loss_val': 0.42749400138524657, 'psi': 0.8627139609338037}-{'f1_val': 0.9959176576326709, 'auprc': 0.9933687276394004, 'loss_val': 0.033730191504837075, 'psi': 0.9948980856353627}
[S16] START round=39 head_norm_before_train=1.850237 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.107148 metrics={'f1_val': 0.8687381293020494, 'auprc': 0.995934370708953, 'loss_val': 0.4746409344983502, 'psi': 0.9196166258648109}-{'f1_val': 0.848897739842417, 'auprc': 0.9959177308114096, 'loss_val': 0.5698438250042648, 'psi': 0.907705736230014}
[S17] START round=39 head_norm_before_train=2.084152 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6194256486166039, 'auprc': 0.8931513450082409, 'loss_val': 0.9695284514889607, 'psi': 0.7289159271732587}-{'f1_val': 0.6237441744874249, 'auprc': 0.902031262287, 'loss_val': 0.8223356072712648, 'psi': 0.735059009607255}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.729 u=0.0000 p_local=0.0838 f1=0.619 auprc=0.893 bytes=30558
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:40410
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[S9] not sending this round → trigger blocked (psi=0.998)
[S9] r=40 psi=0.998 u=0.0003 p_local=0.0124 f1=0.997 auprc=0.998 bytes=35990
[S4] sending update (kind=head size=1797 to 1 peers)
[S10] r=40 psi=0.996 u=0.0003 p_local=0.0436 f1=0.996 auprc=0.996 bytes=41381
[S14] r=40 psi=0.970 u=0.0000 p_local=0.0097 f1=0.952 auprc=0.997 bytes=43162
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=39 metric=0.5965 head_norm=1.753021
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.917630e-02
[S6] stored merged vector for next round verification (round=39)
[S6] DEBUG after merge:  round=39 metric=0.5967 head_norm=1.749204 delta_norm=0.059176
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] r=40 psi=0.723 u=0.0000 p_local=0.1284 f1=0.597 auprc=0.914 bytes=34094
[S11] not sending this round → trigger blocked (psi=0.998)
[S7] r=40 psi=0.658 u=0.0000 p_local=0.0918 f1=0.574 auprc=0.786 bytes=34119
[S8] r=40 psi=0.985 u=0.0000 p_local=0.0342 f1=0.976 auprc=0.999 bytes=35943
[S16] not sending this round → trigger blocked (psi=0.920)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.7776 head_norm=1.906846
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.226763e-02
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.7776 head_norm=1.864422 delta_norm=0.082268
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.863 u=0.0000 p_local=0.3367 f1=0.778 auprc=0.990 bytes=37790
[S9] RECEIVED delta(kind=head bytes=1797) from S4
[S9] cosine check vs S4: cos=-0.0770
[S9] DROPPED delta from S4 (cos=-0.0770 < 0.0)
[S4] r=40 psi=0.958 u=0.0418 p_local=0.0171 f1=0.950 auprc=0.969 bytes=39592
[S11] r=40 psi=0.998 u=0.0013 p_local=0.0144 f1=0.997 auprc=0.999 bytes=46708
[S16] r=40 psi=0.920 u=0.1071 p_local=0.0841 f1=0.869 auprc=0.996 bytes=35965
[S2] START round=40 head_norm_before_train=2.130507 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6339976030105811, 'auprc': 0.726166198939687, 'loss_val': 1.6142347767945906, 'psi': 0.6708650413822235}-{'f1_val': 0.6389905465143574, 'auprc': 0.7188666818592723, 'loss_val': 1.4949354852132068, 'psi': 0.6709410006523233}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.064623 (no previous merge yet)
[S3] round=40 local utility u=1.000000 metrics={'f1_val': 0.9595389913442919, 'auprc': 0.9995756886496054, 'loss_val': 0.14628443028473684, 'psi': 0.9755536702664173}-{'f1_val': 0.6840900406219734, 'auprc': 0.9984985639516218, 'loss_val': 0.7600867854011547, 'psi': 0.8098534499538328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=40 head_norm_before_train=1.701192 cos_to_last_merge=0.9993 (last merge round=36)
[S4] round=40 local utility u=0.000396 metrics={'f1_val': 0.9517094291466217, 'auprc': 0.967714663615605, 'loss_val': 0.2735709457958151, 'psi': 0.958111522934215}-{'f1_val': 0.9504082655988435, 'auprc': 0.96859812112069, 'loss_val': 0.26920653628460295, 'psi': 0.9576842078075821}
[S5] START round=40 head_norm_before_train=1.643240 cos_to_last_merge=0.8372 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.837
[S5] round=40 local utility u=0.001139 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9969105541897596, 'loss_val': 0.06462323632830007, 'psi': 0.9964758356614904}-{'f1_val': 0.996186023309311, 'auprc': 0.9973864998370298, 'loss_val': 0.06832963644296372, 'psi': 0.9966662139203986}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=40 head_norm_before_train=1.749204 cos_to_last_merge=1.0000 (last merge round=39)
[S6] round=40 local utility u=0.804837 metrics={'f1_val': 0.758874714622383, 'auprc': 0.9712532105396625, 'loss_val': 0.39016201454977306, 'psi': 0.8438261129892948}-{'f1_val': 0.5965306220172064, 'auprc': 0.9135751148273619, 'loss_val': 0.8527376085611627, 'psi': 0.7233484191412686}
[S7] START round=40 head_norm_before_train=1.763124 (no previous merge yet)
[S7] round=40 local utility u=0.622417 metrics={'f1_val': 0.6749652731645599, 'auprc': 0.8392169936358034, 'loss_val': 0.3343022204242443, 'psi': 0.7406659613530573}-{'f1_val': 0.5735399390135127, 'auprc': 0.7856720601790225, 'loss_val': 0.8099498825313973, 'psi': 0.6583927874797166}
[S8] START round=40 head_norm_before_train=2.175985 (no previous merge yet)
[S8] round=40 local utility u=0.062764 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9985198159451038, 'loss_val': 0.030644140677176423, 'psi': 0.9954283126424508}-{'f1_val': 0.9761739976752165, 'auprc': 0.9988917720820376, 'loss_val': 0.05412799968391036, 'psi': 0.9852611074379449}
[S9] START round=40 head_norm_before_train=1.599390 cos_to_last_merge=0.9940 (last merge round=30)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9984210905555024, 'loss_val': 0.03842150727788634, 'psi': 0.9949791213111198}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984149334522818, 'loss_val': 0.031818635709216246, 'psi': 0.9976277208881984}
[S10] START round=40 head_norm_before_train=1.990696 cos_to_last_merge=0.7781 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.778
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9956283868989685, 'loss_val': 0.029823189155656245, 'psi': 0.9955623378411805}-{'f1_val': 0.9955183051359886, 'auprc': 0.9956476132022866, 'loss_val': 0.028476210997477394, 'psi': 0.9955700283625077}
[S11] START round=40 head_norm_before_train=1.757183 cos_to_last_merge=0.9999 (last merge round=38)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9895083920395036, 'auprc': 0.9992237315011091, 'loss_val': 0.06408257878031035, 'psi': 0.9933945278241458}-{'f1_val': 0.9974011907167429, 'auprc': 0.998645360393788, 'loss_val': 0.03966634823028099, 'psi': 0.997898858587561}
[S13] START round=40 head_norm_before_train=1.564841 cos_to_last_merge=0.9999 (last merge round=37)
[S13] round=40 local utility u=0.042435 metrics={'f1_val': 0.6345323652456931, 'auprc': 0.8235783257439996, 'loss_val': 0.7802999398016423, 'psi': 0.7101507494450157}-{'f1_val': 0.6617721442621184, 'auprc': 0.7395058505347263, 'loss_val': 0.7763912526810555, 'psi': 0.6928656267711615}
[S13] not sending this round → trigger blocked (psi=0.710)
[S14] START round=40 head_norm_before_train=1.687925 cos_to_last_merge=0.9975 (last merge round=30)
[S14] round=40 local utility u=0.146485 metrics={'f1_val': 0.9942745743340865, 'auprc': 0.998517874273978, 'loss_val': 0.038390270024715706, 'psi': 0.9959718943100431}-{'f1_val': 0.9516551696461595, 'auprc': 0.9971718641711248, 'loss_val': 0.07160578533975061, 'psi': 0.9698618474561456}
[S15] START round=40 head_norm_before_train=1.864422 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.365857 metrics={'f1_val': 0.8696213067104525, 'auprc': 0.9919341645013358, 'loss_val': 0.2525757772264402, 'psi': 0.9185464498268058}-{'f1_val': 0.7775870137937975, 'auprc': 0.9904043816438131, 'loss_val': 0.42749400138524657, 'psi': 0.8627139609338037}
[S16] START round=40 head_norm_before_train=1.866243 cos_to_last_merge=0.9999 (last merge round=38)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8442945435004718, 'auprc': 0.9874202313178524, 'loss_val': 0.7113994963513164, 'psi': 0.901544818627424}-{'f1_val': 0.8687381293020494, 'auprc': 0.995934370708953, 'loss_val': 0.4746409344983502, 'psi': 0.9196166258648109}
[S17] START round=40 head_norm_before_train=2.093075 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6379180013019666, 'auprc': 0.8772887534795429, 'loss_val': 1.194343551001805, 'psi': 0.7336663021729972}-{'f1_val': 0.6194256486166039, 'auprc': 0.8931513450082409, 'loss_val': 0.9695284514889607, 'psi': 0.7289159271732587}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.958)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] ⇄ pheromone p=0.014 → S9@127.0.0.1:40410
[S6] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.035 → S7@127.0.0.1:40408
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] cosine check vs S6: cos=0.9996
[S16] RECEIVED delta(kind=head bytes=1801) from S15
[S16] cosine check vs S15: cos=0.9996
[S10] RECEIVED delta(kind=head bytes=1803) from S7
[S10] cosine check vs S7: cos=-0.0672
[S10] DROPPED delta from S7 (cos=-0.0672 < 0.0)
[S7] ⇄ pheromone p=0.198 → S10@127.0.0.1:40411
[S15] ⇄ pheromone p=0.343 → S16@127.0.0.1:40416
[S6] ⇄ pheromone p=0.264 → S11@127.0.0.1:40412
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=40 metric=0.8443 head_norm=1.881258
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.704791e-02
[S16] stored merged vector for next round verification (round=40)
[S16] DEBUG after merge:  round=40 metric=0.8443 head_norm=1.887460 delta_norm=0.027048
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.067 → S15@127.0.0.1:40415
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=40 metric=0.9895 head_norm=1.772592
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.607809e-02
[S11] stored merged vector for next round verification (round=40)
[S11] DEBUG after merge:  round=40 metric=0.9895 head_norm=1.770385 delta_norm=0.026078
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.012 → S6@127.0.0.1:40407
[S2] START round=41 head_norm_before_train=2.134812 (no previous merge yet)
[S2] round=41 local utility u=0.328061 metrics={'f1_val': 0.6831025115408483, 'auprc': 0.7336763217267618, 'loss_val': 1.2752732880400683, 'psi': 0.7033320356152137}-{'f1_val': 0.6339976030105811, 'auprc': 0.726166198939687, 'loss_val': 1.6142347767945906, 'psi': 0.6708650413822235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=41 head_norm_before_train=2.076134 (no previous merge yet)
[S3] round=41 local utility u=0.100217 metrics={'f1_val': 0.9784503223873661, 'auprc': 0.9995625742441949, 'loss_val': 0.05927913557726081, 'psi': 0.9868952231300976}-{'f1_val': 0.9595389913442919, 'auprc': 0.9995756886496054, 'loss_val': 0.14628443028473684, 'psi': 0.9755536702664173}
[S3] not sending this round → trigger blocked (psi=0.987)
[S4] START round=41 head_norm_before_train=1.720137 cos_to_last_merge=0.9986 (last merge round=36)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9503786094317688, 'auprc': 0.9643825377484028, 'loss_val': 0.27630084380329495, 'psi': 0.9559801807584224}-{'f1_val': 0.9517094291466217, 'auprc': 0.967714663615605, 'loss_val': 0.2735709457958151, 'psi': 0.958111522934215}
[S5] START round=41 head_norm_before_train=1.655205 cos_to_last_merge=0.8367 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.837
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9911830458890575, 'loss_val': 0.07001938368682913, 'psi': 0.9941848323412096}-{'f1_val': 0.996186023309311, 'auprc': 0.9969105541897596, 'loss_val': 0.06462323632830007, 'psi': 0.9964758356614904}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.768560 cos_to_last_merge=0.9999 (last merge round=39)
[S6] round=41 local utility u=0.422384 metrics={'f1_val': 0.8687064505441798, 'auprc': 0.9821722374507154, 'loss_val': 0.23714159262727322, 'psi': 0.9140927653067941}-{'f1_val': 0.758874714622383, 'auprc': 0.9712532105396625, 'loss_val': 0.39016201454977306, 'psi': 0.8438261129892948}
[S7] START round=41 head_norm_before_train=1.767276 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5757080341298018, 'auprc': 0.7857677330880056, 'loss_val': 0.7995070038980198, 'psi': 0.6597319137130833}-{'f1_val': 0.6749652731645599, 'auprc': 0.8392169936358034, 'loss_val': 0.3343022204242443, 'psi': 0.7406659613530573}
[S8] START round=41 head_norm_before_train=2.183228 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9850737047007152, 'auprc': 0.9987290678946898, 'loss_val': 0.041420925280182874, 'psi': 0.990535849978305}-{'f1_val': 0.9933673104406822, 'auprc': 0.9985198159451038, 'loss_val': 0.030644140677176423, 'psi': 0.9954283126424508}
[S9] START round=41 head_norm_before_train=1.611754 cos_to_last_merge=0.9934 (last merge round=30)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9984218120076849, 'loss_val': 0.039904604018168754, 'psi': 0.9939711274752873}-{'f1_val': 0.992684475148198, 'auprc': 0.9984210905555024, 'loss_val': 0.03842150727788634, 'psi': 0.9949791213111198}
[S10] START round=41 head_norm_before_train=1.999503 cos_to_last_merge=0.7771 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.777
[S10] round=41 local utility u=0.000092 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9956632046748644, 'loss_val': 0.029744478413124734, 'psi': 0.995576264951539}-{'f1_val': 0.9955183051359886, 'auprc': 0.9956283868989685, 'loss_val': 0.029823189155656245, 'psi': 0.9955623378411805}
[S11] START round=41 head_norm_before_train=1.770385 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=41 local utility u=0.033548 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9984089857173042, 'loss_val': 0.03782684417192491, 'psi': 0.9973970460358309}-{'f1_val': 0.9895083920395036, 'auprc': 0.9992237315011091, 'loss_val': 0.06408257878031035, 'psi': 0.9933945278241458}
[S13] START round=41 head_norm_before_train=1.573268 cos_to_last_merge=0.9998 (last merge round=37)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6643836740681294, 'auprc': 0.7428718158295635, 'loss_val': 0.777561839206849, 'psi': 0.695778930772703}-{'f1_val': 0.6345323652456931, 'auprc': 0.8235783257439996, 'loss_val': 0.7802999398016423, 'psi': 0.7101507494450157}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.698550 cos_to_last_merge=0.9971 (last merge round=30)
[S14] round=41 local utility u=0.013023 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9988301885975548, 'loss_val': 0.03062634588946953, 'psi': 0.997831251237677}-{'f1_val': 0.9942745743340865, 'auprc': 0.998517874273978, 'loss_val': 0.038390270024715706, 'psi': 0.9959718943100431}
[S15] START round=41 head_norm_before_train=1.894029 cos_to_last_merge=0.9999 (last merge round=39)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.8203483842117499, 'auprc': 0.991136826345886, 'loss_val': 0.35321853684566473, 'psi': 0.8886637610654043}-{'f1_val': 0.8696213067104525, 'auprc': 0.9919341645013358, 'loss_val': 0.2525757772264402, 'psi': 0.9185464498268058}
[S16] START round=41 head_norm_before_train=1.887460 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=41 local utility u=0.266815 metrics={'f1_val': 0.881564263795413, 'auprc': 0.9938809683372294, 'loss_val': 0.42077087315220296, 'psi': 0.9264909456121395}-{'f1_val': 0.8442945435004718, 'auprc': 0.9874202313178524, 'loss_val': 0.7113994963513164, 'psi': 0.901544818627424}
[S17] START round=41 head_norm_before_train=2.100181 (no previous merge yet)
[S17] round=41 local utility u=0.559022 metrics={'f1_val': 0.7024400587179545, 'auprc': 0.9421954273012998, 'loss_val': 0.6581519656888435, 'psi': 0.7983422061512926}-{'f1_val': 0.6379180013019666, 'auprc': 0.8772887534795429, 'loss_val': 1.194343551001805, 'psi': 0.7336663021729972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.914)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:40408
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:40415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:40407
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] cosine check vs S10: cos=-0.0671
[S7] DROPPED delta from S10 (cos=-0.0671 < 0.0)
[S16] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S16
[S15] cosine check vs S16: cos=0.9996
[S6] RECEIVED delta(kind=head bytes=1800) from S11
[S6] cosine check vs S11: cos=0.9995
[S2] START round=42 head_norm_before_train=2.136631 (no previous merge yet)
[S2] round=42 local utility u=0.040528 metrics={'f1_val': 0.6986702885305576, 'auprc': 0.7276675172032991, 'loss_val': 1.2695967480522816, 'psi': 0.7102691799996541}-{'f1_val': 0.6831025115408483, 'auprc': 0.7336763217267618, 'loss_val': 1.2752732880400683, 'psi': 0.7033320356152137}
[S2] not sending this round → trigger blocked (psi=0.710)
[S3] START round=42 head_norm_before_train=2.085626 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9995774832298799, 'loss_val': 0.10073426915900759, 'psi': 0.9764760445316243}-{'f1_val': 0.9784503223873661, 'auprc': 0.9995625742441949, 'loss_val': 0.05927913557726081, 'psi': 0.9868952231300976}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.739345 cos_to_last_merge=0.9981 (last merge round=36)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9492171998793235, 'auprc': 0.9500089731124786, 'loss_val': 0.2805239074544243, 'psi': 0.9495339091725855}-{'f1_val': 0.9503786094317688, 'auprc': 0.9643825377484028, 'loss_val': 0.27630084380329495, 'psi': 0.9559801807584224}
[S5] START round=42 head_norm_before_train=1.673295 cos_to_last_merge=0.8361 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.836
[S5] round=42 local utility u=0.009431 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9931799862593145, 'loss_val': 0.057148432539929905, 'psi': 0.9949836084893124}-{'f1_val': 0.996186023309311, 'auprc': 0.9911830458890575, 'loss_val': 0.07001938368682913, 'psi': 0.9941848323412096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=42 head_norm_before_train=1.786606 cos_to_last_merge=0.9997 (last merge round=39)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6019554910711015, 'auprc': 0.789867216811114, 'loss_val': 0.8312132070442658, 'psi': 0.6771201813671065}-{'f1_val': 0.8687064505441798, 'auprc': 0.9821722374507154, 'loss_val': 0.23714159262727322, 'psi': 0.9140927653067941}
[S7] START round=42 head_norm_before_train=1.772263 (no previous merge yet)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5600737796786504, 'auprc': 0.7845802527679686, 'loss_val': 0.8910559319663799, 'psi': 0.6498763689143776}-{'f1_val': 0.5757080341298018, 'auprc': 0.7857677330880056, 'loss_val': 0.7995070038980198, 'psi': 0.6597319137130833}
[S8] START round=42 head_norm_before_train=2.194052 (no previous merge yet)
[S8] round=42 local utility u=0.011031 metrics={'f1_val': 0.9882077600002297, 'auprc': 0.9981051205525058, 'loss_val': 0.036291071891231395, 'psi': 0.9921667042211402}-{'f1_val': 0.9850737047007152, 'auprc': 0.9987290678946898, 'loss_val': 0.041420925280182874, 'psi': 0.990535849978305}
[S9] START round=42 head_norm_before_train=1.623947 cos_to_last_merge=0.9927 (last merge round=30)
[S9] round=42 local utility u=0.024015 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984243708149436, 'loss_val': 0.028475100406098415, 'psi': 0.9976314958332632}-{'f1_val': 0.9910040044536889, 'auprc': 0.9984218120076849, 'loss_val': 0.039904604018168754, 'psi': 0.9939711274752873}
[S10] START round=42 head_norm_before_train=2.005361 cos_to_last_merge=0.7764 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.776
[S10] round=42 local utility u=0.001887 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9957621377387986, 'loss_val': 0.026266874351076323, 'psi': 0.9956158381771126}-{'f1_val': 0.9955183051359886, 'auprc': 0.9956632046748644, 'loss_val': 0.029744478413124734, 'psi': 0.995576264951539}
[S11] START round=42 head_norm_before_train=1.783004 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=42 local utility u=0.004711 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9987614420982711, 'loss_val': 0.03353506125487062, 'psi': 0.9979452912693543}-{'f1_val': 0.9967224195815153, 'auprc': 0.9984089857173042, 'loss_val': 0.03782684417192491, 'psi': 0.9973970460358309}
[S13] START round=42 head_norm_before_train=1.581416 cos_to_last_merge=0.9998 (last merge round=37)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6557782150509026, 'auprc': 0.6920933118574265, 'loss_val': 0.8537895723527568, 'psi': 0.6703042537735122}-{'f1_val': 0.6643836740681294, 'auprc': 0.7428718158295635, 'loss_val': 0.777561839206849, 'psi': 0.695778930772703}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.709089 cos_to_last_merge=0.9966 (last merge round=30)
[S14] round=42 local utility u=0.000207 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9989245845169012, 'loss_val': 0.028167749875043877, 'psi': 0.9976362983782223}-{'f1_val': 0.9971652929977585, 'auprc': 0.9988301885975548, 'loss_val': 0.03062634588946953, 'psi': 0.997831251237677}
[S15] START round=42 head_norm_before_train=1.921399 cos_to_last_merge=0.9998 (last merge round=39)
[S15] round=42 local utility u=0.696902 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9939733487387306, 'loss_val': 0.02382768450868657, 'psi': 0.9953887860047768}-{'f1_val': 0.8203483842117499, 'auprc': 0.991136826345886, 'loss_val': 0.35321853684566473, 'psi': 0.8886637610654043}
[S16] START round=42 head_norm_before_train=1.902174 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=42 local utility u=0.224161 metrics={'f1_val': 0.9280938913477588, 'auprc': 0.9980503775944296, 'loss_val': 0.2641356271638752, 'psi': 0.9560764858464271}-{'f1_val': 0.881564263795413, 'auprc': 0.9938809683372294, 'loss_val': 0.42077087315220296, 'psi': 0.9264909456121395}
[S17] START round=42 head_norm_before_train=2.107948 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6181930457618358, 'auprc': 0.8659226734181104, 'loss_val': 1.0624032553911067, 'psi': 0.7172848968243456}-{'f1_val': 0.7024400587179545, 'auprc': 0.9421954273012998, 'loss_val': 0.6581519656888435, 'psi': 0.7983422061512926}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:40416
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.956)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=42 metric=0.6020 head_norm=1.798773
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.687565e-02
[S6] stored merged vector for next round verification (round=42)
[S6] DEBUG after merge:  round=42 metric=0.6017 head_norm=1.790526 delta_norm=0.036876
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] not sending this round → trigger blocked (psi=0.998)
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S15
[S16] cosine check vs S15: cos=0.9992
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=42 metric=0.9963 head_norm=1.946136
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.958663e-02
[S15] stored merged vector for next round verification (round=42)
[S15] DEBUG after merge:  round=42 metric=0.9963 head_norm=1.923873 delta_norm=0.039587
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=42 metric=0.9281 head_norm=1.915711
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.187042e-02
[S16] stored merged vector for next round verification (round=42)
[S16] DEBUG after merge:  round=42 metric=0.9277 head_norm=1.930529 delta_norm=0.041870
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=2.135296 (no previous merge yet)
[S2] round=43 local utility u=0.064900 metrics={'f1_val': 0.7226709130894996, 'auprc': 0.7190520918976485, 'loss_val': 1.25795464961633, 'psi': 0.7212233846127591}-{'f1_val': 0.6986702885305576, 'auprc': 0.7276675172032991, 'loss_val': 1.2695967480522816, 'psi': 0.7102691799996541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=43 head_norm_before_train=2.093944 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.932811158571069, 'auprc': 0.9992420476018965, 'loss_val': 0.20120410590547066, 'psi': 0.9593835141834}-{'f1_val': 0.9610750853994537, 'auprc': 0.9995774832298799, 'loss_val': 0.10073426915900759, 'psi': 0.9764760445316243}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.758885 cos_to_last_merge=0.9977 (last merge round=36)
[S4] round=43 local utility u=0.009018 metrics={'f1_val': 0.9490105457809211, 'auprc': 0.9568614626568539, 'loss_val': 0.2818054616565469, 'psi': 0.9521509125312942}-{'f1_val': 0.9492171998793235, 'auprc': 0.9500089731124786, 'loss_val': 0.2805239074544243, 'psi': 0.9495339091725855}
[S5] START round=43 head_norm_before_train=1.690220 cos_to_last_merge=0.8352 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.835
[S5] round=43 local utility u=0.010623 metrics={'f1_val': 0.996186023309311, 'auprc': 0.997363521609488, 'loss_val': 0.04845240181409295, 'psi': 0.9966570226293818}-{'f1_val': 0.996186023309311, 'auprc': 0.9931799862593145, 'loss_val': 0.057148432539929905, 'psi': 0.9949836084893124}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=43 head_norm_before_train=1.790526 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=43 local utility u=1.000000 metrics={'f1_val': 0.9559040764009052, 'auprc': 0.965512373299481, 'loss_val': 0.23830140620798698, 'psi': 0.9597473951603356}-{'f1_val': 0.6019554910711015, 'auprc': 0.789867216811114, 'loss_val': 0.8312132070442658, 'psi': 0.6771201813671065}
[S7] START round=43 head_norm_before_train=1.781446 (no previous merge yet)
[S7] round=43 local utility u=0.342312 metrics={'f1_val': 0.6229018864019109, 'auprc': 0.8000714717663614, 'loss_val': 0.6298744000116163, 'psi': 0.6937697205476911}-{'f1_val': 0.5600737796786504, 'auprc': 0.7845802527679686, 'loss_val': 0.8910559319663799, 'psi': 0.6498763689143776}
[S8] START round=43 head_norm_before_train=2.198498 (no previous merge yet)
[S8] round=43 local utility u=0.021143 metrics={'f1_val': 0.9934699479610548, 'auprc': 0.9988462542524772, 'loss_val': 0.027801826951992854, 'psi': 0.9956204704776238}-{'f1_val': 0.9882077600002297, 'auprc': 0.9981051205525058, 'loss_val': 0.036291071891231395, 'psi': 0.9921667042211402}
[S9] START round=43 head_norm_before_train=1.633631 cos_to_last_merge=0.9921 (last merge round=30)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9984268360171511, 'loss_val': 0.031381730352043995, 'psi': 0.9962347888034064}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984243708149436, 'loss_val': 0.028475100406098415, 'psi': 0.9976314958332632}
[S10] START round=43 head_norm_before_train=2.014533 cos_to_last_merge=0.7753 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.775
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.995630581977397, 'loss_val': 0.030149952757306055, 'psi': 0.9955632158725519}-{'f1_val': 0.9955183051359886, 'auprc': 0.9957621377387986, 'loss_val': 0.026266874351076323, 'psi': 0.9956158381771126}
[S11] START round=43 head_norm_before_train=1.795560 cos_to_last_merge=0.9999 (last merge round=40)
[S11] round=43 local utility u=0.001001 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9987347451190605, 'loss_val': 0.031452972678015445, 'psi': 0.99793461247767}-{'f1_val': 0.9974011907167429, 'auprc': 0.9987614420982711, 'loss_val': 0.03353506125487062, 'psi': 0.9979452912693543}
[S13] START round=43 head_norm_before_train=1.592802 cos_to_last_merge=0.9996 (last merge round=37)
[S13] round=43 local utility u=0.229871 metrics={'f1_val': 0.6951199643952045, 'auprc': 0.730295438806361, 'loss_val': 0.7447052173980965, 'psi': 0.7091901541596671}-{'f1_val': 0.6557782150509026, 'auprc': 0.6920933118574265, 'loss_val': 0.8537895723527568, 'psi': 0.6703042537735122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=43 head_norm_before_train=1.719274 cos_to_last_merge=0.9962 (last merge round=30)
[S14] round=43 local utility u=0.000124 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9984681360472923, 'loss_val': 0.02773889236409197, 'psi': 0.9975725544691828}-{'f1_val': 0.9967774409524363, 'auprc': 0.9989245845169012, 'loss_val': 0.028167749875043877, 'psi': 0.9976362983782223}
[S15] START round=43 head_norm_before_train=1.923873 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.9713761023590266, 'auprc': 0.992257716866185, 'loss_val': 0.05825142364983044, 'psi': 0.9797287481618899}-{'f1_val': 0.9963324108488076, 'auprc': 0.9939733487387306, 'loss_val': 0.02382768450868657, 'psi': 0.9953887860047768}
[S16] START round=43 head_norm_before_train=1.930529 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8507215243278066, 'auprc': 0.9914640963468839, 'loss_val': 0.6419284046917906, 'psi': 0.9070185531354376}-{'f1_val': 0.9280938913477588, 'auprc': 0.9980503775944296, 'loss_val': 0.2641356271638752, 'psi': 0.9560764858464271}
[S17] START round=43 head_norm_before_train=2.117456 (no previous merge yet)
[S17] round=43 local utility u=0.117980 metrics={'f1_val': 0.6434832158931545, 'auprc': 0.8871580559611868, 'loss_val': 1.0418906343868692, 'psi': 0.7409531519203674}-{'f1_val': 0.6181930457618358, 'auprc': 0.8659226734181104, 'loss_val': 1.0624032553911067, 'psi': 0.7172848968243456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:40412
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:40411
[S6] sending update (kind=head size=1795 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:40407
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] cosine check vs S4: cos=-0.0721
[S9] DROPPED delta from S4 (cos=-0.0721 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] cosine check vs S6: cos=0.9992
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=-0.0673
[S10] DROPPED delta from S7 (cos=-0.0673 < 0.0)
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S11
[S6] cosine check vs S11: cos=0.9992
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=43 metric=0.9974 head_norm=1.809495
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.576806e-02
[S11] stored merged vector for next round verification (round=43)
[S11] DEBUG after merge:  round=43 metric=0.9974 head_norm=1.803577 delta_norm=0.035768
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=2.141459 (no previous merge yet)
[S2] round=44 local utility u=0.018503 metrics={'f1_val': 0.7140121389337887, 'auprc': 0.7358993990518758, 'loss_val': 1.2195380457263751, 'psi': 0.7227670429810236}-{'f1_val': 0.7226709130894996, 'auprc': 0.7190520918976485, 'loss_val': 1.25795464961633, 'psi': 0.7212233846127591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=44 head_norm_before_train=2.102381 (no previous merge yet)
[S3] round=44 local utility u=0.284489 metrics={'f1_val': 0.9969869110332736, 'auprc': 0.999761431784712, 'loss_val': 0.01883787736091614, 'psi': 0.9980967193338489}-{'f1_val': 0.932811158571069, 'auprc': 0.9992420476018965, 'loss_val': 0.20120410590547066, 'psi': 0.9593835141834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=44 head_norm_before_train=1.771620 cos_to_last_merge=0.9972 (last merge round=36)
[S4] round=44 local utility u=0.001148 metrics={'f1_val': 0.9486645875644852, 'auprc': 0.9584050938241732, 'loss_val': 0.28206493011280404, 'psi': 0.9525607900683604}-{'f1_val': 0.9490105457809211, 'auprc': 0.9568614626568539, 'loss_val': 0.2818054616565469, 'psi': 0.9521509125312942}
[S5] START round=44 head_norm_before_train=1.705047 cos_to_last_merge=0.8338 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.834
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9939505809048191, 'loss_val': 0.046806493729423804, 'psi': 0.9952918463475142}-{'f1_val': 0.996186023309311, 'auprc': 0.997363521609488, 'loss_val': 0.04845240181409295, 'psi': 0.9966570226293818}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.798352 cos_to_last_merge=0.9999 (last merge round=42)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.7522073541771029, 'auprc': 0.9564056844306887, 'loss_val': 0.4236472796679322, 'psi': 0.8338866862785372}-{'f1_val': 0.9559040764009052, 'auprc': 0.965512373299481, 'loss_val': 0.23830140620798698, 'psi': 0.9597473951603356}
[S7] START round=44 head_norm_before_train=1.788175 (no previous merge yet)
[S7] round=44 local utility u=0.552464 metrics={'f1_val': 0.6942484563565078, 'auprc': 0.9001205688266364, 'loss_val': 0.25317390517309124, 'psi': 0.7765973013445593}-{'f1_val': 0.6229018864019109, 'auprc': 0.8000714717663614, 'loss_val': 0.6298744000116163, 'psi': 0.6937697205476911}
[S8] START round=44 head_norm_before_train=2.202808 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9739599562254813, 'auprc': 0.9953028796679819, 'loss_val': 0.06039139360724154, 'psi': 0.9824971256024815}-{'f1_val': 0.9934699479610548, 'auprc': 0.9988462542524772, 'loss_val': 0.027801826951992854, 'psi': 0.9956204704776238}
[S9] START round=44 head_norm_before_train=1.641423 cos_to_last_merge=0.9917 (last merge round=30)
[S9] round=44 local utility u=0.007714 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984275889873204, 'loss_val': 0.027278746260840932, 'psi': 0.997367342683263}-{'f1_val': 0.9947734239942433, 'auprc': 0.9984268360171511, 'loss_val': 0.031381730352043995, 'psi': 0.9962347888034064}
[S10] START round=44 head_norm_before_train=2.024562 cos_to_last_merge=0.7742 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.774
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9955995828134595, 'loss_val': 0.031911906259129194, 'psi': 0.9955508162069769}-{'f1_val': 0.9955183051359886, 'auprc': 0.995630581977397, 'loss_val': 0.030149952757306055, 'psi': 0.9955632158725519}
[S11] START round=44 head_norm_before_train=1.803577 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.998602733203589, 'loss_val': 0.03322325166899953, 'psi': 0.9974745450303448}-{'f1_val': 0.9974011907167429, 'auprc': 0.9987347451190605, 'loss_val': 0.031452972678015445, 'psi': 0.99793461247767}
[S13] START round=44 head_norm_before_train=1.602651 cos_to_last_merge=0.9993 (last merge round=37)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.678271335734793, 'auprc': 0.7072336724147685, 'loss_val': 0.7614522892889007, 'psi': 0.6898562704067832}-{'f1_val': 0.6951199643952045, 'auprc': 0.730295438806361, 'loss_val': 0.7447052173980965, 'psi': 0.7091901541596671}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.727876 cos_to_last_merge=0.9958 (last merge round=30)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9982662149679589, 'loss_val': 0.027635239886416647, 'psi': 0.9974937923483062}-{'f1_val': 0.9969755000837764, 'auprc': 0.9984681360472923, 'loss_val': 0.02773889236409197, 'psi': 0.9975725544691828}
[S15] START round=44 head_norm_before_train=1.948271 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=44 local utility u=0.090474 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9917672353145062, 'loss_val': 0.02556925314912262, 'psi': 0.994506340635087}-{'f1_val': 0.9713761023590266, 'auprc': 0.992257716866185, 'loss_val': 0.05825142364983044, 'psi': 0.9797287481618899}
[S16] START round=44 head_norm_before_train=1.941173 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=44 local utility u=0.512229 metrics={'f1_val': 0.9401577607462396, 'auprc': 0.9982639801893738, 'loss_val': 0.17448766659702344, 'psi': 0.9634002485234933}-{'f1_val': 0.8507215243278066, 'auprc': 0.9914640963468839, 'loss_val': 0.6419284046917906, 'psi': 0.9070185531354376}
[S17] START round=44 head_norm_before_train=2.124048 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.65200846283394, 'auprc': 0.8598780705111037, 'loss_val': 1.2058769190387715, 'psi': 0.7351563059048054}-{'f1_val': 0.6434832158931545, 'auprc': 0.8871580559611868, 'loss_val': 1.0418906343868692, 'psi': 0.7409531519203674}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:40416
[S15] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:40415
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=44 metric=0.7522 head_norm=1.803501
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.077285e-02
[S6] stored merged vector for next round verification (round=44)
[S6] DEBUG after merge:  round=44 metric=0.7546 head_norm=1.806040 delta_norm=0.040773
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1803) from S15
[S16] cosine check vs S15: cos=0.9997
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=-0.0671
[S10] DROPPED delta from S7 (cos=-0.0671 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S4
[S9] cosine check vs S4: cos=-0.0720
[S9] DROPPED delta from S4 (cos=-0.0720 < 0.0)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] cosine check vs S16: cos=0.9997
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=44 metric=0.9402 head_norm=1.952295
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.585590e-02
[S16] stored merged vector for next round verification (round=44)
[S16] DEBUG after merge:  round=44 metric=0.9399 head_norm=1.960867 delta_norm=0.025856
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=2.145691 (no previous merge yet)
[S2] round=45 local utility u=0.078269 metrics={'f1_val': 0.7040816014552022, 'auprc': 0.7591147167512742, 'loss_val': 1.0730627196651992, 'psi': 0.726094847573631}-{'f1_val': 0.7140121389337887, 'auprc': 0.7358993990518758, 'loss_val': 1.2195380457263751, 'psi': 0.7227670429810236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=45 head_norm_before_train=2.109197 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9808006349781107, 'auprc': 0.9995078205845614, 'loss_val': 0.050953309597973506, 'psi': 0.988283509220691}-{'f1_val': 0.9969869110332736, 'auprc': 0.999761431784712, 'loss_val': 0.01883787736091614, 'psi': 0.9980967193338489}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.777966 cos_to_last_merge=0.9965 (last merge round=36)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9494166445775264, 'auprc': 0.9292005372405334, 'loss_val': 0.28462762075609355, 'psi': 0.9413302016427292}-{'f1_val': 0.9486645875644852, 'auprc': 0.9584050938241732, 'loss_val': 0.28206493011280404, 'psi': 0.9525607900683604}
[S5] START round=45 head_norm_before_train=1.721368 cos_to_last_merge=0.8328 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.833
[S5] round=45 local utility u=0.001416 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9939747553407354, 'loss_val': 0.04404734254619309, 'psi': 0.9953015161218808}-{'f1_val': 0.996186023309311, 'auprc': 0.9939505809048191, 'loss_val': 0.046806493729423804, 'psi': 0.9952918463475142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=45 head_norm_before_train=1.806040 cos_to_last_merge=1.0000 (last merge round=44)
[S6] round=45 local utility u=0.104721 metrics={'f1_val': 0.8157635042658897, 'auprc': 0.9447636512093751, 'loss_val': 0.5606156343341736, 'psi': 0.8673635630432839}-{'f1_val': 0.7522073541771029, 'auprc': 0.9564056844306887, 'loss_val': 0.4236472796679322, 'psi': 0.8338866862785372}
[S7] START round=45 head_norm_before_train=1.792294 (no previous merge yet)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.42857164498540545, 'auprc': 0.7799736428179997, 'loss_val': 1.33180706121954, 'psi': 0.5691324441184432}-{'f1_val': 0.6942484563565078, 'auprc': 0.9001205688266364, 'loss_val': 0.25317390517309124, 'psi': 0.7765973013445593}
[S8] START round=45 head_norm_before_train=2.208691 (no previous merge yet)
[S8] round=45 local utility u=0.081371 metrics={'f1_val': 0.9942761170547124, 'auprc': 0.9986283202665468, 'loss_val': 0.029522125301845167, 'psi': 0.9960169983394462}-{'f1_val': 0.9739599562254813, 'auprc': 0.9953028796679819, 'loss_val': 0.06039139360724154, 'psi': 0.9824971256024815}
[S9] START round=45 head_norm_before_train=1.649926 cos_to_last_merge=0.9912 (last merge round=30)
[S9] round=45 local utility u=0.000363 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998433519054263, 'loss_val': 0.02656985660881413, 'psi': 0.9973697147100401}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984275889873204, 'loss_val': 0.027278746260840932, 'psi': 0.997367342683263}
[S10] START round=45 head_norm_before_train=2.032675 cos_to_last_merge=0.7733 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.773
[S10] round=45 local utility u=0.003544 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9960323730844651, 'loss_val': 0.02612278275035882, 'psi': 0.9957239323153793}-{'f1_val': 0.9955183051359886, 'auprc': 0.9955995828134595, 'loss_val': 0.031911906259129194, 'psi': 0.9955508162069769}
[S11] START round=45 head_norm_before_train=1.817075 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=45 local utility u=0.003877 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9987451567909518, 'loss_val': 0.02996993307195103, 'psi': 0.9979387771464265}-{'f1_val': 0.9967224195815153, 'auprc': 0.998602733203589, 'loss_val': 0.03322325166899953, 'psi': 0.9974745450303448}
[S13] START round=45 head_norm_before_train=1.611580 cos_to_last_merge=0.9989 (last merge round=37)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.7052607952547202, 'auprc': 0.7231465527767929, 'loss_val': 1.003492723464251, 'psi': 0.7124150982635493}-{'f1_val': 0.678271335734793, 'auprc': 0.7072336724147685, 'loss_val': 0.7614522892889007, 'psi': 0.6898562704067832}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.737325 cos_to_last_merge=0.9954 (last merge round=30)
[S14] round=45 local utility u=0.002818 metrics={'f1_val': 0.9974089034627865, 'auprc': 0.9983877447994818, 'loss_val': 0.024943409234063667, 'psi': 0.9978004399974646}-{'f1_val': 0.9969788439352044, 'auprc': 0.9982662149679589, 'loss_val': 0.027635239886416647, 'psi': 0.9974937923483062}
[S15] START round=45 head_norm_before_train=1.969740 cos_to_last_merge=0.9999 (last merge round=42)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.7863071689074321, 'auprc': 0.961595673451136, 'loss_val': 0.4728104609685656, 'psi': 0.8564225707249137}-{'f1_val': 0.9963324108488076, 'auprc': 0.9917672353145062, 'loss_val': 0.02556925314912262, 'psi': 0.994506340635087}
[S16] START round=45 head_norm_before_train=1.960867 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=45 local utility u=0.210638 metrics={'f1_val': 0.9915876338277153, 'auprc': 0.9953681506125718, 'loss_val': 0.05310336199586544, 'psi': 0.9930998405416578}-{'f1_val': 0.9401577607462396, 'auprc': 0.9982639801893738, 'loss_val': 0.17448766659702344, 'psi': 0.9634002485234933}
[S17] START round=45 head_norm_before_train=2.132024 (no previous merge yet)
[S17] round=45 local utility u=0.054417 metrics={'f1_val': 0.6194970304988112, 'auprc': 0.896277705388329, 'loss_val': 1.0111723655892686, 'psi': 0.7302093004546184}-{'f1_val': 0.65200846283394, 'auprc': 0.8598780705111037, 'loss_val': 1.2058769190387715, 'psi': 0.7351563059048054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S4] ⇄ pheromone p=0.006 → S9@127.0.0.1:40410
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] ⇄ pheromone p=0.197 → S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:40407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:40415
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=45 metric=0.7863 head_norm=1.987468
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.369780e-02
[S15] stored merged vector for next round verification (round=45)
[S15] DEBUG after merge:  round=45 metric=0.7863 head_norm=1.969672 delta_norm=0.033698
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.198 → S16@127.0.0.1:40416
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=0.9997
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=-0.0672
[S7] DROPPED delta from S10 (cos=-0.0672 < 0.0)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] ⇄ pheromone p=0.012 → S7@127.0.0.1:40408
[S16] sending update (kind=head size=1801 to 1 peers)
[S6] ⇄ pheromone p=0.270 → S11@127.0.0.1:40412
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] cosine check vs S16: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1799) from S11
[S6] cosine check vs S11: cos=0.9997
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=45 metric=0.9974 head_norm=1.829403
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.188059e-02
[S11] stored merged vector for next round verification (round=45)
[S11] DEBUG after merge:  round=45 metric=0.9974 head_norm=1.822811 delta_norm=0.021881
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.008 → S6@127.0.0.1:40407
[S16] ⇄ pheromone p=0.191 → S15@127.0.0.1:40415
[S2] START round=46 head_norm_before_train=2.152607 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.7183829786565932, 'auprc': 0.7444131686944037, 'loss_val': 1.2108450005989555, 'psi': 0.7287950546717175}-{'f1_val': 0.7040816014552022, 'auprc': 0.7591147167512742, 'loss_val': 1.0730627196651992, 'psi': 0.726094847573631}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.115474 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9325563934937244, 'auprc': 0.9992148430242391, 'loss_val': 0.21442149944251784, 'psi': 0.9592197733059303}-{'f1_val': 0.9808006349781107, 'auprc': 0.9995078205845614, 'loss_val': 0.050953309597973506, 'psi': 0.988283509220691}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.786223 cos_to_last_merge=0.9954 (last merge round=36)
[S4] round=46 local utility u=0.077402 metrics={'f1_val': 0.9539383650484479, 'auprc': 0.9734447263606031, 'loss_val': 0.28968639447409616, 'psi': 0.96174090957331}-{'f1_val': 0.9494166445775264, 'auprc': 0.9292005372405334, 'loss_val': 0.28462762075609355, 'psi': 0.9413302016427292}
[S5] START round=46 head_norm_before_train=1.737928 cos_to_last_merge=0.8322 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9914230245376862, 'loss_val': 0.042951470759607924, 'psi': 0.9942808238006611}-{'f1_val': 0.996186023309311, 'auprc': 0.9939747553407354, 'loss_val': 0.04404734254619309, 'psi': 0.9953015161218808}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.816460 cos_to_last_merge=0.9999 (last merge round=44)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7523805032673343, 'auprc': 0.9584927962566822, 'loss_val': 0.41850440996764204, 'psi': 0.8348254204630734}-{'f1_val': 0.8157635042658897, 'auprc': 0.9447636512093751, 'loss_val': 0.5606156343341736, 'psi': 0.8673635630432839}
[S7] START round=46 head_norm_before_train=1.793536 (no previous merge yet)
[S7] round=46 local utility u=0.953510 metrics={'f1_val': 0.6193996857990701, 'auprc': 0.7993673537945888, 'loss_val': 0.6279357353168161, 'psi': 0.6913867529972777}-{'f1_val': 0.42857164498540545, 'auprc': 0.7799736428179997, 'loss_val': 1.33180706121954, 'psi': 0.5691324441184432}
[S8] START round=46 head_norm_before_train=2.219858 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9798117476688298, 'auprc': 0.9952827071909893, 'loss_val': 0.052538106994777914, 'psi': 0.9860001314776936}-{'f1_val': 0.9942761170547124, 'auprc': 0.9986283202665468, 'loss_val': 0.029522125301845167, 'psi': 0.9960169983394462}
[S9] START round=46 head_norm_before_train=1.658435 cos_to_last_merge=0.9908 (last merge round=30)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9937719190709611, 'auprc': 0.9984368014155321, 'loss_val': 0.03225690213622215, 'psi': 0.9956378720087895}-{'f1_val': 0.9966605118138915, 'auprc': 0.998433519054263, 'loss_val': 0.02656985660881413, 'psi': 0.9973697147100401}
[S10] START round=46 head_norm_before_train=2.037710 cos_to_last_merge=0.7726 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.773
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.996135939482627, 'loss_val': 0.02913276526758017, 'psi': 0.995765358874644}-{'f1_val': 0.9955183051359886, 'auprc': 0.9960323730844651, 'loss_val': 0.02612278275035882, 'psi': 0.9957239323153793}
[S11] START round=46 head_norm_before_train=1.822811 cos_to_last_merge=1.0000 (last merge round=45)
[S11] round=46 local utility u=0.000083 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9986613656763653, 'loss_val': 0.02955308949716105, 'psi': 0.9979052607005919}-{'f1_val': 0.9974011907167429, 'auprc': 0.9987451567909518, 'loss_val': 0.02996993307195103, 'psi': 0.9979387771464265}
[S13] START round=46 head_norm_before_train=1.618873 cos_to_last_merge=0.9986 (last merge round=37)
[S13] round=46 local utility u=0.125701 metrics={'f1_val': 0.6682386601644841, 'auprc': 0.7886911978145396, 'loss_val': 0.7265922790959864, 'psi': 0.7164196752245062}-{'f1_val': 0.7052607952547202, 'auprc': 0.7231465527767929, 'loss_val': 1.003492723464251, 'psi': 0.7124150982635493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=46 head_norm_before_train=1.746812 cos_to_last_merge=0.9951 (last merge round=30)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9959647244635018, 'auprc': 0.9983331075133816, 'loss_val': 0.030199979524102163, 'psi': 0.9969120776834537}-{'f1_val': 0.9974089034627865, 'auprc': 0.9983877447994818, 'loss_val': 0.024943409234063667, 'psi': 0.9978004399974646}
[S15] START round=46 head_norm_before_train=1.969672 cos_to_last_merge=1.0000 (last merge round=45)
[S15] round=46 local utility u=0.908701 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9962202233249966, 'loss_val': 0.021919226853540905, 'psi': 0.996536090362511}-{'f1_val': 0.7863071689074321, 'auprc': 0.961595673451136, 'loss_val': 0.4728104609685656, 'psi': 0.8564225707249137}
[S16] START round=46 head_norm_before_train=1.971337 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9076503077171654, 'auprc': 0.9975718668155811, 'loss_val': 0.3598570847614185, 'psi': 0.9436189313565316}-{'f1_val': 0.9915876338277153, 'auprc': 0.9953681506125718, 'loss_val': 0.05310336199586544, 'psi': 0.9930998405416578}
[S17] START round=46 head_norm_before_train=2.142413 (no previous merge yet)
[S17] round=46 local utility u=0.040917 metrics={'f1_val': 0.616461928066167, 'auprc': 0.9055807740908814, 'loss_val': 0.9390374181252267, 'psi': 0.7321094664760528}-{'f1_val': 0.6194970304988112, 'auprc': 0.896277705388329, 'loss_val': 1.0111723655892686, 'psi': 0.7302093004546184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:40416
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:40411
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[S7] sending update (kind=head size=1801 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=46 metric=0.7524 head_norm=1.829055
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.051909e-02
[S6] stored merged vector for next round verification (round=46)
[S6] DEBUG after merge:  round=46 metric=0.7616 head_norm=1.828974 delta_norm=0.030519
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:40407
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1801) from S7
[S10] cosine check vs S7: cos=-0.0670
[S10] DROPPED delta from S7 (cos=-0.0670 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] cosine check vs S4: cos=-0.0711
[S9] DROPPED delta from S4 (cos=-0.0711 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S15
[S16] cosine check vs S15: cos=0.9999
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=46 metric=0.9967 head_norm=1.986923
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.339721e-02
[S15] stored merged vector for next round verification (round=46)
[S15] DEBUG after merge:  round=46 metric=0.9967 head_norm=1.979100 delta_norm=0.013397
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1799) from S11
[S6] cosine check vs S11: cos=0.9999
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=46 metric=0.9077 head_norm=1.981359
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.525375e-02
[S16] stored merged vector for next round verification (round=46)
[S16] DEBUG after merge:  round=46 metric=0.9070 head_norm=1.984084 delta_norm=0.015254
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=2.160504 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7208862686082574, 'auprc': 0.7265103306871445, 'loss_val': 1.2531327975755582, 'psi': 0.7231358934398122}-{'f1_val': 0.7183829786565932, 'auprc': 0.7444131686944037, 'loss_val': 1.2108450005989555, 'psi': 0.7287950546717175}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.120383 (no previous merge yet)
[S3] round=47 local utility u=0.293076 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9994147015930052, 'loss_val': 0.017921017567684012, 'psi': 0.9982048221048365}-{'f1_val': 0.9325563934937244, 'auprc': 0.9992148430242391, 'loss_val': 0.21442149944251784, 'psi': 0.9592197733059303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=47 head_norm_before_train=1.798877 cos_to_last_merge=0.9950 (last merge round=36)
[S4] round=47 local utility u=0.002506 metrics={'f1_val': 0.9513240324910945, 'auprc': 0.9763179352645754, 'loss_val': 0.2776088591413901, 'psi': 0.9613215936004869}-{'f1_val': 0.9539383650484479, 'auprc': 0.9734447263606031, 'loss_val': 0.28968639447409616, 'psi': 0.96174090957331}
[S5] START round=47 head_norm_before_train=1.750888 cos_to_last_merge=0.8315 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=47 local utility u=0.000759 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9913943126525281, 'loss_val': 0.04134673387808216, 'psi': 0.9942693390465979}-{'f1_val': 0.996186023309311, 'auprc': 0.9914230245376862, 'loss_val': 0.042951470759607924, 'psi': 0.9942808238006611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=47 head_norm_before_train=1.828974 cos_to_last_merge=1.0000 (last merge round=46)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6199791739456763, 'auprc': 0.9348612469962846, 'loss_val': 0.7101402087970017, 'psi': 0.7459320031659196}-{'f1_val': 0.7523805032673343, 'auprc': 0.9584927962566822, 'loss_val': 0.41850440996764204, 'psi': 0.8348254204630734}
[S7] START round=47 head_norm_before_train=1.795960 (no previous merge yet)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5954364869176338, 'auprc': 0.7928723895907674, 'loss_val': 0.7501438288058577, 'psi': 0.6744108479868873}-{'f1_val': 0.6193996857990701, 'auprc': 0.7993673537945888, 'loss_val': 0.6279357353168161, 'psi': 0.6913867529972777}
[S8] START round=47 head_norm_before_train=2.230402 (no previous merge yet)
[S8] round=47 local utility u=0.062257 metrics={'f1_val': 0.9945717084929089, 'auprc': 0.998671081962212, 'loss_val': 0.02674945645109248, 'psi': 0.99621145788063}-{'f1_val': 0.9798117476688298, 'auprc': 0.9952827071909893, 'loss_val': 0.052538106994777914, 'psi': 0.9860001314776936}
[S9] START round=47 head_norm_before_train=1.667849 cos_to_last_merge=0.9902 (last merge round=30)
[S9] round=47 local utility u=0.012078 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984352965275236, 'loss_val': 0.0254283504624753, 'psi': 0.9973704256993443}-{'f1_val': 0.9937719190709611, 'auprc': 0.9984368014155321, 'loss_val': 0.03225690213622215, 'psi': 0.9956378720087895}
[S10] START round=47 head_norm_before_train=2.042232 cos_to_last_merge=0.7720 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.772
[S10] round=47 local utility u=0.000544 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9963017362492117, 'loss_val': 0.02854161598001121, 'psi': 0.9958316775812779}-{'f1_val': 0.9955183051359886, 'auprc': 0.996135939482627, 'loss_val': 0.02913276526758017, 'psi': 0.995765358874644}
[S11] START round=47 head_norm_before_train=1.834265 cos_to_last_merge=1.0000 (last merge round=45)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9985961482348527, 'loss_val': 0.0299821582666013, 'psi': 0.9974719110428503}-{'f1_val': 0.9974011907167429, 'auprc': 0.9986613656763653, 'loss_val': 0.02955308949716105, 'psi': 0.9979052607005919}
[S13] START round=47 head_norm_before_train=1.624842 cos_to_last_merge=0.9982 (last merge round=37)
[S13] round=47 local utility u=0.066518 metrics={'f1_val': 0.6971309625828735, 'auprc': 0.8134173028627704, 'loss_val': 0.8410884445811047, 'psi': 0.7436454986948323}-{'f1_val': 0.6682386601644841, 'auprc': 0.7886911978145396, 'loss_val': 0.7265922790959864, 'psi': 0.7164196752245062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=47 head_norm_before_train=1.753893 cos_to_last_merge=0.9948 (last merge round=30)
[S14] round=47 local utility u=0.002894 metrics={'f1_val': 0.996333843431463, 'auprc': 0.9983388155725106, 'loss_val': 0.02664369345872094, 'psi': 0.997135832287882}-{'f1_val': 0.9959647244635018, 'auprc': 0.9983331075133816, 'loss_val': 0.030199979524102163, 'psi': 0.9969120776834537}
[S15] START round=47 head_norm_before_train=1.979100 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9958372792493142, 'loss_val': 0.022337761753838527, 'psi': 0.9961343582090102}-{'f1_val': 0.9967466683875206, 'auprc': 0.9962202233249966, 'loss_val': 0.021919226853540905, 'psi': 0.996536090362511}
[S16] START round=47 head_norm_before_train=1.984084 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8312126100786222, 'auprc': 0.9915870023689337, 'loss_val': 0.91437686330122, 'psi': 0.8953623669947468}-{'f1_val': 0.9076503077171654, 'auprc': 0.9975718668155811, 'loss_val': 0.3598570847614185, 'psi': 0.9436189313565316}
[S17] START round=47 head_norm_before_train=2.152553 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5296515240566293, 'auprc': 0.7770842765708302, 'loss_val': 1.655746565416115, 'psi': 0.6286246250623096}-{'f1_val': 0.616461928066167, 'auprc': 0.9055807740908814, 'loss_val': 0.9390374181252267, 'psi': 0.7321094664760528}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S4] not sending this round → trigger blocked (psi=0.961)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=47 metric=0.6200 head_norm=1.844850
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.797641e-02
[S6] stored merged vector for next round verification (round=47)
[S6] DEBUG after merge:  round=47 metric=0.6202 head_norm=1.839477 delta_norm=0.017976
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=-0.0669
[S7] DROPPED delta from S10 (cos=-0.0669 < 0.0)
[S2] START round=48 head_norm_before_train=2.168988 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.7211434752785182, 'auprc': 0.7179893298051849, 'loss_val': 1.2638390538697184, 'psi': 0.7198818170891849}-{'f1_val': 0.7208862686082574, 'auprc': 0.7265103306871445, 'loss_val': 1.2531327975755582, 'psi': 0.7231358934398122}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.123277 (no previous merge yet)
[S3] round=48 local utility u=0.001453 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9994935173224664, 'loss_val': 0.01772180605759396, 'psi': 0.9984834274895623}-{'f1_val': 0.9973982357793907, 'auprc': 0.9994147015930052, 'loss_val': 0.017921017567684012, 'psi': 0.9982048221048365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=48 head_norm_before_train=1.812001 cos_to_last_merge=0.9945 (last merge round=36)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9505548190292689, 'auprc': 0.9740720437744987, 'loss_val': 0.2867292837873875, 'psi': 0.9599617089273608}-{'f1_val': 0.9513240324910945, 'auprc': 0.9763179352645754, 'loss_val': 0.2776088591413901, 'psi': 0.9613215936004869}
[S5] START round=48 head_norm_before_train=1.761822 cos_to_last_merge=0.8307 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=48 local utility u=0.010784 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9974250720796013, 'loss_val': 0.03787191207169474, 'psi': 0.9966816428174271}-{'f1_val': 0.996186023309311, 'auprc': 0.9913943126525281, 'loss_val': 0.04134673387808216, 'psi': 0.9942693390465979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=48 head_norm_before_train=1.839477 cos_to_last_merge=1.0000 (last merge round=47)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6206686614530772, 'auprc': 0.8155775818624308, 'loss_val': 0.815342414947314, 'psi': 0.6986322296168186}-{'f1_val': 0.6199791739456763, 'auprc': 0.9348612469962846, 'loss_val': 0.7101402087970017, 'psi': 0.7459320031659196}
[S7] START round=48 head_norm_before_train=1.800399 (no previous merge yet)
[S7] round=48 local utility u=0.475230 metrics={'f1_val': 0.6701201825200771, 'auprc': 0.8316546071124326, 'loss_val': 0.36413195779865903, 'psi': 0.7347339523570193}-{'f1_val': 0.5954364869176338, 'auprc': 0.7928723895907674, 'loss_val': 0.7501438288058577, 'psi': 0.6744108479868873}
[S8] START round=48 head_norm_before_train=2.237061 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9511398814119719, 'auprc': 0.9952926688455163, 'loss_val': 0.11506070921184276, 'psi': 0.9688009963853896}-{'f1_val': 0.9945717084929089, 'auprc': 0.998671081962212, 'loss_val': 0.02674945645109248, 'psi': 0.99621145788063}
[S9] START round=48 head_norm_before_train=1.676804 cos_to_last_merge=0.9896 (last merge round=30)
[S9] round=48 local utility u=0.000161 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984316050009676, 'loss_val': 0.02509440463606797, 'psi': 0.9973689490887219}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984352965275236, 'loss_val': 0.0254283504624753, 'psi': 0.9973704256993443}
[S10] START round=48 head_norm_before_train=2.048150 cos_to_last_merge=0.7712 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.771
[S10] round=48 local utility u=0.000421 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9964080510631103, 'loss_val': 0.028017906931385676, 'psi': 0.9958742035068373}-{'f1_val': 0.9955183051359886, 'auprc': 0.9963017362492117, 'loss_val': 0.02854161598001121, 'psi': 0.9958316775812779}
[S11] START round=48 head_norm_before_train=1.846763 cos_to_last_merge=0.9999 (last merge round=45)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9703910178879556, 'auprc': 0.9992589201653455, 'loss_val': 0.11237783649003595, 'psi': 0.9819381787989114}-{'f1_val': 0.9967224195815153, 'auprc': 0.9985961482348527, 'loss_val': 0.0299821582666013, 'psi': 0.9974719110428503}
[S13] START round=48 head_norm_before_train=1.634194 cos_to_last_merge=0.9977 (last merge round=37)
[S13] round=48 local utility u=0.118052 metrics={'f1_val': 0.724043064477661, 'auprc': 0.8110671716759068, 'loss_val': 0.7594057902692374, 'psi': 0.7588527073569593}-{'f1_val': 0.6971309625828735, 'auprc': 0.8134173028627704, 'loss_val': 0.8410884445811047, 'psi': 0.7436454986948323}
[S13] not sending this round → trigger blocked (psi=0.759)
[S14] START round=48 head_norm_before_train=1.761823 cos_to_last_merge=0.9944 (last merge round=30)
[S14] round=48 local utility u=0.002105 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.998440862904303, 'loss_val': 0.026590066657089934, 'psi': 0.9975616452119871}-{'f1_val': 0.996333843431463, 'auprc': 0.9983388155725106, 'loss_val': 0.02664369345872094, 'psi': 0.997135832287882}
[S15] START round=48 head_norm_before_train=1.996436 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7533912954213442, 'auprc': 0.9135503193106635, 'loss_val': 0.6026984234592385, 'psi': 0.817454904977072}-{'f1_val': 0.9963324108488076, 'auprc': 0.9958372792493142, 'loss_val': 0.022337761753838527, 'psi': 0.9961343582090102}
[S16] START round=48 head_norm_before_train=1.993739 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=48 local utility u=0.147193 metrics={'f1_val': 0.8499540941421165, 'auprc': 0.9891028311742313, 'loss_val': 0.7249872501298307, 'psi': 0.9056135889549624}-{'f1_val': 0.8312126100786222, 'auprc': 0.9915870023689337, 'loss_val': 0.91437686330122, 'psi': 0.8953623669947468}
[S17] START round=48 head_norm_before_train=2.158686 (no previous merge yet)
[S17] round=48 local utility u=1.000000 metrics={'f1_val': 0.7484803464663972, 'auprc': 0.8970446551810535, 'loss_val': 0.8735398036946999, 'psi': 0.8079060699522597}-{'f1_val': 0.5296515240566293, 'auprc': 0.7770842765708302, 'loss_val': 1.655746565416115, 'psi': 0.6286246250623096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S16]  timeout peer S8
[S14]  timeout peer S4
[S8]  timeout peer S17
[S9]  timeout peer S13
[S11]  timeout peer S14
[S14] not sending this round → trigger blocked (psi=0.998)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:40411
[S7] sending update (kind=head size=1799 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:40415
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=-0.0664
[S10] DROPPED delta from S7 (cos=-0.0664 < 0.0)
[S16] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] cosine check vs S16: cos=0.9998
[S2] START round=49 head_norm_before_train=2.171331 (no previous merge yet)
[S2] round=49 local utility u=0.002255 metrics={'f1_val': 0.7222401571870402, 'auprc': 0.7175434043419411, 'loss_val': 1.2645714325728181, 'psi': 0.7203614560490006}-{'f1_val': 0.7211434752785182, 'auprc': 0.7179893298051849, 'loss_val': 1.2638390538697184, 'psi': 0.7198818170891849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=49 head_norm_before_train=2.127612 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9998742044659897, 'loss_val': 0.11095336314766184, 'psi': 0.9765947330260681}-{'f1_val': 0.9978100342676263, 'auprc': 0.9994935173224664, 'loss_val': 0.01772180605759396, 'psi': 0.9984834274895623}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.815863 cos_to_last_merge=0.9941 (last merge round=36)
[S4] round=49 local utility u=0.000142 metrics={'f1_val': 0.9513546881205268, 'auprc': 0.9731135257940495, 'loss_val': 0.28836883305429806, 'psi': 0.9600582231899359}-{'f1_val': 0.9505548190292689, 'auprc': 0.9740720437744987, 'loss_val': 0.2867292837873875, 'psi': 0.9599617089273608}
[S5] START round=49 head_norm_before_train=1.771949 cos_to_last_merge=0.8303 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.830
[S5] round=49 local utility u=0.000744 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9974039274594456, 'loss_val': 0.036319626722798384, 'psi': 0.9966731849693649}-{'f1_val': 0.996186023309311, 'auprc': 0.9974250720796013, 'loss_val': 0.03787191207169474, 'psi': 0.9966816428174271}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=49 head_norm_before_train=1.855658 cos_to_last_merge=1.0000 (last merge round=47)
[S6] round=49 local utility u=1.000000 metrics={'f1_val': 0.8140711851199693, 'auprc': 0.9632757858615311, 'loss_val': 0.366615861781908, 'psi': 0.8737530254165939}-{'f1_val': 0.6206686614530772, 'auprc': 0.8155775818624308, 'loss_val': 0.815342414947314, 'psi': 0.6986322296168186}
[S7] START round=49 head_norm_before_train=1.804226 (no previous merge yet)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6574776987556195, 'auprc': 0.8143058017515797, 'loss_val': 0.41338515295364775, 'psi': 0.7202089399540035}-{'f1_val': 0.6701201825200771, 'auprc': 0.8316546071124326, 'loss_val': 0.36413195779865903, 'psi': 0.7347339523570193}
[S8] START round=49 head_norm_before_train=2.247564 (no previous merge yet)
[S8] round=49 local utility u=0.168345 metrics={'f1_val': 0.9919085369259982, 'auprc': 0.9982301754596765, 'loss_val': 0.03179471582682602, 'psi': 0.9944371923394695}-{'f1_val': 0.9511398814119719, 'auprc': 0.9952926688455163, 'loss_val': 0.11506070921184276, 'psi': 0.9688009963853896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=49 head_norm_before_train=1.685471 cos_to_last_merge=0.9891 (last merge round=30)
[S9] round=49 local utility u=0.000299 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984338140868045, 'loss_val': 0.024502824950230033, 'psi': 0.9973698327230567}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984316050009676, 'loss_val': 0.02509440463606797, 'psi': 0.9973689490887219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=49 head_norm_before_train=2.054334 cos_to_last_merge=0.7704 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.770
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9964380151859918, 'loss_val': 0.029159626605987966, 'psi': 0.9958861891559899}-{'f1_val': 0.9955183051359886, 'auprc': 0.9964080510631103, 'loss_val': 0.028017906931385676, 'psi': 0.9958742035068373}
[S11] START round=49 head_norm_before_train=1.857255 cos_to_last_merge=0.9998 (last merge round=45)
[S11] round=49 local utility u=0.120038 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9986117431076927, 'loss_val': 0.028349264010376306, 'psi': 0.9974781489919864}-{'f1_val': 0.9703910178879556, 'auprc': 0.9992589201653455, 'loss_val': 0.11237783649003595, 'psi': 0.9819381787989114}
[S13] START round=49 head_norm_before_train=1.651370 cos_to_last_merge=0.9970 (last merge round=37)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6604435867943574, 'auprc': 0.7485622643896178, 'loss_val': 0.9723935243019977, 'psi': 0.6956910578324615}-{'f1_val': 0.724043064477661, 'auprc': 0.8110671716759068, 'loss_val': 0.7594057902692374, 'psi': 0.7588527073569593}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.768622 cos_to_last_merge=0.9940 (last merge round=30)
[S14] round=49 local utility u=0.000659 metrics={'f1_val': 0.9967810786833209, 'auprc': 0.9986259058399942, 'loss_val': 0.0246600145643497, 'psi': 0.9975190095459903}-{'f1_val': 0.9969755000837764, 'auprc': 0.998440862904303, 'loss_val': 0.026590066657089934, 'psi': 0.9975616452119871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S14] sending update (kind=head size=1808 to 1 peers)
[S15] START round=49 head_norm_before_train=2.013973 cos_to_last_merge=0.9999 (last merge round=46)
[S15] round=49 local utility u=1.000000 metrics={'f1_val': 0.9691301946437945, 'auprc': 0.9936077151942954, 'loss_val': 0.05886990355334043, 'psi': 0.9789212028639949}-{'f1_val': 0.7533912954213442, 'auprc': 0.9135503193106635, 'loss_val': 0.6026984234592385, 'psi': 0.817454904977072}
[S16] START round=49 head_norm_before_train=2.002599 cos_to_last_merge=0.9999 (last merge round=46)
[S16] round=49 local utility u=0.497229 metrics={'f1_val': 0.9361956977503396, 'auprc': 0.9926896915279375, 'loss_val': 0.2587389564650965, 'psi': 0.9587932952613788}-{'f1_val': 0.8499540941421165, 'auprc': 0.9891028311742313, 'loss_val': 0.7249872501298307, 'psi': 0.9056135889549624}
[S17] START round=49 head_norm_before_train=2.163083 (no previous merge yet)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.641209526171563, 'auprc': 0.8956952029504364, 'loss_val': 1.0405538369464666, 'psi': 0.7430037968831124}-{'f1_val': 0.7484803464663972, 'auprc': 0.8970446551810535, 'loss_val': 0.8735398036946999, 'psi': 0.8079060699522597}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:40407
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[S16] not sending this round → trigger blocked (psi=0.959)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:40412
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] cosine check vs S15: cos=0.9997
[S9] RECEIVED delta(kind=head bytes=1803) from S4
[S9] cosine check vs S4: cos=-0.0707
[S9] DROPPED delta from S4 (cos=-0.0707 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=0.9995
[S6] RECEIVED delta(kind=head bytes=1800) from S11
[S6] cosine check vs S11: cos=0.9995
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=49 metric=0.8141 head_norm=1.865505
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.056670e-02
[S6] stored merged vector for next round verification (round=49)
[S6] DEBUG after merge:  round=49 metric=0.8146 head_norm=1.866087 delta_norm=0.030567
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=49 metric=0.9967 head_norm=1.867170
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.056669e-02
[S11] stored merged vector for next round verification (round=49)
[S11] DEBUG after merge:  round=49 metric=0.9967 head_norm=1.866087 delta_norm=0.030567
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=49 metric=0.9691 head_norm=2.031696
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.671950e-02
[S15] stored merged vector for next round verification (round=49)
[S15] DEBUG after merge:  round=49 metric=0.9687 head_norm=2.017023 delta_norm=0.026720
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
